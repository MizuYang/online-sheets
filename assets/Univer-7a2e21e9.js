import{o as ww,c as Lw,r as aj,a as Fy,b as sj}from"./index-c65d8cd2.js";function uj(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var CC=Symbol("$$IDENTIFIER_DECORATOR");function lj(t){return t&&t[CC]===!0}function Ow(t){return typeof t=="function"}function $y(t){return!!(t&&typeof t.useClass<"u")}function ky(t){return!!(t&&typeof t.useFactory<"u")}function By(t){return!!(t&&typeof t.useValue<"u")}function Uy(t){return!!(t&&typeof t.useAsync<"u")}var Pw=Symbol("AsyncHook");function ip(t){return!!(t&&t.__symbol===Pw)}function Ts(t){return typeof t>"u"?"undefined":Ow(t)&&!t[CC]?t.name:t.toString()}var wr;(function(t){t.MANY="many",t.OPTIONAL="optional",t.REQUIRED="required"})(wr||(wr={}));var z1;(function(t){t.SELF="self",t.SKIP_SELF="skipSelf"})(z1||(z1={}));var cj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),so=function(t){cj(e,t);function e(n){return t.call(this,"[redi]: ".concat(n))||this}return e}(Error),Mw=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vy=Symbol("$$TARGET"),mv=Symbol("$$DEPENDENCIES"),dj=function(t){Mw(e,t);function e(n,r){var i="Could not find dependency registered on the ".concat(n,' (indexed) parameter of the constructor of "').concat(Ts(r),'".');return t.call(this,i)||this}return e}(so),Nw=function(t){Mw(e,t);function e(n,r){var i='It seems that you register "undefined" as dependency on the '.concat(r+1,' parameter of "').concat(Ts(n),'". Please make sure that there is not cyclic dependency among your TypeScript files, or consider using "forwardRef". For more info please visit our website https://redi.wendell.fun/docs/debug#could-not-find-dependency-registered-on');return t.call(this,i)||this}return e}(so);function xw(t){var e=t;return e[mv]||[]}function SC(t,e){var n=xw(t),r=n.find(function(i){return i.paramIndex===e});if(!r)throw new dj(e,t);return r}function Fw(t,e,n,r,i){r===void 0&&(r=wr.REQUIRED);var o={paramIndex:n,identifier:e,quantity:r,lookUp:i,withNew:!1};if(typeof e>"u")throw new Nw(t,n);var a=t;a[Vy]===a?a[mv].push(o):(a[mv]=[o],a[Vy]=a)}var Hy=new Set;function ln(t){if(Hy.has(t))throw new so('Identifier "'.concat(t,'" already exists.'));Hy.add(t);var e=function(n,r,i){Fw(n,e,i)};return e.toString=function(){return t},e[CC]=!0,e}var mj=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),fj=function(t){mj(e,t);function e(n,r,i){var o='Expect "'.concat(r,'" dependency items for id "').concat(Ts(n),'" but get ').concat(i,".");return t.call(this,o)||this}return e}(so);function $w(t,e,n){if(e===wr.OPTIONAL&&n>1||e===wr.REQUIRED&&n!==1)throw new fj(t,e,n)}function hj(t,e){return t===wr.MANY?e:e[0]}function pj(t,e,n){var r=SC(t,e);r.quantity=n}function EC(t){return function e(n){return this instanceof e?this:function(r,i,o){if(n)Fw(r,n,o,t);else{if(t===wr.REQUIRED)throw new Nw(r,o);pj(r,o,t)}}}}var gj=EC(wr.MANY),W0=EC(wr.OPTIONAL),K=EC(wr.REQUIRED);function vj(t){return!!t&&typeof t.unwrap=="function"}function bj(t){return vj(t)?t.unwrap():t}function jy(t){return!!t&&typeof t.dispose=="function"}var kw=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();function _j(t){return t.length===1}var zy=function(t){kw(e,t);function e(n,r,i){var o='Cannot find "'.concat(Ts(r),'" registered by any injector. It is the ').concat(i,'th param of "').concat(lj(n)?Ts(n):n.name,'".');return t.call(this,o)||this}return e}(so),c4=function(t){kw(e,t);function e(n){var r='Cannot find "'.concat(Ts(n),'" registered by any injector.');return t.call(this,r)||this}return e}(so),Cj=function(){function t(e){var n=this;this.dependencyMap=new Map,this.normalizeDependencies(e).map(function(r){return n.add(r[0],r[1])})}return t.prototype.add=function(e,n){typeof n>"u"&&(n={useClass:e,lazy:!1});var r=this.dependencyMap.get(e);typeof r>"u"&&(r=[],this.dependencyMap.set(e,r)),r.push(n)},t.prototype.delete=function(e){this.dependencyMap.delete(e)},t.prototype.get=function(e,n){n===void 0&&(n=wr.REQUIRED);var r=this.dependencyMap.get(e);return $w(e,n,r.length),hj(n,r)},t.prototype.has=function(e){return this.dependencyMap.has(e)},t.prototype.append=function(e){var n=this;this.normalizeDependencies(e).forEach(function(r){return n.add(r[0],r[1])})},t.prototype.dispose=function(){this.dependencyMap.clear()},t.prototype.normalizeDependencies=function(e){return e.map(function(n){var r=n[0],i;return _j(n)?i={useClass:n[0],lazy:!1}:i=n[1],[r,i]})},t}(),Sj=function(){function t(){this.resolvedDependencies=new Map}return t.prototype.add=function(e,n){var r=this.resolvedDependencies.get(e);typeof r>"u"&&(r=[],this.resolvedDependencies.set(e,r)),r.push(n)},t.prototype.has=function(e){return this.resolvedDependencies.has(e)},t.prototype.delete=function(e){if(this.resolvedDependencies.has(e)){var n=this.resolvedDependencies.get(e);n.forEach(function(r){return jy(r)?r.dispose():void 0}),this.resolvedDependencies.delete(e)}},t.prototype.get=function(e,n){n===void 0&&(n=wr.REQUIRED);var r=this.resolvedDependencies.get(e);if(!r)throw new c4(e);return $w(e,n,r.length),n===wr.MANY?r:r[0]},t.prototype.dispose=function(){Array.from(this.resolvedDependencies.values()).forEach(function(e){e.forEach(function(n){return jy(n)?n.dispose():void 0})}),this.resolvedDependencies.clear()},t}();function Ej(t,e,n){var r=SC(t,e);r.lookUp=n}function Bw(t){return function e(){return this instanceof e?this:function(n,r,i){Ej(n,i,t)}}}var yj=Bw(z1.SKIP_SELF),Dj=Bw(z1.SELF);function Rj(t,e,n){var r=SC(t,e);r.withNew=n}function Ij(t){return function e(){return this instanceof e?this:function(n,r,i){Rj(n,i,t)}}}var Aj=Ij(!0);function Tj(t){return t?t.map(function(e,n){if(!Array.isArray(e))return{paramIndex:n,identifier:e,quantity:wr.REQUIRED,withNew:!1};var r=e.slice(0,e.length-1),i=e[e.length-1],o=void 0,a=wr.REQUIRED,s=!1;return r.forEach(function(u){if(u instanceof Dj)o=z1.SELF;else if(u instanceof yj)o=z1.SKIP_SELF;else if(u instanceof W0)a=wr.OPTIONAL;else if(u instanceof gj)a=wr.MANY;else if(u instanceof Aj)s=!0;else throw new so("unknown dep modifier ".concat(u,"."))}),{paramIndex:n,identifier:i,quantity:a,lookUp:o,withNew:s}}):[]}var fv;(function(){if(typeof requestIdleCallback<"u"&&typeof cancelIdleCallback<"u")fv=function(e,n){var r=requestIdleCallback(e,typeof n=="number"?{timeout:n}:void 0),i=!1;return function(){i||(i=!0,cancelIdleCallback(r))}};else{var t=Object.freeze({didTimeout:!0,timeRemaining:function(){return 15}});fv=function(e){var n=setTimeout(function(){return e(t)}),r=!1;return function(){r||(r=!0,clearTimeout(n))}}}})();var wj=function(){function t(e){var n=this;this.didRun=!1,this.selfExecutor=function(){try{n.value=e()}catch(r){n.error=r}finally{n.didRun=!0}},this.disposeCallback=fv(function(){return n.selfExecutor()})}return t.prototype.hasRun=function(){return this.didRun},t.prototype.dispose=function(){this.disposeCallback()},t.prototype.getValue=function(){if(this.didRun||(this.dispose(),this.selfExecutor()),this.error)throw this.error;return this.value},t}(),Y0=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_h=function(){return _h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},_h.apply(this,arguments)},xl=function(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},Lj=300,Id=Symbol("$$NOT_INSTANTIATED_SYMBOL"),Oj=function(t){Y0(e,t);function e(n){return t.call(this,'Detecting cyclic dependency. The last identifier is "'.concat(Ts(n),'".'))||this}return e}(so),Pj=function(t){Y0(e,t);function e(){return t.call(this,"Injector cannot be accessed after it was disposed.")||this}return e}(so),Mj=function(t){Y0(e,t);function e(n){return t.call(this,'Async item "'.concat(Ts(n),'" returns another async item.'))||this}return e}(so),Nj=function(t){Y0(e,t);function e(n){return t.call(this,'Cannot get async item "'.concat(Ts(n),'" from sync api.'))||this}return e}(so),Wy=function(t){Y0(e,t);function e(n){return t.call(this,'Cannot add dependency "'.concat(Ts(n),'" after it is already resolved.'))||this}return e}(so),xj=function(t){Y0(e,t);function e(n){return t.call(this,'Cannot dependency dependency "'.concat(Ts(n),'" after it is already resolved.'))||this}return e}(so),wn=function(){function t(e,n){n===void 0&&(n=null),this.parent=n,this.children=[],this.resolutionOngoing=0,this.disposed=!1,this.dependencyCollection=new Cj(e||[]),this.resolvedDependencyCollection=new Sj,n&&n.children.push(this)}return t.prototype.createChild=function(e){return this.ensureInjectorNotDisposed(),new t(e,this)},t.prototype.dispose=function(){this.children.forEach(function(e){return e.dispose()}),this.children.length=0,this.dependencyCollection.dispose(),this.resolvedDependencyCollection.dispose(),this.deleteSelfFromParent(),this.disposed=!0},t.prototype.deleteSelfFromParent=function(){if(this.parent){var e=this.parent.children.indexOf(this);e>-1&&this.parent.children.splice(e,1)}},t.prototype.add=function(e){this.ensureInjectorNotDisposed();var n=e[0],r=e[1];if(this.resolvedDependencyCollection.has(n))throw new Wy(n);typeof r>"u"?this.dependencyCollection.add(n):Uy(r)||$y(r)||By(r)||ky(r)?this.dependencyCollection.add(n,r):this.resolvedDependencyCollection.add(n,r)},t.prototype.replace=function(e){this.ensureInjectorNotDisposed();var n=e[0];if(this.resolvedDependencyCollection.has(n))throw new Wy(n);this.dependencyCollection.delete(n),e.length===1?this.dependencyCollection.add(n):this.dependencyCollection.add(n,e[1])},t.prototype.delete=function(e){if(this.ensureInjectorNotDisposed(),this.resolvedDependencyCollection.has(e))throw new xj(e);this.dependencyCollection.delete(e)},t.prototype.invoke=function(e){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o={get:function(a,s,u){return n._get(a,s,u)}};return e.apply(void 0,xl([o],r,!1))},t.prototype.has=function(e){var n;return this.dependencyCollection.has(e)||((n=this.parent)===null||n===void 0?void 0:n.has(e))||!1},t.prototype.get=function(e,n,r){var i=this._get(e,n,r);if(Array.isArray(i)&&i.some(function(o){return ip(o)})||ip(i))throw new Nj(e);return i},t.prototype._get=function(e,n,r,i){this.ensureInjectorNotDisposed();var o=wr.REQUIRED;if(n===wr.REQUIRED||n===wr.OPTIONAL||n===wr.MANY?o=n:r=n,!i){var a=this.getValue(e,o,r);if(a!==Id)return a}return this.createDependency(e,o,r,!i)},t.prototype.getAsync=function(e){this.ensureInjectorNotDisposed();var n=this.getValue(e,wr.REQUIRED);if(n!==Id)return Promise.resolve(n);var r=this.createDependency(e,wr.REQUIRED);return ip(r)?r.whenReady():Promise.resolve(r)},t.prototype.createInstance=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return this.ensureInjectorNotDisposed(),this._resolveClass.apply(this,xl([e],n,!1))},t.prototype.resolveDependency=function(e,n,r){return r===void 0&&(r=!0),By(n)?this.resolveValueDependency(e,n):ky(n)?this.resolveFactory(e,n,r):$y(n)?this.resolveClass(e,n,r):this.resolveAsync(e,n)},t.prototype.resolveValueDependency=function(e,n){var r=n.useValue;return this.resolvedDependencyCollection.add(e,r),r},t.prototype.resolveClass=function(e,n,r){var i=this;r===void 0&&(r=!0);var o=n.useClass,a;if(n.lazy){var s=new wj(function(){return i._resolveClass(o)});a=new Proxy(Object.create(null),{get:function(u,l){var c;if(l in u)return u[l];if(l!=="whenReady"){var d=s.hasRun(),m=s.getValue();d||(c=n.onInstantiation)===null||c===void 0||c.call(n,m);var f=m[l];return typeof f!="function"||(f=f.bind(m),u[l]=f),f}},set:function(u,l,c){return s.getValue()[l]=c,!0}})}else a=this._resolveClass(o);return e&&r&&this.resolvedDependencyCollection.add(e,a),a},t.prototype._resolveClass=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.markNewResolution(e);for(var i=xw(e).sort(function(h,p){return h.paramIndex-p.paramIndex}).map(function(h){return _h(_h({},h),{identifier:bj(h.identifier)})}),o=[],a=0,s=i;a<s.length;a++){var u=s[a];try{var l=this._get(u.identifier,u.quantity,u.lookUp,u.withNew);o.push(l)}catch(h){throw h instanceof c4?new zy(e,u.identifier,u.paramIndex):h}}var c=xl([],n,!0),d=i.length>0?i[0].paramIndex:c.length;if(c.length!==d){console.warn("[redi]: Expect ".concat(d," custom parameter(s) of ").concat(e.toString()," but get ").concat(c.length,"."));var m=d-c.length;m>0?c=xl(xl([],c,!0),new Array(m).fill(void 0),!0):c=c.slice(0,d)}var f=new(e.bind.apply(e,xl(xl([void 0],c,!1),o,!1)));return this.markResolutionCompleted(),f},t.prototype.resolveFactory=function(e,n,r){var i;this.markNewResolution(e);for(var o=Tj(n.deps),a=[],s=0,u=o;s<u.length;s++){var l=u[s];try{var c=this._get(l.identifier,l.quantity,l.lookUp,l.withNew);a.push(c)}catch(m){throw m instanceof c4?new zy(e,l.identifier,l.paramIndex):m}}var d=n.useFactory.apply(null,a);return r&&this.resolvedDependencyCollection.add(e,d),this.markResolutionCompleted(),(i=n==null?void 0:n.onInstantiation)===null||i===void 0||i.call(n,d),d},t.prototype.resolveAsync=function(e,n){var r=this,i={__symbol:Pw,whenReady:function(){return r._resolveAsync(e,n)}};return i},t.prototype._resolveAsync=function(e,n){var r=this;return n.useAsync().then(function(i){var o=r.getValue(e);if(o!==Id)return o;var a;if(Array.isArray(i)){var s=i[1];if(Uy(s))throw new Mj(e);a=r.resolveDependency(e,s)}else Ow(i)?a=r._resolveClass(i):a=i;return r.resolvedDependencyCollection.add(e,a),a})},t.prototype.getValue=function(e,n,r){var i=this;n===void 0&&(n=wr.REQUIRED);var o=function(){return i.dependencyCollection.has(e)&&!i.resolvedDependencyCollection.has(e)?Id:i.resolvedDependencyCollection.get(e,n)},a=function(){return i.parent?i.parent.getValue(e,n):Id};return r===z1.SKIP_SELF?a():r===z1.SELF||this.resolvedDependencyCollection.has(e)||this.dependencyCollection.has(e)?o():a()},t.prototype.createDependency=function(e,n,r,i){var o=this;n===void 0&&(n=wr.REQUIRED),i===void 0&&(i=!0);var a=function(){var u=o.dependencyCollection.get(e,n),l=null;return Array.isArray(u)?l=u.map(function(c){return o.resolveDependency(e,c,i)}):u&&(l=o.resolveDependency(e,u,i)),l},s=function(){if(o.parent)return o.parent.createDependency(e,n,void 0,i);if(n===wr.OPTIONAL)return null;throw new c4(e)};return r===z1.SKIP_SELF?s():e===t?this:this.dependencyCollection.has(e)?a():s()},t.prototype.markNewResolution=function(e){if(this.resolutionOngoing+=1,this.resolutionOngoing>=Lj)throw new Oj(e)},t.prototype.markResolutionCompleted=function(){this.resolutionOngoing-=1},t.prototype.ensureInjectorNotDisposed=function(){if(this.disposed)throw new Pj},t}(),Yy=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof global<"u"&&global,Xy="REDI_GLOBAL_LOCK";Yy[Xy]?console.error(`[redi]: You are loading scripts of redi more than once! This may cause undesired behavior in your application.
Maybe your dependencies added redi as its dependency and bundled redi to its dist files. Or you import different versions of redi.
For more info please visit our website: https://redi.wendell.fun/en-US/docs/debug#import-scripts-of-redi-more-than-once`):Yy[Xy]=!0;var hv=function(t,e){return hv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},hv(t,e)};function iu(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");hv(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function Fj(t,e,n,r){function i(o){return o instanceof n?o:new n(function(a){a(o)})}return new(n||(n=Promise))(function(o,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?o(c.value):i(c.value).then(s,u)}l((r=r.apply(t,e||[])).next())})}function Uw(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(n=0)),n;)try{if(r=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){n.label=l[1];break}if(l[0]===6&&n.label<o[1]){n.label=o[1],o=l;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(l);break}o[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(c){l=[6,c],i=0}finally{r=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function _c(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function tl(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return o}function Cc(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function u0(t){return this instanceof u0?(this.v=t,this):new u0(t)}function $j(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(m){r[m]&&(i[m]=function(f){return new Promise(function(h,p){o.push([m,f,h,p])>1||s(m,f)})})}function s(m,f){try{u(r[m](f))}catch(h){d(o[0][3],h)}}function u(m){m.value instanceof u0?Promise.resolve(m.value.v).then(l,c):d(o[0][2],m)}function l(m){s("next",m)}function c(m){s("throw",m)}function d(m,f){m(f),o.shift(),o.length&&s(o[0][0],o[0][1])}}function kj(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof _c=="function"?_c(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(a){return new Promise(function(s,u){a=t[o](a),i(s,u,a.done,a.value)})}}function i(o,a,s,u){Promise.resolve(u).then(function(l){o({value:l,done:s})},a)}}function hr(t){return typeof t=="function"}function Vw(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var op=Vw(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function J6(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var X0=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=_c(a),u=s.next();!u.done;u=s.next()){var l=u.value;l.remove(this)}}catch(p){e={error:p}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}else a.remove(this);var c=this.initialTeardown;if(hr(c))try{c()}catch(p){o=p instanceof op?p.errors:[p]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var m=_c(d),f=m.next();!f.done;f=m.next()){var h=f.value;try{qy(h)}catch(p){o=o??[],p instanceof op?o=Cc(Cc([],tl(o)),tl(p.errors)):o.push(p)}}}catch(p){r={error:p}}finally{try{f&&!f.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}}if(o)throw new op(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)qy(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&J6(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&J6(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Hw=X0.EMPTY;function jw(t){return t instanceof X0||t&&"closed"in t&&hr(t.remove)&&hr(t.add)&&hr(t.unsubscribe)}function qy(t){hr(t)?t():t.unsubscribe()}var zw={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},pv={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=pv.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,Cc([t,e],tl(n))):setTimeout.apply(void 0,Cc([t,e],tl(n)))},clearTimeout:function(t){var e=pv.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Ww(t){pv.setTimeout(function(){throw t})}function gv(){}function d4(t){t()}var yC=function(t){iu(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,jw(n)&&n.add(r)):r.destination=Hj,r}return e.create=function(n,r,i){return new vv(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(X0),Bj=Function.prototype.bind;function ap(t,e){return Bj.call(t,e)}var Uj=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Gf(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Gf(r)}else Gf(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Gf(n)}},t}(),vv=function(t){iu(e,t);function e(n,r,i){var o=t.call(this)||this,a;if(hr(n)||!n)a={next:n??void 0,error:r??void 0,complete:i??void 0};else{var s;o&&zw.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=function(){return o.unsubscribe()},a={next:n.next&&ap(n.next,s),error:n.error&&ap(n.error,s),complete:n.complete&&ap(n.complete,s)}):a=n}return o.destination=new Uj(a),o}return e}(yC);function Gf(t){Ww(t)}function Vj(t){throw t}var Hj={closed:!0,next:gv,error:Vj,complete:gv},DC=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function q0(t){return t}function jj(t){return t.length===0?q0:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var Wt=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,o=Wj(e)?e:new vv(e,n,r);return d4(function(){var a=i,s=a.operator,u=a.source;o.add(s?s.call(o,u):u?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=Gy(n),new n(function(i,o){var a=new vv({next:function(s){try{e(s)}catch(u){o(u),a.unsubscribe()}},error:o,complete:i});r.subscribe(a)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[DC]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return jj(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=Gy(e),new e(function(r,i){var o;n.subscribe(function(a){return o=a},function(a){return i(a)},function(){return r(o)})})},t.create=function(e){return new t(e)},t}();function Gy(t){var e;return(e=t??zw.Promise)!==null&&e!==void 0?e:Promise}function zj(t){return t&&hr(t.next)&&hr(t.error)&&hr(t.complete)}function Wj(t){return t&&t instanceof yC||zj(t)&&jw(t)}function Yj(t){return hr(t==null?void 0:t.lift)}function ga(t){return function(e){if(Yj(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Yo(t,e,n,r,i){return new Xj(t,e,n,r,i)}var Xj=function(t){iu(e,t);function e(n,r,i,o,a,s){var u=t.call(this,n)||this;return u.onFinalize=a,u.shouldUnsubscribe=s,u._next=r?function(l){try{r(l)}catch(c){n.error(c)}}:t.prototype._next,u._error=o?function(l){try{o(l)}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._error,u._complete=i?function(){try{i()}catch(l){n.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,u}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(yC),qj=Vw(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),an=function(t){iu(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new Ky(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new qj},e.prototype.next=function(n){var r=this;d4(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var a=_c(r.currentObservers),s=a.next();!s.done;s=a.next()){var u=s.value;u.next(n)}}catch(l){i={error:l}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;d4(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;d4(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,o=i.hasError,a=i.isStopped,s=i.observers;return o||a?Hw:(this.currentObservers=null,s.push(n),new X0(function(){r.currentObservers=null,J6(s,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,o=r.thrownError,a=r.isStopped;i?n.error(o):a&&n.complete()},e.prototype.asObservable=function(){var n=new Wt;return n.source=this,n},e.create=function(n,r){return new Ky(n,r)},e}(Wt),Ky=function(t){iu(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:Hw},e}(an),dn=function(t){iu(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,o=n._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(an),Yw={now:function(){return(Yw.delegate||Date).now()},delegate:void 0},Gj=function(t){iu(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e}(X0),Ch={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Ch.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,Cc([t,e],tl(n))):setInterval.apply(void 0,Cc([t,e],tl(n)))},clearInterval:function(t){var e=Ch.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},Kj=function(t){iu(e,t);function e(n,r){var i=t.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var o=this.id,a=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(a,o,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(a,this.id,r),this},e.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),Ch.setInterval(n.flush.bind(n,this),i)},e.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&Ch.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var i=!1,o;try{this.work(n)}catch(a){i=!0,o=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,J6(o,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(Gj),Zy=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=Yw.now,t}(),Zj=function(t){iu(e,t);function e(n,r){r===void 0&&(r=Zy.now);var i=t.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},e}(Zy),Xw=new Zj(Kj),Qj=new Wt(function(t){return t.complete()});function Jj(t){return t&&hr(t.schedule)}function RC(t){return t[t.length-1]}function ez(t){return hr(RC(t))?t.pop():void 0}function G0(t){return Jj(RC(t))?t.pop():void 0}function tz(t,e){return typeof RC(t)=="number"?t.pop():e}var IC=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function qw(t){return hr(t==null?void 0:t.then)}function Gw(t){return hr(t[DC])}function Kw(t){return Symbol.asyncIterator&&hr(t==null?void 0:t[Symbol.asyncIterator])}function Zw(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function nz(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Qw=nz();function Jw(t){return hr(t==null?void 0:t[Qw])}function eL(t){return $j(this,arguments,function(){var n,r,i,o;return Uw(this,function(a){switch(a.label){case 0:n=t.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,u0(n.read())];case 3:return r=a.sent(),i=r.value,o=r.done,o?[4,u0(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,u0(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function tL(t){return hr(t==null?void 0:t.getReader)}function ou(t){if(t instanceof Wt)return t;if(t!=null){if(Gw(t))return rz(t);if(IC(t))return iz(t);if(qw(t))return oz(t);if(Kw(t))return nL(t);if(Jw(t))return az(t);if(tL(t))return sz(t)}throw Zw(t)}function rz(t){return new Wt(function(e){var n=t[DC]();if(hr(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function iz(t){return new Wt(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function oz(t){return new Wt(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,Ww)})}function az(t){return new Wt(function(e){var n,r;try{for(var i=_c(t),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.next(a),e.closed)return}}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function nL(t){return new Wt(function(e){uz(t,e).catch(function(n){return e.error(n)})})}function sz(t){return nL(eL(t))}function uz(t,e){var n,r,i,o;return Fj(this,void 0,void 0,function(){var a,s;return Uw(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=kj(t),u.label=1;case 1:return[4,n.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(a=r.value,e.next(a),e.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=u.sent(),i={error:s},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function Cs(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function rL(t,e){return e===void 0&&(e=0),ga(function(n,r){n.subscribe(Yo(r,function(i){return Cs(r,t,function(){return r.next(i)},e)},function(){return Cs(r,t,function(){return r.complete()},e)},function(i){return Cs(r,t,function(){return r.error(i)},e)}))})}function iL(t,e){return e===void 0&&(e=0),ga(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function lz(t,e){return ou(t).pipe(iL(e),rL(e))}function cz(t,e){return ou(t).pipe(iL(e),rL(e))}function dz(t,e){return new Wt(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function mz(t,e){return new Wt(function(n){var r;return Cs(n,e,function(){r=t[Qw](),Cs(n,e,function(){var i,o,a;try{i=r.next(),o=i.value,a=i.done}catch(s){n.error(s);return}a?n.complete():n.next(o)},0,!0)}),function(){return hr(r==null?void 0:r.return)&&r.return()}})}function oL(t,e){if(!t)throw new Error("Iterable cannot be null");return new Wt(function(n){Cs(n,e,function(){var r=t[Symbol.asyncIterator]();Cs(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function fz(t,e){return oL(eL(t),e)}function hz(t,e){if(t!=null){if(Gw(t))return lz(t,e);if(IC(t))return dz(t,e);if(qw(t))return cz(t,e);if(Kw(t))return oL(t,e);if(Jw(t))return mz(t,e);if(tL(t))return fz(t,e)}throw Zw(t)}function Ym(t,e){return e?hz(t,e):ou(t)}function Kf(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=G0(t);return Ym(t,n)}function AC(t){return!!t&&(t instanceof Wt||hr(t.lift)&&hr(t.subscribe))}function ja(t,e){return ga(function(n,r){var i=0;n.subscribe(Yo(r,function(o){r.next(t.call(e,o,i++))}))})}var pz=Array.isArray;function gz(t,e){return pz(e)?t.apply(void 0,Cc([],tl(e))):t(e)}function aL(t){return ja(function(e){return gz(t,e)})}var vz=Array.isArray,bz=Object.getPrototypeOf,_z=Object.prototype,Cz=Object.keys;function Sz(t){if(t.length===1){var e=t[0];if(vz(e))return{args:e,keys:null};if(Ez(e)){var n=Cz(e);return{args:n.map(function(r){return e[r]}),keys:n}}}return{args:t,keys:null}}function Ez(t){return t&&typeof t=="object"&&bz(t)===_z}function yz(t,e){return t.reduce(function(n,r,i){return n[r]=e[i],n},{})}function TC(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=G0(t),r=ez(t),i=Sz(t),o=i.args,a=i.keys;if(o.length===0)return Ym([],n);var s=new Wt(Dz(o,n,a?function(u){return yz(a,u)}:q0));return r?s.pipe(aL(r)):s}function Dz(t,e,n){return n===void 0&&(n=q0),function(r){Qy(e,function(){for(var i=t.length,o=new Array(i),a=i,s=i,u=function(c){Qy(e,function(){var d=Ym(t[c],e),m=!1;d.subscribe(Yo(r,function(f){o[c]=f,m||(m=!0,s--),s||r.next(n(o.slice()))},function(){--a||r.complete()}))},r)},l=0;l<i;l++)u(l)},r)}}function Qy(t,e,n){t?Cs(n,t,e):e()}function Rz(t,e,n,r,i,o,a,s){var u=[],l=0,c=0,d=!1,m=function(){d&&!u.length&&!l&&e.complete()},f=function(p){return l<r?h(p):u.push(p)},h=function(p){o&&e.next(p),l++;var v=!1;ou(n(p,c++)).subscribe(Yo(e,function(g){i==null||i(g),o?f(g):e.next(g)},function(){v=!0},void 0,function(){if(v)try{l--;for(var g=function(){var b=u.shift();a?Cs(e,a,function(){return h(b)}):h(b)};u.length&&l<r;)g();m()}catch(b){e.error(b)}}))};return t.subscribe(Yo(e,f,function(){d=!0,m()})),function(){s==null||s()}}function wC(t,e,n){return n===void 0&&(n=1/0),hr(e)?wC(function(r,i){return ja(function(o,a){return e(r,o,i,a)})(ou(t(r,i)))},n):(typeof e=="number"&&(n=e),ga(function(r,i){return Rz(r,i,t,n)}))}function sL(t){return t===void 0&&(t=1/0),wC(q0,t)}function Iz(){return sL(1)}function Jy(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Iz()(Ym(t,G0(t)))}var Az=["addListener","removeListener"],Tz=["addEventListener","removeEventListener"],wz=["on","off"];function bv(t,e,n,r){if(hr(n)&&(r=n,n=void 0),r)return bv(t,e,n).pipe(aL(r));var i=tl(Pz(t)?Tz.map(function(s){return function(u){return t[s](e,u,n)}}):Lz(t)?Az.map(eD(t,e)):Oz(t)?wz.map(eD(t,e)):[],2),o=i[0],a=i[1];if(!o&&IC(t))return wC(function(s){return bv(s,e,n)})(ou(t));if(!o)throw new TypeError("Invalid event target");return new Wt(function(s){var u=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return s.next(1<l.length?l:l[0])};return o(u),function(){return a(u)}})}function eD(t,e){return function(n){return function(r){return t[n](e,r)}}}function Lz(t){return hr(t.addListener)&&hr(t.removeListener)}function Oz(t){return hr(t.on)&&hr(t.off)}function Pz(t){return hr(t.addEventListener)&&hr(t.removeEventListener)}function Q9(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=G0(t),r=tz(t,1/0),i=t;return i.length?i.length===1?ou(i[0]):sL(r)(Ym(i,n)):Qj}function Sh(t,e){return ga(function(n,r){var i=0;n.subscribe(Yo(r,function(o){return t.call(e,o,i++)&&r.next(o)}))})}function Mz(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=(e=G0(r))!==null&&e!==void 0?e:Xw,a=(n=r[0])!==null&&n!==void 0?n:null,s=r[1]||1/0;return ga(function(u,l){var c=[],d=!1,m=function(p){var v=p.buffer,g=p.subs;g.unsubscribe(),J6(c,p),l.next(v),d&&f()},f=function(){if(c){var p=new X0;l.add(p);var v=[],g={buffer:v,subs:p};c.push(g),Cs(p,o,function(){return m(g)},t)}};a!==null&&a>=0?Cs(l,o,f,a,!0):d=!0,f();var h=Yo(l,function(p){var v,g,b=c.slice();try{for(var C=_c(b),S=C.next();!S.done;S=C.next()){var E=S.value,y=E.buffer;y.push(p),s<=y.length&&m(E)}}catch(D){v={error:D}}finally{try{S&&!S.done&&(g=C.return)&&g.call(C)}finally{if(v)throw v.error}}},function(){for(;c!=null&&c.length;)l.next(c.shift().buffer);h==null||h.unsubscribe(),l.complete(),l.unsubscribe()},void 0,function(){return c=null});u.subscribe(h)})}function LC(t,e){return e===void 0&&(e=Xw),ga(function(n,r){var i=null,o=null,a=null,s=function(){if(i){i.unsubscribe(),i=null;var l=o;o=null,r.next(l)}};function u(){var l=a+t,c=e.now();if(c<l){i=this.schedule(void 0,l-c),r.add(i);return}s()}n.subscribe(Yo(r,function(l){o=l,a=e.now(),i||(i=e.schedule(u,t),r.add(i))},function(){s(),r.complete()},void 0,function(){o=i=null}))})}function OC(t,e){return e===void 0&&(e=q0),t=t??Nz,ga(function(n,r){var i,o=!0;n.subscribe(Yo(r,function(a){var s=e(a);(o||!t(i,s))&&(o=!1,i=s,r.next(a))}))})}function Nz(t,e){return t===e}function xz(){return ga(function(t,e){var n,r=!1;t.subscribe(Yo(e,function(i){var o=n;n=i,r&&e.next([o,i]),r=!0}))})}function Fz(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=G0(t);return ga(function(r,i){(n?Jy(t,r,n):Jy(t,r)).subscribe(i)})}function PC(t,e){return ga(function(n,r){var i=null,o=0,a=!1,s=function(){return a&&!i&&r.complete()};n.subscribe(Yo(r,function(u){i==null||i.unsubscribe();var l=0,c=o++;ou(t(u,c)).subscribe(i=Yo(r,function(d){return r.next(e?e(u,d,c,l++):d)},function(){i=null,s()}))},function(){a=!0,s()}))})}function Fi(t){return ga(function(e,n){ou(t).subscribe(Yo(n,function(){return n.complete()},gv)),!n.closed&&e.subscribe(n)})}function $z(t,e,n){var r=hr(t)||e||n?{next:t,error:e,complete:n}:t;return r?ga(function(i,o){var a;(a=r.subscribe)===null||a===void 0||a.call(r);var s=!0;i.subscribe(Yo(o,function(u){var l;(l=r.next)===null||l===void 0||l.call(r,u),o.next(u)},function(){var u;s=!1,(u=r.complete)===null||u===void 0||u.call(r),o.complete()},function(u){var l;s=!1,(l=r.error)===null||l===void 0||l.call(r,u),o.error(u)},function(){var u,l;s&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):q0}var kz=Object.defineProperty,Bz=(t,e,n)=>e in t?kz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ge=(t,e,n)=>(Bz(t,typeof e!="symbol"?e+"":e,n),n);function Uz(){Vz()}const Zf=typeof global<"u"?global:typeof self<"u"?self:window;function Vz(){typeof Zf.requestIdleCallback!="function"&&(Zf.requestIdleCallback=function(t){const e=Date.now();return setTimeout(function(){const n=Math.max(0,50-(Date.now()-e));t({didTimeout:n===0,timeRemaining(){return n}})},1)}),typeof Zf.cancelIdleCallback!="function"&&(Zf.cancelIdleCallback=function(t){clearTimeout(t)})}let J9=class uL{constructor(){ge(this,"_data",[])}static create(){return new uL}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const n=this._data.indexOf(e);this._data.splice(n,1)}getData(){return this._data}};var Ir=(t=>(t[t.Univer=0]="Univer",t[t.Doc=1]="Doc",t[t.Sheet=2]="Sheet",t[t.Slide=3]="Slide",t))(Ir||{});let b1=class{constructor(e){ge(this,"_name"),this._name=e}onStarting(e){}onReady(){}onRendered(){}onSteady(){}onDestroy(){}getPluginName(){return this._name}};ge(b1,"type",0);let Hz=class{constructor(){ge(this,"_plugins",[])}addPlugin(e){this._plugins.push(e)}removePlugins(){const e=this._plugins.slice();return this._plugins.length=0,e}forEachPlugin(e){this._plugins.forEach(e)}},jz=class{constructor(){ge(this,"_pluginsRegisteredByBusiness",new Map)}registerPlugin(e,n){const r=e.type;this._pluginsRegisteredByBusiness.has(r)||this._pluginsRegisteredByBusiness.set(r,[]),this._pluginsRegisteredByBusiness.get(r).push({plugin:e,options:n})}getRegisterPlugins(e){return this._pluginsRegisteredByBusiness.get(e)||[]}clearPluginsOfType(e){this._pluginsRegisteredByBusiness.delete(e)}};function r1(t,e){const n=t.indexOf(e);return n>-1?(t.splice(n,1),!0):!1}function zz(t,e){for(let n=t.length-1;n>-1;n--){const r=t[n];if(e(r,n))return r}return null}function Wz(t){for(const[e,n]of t.entries())try{if(!n())return{index:e,result:!1}}catch(r){return{index:e,result:!1,error:r}}return{result:!0,index:-1}}function tD(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nD(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return o}function rD(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function I6(t){return typeof t=="function"}function Yz(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var sp=Yz(function(t){return function(e){t(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function iD(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var lL=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=tD(a),u=s.next();!u.done;u=s.next()){var l=u.value;l.remove(this)}}catch(p){e={error:p}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}else a.remove(this);var c=this.initialTeardown;if(I6(c))try{c()}catch(p){o=p instanceof sp?p.errors:[p]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var m=tD(d),f=m.next();!f.done;f=m.next()){var h=f.value;try{oD(h)}catch(p){o=o??[],p instanceof sp?o=rD(rD([],nD(o)),nD(p.errors)):o.push(p)}}}catch(p){r={error:p}}finally{try{f&&!f.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}}if(o)throw new sp(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)oD(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&iD(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&iD(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}();lL.EMPTY;function cL(t){return t instanceof lL||t&&"closed"in t&&I6(t.remove)&&I6(t.add)&&I6(t.unsubscribe)}function oD(t){I6(t)?t():t.unsubscribe()}let Xz=class{constructor(e=!1){ge(this,"skipNextObservers"),ge(this,"lastReturnValue"),ge(this,"isStopPropagation",!1),this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}};function qz(t){return t instanceof dL}let dL=class{constructor(e,n){ge(this,"_willBeUnregistered",!1),ge(this,"unregisterOnNextCall",!1),this.callback=e,this.observable=n}dispose(){this.observable.remove(this)}},Vn=class mL{constructor(e){ge(this,"_observers",new Array),ge(this,"_eventState"),ge(this,"_onObserverAdded"),this._eventState=new Xz,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,n=!1,r=!1){if(!e)return null;const i=new dL(e,this);return i.unregisterOnNextCall=r,n?this._observers.unshift(i):this._observers.push(i),this._onObserverAdded&&this._onObserverAdded(i),i}addOnce(e){return this.add(e,void 0,!0)}remove(e){return e&&this._observers.indexOf(e)!==-1?(this._deferUnregister(e),!0):!1}removeCallback(e){for(let n=0;n<this._observers.length;n++){const r=this._observers[n];if(!r._willBeUnregistered&&r.callback===e)return this._deferUnregister(r),!0}return!1}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const n=this._eventState;n.skipNextObservers=!1,n.lastReturnValue=e,n.isStopPropagation=!1;let r=!1;for(let i=0;i<this._observers.length;i++){const o=this._observers[i];if(!o._willBeUnregistered&&(n.lastReturnValue=o.callback(e,n),o.unregisterOnNextCall&&this._deferUnregister(o),n.isStopPropagation&&(r=!0),n.skipNextObservers))return{lastReturnValue:n.lastReturnValue,stopPropagation:r}}return{lastReturnValue:n.lastReturnValue,stopPropagation:r}}notifyObserversWithPromise(e){let n=Promise.resolve(e);if(!this._observers.length)return n;const r=this._eventState;r.skipNextObservers=!1;for(let i=0;i<this._observers.length;i++){const o=this._observers[i];r.skipNextObservers||o._willBeUnregistered||(n=n.then(()=>o.callback(e,r)),o.unregisterOnNextCall&&this._deferUnregister(o))}return n.then(()=>e)}notifyObserver(e,n){if(e._willBeUnregistered)return;const r=this._eventState;return r.skipNextObservers=!1,e.callback(n,r),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new mL;return e._observers=this._observers.slice(0),e}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0)}_remove(e){if(!e)return!1;const n=this._observers.indexOf(e);return n!==-1?(this._observers.splice(n,1),!0):!1}};function je(t){let e=!1;return cL(t)?{dispose:()=>{e||(e=!0,t.unsubscribe())}}:qz(t)?{dispose:()=>{e||(e=!0,t.dispose())}}:{dispose:()=>{e||(e=!0,t())}}}let ws=class{constructor(){ge(this,"_disposables",new Set)}add(e){return this._disposables.add(e),{dispose:()=>{e.dispose(),this._disposables.delete(e)}}}dispose(){this._disposables.forEach(e=>{e.dispose(),this._disposables.delete(e)})}},We=class{constructor(){ge(this,"_disposed",!1),ge(this,"_collection",new ws)}disposeWithMe(e){const n=cL(e)?je(e):e;return this._collection.add(n)}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}},Ro=class extends We{constructor(){super(...arguments),ge(this,"dispose$",new an)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}};const pr=ln("univer.context-service");let Gz=class extends We{constructor(){super(...arguments),ge(this,"_contextChanged$",new an),ge(this,"contextChanged$",this._contextChanged$.asObservable()),ge(this,"_contextMap",new Map)}dispose(){super.dispose(),this._contextChanged$.complete()}getContextValue(e){var n;return(n=this._contextMap.get(e))!=null?n:!1}setContextValue(e,n){this._contextMap.set(e,n),this._contextChanged$.next({[e]:n})}subscribeContextValue$(e){return new Wt(n=>{const r=this._contextChanged$.pipe(Sh(i=>typeof i[e]<"u")).subscribe(i=>n.next(i[e]));return this._contextMap.has(e)&&n.next(this._contextMap.get(e)),()=>r.unsubscribe()})}};const oo=ln("univer.log");let Kz=class extends We{constructor(){super(...arguments),ge(this,"_logLevel",3)}debug(...e){this._logLevel>=4&&this._log(console.debug,...e)}log(...e){this._logLevel>=3&&this._log(console.log,...e)}warn(...e){this._logLevel>=2&&this._log(console.warn,...e)}error(...e){this._logLevel>=1&&this._log(console.error,...e)}setLogLevel(e){this._logLevel=e}_log(e,...n){const r=n[0];/^\[(.*?)\]/g.test(r)?e(`\x1B[97;104m${r}\x1B[0m`,...n.slice(1)):e(...n)}};var Zz=Object.defineProperty,Qz=Object.getOwnPropertyDescriptor,Jz=(t,e,n,r)=>{for(var i=r>1?void 0:r?Qz(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Zz(e,n,i),i},aD=(t,e)=>(n,r)=>e(n,r,t),ue=(t=>(t[t.COMMAND=0]="COMMAND",t[t.OPERATION=1]="OPERATION",t[t.MUTATION=2]="MUTATION",t))(ue||{});const se=ln("anywhere.command-service");let eW=class{constructor(){ge(this,"_commands",new Map)}registerCommand(e){if(this._commands.has(e.id))throw new Error(`[CommandRegistry]: command "${e.id}" has been registered before.`);return this._commands.set(e.id,e),je(()=>{var n;this._commands.delete(e.id),(n=e.onDispose)==null||n.call(e)})}getCommand(e){return this._commands.has(e)?[this._commands.get(e)]:null}},_v=class{constructor(e,n){ge(this,"_commandRegistry"),ge(this,"_beforeCommandExecutionListeners",[]),ge(this,"_commandExecutedListeners",[]),ge(this,"_multiCommandDisposables",new Map),ge(this,"_commandExecutingLevel",0),ge(this,"_commandExecutionStack",[]),this._injector=e,this._logService=n,this._commandRegistry=new eW,this._registerCommand(e5)}registerCommand(e){return this._registerCommand(e)}registerMultipleCommand(e){return this._registerMultiCommand(e)}beforeCommandExecuted(e){if(this._beforeCommandExecutionListeners.indexOf(e)===-1)return this._beforeCommandExecutionListeners.push(e),je(()=>{const n=this._beforeCommandExecutionListeners.indexOf(e);this._beforeCommandExecutionListeners.splice(n,1)});throw new Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(e){if(this._commandExecutedListeners.indexOf(e)===-1)return this._commandExecutedListeners.push(e),je(()=>{const n=this._commandExecutedListeners.indexOf(e);this._commandExecutedListeners.splice(n,1)});throw new Error("[CommandService]: could not add a listener twice.")}async executeCommand(e,n,r){const i=this._commandRegistry.getCommand(e);if(i){const[o]=i,a={id:o.id,type:o.type,params:n},s=this._pushCommandExecutionStack(a);this._beforeCommandExecutionListeners.forEach(l=>l(a,r));const u=await this._execute(o,n);return this._commandExecutedListeners.forEach(l=>l(a,r)),s.dispose(),u}throw new Error(`[CommandService]: command "${e}" is not registered.`)}syncExecuteCommand(e,n,r){var i;const o=this._commandRegistry.getCommand(e);if(o){const[a]=o,s={id:a.id,type:a.type,params:n};if(a.type===2){const c=zz(this._commandExecutionStack,d=>d.type===0);c&&(s.params=(i=s.params)!=null?i:{},s.params.trigger=c.id)}const u=this._pushCommandExecutionStack(s);this._beforeCommandExecutionListeners.forEach(c=>c(s,r));const l=this._syncExecute(a,n);return this._commandExecutedListeners.forEach(c=>c(s,r)),u.dispose(),l}throw new Error(`[CommandService]: command "${e}" is not registered.`)}_pushCommandExecutionStack(e){return this._commandExecutionStack.push(e),je(()=>r1(this._commandExecutionStack,e))}_registerCommand(e){return this._commandRegistry.registerCommand(e)}_registerMultiCommand(e){const n=this._commandRegistry.getCommand(e.id);let r;if(n){if(n[0].multi!==!0)throw new Error("Command has registered as a single command.");r=n[0]}else{const o=new ws;r=new tW(e.id),o.add(this._commandRegistry.registerCommand(r)),o.add(je(()=>{this._multiCommandDisposables.delete(e.id)})),this._multiCommandDisposables.set(e.id,o)}const i=r.registerImplementation(e);return je(()=>{var o;i.dispose(),r.hasImplementations()||(o=this._multiCommandDisposables.get(e.id))==null||o.dispose()})}async _execute(e,n){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${e.id}"`),this._commandExecutingLevel++;let r;try{r=await this._injector.invoke(e.handler,n),this._commandExecutingLevel--}catch(i){throw r=!1,this._commandExecutingLevel=0,i}return r}_syncExecute(e,n){this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${e.id}".`),this._commandExecutingLevel++;let r;try{if(r=this._injector.invoke(e.handler,n),r instanceof Promise)throw new TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(i){throw r=!1,this._commandExecutingLevel=0,i}return r}};_v=Jz([aD(0,K(wn)),aD(1,oo)],_v);let tW=class{constructor(e){ge(this,"name"),ge(this,"multi",!0),ge(this,"type",0),ge(this,"priority",0),ge(this,"_implementations",[]),ge(this,"handler",async(n,r)=>{if(!this._implementations.length)return!1;const i=n.get(oo),o=n.get(pr),a=n.get(wn);for(const s of this._implementations){const u=s.command.preconditions;if((!u||u&&u(o))&&(i.debug("[MultiCommand]",`executing implementation "${s.command.name}".`),await a.invoke(s.command.handler,r)))return!0}return!1}),this.id=e,this.name=e}registerImplementation(e){const n={command:e};return this._implementations.push(n),this._implementations.sort((r,i)=>i.command.priority-r.command.priority),je(()=>{var r;const i=this._implementations.indexOf(n);this._implementations.splice(i,1),(r=e.onDispose)==null||r.call(e)})}hasImplementations(){return this._implementations.length>0}};function lr(t,e,n){const r=t.map(i=>()=>e.syncExecuteCommand(i.id,i.params,n));return Wz(r)}const e5={id:"nil",type:0,handler:()=>!0},K0=ln("univer.config-service");let nW=class{constructor(){ge(this,"_config",new Map)}getConfig(e){return this._config.get(e)}setConfig(e,n){this._config.set(e,n)}deleteConfig(e){this._config.delete(e)}},Z0=class extends We{constructor(){super(...arguments),ge(this,"_error$",new an),ge(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(e){this._error$.next({errorKey:e})}};const rW="__default_document_sub_component_id20231101__";let iW=class{constructor(){ge(this,"_managerInfo",new Map),ge(this,"_remove$",new an),ge(this,"remove$",this._remove$.asObservable()),ge(this,"_andOrUpdate$",new an),ge(this,"andOrUpdate$",this._andOrUpdate$.asObservable()),ge(this,"_pluginUpdate$",new an),ge(this,"pluginUpdate$",this._pluginUpdate$.asObservable())}getFloatObject(e){return this._getFloatingObject(e)}getFloatObjects(e){return this._getFloatingObjects(e)}dispose(){this._remove$.complete(),this._andOrUpdate$.complete(),this._pluginUpdate$.complete(),this._managerInfo.clear()}clear(e){const n=this._clearByParam(e);this._remove$.next(n)}addOrUpdate(e){const n=this._addByParam(e);this._andOrUpdate$.next(n)}BatchAddOrUpdate(e){const n=[];e.forEach(r=>{n.push(...this._addByParam(r))}),this._andOrUpdate$.next(n)}remove(e){const n=this._removeByParam(e);this._remove$.next(n)}pluginUpdateRefresh(e){this._pluginUpdate$.next(e)}_getFloatingObjects(e){var n;if(e==null)return;const{unitId:r,subUnitId:i}=e;return(n=this._managerInfo.get(r))==null?void 0:n.get(i)}_getFloatingObject(e){var n,r;if(e==null)return;const{unitId:i,subUnitId:o,floatingObjectId:a}=e;return(r=(n=this._managerInfo.get(i))==null?void 0:n.get(o))==null?void 0:r.get(a)}_addByParam(e){const{unitId:n,subUnitId:r,floatingObject:i,floatingObjectId:o}=e;this._managerInfo.has(n)||this._managerInfo.set(n,new Map);const a=this._managerInfo.get(n);return a.has(r)||a.set(r,new Map),a.get(r).set(o,i),[{unitId:n,subUnitId:r,floatingObjectId:o,floatingObject:i}]}_clearByParam(e){const n=this._getFloatingObjects(e),{unitId:r,subUnitId:i}=e,o=[];return n==null||n.forEach((a,s)=>{o.push({unitId:r,subUnitId:i,floatingObjectId:s,floatingObject:a})}),n==null||n.clear(),o}_removeByParam(e){const n=this._getFloatingObjects(e),r=n==null?void 0:n.get(e.floatingObjectId);return r==null?[]:(n==null||n.delete(e.floatingObjectId),[{...e,floatingObject:r}])}};const fL=ln("univer.floating-object.service");let Xm=class{constructor(){ge(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(e){this.cursor+=e}moveCursorTo(e){this.cursor=e}};function oW(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=Math.floor((r+n)/2);if(e<t[i]&&(i===0||e>=t[i-1]))return i;if(e>=t[i])n=i+1;else if(e<t[i])r=i-1;else return-1}return-1}function aW(t,e){let n=0,r=0,i=0,o=-1,a=t.length-1;for(;n<t.length&&a>=0&&a>=n;){if(r=t[a],a===0?i=0:i=t[a-1],e>=i&&e<=r){o=a;break}if(r=t[n],n===0?i=0:i=t[n-1],e>=i&&e<r){o=n;break}n++,a--}return o}function hu(t,e){let n=t.length-1;return e<0?-1:e<t[0]?0:e>t[t.length-1]?Number.POSITIVE_INFINITY:(t.length<40||e<=t[20]||e>=t[n-20]?n=aW(t,e):n=oW(t,e),n)}var Lt=(t=>(t[t.NONE=0]="NONE",t[t.THIN=1]="THIN",t[t.HAIR=2]="HAIR",t[t.DOTTED=3]="DOTTED",t[t.DASHED=4]="DASHED",t[t.DASH_DOT=5]="DASH_DOT",t[t.DASH_DOT_DOT=6]="DASH_DOT_DOT",t[t.DOUBLE=7]="DOUBLE",t[t.MEDIUM=8]="MEDIUM",t[t.MEDIUM_DASHED=9]="MEDIUM_DASHED",t[t.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",t[t.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",t[t.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",t[t.THICK=13]="THICK",t))(Lt||{}),ai=(t=>(t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right",t.NONE="none",t.ALL="all",t.OUTSIDE="outside",t.INSIDE="inside",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.TLBR="tlbr",t.TLBC_TLMR="tlbc_tlmr",t.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",t.BLTR="bl_tr",t.MLTR_BCTR="mltr_bctr",t))(ai||{}),us=(t=>(t[t.UNSUPPORTED=0]="UNSUPPORTED",t[t.RGB=1]="RGB",t[t.HEX=2]="HEX",t[t.THEME=3]="THEME",t))(us||{}),Tr=(t=>(t[t.COLUMNS=0]="COLUMNS",t[t.ROWS=1]="ROWS",t))(Tr||{}),ye=(t=>(t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t))(ye||{});function hL(t){switch(t){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}var t5=(t=>(t.EN_US="enUS",t.ZH_CN="zhCN",t))(t5||{}),m4=(t=>(t[t.GRID=0]="GRID",t[t.KANBAN=1]="KANBAN",t[t.GANTT=2]="GANTT",t))(m4||{}),Eh=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",t))(Eh||{}),Aa=(t=>(t[t.DASH=0]="DASH",t[t.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",t[t.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",t[t.DASHED_HEAVY=3]="DASHED_HEAVY",t[t.DASH_LONG=4]="DASH_LONG",t[t.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",t[t.DOT_DASH=6]="DOT_DASH",t[t.DOT_DOT_DASH=7]="DOT_DOT_DASH",t[t.DOTTED=8]="DOTTED",t[t.DOTTED_HEAVY=9]="DOTTED_HEAVY",t[t.DOUBLE=10]="DOUBLE",t[t.NONE=11]="NONE",t[t.SINGLE=12]="SINGLE",t[t.THICK=13]="THICK",t[t.WAVE=14]="WAVE",t[t.WAVY_DOUBLE=15]="WAVY_DOUBLE",t[t.WAVY_HEAVY=16]="WAVY_HEAVY",t[t.WORDS=17]="WORDS",t))(Aa||{}),Zn=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT=1]="LEFT",t[t.CENTER=2]="CENTER",t[t.RIGHT=3]="RIGHT",t[t.JUSTIFIED=4]="JUSTIFIED",t))(Zn||{}),li=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TOP=1]="TOP",t[t.MIDDLE=2]="MIDDLE",t[t.BOTTOM=3]="BOTTOM",t))(li||{}),Ar=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.OVERFLOW=1]="OVERFLOW",t[t.CLIP=2]="CLIP",t[t.WRAP=3]="WRAP",t))(Ar||{}),S0=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ITALIC=1]="ITALIC",t))(S0||{}),E0=(t=>(t[t.NORMAL=0]="NORMAL",t[t.BOLD=1]="BOLD",t))(E0||{}),yr=(t=>(t[t.NORMAL=1]="NORMAL",t[t.SUBSCRIPT=2]="SUBSCRIPT",t[t.SUPERSCRIPT=3]="SUPERSCRIPT",t))(yr||{}),we=(t=>(t[t.FALSE=0]="FALSE",t[t.TRUE=1]="TRUE",t))(we||{}),$n=(t=>(t[t.STRING=1]="STRING",t[t.NUMBER=2]="NUMBER",t[t.BOOLEAN=3]="BOOLEAN",t[t.FORCE_STRING=4]="FORCE_STRING",t))($n||{}),No=(t=>(t[t.DARK1=0]="DARK1",t[t.LIGHT1=1]="LIGHT1",t[t.DARK2=2]="DARK2",t[t.LIGHT2=3]="LIGHT2",t[t.ACCENT1=4]="ACCENT1",t[t.ACCENT2=5]="ACCENT2",t[t.ACCENT3=6]="ACCENT3",t[t.ACCENT4=7]="ACCENT4",t[t.ACCENT5=8]="ACCENT5",t[t.ACCENT6=9]="ACCENT6",t[t.HYPERLINK=10]="HYPERLINK",t[t.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",t))(No||{}),MC=(t=>(t.OFFICE="Office",t.OFFICE_2007_2010="Office 2007-2010",t.GRAYSCALE="Grayscale",t.BLUE_WARM="Blue Warm",t.BLUE="Blue",t.BLUE_II="Blue II",t.BLUE_GREEN="Blue Green",t.GREEN="Green",t.GREEN_YELLOW="Green Yellow",t.YELLOW="Yellow",t.YELLOW_ORANGE="Yellow Orange",t.ORANGE="Orange",t.ORANGE_RED="Orange Red",t.RED_ORANGE="Red Orange",t.RED="Red",t.RED_VIOLET="Red Violet",t.VIOLET="Violet",t.VIOLET_II="Violet II",t.MEDIAN="Median",t.PAPER="Paper",t.MARQUEE="Marquee",t.SLIPSTREAM="Slipstream",t.Aspect="Aspect",t))(MC||{});const sW={[MC.OFFICE]:{[No.ACCENT1]:"#4472C4",[No.ACCENT2]:"#ED7D31",[No.ACCENT3]:"#A5A5A5",[No.ACCENT4]:"#70AD47",[No.ACCENT5]:"#5B9BD5",[No.ACCENT6]:"#70AD47",[No.DARK1]:"#000000",[No.DARK2]:"#44546A",[No.LIGHT1]:"#FFFFFF",[No.LIGHT2]:"#E7E6E6",[No.HYPERLINK]:"#0563C1",[No.FOLLOWED_HYPERLINK]:"#954F72"}};let NC=class{constructor(){ge(this,"_themeValue",No.LIGHT1),ge(this,"_themeColors"),ge(this,"_themeTint"),ge(this,"_rgbValue",""),ge(this,"_colorType"),this._colorType=us.UNSUPPORTED,this._themeColors=MC.OFFICE,this._themeTint=0}asRgbColor(){return new lW(this._rgbValue,this)}asThemeColor(){return new cW(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case us.THEME:return this.asThemeColor();case us.RGB:return this.asRgbColor();case us.UNSUPPORTED:throw new Error("unsupported color type")}}setRgbColor(e){return this._colorType=us.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=us.THEME,this._themeColors=e}setThemeTint(e){this._colorType=us.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=us.THEME,this._themeValue=e,this}getColorType(){return this._colorType}},yh=class pL{constructor(e){ge(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";const n=+`0x${e[0]}${e[1]}`,r=+`0x${e[2]}${e[3]}`,i=+`0x${e[4]}${e[5]}`;return new NC().setRgbColor(`rgb(${n},${r},${i})`).asRgbColor()}static hexToRgbString(e){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(n,(o,a,s,u)=>a+a+s+s+u+u);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let i=null;if(r){const o=Number.parseInt(r[1],16),a=Number.parseInt(r[2],16),s=Number.parseInt(r[3],16);i=`rgba(${o},${a},${s})`}return i}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new pL(this._builder)}equals(e){return!1}},uW=class{constructor(e){ge(this,"_saturation",0),ge(this,"_hue",0),ge(this,"_lightness",0),ge(this,"_alpha",0);const n=e.getRed()/255,r=e.getGreen()/255,i=e.getBlue()/255,o=e.getAlpha()/255,a=Math.min(n,Math.min(r,i)),s=Math.max(n,Math.max(r,i)),u=s-a;if(s===a){this._hue=0,this._saturation=0,this._lightness=s;return}this._lightness=(a+s)/2,this._lightness<.5?this._saturation=u/(s+a):this._saturation=u/(2-s-a),n===s&&(this._hue=(r-i)/u),r===s&&(this._hue=2+(i-n)/u),i===s&&(this._hue=4+(n-r)/u),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){const e=new NC;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let n;this._lightness<.5?n=this._lightness*(1+this._saturation):n=this._lightness+this._saturation-this._lightness*this._saturation;const r=2*this._lightness-n,i=this._hue/360,o=i+1/3,a=this.setColor(n,r,o),s=this.setColor(n,r,i),u=i-1/3,l=this.setColor(n,r,u);return e.setRgbColor(`rgba(${Math.round(a*255)},${Math.round(s*255)},${Math.round(l*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,n,r){r<0&&(r+=1),r>1&&(r-=1);let i;return 6*r<1?i=n+(e-n)*6*r:2*r<1?i=e:3*r<2?i=n+(e-n)*(2/3-r)*6:i=n,i}setLightness(e){this._lightness=e}};const f4=class Ru extends yh{constructor(e,n){super(n),ge(this,"_cssString"),ge(this,"_red"),ge(this,"_green"),ge(this,"_blue"),ge(this,"_alpha");let r=e.match(Ru.RGBA_EXTRACT);if(r){const i=+r[1],o=+r[2],a=+r[3],s=+r[4];this._cssString=e,this._red=i,this._green=o,this._blue=a,this._alpha=s;return}if(r=e.match(Ru.RGB_EXTRACT),r){const i=+r[1],o=+r[2],a=+r[3];this._cssString=e,this._red=i,this._green=o,this._blue=a,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return yh.rgbColorToHexValue(this)}getRed(){let e=this._red+Ru.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getGreen(){let e=this._green+Ru.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getBlue(){let e=this._blue+Ru.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getAlpha(){return this._alpha}getColorType(){return us.RGB}clone(){return new Ru(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(e){return e instanceof Ru?e._red===this._red&&e._blue===this._blue&&e._green===this._green&&e._alpha===this._alpha:!1}getCssString(){return this._cssString}};ge(f4,"RGB_COLOR_AMT",0),ge(f4,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),ge(f4,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let lW=f4;const gL=class P2 extends yh{constructor(e,n,r,i){super(i),ge(this,"_themeColorType"),ge(this,"_themeTint"),ge(this,"_themeColors"),this._themeColorType=e,this._themeTint=n,this._themeColors=r}lumValue(e,n){if(e==null)return n;let r;return e<0?r=n*(1+e):r=n*(1-e)+(255-255*(1-e)),r}asRgbColor(){const e=sW[this._themeColors];if(e==null)throw new Error("not find themeColors type");const n=e[this._themeColorType];if(n==null)throw new Error("not find themeColors value");let r;if(P2._cacheThemeColor.has(this._themeColors)){if(r=P2._cacheThemeColor.get(this._themeColors),r.has(this._themeColorType))return r.get(this._themeColorType)}else r=new Map,P2._cacheThemeColor.set(this._themeColors,r);const i=new uW(yh.hexValueToRgbColor(n));i.setLightness(this.lumValue(this._themeTint,i.getLightness()*255)/255);const o=i.asRgbColor();return r.set(this._themeColorType,o),o}clone(){return new P2(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(e){return e instanceof P2?e._themeColorType===this._themeColorType:!1}getColorType(){return us.THEME}getThemeColorType(){return this._themeColorType}};ge(gL,"_cacheThemeColor",new Map);let cW=gL;const B2={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};let Xo=class qs{constructor(e){if(ge(this,"_color"),ge(this,"_rgbColor"),ge(this,"_isValid",!1),e==null){this._setNullColor();return}if(e instanceof qs){this._color={...e._color},this._rgbColor={...e._rgbColor};return}const n=vL(e);if(n==null){this._setNullColor();return}this._color=n;const r=pW(this._color);if(r==null){this._setNullColor();return}this._rgbColor=r,this._isValid=!0}static mix(e,n,r){var i,o;r=Math.min(1,Math.max(0,r));const a=new qs(e).toRgb(),s=new qs(n).toRgb(),u=(i=a.a)!=null?i:1,l=(o=s.a)!=null?o:1,c={r:(s.r-a.r)*r+a.r,g:(s.g-a.g)*r+a.g,b:(s.b-a.b)*r+a.b,a:(l-u)*r+u};return new qs(c)}static getContrastRatio(e,n){const r=new qs(e).getLuminance(),i=new qs(n).getLuminance();return(Math.max(r,i)+.05)/(Math.min(r,i)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){const{r:e,g:n,b:r,a:i=1}=this.toRgb(),o=i<1;return`rgb${o?"a":""}(${e},${n},${r}${o?`,${i}`:""})`}toString(){return this.toRgbString()}toHexString(e){const{r:n,g:r,b:i,a:o=1}=this.toRgb(),a=o<1,s=[Qf(Math.round(n).toString(16)),Qf(Math.round(r).toString(16)),Qf(Math.round(i).toString(16)),Qf(Math.round(o*255).toString(16))];return e&&s[0][0]===s[0][1]&&s[1][0]===s[1][1]&&s[2][0]===s[2][1]&&s[3][0]===s[3][1]?a?`#${s[0][0]}${s[1][0]}${s[2][0]}${s[3][0]}`:`#${s[0][0]}${s[1][0]}${s[2][0]}`:a?`#${s[0]}${s[1]}${s[2]}${s[3]}`:`#${s[0]}${s[1]}${s[2]}`}toHsv(){return _W(this.toRgb())}toHsl(){return bW(this.toRgb())}lighten(e=10){const n=this.toHsl();return n.l+=e,n.l=Math.min(Math.max(n.l,0),100),new qs(n)}darken(e=10){const n=this.toHsl();return n.l-=e,n.l=Math.min(Math.max(n.l,0),100),new qs(n)}setAlpha(e){return new qs({...this._rgbColor,a:e})}getLuminance(){let{r:e,g:n,b:r}=this.toRgb();return e=up(e),n=up(n),r=up(r),Number((.2126*e+.7152*n+.0722*r).toFixed(3))}getBrightness(){const{r:e,g:n,b:r}=this.toRgb();return(e*299+n*587+r*114)/1e3}getAlpha(){var e;return(e=this._color.a)!=null?e:1}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}};const Qf=t=>t.length===1?`0${t}`:t,up=t=>(t/=255,t<=.03928?t/12.92:((t+.055)/1.055)**2.4),vL=t=>{if(SW(t)){if("r"in t){const r={r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)};return t.a!==void 0&&(r.a=t.a),r}if("l"in t){const r={h:Math.round(t.h),s:t.s,l:t.l};return t.a!==void 0&&(r.a=t.a),r}const n={h:Math.round(t.h),s:t.s,v:t.v};return t.a!==void 0&&(n.a=t.a),n}const e=t.trim();if(B2[e]){const n=B2[e],r={r:Math.round(n[0]),g:Math.round(n[1]),b:Math.round(n[2])};return r.a=n[3]||1,r}if(e.startsWith("#"))return dW(e);if(e.startsWith("rgb"))return mW(e);if(e.startsWith("hsl"))return fW(e);if(e.startsWith("hsv"))return hW(e)},dW=t=>{const e=t.substring(1),n=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(n);if(!r||r.length<3)throw new Error(`The color '${t}' is illegal hex color`);r[0].length===1&&(r=r.map(o=>o+o));const i={r:Number.parseInt(r[0],16),g:Number.parseInt(r[1],16),b:Number.parseInt(r[2],16)};return r.length>3&&(i.a=Number.parseInt(r[3],16)/255),i},mW=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal rgb color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal rgb color`);const r={r:Number.parseInt(n[0],10),g:Number.parseInt(n[1],10),b:Number.parseInt(n[2],10)};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},fW=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsl color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsl color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),l:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},hW=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsv color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsv color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),v:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},pW=t=>{const e=vL(t);if(e!=null)return"r"in e?e:"l"in e?gW(e):vW(e)},lp=(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),gW=t=>{let{h:e,s:n,l:r}=t;e/=360,n/=100,r/=100;let i=0,o=0,a=0;if(n===0)i=o=a=r;else{const u=r<.5?r*(1+n):r+n-r*n,l=2*r-u;i=lp(l,u,e+1/3),o=lp(l,u,e),a=lp(l,u,e-1/3)}const s={r:Math.round(i*255),g:Math.round(o*255),b:Math.round(a*255)};return t.a!==void 0&&(s.a=t.a),s},vW=t=>{let{h:e,s:n,v:r}=t;e=e/360*6,n/=100,r/=100;const i=Math.floor(e),o=e-i,a=r*(1-n),s=r*(1-o*n),u=r*(1-(1-o)*n),l=i%6,c=[r,s,a,a,u,r][l],d=[u,r,r,s,a,a][l],m=[a,a,u,r,r,s][l],f={r:c*255,g:d*255,b:m*255};return t.a!==void 0&&(f.a=t.a),f},bW=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const i=Math.max(e,n,r),o=Math.min(e,n,r),a=(i+o)/2;let s,u;if(i===o)s=u=0;else{const c=i-o;switch(u=a>.5?c/(2-i-o):c/(i+o),i){case e:s=(n-r)/c+(n<r?6:0);break;case n:s=(r-e)/c+2;break;default:s=(e-n)/c+4;break}s/=6}const l={h:Math.round(s*360),s:Math.round(u*100),l:Math.round(a*100)};return t.a!==void 0&&(l.a=t.a),l},_W=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const i=Math.max(e,n,r),o=Math.min(e,n,r);let a;const s=i,u=i-o,l=i===0?0:u/i;if(i===o)a=0;else{switch(i){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;default:a=(e-n)/u+4;break}a/=6}const c={h:Math.round(a*360),s:Math.round(l*100),v:Math.round(s*100)};return t.a!==void 0&&(c.a=t.a),c},CW=t=>t==null,SW=t=>!CW(t)&&typeof t=="object";var Ii=(t=>(t[t.COVER=0]="COVER",t[t.REPLACE=1]="REPLACE",t[t.INTERSECTION=2]="INTERSECTION",t))(Ii||{});const EW="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let yW=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=EW[n[t]&63];return e};const DW=/^-ms-/,RW=/-([a-z])/g,pu=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];let Ie=class mi{static stringAt(e){let n="",r=e;for(;r>=pu.length;)r/=pu.length,r-=1,n+=pu[r%pu.length];const i=e%pu.length;return n+=pu[i],n}static indexAt(e){let n=0;for(let r=0;r<e.length-1;r+=1){const i=e.charCodeAt(r)-65,o=e.length-1-r;n+=pu.length**o+pu.length*i}return n+=e.charCodeAt(e.length-1)-65,n}static deleteBlank(e){return mi.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,n=navigator.platform==="Win32"||navigator.platform==="Windows",r=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(r)return"Mac";if(navigator.platform==="X11"&&!n&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,n=e.indexOf("Opera")>-1,r=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,i=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,a=e.indexOf("Firefox")>-1,s=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,u=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(r){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const l=Number.parseFloat(RegExp.$1);return l===7?"IE7":l===8?"IE8":l===9?"IE9":l===10?"IE10":"0"}return a?"FF":n?"Opera":s?"Safari":u?"Chrome":o?"Edge":i?"IE11":"Unknown browser"}static generateRandomId(e=21){return yW(e)}static getClassName(e){return e.constructor.name}static deepMerge(e,...n){n.forEach(a=>a&&o(a));function r(a,s){a.forEach((u,l)=>{var c,d;if(mi.isArray(u)){const m=(c=s[l])!=null?c:[];s[l]=m,r(u,m);return}if(mi.isObject(u)){const m=(d=s[l])!=null?d:{};s[l]=m,i(u,m);return}s[l]=u})}function i(a,s){Object.keys(a).forEach(u=>{var l,c;const d=a[u];if(mi.isObject(d)){const m=(l=s[u])!=null?l:{};s[u]=m,i(d,m);return}if(mi.isArray(d)){const m=(c=s[u])!=null?c:[];s[u]=m,r(d,m);return}s[u]=d})}function o(a){Object.keys(a).forEach(s=>{var u,l;const c=a[s];if(mi.isArray(c)){const d=(u=e[s])!=null?u:[];e[s]=d,r(c,d);return}if(mi.isObject(c)){const d=(l=e[s])!=null?l:{};e[s]=d,i(c,d);return}e[s]=c})}return e}static numberFixed(e,n){return Number(Number(e).toFixed(n))}static diffValue(e,n){function r(a,s){const u=mi.getValueType(a),l=mi.getValueType(s);return u!==l?!1:mi.isArray(a)?i(a,s):mi.isObject(a)?o(a,s):mi.isDate(a)?a.getTime()===s.getTime():mi.isRegExp(a)?a.toString()===s.toString():a===s}function i(a,s){if(e.length!==n.length)return!1;for(let u=0,l=a.length;u<l;u++){const c=a[u],d=s[u];if(!r(c,d))return!1}return!0}function o(a,s){const u=Object.keys(a),l=Object.keys(s);if(u.length!==l.length)return!1;for(const c of u){if(!l.includes(c))return!1;const d=a[c],m=s[c];if(!r(d,m))return!1}return!0}return r(e,n)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const n=[];return e.forEach((r,i)=>{n[i]=mi.deepClone(r)}),n}if(this.isObject(e)){const n={};return Object.keys(e).forEach(r=>{const i=e[r];n[r]=mi.deepClone(i)}),Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}return e}static getLanguage(){const e="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||e}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isAssignableFrom(e,n){return e instanceof n}static isBoolean(e){return this.getValueType(e)==="[object Boolean]"}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isFunction(e){return this.getValueType(e)==="[object Function]"}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isStringNumber(e){return!isNaN(Number.parseFloat(e))&&isFinite(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const n in e)return!1;return!0}static isMobile(){let e=0,n=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(n=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&n<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return String(e.match(/MicroMessenger/i))==="micromessenger"}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static itCount(e){return n=>{for(let r=0;r<e;r++)n&&n()}}static hasLength(e,n){return mi.isDefine(e)?mi.isDefine(n)?e.length===n:e.length>0:!1}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,n){return n.toUpperCase()}static camelCase(e){return e.replace(DW,"ms-").replace(RW,this.fCamelCase)}static removeNull(e){return this.isObject(e)&&Object.keys(e).forEach(n=>{const r=e[n];r==null?delete e[n]:mi.removeNull(r)}),e}static fillTwoDimensionalArray(e,n,r){return new Array(e).fill(r).map(i=>new Array(n).fill(r))}static numToWord(e){let n="";for(;e>0;){let r=e%26;r=r===0?r=26:r,n=String.fromCharCode(96+r)+n,e=(e-r)/26}return n.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return Number.NaN;const n=e.toLowerCase().split(""),r=n.length;let i=0,o=0;for(let a=0;a<r;a++)o=n[a].charCodeAt(0)-96,i+=o*26**(r-a-1);return i===0?Number.NaN:i-1}static chatAtABC(e){let n="";for(;e>=0;)n=String.fromCharCode(e%26+97)+n,e=Math.floor(e/26)-1;return n.toUpperCase()}static randSort(e){for(let n=0,r=e.length;n<r;n++){const i=Number.parseInt((Math.random()*r).toString()),o=e[i];e[i]=e[n],e[n]=o}return e}static commonExtend(e,n){const r={};for(const i in e)r[i]=e[i];for(const i in n)n[i]!=null&&(r[i]=n[i]);return r}static commonExtend1(e,n){for(const r in e)n[r]==null&&(n[r]=e[r]);return n}static arrayToObject(e){const n={};return e.forEach((r,i)=>{n[i]={},r.forEach((o,a)=>{n[i][a]=o})}),n}static hasIntersectionBetweenTwoRanges(e,n,r,i){return n>=r&&i>=e}};function xC(t){if(!t)return;const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i,mergeInfo:o}=t;let{startY:a,endY:s,startX:u,endX:l}=t,c=e,d=n,m=e,f=n;if(r&&o){const{startRow:h,startColumn:p,endRow:v,endColumn:g,startY:b,endY:C,startX:S,endX:E}=o;c=h,d=p,m=v,f=g,a=b,s=C,u=S,l=E}return i&&(a=o.startY,s=o.endY,u=o.startX,l=o.endX,m=o.endRow,f=o.endColumn),{startRow:c,startColumn:d,endRow:m,endColumn:f,startY:a,endY:s,startX:u,endX:l}}function IW(t){if(!t)return;const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i,startRow:o,startColumn:a,endRow:s,endColumn:u}=t;let l=e,c=n,d=e,m=n;return(r||i)&&(l=o,c=a,d=s,m=u),{startRow:l,startColumn:c,endRow:d,endColumn:m}}function sD(t){var e;return!t||(((e=t==null?void 0:t.v)==null?void 0:e.toString())||"").length===0&&!t.p}function mo(t){if(t){if(t.rgb)return t.rgb;if(t.th)return new NC().setThemeColor(t.th).asThemeColor().asRgbColor().getCssString()}return null}function $i(t){return Ie.isString(t)&&t.substring(0,1)==="="&&t.length>1}function La(t){return Ie.isString(t)&&t.indexOf("=")===-1&&t.length===6}function AW(t,e=!1){var n;let r="";const i=new Map([["ff",()=>{t.ff&&(r+=`font-family: ${t.ff}; `)}],["fs",()=>{if(t.fs){let a=t.fs;t.va&&(a/=2),r+=`font-size: ${a}pt; `}}],["it",()=>{t.it&&(r+="font-style: italic; ")}],["bl",()=>{t.bl&&(r+="font-weight: bold; ")}],["ul",()=>{var a;(a=t.ul)!=null&&a.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," underline"):r+="text-decoration-line: underline; ",t.ul.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${mo(t.ul.cl)}; `),t.ul.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ul.t} `))}],["st",()=>{var a;(a=t.st)!=null&&a.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," line-through"):r+="text-decoration-line: line-through; ",t.st.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${mo(t.st.cl)}; `),t.st.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.st.t} `))}],["ol",()=>{var a;(a=t.ol)!=null&&a.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," overline"):r+="text-decoration-line: overline; ",t.ol.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${mo(t.ol.cl)}; `),t.ol.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ol.t} `))}],["bg",()=>{t.bg&&(r+=`background: ${mo(t.bg)}; `)}],["bd",()=>{var a,s,u,l,c,d,m,f,h,p,v,g;(a=t.bd)!=null&&a.b&&(r+=`border-bottom: ${Jf((s=t.bd)==null?void 0:s.b.s)} ${(u=mo(t.bd.b.cl))!=null?u:""}; `),(l=t.bd)!=null&&l.t&&(r+=`border-top: ${Jf((c=t.bd)==null?void 0:c.t.s)} ${(d=mo(t.bd.t.cl))!=null?d:""}; `),(m=t.bd)!=null&&m.r&&(r+=`border-right: ${Jf((f=t.bd)==null?void 0:f.r.s)} ${(h=mo(t.bd.r.cl))!=null?h:""}; `),(p=t.bd)!=null&&p.l&&(r+=`border-left: ${Jf((v=t.bd)==null?void 0:v.l.s)} ${(g=mo(t.bd.l.cl))!=null?g:""}; `)}],["cl",()=>{t.cl&&(r+=`color: ${mo(t.cl)}; `)}],["va",()=>{t.va===yr.SUBSCRIPT?r+="vertical-align: sub; ":t.va===yr.SUPERSCRIPT&&(r+="vertical-align: super; ")}],["td",()=>{t.td===Eh.LEFT_TO_RIGHT?r+="direction: ltr; ":t.td===Eh.RIGHT_TO_LEFT&&(r+="direction: rtl; ")}],["tr",()=>{var a,s,u;t.tr&&(r+=`data-rotate: (${(a=t.tr)==null?void 0:a.a}deg${(s=t.tr)!=null&&s.v?` ,${(u=t.tr)==null?void 0:u.v}`:""});`)}],["ht",()=>{t.ht===Zn.LEFT?r+="text-align: left; ":t.ht===Zn.RIGHT?r+="text-align: right; ":t.ht===Zn.CENTER?r+="text-align: center; ":t.ht===Zn.JUSTIFIED&&(r+="text-align: justify; ")}],["vt",()=>{t.vt===li.BOTTOM?r+="vertical-align: bottom; ":t.vt===li.TOP?r+="vertical-align: top; ":t.vt===li.MIDDLE&&(r+="vertical-align: middle; ")}],["tb",()=>{t.tb===Ar.CLIP?r+="text-overflow: clip; ":t.tb===Ar.OVERFLOW?r+="text-break: overflow; ":t.tb===Ar.WRAP&&(r+="word-wrap: break-word;")}],["pd",()=>{var a,s,u,l,c,d,m,f;const h=`${(a=t.pd)==null?void 0:a.b}pt`,p=`${(s=t.pd)==null?void 0:s.t}pt`,v=`${(u=t.pd)==null?void 0:u.l}pt`,g=`${(l=t.pd)==null?void 0:l.r}pt`;(c=t.pd)!=null&&c.b&&(r+=`padding-bottom: ${h}; `),(d=t.pd)!=null&&d.t&&(r+=`padding-top: ${p}; `),(m=t.pd)!=null&&m.l&&(r+=`padding-left: ${v}; `),(f=t.pd)!=null&&f.r&&(r+=`padding-right: ${g}; `)}]]),o=["bd","tr","tb"];for(const a in t)e&&o.includes(a)||(n=i.get(a))==null||n();return r}function Jf(t){let e="";return t===Lt.NONE?e="none":t===Lt.THIN?e="0.5pt solid":t===Lt.HAIR?e="0.5pt double":t===Lt.DOTTED?e="0.5pt dotted":t===Lt.DASHED||t===Lt.DASH_DOT?e="0.5pt dashed":t===Lt.DASH_DOT_DOT?e="0.5pt dotted":t===Lt.DOUBLE?e="0.5pt double":t===Lt.MEDIUM?e="1pt solid":t===Lt.MEDIUM_DASHED||t===Lt.MEDIUM_DASH_DOT?e="1pt dashed":t===Lt.MEDIUM_DASH_DOT_DOT?e="1pt dotted":t===Lt.SLANT_DASH_DOT?e="0.5pt dashed":t===Lt.THICK&&(e="1.5pt solid"),e}function I1(t){let e=0;if(t=t.trim(),t==="none")e=Lt.NONE;else if(t==="0.5pt solid")e=Lt.THIN;else if(t==="0.5pt double")e=Lt.HAIR;else if(t==="0.5pt dotted")e=Lt.DOTTED;else if(t==="0.5pt dashed")e=Lt.DASHED;else if(t==="1pt solid")e=Lt.MEDIUM;else if(t==="1pt dashed")e=Lt.MEDIUM_DASHED;else if(t==="1pt dotted")e=Lt.MEDIUM_DASH_DOT_DOT;else if(t==="1.5pt solid")e=Lt.THICK;else return Lt.NONE;return e}function h4(t,e){let n=t.body;if(e){const{headers:r,footers:i}=t;r!=null&&r[e]?n=r[e].body:i!=null&&i[e]&&(n=i[e].body)}return n}function TW(t){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=t;return!(e<0||r<0||n<0||i<0)}function bL(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(n=>bL(t[n],e[n])):t===e:!1}function wW(t,e){const n=t.ts||{},r=e.ts||{};return t.sId!==e.sId?!1:bL(n,r)}function FC(t,e,n,r){if(t>e&&([t,e]=[e,t]),n>r&&([n,r]=[r,n]),e<n||r<t)return[t,e];n<t&&(n=t),r>e&&(r=e);const i=r-n+1;let o=[];return t===n?o=[r+1-i,e-i]:e===r?o=[t,n-1]:o=[t,e-i],o}function LW(t){return!(t==null||(t.indentStart==null||t.indentStart===0)&&t.hanging==null||t.hanging===0)}function _L(t,e,n){return t.slice(0,e)+n+t.slice(e)}function CL(t,e,n){return e>n?t:t.slice(0,e)+t.slice(n)}function n5(t){return t===null||t.toString().replace(/\s/g,"")===""||typeof t=="boolean"?!1:!isNaN(t)}function OW(t){let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+(e<<6)+(e<<16)-e;return e>>>0}let e3=class{static hasLength(e,n){return e.length===n}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isIterable(e){return e[Symbol.iterator]!=null}static isNumber(e){return this.getValueType(e)==="[object Number]"}};const Er=Symbol("newer"),fi=Symbol("older");let PW=class{constructor(e){ge(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Er],{done:!1,value:e.key}):{done:!0,value:void 0}}},MW=class{constructor(e){ge(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Er],{done:!1,value:e.value}):{done:!0,value:void 0}}},NW=class{constructor(e){ge(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Er],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}};var SL,EL;let uD=class{constructor(e,n){ge(this,"key"),ge(this,"value"),ge(this,SL),ge(this,EL),this.key=e,this.value=n,this[Er]=void 0,this[fi]=void 0}toJSON(){return{key:this.key,value:this.value}}};SL=Er,EL=fi;let r5=class{constructor(...e){if(ge(this,"_keymap"),ge(this,"size",0),ge(this,"limit"),ge(this,"oldest"),ge(this,"newest"),ge(this,"_onShiftListeners",[]),e3.hasLength(e,1)){if(e3.isNumber(e[0])){const n=e[0];this._initialize(n,void 0);return}if(e3.isIterable(e[0])){const n=e[0];this._initialize(0,n);return}return}if(e3.hasLength(e,2)){const n=e[0],r=e[1];this._initialize(n,r)}}onShift(e){if(this._onShiftListeners.indexOf(e)===-1)return this._onShiftListeners.push(e),je(()=>r1(this._onShiftListeners,e));throw new Error("[LRUMap]: the listener has been registered!")}_initialize(e,n){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,n&&(this.assign(n),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[Er]&&(e===this.oldest&&(this.oldest=e[Er]),e[Er][fi]=e[fi]),e[fi]&&(e[fi][Er]=e[Er]),e[Er]=void 0,e[fi]=this.newest,this.newest&&(this.newest[Er]=e),this.newest=e)}assign(e){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();const i=e[Symbol.iterator]();for(let o=i.next();!o.done;o=i.next()){const a=new uD(o.value[0],o.value[1]);if(this._keymap.set(a.key,a),n?(n[Er]=a,a[fi]=n):this.oldest=a,n=a,r--===0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}set(e,n){let r=this._keymap.get(e);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(e,r=new uD(e,n)),this.newest?(this.newest[Er]=r,r[fi]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const e=this.oldest;if(e)return this.oldest&&this.oldest[Er]?(this.oldest=this.oldest[Er],this.oldest[fi]=void 0):(this.oldest=void 0,this.newest=void 0),e[Er]=e[fi]=void 0,this._keymap.delete(e.key),--this.size,this._onShiftListeners.forEach(n=>n(e)),[e.key,e.value]}get(e){const n=this._keymap.get(e);if(n)return this._markEntryAsUsed(n),n.value}has(e){return this._keymap.has(e)}find(e){const n=this._keymap.get(e);return n?n.value:void 0}delete(e){const n=this._keymap.get(e);if(n)return this._keymap.delete(n.key),n[Er]&&n[fi]?(n[fi][Er]=n[Er],n[Er][fi]=n[fi]):n[Er]?(n[Er][fi]=void 0,this.oldest=n[Er]):n[fi]?(n[fi][Er]=void 0,this.newest=n[fi]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new PW(this.oldest)}values(){return new MW(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new NW(this.oldest)}forEach(e,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)e.call(n,r.value,r.key,this),r=r[Er]}toJSON(){const e=new Array(this.size);let n=0,r=this.oldest;for(;r;)e[n++]={key:r.key,value:r.value},r=r[Er];return e}toString(){let e="",n=this.oldest;for(;n;)e+=`${String(n.key)}:${n.value}`,n=n[Er],n&&(e+=" < ");return e}};function Ss(t){let e=0;const n=Object.keys(t);for(const r of n){const i=Number(r);e=Math.max(e,i)}return e+1}function y0(t,e,n){const r=Ss(n),i=n;for(let o=r-1;o>=t;o--)i[o+1]=i[o];i[t]=e}function Dh(t,e,n,r){const i=t+e,o=Ss(n),a=n;let s=0;const u={};for(let m=t;m<i;m++){const f=a[m];f!==void 0&&(delete a[m],u[s]=f,s++)}const l=r?Ss(r):0,c=t-i+l,d=o;if(c>0)for(let m=d-1;m>=i;m--)a[m]!==void 0&&(a[m+c]=a[m],delete a[m]);else if(c<0)for(let m=i;m<d;m++)a[m]!==void 0&&(a[m+c]=a[m],delete a[m]);if(r)for(let m=0;m<l;m++)a[t+m]=r[m];return u}function yL(t,e){const n=t,r=Object.keys(n),i=r.length,o=e,a=Object.keys(o),s=a.length,u={};let l=0;for(let c=0;c<i;c++,l++){const d=r[c];u[l]=n[d]}for(let c=0;c<s;c++,l++){const d=a[c];u[l]=o[d]}return u}function DL(t,e,n){const r=n;if(Ss(n)>0){const i={};let o=0;for(let a=t;a<=e;a++)r[a]&&(i[o]=r[a],o++);return i}return{}}function Rh(t,e,n,r){const i=t>n;if(!i&&t+e>n)throw new Error("Invalid move operation");i?xW(t,e,n,r):FW(t,e,n,r)}function xW(t,e,n,r){const i=r,o=[];for(let a=t;a<t+e;a++)o.push(i[a]);for(let a=t-1;a>=n;a--){const s=i[a];i[a+e]=s,s==null&&delete i[a+e]}o.forEach((a,s)=>{i[n+s]=a,a==null&&delete i[n+s]})}function FW(t,e,n,r){const i=r,o=[];for(let a=t;a<t+e;a++)o.push(i[a]);for(let a=t+e;a<n;a++){const s=i[a];i[a-e]=s,s==null&&delete i[a-e]}o.forEach((a,s)=>{i[n+s-e]=a,a==null&&delete i[n+s-e]})}let Ye=class u6{constructor(e={}){ge(this,"_matrix"),this._setOriginValue(e)}static MakeObjectMatrixSize(e){return new u6({[e-1]:{}})}getMatrix(){return this._matrix}forEach(e){const n=this._matrix,r=Object.keys(n);for(const i of r){const o=Number(i),a=n[o];if(e(o,a)===!1)return this}return this}forRow(e){const n=this._matrix,r=Object.keys(n);for(const i of r){const o=Number(i),a=n[o];if(e(o,Object.keys(a).map(s=>Number(s)))===!1)return this}return this}forValue(e){const n=this._matrix,r=Object.keys(n);for(const i of r){const o=Number(i),a=n[o];if(!a)continue;const s=Object.keys(a);for(const u of s){const l=Number(u),c=a[Number(u)];if(e(o,l,c)===!1)return this}}return this}swapRow(e,n){const r=this._matrix[e],i=this._matrix[n];this._matrix[e]=i,this._matrix[n]=r}getRow(e){return this._matrix[e]}getRowOrCreate(e){let n=this.getRow(e);return n==null&&(n={},this._matrix[e]=n),n}reset(){this._setOriginValue({})}hasValue(){const e=this._matrix,n=Object.keys(e);if(n.length===0)return!1;for(const r of n){const i=Number(r),o=e[i];if(Object.keys(o).length>0)return!0}return!1}getValue(e,n){var r,i;return(i=(r=this._matrix)==null?void 0:r[e])==null?void 0:i[n]}setValue(e,n,r){const i=this.getRowOrCreate(e);i[n]=r}deleteValue(e,n){var r,i;(i=(r=this._matrix)==null?void 0:r[e])==null||delete i[n]}realDeleteValue(e,n){var r,i,o;if((i=(r=this._matrix)==null?void 0:r[e])==null||delete i[n],this.getRow(e)){const a=this.getRow(e);if(a==null)return;Object.keys(a).length===0&&((o=this._matrix)==null||delete o[e])}}setRow(e,n){this._matrix[e]=n}moveRows(e,n,r){Rh(e,n,r,this._matrix)}moveColumns(e,n,r){this.forEach((i,o)=>{Rh(e,n,r,o)})}insertRows(e,n){for(let r=e;r<e+n;r++)y0(r,{},this._matrix)}insertColumns(e,n){for(let r=e;r<e+n;r++)this.forEach((i,o)=>{y0(r,void 0,o)})}removeRows(e,n){Dh(e,n,this._matrix)}removeColumns(e,n){this.forEach((r,i)=>{Dh(e,n,i)})}getFragment(e,n,r,i){const o=new u6;let a=0;for(let s=e;s<=n;s++){const u={};let l=0;for(let c=r;c<=i;c++){const d=this.getValue(s,c);u[l]=d,l++}o.setRow(a,u),a++}return o}getSlice(e,n,r,i){const o=new u6;for(let a=e;a<=n;a++)for(let s=r;s<=i;s++){const u=this.getValue(a,s);u&&o.setValue(a,s,Ie.deepClone(u))}return o}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return Ss(this._matrix)}getRange(){const e=this.getLength()-1;let n=0;const r=this.getLength();for(let i=0;i<r;i++){const o=this.getRow(i);if(o){const a=Ss(o)-1;n=a>n?a:n}}return{startRow:0,startColumn:0,endRow:e,endColumn:n}}toNativeArray(){const e=new Array;return this.forValue((n,r,i)=>{e.push(i)}),e}toArray(){const e=[];return this.forRow((n,r)=>{e[n]==null&&(e[n]=[]),r.forEach(i=>{e[n][i]=this.getValue(n,i)})}),e}toJSON(){return this._matrix}clone(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getData(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getArrayData(){let e=0,n=0,r=!1,i=!1;const o=new u6;return this.forEach((a,s)=>{r||(r=!0,e=a),Object.keys(s).forEach(u=>{const l=Number(u);i?l<n&&(n=l):(i=!0,n=l);const c=this.getValue(a,l);o.setValue(a-e,l-n,c)})}),o.getData()}getDataRange(){let e=0,n=0,r=0,i=-1,o=!1,a=!1;return this.forEach((s,u)=>{o||(o=!0,e=s);const l=Ss(u)-1;l>r&&(r=l),Object.keys(u).forEach(c=>{const d=Number(c);a?d<n&&(n=d):(a=!0,n=d)}),s>i&&(i=s)}),{startRow:e,startColumn:n,endRow:i,endColumn:r}}getDiscreteRanges(){const e=[];return this.forEach((n,r)=>{Object.keys(r).forEach(i=>{const o=Number(i);let a=!1;for(const s of e)if(n>=s.startRow&&n<=s.endRow+1&&o>=s.startColumn&&o<=s.endColumn+1){s.endRow=Math.max(n,s.endRow),s.endColumn=Math.max(o,s.endColumn),a=!0;break}a||e.push({startRow:n,endRow:n,startColumn:o,endColumn:o})})}),e}merge(e){this.forValue((n,r)=>{const i=e.getValue(n,r);i!=null&&this.setValue(n,r,i)})}_setOriginValue(e={}){this._matrix=e}};var RL=(t=>(t.INIT="init",t.FETCHING="fetching",t.DONE="done",t))(RL||{});let IL=class{constructor(){ge(this,"status","init")}};const $W=t=>t.some(e=>e.status==="init")?"init":t.some(e=>e.status==="fetching")?"fetching":"done";var ct=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(ct||{}),Hn=(t=>(t[t.NONE=0]="NONE",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(Hn||{});function kW(t){return[t.startRow,t.startColumn,t.endRow,t.endColumn]}const M2=class AL{static clone(e){return e.rangeType!==void 0?{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}static equals(e,n){return e==null||n==null?!1:e.endRow===n.endRow&&e.endColumn===n.endColumn&&e.startRow===n.startRow&&e.startColumn===n.startColumn&&(e.rangeType===n.rangeType||e.rangeType===void 0&&n.rangeType===ct.NORMAL||n.rangeType===void 0&&e.rangeType===ct.NORMAL)}static intersects(e,n){const r=e.startRow,i=e.endRow,o=e.startColumn,a=e.endColumn,s=n.startRow,u=n.endRow,l=n.startColumn,c=n.endColumn,d=Math.abs(o+a-l-c),m=Math.abs(o-a)+Math.abs(l-c),f=Math.abs(r+i-s-u),h=Math.abs(r-i)+Math.abs(s-u);return d<=m&&f<=h}static getIntersects(e,n){const r=e.startRow,i=e.endRow,o=e.startColumn,a=e.endColumn,s=n.startRow,u=n.endRow,l=n.startColumn,c=n.endColumn;let d,m,f,h;if(s<=i)s>=r?m=s:m=r;else return null;if(u>=r)u>=i?h=i:h=u;else return null;if(l<=a)l>o?d=l:d=o;else return null;if(c>=o)c>=a?f=a:f=c;else return null;return{startRow:m,endRow:h,startColumn:d,endColumn:f,rangeType:ct.NORMAL}}static contains(e,n){return e.startRow<=n.startRow&&e.endRow>=n.endRow&&e.startColumn<=n.startColumn&&e.endColumn>=n.endColumn}static realContain(e,n){return AL.contains(e,n)&&(e.startRow<n.startRow||e.endRow>n.endRow||e.startColumn<n.startColumn||e.endColumn>n.endColumn)}static union(...e){return e.reduce((n,r)=>({startRow:Math.min(n.startRow,r.startRow),startColumn:Math.min(n.startColumn,r.startColumn),endRow:Math.max(n.endRow,r.endRow),endColumn:Math.max(n.endColumn,r.endColumn),rangeType:ct.NORMAL}),e[0])}static subtract(e,n){if(n.startRow>=e.endRow||n.endRow<=e.startRow||n.startColumn>=e.endColumn||n.endColumn<=e.startColumn)return[e];const r=[];n.startRow>e.startRow&&r.push({startRow:e.startRow,startColumn:e.startColumn,endRow:n.startRow,endColumn:e.endColumn}),n.endRow<e.endRow&&r.push({startRow:n.endRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn});const i=Math.max(e.startRow,n.startRow),o=Math.min(e.endRow,n.endRow);return n.startColumn>e.startColumn&&r.push({startRow:i,startColumn:e.startColumn,endRow:o,endColumn:n.startColumn}),n.endColumn<e.endColumn&&r.push({startRow:i,startColumn:n.endColumn,endRow:o,endColumn:e.endColumn}),r}};ge(M2,"getRelativeRange",(t,e)=>({startRow:t.startRow-e.startRow,endRow:t.endRow-t.startRow,startColumn:t.startColumn-e.startColumn,endColumn:t.endColumn-t.startColumn})),ge(M2,"getPositionRange",(t,e)=>({startRow:t.startRow+e.startRow,endRow:t.endRow+t.startRow+e.startRow,startColumn:t.startColumn+e.startColumn,endColumn:t.endColumn+t.startColumn+e.startColumn})),ge(M2,"moveHorizontal",(t,e=0,n=0)=>({...t,startColumn:t.startColumn+e,endColumn:t.endColumn+e+n})),ge(M2,"moveVertical",(t,e=0,n=0)=>({...t,startRow:t.startRow+e,endRow:t.endRow+e+n})),ge(M2,"moveOffset",(t,e,n)=>({...t,startRow:t.startRow+n,endRow:t.endRow+n,startColumn:t.startColumn+e,endColumn:t.endColumn+e}));let ht=M2,cp=class{constructor(e,n){ge(this,"_values",[]),ge(this,"_keys",[]),ge(this,"_keyMaps",new Map),this._values=e,this._keys=n,e.forEach(r=>{this._initKeyMap(r)})}_initKeyMap(e){this._keys.forEach(n=>{const r=e[n],i=this._keyMaps.get(n)||new Map;i.set(r,e),this._keyMaps.set(n,i)})}getValue(e){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(e))return r.get(e)}return null}hasValue(e){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(e))return!0}return!1}addValue(e){this._values.push(e),this._initKeyMap(e)}setValue(e,n,r){const i=this.getValue(e);i&&Object.keys(i).includes(n)&&(i[n]=r)}deleteValue(e){const n=this.getValue(e);if(n){this._keys.forEach(i=>{const o=this._keyMaps.get(i),a=n[i];o==null||o.delete(a)});const r=this._values.findIndex(i=>i===n);this._values.splice(r,1)}}getValues(){return this._values}getKeyMap(e){var n;return[...((n=this._keyMaps.get(e))==null?void 0:n.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}};function lD(t,e,n,r){return{forEach(i){for(let o=t;o<=e;o++)for(let a=n;a<=r;a++)i(o,a)}}}const Ih=65,TL=90,BW=97;function UW(t){const e=TL-Ih+1;let n="";for(;t>=0;)n=String.fromCharCode(t%e+Ih)+n,t=Math.floor(t/e)-1;return n}function VW(t,e){let n="";for(;e>0;)n+=t,e--;return n}function wL(t,e=!1){const n=TL-Ih+1;let r=BW;e&&(r=Ih);const i=String.fromCharCode(t%n+r),o=Math.floor(t/n)+1;return VW(i,o)}function gs(t,e){return t.zIndex>e.zIndex?1:t.zIndex===e.zIndex?0:-1}function cD(t,e){return t.zIndex>e.zIndex?-1:t.zIndex===e.zIndex?0:1}function qm(t="index",e=1){return(n,r)=>n[t]>r[t]?e:n[t]===r[t]?0:-e}var si=(t=>(t[t.PARAGRAPH=0]="PARAGRAPH",t[t.SECTION_BREAK=1]="SECTION_BREAK",t[t.TABLE=2]="TABLE",t[t.TABLE_ROW=3]="TABLE_ROW",t[t.TABLE_CELL=4]="TABLE_CELL",t))(si||{}),mn=(t=>(t.PARAGRAPH="\r",t.SECTION_BREAK=`
`,t.TABLE_START="",t.TABLE_ROW_START="\x1B",t.TABLE_CELL_START="",t.TABLE_CELL_END="",t.TABLE_ROW_END="",t.TABLE_END="",t.CUSTOM_RANGE_START="",t.CUSTOM_RANGE_END="",t.COLUMN_BREAK="\v",t.PAGE_BREAK="\f",t.DOCS_END="\0",t.TAB="	",t.CUSTOM_BLOCK="\b",t.LETTER="",t.SPACE=" ",t))(mn||{});function LL(t){const e=[];for(const n of t){const{st:r,ed:i,ts:o}=n;if(n.sId===void 0&&delete n.sId,r===i||Ie.isEmptyObject(o)&&n.sId==null)continue;if(e.length===0){e.push(n);continue}const a=e.pop();wW(n,a)&&Ie.hasIntersectionBetweenTwoRanges(a.st,a.ed,n.st,n.ed)?e.push({...n,st:a.st,ed:i}):e.push(a,n)}return e}function OL(t,e,n,r){var i;const{textRuns:o}=t;if(o==null)return;const a=[],s=o.length;let u=!1;const l=(i=e.textRuns)!=null?i:[];if(l.length)for(let c=0,d=l.length;c<d;c++){const m=l[c];m.st+=r,m.ed+=r}for(let c=0;c<s;c++){const d=o[c],{st:m,ed:f}=d;if(f<r)a.push(d);else if(r>=m&&r<=f)if(u)d.st+=n,d.ed+=n,a.push(d);else{u=!0,d.ed+=n;const h=[];if(l.length){const p={...d,st:m,ed:l[0].st};h.push(p),h.push(...l);const v=l[l.length-1],g={...d,st:v.ed,ed:f+n};h.push(g)}else h.push(d);a.push(...h)}else d.st+=n,d.ed+=n,u||(u=!0,a.push(...l)),a.push(d)}u||(u=!0,a.push(...l)),t.textRuns=LL(a)}function $C(t,e,n,r){const{paragraphs:i}=t;if(i==null)return;const{paragraphs:o,dataStream:a}=e,s=[];let u=-1;for(let c=0,d=i.length;c<d;c++){const m=i[c],{startIndex:f}=m;f>=r&&(m.startIndex+=n),u===-1&&f>=r&&(u=c),s.push(m.startIndex)}let l=-1;if(o){for(let c=0,d=o.length;c<d;c++){const m=o[c];m.startIndex+=r;const f=m.startIndex;l=s.indexOf(f)}if(a===mn.PARAGRAPH&&o.length===1){const c=i[u],d=o[0],m=c.paragraphStyle,f=c.bullet;c.paragraphStyle=d.paragraphStyle,c.bullet=d.bullet,d.paragraphStyle=m,d.bullet=f}l!==-1&&i.splice(l,1),i.push(...o),i.sort(qm("startIndex"))}}function HW(t,e,n,r){const{sectionBreaks:i}=t;if(i==null)return;for(let a=0,s=i.length;a<s;a++){const u=i[a],{startIndex:l}=u;l>=r&&(u.startIndex+=n)}const o=e.sectionBreaks;if(o){for(let a=0,s=o.length;a<s;a++){const u=o[a];u.startIndex+=r}i.push(...o),i.sort(qm("startIndex"))}}function PL(t,e,n,r){const{customBlocks:i}=t;if(i==null)return;for(let a=0,s=i.length;a<s;a++){const u=i[a],{startIndex:l}=u;l>=r&&(u.startIndex+=n)}const o=e.customBlocks;if(o){for(let a=0,s=o.length;a<s;a++){const u=o[a];u.startIndex+=r}i.push(...o),i.sort(qm("startIndex"))}}function kC(t,e,n,r){const{tables:i}=t;if(i==null)return;for(let a=0,s=i.length;a<s;a++){const u=i[a],{startIndex:l,endIndex:c}=u;l>r?(u.startIndex+=n,u.endIndex+=n):c>=r-1&&(u.endIndex+=n)}const o=e.tables;if(o){for(let a=0,s=o.length;a<s;a++){const u=o[a];u.startIndex+=r,u.endIndex+=r}i.push(...o),i.sort(qm("startIndex"))}}function jW(t,e,n,r){const{customRanges:i}=t;if(i==null)return;for(let a=0,s=i.length;a<s;a++){const u=i[a],{startIndex:l,endIndex:c}=u;l>r?(u.startIndex+=n,u.endIndex+=n):c>=r-1&&(u.endIndex+=n)}const o=e.customRanges;if(o){for(let a=0,s=o.length;a<s;a++){const u=o[a];u.startIndex+=r,u.endIndex+=r}i.push(...o),i.sort(qm("startIndex"))}}function ML(t,e,n){const{textRuns:r}=t,i=n,o=n+e,a=[];if(r){const s=[];for(let u=0,l=r.length;u<l;u++){const c=r[u],{st:d,ed:m}=c;if(i<=d&&o>=m){a.push({...c,st:d-i,ed:m-i});continue}else d<=i&&m>=o?(a.push({...c,st:i-i,ed:o-i}),c.ed-=e):i>=d&&i<m?(a.push({...c,st:i-i,ed:m-i}),c.ed=i):o>d&&o<=m?(a.push({...c,st:d-i,ed:o-i}),c.st=o-e,c.ed-=e):d>=o&&(c.st-=e,c.ed-=e);s.push(c)}t.textRuns=s}return a}function NL(t,e,n){const{paragraphs:r}=t,i=n,o=n+e,a=[];if(r){const s=[];for(let u=0,l=r.length;u<l;u++){const c=r[u],{startIndex:d}=c;if(d>=i&&d<o){a.push({...c,startIndex:d-n});continue}else d>=o&&(c.startIndex-=e);s.push(c)}t.paragraphs=s}return a}function xL(t,e,n){const{sectionBreaks:r}=t,i=n,o=n+e-1,a=[];if(r){const s=[];for(let u=0,l=r.length;u<l;u++){const c=r[u],{startIndex:d}=c;if(d>=i&&d<=o){a.push({...c,startIndex:d-n});continue}else d>o&&(c.startIndex-=e);s.push(c)}t.sectionBreaks=s}return a}function FL(t,e,n){const{customBlocks:r}=t,i=n,o=n+e-1,a=[];if(r){const s=[];for(let u=0,l=r.length;u<l;u++){const c=r[u],{startIndex:d}=c;if(d>=i&&d<=o){a.push({...c,startIndex:d-n});continue}else d>o&&(c.startIndex-=e);s.push(c)}t.customBlocks=s}return a}function $L(t,e,n){const{tables:r}=t,i=n,o=n+e-1,a=[];if(r){const s=[];for(let u=0,l=r.length;u<l;u++){const c=r[u],{startIndex:d,endIndex:m}=c;if(i<=d&&o>=m){a.push({...c,startIndex:d-n,endIndex:m-n});continue}else if(d<=i&&m>=o){const f=FC(d,m,i,o);c.startIndex=f[0],c.endIndex=f[1]}else o<d&&(c.startIndex-=e,c.endIndex-=e);s.push(c)}t.tables=s}return a}function kL(t,e,n){const{customRanges:r}=t,i=n,o=n+e-1,a=[];if(r){const s=[];for(let u=0,l=r.length;u<l;u++){const c=r[u],{startIndex:d,endIndex:m}=c;if(i<=d&&o>=m){a.push({...c,startIndex:d-n,endIndex:m-n});continue}else if(d<=i&&m>=o){const f=FC(d,m,i,o);c.startIndex=f[0],c.endIndex=f[1]}else o<d&&(c.startIndex-=e,c.endIndex-=e);s.push(c)}t.customRanges=s}return a}function zW(t,e,n){const{dataStream:r}=t,i=n,o=n+e,a=ML(t,e,n),s=NL(t,e,n),u=xL(t,e,n),l=FL(t,e,n),c=$L(t,e,n),d=kL(t,e,n);let m="";return r&&(t.dataStream=CL(r,i,o),m=r.slice(i,o)),{dataStream:m,textRuns:a,paragraphs:s,sectionBreaks:u,customBlocks:l,tables:c,customRanges:d}}function WW(t,e,n,r){t.dataStream=_L(t.dataStream,r,e.dataStream),OL(t,e,n,r),$C(t,e,n,r),HW(t,e,n,r),PL(t,e,n,r),kC(t,e,n,r),jW(t,e,n,r)}var Js=(t=>(t[t.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",t[t.NONE=1]="NONE",t[t.DECIMAL=2]="DECIMAL",t[t.ZERO_DECIMAL=3]="ZERO_DECIMAL",t[t.UPPER_ALPHA=4]="UPPER_ALPHA",t[t.ALPHA=5]="ALPHA",t[t.UPPER_ROMAN=6]="UPPER_ROMAN",t[t.ROMAN=7]="ROMAN",t))(Js||{}),e1=(t=>(t[t.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",t[t.START=1]="START",t[t.CENTER=2]="CENTER",t[t.END=3]="END",t))(e1||{}),Uo=(t=>(t[t.DEFAULT=0]="DEFAULT",t[t.LINES=1]="LINES",t[t.LINES_AND_CHARS=2]="LINES_AND_CHARS",t[t.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",t))(Uo||{}),Ah=(t=>(t[t.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",t[t.CONTINUOUS=1]="CONTINUOUS",t[t.NEXT_PAGE=2]="NEXT_PAGE",t[t.EVEN_PAGE=3]="EVEN_PAGE",t[t.ODD_PAGE=4]="ODD_PAGE",t))(Ah||{}),em=(t=>(t[t.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",t[t.NONE=1]="NONE",t[t.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",t))(em||{}),A6=(t=>(t[t.BOTH_SIDES=0]="BOTH_SIDES",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.LARGEST=3]="LARGEST",t))(A6||{}),i1=(t=>(t[t.INLINE=0]="INLINE",t[t.WRAP_NONE=1]="WRAP_NONE",t[t.WRAP_POLYGON=2]="WRAP_POLYGON",t[t.WRAP_SQUARE=3]="WRAP_SQUARE",t[t.WRAP_THROUGH=4]="WRAP_THROUGH",t[t.WRAP_TIGHT=5]="WRAP_TIGHT",t[t.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",t))(i1||{}),Th=(t=>(t[t.AUTO=0]="AUTO",t[t.AT_LEAST=1]="AT_LEAST",t[t.EXACT=2]="EXACT",t))(Th||{}),l6=(t=>(t.NORMAL="normal",t.BOLD="bold",t.ITALIC="italic",t))(l6||{}),Hr=(t=>(t[t.CHARACTER=0]="CHARACTER",t[t.COLUMN=1]="COLUMN",t[t.INSIDE_MARGIN=2]="INSIDE_MARGIN",t[t.LEFT_MARGIN=3]="LEFT_MARGIN",t[t.MARGIN=4]="MARGIN",t[t.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",t[t.PAGE=6]="PAGE",t[t.RIGHT_MARGIN=7]="RIGHT_MARGIN",t))(Hr||{}),qr=(t=>(t[t.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",t[t.INSIDE_MARGIN=1]="INSIDE_MARGIN",t[t.LINE=2]="LINE",t[t.MARGIN=3]="MARGIN",t[t.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",t[t.PAGE=5]="PAGE",t[t.PARAGRAPH=6]="PARAGRAPH",t[t.TOP_MARGIN=7]="TOP_MARGIN",t))(qr||{}),BL=(t=>(t[t.POINT=0]="POINT",t[t.LINE=1]="LINE",t[t.CHARACTER=2]="CHARACTER",t))(BL||{}),Iu=(t=>(t[t.CENTER=0]="CENTER",t[t.INSIDE=1]="INSIDE",t[t.LEFT=2]="LEFT",t[t.OUTSIDE=3]="OUTSIDE",t[t.RIGHT=4]="RIGHT",t))(Iu||{}),N2=(t=>(t[t.BOTTOM=0]="BOTTOM",t[t.CENTER=1]="CENTER",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE",t[t.TOP=4]="TOP",t))(N2||{}),i5=(t=>(t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE",t))(i5||{}),tm=(t=>(t.BULLET_LIST="BULLET_LIST",t.ORDER_LIST="ORDER_LIST",t))(tm||{});const YW={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:[{bulletAlignment:e1.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"●",hanging:21,indentStart:21},{bulletAlignment:e1.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"■",hanging:21,indentStart:42},{bulletAlignment:e1.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"◆",hanging:21,indentStart:63}]},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:[{bulletAlignment:e1.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Js.DECIMAL,hanging:21,indentStart:21},{bulletAlignment:e1.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Js.DECIMAL,hanging:21,indentStart:42},{bulletAlignment:e1.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Js.DECIMAL,hanging:21,indentStart:63}]}};function XW(t,e,n,r,i){const o=qW(t,e,n,r,i),a=GW(t,e,n,r,i),s=KW(t,e,n,r,i),u=ZW(t,e,n,r,i),l=QW(t,e,n,r,i),c=JW(t,e,n,r,i);return{dataStream:"",textRuns:o,paragraphs:a,sectionBreaks:s,customBlocks:u,tables:l,customRanges:c}}function qW(t,e,n,r,i){const{textRuns:o}=t,{textRuns:a}=e;if(o==null||a==null)return;const s=ML(t,n,r);if(i!==Ii.REPLACE){const u=UL(a,s,i);e.textRuns=u}return OL(t,e,n,r),s}function UL(t,e,n){if(e.length===0)return t;t=Ie.deepClone(t),e=Ie.deepClone(e);const r=[],i=t.length,o=e.length;let a=0,s=0,u=null;function l(){return u?(r.push(u),u=null,!0):!1}for(;a<i&&s<o;){const{st:f,ed:h,ts:p}=t[a],{st:v,ed:g,ts:b,sId:C}=e[s];let S;n===Ii.COVER?S={...b,...p}:S={...p,...b},h<v?(l()||r.push(t[a]),a++):g<f?(l()||r.push(e[s]),s++):(r.push({st:Math.min(f,v),ed:Math.max(f,v),ts:f<v?{...p}:{...b},sId:f<v?void 0:C}),r.push({st:Math.max(f,v),ed:Math.min(h,g),ts:S,sId:C}),h<g?(a++,e[s].st=h):(s++,t[a].st=g),u={st:Math.min(h,g),ed:Math.max(h,g),ts:h<g?{...b}:{...p},sId:h<g?C:void 0})}l();const c=r[r.length-1],d=t[i-1],m=e[o-1];return c.ed!==Math.max(d.ed,m.ed)&&(d.ed>m.ed?r.push(d):r.push(m)),LL(r)}function GW(t,e,n,r,i){const{paragraphs:o}=t,{paragraphs:a}=e;if(o==null||a==null)return;const s=NL(t,n,r);if(i!==Ii.REPLACE){const u=[];for(const l of a){const{startIndex:c,paragraphStyle:d,bullet:m}=l;let f=[];for(const h of s){const{startIndex:p,paragraphStyle:v,bullet:g}=h;let b,C;if(i===Ii.COVER?(b={...v,...d},C={listId:"",listType:tm.BULLET_LIST,nestingLevel:0,textStyle:{},...g,...m}):(b={...d,...v},C={listId:"",listType:tm.BULLET_LIST,nestingLevel:0,textStyle:{},...m,...g}),c===p){f.push({startIndex:c,paragraphStyle:b,bullet:C});break}}u.push(...f),f=[]}e.paragraphs=u}return $C(t,e,n,r),s}function KW(t,e,n,r,i){const{sectionBreaks:o}=t,{sectionBreaks:a}=e;if(o==null||a==null)return;const s=xL(t,n,r);if(i!==Ii.REPLACE){const u=[];for(const l of a){const{startIndex:c}=l;let d=[];for(const m of s){const{startIndex:f}=m;if(c===f){i===Ii.COVER?d.push({...m,...l}):d.push({...l,...m});break}}u.push(...d),d=[]}e.sectionBreaks=u}return $C(t,e,n,r),s}function ZW(t,e,n,r,i){const{customBlocks:o}=t,{customBlocks:a}=e;if(o==null||a==null)return;const s=FL(t,n,r);if(i!==Ii.REPLACE){const u=[];for(const l of a){const{startIndex:c}=l;let d=[];for(const m of s){const{startIndex:f}=m;if(c===f){i===Ii.COVER?d.push({...m,...l}):d.push({...l,...m});break}}u.push(...d),d=[]}e.customBlocks=u}return PL(t,e,n,r),s}function QW(t,e,n,r,i){const{tables:o}=t,{tables:a}=e;if(o==null||a==null)return;const s=$L(t,n,r);if(i!==Ii.REPLACE){const u=[];for(const l of a){const{startIndex:c,endIndex:d}=l;let m=[];for(const f of s){const{startIndex:h,endIndex:p}=f;if(h>=c&&p<=d){i===Ii.COVER?m.push({...f,...l}):m.push({...l,...f});break}}u.push(...m),m=[]}e.tables=u}return kC(t,e,n,r),s}function JW(t,e,n,r,i){const{customRanges:o}=t,{tables:a}=e;if(o==null||a==null)return;const s=kL(t,n,r);if(i!==Ii.REPLACE){const u=[];for(const l of a){const{startIndex:c,endIndex:d}=l;let m=[];for(const f of s){const{startIndex:h,endIndex:p}=f;if(h>=c&&p<=d){i===Ii.COVER?m.push({...f,...l}):m.push({...l,...f});break}}u.push(...m),m=[]}e.customRanges=u}return kC(t,e,n,r),s}var jt=(t=>(t.RETAIN="r",t.INSERT="i",t.DELETE="d",t))(jt||{});function VL(t,e,n){const{dataStream:r,textRuns:i=[],paragraphs:o=[]}=t,a={dataStream:r.slice(e,n)},s=[];for(const l of i){const c=Ie.deepClone(l),{st:d,ed:m}=c;Ie.hasIntersectionBetweenTwoRanges(d,m,e,n)&&(e>=d&&e<=m?s.push({...c,st:e,ed:Math.min(n,m)}):n>=d&&n<=m?s.push({...c,st:Math.max(e,d),ed:n}):s.push(c))}s.length&&(a.textRuns=s.map(l=>{const{st:c,ed:d}=l;return{...l,st:c-e,ed:d-e}}));const u=[];for(const l of o){const{startIndex:c}=l;c>=e&&c<=n&&u.push(Ie.deepClone(l))}return u.length&&(a.paragraphs=u.map(l=>({...l,startIndex:l.startIndex-e}))),a}function dD(t,e,n=Ii.COVER){if(e.dataStream!=="")throw new Error("Cannot compose other body with non-empty dataStream");const r={dataStream:t.dataStream},{textRuns:i=[],paragraphs:o=[]}=t,{textRuns:a=[],paragraphs:s=[]}=e,u=UL(a,i,n);u.length&&(r.textRuns=u);const l=[];let c=0,d=0;for(;c<o.length&&d<s.length;){const m=o[c],f=s[d],{startIndex:h}=m,{startIndex:p}=f;h===p?(l.push(Ie.deepMerge(m,f)),c++,d++):h<p?(l.push(Ie.deepClone(m)),c++):(l.push(Ie.deepClone(f)),d++)}return c<o.length&&l.push(...o.slice(c)),d<s.length&&l.push(...s.slice(d)),l.length&&(r.paragraphs=l),r}function eY(t){const{body:e}=t;if(e==null)return!0;const{textRuns:n=[],paragraphs:r=[]}=e;return n.length===0&&r.length===0}const HL={id:"default_doc",documentStyle:{}};let tY=class{constructor(e){ge(this,"snapshot"),this.snapshot={...HL,...e}}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get body(){return this.snapshot.body}get zoomRatio(){var e;return((e=this.snapshot.settings)==null?void 0:e.zoomRatio)||1}getBody(){return this.snapshot.body}getShouldRenderLoopImmediately(){return this.snapshot.shouldStartRenderingImmediately!==!1}getContainer(){return this.snapshot.container}getParentRenderUnitId(){return this.snapshot.parentRenderUnitId}getSnapshot(){return this.snapshot}updateDocumentId(e){this.snapshot.id=e}updateDocumentRenderConfig(e){const{documentStyle:n}=this.snapshot;n.renderConfig==null?n.renderConfig=e:n.renderConfig={...n.renderConfig,...e}}updateDocumentDataMargin(e){const{t:n,l:r,b:i,r:o}=e,{documentStyle:a}=this.snapshot;n!=null&&(a.marginTop=n),r!=null&&(a.marginLeft=r),i!=null&&(a.marginBottom=i),o!=null&&(a.marginRight=o)}updateDocumentDataPageSize(e,n){const{documentStyle:r}=this.snapshot;if(!r.pageSize){e=e??Number.POSITIVE_INFINITY,n=n??Number.POSITIVE_INFINITY,r.pageSize={width:e,height:n};return}e!==void 0&&(r.pageSize.width=e),n!==void 0&&(r.pageSize.height=n)}updateDrawing(e,n){const{drawings:r}=this,{width:i,height:o,left:a,top:s}=n,u=r==null?void 0:r[e];if(!u)return;const l=u.objectTransform;l.size.width=i,l.size.height=o,l.positionH.posOffset=a,l.positionV.posOffset=s}setZoomRatio(e=1){this.snapshot.settings==null?this.snapshot.settings={zoomRatio:e}:this.snapshot.settings.zoomRatio=1}},nm=class Cv extends tY{constructor(e){var n;super(e),ge(this,"_unitId"),ge(this,"headerModelMap",new Map),ge(this,"footerModelMap",new Map);const r=6;this._unitId=(n=this.snapshot.id)!=null?n:Ie.generateRandomId(r),this._initializeHeaderFooterModel()}dispose(){this.headerModelMap.forEach(e=>{e.dispose()}),this.footerModelMap.forEach(e=>{e.dispose()})}getRev(){var e;return(e=this.snapshot.rev)!=null?e:1}incrementRev(){this.snapshot.rev=this.getRev()+1}getSettings(){return this.snapshot.settings}reset(e){if(e.id&&e.id!==this._unitId)throw new Error("Cannot reset a document model with a different unit id!");this.snapshot={...HL,...e},this._initializeHeaderFooterModel()}getSelfOrHeaderFooterModel(e){if(e!=null){if(this.headerModelMap.has(e))return this.headerModelMap.get(e);if(this.footerModelMap.has(e))return this.footerModelMap.get(e)}return this}getUnitId(){return this._unitId}apply(e){const n=[],r=new Xm;return r.reset(),e.forEach(i=>{if(i=Ie.deepClone(i),i.t===jt.RETAIN){const{coverType:o,body:a,len:s,segmentId:u}=i;if(a!=null){const l=this._updateApply(a,s,r.cursor,o,u);n.push({...i,t:jt.RETAIN,coverType:Ii.REPLACE,body:l})}else n.push({...i,t:jt.RETAIN});r.moveCursor(s)}else if(i.t===jt.INSERT){const{body:o,len:a,segmentId:s,line:u}=i;this._insertApply(o,a,r.cursor,s),r.moveCursor(a),n.push({t:jt.DELETE,len:a,line:u,segmentId:s})}else if(i.t===jt.DELETE){const{len:o,segmentId:a}=i,s=this._deleteApply(o,r.cursor,a);n.push({...i,t:jt.INSERT,body:s})}else throw new Error(`Unknown action type for action: ${i}.`)}),n}sliceBody(e,n){const r=this.getBody();if(r!=null)return VL(r,e,n)}_updateApply(e,n,r,i=Ii.COVER,o){if(e==null)throw new Error("updateBody is none");const a=this.snapshot,s=h4(a,o);if(s==null)throw new Error("no body has changed");return XW(s,e,n,r,i)}_deleteApply(e,n,r){const i=this.snapshot,o=h4(i,r);if(o==null)throw new Error("no body has changed");return e<=0?{dataStream:""}:zW(o,e,n)}_insertApply(e,n,r,i){const o=this.snapshot,a=h4(o,i);if(n!==0){if(a==null)throw new Error("no body has changed");WW(a,e,n,r)}}_initializeHeaderFooterModel(){const{headers:e,footers:n}=this.getSnapshot();if(e)for(const r in e){const i=e[r];this.headerModelMap.set(r,new Cv(i))}if(n)for(const r in n){const i=n[r];this.footerModelMap.set(r,new Cv(i))}}updateDocumentId(e){super.updateDocumentId(e),this._unitId=e}};const nY="0.1.0-beta.5",dp={sheetId:"",range:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},rY={id:"",sheetOrder:[],name:"",appVersion:nY,locale:t5.ZH_CN,styles:{},sheets:{},resources:[]},mp={ff:"Times New Roman",fs:14,it:we.FALSE,bl:we.FALSE,ul:{s:we.FALSE},st:{s:we.FALSE},ol:{s:we.FALSE},tr:{a:0,v:we.FALSE},td:Eh.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:Zn.UNSPECIFIED,vt:li.UNSPECIFIED,tb:Ar.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},iY={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};let oY=class{constructor(e={}){ge(this,"_styles"),ge(this,"_cacheMap",new r5(1e5)),this._styles=e,this._generateCacheMap()}each(e){return Object.entries(this._styles).forEach(e),this}search(e,n){return this._cacheMap.has(n)?this._cacheMap.get(n):this._getExistingStyleId(e)||"-1"}get(e){return typeof e!="string"?e:(e=String(e),this._styles[e])}add(e,n){const r=Ie.generateRandomId(6);return this._styles[r]=e,this._cacheMap.set(n,r),r}setValue(e){if(e==null)return;const n=JSON.stringify(e),r=this.search(e,n);return r!=="-1"?r:this.add(e,n)}toJSON(){return this._styles}getStyleByCell(e){let n;e&&Ie.isObject(e.s)?n=e.s:n=(e==null?void 0:e.s)&&this.get(e.s);const r=e==null?void 0:e.interceptorStyle;return r?{...n,...r}:n}_generateCacheMap(){const{_styles:e,_cacheMap:n}=this;for(const r in e){const i=JSON.stringify(e[r]);n.set(i,r)}}_getExistingStyleId(e){const{_styles:n}=this;for(const r in n)if(Ie.diffValue(n[r],e))return r;return null}};function jL(t){return t&&(t.s!==void 0||t.p!==void 0||t.v!==void 0||t.t!==void 0||t.f!==void 0||t.si!==void 0)}function aY(t){if(t.t!==void 0)return t.t;if(typeof t.v=="string")return $n.STRING;if(typeof t.v=="number")return $n.NUMBER;if(typeof t.v=="boolean")return $n.BOOLEAN}function T6(t){if(t==null)return!0;const{v:e,f:n,si:r,p:i,s:o}=t;return!(!(e==null||typeof e=="string"&&e.length===0)||n!=null&&n.length>0||r!=null&&r.length>0||i!=null)}var zL=(t=>(t[t.SLIDE=0]="SLIDE",t[t.MASTER=1]="MASTER",t[t.LAYOUT=2]="LAYOUT",t[t.HANDOUT_MASTER=3]="HANDOUT_MASTER",t[t.NOTES_MASTER=4]="NOTES_MASTER",t))(zL||{});let sY=class{constructor(e,n){ge(this,"_columnData",{}),this._config=e,this._columnData=n}getColumnData(){return this._columnData}getColVisible(e){const{_columnData:n}=this,r=n[e];return r?r.hd!==we.TRUE:!0}getHiddenCols(e=0,n=this.getSize()-1){const r=[];let i=!1,o=-1;for(let a=e;a<=n;a++){const s=this.getColVisible(a);i&&s?(i=!1,r.push({rangeType:ct.COLUMN,startColumn:o,endColumn:a-1,startRow:0,endRow:0})):!i&&!s&&(i=!0,o=a)}return i&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:n,rangeType:ct.COLUMN}),r}getVisibleCols(e=0,n=this.getSize()-1){const r=[];let i=!1,o=-1;for(let a=e;a<=n;a++){const s=this.getColVisible(a);i&&!s?(i=!1,r.push({rangeType:ct.COLUMN,startColumn:o,endColumn:a-1,startRow:0,endRow:0})):!i&&s&&(i=!0,o=a)}return i&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:n,rangeType:ct.COLUMN}),r}getColumnDatas(e,n){const r={};let i=0;for(let o=e;o<e+n;o++){const a=this.getColumnOrCreate(o);r[i]=a,i++}return r}getSize(){return Ss(this._columnData)}getColumnWidth(e){const{_columnData:n}=this,r=this._config;let i=0;return i=(n[e]||{hd:we.FALSE,w:r.defaultColumnWidth}).w||r.defaultColumnWidth,i}getColumn(e){const n=this._columnData[e];if(n)return n}getColumnOrCreate(e){const{_columnData:n}=this,r=this._config,i=n[e];if(i)return i;const o={w:r.defaultColumnWidth,hd:we.FALSE};return this._columnData[e]=o,o}};function t3(t,e){const{textRuns:n=[],paragraphs:r=[],sectionBreaks:i=[]}=e;let o=0;for(const a of n){const{ts:s={},st:u,ed:l}=a;if(s[t]==null)return we.FALSE;switch(t){case"bl":case"it":{if(s[t]===we.FALSE)return we.FALSE;break}case"ul":case"st":{if(s[t].s===we.FALSE)return we.FALSE;break}default:throw new Error(`unknown style key: ${t} in IStyleBase`)}o+=l-u}return e.dataStream.length-r.length-i.length===o?we.TRUE:we.FALSE}let mr=class Sv{constructor(e,n,r){ge(this,"_range"),ge(this,"_worksheet"),this._deps=r,this._range=n,this._worksheet=e}static foreach(e,n){const{startRow:r,startColumn:i,endRow:o,endColumn:a}=e;for(let s=r;s<=o;s++)for(let u=i;u<=a;u++)n(s,u)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range,o=[];for(let a=e;a<=n;a++){const s=[];for(let u=r;u<=i;u++)s.push(this.getMatrix().getValue(a,u)||null);o.push(s)}return o}getMatrix(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range,o=this._worksheet.getCellMatrix(),a=new Ye;for(let s=e;s<=n;s++)for(let u=r;u<=i;u++)a.setValue(s,u,o.getValue(s,u)||null);return a}getMatrixObject(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range,o=this._worksheet.getCellMatrix(),a=new Ye;for(let s=e;s<=n;s++)for(let u=r;u<=i;u++)a.setValue(s-e,u-r,o.getValue(s,u)||{});return a}getA1Notation(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this._range;let o,a;return r<i?(o=Ie.numToWord(r+1)+(e+1),a=Ie.numToWord(i+1)+(n+1)):(o=Ie.numToWord(i+1)+(n+1),a=Ie.numToWord(r+1)+(e+1)),o===a?`${o}`:`${o}:${a}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const o=e.getStyleByCell(r);return((i=o==null?void 0:o.bg)==null?void 0:i.rgb)||mp.bg.rgb}))}getCell(e,n){const{startRow:r,endRow:i,startColumn:o,endColumn:a}=this._range,s={startRow:r+e,endRow:r+e,startColumn:o+n,endColumn:o+n};return new Sv(this._worksheet,s,this._deps)}getColumn(){return this._range.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){var n;const{startRow:r,endRow:i,startColumn:o,endColumn:a}=this._range,s=this._worksheet.getCellMatrix().getFragment(r,i,o,a).getData();if(e.isIncludeStyle){const u=this._deps.getStyles();for(let l=0;l<=i-r;l++)for(let c=0;c<=a-o;c++){if(s==null||((n=s==null?void 0:s[l])==null?void 0:n[c])==null)continue;const d=s[l][c].s;d&&(s[l][c].s=u.get(d))}}return s}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var i;const o=e.getStyleByCell(r);return((i=o==null?void 0:o.cl)==null?void 0:i.rgb)||mp.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?t3("ul",r.body)===we.TRUE?{s:we.TRUE}:{s:we.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?t3("st",r.body)===we.TRUE?{s:we.TRUE}:{s:we.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?t3("it",r.body)===we.TRUE?S0.ITALIC:S0.NORMAL:this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?t3("bl",r.body)===we.TRUE?E0.BOLD:E0.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_range:e,_worksheet:n}=this,{startRow:r,endRow:i}=e;let o=0;for(let a=0;a<=i-r;a++){const s=n.getRowHeight(a);o+=s}return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){const{startColumn:e,endColumn:n}=this._range;return n-e+1}getNumRows(){const{startRow:e,endRow:n}=this._range;return n-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(n=>(n==null?void 0:n.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>e.getStyleByCell(r)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_range:e,_worksheet:n}=this,{startColumn:r,endColumn:i}=e;let o=0;for(let a=0;a<=i-r;a++)o+=n.getColumnWidth(a);return o}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(e){Sv.foreach(this._range,e)}_getStyles(e){const n=this._deps.getStyles();return this.getValues().map(r=>r.map(i=>{const o=n&&n.getStyleByCell(i);return o&&o[e]||mp[e]}))}},uY=class{constructor(e,n){ge(this,"_rowData"),this._config=e,this._rowData=n}getRowData(){return this._rowData}getRowDatas(e,n){const r={};let i=0;for(let o=e;o<e+n;o++){const a=this.getRowOrCreate(o);r[i]=a,i++}return r}getRowHeight(e,n=1){const{_rowData:r}=this,i=this._config;let o=0;for(let a=0;a<n;a++){const s=r[a+e]||{hd:we.FALSE,h:i.defaultRowHeight},{ia:u,ah:l,h:c=i.defaultRowHeight}=s;o+=(u==null||u===we.TRUE)&&typeof l=="number"?l:c}return o}getRow(e){return this._rowData[e]}getRowOrCreate(e){const{_rowData:n}=this,r=n[e];if(r)return r;const i=this._config,o={hd:we.FALSE,h:i.defaultRowHeight};return n[e]=o,o}getHiddenRows(e=0,n=this.getSize()-1){const r=[];let i=!1,o=-1;for(let a=e;a<=n;a++){const s=this.getRowVisible(a);i&&s?(i=!1,r.push({startRow:o,endRow:a-1,startColumn:0,endColumn:0,rangeType:ct.ROW})):!i&&!s&&(i=!0,o=a)}return i&&r.push({startRow:o,endRow:n,startColumn:0,endColumn:0,rangeType:ct.ROW}),r}getVisibleRows(e=0,n=this.getSize()-1){const r=[];let i=!1,o=-1;for(let a=e;a<=n;a++){const s=this.getRowVisible(a);i&&!s?(i=!1,r.push({startRow:o,endRow:a-1,startColumn:0,endColumn:0,rangeType:ct.ROW})):!i&&s&&(i=!0,o=a)}return i&&r.push({startRow:o,endRow:n,startColumn:0,endColumn:0,rangeType:ct.ROW}),r}getRowVisible(e){const n=this.getRow(e);return n?n.hd!==we.TRUE:!0}getSize(){return Ss(this._rowData)}};const lY=1e3,cY=20,Ev=19,mD="DEFAULT_WORKSHEET_COLUMN_WIDTH",yv=73,dY=46,mY=20;function WL(t){const e={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:we.FALSE,rowCount:lY,columnCount:cY,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:yv,defaultRowHeight:Ev,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:we.TRUE,rowHeader:{width:dY,hidden:we.FALSE},columnHeader:{height:mY,hidden:we.FALSE},selections:["A1"],rightToLeft:we.FALSE};return Object.keys(e).forEach(n=>{const r=n;typeof t[r]>"u"&&(t[r]=e[r])}),t}let fY=class extends We{constructor(){super(...arguments),ge(this,"_cellContentInterceptors",[]),ge(this,"_rowFilteredInterceptors",[]),ge(this,"_rowVisibleInterceptors",[]),ge(this,"_colVisibleInterceptors",[])}dispose(){super.dispose(),this._cellContentInterceptors.length=0,this._rowFilteredInterceptors.length=0,this._rowVisibleInterceptors.length=0,this._colVisibleInterceptors.length=0}getCell(e,n){for(const r of this._cellContentInterceptors){const i=r.getCell(e,n);if(typeof i<"u")return i}return null}registerCellContentInterceptor(e){if(this._cellContentInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptors.push(e),je(()=>r1(this._cellContentInterceptors,e))}registerRowFilteredInterceptor(e){if(this._rowFilteredInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptors.push(e),je(()=>r1(this._rowFilteredInterceptors,e))}registerRowVisibleInterceptor(e){if(this._rowVisibleInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowVisibleInterceptors.push(e),je(()=>r1(this._rowVisibleInterceptors,e))}registerColVisibleInterceptor(e){if(this._colVisibleInterceptors.includes(e))throw new Error("[SheetViewModel]: Interceptor already registered.");return this._colVisibleInterceptors.push(e),je(()=>r1(this._colVisibleInterceptors,e))}},fD=class YL{constructor(e,n){ge(this,"_initialized"),ge(this,"_sheetId"),ge(this,"_snapshot"),ge(this,"_cellData"),ge(this,"_rowManager"),ge(this,"_columnManager"),ge(this,"_viewModel");var r;this._styles=n,this._snapshot=WL(e);const{columnData:i,rowData:o,cellData:a}=this._snapshot;this._sheetId=(r=this._snapshot.id)!=null?r:Ie.generateRandomId(6),this._initialized=!1,this._cellData=new Ye(a),this._rowManager=new uY(this._snapshot,o),this._columnManager=new sY(this._snapshot,i),this._viewModel=new fY}__interceptViewModel(e){e(this._viewModel)}getSnapshot(){return this._snapshot}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){const e=this.getCellMatrix(),n=this.getMergeData();let r=-1,i=-1,o=-1,a=-1,s=!1,u=!1;return e.forEach((l,c)=>{Object.keys(c).forEach(d=>{const m=+d,f=e.getValue(l,m),h=f!=null&&f.s?this._styles.get(f.s):null,p=(h==null?void 0:h.bd)&&(h.bd.b||h.bd.l||h.bd.r||h.bd.t||h.bd.bc_tr||h.bd.bl_tr||h.bd.ml_tr||h.bd.tl_bc||h.bd.tl_br||h.bd.tl_mr);(f&&(f.v||f.p)||h!=null&&h.bg||p)&&(s?r=Math.min(r,l):(r=l,s=!0),i=Math.max(i,l),u?o=Math.min(o,m):(u=!0,o=m),a=Math.max(a,m))})}),n.forEach(l=>{s?r=Math.min(r,l.startRow):(r=l.startRow,s=!0),i=Math.max(i,l.endRow),u?o=Math.min(o,l.startColumn):(o=l.startColumn,s=!0),a=Math.max(a,l.endColumn)}),!s||!u?null:{startColumn:o,startRow:r,endColumn:a,endRow:i}}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){const{_snapshot:e}=this,n=Ie.deepClone(e);return new YL(n,this._styles)}getMergeData(){return this._snapshot.mergeData}getMergedCells(e,n){const r=this._snapshot.mergeData,i=[];for(let o=0;o<r.length;o++){const a=r[o];ht.intersects({startRow:e,startColumn:n,endRow:e,endColumn:n},a)&&i.push(a)}return i.length?i:null}getMergedCell(e,n){const r=this._snapshot.mergeData;for(let i=0;i<r.length;i++){const o=r[i];if(ht.intersects({startRow:e,startColumn:n,endRow:e,endColumn:n},o))return o}return null}getCell(e,n){return e<0||n<0?null:this._viewModel.getCell(e,n)}getCellRaw(e,n){return this.getCellMatrix().getValue(e,n)}getMatrixWithMergedCells(e,n,r,i){const o=this.getCellMatrix(),a=this._snapshot.mergeData.filter(u=>ht.intersects({startRow:e,startColumn:n,endRow:r,endColumn:i},u)),s=new Ye;return lD(e,r,n,i).forEach((u,l)=>{const c=o.getValue(u,l);c&&s.setValue(u,l,c)}),a.forEach(u=>{const{startColumn:l,startRow:c,endColumn:d,endRow:m}=u;lD(c,m,l,d).forEach((f,h)=>{f===c&&h===l&&s.setValue(f,h,{...o.getValue(f,h),rowSpan:m-c+1,colSpan:d-l+1}),(f!==c||h!==l)&&s.realDeleteValue(f,h)})}),s}getRange(e,n,r,i){return typeof e=="object"?new mr(this,e,{getStyles:()=>this._styles}):new mr(this,{startRow:e,startColumn:n,endColumn:i||n,endRow:r||e},{getStyles:()=>this._styles})}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){const{_snapshot:e}=this,{columnCount:n}=e;return n}getMaxRows(){const{_snapshot:e}=this,{rowCount:n}=e;return n}getRowCount(){return this._snapshot.rowCount}setRowCount(e){this._snapshot.rowCount=e}getColumnCount(){return this._snapshot.columnCount}setColumnCount(e){this._snapshot.columnCount=e}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){const{_snapshot:e}=this,{showGridlines:n}=e;return n===0}getTabColor(){const{_snapshot:e}=this,{tabColor:n}=e;return n}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}getRowVisible(e){return this.getRowManager().getRowVisible(e)}getHiddenRows(e,n){const r=this.getMaxColumns()-1,i=this._rowManager.getHiddenRows(e,n);return i.forEach(o=>o.endColumn=r),i}getColVisible(e){return this._columnManager.getColVisible(e)}getHiddenCols(e,n){const r=this.getMaxRows()-1,i=this._columnManager.getHiddenCols(e,n);return i.forEach(o=>o.endRow=r),i}getVisibleRows(){const e=this.getRowCount();return this._rowManager.getVisibleRows(0,e-1)}getVisibleCols(){const e=this.getColumnCount();return this._columnManager.getVisibleCols(0,e-1)}isRightToLeft(){const{_snapshot:e}=this,{rightToLeft:n}=e;return n}getLastRowWithContent(){return this._cellData.getLength()-1}getLastColumnWithContent(){return this._cellData.getRange().endColumn}cellHasValue(e){return e&&(e.v!==void 0||e.f!==void 0||e.p!==void 0)}};var hY=Object.defineProperty,pY=Object.getOwnPropertyDescriptor,gY=(t,e,n,r)=>{for(var i=r>1?void 0:r?pY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&hY(e,n,i),i},vY=(t,e)=>(n,r)=>e(n,r,t);function bY(t,e){return`${t.getUnitId()}|${e.getSheetId()}`}let wh=class extends We{constructor(e={},n){super(),ge(this,"_sheetCreated$",new an),ge(this,"sheetCreated$",this._sheetCreated$.asObservable()),ge(this,"_sheetDisposed$",new an),ge(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),ge(this,"_activeSheet$",new dn(null)),ge(this,"activeSheet$",this._activeSheet$.asObservable()),ge(this,"_worksheets"),ge(this,"_styles"),ge(this,"_snapshot"),ge(this,"_unitId"),ge(this,"_count"),this._logService=n,this._snapshot=Ie.commonExtend(rY,e);const{styles:r}=this._snapshot;(this._snapshot.id==null||this._snapshot.id.length===0)&&(this._snapshot.id=Ie.generateRandomId(6)),this._unitId=this._snapshot.id,this._styles=new oY(r),this._count=1,this._worksheets=new Map,this._passWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._snapshot.name}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete()}save(){return Ie.deepClone(this._snapshot)}static isIRangeType(e){return typeof e=="string"||"startRow"in e||"row"in e}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}getUnitId(){return this._unitId}getRev(){var e;return(e=this._snapshot.rev)!=null?e:1}incrementRev(){this._snapshot.rev=this.getRev()+1}getShouldRenderLoopImmediately(){return this._snapshot.shouldStartRenderingImmediately!==!1}getContainer(){return this._snapshot.container}addWorksheet(e,n,r){const{sheets:i,sheetOrder:o}=this._snapshot;if(i[e])return!1;i[e]=r,o.splice(n,0,e);const a=new fD(r,this._styles);return this._worksheets.set(e,a),this._sheetCreated$.next(a),!0}getParentRenderUnitId(){return this._snapshot.parentRenderUnitId}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getConfig(){return this._snapshot}getIndexBySheetId(e){const{sheetOrder:n}=this._snapshot;return n.findIndex(r=>r===e)}getRawActiveSheet(){return this._activeSheet}getActiveSheet(){const e=this.getRawActiveSheet();if(!e){const n=this._worksheets.get(this._snapshot.sheetOrder[0]);return this.setActiveSheet(n),n}return e}setActiveSheet(e){this._activeSheet$.next(e)}removeSheet(e){var n;return this._worksheets.get(e)?(((n=this._activeSheet)==null?void 0:n.getSheetId())===e&&this.setActiveSheet(null),this._worksheets.delete(e),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(e),1),delete this._snapshot.sheets[e],!0):!1}getActiveSheetIndex(){const{sheetOrder:e}=this._snapshot;return e.findIndex(n=>this._worksheets.get(n)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){const{sheetOrder:e}=this._snapshot;return e.map(n=>this._worksheets.get(n))}getSheetsName(){const{sheetOrder:e}=this._snapshot,n=[];return e.forEach(r=>{const i=this._worksheets.get(r);i&&n.push(i.getName())}),n}getSheetIndex(e){const{sheetOrder:n}=this._snapshot;return n.findIndex(r=>e.getSheetId()===r)}getSheetBySheetName(e){const{sheetOrder:n}=this._snapshot,r=n.find(i=>this._worksheets.get(i).getName()===e);return this._worksheets.get(r)}getSheetBySheetId(e){return this._worksheets.get(e)}getSheetByIndex(e){const{sheetOrder:n}=this._snapshot;return this._worksheets.get(n[e])}getHiddenWorksheets(){return this.getSheets().filter(e=>e.getConfig().hidden===we.TRUE).map(e=>e.getConfig().id)}transformRangeType(e){if(typeof e=="string")return this._getCellRange(e);if(typeof e!="string"&&"row"in e){const n=e;return{sheetId:"",range:{startRow:n.row[0],startColumn:n.column[0],endRow:n.row[1],endColumn:n.column[1]}}}return typeof e!="string"&&"startRow"in e?{sheetId:"",range:e}:dp}load(e){this._snapshot=e}checkSheetName(e){return this.getSheetsName().includes(e)}uniqueSheetName(e="Sheet1"){let n=e;for(;this.checkSheetName(n);)n=e+this._count,this._count++;return n}generateNewSheetName(e){let n=e+this._count;for(;this.checkSheetName(n);)n=e+this._count,this._count++;return n}_getCellRange(e){var n,r,i,o,a;let s="",u="";if(e.indexOf("!")>-1){const f=e.split("!");s=f[0],u=f[1],s=s.replace(/\\'/g,"'").replace(/''/g,"'"),s.substring(0,1)==="'"&&s.substring(s.length-1,1)==="'"&&(s=s.substring(1,s.length-1))}else u=e;if(u.indexOf(":")===-1){const f=Number.parseInt(u.replace(/[^0-9]/g,""),10)-1,h=Ie.ABCatNum(u.replace(/[^A-Za-z]/g,""));return!Number.isNaN(f)&&!Number.isNaN(h)?{sheetId:s,range:{startRow:f,endRow:f,startColumn:h,endColumn:h}}:dp}u=u.split(":");const l=[0,0],c=[0,0],d=((n=this.getSheetBySheetName(s))==null?void 0:n.getMaxRows())||((r=this.getActiveSheet())==null?void 0:r.getMaxRows()),m=((i=this.getSheetBySheetName(s))==null?void 0:i.getMaxColumns())||((o=this.getActiveSheet())==null?void 0:o.getMaxColumns());return l[0]=Number.parseInt(u[0].replace(/[^0-9]/g,""),10)-1,l[1]=Number.parseInt(u[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(l[0])&&(l[0]=0),Number.isNaN(l[1])&&(l[1]=d),l[0]>l[1]||(c[0]=Ie.ABCatNum(u[0].replace(/[^A-Za-z]/g,"")),c[1]=Ie.ABCatNum(u[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(c[0])&&(c[0]=0),Number.isNaN(c[1])&&(c[1]=m),c[0]>c[1])?dp:{sheetId:((a=this.getSheetBySheetName(s))==null?void 0:a.getSheetId())||"",range:{startRow:l[0],endRow:l[1],startColumn:c[0],endColumn:c[1]}}}_passWorksheetSnapshots(){const{_snapshot:e,_worksheets:n}=this,{sheets:r,sheetOrder:i}=e;if(Ie.isEmptyObject(r)){const o=Ie.generateRandomId();r[o]={id:o}}for(const o in r){const a=r[o],{name:s}=a;a.name=this.uniqueSheetName(s),a.name!==s&&this._logService.error(`The worksheet name ${s} is duplicated, we change it to ${a.name}`);const u=new fD(a,this._styles);n.set(o,u),i.includes(o)||i.push(o)}}};wh=gY([vY(1,oo)],wh);let XL=class{constructor(e){ge(this,"_snapshot"),ge(this,"_unitId");var n;this._snapshot={...iY,...e},this._unitId=(n=this._snapshot.id)!=null?n:Ie.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return(e=this._snapshot.body)==null?void 0:e.pages}getPageOrder(){var e;return(e=this._snapshot.body)==null?void 0:e.pageOrder}getPage(e){const n=this.getPages();return n==null?void 0:n[e]}getElementsByPage(e){var n;return(n=this.getPage(e))==null?void 0:n.pageElements}getElement(e,n){var r;return(r=this.getElementsByPage(e))==null?void 0:r[n]}getPageSize(){return this._snapshot.pageSize}addPage(){return{id:"cover_1",pageType:zL.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}};const qo="FOCUSING_SHEET",So="FOCUSING_DOC",hD="FOCUSING_SLIDE",BC="FOCUSING_EDITOR_BUT_HIDDEN",Mr="EDITOR_ACTIVATED",rc="FOCUSING_EDITOR_INPUT_FORMULA",W1="FOCUSING_FORMULA_EDITOR",nl="FOCUSING_UNIVER_EDITOR";var _Y=Object.defineProperty,CY=Object.getOwnPropertyDescriptor,SY=(t,e,n,r)=>{for(var i=r>1?void 0:r?CY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&_Y(e,n,i),i},EY=(t,e)=>(n,r)=>e(n,r,t),or=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.DOC=1]="DOC",t[t.SHEET=2]="SHEET",t[t.SLIDE=3]="SLIDE",t))(or||{});const ae=ln("univer.current");let Dv=class extends We{constructor(e,n){super(),ge(this,"_focused",null),ge(this,"_focused$",new dn(null)),ge(this,"focused$",this._focused$.asObservable()),ge(this,"_currentSheet$",new dn(null)),ge(this,"currentSheet$",this._currentSheet$.asObservable()),ge(this,"_currentDoc$",new dn(null)),ge(this,"currentDoc$",this._currentDoc$.asObservable()),ge(this,"_currentSlide$",new dn(null)),ge(this,"currentSlide$",this._currentSlide$.asObservable()),ge(this,"_sheetAdded$",new an),ge(this,"sheetAdded$",this._sheetAdded$.asObservable()),ge(this,"_docAdded$",new an),ge(this,"docAdded$",this._docAdded$.asObservable()),ge(this,"_slideAdded$",new an),ge(this,"slideAdded$",this._slideAdded$.asObservable()),ge(this,"_sheetDisposed$",new an),ge(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),ge(this,"_docDisposed$",new an),ge(this,"docDisposed$",this._docDisposed$.asObservable()),ge(this,"_slideDisposed$",new an),ge(this,"slideDisposed$",this._slideDisposed$.asObservable()),ge(this,"_sheets",[]),ge(this,"_docs",[]),ge(this,"_slides",[]),this._handler=e,this._contextService=n}dispose(){super.dispose(),this._focused$.complete(),this._currentDoc$.complete(),this._currentSheet$.complete(),this._currentSlide$.complete(),this._sheetAdded$.complete(),this._docAdded$.complete(),this._slideAdded$.complete(),this._sheetDisposed$.complete(),this._docDisposed$.complete(),this._slideDisposed$.complete()}createDoc(e){return this._handler.createUniverDoc(e)}createSheet(e){return this._handler.createUniverSheet(e)}createSlide(e){return this._handler.createUniverSlide(e)}addSheet(e){this._sheets.push(e),this._sheetAdded$.next(e),this.setCurrentUniverSheetInstance(e.getUnitId())}changeDoc(e,n){const r=this._docs.find(i=>i.getUnitId()===e);if(r!=null){const i=this._docs.indexOf(r);this._docs.splice(i,1)}this.addDoc(n)}addDoc(e){this._docs.push(e),this._docAdded$.next(e),this.setCurrentUniverDocInstance(e.getUnitId())}addSlide(e){this._slides.push(e),this._slideAdded$.next(e),this.setCurrentUniverSlideInstance(e.getUnitId())}getUniverSheetInstance(e){return this._sheets.find(n=>n.getUnitId()===e)}getUniverDocInstance(e){return this._docs.find(n=>n.getUnitId()===e)}getUniverSlideInstance(e){return this._slides.find(n=>n.getUnitId()===e)}getAllUniverSheetsInstance(){return this._sheets}getAllUniverDocsInstance(){return this._docs}getAllUniverSlidesInstance(){return this._slides}setCurrentUniverSheetInstance(e){this._currentSheet$.next(this.getUniverSheetInstance(e)||null)}setCurrentUniverSlideInstance(e){this._currentSlide$.next(this.getUniverSlideInstance(e)||null)}setCurrentUniverDocInstance(e){this._currentDoc$.next(this.getUniverDocInstance(e)||null)}getCurrentUniverSheetInstance(){const e=this._currentSheet$.getValue();if(!e)throw new Error("No current sheet!");return e}getCurrentUniverDocInstance(){const e=this._currentDoc$.getValue();if(!e)throw new Error("No current doc!");return e}getCurrentUniverSlideInstance(){const e=this._currentSlide$.getValue();if(!e)throw new Error("No current slide!");return e}focusUniverInstance(e){e&&(this._focused=this.getUniverSheetInstance(e)||this.getUniverDocInstance(e)||this.getUniverSlideInstance(e)||null),this._focused$.next(e),[So,qo,hD].forEach(n=>this._contextService.setContextValue(n,!1)),this._focused instanceof wh?this._contextService.setContextValue(qo,!0):this._focused instanceof nm?this._contextService.setContextValue(So,!0):this._focused instanceof XL&&this._contextService.setContextValue(hD,!0)}getFocusedUniverInstance(){return this._focused}getDocumentType(e){if(this.getUniverDocInstance(e))return 1;if(this.getUniverSheetInstance(e))return 2;if(this.getUniverSlideInstance(e))return 3;throw new Error(`[UniverInstanceService]: No document with unitId ${e}`)}disposeDocument(e){const n=this.getUniverDocInstance(e);if(n){const o=this._docs.indexOf(n);return this._docs.splice(o,1),this._docDisposed$.next(n),this.focusUniverInstance(null),!0}const r=this.getUniverSheetInstance(e);if(r){const o=this._sheets.indexOf(r);return this._sheets.splice(o,1),this._sheetDisposed$.next(r),this.focusUniverInstance(null),!0}const i=this.getUniverSlideInstance(e);if(i){const o=this._slides.indexOf(i);return this._slides.splice(o,1),this._slideDisposed$.next(i),this.focusUniverInstance(null),!0}return!1}};Dv=SY([EY(1,pr)],Dv);var ot=(t=>(t[t.Starting=0]="Starting",t[t.Ready=1]="Ready",t[t.Rendered=2]="Rendered",t[t.Steady=3]="Steady",t))(ot||{});const yY={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"},p4=new Map;function yt(t,e){return function(n){o5(t,e)}}function o5(t,e){p4.has(t)||p4.set(t,[]),p4.get(t).push(e)}var DY=Object.defineProperty,RY=Object.getOwnPropertyDescriptor,qL=(t,e,n,r)=>{for(var i=r>1?void 0:r?RY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&DY(e,n,i),i},Rv=(t,e)=>(n,r)=>e(n,r,t);let vs=class extends We{constructor(e){super(),ge(this,"_lifecycle$",new dn(ot.Starting)),ge(this,"lifecycle$",this._lifecycle$.asObservable()),this._logService=e,this._reportProgress(ot.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(e){if(e<this.stage)throw new Error("[LifecycleService]: lifecycle stage cannot go backward!");e!==this.stage&&(this._reportProgress(e),this._lifecycle$.next(e))}dispose(){this._lifecycle$.complete(),super.dispose()}subscribeWithPrevious(){return new Wt(e=>(this.stage===ot.Starting||(this.stage===ot.Ready?e.next(ot.Starting):this.stage===ot.Rendered?(e.next(ot.Starting),e.next(ot.Ready)):(e.next(ot.Starting),e.next(ot.Ready),e.next(ot.Rendered))),this._lifecycle$.subscribe(e)))}_reportProgress(e){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${yY[e]}".`)}};vs=qL([Rv(0,oo)],vs);let Hu=class extends We{constructor(e,n){super(),ge(this,"_started",!1),this._lifecycleService=e,this._injector=n}start(){this._started||(this._started=!0,this.disposeWithMe(je(this._lifecycleService.subscribeWithPrevious().subscribe(e=>this.initModulesOnStage(e)))))}initModulesOnStage(e){const n=p4.get(e);n==null||n.forEach(r=>{this._injector.has(r)&&this._injector.get(r)})}};Hu=qL([Rv(0,K(vs)),Rv(1,K(wn))],Hu);let Gt=class extends We{constructor(){super(),ge(this,"_currentLocale",t5.ZH_CN),ge(this,"_locales",null),ge(this,"localeChanged$",new an),ge(this,"t",(e,...n)=>{if(!this._locales)throw new Error("Locale not initialized");function r(a,s){const u=s.shift();if(u&&a&&u in a){const l=a[u];return s.length>0&&(typeof l=="object"||Array.isArray(l))?r(l,s):l}return null}const i=e.split("."),o=r(this._locales[this._currentLocale],i);if(typeof o=="string"){let a=o;return n.forEach((s,u)=>{a=a.replace(`{${u}}`,s)}),a}else return e}),this.disposeWithMe(je(()=>this.localeChanged$.complete()))}load(e){var n;this._locales=Ie.deepMerge((n=this._locales)!=null?n:{},e)}setLocale(e){this._currentLocale=e,this.localeChanged$.next()}getLocales(){var e;return(e=this._locales)==null?void 0:e[this._currentLocale]}};const UC=ln("resource-manager-service"),IY=ln("ResourcePersistenceService");o5(ot.Ready,IY);var AY=Object.defineProperty,TY=Object.getOwnPropertyDescriptor,wY=(t,e,n,r)=>{for(var i=r>1?void 0:r?TY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&AY(e,n,i),i},pD=(t,e)=>(n,r)=>e(n,r,t);const VC=ln("univer.permission-service"),gD="PERMISSION";let g4=class extends We{constructor(e,n){super(),ge(this,"_permissionPointMap",new Map),ge(this,"deletePermissionPoint",(r,i)=>{const o=this._permissionPointMap.get(r);if(o){const a=o.get(i);a&&(a.complete(),this._permissionPointMap.delete(i))}}),ge(this,"addPermissionPoint",(r,i)=>{const o=this._permissionPointMap.get(r)||new Map;return o.has(i.id)?!1:(o.set(i.id,new dn(i)),this._permissionPointMap.set(r,o),!0)}),ge(this,"updatePermissionPoint",(r,i,o)=>{const a=this._permissionPointMap.get(r);if(!a)return;const s=a.get(i);if(s){const u=s.getValue();u.value=o,u.status=RL.DONE,s.next(u)}}),ge(this,"getPermissionPoint",(r,i)=>{const o=this._permissionPointMap.get(r);if(!o)return;const a=o.get(i);if(a)return a.getValue()}),this._resourceManagerService=e,this._univerInstanceService=n}_init(){this.disposeWithMe(je(this._univerInstanceService.sheetAdded$.subscribe(e=>{this._resourceManagerService.registerPluginResource(e.getUnitId(),gD,{onChange:(n,r)=>{r.forEach(i=>{this.getPermissionPoint(n,i.id)?this.updatePermissionPoint(n,i.id,i.value):this.addPermissionPoint(n,i)})},toJson:n=>this._toJson(n),parseJson:n=>this._parseJson(n)})}))),this.disposeWithMe(je(this._univerInstanceService.sheetDisposed$.subscribe(e=>{this._resourceManagerService.disposePluginResource(e.getUnitId(),gD)})))}_toJson(e){const n=this._permissionPointMap.get(e);let r=[];return n&&(r=[...n.keys()].reduce((i,o)=>{const a=n.get(o);return a&&i.push(a.getValue()),i},[])),JSON.stringify(r)}_parseJson(e){return JSON.parse(e)}composePermission$(e,n){const r=this._permissionPointMap.get(e),i=n.map(o=>{const a=r==null?void 0:r.get(o);if(!a)throw new Error(`${o} permissionPoint is not exist`);return a.asObservable()});return TC(i).pipe(ja(o=>(o.every(a=>this._permissionPointMap.get(a.id)),o)))}composePermission(e,n){const r=this._permissionPointMap.get(e);return n.map(i=>{const o=r==null?void 0:r.get(i);if(!o)throw new Error(`${i} permissionPoint is not exist`);return o.getValue()})}};g4=wY([yt(ot.Starting,g4),pD(0,K(UC)),pD(1,K(ae))],g4);const Iv="univer.editable";let fp=class extends IL{constructor(e){super(),ge(this,"id",Iv),ge(this,"value",!0),ge(this,"unitID"),this.unitID=e}};var LY=Object.defineProperty,OY=Object.getOwnPropertyDescriptor,PY=(t,e,n,r)=>{for(var i=r>1?void 0:r?OY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&LY(e,n,i),i},vD=(t,e)=>(n,r)=>e(n,r,t);let v4=class extends We{constructor(e,n){super(),this._permissionService=e,this._univerInstanceService=n,this._init()}_init(){this._univerInstanceService.sheetAdded$.subscribe(e=>{const n=new fp(e.getUnitId());this._permissionService.addPermissionPoint(e.getUnitId(),n)})}getEditable(e){let n=e;n||(n=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId());const r=new fp(n),i=this._permissionService.getPermissionPoint(n,r.id);return i==null?void 0:i.value}setEditable(e,n){const r=new fp(e);this._permissionService.updatePermissionPoint(e,r.id,n)}};v4=PY([yt(ot.Starting,v4),vD(0,K(VC)),vD(1,K(ae))],v4);let MY=class extends We{constructor(){super(...arguments),ge(this,"_resourceMap",new Map),ge(this,"_register$",new an),ge(this,"register$",this._register$.asObservable())}getAllResource(e){const n=this._resourceMap.get(e);return n?[...n.keys()].reduce((r,i)=>{const o=n.get(i);return o&&r.push({unitID:e,resourceName:i,hook:o}),r},[]):[]}registerPluginResource(e,n,r){const i=this._resourceMap.get(e)||new Map;if(i.has(n))throw new Error("the pluginName is registered");return i.set(n,r),this._resourceMap.set(e,i),this._register$.next({unitID:e,resourceName:n,hook:r}),je(()=>i.delete(n))}disposePluginResource(e,n){const r=this._resourceMap.get(e);r==null||r.delete(n)}dispose(){this._register$.complete(),this._resourceMap.clear()}},_i=class extends We{constructor(){super(),ge(this,"_currentTheme"),ge(this,"_currentTheme$",new dn({})),ge(this,"currentTheme$",this._currentTheme$.asObservable()),this.disposeWithMe(je(()=>this._currentTheme$.complete()))}getCurrentTheme(){if(!this._currentTheme)throw new Error("[ThemeService]: current theme is not set!");return this._currentTheme}setTheme(e){this._currentTheme=e,this._currentTheme$.next(e)}};const Qr="__defaultDocumentNormalEditorSpecialUnitId_20231006__",qn="__defaultDocumentFormulaBarEditorSpecialUnitId_20231012__",Sc=`\r
`;var NY=Object.defineProperty,xY=Object.getOwnPropertyDescriptor,FY=(t,e,n,r)=>{for(var i=r>1?void 0:r?xY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&NY(e,n,i),i},hp=(t,e)=>(n,r)=>e(n,r,t);const en=ln("univer.undo-redo.service"),$Y=20;let GL=class{dispose(){}async dispatchToHandlers(){return!1}};const Av="univer.command.redo",Tv="univer.command.undo",Gm=new class extends GL{constructor(){super(...arguments),ge(this,"type",ue.COMMAND),ge(this,"id",Tv)}async handler(t){const e=t.get(en),n=e.pitchTopUndoElement();if(!n)return!1;const r=t.get(se);return(n.undo?await n.undo(n.undoMutations):lr(n.undoMutations,r))?(e.popUndoToRedo(),!0):!1}},a5=new class extends GL{constructor(){super(...arguments),ge(this,"type",ue.COMMAND),ge(this,"id",Av)}async handler(t){const e=t.get(en),n=e.pitchTopRedoElement();if(!n)return!1;const r=t.get(se);return(n.redo?await n.redo(n.redoMutations):lr(n.redoMutations,r))?(e.popRedoToUndo(),!0):!1}};let wv=class extends We{constructor(e,n,r){super(),ge(this,"undoRedoStatus$"),ge(this,"_undoRedoStatus$",new dn({undos:0,redos:0})),ge(this,"_undoStacks",new Map),ge(this,"_redoStacks",new Map),this._univerInstanceService=e,this._commandService=n,this._contextService=r,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(Gm)),this.disposeWithMe(this._commandService.registerCommand(a5)),this.disposeWithMe(je(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(je(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(e){const{unitID:n}=e,r=this._getRedoStack(n,!0),i=this._getUndoStack(n,!0);r.length=0,i.push(e),i.length>$Y&&i.splice(0,1),this._updateStatus()}clearUndoRedo(e){const n=this._getRedoStack(e);n&&(n.length=0);const r=this._getUndoStack(e);r&&(r.length=0),this._updateStatus()}pitchTopUndoElement(){const e=this._getUndoStackForFocused();return e.length?e[e.length-1]:null}pitchTopRedoElement(){const e=this._getRedoStackForFocused();return e.length?e[e.length-1]:null}popUndoToRedo(){const e=this._getUndoStackForFocused().pop();e&&(this._getRedoStackForFocused().push(e),this._updateStatus())}popRedoToUndo(){const e=this._getRedoStackForFocused().pop();e&&(this._getUndoStackForFocused().push(e),this._updateStatus())}_updateStatus(){var e,n;const r=this._getFocusedUniverInstanceId(),i=r&&((e=this._undoStacks.get(r))==null?void 0:e.length)||0,o=r&&((n=this._redoStacks.get(r))==null?void 0:n.length)||0;this._undoRedoStatus$.next({undos:i,redos:o})}_getUndoStack(e,n=!1){let r=this._undoStacks.get(e);return!r&&n&&(r=[],this._undoStacks.set(e,r)),r||null}_getRedoStack(e,n=!1){let r=this._redoStacks.get(e);return!r&&n&&(r=[],this._redoStacks.set(e,r)),r||null}_getUndoStackForFocused(){const e=this._getFocusedUniverInstanceId();if(!e)throw new Error("No focused univer instance!");return this._getUndoStack(e,!0)}_getRedoStackForFocused(){const e=this._getFocusedUniverInstanceId();if(!e)throw new Error("No focused univer instance!");return this._getRedoStack(e,!0)}_getFocusedUniverInstanceId(){var e,n,r,i;let o="";const a=this._contextService.getContextValue(qo),s=this._contextService.getContextValue(W1),u=this._contextService.getContextValue(Mr);return a?s?o=qn:u?o=Qr:o=(n=(e=this._univerInstanceService.getFocusedUniverInstance())==null?void 0:e.getUnitId())!=null?n:"":o=(i=(r=this._univerInstanceService.getFocusedUniverInstance())==null?void 0:r.getUnitId())!=null?i:"",o}};wv=FY([hp(0,ae),hp(1,se),hp(2,pr)],wv);let s5=class extends We{constructor(){super(...arguments),ge(this,"_started",!1)}addPlugins(e){if(this._started){const n=e.map(([r,i])=>this._initPlugin(r,i));this._pluginsRunLifecycle(n,ot.Starting),setTimeout(()=>this._takePluginsThroughLifecycle(n,!0))}else{const n=e.map(([r,i])=>this._initPlugin(r,i));this._takePluginsThroughLifecycle(n),this._started=!0}}_takePluginsThroughLifecycle(e,n=!1){this.disposeWithMe(je(this._lifecycleService.subscribeWithPrevious().subscribe(r=>{n&&r===ot.Starting||this._pluginsRunLifecycle(e,r)})))}_pluginsRunLifecycle(e,n){e.forEach(r=>{switch(n){case ot.Starting:r.onStarting(this._injector);break;case ot.Ready:r.onReady();break;case ot.Rendered:r.onRendered();break;case ot.Steady:r.onSteady();break}}),this._lifecycleInitializerService.initModulesOnStage(n)}_initPlugin(e,n){return this._injector.createInstance(e,n)}};var kY=Object.defineProperty,BY=Object.getOwnPropertyDescriptor,UY=(t,e,n,r)=>{for(var i=r>1?void 0:r?BY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&kY(e,n,i),i},pp=(t,e)=>(n,r)=>e(n,r,t);let Lv=class extends s5{constructor(e,n,r){super(),this._injector=e,this._lifecycleService=n,this._lifecycleInitializerService=r}createDoc(e){return this._injector.createInstance(nm,e)}};Lv=UY([pp(0,K(wn)),pp(1,K(vs)),pp(2,K(Hu))],Lv);var VY=Object.defineProperty,HY=Object.getOwnPropertyDescriptor,jY=(t,e,n,r)=>{for(var i=r>1?void 0:r?HY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&VY(e,n,i),i},gp=(t,e)=>(n,r)=>e(n,r,t);let Ov=class extends s5{constructor(e,n,r){super(),this._injector=e,this._lifecycleService=n,this._lifecycleInitializerService=r}createSheet(e){return this._injector.createInstance(wh,e)}};Ov=jY([gp(0,K(wn)),gp(1,K(vs)),gp(2,K(Hu))],Ov);var zY=Object.defineProperty,WY=Object.getOwnPropertyDescriptor,YY=(t,e,n,r)=>{for(var i=r>1?void 0:r?WY(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&zY(e,n,i),i},vp=(t,e)=>(n,r)=>e(n,r,t);let Pv=class extends s5{constructor(e,n,r){super(),this._injector=e,this._lifecycleService=n,this._lifecycleInitializerService=r}createSlide(e){return this._injector.createInstance(XL,e)}};Pv=YY([vp(0,K(wn)),vp(1,K(vs)),vp(2,K(Hu))],Pv);const XY=200;let qY=class extends s5{constructor(e={}){super(),ge(this,"_injector"),ge(this,"_univerPluginStore",new Hz),ge(this,"_univerPluginRegistry",new jz),ge(this,"_univerSheet",null),ge(this,"_univerDoc",null),ge(this,"_univerSlide",null),ge(this,"_initLazyPluginsTimer"),this._injector=this._initDependencies();const{theme:n,locale:r,locales:i,logLevel:o}=e;n&&this._injector.get(_i).setTheme(n),i&&this._injector.get(Gt).load(i),r&&this._injector.get(Gt).setLocale(r),o&&this._injector.get(oo).setLogLevel(o)}get _univerInstanceService(){return this._injector.get(ae)}get _lifecycleService(){return this._injector.get(vs)}get _lifecycleInitializerService(){return this._injector.get(Hu)}__getInjector(){return this._injector}dispose(){this._injector.dispose(),super.dispose()}setLocale(e){this._injector.get(Gt).setLocale(e)}createUniverSheet(e){let n;const r=()=>{n=this._univerSheet.createSheet(e),this._univerInstanceService.addSheet(n)};if(this._univerSheet)r();else{this._tryProgressToStart();const i=this._univerSheet=this._injector.createInstance(Ov),o=this._univerPluginRegistry.getRegisterPlugins(Ir.Sheet).map(a=>[a.plugin,a.options]);this._univerPluginRegistry.clearPluginsOfType(Ir.Sheet),i.addPlugins(o),r(),this._tryProgressToReady()}return n}createUniverDoc(e){let n;const r=()=>{n=this._univerDoc.createDoc(e),this._univerInstanceService.addDoc(n)};if(this._univerDoc)r();else{this._tryProgressToStart();const i=this._univerDoc=this._injector.createInstance(Lv),o=this._univerPluginRegistry.getRegisterPlugins(Ir.Doc).map(a=>[a.plugin,a.options]);this._univerPluginRegistry.clearPluginsOfType(Ir.Doc),i.addPlugins(o),r(),this._tryProgressToReady()}return n}createUniverSlide(e){let n;const r=()=>{n=this._univerSlide.createSlide(e),this._univerInstanceService.addSlide(n)};if(this._univerSlide)r();else{this._tryProgressToStart();const i=this._univerSlide=this._injector.createInstance(Pv),o=this._univerPluginRegistry.getRegisterPlugins(Ir.Slide).map(a=>[a.plugin,a.options]);this._univerPluginRegistry.clearPluginsOfType(Ir.Slide),i.addPlugins(o),r(),this._tryProgressToReady()}return n}_initDependencies(){return new wn([[ae,{useFactory:e=>new Dv({createUniverDoc:n=>this.createUniverDoc(n),createUniverSheet:n=>this.createUniverSheet(n),createUniverSlide:n=>this.createUniverSlide(n)},e),deps:[pr]}],[Z0],[Gt],[_i],[vs],[Hu],[VC,{useClass:g4}],[v4],[oo,{useClass:Kz,lazy:!0}],[se,{useClass:_v,lazy:!0}],[en,{useClass:wv,lazy:!0}],[K0,{useClass:nW}],[pr,{useClass:Gz}],[fL,{useClass:iW,lazy:!0}],[UC,{useClass:MY,lazy:!0}]])}_tryProgressToStart(){this._started||(this._injector.get(Hu).start(),this._started=!0)}_tryProgressToReady(){this._injector.get(vs).stage<ot.Ready&&(this._injector.get(vs).stage=ot.Ready,this._univerPluginStore.forEachPlugin(e=>e.onReady()))}registerPlugin(e,n){if(e.type===Ir.Univer)this._registerUniverPlugin(e,n);else if(e.type===Ir.Sheet)this._registerSheetsPlugin(e,n);else if(e.type===Ir.Doc)this._registerDocsPlugin(e,n);else if(e.type===Ir.Slide)this._registerSlidesPlugin(e,n);else throw new Error(`Unimplemented plugin system for business: "${e.type}".`);if(this._started)return this._scheduleInitPluginAfterStarted()}_scheduleInitPluginAfterStarted(){this._initLazyPluginsTimer===void 0&&(this._initLazyPluginsTimer=setTimeout(()=>this._flushLazyPlugins(),XY))}_flushLazyPlugins(){this._initLazyPluginsTimer=void 0;const e=this._univerPluginRegistry.getRegisterPlugins(Ir.Univer);if(e.length){this._univerPluginRegistry.clearPluginsOfType(Ir.Univer);const n=e.map(r=>this._injector.createInstance(r.plugin,r.options));this._takePluginsThroughLifecycle(n)}if(this._univerSheet){const n=this._univerPluginRegistry.getRegisterPlugins(Ir.Sheet).map(r=>[r.plugin,r.options]);n.length&&(this._univerSheet.addPlugins(n),this._univerPluginRegistry.clearPluginsOfType(Ir.Sheet))}if(this._univerDoc){const n=this._univerPluginRegistry.getRegisterPlugins(Ir.Doc).map(r=>[r.plugin,r.options]);n.length&&(this._univerDoc.addPlugins(n),this._univerPluginRegistry.clearPluginsOfType(Ir.Doc))}if(this._univerSlide){const n=this._univerPluginRegistry.getRegisterPlugins(Ir.Slide).map(r=>[r.plugin,r.options]);n.length&&(this._univerSlide.addPlugins(n),this._univerPluginRegistry.clearPluginsOfType(Ir.Slide))}}_registerUniverPlugin(e,n){if(this._started)this._univerPluginRegistry.registerPlugin(e,n);else{const r=this._injector.createInstance(e,n);r.onStarting(this._injector),this._univerPluginStore.addPlugin(r)}}_registerSheetsPlugin(e,n){this._univerPluginRegistry.registerPlugin(e,n)}_registerDocsPlugin(e,n){this._univerPluginRegistry.registerPlugin(e,n)}_registerSlidesPlugin(e,n){this._univerPluginRegistry.registerPlugin(e,n)}};function KL(t){const e=new MessageChannel;let n=!1;return e.port1.onmessage=()=>{n||t()},e.port2.postMessage(null),()=>{n=!0}}let bD=class{constructor(e){ge(this,"_index",0),ge(this,"_offset",0),this._actions=e}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(e){e||(e=Number.POSITIVE_INFINITY);const n=this._actions[this._index];if(n){const r=this._offset,i=n.len;return e>=i-r?(e=i-r,this._index+=1,this._offset=0):this._offset+=e,n.t===jt.DELETE||n.t===jt.RETAIN&&n.body==null?Ie.deepClone({...n,len:e}):Ie.deepClone({...n,len:e,body:VL(n.body,r,r+e)})}else return{t:jt.RETAIN,len:Number.POSITIVE_INFINITY}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){const e=this._actions[this._index];return e?e.t:jt.RETAIN}rest(){if(this.hasNext()){if(this._offset===0)return this._actions.slice(this._index);{const e=this._offset,n=this._index,r=this.next(),i=this._actions.slice(this._index);return this._offset=e,this._index=n,[r].concat(i)}}else return[]}};function _D(t){return Object.keys(t).length===1}let Go=class ZL{constructor(){ge(this,"_actions",[])}static compose(e,n){const r=new bD(e),i=new bD(n),o=new ZL;for(;r.hasNext()||i.hasNext();)if(i.peekType()===jt.INSERT)o.push(i.next());else if(r.peekType()===jt.DELETE)o.push(r.next());else{const a=Math.min(r.peekLength(),i.peekLength()),s=r.next(a),u=i.next(a);s.t===jt.INSERT&&u.t===jt.RETAIN?u.body==null?o.push(s):o.push({...s,body:dD(s.body,u.body,u.coverType)}):s.t===jt.RETAIN&&u.t===jt.RETAIN?s.body==null&&u.body==null?o.push(s.len!==Number.POSITIVE_INFINITY?s:u):s.body&&u.body?o.push({...s,body:dD(s.body,u.body,u.coverType)}):o.push(s.body?s:u):s.t===jt.RETAIN&&u.t===jt.DELETE?o.push(u):s.t===jt.INSERT&&(u.t,jt.DELETE)}return o.trimEndUselessRetainAction(),o.serialize()}insert(e,n,r){const i={t:jt.INSERT,body:n,len:e,line:0,segmentId:r};return this.push(i),this}retain(e,n,r,i){const o={t:jt.RETAIN,len:e,segmentId:n};return r!=null&&(o.body=r),i!=null&&(o.coverType=i),this.push(o),this}delete(e,n){const r={t:jt.DELETE,len:e,line:0,segmentId:n};return this.push(r),this}serialize(){return this._actions}push(...e){if(e.length>1){for(const o of e)this.push(o);return this}let n=this._actions.length,r=this._actions[n-1];const i=Ie.deepClone(e[0]);if(i.t===jt.RETAIN&&i.len===0&&i.body==null)return this;if(typeof r=="object"){if(r.t===jt.DELETE&&i.t===jt.DELETE)return r.len+=i.len,this;if(r.t===jt.DELETE&&i.t===jt.INSERT&&(n-=1,r=this._actions[n-1],r==null))return this._actions.unshift(i),this;if(r.t===jt.RETAIN&&i.t===jt.RETAIN&&r.body==null&&i.body==null)return r.len+=i.len,this;if(r.t===jt.INSERT&&_D(r.body)&&i.t===jt.INSERT&&_D(i.body))return r.len+=i.len,r.body.dataStream+=i.body.dataStream,this}return n===this._actions.length?this._actions.push(i):this._actions.splice(n,0,i),this}trimEndUselessRetainAction(){let e=this._actions[this._actions.length-1];for(;e&&e.t===jt.RETAIN&&eY(e);)this._actions.pop(),e=this._actions[this._actions.length-1];return this}};const QL=ln("ILocalStorageService"),Q0=t=>`sheet_interceptor_${t}`,JL=t=>function(e,n){let r=-1;function i(o,a){if(o<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");return r=o,o===t.length?a:t[o].handler(a,n,i.bind(null,o+1))}return i(0,e)};let eO=class{constructor(e){ge(this,"_interceptorsByName",new Map),ge(this,"_interceptorPoints"),this._interceptorPoints=e}fetchThroughInterceptors(e){const n=e,r=this._interceptorsByName.get(n);return JL(r||[])}intercept(e,n){const r=e;this._interceptorsByName.has(r)||this._interceptorsByName.set(r,[]);const i=this._interceptorsByName.get(r);return i.push(n),this._interceptorsByName.set(r,i.sort((o,a)=>{var s,u;return((s=a.priority)!=null?s:0)-((u=o.priority)!=null?u:0)})),()=>r1(this._interceptorsByName.get(r),n)}getInterceptPoints(){return this._interceptorPoints}};Uz();function tO(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var nO={exports:{}},Gn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Km=Symbol.for("react.element"),GY=Symbol.for("react.portal"),KY=Symbol.for("react.fragment"),ZY=Symbol.for("react.strict_mode"),QY=Symbol.for("react.profiler"),JY=Symbol.for("react.provider"),eX=Symbol.for("react.context"),tX=Symbol.for("react.forward_ref"),nX=Symbol.for("react.suspense"),rX=Symbol.for("react.memo"),iX=Symbol.for("react.lazy"),CD=Symbol.iterator;function oX(t){return t===null||typeof t!="object"?null:(t=CD&&t[CD]||t["@@iterator"],typeof t=="function"?t:null)}var rO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iO=Object.assign,oO={};function J0(t,e,n){this.props=t,this.context=e,this.refs=oO,this.updater=n||rO}J0.prototype.isReactComponent={};J0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};J0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aO(){}aO.prototype=J0.prototype;function HC(t,e,n){this.props=t,this.context=e,this.refs=oO,this.updater=n||rO}var jC=HC.prototype=new aO;jC.constructor=HC;iO(jC,J0.prototype);jC.isPureReactComponent=!0;var SD=Array.isArray,sO=Object.prototype.hasOwnProperty,zC={current:null},uO={key:!0,ref:!0,__self:!0,__source:!0};function lO(t,e,n){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)sO.call(e,r)&&!uO.hasOwnProperty(r)&&(i[r]=e[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];i.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:Km,type:t,key:o,ref:a,props:i,_owner:zC.current}}function aX(t,e){return{$$typeof:Km,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function WC(t){return typeof t=="object"&&t!==null&&t.$$typeof===Km}function sX(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ED=/\/+/g;function bp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?sX(""+t.key):e.toString(36)}function b4(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Km:case GY:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+bp(a,0):r,SD(i)?(n="",t!=null&&(n=t.replace(ED,"$&/")+"/"),b4(i,e,n,"",function(l){return l})):i!=null&&(WC(i)&&(i=aX(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(ED,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",SD(t))for(var s=0;s<t.length;s++){o=t[s];var u=r+bp(o,s);a+=b4(o,e,n,u,i)}else if(u=oX(t),typeof u=="function")for(t=u.call(t),s=0;!(o=t.next()).done;)o=o.value,u=r+bp(o,s++),a+=b4(o,e,n,u,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function n3(t,e,n){if(t==null)return t;var r=[],i=0;return b4(t,r,"","",function(o){return e.call(n,o,i++)}),r}function uX(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Io={current:null},_4={transition:null},lX={ReactCurrentDispatcher:Io,ReactCurrentBatchConfig:_4,ReactCurrentOwner:zC};Gn.Children={map:n3,forEach:function(t,e,n){n3(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return n3(t,function(){e++}),e},toArray:function(t){return n3(t,function(e){return e})||[]},only:function(t){if(!WC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Gn.Component=J0;Gn.Fragment=KY;Gn.Profiler=QY;Gn.PureComponent=HC;Gn.StrictMode=ZY;Gn.Suspense=nX;Gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lX;Gn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=iO({},t.props),i=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=zC.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in e)sO.call(e,u)&&!uO.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Km,type:t.type,key:i,ref:o,props:r,_owner:a}};Gn.createContext=function(t){return t={$$typeof:eX,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:JY,_context:t},t.Consumer=t};Gn.createElement=lO;Gn.createFactory=function(t){var e=lO.bind(null,t);return e.type=t,e};Gn.createRef=function(){return{current:null}};Gn.forwardRef=function(t){return{$$typeof:tX,render:t}};Gn.isValidElement=WC;Gn.lazy=function(t){return{$$typeof:iX,_payload:{_status:-1,_result:t},_init:uX}};Gn.memo=function(t,e){return{$$typeof:rX,type:t,compare:e===void 0?null:e}};Gn.startTransition=function(t){var e=_4.transition;_4.transition={};try{t()}finally{_4.transition=e}};Gn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Gn.useCallback=function(t,e){return Io.current.useCallback(t,e)};Gn.useContext=function(t){return Io.current.useContext(t)};Gn.useDebugValue=function(){};Gn.useDeferredValue=function(t){return Io.current.useDeferredValue(t)};Gn.useEffect=function(t,e){return Io.current.useEffect(t,e)};Gn.useId=function(){return Io.current.useId()};Gn.useImperativeHandle=function(t,e,n){return Io.current.useImperativeHandle(t,e,n)};Gn.useInsertionEffect=function(t,e){return Io.current.useInsertionEffect(t,e)};Gn.useLayoutEffect=function(t,e){return Io.current.useLayoutEffect(t,e)};Gn.useMemo=function(t,e){return Io.current.useMemo(t,e)};Gn.useReducer=function(t,e,n){return Io.current.useReducer(t,e,n)};Gn.useRef=function(t){return Io.current.useRef(t)};Gn.useState=function(t){return Io.current.useState(t)};Gn.useSyncExternalStore=function(t,e,n){return Io.current.useSyncExternalStore(t,e,n)};Gn.useTransition=function(){return Io.current.useTransition()};Gn.version="18.2.0";nO.exports=Gn;var _=nO.exports;const Se=tO(_),cX=uj({__proto__:null,default:Se},[_]);function cO(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=cO(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Ci(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=cO(t))&&(r&&(r+=" "),r+=e);return r}var dO={exports:{}},va={},mO={exports:{}},fO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(X,x){var O=X.length;X.push(x);e:for(;0<O;){var M=O-1>>>1,V=X[M];if(0<i(V,x))X[M]=x,X[O]=V,O=M;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var x=X[0],O=X.pop();if(O!==x){X[0]=O;e:for(var M=0,V=X.length,q=V>>>1;M<q;){var ie=2*(M+1)-1,ce=X[ie],pe=ie+1,oe=X[pe];if(0>i(ce,O))pe<V&&0>i(oe,ce)?(X[M]=oe,X[pe]=O,M=pe):(X[M]=ce,X[ie]=O,M=ie);else if(pe<V&&0>i(oe,O))X[M]=oe,X[pe]=O,M=pe;else break e}}return x}function i(X,x){var O=X.sortIndex-x.sortIndex;return O!==0?O:X.id-x.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,d=null,m=3,f=!1,h=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(X){for(var x=n(l);x!==null;){if(x.callback===null)r(l);else if(x.startTime<=X)r(l),x.sortIndex=x.expirationTime,e(u,x);else break;x=n(l)}}function S(X){if(p=!1,C(X),!h)if(n(u)!==null)h=!0,Q(E);else{var x=n(l);x!==null&&te(S,x.startTime-X)}}function E(X,x){h=!1,p&&(p=!1,g(R),R=-1),f=!0;var O=m;try{for(C(x),d=n(u);d!==null&&(!(d.expirationTime>x)||X&&!P());){var M=d.callback;if(typeof M=="function"){d.callback=null,m=d.priorityLevel;var V=M(d.expirationTime<=x);x=t.unstable_now(),typeof V=="function"?d.callback=V:d===n(u)&&r(u),C(x)}else r(u);d=n(u)}if(d!==null)var q=!0;else{var ie=n(l);ie!==null&&te(S,ie.startTime-x),q=!1}return q}finally{d=null,m=O,f=!1}}var y=!1,D=null,R=-1,I=5,T=-1;function P(){return!(t.unstable_now()-T<I)}function N(){if(D!==null){var X=t.unstable_now();T=X;var x=!0;try{x=D(!0,X)}finally{x?B():(y=!1,D=null)}}else y=!1}var B;if(typeof b=="function")B=function(){b(N)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,G=W.port2;W.port1.onmessage=N,B=function(){G.postMessage(null)}}else B=function(){v(N,0)};function Q(X){D=X,y||(y=!0,B())}function te(X,x){R=v(function(){X(t.unstable_now())},x)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){h||f||(h=!0,Q(E))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(X){switch(m){case 1:case 2:case 3:var x=3;break;default:x=m}var O=m;m=x;try{return X()}finally{m=O}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,x){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var O=m;m=X;try{return x()}finally{m=O}},t.unstable_scheduleCallback=function(X,x,O){var M=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?M+O:M):O=M,X){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=O+V,X={id:c++,callback:x,priorityLevel:X,startTime:O,expirationTime:V,sortIndex:-1},O>M?(X.sortIndex=O,e(l,X),n(u)===null&&X===n(l)&&(p?(g(R),R=-1):p=!0,te(S,O-M))):(X.sortIndex=V,e(u,X),h||f||(h=!0,Q(E))),X},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(X){var x=m;return function(){var O=m;m=x;try{return X.apply(this,arguments)}finally{m=O}}}})(fO);mO.exports=fO;var dX=mO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hO=_,ha=dX;function vt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pO=new Set,rm={};function Hc(t,e){D0(t,e),D0(t+"Capture",e)}function D0(t,e){for(rm[t]=e,t=0;t<e.length;t++)pO.add(e[t])}var K1=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mv=Object.prototype.hasOwnProperty,mX=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yD={},DD={};function fX(t){return Mv.call(DD,t)?!0:Mv.call(yD,t)?!1:mX.test(t)?DD[t]=!0:(yD[t]=!0,!1)}function hX(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function pX(t,e,n,r){if(e===null||typeof e>"u"||hX(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ao(t,e,n,r,i,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var Vi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vi[t]=new Ao(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vi[e]=new Ao(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vi[t]=new Ao(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vi[t]=new Ao(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vi[t]=new Ao(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vi[t]=new Ao(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vi[t]=new Ao(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vi[t]=new Ao(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vi[t]=new Ao(t,5,!1,t.toLowerCase(),null,!1,!1)});var YC=/[\-:]([a-z])/g;function XC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(YC,XC);Vi[e]=new Ao(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(YC,XC);Vi[e]=new Ao(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(YC,XC);Vi[e]=new Ao(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vi[t]=new Ao(t,1,!1,t.toLowerCase(),null,!1,!1)});Vi.xlinkHref=new Ao("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vi[t]=new Ao(t,1,!1,t.toLowerCase(),null,!0,!0)});function qC(t,e,n,r){var i=Vi.hasOwnProperty(e)?Vi[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(pX(e,n,i,r)&&(n=null),r||i===null?fX(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var au=hO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,r3=Symbol.for("react.element"),U2=Symbol.for("react.portal"),V2=Symbol.for("react.fragment"),GC=Symbol.for("react.strict_mode"),Nv=Symbol.for("react.profiler"),gO=Symbol.for("react.provider"),vO=Symbol.for("react.context"),KC=Symbol.for("react.forward_ref"),xv=Symbol.for("react.suspense"),Fv=Symbol.for("react.suspense_list"),ZC=Symbol.for("react.memo"),wu=Symbol.for("react.lazy"),bO=Symbol.for("react.offscreen"),RD=Symbol.iterator;function Ad(t){return t===null||typeof t!="object"?null:(t=RD&&t[RD]||t["@@iterator"],typeof t=="function"?t:null)}var Xr=Object.assign,_p;function c6(t){if(_p===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);_p=e&&e[1]||""}return`
`+_p+t}var Cp=!1;function Sp(t,e){if(!t||Cp)return"";Cp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||i[a]!==o[s]){var u=`
`+i[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=s);break}}}finally{Cp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?c6(t):""}function gX(t){switch(t.tag){case 5:return c6(t.type);case 16:return c6("Lazy");case 13:return c6("Suspense");case 19:return c6("SuspenseList");case 0:case 2:case 15:return t=Sp(t.type,!1),t;case 11:return t=Sp(t.type.render,!1),t;case 1:return t=Sp(t.type,!0),t;default:return""}}function $v(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case V2:return"Fragment";case U2:return"Portal";case Nv:return"Profiler";case GC:return"StrictMode";case xv:return"Suspense";case Fv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vO:return(t.displayName||"Context")+".Consumer";case gO:return(t._context.displayName||"Context")+".Provider";case KC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ZC:return e=t.displayName||null,e!==null?e:$v(t.type)||"Memo";case wu:e=t._payload,t=t._init;try{return $v(t(e))}catch{}}return null}function vX(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $v(e);case 8:return e===GC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function rl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _O(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function bX(t){var e=_O(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function i3(t){t._valueTracker||(t._valueTracker=bX(t))}function CO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_O(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Lh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function kv(t,e){var n=e.checked;return Xr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ID(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=rl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function SO(t,e){e=e.checked,e!=null&&qC(t,"checked",e,!1)}function Bv(t,e){SO(t,e);var n=rl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Uv(t,e.type,n):e.hasOwnProperty("defaultValue")&&Uv(t,e.type,rl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function AD(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Uv(t,e,n){(e!=="number"||Lh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var d6=Array.isArray;function l0(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+rl(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Vv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(vt(91));return Xr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function TD(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(vt(92));if(d6(n)){if(1<n.length)throw Error(vt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:rl(n)}}function EO(t,e){var n=rl(e.value),r=rl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wD(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var o3,DO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(o3=o3||document.createElement("div"),o3.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=o3.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function im(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var w6={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_X=["Webkit","ms","Moz","O"];Object.keys(w6).forEach(function(t){_X.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),w6[e]=w6[t]})});function RO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||w6.hasOwnProperty(t)&&w6[t]?(""+e).trim():e+"px"}function IO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=RO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var CX=Xr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jv(t,e){if(e){if(CX[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(vt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(vt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(vt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(vt(62))}}function zv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wv=null;function QC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yv=null,c0=null,d0=null;function LD(t){if(t=Jm(t)){if(typeof Yv!="function")throw Error(vt(280));var e=t.stateNode;e&&(e=m5(e),Yv(t.stateNode,t.type,e))}}function AO(t){c0?d0?d0.push(t):d0=[t]:c0=t}function TO(){if(c0){var t=c0,e=d0;if(d0=c0=null,LD(t),e)for(t=0;t<e.length;t++)LD(e[t])}}function wO(t,e){return t(e)}function LO(){}var Ep=!1;function OO(t,e,n){if(Ep)return t(e,n);Ep=!0;try{return wO(t,e,n)}finally{Ep=!1,(c0!==null||d0!==null)&&(LO(),TO())}}function om(t,e){var n=t.stateNode;if(n===null)return null;var r=m5(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(vt(231,e,typeof n));return n}var Xv=!1;if(K1)try{var Td={};Object.defineProperty(Td,"passive",{get:function(){Xv=!0}}),window.addEventListener("test",Td,Td),window.removeEventListener("test",Td,Td)}catch{Xv=!1}function SX(t,e,n,r,i,o,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(c){this.onError(c)}}var L6=!1,Oh=null,Ph=!1,qv=null,EX={onError:function(t){L6=!0,Oh=t}};function yX(t,e,n,r,i,o,a,s,u){L6=!1,Oh=null,SX.apply(EX,arguments)}function DX(t,e,n,r,i,o,a,s,u){if(yX.apply(this,arguments),L6){if(L6){var l=Oh;L6=!1,Oh=null}else throw Error(vt(198));Ph||(Ph=!0,qv=l)}}function jc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function PO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function OD(t){if(jc(t)!==t)throw Error(vt(188))}function RX(t){var e=t.alternate;if(!e){if(e=jc(t),e===null)throw Error(vt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return OD(i),t;if(o===r)return OD(i),e;o=o.sibling}throw Error(vt(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a)throw Error(vt(189))}}if(n.alternate!==r)throw Error(vt(190))}if(n.tag!==3)throw Error(vt(188));return n.stateNode.current===n?t:e}function MO(t){return t=RX(t),t!==null?NO(t):null}function NO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=NO(t);if(e!==null)return e;t=t.sibling}return null}var xO=ha.unstable_scheduleCallback,PD=ha.unstable_cancelCallback,IX=ha.unstable_shouldYield,AX=ha.unstable_requestPaint,ri=ha.unstable_now,TX=ha.unstable_getCurrentPriorityLevel,JC=ha.unstable_ImmediatePriority,FO=ha.unstable_UserBlockingPriority,Mh=ha.unstable_NormalPriority,wX=ha.unstable_LowPriority,$O=ha.unstable_IdlePriority,u5=null,a1=null;function LX(t){if(a1&&typeof a1.onCommitFiberRoot=="function")try{a1.onCommitFiberRoot(u5,t,void 0,(t.current.flags&128)===128)}catch{}}var Es=Math.clz32?Math.clz32:MX,OX=Math.log,PX=Math.LN2;function MX(t){return t>>>=0,t===0?32:31-(OX(t)/PX|0)|0}var a3=64,s3=4194304;function m6(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var s=a&~i;s!==0?r=m6(s):(o&=a,o!==0&&(r=m6(o)))}else a=n&~i,a!==0?r=m6(a):o!==0&&(r=m6(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Es(e),i=1<<n,r|=t[n],e&=~i;return r}function NX(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xX(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Es(o),s=1<<a,u=i[a];u===-1?(!(s&n)||s&r)&&(i[a]=NX(s,e)):u<=e&&(t.expiredLanes|=s),o&=~s}}function Gv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function kO(){var t=a3;return a3<<=1,!(a3&4194240)&&(a3=64),t}function yp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Zm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Es(e),t[e]=n}function FX(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Es(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function eS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Es(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var br=0;function BO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var UO,tS,VO,HO,jO,Kv=!1,u3=[],ju=null,zu=null,Wu=null,am=new Map,sm=new Map,Pu=[],$X="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function MD(t,e){switch(t){case"focusin":case"focusout":ju=null;break;case"dragenter":case"dragleave":zu=null;break;case"mouseover":case"mouseout":Wu=null;break;case"pointerover":case"pointerout":am.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":sm.delete(e.pointerId)}}function wd(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Jm(e),e!==null&&tS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function kX(t,e,n,r,i){switch(e){case"focusin":return ju=wd(ju,t,e,n,r,i),!0;case"dragenter":return zu=wd(zu,t,e,n,r,i),!0;case"mouseover":return Wu=wd(Wu,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return am.set(o,wd(am.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,sm.set(o,wd(sm.get(o)||null,t,e,n,r,i)),!0}return!1}function zO(t){var e=ic(t.target);if(e!==null){var n=jc(e);if(n!==null){if(e=n.tag,e===13){if(e=PO(n),e!==null){t.blockedOn=e,jO(t.priority,function(){VO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function C4(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Zv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Wv=r,n.target.dispatchEvent(r),Wv=null}else return e=Jm(n),e!==null&&tS(e),t.blockedOn=n,!1;e.shift()}return!0}function ND(t,e,n){C4(t)&&n.delete(e)}function BX(){Kv=!1,ju!==null&&C4(ju)&&(ju=null),zu!==null&&C4(zu)&&(zu=null),Wu!==null&&C4(Wu)&&(Wu=null),am.forEach(ND),sm.forEach(ND)}function Ld(t,e){t.blockedOn===e&&(t.blockedOn=null,Kv||(Kv=!0,ha.unstable_scheduleCallback(ha.unstable_NormalPriority,BX)))}function um(t){function e(i){return Ld(i,t)}if(0<u3.length){Ld(u3[0],t);for(var n=1;n<u3.length;n++){var r=u3[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ju!==null&&Ld(ju,t),zu!==null&&Ld(zu,t),Wu!==null&&Ld(Wu,t),am.forEach(e),sm.forEach(e),n=0;n<Pu.length;n++)r=Pu[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Pu.length&&(n=Pu[0],n.blockedOn===null);)zO(n),n.blockedOn===null&&Pu.shift()}var m0=au.ReactCurrentBatchConfig,xh=!0;function UX(t,e,n,r){var i=br,o=m0.transition;m0.transition=null;try{br=1,nS(t,e,n,r)}finally{br=i,m0.transition=o}}function VX(t,e,n,r){var i=br,o=m0.transition;m0.transition=null;try{br=4,nS(t,e,n,r)}finally{br=i,m0.transition=o}}function nS(t,e,n,r){if(xh){var i=Zv(t,e,n,r);if(i===null)Mp(t,e,r,Fh,n),MD(t,r);else if(kX(i,t,e,n,r))r.stopPropagation();else if(MD(t,r),e&4&&-1<$X.indexOf(t)){for(;i!==null;){var o=Jm(i);if(o!==null&&UO(o),o=Zv(t,e,n,r),o===null&&Mp(t,e,r,Fh,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else Mp(t,e,r,null,n)}}var Fh=null;function Zv(t,e,n,r){if(Fh=null,t=QC(r),t=ic(t),t!==null)if(e=jc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=PO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Fh=t,null}function WO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(TX()){case JC:return 1;case FO:return 4;case Mh:case wX:return 16;case $O:return 536870912;default:return 16}default:return 16}}var Nu=null,rS=null,S4=null;function YO(){if(S4)return S4;var t,e=rS,n=e.length,r,i="value"in Nu?Nu.value:Nu.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[o-r];r++);return S4=i.slice(t,1<r?1-r:void 0)}function E4(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function l3(){return!0}function xD(){return!1}function ba(t){function e(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?l3:xD,this.isPropagationStopped=xD,this}return Xr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=l3)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=l3)},persist:function(){},isPersistent:l3}),e}var ed={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iS=ba(ed),Qm=Xr({},ed,{view:0,detail:0}),HX=ba(Qm),Dp,Rp,Od,l5=Xr({},Qm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Od&&(Od&&t.type==="mousemove"?(Dp=t.screenX-Od.screenX,Rp=t.screenY-Od.screenY):Rp=Dp=0,Od=t),Dp)},movementY:function(t){return"movementY"in t?t.movementY:Rp}}),FD=ba(l5),jX=Xr({},l5,{dataTransfer:0}),zX=ba(jX),WX=Xr({},Qm,{relatedTarget:0}),Ip=ba(WX),YX=Xr({},ed,{animationName:0,elapsedTime:0,pseudoElement:0}),XX=ba(YX),qX=Xr({},ed,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),GX=ba(qX),KX=Xr({},ed,{data:0}),$D=ba(KX),ZX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},JX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eq(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=JX[t])?!!e[t]:!1}function oS(){return eq}var tq=Xr({},Qm,{key:function(t){if(t.key){var e=ZX[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=E4(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?QX[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oS,charCode:function(t){return t.type==="keypress"?E4(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?E4(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nq=ba(tq),rq=Xr({},l5,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kD=ba(rq),iq=Xr({},Qm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oS}),oq=ba(iq),aq=Xr({},ed,{propertyName:0,elapsedTime:0,pseudoElement:0}),sq=ba(aq),uq=Xr({},l5,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lq=ba(uq),cq=[9,13,27,32],aS=K1&&"CompositionEvent"in window,O6=null;K1&&"documentMode"in document&&(O6=document.documentMode);var dq=K1&&"TextEvent"in window&&!O6,XO=K1&&(!aS||O6&&8<O6&&11>=O6),BD=String.fromCharCode(32),UD=!1;function qO(t,e){switch(t){case"keyup":return cq.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var H2=!1;function mq(t,e){switch(t){case"compositionend":return GO(e);case"keypress":return e.which!==32?null:(UD=!0,BD);case"textInput":return t=e.data,t===BD&&UD?null:t;default:return null}}function fq(t,e){if(H2)return t==="compositionend"||!aS&&qO(t,e)?(t=YO(),S4=rS=Nu=null,H2=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return XO&&e.locale!=="ko"?null:e.data;default:return null}}var hq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VD(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!hq[t.type]:e==="textarea"}function KO(t,e,n,r){AO(r),e=$h(e,"onChange"),0<e.length&&(n=new iS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var P6=null,lm=null;function pq(t){sP(t,0)}function c5(t){var e=W2(t);if(CO(e))return t}function gq(t,e){if(t==="change")return e}var ZO=!1;if(K1){var Ap;if(K1){var Tp="oninput"in document;if(!Tp){var HD=document.createElement("div");HD.setAttribute("oninput","return;"),Tp=typeof HD.oninput=="function"}Ap=Tp}else Ap=!1;ZO=Ap&&(!document.documentMode||9<document.documentMode)}function jD(){P6&&(P6.detachEvent("onpropertychange",QO),lm=P6=null)}function QO(t){if(t.propertyName==="value"&&c5(lm)){var e=[];KO(e,lm,t,QC(t)),OO(pq,e)}}function vq(t,e,n){t==="focusin"?(jD(),P6=e,lm=n,P6.attachEvent("onpropertychange",QO)):t==="focusout"&&jD()}function bq(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return c5(lm)}function _q(t,e){if(t==="click")return c5(e)}function Cq(t,e){if(t==="input"||t==="change")return c5(e)}function Sq(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ls=typeof Object.is=="function"?Object.is:Sq;function cm(t,e){if(Ls(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Mv.call(e,i)||!Ls(t[i],e[i]))return!1}return!0}function zD(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function WD(t,e){var n=zD(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zD(n)}}function JO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?JO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function eP(){for(var t=window,e=Lh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Lh(t.document)}return e}function sS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Eq(t){var e=eP(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&JO(n.ownerDocument.documentElement,n)){if(r!==null&&sS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=WD(n,o);var a=WD(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var yq=K1&&"documentMode"in document&&11>=document.documentMode,j2=null,Qv=null,M6=null,Jv=!1;function YD(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jv||j2==null||j2!==Lh(r)||(r=j2,"selectionStart"in r&&sS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),M6&&cm(M6,r)||(M6=r,r=$h(Qv,"onSelect"),0<r.length&&(e=new iS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=j2)))}function c3(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var z2={animationend:c3("Animation","AnimationEnd"),animationiteration:c3("Animation","AnimationIteration"),animationstart:c3("Animation","AnimationStart"),transitionend:c3("Transition","TransitionEnd")},wp={},tP={};K1&&(tP=document.createElement("div").style,"AnimationEvent"in window||(delete z2.animationend.animation,delete z2.animationiteration.animation,delete z2.animationstart.animation),"TransitionEvent"in window||delete z2.transitionend.transition);function d5(t){if(wp[t])return wp[t];if(!z2[t])return t;var e=z2[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in tP)return wp[t]=e[n];return t}var nP=d5("animationend"),rP=d5("animationiteration"),iP=d5("animationstart"),oP=d5("transitionend"),aP=new Map,XD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dl(t,e){aP.set(t,e),Hc(e,[t])}for(var Lp=0;Lp<XD.length;Lp++){var Op=XD[Lp],Dq=Op.toLowerCase(),Rq=Op[0].toUpperCase()+Op.slice(1);Dl(Dq,"on"+Rq)}Dl(nP,"onAnimationEnd");Dl(rP,"onAnimationIteration");Dl(iP,"onAnimationStart");Dl("dblclick","onDoubleClick");Dl("focusin","onFocus");Dl("focusout","onBlur");Dl(oP,"onTransitionEnd");D0("onMouseEnter",["mouseout","mouseover"]);D0("onMouseLeave",["mouseout","mouseover"]);D0("onPointerEnter",["pointerout","pointerover"]);D0("onPointerLeave",["pointerout","pointerover"]);Hc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var f6="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Iq=new Set("cancel close invalid load scroll toggle".split(" ").concat(f6));function qD(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,DX(r,e,void 0,t),t.currentTarget=null}function sP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;qD(i,s,l),o=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;qD(i,s,l),o=u}}}if(Ph)throw t=qv,Ph=!1,qv=null,t}function xr(t,e){var n=e[ib];n===void 0&&(n=e[ib]=new Set);var r=t+"__bubble";n.has(r)||(uP(e,t,2,!1),n.add(r))}function Pp(t,e,n){var r=0;e&&(r|=4),uP(n,t,r,e)}var d3="_reactListening"+Math.random().toString(36).slice(2);function dm(t){if(!t[d3]){t[d3]=!0,pO.forEach(function(n){n!=="selectionchange"&&(Iq.has(n)||Pp(n,!1,t),Pp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[d3]||(e[d3]=!0,Pp("selectionchange",!1,e))}}function uP(t,e,n,r){switch(WO(e)){case 1:var i=UX;break;case 4:i=VX;break;default:i=nS}n=i.bind(null,e,n,t),i=void 0,!Xv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Mp(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;s!==null;){if(a=ic(s),a===null)return;if(u=a.tag,u===5||u===6){r=o=a;continue e}s=s.parentNode}}r=r.return}OO(function(){var l=o,c=QC(n),d=[];e:{var m=aP.get(t);if(m!==void 0){var f=iS,h=t;switch(t){case"keypress":if(E4(n)===0)break e;case"keydown":case"keyup":f=nq;break;case"focusin":h="focus",f=Ip;break;case"focusout":h="blur",f=Ip;break;case"beforeblur":case"afterblur":f=Ip;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=FD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=zX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=oq;break;case nP:case rP:case iP:f=XX;break;case oP:f=sq;break;case"scroll":f=HX;break;case"wheel":f=lq;break;case"copy":case"cut":case"paste":f=GX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=kD}var p=(e&4)!==0,v=!p&&t==="scroll",g=p?m!==null?m+"Capture":null:m;p=[];for(var b=l,C;b!==null;){C=b;var S=C.stateNode;if(C.tag===5&&S!==null&&(C=S,g!==null&&(S=om(b,g),S!=null&&p.push(mm(b,S,C)))),v)break;b=b.return}0<p.length&&(m=new f(m,h,null,n,c),d.push({event:m,listeners:p}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",m&&n!==Wv&&(h=n.relatedTarget||n.fromElement)&&(ic(h)||h[Z1]))break e;if((f||m)&&(m=c.window===c?c:(m=c.ownerDocument)?m.defaultView||m.parentWindow:window,f?(h=n.relatedTarget||n.toElement,f=l,h=h?ic(h):null,h!==null&&(v=jc(h),h!==v||h.tag!==5&&h.tag!==6)&&(h=null)):(f=null,h=l),f!==h)){if(p=FD,S="onMouseLeave",g="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(p=kD,S="onPointerLeave",g="onPointerEnter",b="pointer"),v=f==null?m:W2(f),C=h==null?m:W2(h),m=new p(S,b+"leave",f,n,c),m.target=v,m.relatedTarget=C,S=null,ic(c)===l&&(p=new p(g,b+"enter",h,n,c),p.target=C,p.relatedTarget=v,S=p),v=S,f&&h)t:{for(p=f,g=h,b=0,C=p;C;C=s2(C))b++;for(C=0,S=g;S;S=s2(S))C++;for(;0<b-C;)p=s2(p),b--;for(;0<C-b;)g=s2(g),C--;for(;b--;){if(p===g||g!==null&&p===g.alternate)break t;p=s2(p),g=s2(g)}p=null}else p=null;f!==null&&GD(d,m,f,p,!1),h!==null&&v!==null&&GD(d,v,h,p,!0)}}e:{if(m=l?W2(l):window,f=m.nodeName&&m.nodeName.toLowerCase(),f==="select"||f==="input"&&m.type==="file")var E=gq;else if(VD(m))if(ZO)E=Cq;else{E=bq;var y=vq}else(f=m.nodeName)&&f.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(E=_q);if(E&&(E=E(t,l))){KO(d,E,n,c);break e}y&&y(t,m,l),t==="focusout"&&(y=m._wrapperState)&&y.controlled&&m.type==="number"&&Uv(m,"number",m.value)}switch(y=l?W2(l):window,t){case"focusin":(VD(y)||y.contentEditable==="true")&&(j2=y,Qv=l,M6=null);break;case"focusout":M6=Qv=j2=null;break;case"mousedown":Jv=!0;break;case"contextmenu":case"mouseup":case"dragend":Jv=!1,YD(d,n,c);break;case"selectionchange":if(yq)break;case"keydown":case"keyup":YD(d,n,c)}var D;if(aS)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else H2?qO(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(XO&&n.locale!=="ko"&&(H2||R!=="onCompositionStart"?R==="onCompositionEnd"&&H2&&(D=YO()):(Nu=c,rS="value"in Nu?Nu.value:Nu.textContent,H2=!0)),y=$h(l,R),0<y.length&&(R=new $D(R,t,null,n,c),d.push({event:R,listeners:y}),D?R.data=D:(D=GO(n),D!==null&&(R.data=D)))),(D=dq?mq(t,n):fq(t,n))&&(l=$h(l,"onBeforeInput"),0<l.length&&(c=new $D("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=D))}sP(d,e)})}function mm(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $h(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=om(t,n),o!=null&&r.unshift(mm(t,o,i)),o=om(t,e),o!=null&&r.push(mm(t,o,i))),t=t.return}return r}function s2(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function GD(t,e,n,r,i){for(var o=e._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,i?(u=om(n,o),u!=null&&a.unshift(mm(n,u,s))):i||(u=om(n,o),u!=null&&a.push(mm(n,u,s)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var Aq=/\r\n?/g,Tq=/\u0000|\uFFFD/g;function KD(t){return(typeof t=="string"?t:""+t).replace(Aq,`
`).replace(Tq,"")}function m3(t,e,n){if(e=KD(e),KD(t)!==e&&n)throw Error(vt(425))}function kh(){}var eb=null,tb=null;function nb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rb=typeof setTimeout=="function"?setTimeout:void 0,wq=typeof clearTimeout=="function"?clearTimeout:void 0,ZD=typeof Promise=="function"?Promise:void 0,Lq=typeof queueMicrotask=="function"?queueMicrotask:typeof ZD<"u"?function(t){return ZD.resolve(null).then(t).catch(Oq)}:rb;function Oq(t){setTimeout(function(){throw t})}function Np(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),um(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);um(e)}function Yu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function QD(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var td=Math.random().toString(36).slice(2),n1="__reactFiber$"+td,fm="__reactProps$"+td,Z1="__reactContainer$"+td,ib="__reactEvents$"+td,Pq="__reactListeners$"+td,Mq="__reactHandles$"+td;function ic(t){var e=t[n1];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Z1]||n[n1]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=QD(t);t!==null;){if(n=t[n1])return n;t=QD(t)}return e}t=n,n=t.parentNode}return null}function Jm(t){return t=t[n1]||t[Z1],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function W2(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(vt(33))}function m5(t){return t[fm]||null}var ob=[],Y2=-1;function Rl(t){return{current:t}}function $r(t){0>Y2||(t.current=ob[Y2],ob[Y2]=null,Y2--)}function Lr(t,e){Y2++,ob[Y2]=t.current,t.current=e}var il={},ao=Rl(il),Vo=Rl(!1),Ec=il;function R0(t,e){var n=t.type.contextTypes;if(!n)return il;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ho(t){return t=t.childContextTypes,t!=null}function Bh(){$r(Vo),$r(ao)}function JD(t,e,n){if(ao.current!==il)throw Error(vt(168));Lr(ao,e),Lr(Vo,n)}function lP(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(vt(108,vX(t)||"Unknown",i));return Xr({},n,r)}function Uh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||il,Ec=ao.current,Lr(ao,t),Lr(Vo,Vo.current),!0}function eR(t,e,n){var r=t.stateNode;if(!r)throw Error(vt(169));n?(t=lP(t,e,Ec),r.__reactInternalMemoizedMergedChildContext=t,$r(Vo),$r(ao),Lr(ao,t)):$r(Vo),Lr(Vo,n)}var F1=null,f5=!1,xp=!1;function cP(t){F1===null?F1=[t]:F1.push(t)}function Nq(t){f5=!0,cP(t)}function Il(){if(!xp&&F1!==null){xp=!0;var t=0,e=br;try{var n=F1;for(br=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}F1=null,f5=!1}catch(i){throw F1!==null&&(F1=F1.slice(t+1)),xO(JC,Il),i}finally{br=e,xp=!1}}return null}var X2=[],q2=0,Vh=null,Hh=0,Oa=[],Pa=0,yc=null,k1=1,B1="";function Yl(t,e){X2[q2++]=Hh,X2[q2++]=Vh,Vh=t,Hh=e}function dP(t,e,n){Oa[Pa++]=k1,Oa[Pa++]=B1,Oa[Pa++]=yc,yc=t;var r=k1;t=B1;var i=32-Es(r)-1;r&=~(1<<i),n+=1;var o=32-Es(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,k1=1<<32-Es(e)+i|n<<i|r,B1=o+t}else k1=1<<o|n<<i|r,B1=t}function uS(t){t.return!==null&&(Yl(t,1),dP(t,1,0))}function lS(t){for(;t===Vh;)Vh=X2[--q2],X2[q2]=null,Hh=X2[--q2],X2[q2]=null;for(;t===yc;)yc=Oa[--Pa],Oa[Pa]=null,B1=Oa[--Pa],Oa[Pa]=null,k1=Oa[--Pa],Oa[Pa]=null}var ma=null,ua=null,Ur=!1,fs=null;function mP(t,e){var n=Ba(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function tR(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ma=t,ua=Yu(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ma=t,ua=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=yc!==null?{id:k1,overflow:B1}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ba(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ma=t,ua=null,!0):!1;default:return!1}}function ab(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sb(t){if(Ur){var e=ua;if(e){var n=e;if(!tR(t,e)){if(ab(t))throw Error(vt(418));e=Yu(n.nextSibling);var r=ma;e&&tR(t,e)?mP(r,n):(t.flags=t.flags&-4097|2,Ur=!1,ma=t)}}else{if(ab(t))throw Error(vt(418));t.flags=t.flags&-4097|2,Ur=!1,ma=t}}}function nR(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ma=t}function f3(t){if(t!==ma)return!1;if(!Ur)return nR(t),Ur=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!nb(t.type,t.memoizedProps)),e&&(e=ua)){if(ab(t))throw fP(),Error(vt(418));for(;e;)mP(t,e),e=Yu(e.nextSibling)}if(nR(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(vt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ua=Yu(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ua=null}}else ua=ma?Yu(t.stateNode.nextSibling):null;return!0}function fP(){for(var t=ua;t;)t=Yu(t.nextSibling)}function I0(){ua=ma=null,Ur=!1}function cS(t){fs===null?fs=[t]:fs.push(t)}var xq=au.ReactCurrentBatchConfig;function ls(t,e){if(t&&t.defaultProps){e=Xr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var jh=Rl(null),zh=null,G2=null,dS=null;function mS(){dS=G2=zh=null}function fS(t){var e=jh.current;$r(jh),t._currentValue=e}function ub(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function f0(t,e){zh=t,dS=G2=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bo=!0),t.firstContext=null)}function Ya(t){var e=t._currentValue;if(dS!==t)if(t={context:t,memoizedValue:e,next:null},G2===null){if(zh===null)throw Error(vt(308));G2=t,zh.dependencies={lanes:0,firstContext:t}}else G2=G2.next=t;return e}var oc=null;function hS(t){oc===null?oc=[t]:oc.push(t)}function hP(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,hS(e)):(n.next=i.next,i.next=n),e.interleaved=n,Q1(t,r)}function Q1(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Lu=!1;function pS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pP(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Y1(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xu(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ir&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Q1(t,n)}return i=r.interleaved,i===null?(e.next=e,hS(r)):(e.next=i.next,i.next=e),r.interleaved=e,Q1(t,n)}function y4(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,eS(t,n)}}function rR(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wh(t,e,n,r){var i=t.updateQueue;Lu=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?o=l:a.next=l,a=u;var c=t.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(o!==null){var d=i.baseState;a=0,c=l=u=null,s=o;do{var m=s.lane,f=s.eventTime;if((r&m)===m){c!==null&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=t,p=s;switch(m=e,f=n,p.tag){case 1:if(h=p.payload,typeof h=="function"){d=h.call(f,d,m);break e}d=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=p.payload,m=typeof h=="function"?h.call(f,d,m):h,m==null)break e;d=Xr({},d,m);break e;case 2:Lu=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[s]:m.push(s))}else f={eventTime:f,lane:m,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=f,u=d):c=c.next=f,a|=m;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;m=s,s=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(c===null&&(u=d),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Rc|=a,t.lanes=a,t.memoizedState=d}}function iR(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(vt(191,i));i.call(r)}}}var gP=new hO.Component().refs;function lb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Xr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var h5={isMounted:function(t){return(t=t._reactInternals)?jc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=bo(),i=Gu(t),o=Y1(r,i);o.payload=e,n!=null&&(o.callback=n),e=Xu(t,o,i),e!==null&&(ys(e,t,i,r),y4(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=bo(),i=Gu(t),o=Y1(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Xu(t,o,i),e!==null&&(ys(e,t,i,r),y4(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=bo(),r=Gu(t),i=Y1(n,r);i.tag=2,e!=null&&(i.callback=e),e=Xu(t,i,r),e!==null&&(ys(e,t,r,n),y4(e,t,r))}};function oR(t,e,n,r,i,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!cm(n,r)||!cm(i,o):!0}function vP(t,e,n){var r=!1,i=il,o=e.contextType;return typeof o=="object"&&o!==null?o=Ya(o):(i=Ho(e)?Ec:ao.current,r=e.contextTypes,o=(r=r!=null)?R0(t,i):il),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=h5,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function aR(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&h5.enqueueReplaceState(e,e.state,null)}function cb(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=gP,pS(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Ya(o):(o=Ho(e)?Ec:ao.current,i.context=R0(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(lb(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&h5.enqueueReplaceState(i,i.state,null),Wh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Pd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(vt(309));var r=n.stateNode}if(!r)throw Error(vt(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var s=i.refs;s===gP&&(s=i.refs={}),a===null?delete s[o]:s[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(vt(284));if(!n._owner)throw Error(vt(290,t))}return t}function h3(t,e){throw t=Object.prototype.toString.call(e),Error(vt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function sR(t){var e=t._init;return e(t._payload)}function bP(t){function e(g,b){if(t){var C=g.deletions;C===null?(g.deletions=[b],g.flags|=16):C.push(b)}}function n(g,b){if(!t)return null;for(;b!==null;)e(g,b),b=b.sibling;return null}function r(g,b){for(g=new Map;b!==null;)b.key!==null?g.set(b.key,b):g.set(b.index,b),b=b.sibling;return g}function i(g,b){return g=Ku(g,b),g.index=0,g.sibling=null,g}function o(g,b,C){return g.index=C,t?(C=g.alternate,C!==null?(C=C.index,C<b?(g.flags|=2,b):C):(g.flags|=2,b)):(g.flags|=1048576,b)}function a(g){return t&&g.alternate===null&&(g.flags|=2),g}function s(g,b,C,S){return b===null||b.tag!==6?(b=Hp(C,g.mode,S),b.return=g,b):(b=i(b,C),b.return=g,b)}function u(g,b,C,S){var E=C.type;return E===V2?c(g,b,C.props.children,S,C.key):b!==null&&(b.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===wu&&sR(E)===b.type)?(S=i(b,C.props),S.ref=Pd(g,b,C),S.return=g,S):(S=w4(C.type,C.key,C.props,null,g.mode,S),S.ref=Pd(g,b,C),S.return=g,S)}function l(g,b,C,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==C.containerInfo||b.stateNode.implementation!==C.implementation?(b=jp(C,g.mode,S),b.return=g,b):(b=i(b,C.children||[]),b.return=g,b)}function c(g,b,C,S,E){return b===null||b.tag!==7?(b=fc(C,g.mode,S,E),b.return=g,b):(b=i(b,C),b.return=g,b)}function d(g,b,C){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Hp(""+b,g.mode,C),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case r3:return C=w4(b.type,b.key,b.props,null,g.mode,C),C.ref=Pd(g,null,b),C.return=g,C;case U2:return b=jp(b,g.mode,C),b.return=g,b;case wu:var S=b._init;return d(g,S(b._payload),C)}if(d6(b)||Ad(b))return b=fc(b,g.mode,C,null),b.return=g,b;h3(g,b)}return null}function m(g,b,C,S){var E=b!==null?b.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return E!==null?null:s(g,b,""+C,S);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case r3:return C.key===E?u(g,b,C,S):null;case U2:return C.key===E?l(g,b,C,S):null;case wu:return E=C._init,m(g,b,E(C._payload),S)}if(d6(C)||Ad(C))return E!==null?null:c(g,b,C,S,null);h3(g,C)}return null}function f(g,b,C,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(C)||null,s(b,g,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case r3:return g=g.get(S.key===null?C:S.key)||null,u(b,g,S,E);case U2:return g=g.get(S.key===null?C:S.key)||null,l(b,g,S,E);case wu:var y=S._init;return f(g,b,C,y(S._payload),E)}if(d6(S)||Ad(S))return g=g.get(C)||null,c(b,g,S,E,null);h3(b,S)}return null}function h(g,b,C,S){for(var E=null,y=null,D=b,R=b=0,I=null;D!==null&&R<C.length;R++){D.index>R?(I=D,D=null):I=D.sibling;var T=m(g,D,C[R],S);if(T===null){D===null&&(D=I);break}t&&D&&T.alternate===null&&e(g,D),b=o(T,b,R),y===null?E=T:y.sibling=T,y=T,D=I}if(R===C.length)return n(g,D),Ur&&Yl(g,R),E;if(D===null){for(;R<C.length;R++)D=d(g,C[R],S),D!==null&&(b=o(D,b,R),y===null?E=D:y.sibling=D,y=D);return Ur&&Yl(g,R),E}for(D=r(g,D);R<C.length;R++)I=f(D,g,R,C[R],S),I!==null&&(t&&I.alternate!==null&&D.delete(I.key===null?R:I.key),b=o(I,b,R),y===null?E=I:y.sibling=I,y=I);return t&&D.forEach(function(P){return e(g,P)}),Ur&&Yl(g,R),E}function p(g,b,C,S){var E=Ad(C);if(typeof E!="function")throw Error(vt(150));if(C=E.call(C),C==null)throw Error(vt(151));for(var y=E=null,D=b,R=b=0,I=null,T=C.next();D!==null&&!T.done;R++,T=C.next()){D.index>R?(I=D,D=null):I=D.sibling;var P=m(g,D,T.value,S);if(P===null){D===null&&(D=I);break}t&&D&&P.alternate===null&&e(g,D),b=o(P,b,R),y===null?E=P:y.sibling=P,y=P,D=I}if(T.done)return n(g,D),Ur&&Yl(g,R),E;if(D===null){for(;!T.done;R++,T=C.next())T=d(g,T.value,S),T!==null&&(b=o(T,b,R),y===null?E=T:y.sibling=T,y=T);return Ur&&Yl(g,R),E}for(D=r(g,D);!T.done;R++,T=C.next())T=f(D,g,R,T.value,S),T!==null&&(t&&T.alternate!==null&&D.delete(T.key===null?R:T.key),b=o(T,b,R),y===null?E=T:y.sibling=T,y=T);return t&&D.forEach(function(N){return e(g,N)}),Ur&&Yl(g,R),E}function v(g,b,C,S){if(typeof C=="object"&&C!==null&&C.type===V2&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case r3:e:{for(var E=C.key,y=b;y!==null;){if(y.key===E){if(E=C.type,E===V2){if(y.tag===7){n(g,y.sibling),b=i(y,C.props.children),b.return=g,g=b;break e}}else if(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===wu&&sR(E)===y.type){n(g,y.sibling),b=i(y,C.props),b.ref=Pd(g,y,C),b.return=g,g=b;break e}n(g,y);break}else e(g,y);y=y.sibling}C.type===V2?(b=fc(C.props.children,g.mode,S,C.key),b.return=g,g=b):(S=w4(C.type,C.key,C.props,null,g.mode,S),S.ref=Pd(g,b,C),S.return=g,g=S)}return a(g);case U2:e:{for(y=C.key;b!==null;){if(b.key===y)if(b.tag===4&&b.stateNode.containerInfo===C.containerInfo&&b.stateNode.implementation===C.implementation){n(g,b.sibling),b=i(b,C.children||[]),b.return=g,g=b;break e}else{n(g,b);break}else e(g,b);b=b.sibling}b=jp(C,g.mode,S),b.return=g,g=b}return a(g);case wu:return y=C._init,v(g,b,y(C._payload),S)}if(d6(C))return h(g,b,C,S);if(Ad(C))return p(g,b,C,S);h3(g,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,b!==null&&b.tag===6?(n(g,b.sibling),b=i(b,C),b.return=g,g=b):(n(g,b),b=Hp(C,g.mode,S),b.return=g,g=b),a(g)):n(g,b)}return v}var A0=bP(!0),_P=bP(!1),ef={},s1=Rl(ef),hm=Rl(ef),pm=Rl(ef);function ac(t){if(t===ef)throw Error(vt(174));return t}function gS(t,e){switch(Lr(pm,e),Lr(hm,t),Lr(s1,ef),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hv(e,t)}$r(s1),Lr(s1,e)}function T0(){$r(s1),$r(hm),$r(pm)}function CP(t){ac(pm.current);var e=ac(s1.current),n=Hv(e,t.type);e!==n&&(Lr(hm,t),Lr(s1,n))}function vS(t){hm.current===t&&($r(s1),$r(hm))}var zr=Rl(0);function Yh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fp=[];function bS(){for(var t=0;t<Fp.length;t++)Fp[t]._workInProgressVersionPrimary=null;Fp.length=0}var D4=au.ReactCurrentDispatcher,$p=au.ReactCurrentBatchConfig,Dc=0,Yr=null,hi=null,Di=null,Xh=!1,N6=!1,gm=0,Fq=0;function Xi(){throw Error(vt(321))}function _S(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ls(t[n],e[n]))return!1;return!0}function CS(t,e,n,r,i,o){if(Dc=o,Yr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,D4.current=t===null||t.memoizedState===null?Uq:Vq,t=n(r,i),N6){o=0;do{if(N6=!1,gm=0,25<=o)throw Error(vt(301));o+=1,Di=hi=null,e.updateQueue=null,D4.current=Hq,t=n(r,i)}while(N6)}if(D4.current=qh,e=hi!==null&&hi.next!==null,Dc=0,Di=hi=Yr=null,Xh=!1,e)throw Error(vt(300));return t}function SS(){var t=gm!==0;return gm=0,t}function Ks(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Di===null?Yr.memoizedState=Di=t:Di=Di.next=t,Di}function Xa(){if(hi===null){var t=Yr.alternate;t=t!==null?t.memoizedState:null}else t=hi.next;var e=Di===null?Yr.memoizedState:Di.next;if(e!==null)Di=e,hi=t;else{if(t===null)throw Error(vt(310));hi=t,t={memoizedState:hi.memoizedState,baseState:hi.baseState,baseQueue:hi.baseQueue,queue:hi.queue,next:null},Di===null?Yr.memoizedState=Di=t:Di=Di.next=t}return Di}function vm(t,e){return typeof e=="function"?e(t):e}function kp(t){var e=Xa(),n=e.queue;if(n===null)throw Error(vt(311));n.lastRenderedReducer=t;var r=hi,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var s=a=null,u=null,l=o;do{var c=l.lane;if((Dc&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,Yr.lanes|=c,Rc|=c}l=l.next}while(l!==null&&l!==o);u===null?a=r:u.next=s,Ls(r,e.memoizedState)||(Bo=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Yr.lanes|=o,Rc|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Bp(t){var e=Xa(),n=e.queue;if(n===null)throw Error(vt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=t(o,a.action),a=a.next;while(a!==i);Ls(o,e.memoizedState)||(Bo=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function SP(){}function EP(t,e){var n=Yr,r=Xa(),i=e(),o=!Ls(r.memoizedState,i);if(o&&(r.memoizedState=i,Bo=!0),r=r.queue,ES(RP.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Di!==null&&Di.memoizedState.tag&1){if(n.flags|=2048,bm(9,DP.bind(null,n,r,i,e),void 0,null),Ri===null)throw Error(vt(349));Dc&30||yP(n,e,i)}return i}function yP(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Yr.updateQueue,e===null?(e={lastEffect:null,stores:null},Yr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function DP(t,e,n,r){e.value=n,e.getSnapshot=r,IP(e)&&AP(t)}function RP(t,e,n){return n(function(){IP(e)&&AP(t)})}function IP(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ls(t,n)}catch{return!0}}function AP(t){var e=Q1(t,1);e!==null&&ys(e,t,1,-1)}function uR(t){var e=Ks();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vm,lastRenderedState:t},e.queue=t,t=t.dispatch=Bq.bind(null,Yr,t),[e.memoizedState,t]}function bm(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Yr.updateQueue,e===null?(e={lastEffect:null,stores:null},Yr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function TP(){return Xa().memoizedState}function R4(t,e,n,r){var i=Ks();Yr.flags|=t,i.memoizedState=bm(1|e,n,void 0,r===void 0?null:r)}function p5(t,e,n,r){var i=Xa();r=r===void 0?null:r;var o=void 0;if(hi!==null){var a=hi.memoizedState;if(o=a.destroy,r!==null&&_S(r,a.deps)){i.memoizedState=bm(e,n,o,r);return}}Yr.flags|=t,i.memoizedState=bm(1|e,n,o,r)}function lR(t,e){return R4(8390656,8,t,e)}function ES(t,e){return p5(2048,8,t,e)}function wP(t,e){return p5(4,2,t,e)}function LP(t,e){return p5(4,4,t,e)}function OP(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function PP(t,e,n){return n=n!=null?n.concat([t]):null,p5(4,4,OP.bind(null,e,t),n)}function yS(){}function MP(t,e){var n=Xa();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_S(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function NP(t,e){var n=Xa();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_S(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function xP(t,e,n){return Dc&21?(Ls(n,e)||(n=kO(),Yr.lanes|=n,Rc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bo=!0),t.memoizedState=n)}function $q(t,e){var n=br;br=n!==0&&4>n?n:4,t(!0);var r=$p.transition;$p.transition={};try{t(!1),e()}finally{br=n,$p.transition=r}}function FP(){return Xa().memoizedState}function kq(t,e,n){var r=Gu(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},$P(t))kP(e,n);else if(n=hP(t,e,n,r),n!==null){var i=bo();ys(n,t,r,i),BP(n,e,r)}}function Bq(t,e,n){var r=Gu(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if($P(t))kP(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,Ls(s,a)){var u=e.interleaved;u===null?(i.next=i,hS(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=hP(t,e,i,r),n!==null&&(i=bo(),ys(n,t,r,i),BP(n,e,r))}}function $P(t){var e=t.alternate;return t===Yr||e!==null&&e===Yr}function kP(t,e){N6=Xh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function BP(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,eS(t,n)}}var qh={readContext:Ya,useCallback:Xi,useContext:Xi,useEffect:Xi,useImperativeHandle:Xi,useInsertionEffect:Xi,useLayoutEffect:Xi,useMemo:Xi,useReducer:Xi,useRef:Xi,useState:Xi,useDebugValue:Xi,useDeferredValue:Xi,useTransition:Xi,useMutableSource:Xi,useSyncExternalStore:Xi,useId:Xi,unstable_isNewReconciler:!1},Uq={readContext:Ya,useCallback:function(t,e){return Ks().memoizedState=[t,e===void 0?null:e],t},useContext:Ya,useEffect:lR,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,R4(4194308,4,OP.bind(null,e,t),n)},useLayoutEffect:function(t,e){return R4(4194308,4,t,e)},useInsertionEffect:function(t,e){return R4(4,2,t,e)},useMemo:function(t,e){var n=Ks();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ks();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=kq.bind(null,Yr,t),[r.memoizedState,t]},useRef:function(t){var e=Ks();return t={current:t},e.memoizedState=t},useState:uR,useDebugValue:yS,useDeferredValue:function(t){return Ks().memoizedState=t},useTransition:function(){var t=uR(!1),e=t[0];return t=$q.bind(null,t[1]),Ks().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Yr,i=Ks();if(Ur){if(n===void 0)throw Error(vt(407));n=n()}else{if(n=e(),Ri===null)throw Error(vt(349));Dc&30||yP(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,lR(RP.bind(null,r,o,t),[t]),r.flags|=2048,bm(9,DP.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Ks(),e=Ri.identifierPrefix;if(Ur){var n=B1,r=k1;n=(r&~(1<<32-Es(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=gm++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Fq++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Vq={readContext:Ya,useCallback:MP,useContext:Ya,useEffect:ES,useImperativeHandle:PP,useInsertionEffect:wP,useLayoutEffect:LP,useMemo:NP,useReducer:kp,useRef:TP,useState:function(){return kp(vm)},useDebugValue:yS,useDeferredValue:function(t){var e=Xa();return xP(e,hi.memoizedState,t)},useTransition:function(){var t=kp(vm)[0],e=Xa().memoizedState;return[t,e]},useMutableSource:SP,useSyncExternalStore:EP,useId:FP,unstable_isNewReconciler:!1},Hq={readContext:Ya,useCallback:MP,useContext:Ya,useEffect:ES,useImperativeHandle:PP,useInsertionEffect:wP,useLayoutEffect:LP,useMemo:NP,useReducer:Bp,useRef:TP,useState:function(){return Bp(vm)},useDebugValue:yS,useDeferredValue:function(t){var e=Xa();return hi===null?e.memoizedState=t:xP(e,hi.memoizedState,t)},useTransition:function(){var t=Bp(vm)[0],e=Xa().memoizedState;return[t,e]},useMutableSource:SP,useSyncExternalStore:EP,useId:FP,unstable_isNewReconciler:!1};function w0(t,e){try{var n="",r=e;do n+=gX(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Up(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function db(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var jq=typeof WeakMap=="function"?WeakMap:Map;function UP(t,e,n){n=Y1(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Kh||(Kh=!0,Sb=r),db(t,e)},n}function VP(t,e,n){n=Y1(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){db(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){db(t,e),typeof r!="function"&&(qu===null?qu=new Set([this]):qu.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function cR(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new jq;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=rG.bind(null,t,e,n),e.then(t,t))}function dR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function mR(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Y1(-1,1),e.tag=2,Xu(n,e,1))),n.lanes|=1),t)}var zq=au.ReactCurrentOwner,Bo=!1;function fo(t,e,n,r){e.child=t===null?_P(e,null,n,r):A0(e,t.child,n,r)}function fR(t,e,n,r,i){n=n.render;var o=e.ref;return f0(e,i),r=CS(t,e,n,r,o,i),n=SS(),t!==null&&!Bo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,J1(t,e,i)):(Ur&&n&&uS(e),e.flags|=1,fo(t,e,r,i),e.child)}function hR(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!OS(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,HP(t,e,o,r,i)):(t=w4(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:cm,n(a,r)&&t.ref===e.ref)return J1(t,e,i)}return e.flags|=1,t=Ku(o,r),t.ref=e.ref,t.return=e,e.child=t}function HP(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(cm(o,r)&&t.ref===e.ref)if(Bo=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Bo=!0);else return e.lanes=t.lanes,J1(t,e,i)}return mb(t,e,n,r,i)}function jP(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lr(Z2,aa),aa|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Lr(Z2,aa),aa|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Lr(Z2,aa),aa|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Lr(Z2,aa),aa|=r;return fo(t,e,i,n),e.child}function zP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function mb(t,e,n,r,i){var o=Ho(n)?Ec:ao.current;return o=R0(e,o),f0(e,i),n=CS(t,e,n,r,o,i),r=SS(),t!==null&&!Bo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,J1(t,e,i)):(Ur&&r&&uS(e),e.flags|=1,fo(t,e,n,i),e.child)}function pR(t,e,n,r,i){if(Ho(n)){var o=!0;Uh(e)}else o=!1;if(f0(e,i),e.stateNode===null)I4(t,e),vP(e,n,r),cb(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=Ya(l):(l=Ho(n)?Ec:ao.current,l=R0(e,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&aR(e,a,r,l),Lu=!1;var m=e.memoizedState;a.state=m,Wh(e,r,a,i),u=e.memoizedState,s!==r||m!==u||Vo.current||Lu?(typeof c=="function"&&(lb(e,n,c,r),u=e.memoizedState),(s=Lu||oR(e,n,s,r,m,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,pP(t,e),s=e.memoizedProps,l=e.type===e.elementType?s:ls(e.type,s),a.props=l,d=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Ya(u):(u=Ho(n)?Ec:ao.current,u=R0(e,u));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||m!==u)&&aR(e,a,r,u),Lu=!1,m=e.memoizedState,a.state=m,Wh(e,r,a,i);var h=e.memoizedState;s!==d||m!==h||Vo.current||Lu?(typeof f=="function"&&(lb(e,n,f,r),h=e.memoizedState),(l=Lu||oR(e,n,l,r,m,h,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,h,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,h,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=h),a.props=r,a.state=h,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return fb(t,e,n,r,o,i)}function fb(t,e,n,r,i,o){zP(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&eR(e,n,!1),J1(t,e,o);r=e.stateNode,zq.current=e;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=A0(e,t.child,null,o),e.child=A0(e,null,s,o)):fo(t,e,s,o),e.memoizedState=r.state,i&&eR(e,n,!0),e.child}function WP(t){var e=t.stateNode;e.pendingContext?JD(t,e.pendingContext,e.pendingContext!==e.context):e.context&&JD(t,e.context,!1),gS(t,e.containerInfo)}function gR(t,e,n,r,i){return I0(),cS(i),e.flags|=256,fo(t,e,n,r),e.child}var hb={dehydrated:null,treeContext:null,retryLane:0};function pb(t){return{baseLanes:t,cachePool:null,transitions:null}}function YP(t,e,n){var r=e.pendingProps,i=zr.current,o=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(i&2)!==0),s?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Lr(zr,i&1),t===null)return sb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=b5(a,r,0,null),t=fc(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=pb(n),e.memoizedState=hb,t):DS(e,a));if(i=t.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return Wq(t,e,a,r,s,i,n);if(o){o=r.fallback,a=e.mode,i=t.child,s=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ku(i,u),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=Ku(s,o):(o=fc(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?pb(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=hb,r}return o=t.child,t=o.sibling,r=Ku(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function DS(t,e){return e=b5({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function p3(t,e,n,r){return r!==null&&cS(r),A0(e,t.child,null,n),t=DS(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Wq(t,e,n,r,i,o,a){if(n)return e.flags&256?(e.flags&=-257,r=Up(Error(vt(422))),p3(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=b5({mode:"visible",children:r.children},i,0,null),o=fc(o,i,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&A0(e,t.child,null,a),e.child.memoizedState=pb(a),e.memoizedState=hb,o);if(!(e.mode&1))return p3(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,o=Error(vt(419)),r=Up(o,r,void 0),p3(t,e,a,r)}if(s=(a&t.childLanes)!==0,Bo||s){if(r=Ri,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Q1(t,i),ys(r,t,i,-1))}return LS(),r=Up(Error(vt(421))),p3(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=iG.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,ua=Yu(i.nextSibling),ma=e,Ur=!0,fs=null,t!==null&&(Oa[Pa++]=k1,Oa[Pa++]=B1,Oa[Pa++]=yc,k1=t.id,B1=t.overflow,yc=e),e=DS(e,r.children),e.flags|=4096,e)}function vR(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ub(t.return,e,n)}function Vp(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function XP(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(fo(t,e,r.children,n),r=zr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&vR(t,n,e);else if(t.tag===19)vR(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Lr(zr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Yh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Vp(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Yh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Vp(e,!0,n,null,o);break;case"together":Vp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function I4(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function J1(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Rc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(vt(153));if(e.child!==null){for(t=e.child,n=Ku(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ku(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Yq(t,e,n){switch(e.tag){case 3:WP(e),I0();break;case 5:CP(e);break;case 1:Ho(e.type)&&Uh(e);break;case 4:gS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Lr(jh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Lr(zr,zr.current&1),e.flags|=128,null):n&e.child.childLanes?YP(t,e,n):(Lr(zr,zr.current&1),t=J1(t,e,n),t!==null?t.sibling:null);Lr(zr,zr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return XP(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Lr(zr,zr.current),r)break;return null;case 22:case 23:return e.lanes=0,jP(t,e,n)}return J1(t,e,n)}var qP,gb,GP,KP;qP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gb=function(){};GP=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ac(s1.current);var o=null;switch(n){case"input":i=kv(t,i),r=kv(t,r),o=[];break;case"select":i=Xr({},i,{value:void 0}),r=Xr({},r,{value:void 0}),o=[];break;case"textarea":i=Vv(t,i),r=Vv(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=kh)}jv(n,r);var a;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var s=i[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(rm.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(s=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(o=o||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(rm.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&xr("scroll",t),o||s===u||(o=[])):(o=o||[]).push(l,u))}n&&(o=o||[]).push("style",n);var l=o;(e.updateQueue=l)&&(e.flags|=4)}};KP=function(t,e,n,r){n!==r&&(e.flags|=4)};function Md(t,e){if(!Ur)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qi(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Xq(t,e,n){var r=e.pendingProps;switch(lS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qi(e),null;case 1:return Ho(e.type)&&Bh(),qi(e),null;case 3:return r=e.stateNode,T0(),$r(Vo),$r(ao),bS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(f3(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fs!==null&&(Db(fs),fs=null))),gb(t,e),qi(e),null;case 5:vS(e);var i=ac(pm.current);if(n=e.type,t!==null&&e.stateNode!=null)GP(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(vt(166));return qi(e),null}if(t=ac(s1.current),f3(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[n1]=e,r[fm]=o,t=(e.mode&1)!==0,n){case"dialog":xr("cancel",r),xr("close",r);break;case"iframe":case"object":case"embed":xr("load",r);break;case"video":case"audio":for(i=0;i<f6.length;i++)xr(f6[i],r);break;case"source":xr("error",r);break;case"img":case"image":case"link":xr("error",r),xr("load",r);break;case"details":xr("toggle",r);break;case"input":ID(r,o),xr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},xr("invalid",r);break;case"textarea":TD(r,o),xr("invalid",r)}jv(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?r.textContent!==s&&(o.suppressHydrationWarning!==!0&&m3(r.textContent,s,t),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&m3(r.textContent,s,t),i=["children",""+s]):rm.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&xr("scroll",r)}switch(n){case"input":i3(r),AD(r,o,!0);break;case"textarea":i3(r),wD(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=kh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[n1]=e,t[fm]=r,qP(t,e,!1,!1),e.stateNode=t;e:{switch(a=zv(n,r),n){case"dialog":xr("cancel",t),xr("close",t),i=r;break;case"iframe":case"object":case"embed":xr("load",t),i=r;break;case"video":case"audio":for(i=0;i<f6.length;i++)xr(f6[i],t);i=r;break;case"source":xr("error",t),i=r;break;case"img":case"image":case"link":xr("error",t),xr("load",t),i=r;break;case"details":xr("toggle",t),i=r;break;case"input":ID(t,r),i=kv(t,r),xr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Xr({},r,{value:void 0}),xr("invalid",t);break;case"textarea":TD(t,r),i=Vv(t,r),xr("invalid",t);break;default:i=r}jv(n,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="style"?IO(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&DO(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&im(t,u):typeof u=="number"&&im(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(rm.hasOwnProperty(o)?u!=null&&o==="onScroll"&&xr("scroll",t):u!=null&&qC(t,o,u,a))}switch(n){case"input":i3(t),AD(t,r,!1);break;case"textarea":i3(t),wD(t);break;case"option":r.value!=null&&t.setAttribute("value",""+rl(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?l0(t,!!r.multiple,o,!1):r.defaultValue!=null&&l0(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=kh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qi(e),null;case 6:if(t&&e.stateNode!=null)KP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(vt(166));if(n=ac(pm.current),ac(s1.current),f3(e)){if(r=e.stateNode,n=e.memoizedProps,r[n1]=e,(o=r.nodeValue!==n)&&(t=ma,t!==null))switch(t.tag){case 3:m3(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&m3(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[n1]=e,e.stateNode=r}return qi(e),null;case 13:if($r(zr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ur&&ua!==null&&e.mode&1&&!(e.flags&128))fP(),I0(),e.flags|=98560,o=!1;else if(o=f3(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(vt(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(vt(317));o[n1]=e}else I0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qi(e),o=!1}else fs!==null&&(Db(fs),fs=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||zr.current&1?vi===0&&(vi=3):LS())),e.updateQueue!==null&&(e.flags|=4),qi(e),null);case 4:return T0(),gb(t,e),t===null&&dm(e.stateNode.containerInfo),qi(e),null;case 10:return fS(e.type._context),qi(e),null;case 17:return Ho(e.type)&&Bh(),qi(e),null;case 19:if($r(zr),o=e.memoizedState,o===null)return qi(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)Md(o,!1);else{if(vi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Yh(t),a!==null){for(e.flags|=128,Md(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Lr(zr,zr.current&1|2),e.child}t=t.sibling}o.tail!==null&&ri()>L0&&(e.flags|=128,r=!0,Md(o,!1),e.lanes=4194304)}else{if(!r)if(t=Yh(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Md(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Ur)return qi(e),null}else 2*ri()-o.renderingStartTime>L0&&n!==1073741824&&(e.flags|=128,r=!0,Md(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ri(),e.sibling=null,n=zr.current,Lr(zr,r?n&1|2:n&1),e):(qi(e),null);case 22:case 23:return wS(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?aa&1073741824&&(qi(e),e.subtreeFlags&6&&(e.flags|=8192)):qi(e),null;case 24:return null;case 25:return null}throw Error(vt(156,e.tag))}function qq(t,e){switch(lS(e),e.tag){case 1:return Ho(e.type)&&Bh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return T0(),$r(Vo),$r(ao),bS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vS(e),null;case 13:if($r(zr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(vt(340));I0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $r(zr),null;case 4:return T0(),null;case 10:return fS(e.type._context),null;case 22:case 23:return wS(),null;case 24:return null;default:return null}}var g3=!1,Ji=!1,Gq=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function K2(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Gr(t,e,r)}else n.current=null}function vb(t,e,n){try{n()}catch(r){Gr(t,e,r)}}var bR=!1;function Kq(t,e){if(eb=xh,t=eP(),sS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,d=t,m=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(s=a+i),d!==o||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(f=d.firstChild)!==null;)m=d,d=f;for(;;){if(d===t)break t;if(m===n&&++l===i&&(s=a),m===o&&++c===r&&(u=a),(f=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=f}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(tb={focusedElem:t,selectionRange:n},xh=!1,Ut=e;Ut!==null;)if(e=Ut,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ut=t;else for(;Ut!==null;){e=Ut;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var p=h.memoizedProps,v=h.memoizedState,g=e.stateNode,b=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:ls(e.type,p),v);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(vt(163))}}catch(S){Gr(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Ut=t;break}Ut=e.return}return h=bR,bR=!1,h}function x6(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&vb(e,n,o)}i=i.next}while(i!==r)}}function g5(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function bb(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ZP(t){var e=t.alternate;e!==null&&(t.alternate=null,ZP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[n1],delete e[fm],delete e[ib],delete e[Pq],delete e[Mq])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function QP(t){return t.tag===5||t.tag===3||t.tag===4}function _R(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||QP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _b(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=kh));else if(r!==4&&(t=t.child,t!==null))for(_b(t,e,n),t=t.sibling;t!==null;)_b(t,e,n),t=t.sibling}function Cb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Cb(t,e,n),t=t.sibling;t!==null;)Cb(t,e,n),t=t.sibling}var xi=null,cs=!1;function gu(t,e,n){for(n=n.child;n!==null;)JP(t,e,n),n=n.sibling}function JP(t,e,n){if(a1&&typeof a1.onCommitFiberUnmount=="function")try{a1.onCommitFiberUnmount(u5,n)}catch{}switch(n.tag){case 5:Ji||K2(n,e);case 6:var r=xi,i=cs;xi=null,gu(t,e,n),xi=r,cs=i,xi!==null&&(cs?(t=xi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):xi.removeChild(n.stateNode));break;case 18:xi!==null&&(cs?(t=xi,n=n.stateNode,t.nodeType===8?Np(t.parentNode,n):t.nodeType===1&&Np(t,n),um(t)):Np(xi,n.stateNode));break;case 4:r=xi,i=cs,xi=n.stateNode.containerInfo,cs=!0,gu(t,e,n),xi=r,cs=i;break;case 0:case 11:case 14:case 15:if(!Ji&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&vb(n,e,a),i=i.next}while(i!==r)}gu(t,e,n);break;case 1:if(!Ji&&(K2(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Gr(n,e,s)}gu(t,e,n);break;case 21:gu(t,e,n);break;case 22:n.mode&1?(Ji=(r=Ji)||n.memoizedState!==null,gu(t,e,n),Ji=r):gu(t,e,n);break;default:gu(t,e,n)}}function CR(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Gq),e.forEach(function(r){var i=oG.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ja(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:xi=s.stateNode,cs=!1;break e;case 3:xi=s.stateNode.containerInfo,cs=!0;break e;case 4:xi=s.stateNode.containerInfo,cs=!0;break e}s=s.return}if(xi===null)throw Error(vt(160));JP(o,a,i),xi=null,cs=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(l){Gr(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)eM(e,t),e=e.sibling}function eM(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ja(e,t),Hs(t),r&4){try{x6(3,t,t.return),g5(3,t)}catch(p){Gr(t,t.return,p)}try{x6(5,t,t.return)}catch(p){Gr(t,t.return,p)}}break;case 1:Ja(e,t),Hs(t),r&512&&n!==null&&K2(n,n.return);break;case 5:if(Ja(e,t),Hs(t),r&512&&n!==null&&K2(n,n.return),t.flags&32){var i=t.stateNode;try{im(i,"")}catch(p){Gr(t,t.return,p)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,s=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&SO(i,o),zv(s,a);var l=zv(s,o);for(a=0;a<u.length;a+=2){var c=u[a],d=u[a+1];c==="style"?IO(i,d):c==="dangerouslySetInnerHTML"?DO(i,d):c==="children"?im(i,d):qC(i,c,d,l)}switch(s){case"input":Bv(i,o);break;case"textarea":EO(i,o);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?l0(i,!!o.multiple,f,!1):m!==!!o.multiple&&(o.defaultValue!=null?l0(i,!!o.multiple,o.defaultValue,!0):l0(i,!!o.multiple,o.multiple?[]:"",!1))}i[fm]=o}catch(p){Gr(t,t.return,p)}}break;case 6:if(Ja(e,t),Hs(t),r&4){if(t.stateNode===null)throw Error(vt(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(p){Gr(t,t.return,p)}}break;case 3:if(Ja(e,t),Hs(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{um(e.containerInfo)}catch(p){Gr(t,t.return,p)}break;case 4:Ja(e,t),Hs(t);break;case 13:Ja(e,t),Hs(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(AS=ri())),r&4&&CR(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Ji=(l=Ji)||c,Ja(e,t),Ji=l):Ja(e,t),Hs(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!c&&t.mode&1)for(Ut=t,c=t.child;c!==null;){for(d=Ut=c;Ut!==null;){switch(m=Ut,f=m.child,m.tag){case 0:case 11:case 14:case 15:x6(4,m,m.return);break;case 1:K2(m,m.return);var h=m.stateNode;if(typeof h.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(p){Gr(r,n,p)}}break;case 5:K2(m,m.return);break;case 22:if(m.memoizedState!==null){ER(d);continue}}f!==null?(f.return=m,Ut=f):ER(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,l?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=RO("display",a))}catch(p){Gr(t,t.return,p)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(p){Gr(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ja(e,t),Hs(t),r&4&&CR(t);break;case 21:break;default:Ja(e,t),Hs(t)}}function Hs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(QP(n)){var r=n;break e}n=n.return}throw Error(vt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(im(i,""),r.flags&=-33);var o=_R(t);Cb(t,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,s=_R(t);_b(t,s,a);break;default:throw Error(vt(161))}}catch(u){Gr(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Zq(t,e,n){Ut=t,tM(t)}function tM(t,e,n){for(var r=(t.mode&1)!==0;Ut!==null;){var i=Ut,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||g3;if(!a){var s=i.alternate,u=s!==null&&s.memoizedState!==null||Ji;s=g3;var l=Ji;if(g3=a,(Ji=u)&&!l)for(Ut=i;Ut!==null;)a=Ut,u=a.child,a.tag===22&&a.memoizedState!==null?yR(i):u!==null?(u.return=a,Ut=u):yR(i);for(;o!==null;)Ut=o,tM(o),o=o.sibling;Ut=i,g3=s,Ji=l}SR(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ut=o):SR(t)}}function SR(t){for(;Ut!==null;){var e=Ut;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ji||g5(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ji)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ls(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&iR(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}iR(e,a,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&um(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(vt(163))}Ji||e.flags&512&&bb(e)}catch(m){Gr(e,e.return,m)}}if(e===t){Ut=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ut=n;break}Ut=e.return}}function ER(t){for(;Ut!==null;){var e=Ut;if(e===t){Ut=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ut=n;break}Ut=e.return}}function yR(t){for(;Ut!==null;){var e=Ut;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{g5(4,e)}catch(u){Gr(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){Gr(e,i,u)}}var o=e.return;try{bb(e)}catch(u){Gr(e,o,u)}break;case 5:var a=e.return;try{bb(e)}catch(u){Gr(e,a,u)}}}catch(u){Gr(e,e.return,u)}if(e===t){Ut=null;break}var s=e.sibling;if(s!==null){s.return=e.return,Ut=s;break}Ut=e.return}}var Qq=Math.ceil,Gh=au.ReactCurrentDispatcher,RS=au.ReactCurrentOwner,za=au.ReactCurrentBatchConfig,ir=0,Ri=null,ui=null,Bi=0,aa=0,Z2=Rl(0),vi=0,_m=null,Rc=0,v5=0,IS=0,F6=null,ko=null,AS=0,L0=1/0,x1=null,Kh=!1,Sb=null,qu=null,v3=!1,xu=null,Zh=0,$6=0,Eb=null,A4=-1,T4=0;function bo(){return ir&6?ri():A4!==-1?A4:A4=ri()}function Gu(t){return t.mode&1?ir&2&&Bi!==0?Bi&-Bi:xq.transition!==null?(T4===0&&(T4=kO()),T4):(t=br,t!==0||(t=window.event,t=t===void 0?16:WO(t.type)),t):1}function ys(t,e,n,r){if(50<$6)throw $6=0,Eb=null,Error(vt(185));Zm(t,n,r),(!(ir&2)||t!==Ri)&&(t===Ri&&(!(ir&2)&&(v5|=n),vi===4&&Mu(t,Bi)),jo(t,r),n===1&&ir===0&&!(e.mode&1)&&(L0=ri()+500,f5&&Il()))}function jo(t,e){var n=t.callbackNode;xX(t,e);var r=Nh(t,t===Ri?Bi:0);if(r===0)n!==null&&PD(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&PD(n),e===1)t.tag===0?Nq(DR.bind(null,t)):cP(DR.bind(null,t)),Lq(function(){!(ir&6)&&Il()}),n=null;else{switch(BO(r)){case 1:n=JC;break;case 4:n=FO;break;case 16:n=Mh;break;case 536870912:n=$O;break;default:n=Mh}n=lM(n,nM.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function nM(t,e){if(A4=-1,T4=0,ir&6)throw Error(vt(327));var n=t.callbackNode;if(h0()&&t.callbackNode!==n)return null;var r=Nh(t,t===Ri?Bi:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Qh(t,r);else{e=r;var i=ir;ir|=2;var o=iM();(Ri!==t||Bi!==e)&&(x1=null,L0=ri()+500,mc(t,e));do try{tG();break}catch(s){rM(t,s)}while(1);mS(),Gh.current=o,ir=i,ui!==null?e=0:(Ri=null,Bi=0,e=vi)}if(e!==0){if(e===2&&(i=Gv(t),i!==0&&(r=i,e=yb(t,i))),e===1)throw n=_m,mc(t,0),Mu(t,r),jo(t,ri()),n;if(e===6)Mu(t,r);else{if(i=t.current.alternate,!(r&30)&&!Jq(i)&&(e=Qh(t,r),e===2&&(o=Gv(t),o!==0&&(r=o,e=yb(t,o))),e===1))throw n=_m,mc(t,0),Mu(t,r),jo(t,ri()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(vt(345));case 2:Xl(t,ko,x1);break;case 3:if(Mu(t,r),(r&130023424)===r&&(e=AS+500-ri(),10<e)){if(Nh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){bo(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=rb(Xl.bind(null,t,ko,x1),e);break}Xl(t,ko,x1);break;case 4:if(Mu(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Es(r);o=1<<a,a=e[a],a>i&&(i=a),r&=~o}if(r=i,r=ri()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Qq(r/1960))-r,10<r){t.timeoutHandle=rb(Xl.bind(null,t,ko,x1),r);break}Xl(t,ko,x1);break;case 5:Xl(t,ko,x1);break;default:throw Error(vt(329))}}}return jo(t,ri()),t.callbackNode===n?nM.bind(null,t):null}function yb(t,e){var n=F6;return t.current.memoizedState.isDehydrated&&(mc(t,e).flags|=256),t=Qh(t,e),t!==2&&(e=ko,ko=n,e!==null&&Db(e)),t}function Db(t){ko===null?ko=t:ko.push.apply(ko,t)}function Jq(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Ls(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Mu(t,e){for(e&=~IS,e&=~v5,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Es(e),r=1<<n;t[n]=-1,e&=~r}}function DR(t){if(ir&6)throw Error(vt(327));h0();var e=Nh(t,0);if(!(e&1))return jo(t,ri()),null;var n=Qh(t,e);if(t.tag!==0&&n===2){var r=Gv(t);r!==0&&(e=r,n=yb(t,r))}if(n===1)throw n=_m,mc(t,0),Mu(t,e),jo(t,ri()),n;if(n===6)throw Error(vt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xl(t,ko,x1),jo(t,ri()),null}function TS(t,e){var n=ir;ir|=1;try{return t(e)}finally{ir=n,ir===0&&(L0=ri()+500,f5&&Il())}}function Ic(t){xu!==null&&xu.tag===0&&!(ir&6)&&h0();var e=ir;ir|=1;var n=za.transition,r=br;try{if(za.transition=null,br=1,t)return t()}finally{br=r,za.transition=n,ir=e,!(ir&6)&&Il()}}function wS(){aa=Z2.current,$r(Z2)}function mc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,wq(n)),ui!==null)for(n=ui.return;n!==null;){var r=n;switch(lS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Bh();break;case 3:T0(),$r(Vo),$r(ao),bS();break;case 5:vS(r);break;case 4:T0();break;case 13:$r(zr);break;case 19:$r(zr);break;case 10:fS(r.type._context);break;case 22:case 23:wS()}n=n.return}if(Ri=t,ui=t=Ku(t.current,null),Bi=aa=e,vi=0,_m=null,IS=v5=Rc=0,ko=F6=null,oc!==null){for(e=0;e<oc.length;e++)if(n=oc[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}oc=null}return t}function rM(t,e){do{var n=ui;try{if(mS(),D4.current=qh,Xh){for(var r=Yr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xh=!1}if(Dc=0,Di=hi=Yr=null,N6=!1,gm=0,RS.current=null,n===null||n.return===null){vi=1,_m=e,ui=null;break}e:{var o=t,a=n.return,s=n,u=e;if(e=Bi,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var m=c.alternate;m?(c.updateQueue=m.updateQueue,c.memoizedState=m.memoizedState,c.lanes=m.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=dR(a);if(f!==null){f.flags&=-257,mR(f,a,s,o,e),f.mode&1&&cR(o,l,e),e=f,u=l;var h=e.updateQueue;if(h===null){var p=new Set;p.add(u),e.updateQueue=p}else h.add(u);break e}else{if(!(e&1)){cR(o,l,e),LS();break e}u=Error(vt(426))}}else if(Ur&&s.mode&1){var v=dR(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),mR(v,a,s,o,e),cS(w0(u,s));break e}}o=u=w0(u,s),vi!==4&&(vi=2),F6===null?F6=[o]:F6.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=UP(o,u,e);rR(o,g);break e;case 1:s=u;var b=o.type,C=o.stateNode;if(!(o.flags&128)&&(typeof b.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(qu===null||!qu.has(C)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=VP(o,s,e);rR(o,S);break e}}o=o.return}while(o!==null)}aM(n)}catch(E){e=E,ui===n&&n!==null&&(ui=n=n.return);continue}break}while(1)}function iM(){var t=Gh.current;return Gh.current=qh,t===null?qh:t}function LS(){(vi===0||vi===3||vi===2)&&(vi=4),Ri===null||!(Rc&268435455)&&!(v5&268435455)||Mu(Ri,Bi)}function Qh(t,e){var n=ir;ir|=2;var r=iM();(Ri!==t||Bi!==e)&&(x1=null,mc(t,e));do try{eG();break}catch(i){rM(t,i)}while(1);if(mS(),ir=n,Gh.current=r,ui!==null)throw Error(vt(261));return Ri=null,Bi=0,vi}function eG(){for(;ui!==null;)oM(ui)}function tG(){for(;ui!==null&&!IX();)oM(ui)}function oM(t){var e=uM(t.alternate,t,aa);t.memoizedProps=t.pendingProps,e===null?aM(t):ui=e,RS.current=null}function aM(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=qq(n,e),n!==null){n.flags&=32767,ui=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vi=6,ui=null;return}}else if(n=Xq(n,e,aa),n!==null){ui=n;return}if(e=e.sibling,e!==null){ui=e;return}ui=e=t}while(e!==null);vi===0&&(vi=5)}function Xl(t,e,n){var r=br,i=za.transition;try{za.transition=null,br=1,nG(t,e,n,r)}finally{za.transition=i,br=r}return null}function nG(t,e,n,r){do h0();while(xu!==null);if(ir&6)throw Error(vt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(vt(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(FX(t,o),t===Ri&&(ui=Ri=null,Bi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||v3||(v3=!0,lM(Mh,function(){return h0(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=za.transition,za.transition=null;var a=br;br=1;var s=ir;ir|=4,RS.current=null,Kq(t,n),eM(n,t),Eq(tb),xh=!!eb,tb=eb=null,t.current=n,Zq(n),AX(),ir=s,br=a,za.transition=o}else t.current=n;if(v3&&(v3=!1,xu=t,Zh=i),o=t.pendingLanes,o===0&&(qu=null),LX(n.stateNode),jo(t,ri()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Kh)throw Kh=!1,t=Sb,Sb=null,t;return Zh&1&&t.tag!==0&&h0(),o=t.pendingLanes,o&1?t===Eb?$6++:($6=0,Eb=t):$6=0,Il(),null}function h0(){if(xu!==null){var t=BO(Zh),e=za.transition,n=br;try{if(za.transition=null,br=16>t?16:t,xu===null)var r=!1;else{if(t=xu,xu=null,Zh=0,ir&6)throw Error(vt(331));var i=ir;for(ir|=4,Ut=t.current;Ut!==null;){var o=Ut,a=o.child;if(Ut.flags&16){var s=o.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(Ut=l;Ut!==null;){var c=Ut;switch(c.tag){case 0:case 11:case 15:x6(8,c,o)}var d=c.child;if(d!==null)d.return=c,Ut=d;else for(;Ut!==null;){c=Ut;var m=c.sibling,f=c.return;if(ZP(c),c===l){Ut=null;break}if(m!==null){m.return=f,Ut=m;break}Ut=f}}}var h=o.alternate;if(h!==null){var p=h.child;if(p!==null){h.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}Ut=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,Ut=a;else e:for(;Ut!==null;){if(o=Ut,o.flags&2048)switch(o.tag){case 0:case 11:case 15:x6(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,Ut=g;break e}Ut=o.return}}var b=t.current;for(Ut=b;Ut!==null;){a=Ut;var C=a.child;if(a.subtreeFlags&2064&&C!==null)C.return=a,Ut=C;else e:for(a=b;Ut!==null;){if(s=Ut,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:g5(9,s)}}catch(E){Gr(s,s.return,E)}if(s===a){Ut=null;break e}var S=s.sibling;if(S!==null){S.return=s.return,Ut=S;break e}Ut=s.return}}if(ir=i,Il(),a1&&typeof a1.onPostCommitFiberRoot=="function")try{a1.onPostCommitFiberRoot(u5,t)}catch{}r=!0}return r}finally{br=n,za.transition=e}}return!1}function RR(t,e,n){e=w0(n,e),e=UP(t,e,1),t=Xu(t,e,1),e=bo(),t!==null&&(Zm(t,1,e),jo(t,e))}function Gr(t,e,n){if(t.tag===3)RR(t,t,n);else for(;e!==null;){if(e.tag===3){RR(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qu===null||!qu.has(r))){t=w0(n,t),t=VP(e,t,1),e=Xu(e,t,1),t=bo(),e!==null&&(Zm(e,1,t),jo(e,t));break}}e=e.return}}function rG(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=bo(),t.pingedLanes|=t.suspendedLanes&n,Ri===t&&(Bi&n)===n&&(vi===4||vi===3&&(Bi&130023424)===Bi&&500>ri()-AS?mc(t,0):IS|=n),jo(t,e)}function sM(t,e){e===0&&(t.mode&1?(e=s3,s3<<=1,!(s3&130023424)&&(s3=4194304)):e=1);var n=bo();t=Q1(t,e),t!==null&&(Zm(t,e,n),jo(t,n))}function iG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),sM(t,n)}function oG(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(vt(314))}r!==null&&r.delete(e),sM(t,n)}var uM;uM=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vo.current)Bo=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Bo=!1,Yq(t,e,n);Bo=!!(t.flags&131072)}else Bo=!1,Ur&&e.flags&1048576&&dP(e,Hh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;I4(t,e),t=e.pendingProps;var i=R0(e,ao.current);f0(e,n),i=CS(null,e,r,t,i,n);var o=SS();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ho(r)?(o=!0,Uh(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,pS(e),i.updater=h5,e.stateNode=i,i._reactInternals=e,cb(e,r,t,n),e=fb(null,e,r,!0,o,n)):(e.tag=0,Ur&&o&&uS(e),fo(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(I4(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=sG(r),t=ls(r,t),i){case 0:e=mb(null,e,r,t,n);break e;case 1:e=pR(null,e,r,t,n);break e;case 11:e=fR(null,e,r,t,n);break e;case 14:e=hR(null,e,r,ls(r.type,t),n);break e}throw Error(vt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ls(r,i),mb(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ls(r,i),pR(t,e,r,i,n);case 3:e:{if(WP(e),t===null)throw Error(vt(387));r=e.pendingProps,o=e.memoizedState,i=o.element,pP(t,e),Wh(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=w0(Error(vt(423)),e),e=gR(t,e,r,n,i);break e}else if(r!==i){i=w0(Error(vt(424)),e),e=gR(t,e,r,n,i);break e}else for(ua=Yu(e.stateNode.containerInfo.firstChild),ma=e,Ur=!0,fs=null,n=_P(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(I0(),r===i){e=J1(t,e,n);break e}fo(t,e,r,n)}e=e.child}return e;case 5:return CP(e),t===null&&sb(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,a=i.children,nb(r,i)?a=null:o!==null&&nb(r,o)&&(e.flags|=32),zP(t,e),fo(t,e,a,n),e.child;case 6:return t===null&&sb(e),null;case 13:return YP(t,e,n);case 4:return gS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=A0(e,null,r,n):fo(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ls(r,i),fR(t,e,r,i,n);case 7:return fo(t,e,e.pendingProps,n),e.child;case 8:return fo(t,e,e.pendingProps.children,n),e.child;case 12:return fo(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value,Lr(jh,r._currentValue),r._currentValue=a,o!==null)if(Ls(o.value,a)){if(o.children===i.children&&!Vo.current){e=J1(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=Y1(-1,n&-n),u.tag=2;var l=o.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),ub(o.return,n,e),s.lanes|=n;break}u=u.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(vt(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),ub(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}fo(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,f0(e,n),i=Ya(i),r=r(i),e.flags|=1,fo(t,e,r,n),e.child;case 14:return r=e.type,i=ls(r,e.pendingProps),i=ls(r.type,i),hR(t,e,r,i,n);case 15:return HP(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ls(r,i),I4(t,e),e.tag=1,Ho(r)?(t=!0,Uh(e)):t=!1,f0(e,n),vP(e,r,i),cb(e,r,i,n),fb(null,e,r,!0,t,n);case 19:return XP(t,e,n);case 22:return jP(t,e,n)}throw Error(vt(156,e.tag))};function lM(t,e){return xO(t,e)}function aG(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ba(t,e,n,r){return new aG(t,e,n,r)}function OS(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sG(t){if(typeof t=="function")return OS(t)?1:0;if(t!=null){if(t=t.$$typeof,t===KC)return 11;if(t===ZC)return 14}return 2}function Ku(t,e){var n=t.alternate;return n===null?(n=Ba(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function w4(t,e,n,r,i,o){var a=2;if(r=t,typeof t=="function")OS(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case V2:return fc(n.children,i,o,e);case GC:a=8,i|=8;break;case Nv:return t=Ba(12,n,e,i|2),t.elementType=Nv,t.lanes=o,t;case xv:return t=Ba(13,n,e,i),t.elementType=xv,t.lanes=o,t;case Fv:return t=Ba(19,n,e,i),t.elementType=Fv,t.lanes=o,t;case bO:return b5(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gO:a=10;break e;case vO:a=9;break e;case KC:a=11;break e;case ZC:a=14;break e;case wu:a=16,r=null;break e}throw Error(vt(130,t==null?t:typeof t,""))}return e=Ba(a,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function fc(t,e,n,r){return t=Ba(7,t,r,e),t.lanes=n,t}function b5(t,e,n,r){return t=Ba(22,t,r,e),t.elementType=bO,t.lanes=n,t.stateNode={isHidden:!1},t}function Hp(t,e,n){return t=Ba(6,t,null,e),t.lanes=n,t}function jp(t,e,n){return e=Ba(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uG(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yp(0),this.expirationTimes=yp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function PS(t,e,n,r,i,o,a,s,u){return t=new uG(t,e,n,s,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ba(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},pS(o),t}function lG(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U2,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function cM(t){if(!t)return il;t=t._reactInternals;e:{if(jc(t)!==t||t.tag!==1)throw Error(vt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ho(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(vt(171))}if(t.tag===1){var n=t.type;if(Ho(n))return lP(t,n,e)}return e}function dM(t,e,n,r,i,o,a,s,u){return t=PS(n,r,!0,t,i,o,a,s,u),t.context=cM(null),n=t.current,r=bo(),i=Gu(n),o=Y1(r,i),o.callback=e??null,Xu(n,o,i),t.current.lanes=i,Zm(t,i,r),jo(t,r),t}function _5(t,e,n,r){var i=e.current,o=bo(),a=Gu(i);return n=cM(n),e.context===null?e.context=n:e.pendingContext=n,e=Y1(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xu(i,e,a),t!==null&&(ys(t,i,a,o),y4(t,i,a)),a}function Jh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function IR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function MS(t,e){IR(t,e),(t=t.alternate)&&IR(t,e)}function cG(){return null}var mM=typeof reportError=="function"?reportError:function(t){console.error(t)};function NS(t){this._internalRoot=t}C5.prototype.render=NS.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(vt(409));_5(t,e,null,null)};C5.prototype.unmount=NS.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ic(function(){_5(null,t,null,null)}),e[Z1]=null}};function C5(t){this._internalRoot=t}C5.prototype.unstable_scheduleHydration=function(t){if(t){var e=HO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Pu.length&&e!==0&&e<Pu[n].priority;n++);Pu.splice(n,0,t),n===0&&zO(t)}};function xS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function S5(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function AR(){}function dG(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var l=Jh(a);o.call(l)}}var a=dM(e,r,t,0,null,!1,!1,"",AR);return t._reactRootContainer=a,t[Z1]=a.current,dm(t.nodeType===8?t.parentNode:t),Ic(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var l=Jh(u);s.call(l)}}var u=PS(t,0,!1,null,null,!1,!1,"",AR);return t._reactRootContainer=u,t[Z1]=u.current,dm(t.nodeType===8?t.parentNode:t),Ic(function(){_5(e,u,n,r)}),u}function E5(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var s=i;i=function(){var u=Jh(a);s.call(u)}}_5(e,a,t,i)}else a=dG(n,e,t,i,r);return Jh(a)}UO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=m6(e.pendingLanes);n!==0&&(eS(e,n|1),jo(e,ri()),!(ir&6)&&(L0=ri()+500,Il()))}break;case 13:Ic(function(){var r=Q1(t,1);if(r!==null){var i=bo();ys(r,t,1,i)}}),MS(t,1)}};tS=function(t){if(t.tag===13){var e=Q1(t,134217728);if(e!==null){var n=bo();ys(e,t,134217728,n)}MS(t,134217728)}};VO=function(t){if(t.tag===13){var e=Gu(t),n=Q1(t,e);if(n!==null){var r=bo();ys(n,t,e,r)}MS(t,e)}};HO=function(){return br};jO=function(t,e){var n=br;try{return br=t,e()}finally{br=n}};Yv=function(t,e,n){switch(e){case"input":if(Bv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=m5(r);if(!i)throw Error(vt(90));CO(r),Bv(r,i)}}}break;case"textarea":EO(t,n);break;case"select":e=n.value,e!=null&&l0(t,!!n.multiple,e,!1)}};wO=TS;LO=Ic;var mG={usingClientEntryPoint:!1,Events:[Jm,W2,m5,AO,TO,TS]},Nd={findFiberByHostInstance:ic,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},fG={bundleType:Nd.bundleType,version:Nd.version,rendererPackageName:Nd.rendererPackageName,rendererConfig:Nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:au.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=MO(t),t===null?null:t.stateNode},findFiberByHostInstance:Nd.findFiberByHostInstance||cG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var b3=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!b3.isDisabled&&b3.supportsFiber)try{u5=b3.inject(fG),a1=b3}catch{}}va.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mG;va.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xS(e))throw Error(vt(200));return lG(t,e,null,n)};va.createRoot=function(t,e){if(!xS(t))throw Error(vt(299));var n=!1,r="",i=mM;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=PS(t,1,!1,null,null,n,!1,r,i),t[Z1]=e.current,dm(t.nodeType===8?t.parentNode:t),new NS(e)};va.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(vt(188)):(t=Object.keys(t).join(","),Error(vt(268,t)));return t=MO(e),t=t===null?null:t.stateNode,t};va.flushSync=function(t){return Ic(t)};va.hydrate=function(t,e,n){if(!S5(e))throw Error(vt(200));return E5(null,t,e,!0,n)};va.hydrateRoot=function(t,e,n){if(!xS(t))throw Error(vt(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=mM;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=dM(e,null,t,1,n??null,i,!1,o,a),t[Z1]=e.current,dm(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new C5(e)};va.render=function(t,e,n){if(!S5(e))throw Error(vt(200));return E5(null,t,e,!1,n)};va.unmountComponentAtNode=function(t){if(!S5(t))throw Error(vt(40));return t._reactRootContainer?(Ic(function(){E5(null,null,t,!1,function(){t._reactRootContainer=null,t[Z1]=null})}),!0):!1};va.unstable_batchedUpdates=TS;va.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!S5(n))throw Error(vt(200));if(t==null||t._reactInternals===void 0)throw Error(vt(38));return E5(t,e,n,!1,r)};va.version="18.2.0-next-9e3b772b8-20220608";function fM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fM)}catch(t){console.error(t)}}fM(),dO.exports=va;var Ac=dO.exports;const o1=tO(Ac);var hG=Object.defineProperty,pG=(t,e,n)=>e in t?hG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,e9=(t,e,n)=>(pG(t,typeof e!="symbol"?e+"":e,n),n);const gG="univer-button",vG="univer-button-default",bG="univer-button-primary",_G="univer-button-text",CG="univer-button-link",SG="univer-button-small",EG="univer-button-middle",yG="univer-button-large",DG="univer-button-block",A1={button:gG,buttonDefault:vG,buttonPrimary:bG,buttonText:_G,buttonLink:CG,buttonSmall:SG,buttonMiddle:EG,buttonLarge:yG,buttonBlock:DG};function X1(t){const{children:e,className:n,style:r,type:i="default",size:o="middle",block:a,htmlType:s,disabled:u=!1,onClick:l,...c}=t,d=Ci(A1.button,{[A1.buttonPrimary]:i==="primary",[A1.buttonDefault]:i==="default",[A1.buttonText]:i==="text",[A1.buttonLink]:i==="link",[A1.buttonSmall]:o==="small",[A1.buttonMiddle]:o==="middle",[A1.buttonLarge]:o==="large",[A1.buttonBlock]:a},n);return Se.createElement("button",{className:d,style:r,type:s,onClick:l,disabled:u,...c},e)}var Ma=function(){return Ma=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Ma.apply(this,arguments)},RG=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},Ka=_.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,a=RG(t,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),u=_.useRef("_".concat(TG()));return hM(n,"".concat(r),{defIds:n.defIds,idSuffix:u.current},Ma({ref:e,className:s},a),o)});function hM(t,e,n,r,i){return _.createElement(t.tag,Ma(Ma({key:e},IG(t,n,i)),r),(AG(t,n).children||[]).map(function(o,a){return hM(o,"".concat(e,"-").concat(t.tag,"-").concat(a),n,void 0,i)}))}function IG(t,e,n){var r=Ma({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var a=o[0],s=o[1];typeof s=="string"&&(r[a]=s.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function AG(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?Ma(Ma({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?Ma(Ma({},i),{attrs:Ma(Ma({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function TG(){return Math.random().toString(36).substring(2,8)}Ka.displayName="UniverIcon";var wG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.44 3.57291C14.698 3.83093 14.698 4.24927 14.44 4.50729L6.44342 12.5037C6.28721 12.6599 6.03395 12.6599 5.87774 12.5037L1.55992 8.18578C1.3019 7.92776 1.3019 7.50942 1.55993 7.2514C1.81795 6.99338 2.23629 6.99338 2.49431 7.25141L6.01916 10.7763C6.09727 10.8544 6.2239 10.8544 6.30201 10.7763L13.5056 3.57291C13.7636 3.31489 14.1819 3.31489 14.44 3.57291Z",fillRule:"evenodd",clipRule:"evenodd"}}]},pM=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"check-mark-single",ref:e,icon:wG}))});pM.displayName="CheckMarkSingle";const LG=pM;var OG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.57061 3.65132C4.31677 3.39748 3.90521 3.39748 3.65137 3.65132C3.39753 3.90516 3.39753 4.31672 3.65137 4.57056L7.08079 7.99998L3.65123 11.4295C3.39739 11.6834 3.39739 12.0949 3.65123 12.3488C3.90507 12.6026 4.31662 12.6026 4.57047 12.3488L8.00003 8.91921L11.4295 12.3487C11.6834 12.6026 12.0949 12.6026 12.3488 12.3487C12.6026 12.0949 12.6026 11.6833 12.3488 11.4295L8.91927 7.99998L12.3486 4.57061C12.6025 4.31677 12.6025 3.90521 12.3486 3.65137C12.0948 3.39753 11.6832 3.39753 11.4294 3.65137L8.00003 7.08074L4.57061 3.65132Z"}}]},gM=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"close-single",ref:e,icon:OG}))});gM.displayName="CloseSingle";const vM=gM;var PG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_371_77",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_371_77)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.85869 12.9216C8.38445 13.4708 7.61555 13.4708 7.14131 12.9216L0.358114 5.06726C-0.406895 4.18144 0.134916 2.66683 1.2168 2.66683L14.7832 2.66683C15.8651 2.66683 16.4069 4.18144 15.6419 5.06726L8.85869 12.9216Z"}}]}]},MG=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"dropdown-single",ref:e,icon:PG}))});MG.displayName="DropdownSingle";var NG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0 0H16V16H0z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.09973 1.50049C4.51022 1.50049 1.59973 4.41098 1.59973 8.00049C1.59973 11.59 4.51022 14.5005 8.09973 14.5005C11.6892 14.5005 14.5997 11.59 14.5997 8.00049C14.5997 4.41098 11.6892 1.50049 8.09973 1.50049ZM10.4995 10.4701L9.5419 10.4657L8.09971 8.74643L6.65897 10.4643L5.69993 10.4686C5.63609 10.4686 5.58386 10.4179 5.58386 10.3526C5.58386 10.325 5.59402 10.2989 5.61143 10.2771L7.49904 8.02824L5.61143 5.7808C5.59402 5.75904 5.58386 5.73292 5.58386 5.70536C5.58386 5.64152 5.63609 5.58929 5.69993 5.58929L6.65897 5.59364L8.09971 7.31295L9.54045 5.59509L10.498 5.59074C10.5619 5.59074 10.6141 5.64152 10.6141 5.70681C10.6141 5.73438 10.604 5.76049 10.5865 5.78225L8.70183 8.02969L10.588 10.2786C10.6054 10.3003 10.6156 10.3265 10.6156 10.354C10.6156 10.4179 10.5633 10.4701 10.4995 10.4701Z",fillRule:"evenodd",clipRule:"evenodd"}}]},bM=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"error-single",ref:e,icon:NG}))});bM.displayName="ErrorSingle";const xG=bM;var FG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_249",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_249)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.74717 2.0944C8.74717 1.68671 8.41279 1.3562 8.00032 1.3562C7.58785 1.3562 7.25347 1.68671 7.25347 2.0944V7.26186H2.02541C1.61294 7.26186 1.27856 7.59237 1.27856 8.00007C1.27856 8.40777 1.61294 8.73827 2.02541 8.73827H7.25347V13.9057C7.25347 14.3134 7.58785 14.6439 8.00032 14.6439C8.41279 14.6439 8.74717 14.3134 8.74717 13.9057V8.73827H13.975C14.3874 8.73827 14.7218 8.40777 14.7218 8.00007C14.7218 7.59237 14.3874 7.26186 13.975 7.26186H8.74717V2.0944Z"}}]}]},_M=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"increase-single",ref:e,icon:FG}))});_M.displayName="IncreaseSingle";const $G=_M;var kG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.629584 3.99986C1.13729 3.4922 1.9604 3.49224 2.46806 3.99995L7.57569 9.10806C7.81 9.3424 8.18992 9.3424 8.42424 9.10808L13.5323 3.99998C14.04 3.4923 14.8631 3.4923 15.3708 3.99998C15.8785 4.50766 15.8785 5.33078 15.3708 5.83846L9.41415 11.7951C8.63307 12.5762 7.36669 12.5762 6.58565 11.7951L0.629497 5.83834C0.121839 5.33063 0.121879 4.50752 0.629584 3.99986Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},CM=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"more-down-single",ref:e,icon:kG}))});CM.displayName="MoreDownSingle";const BG=CM;var UG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_506_8",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M16 0H32V16H16z",transform:"rotate(90 16 0)"}}]},{tag:"g",attrs:{mask:"url(#mask0_506_8)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.0001 0.629584C12.5078 1.13729 12.5078 1.9604 12.0001 2.46806L6.89194 7.57569C6.6576 7.81 6.65759 8.18992 6.89192 8.42424L12 13.5323C12.5077 14.04 12.5077 14.8631 12 15.3708C11.4923 15.8785 10.6692 15.8785 10.1615 15.3708L4.20487 9.41415C3.4238 8.63307 3.42383 7.36669 4.20494 6.58565L10.1617 0.629496C10.6694 0.121839 11.4925 0.121879 12.0001 0.629584Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},VG=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"more-left-single",ref:e,icon:UG}))});VG.displayName="MoreLeftSingle";var HG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_506_11",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 16H16V32H0z",transform:"rotate(-90 0 16)"}}]},{tag:"g",attrs:{mask:"url(#mask0_506_11)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.99986 15.3704C3.4922 14.8627 3.49224 14.0396 3.99995 13.5319L9.10806 8.42431C9.3424 8.19 9.3424 7.81008 9.10808 7.57576L3.99998 2.46766C3.4923 1.95998 3.4923 1.13687 3.99998 0.629185C4.50766 0.121504 5.33078 0.121504 5.83846 0.629185L11.7951 6.58585C12.5762 7.36693 12.5762 8.63331 11.7951 9.41435L5.83834 15.3705C5.33063 15.8782 4.50752 15.8781 3.99986 15.3704Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},jG=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"more-right-single",ref:e,icon:HG}))});jG.displayName="MoreRightSingle";var zG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_252",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_252)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.27832 7.99992C1.27832 7.59222 1.61269 7.26172 2.02517 7.26172H13.9747C14.3872 7.26172 14.7216 7.59222 14.7216 7.99992C14.7216 8.40762 14.3872 8.73813 13.9747 8.73813H2.02517C1.61269 8.73813 1.27832 8.40762 1.27832 7.99992Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},SM=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"reduce-single",ref:e,icon:zG}))});SM.displayName="ReduceSingle";const WG=SM;var YG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0 0H16V16H0z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.00061 1.60059C4.4111 1.60059 1.50061 4.51108 1.50061 8.10059C1.50061 11.6901 4.4111 14.6006 8.00061 14.6006C11.5901 14.6006 14.5006 11.6901 14.5006 8.10059C14.5006 4.51108 11.5901 1.60059 8.00061 1.60059ZM10.8082 5.97793L7.75259 10.2145C7.56832 10.4713 7.18674 10.4713 7.00248 10.2145L5.19321 7.70739C5.13808 7.6305 5.19321 7.52313 5.28752 7.52313H5.96799C6.11598 7.52313 6.25672 7.59422 6.34377 7.7161L7.37681 9.14958L9.65761 5.98664C9.74466 5.86621 9.88395 5.79367 10.0334 5.79367H10.7139C10.8082 5.79367 10.8633 5.90103 10.8082 5.97793Z",fillRule:"evenodd",clipRule:"evenodd"}}]},EM=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"success-single",ref:e,icon:YG}))});EM.displayName="SuccessSingle";const XG=EM;var qG={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.40051 8.00049C1.40051 4.41098 4.311 1.50049 7.90051 1.50049C11.49 1.50049 14.4005 4.41098 14.4005 8.00049C14.4005 11.59 11.49 14.5005 7.90051 14.5005C4.311 14.5005 1.40051 11.59 1.40051 8.00049ZM7.31368 5.3379L7.56087 9.33424H8.24066L8.49816 5.3379L8.51876 4.12252H7.28278L7.31368 5.3379ZM7.07678 11.0646C7.07678 11.5693 7.44758 11.8783 7.90077 11.8783C8.35396 11.8783 8.72476 11.5693 8.72476 11.0646C8.72476 10.5805 8.35396 10.2612 7.90077 10.2612C7.44758 10.2612 7.07678 10.5805 7.07678 11.0646Z",fillRule:"evenodd",clipRule:"evenodd"}}]},yM=_.forwardRef(function(t,e){return _.createElement(Ka,Object.assign({},t,{id:"warning-single",ref:e,icon:qG}))});yM.displayName="WarningSingle";const GG=yM;function Qt(){return Qt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qt.apply(this,arguments)}function Pr(t){"@babel/helpers - typeof";return Pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pr(t)}function KG(t,e){if(Pr(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Pr(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DM(t){var e=KG(t,"string");return Pr(e)=="symbol"?e:String(e)}function ut(t,e,n){return e=DM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RM(t){if(Array.isArray(t))return t}function ZG(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}function Rb(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function FS(t,e){if(t){if(typeof t=="string")return Rb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rb(t,e)}}function IM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qe(t,e){return RM(t)||ZG(t,e)||FS(t,e)||IM()}function TR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function $e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?TR(Object(n),!0).forEach(function(r){ut(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TR(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Al(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,DM(r.key),r)}}function Tl(t,e,n){return e&&wR(t.prototype,e),n&&wR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function t9(t,e){return t9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},t9(t,e)}function tf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&t9(t,e)}function n9(t){return n9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n9(t)}function AM(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AM=function(){return!!t})()}function r9(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QG(t,e){if(e&&(Pr(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r9(t)}function nf(t){var e=AM();return function(){var n=n9(t),r;if(e){var i=n9(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return QG(this,r)}}function y5(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Qn(t,e){if(t==null)return{};var n=y5(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Ui(t,e){JG(t)&&(t="100%");var n=eK(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function _3(t){return Math.min(1,Math.max(0,t))}function JG(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function eK(t){return typeof t=="string"&&t.indexOf("%")!==-1}function TM(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function C3(t){return t<=1?"".concat(Number(t)*100,"%"):t}function sc(t){return t.length===1?"0"+t:String(t)}function tK(t,e,n){return{r:Ui(t,255)*255,g:Ui(e,255)*255,b:Ui(n,255)*255}}function LR(t,e,n){t=Ui(t,255),e=Ui(e,255),n=Ui(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),o=0,a=0,s=(r+i)/2;if(r===i)a=0,o=0;else{var u=r-i;switch(a=s>.5?u/(2-r-i):u/(r+i),r){case t:o=(e-n)/u+(e<n?6:0);break;case e:o=(n-t)/u+2;break;case n:o=(t-e)/u+4;break}o/=6}return{h:o,s:a,l:s}}function zp(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function nK(t,e,n){var r,i,o;if(t=Ui(t,360),e=Ui(e,100),n=Ui(n,100),e===0)i=n,o=n,r=n;else{var a=n<.5?n*(1+e):n+e-n*e,s=2*n-a;r=zp(s,a,t+1/3),i=zp(s,a,t),o=zp(s,a,t-1/3)}return{r:r*255,g:i*255,b:o*255}}function OR(t,e,n){t=Ui(t,255),e=Ui(e,255),n=Ui(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),o=0,a=r,s=r-i,u=r===0?0:s/r;if(r===i)o=0;else{switch(r){case t:o=(e-n)/s+(e<n?6:0);break;case e:o=(n-t)/s+2;break;case n:o=(t-e)/s+4;break}o/=6}return{h:o,s:u,v:a}}function rK(t,e,n){t=Ui(t,360)*6,e=Ui(e,100),n=Ui(n,100);var r=Math.floor(t),i=t-r,o=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),u=r%6,l=[n,a,o,o,s,n][u],c=[s,n,n,a,o,o][u],d=[o,o,s,n,n,a][u];return{r:l*255,g:c*255,b:d*255}}function PR(t,e,n,r){var i=[sc(Math.round(t).toString(16)),sc(Math.round(e).toString(16)),sc(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function iK(t,e,n,r,i){var o=[sc(Math.round(t).toString(16)),sc(Math.round(e).toString(16)),sc(Math.round(n).toString(16)),sc(oK(r))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function oK(t){return Math.round(parseFloat(t)*255).toString(16)}function MR(t){return na(t)/255}function na(t){return parseInt(t,16)}function aK(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var Ib={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function sK(t){var e={r:0,g:0,b:0},n=1,r=null,i=null,o=null,a=!1,s=!1;return typeof t=="string"&&(t=cK(t)),typeof t=="object"&&(T1(t.r)&&T1(t.g)&&T1(t.b)?(e=tK(t.r,t.g,t.b),a=!0,s=String(t.r).substr(-1)==="%"?"prgb":"rgb"):T1(t.h)&&T1(t.s)&&T1(t.v)?(r=C3(t.s),i=C3(t.v),e=rK(t.h,r,i),a=!0,s="hsv"):T1(t.h)&&T1(t.s)&&T1(t.l)&&(r=C3(t.s),o=C3(t.l),e=nK(t.h,r,o),a=!0,s="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=TM(n),{ok:a,format:t.format||s,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var uK="[-\\+]?\\d+%?",lK="[-\\+]?\\d*\\.\\d+%?",Fu="(?:".concat(lK,")|(?:").concat(uK,")"),Wp="[\\s|\\(]+(".concat(Fu,")[,|\\s]+(").concat(Fu,")[,|\\s]+(").concat(Fu,")\\s*\\)?"),Yp="[\\s|\\(]+(".concat(Fu,")[,|\\s]+(").concat(Fu,")[,|\\s]+(").concat(Fu,")[,|\\s]+(").concat(Fu,")\\s*\\)?"),os={CSS_UNIT:new RegExp(Fu),rgb:new RegExp("rgb"+Wp),rgba:new RegExp("rgba"+Yp),hsl:new RegExp("hsl"+Wp),hsla:new RegExp("hsla"+Yp),hsv:new RegExp("hsv"+Wp),hsva:new RegExp("hsva"+Yp),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function cK(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(Ib[t])t=Ib[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=os.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=os.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=os.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=os.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=os.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=os.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=os.hex8.exec(t),n?{r:na(n[1]),g:na(n[2]),b:na(n[3]),a:MR(n[4]),format:e?"name":"hex8"}:(n=os.hex6.exec(t),n?{r:na(n[1]),g:na(n[2]),b:na(n[3]),format:e?"name":"hex"}:(n=os.hex4.exec(t),n?{r:na(n[1]+n[1]),g:na(n[2]+n[2]),b:na(n[3]+n[3]),a:MR(n[4]+n[4]),format:e?"name":"hex8"}:(n=os.hex3.exec(t),n?{r:na(n[1]+n[1]),g:na(n[2]+n[2]),b:na(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function T1(t){return!!os.CSS_UNIT.exec(String(t))}var dK=function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var r;if(e instanceof t)return e;typeof e=="number"&&(e=aK(e)),this.originalInput=e;var i=sK(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=(r=n.format)!==null&&r!==void 0?r:i.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,r,i,o=e.r/255,a=e.g/255,s=e.b/255;return o<=.03928?n=o/12.92:n=Math.pow((o+.055)/1.055,2.4),a<=.03928?r=a/12.92:r=Math.pow((a+.055)/1.055,2.4),s<=.03928?i=s/12.92:i=Math.pow((s+.055)/1.055,2.4),.2126*n+.7152*r+.0722*i},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=TM(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=OR(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=OR(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(r,"%, ").concat(i,"%)"):"hsva(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=LR(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=LR(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(r,"%, ").concat(i,"%)"):"hsla(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),PR(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),iK(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),r=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(r,")"):"rgba(".concat(e,", ").concat(n,", ").concat(r,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(Ui(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(Ui(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+PR(this.r,this.g,this.b,!1),n=0,r=Object.entries(Ib);n<r.length;n++){var i=r[n],o=i[0],a=i[1];if(e===a)return o}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var r=!1,i=this.a<1&&this.a>=0,o=!n&&i&&(e.startsWith("hex")||e==="name");return o?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=_3(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=_3(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=_3(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=_3(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var r=this.toRgb(),i=new t(e).toRgb(),o=n/100,a={r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a};return new t(a)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var r=this.toHsl(),i=360/n,o=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,o.push(new t(r));return o},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),r=n.h,i=n.s,o=n.v,a=[],s=1/e;e--;)a.push(new t({h:r,s:i,v:o})),o=(o+s)%1;return a},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),r=new t(e).toRgb(),i=n.a+r.a*(1-n.a);return new t({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),r=n.h,i=[this],o=360/e,a=1;a<e;a++)i.push(new t({h:(r+a*o)%360,s:n.s,l:n.l}));return i},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}(),mK=["b"],fK=["v"],Xp=function(t){return Math.round(Number(t||0))},hK=function(t){if(t&&Pr(t)==="object"&&"h"in t&&"b"in t){var e=t,n=e.b,r=Qn(e,mK);return $e($e({},r),{},{v:n})}return typeof t=="string"&&/hsb/.test(t)?t.replace(/hsb/,"hsv"):t},NR=function(t){tf(n,t);var e=nf(n);function n(r){return Al(this,n),e.call(this,hK(r))}return Tl(n,[{key:"toHsbString",value:function(){var r=this.toHsb(),i=Xp(r.s*100),o=Xp(r.b*100),a=Xp(r.h),s=r.a,u="hsb(".concat(a,", ").concat(i,"%, ").concat(o,"%)"),l="hsba(".concat(a,", ").concat(i,"%, ").concat(o,"%, ").concat(s.toFixed(s===0?0:2),")");return s===1?u:l}},{key:"toHsb",value:function(){var r=this.toHsv();Pr(this.originalInput)==="object"&&this.originalInput&&"h"in this.originalInput&&(r=this.originalInput);var i=r;i.v;var o=Qn(i,fK);return $e($e({},o),{},{b:r.v})}}]),n}(dK),pK="rc-color-picker",Zu=function(t){return t instanceof NR?t:new NR(t)},gK=Zu("#1677ff"),wM=function(t){var e=t.offset,n=t.targetRef,r=t.containerRef,i=t.color,o=t.type,a=r.current.getBoundingClientRect(),s=a.width,u=a.height,l=n.current.getBoundingClientRect(),c=l.width,d=l.height,m=c/2,f=d/2,h=(e.x+m)/s,p=1-(e.y+f)/u,v=i.toHsb(),g=h,b=(e.x+m)/s*360;if(o)switch(o){case"hue":return Zu($e($e({},v),{},{h:b<=0?0:b}));case"alpha":return Zu($e($e({},v),{},{a:g<=0?0:g}))}return Zu({h:v.h,s:h<=0?0:h,b:p>=1?1:p,a:v.a})},LM=function(t,e,n,r){var i=t.current.getBoundingClientRect(),o=i.width,a=i.height,s=e.current.getBoundingClientRect(),u=s.width,l=s.height,c=u/2,d=l/2,m=n.toHsb();if(!(u===0&&l===0||u!==l)){if(r)switch(r){case"hue":return{x:m.h/360*o-c,y:-d/3};case"alpha":return{x:m.a/1*o-c,y:-d/3}}return{x:m.s*o-c,y:(1-m.b)*a-d}}};function OM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var PM={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(o=i(o,r(s)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var s in o)e.call(o,s)&&o[s]&&(a=i(a,s));return a}function i(o,a){return a?o?o+" "+a:o+a:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(PM);var vK=PM.exports;const Xt=OM(vK);var MM=function(t){var e=t.color,n=t.prefixCls,r=t.className,i=t.style,o=t.onClick,a="".concat(n,"-color-block");return Se.createElement("div",{className:Xt(a,r),style:i,onClick:o},Se.createElement("div",{className:"".concat(a,"-inner"),style:{background:e}}))};function bK(t){var e="touches"in t?t.touches[0]:t,n=document.documentElement.scrollLeft||document.body.scrollLeft||window.pageXOffset,r=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;return{pageX:e.pageX-n,pageY:e.pageY-r}}function NM(t){var e=t.offset,n=t.targetRef,r=t.containerRef,i=t.direction,o=t.onDragChange,a=t.onDragChangeComplete,s=t.calculate,u=t.color,l=t.disabledDrag,c=_.useState(e||{x:0,y:0}),d=Qe(c,2),m=d[0],f=d[1],h=_.useRef(null),p=_.useRef(null),v=_.useRef({flag:!1});_.useEffect(function(){if(v.current.flag===!1){var E=s==null?void 0:s(r);E&&f(E)}},[u,r]),_.useEffect(function(){return function(){document.removeEventListener("mousemove",h.current),document.removeEventListener("mouseup",p.current),document.removeEventListener("touchmove",h.current),document.removeEventListener("touchend",p.current),h.current=null,p.current=null}},[]);var g=function(E){var y=bK(E),D=y.pageX,R=y.pageY,I=r.current.getBoundingClientRect(),T=I.x,P=I.y,N=I.width,B=I.height,W=n.current.getBoundingClientRect(),G=W.width,Q=W.height,te=G/2,X=Q/2,x=Math.max(0,Math.min(D-T,N))-te,O=Math.max(0,Math.min(R-P,B))-X,M={x,y:i==="x"?m.y:O};if(G===0&&Q===0||G!==Q)return!1;f(M),o==null||o(M)},b=function(E){E.preventDefault(),g(E)},C=function(E){E.preventDefault(),v.current.flag=!1,document.removeEventListener("mousemove",h.current),document.removeEventListener("mouseup",p.current),document.removeEventListener("touchmove",h.current),document.removeEventListener("touchend",p.current),h.current=null,p.current=null,a==null||a()},S=function(E){document.removeEventListener("mousemove",h.current),document.removeEventListener("mouseup",p.current),!l&&(g(E),v.current.flag=!0,document.addEventListener("mousemove",b),document.addEventListener("mouseup",C),document.addEventListener("touchmove",b),document.addEventListener("touchend",C),h.current=b,p.current=C)};return[m,S]}var xM=function(t){var e=t.size,n=e===void 0?"default":e,r=t.color,i=t.prefixCls;return Se.createElement("div",{className:Xt("".concat(i,"-handler"),ut({},"".concat(i,"-handler-sm"),n==="small")),style:{backgroundColor:r}})},FM=function(t){var e=t.children,n=t.style,r=t.prefixCls;return Se.createElement("div",{className:"".concat(r,"-palette"),style:$e({position:"relative"},n)},e)},$M=_.forwardRef(function(t,e){var n=t.children,r=t.offset;return Se.createElement("div",{ref:e,style:{position:"absolute",left:r.x,top:r.y,zIndex:1}},n)}),_K=function(t){var e=t.color,n=t.onChange,r=t.prefixCls,i=t.onChangeComplete,o=t.disabled,a=_.useRef(),s=_.useRef(),u=_.useRef(e),l=NM({color:e,containerRef:a,targetRef:s,calculate:function(f){return LM(f,s,e)},onDragChange:function(f){var h=wM({offset:f,targetRef:s,containerRef:a,color:e});u.current=h,n(h)},onDragChangeComplete:function(){return i==null?void 0:i(u.current)},disabledDrag:o}),c=Qe(l,2),d=c[0],m=c[1];return Se.createElement("div",{ref:a,className:"".concat(r,"-select"),onMouseDown:m,onTouchStart:m},Se.createElement(FM,{prefixCls:r},Se.createElement($M,{offset:d,ref:s},Se.createElement(xM,{color:e.toRgbString(),prefixCls:r})),Se.createElement("div",{className:"".concat(r,"-saturation"),style:{backgroundColor:"hsl(".concat(e.toHsb().h,",100%, 50%)"),backgroundImage:"linear-gradient(0deg, #000, transparent),linear-gradient(90deg, #fff, hsla(0, 0%, 100%, 0))"}})))},CK=function(t){var e=t.colors,n=t.children,r=t.direction,i=r===void 0?"to right":r,o=t.type,a=t.prefixCls,s=_.useMemo(function(){return e.map(function(u,l){var c=Zu(u);return o==="alpha"&&l===e.length-1&&c.setAlpha(1),c.toRgbString()}).join(",")},[e,o]);return Se.createElement("div",{className:"".concat(a,"-gradient"),style:{position:"absolute",inset:0,background:"linear-gradient(".concat(i,", ").concat(s,")")}},n)},xR=function(t){var e=t.gradientColors,n=t.direction,r=t.type,i=r===void 0?"hue":r,o=t.color,a=t.value,s=t.onChange,u=t.onChangeComplete,l=t.disabled,c=t.prefixCls,d=_.useRef(),m=_.useRef(),f=_.useRef(o),h=NM({color:o,targetRef:m,containerRef:d,calculate:function(b){return LM(b,m,o,i)},onDragChange:function(b){var C=wM({offset:b,targetRef:m,containerRef:d,color:o,type:i});f.current=C,s(C)},onDragChangeComplete:function(){u==null||u(f.current,i)},direction:"x",disabledDrag:l}),p=Qe(h,2),v=p[0],g=p[1];return Se.createElement("div",{ref:d,className:Xt("".concat(c,"-slider"),"".concat(c,"-slider-").concat(i)),onMouseDown:g,onTouchStart:g},Se.createElement(FM,{prefixCls:c},Se.createElement($M,{offset:v,ref:m},Se.createElement(xM,{size:"small",color:a,prefixCls:c})),Se.createElement(CK,{colors:e,direction:n,type:i,prefixCls:c})))};function FR(t){return t!==void 0}var SK=function(t,e){var n=e.defaultValue,r=e.value,i=_.useState(function(){var u;return FR(r)?u=r:FR(n)?u=n:u=t,Zu(u)}),o=Qe(i,2),a=o[0],s=o[1];return _.useEffect(function(){r&&s(Zu(r))},[r]),[a,s]},EK=["rgb(255, 0, 0) 0%","rgb(255, 255, 0) 17%","rgb(0, 255, 0) 33%","rgb(0, 255, 255) 50%","rgb(0, 0, 255) 67%","rgb(255, 0, 255) 83%","rgb(255, 0, 0) 100%"];const yK=_.forwardRef(function(t,e){var n=t.value,r=t.defaultValue,i=t.prefixCls,o=i===void 0?pK:i,a=t.onChange,s=t.onChangeComplete,u=t.className,l=t.style,c=t.panelRender,d=t.disabledAlpha,m=d===void 0?!1:d,f=t.disabled,h=f===void 0?!1:f,p=SK(gK,{value:n,defaultValue:r}),v=Qe(p,2),g=v[0],b=v[1],C=_.useMemo(function(){var R=Zu(g.toRgbString());return R.setAlpha(1),R.toRgbString()},[g]),S=Xt("".concat(o,"-panel"),u,ut({},"".concat(o,"-panel-disabled"),h)),E={prefixCls:o,onChangeComplete:s,disabled:h},y=function(R,I){n||b(R),a==null||a(R,I)},D=Se.createElement(Se.Fragment,null,Se.createElement(_K,Qt({color:g,onChange:y},E)),Se.createElement("div",{className:"".concat(o,"-slider-container")},Se.createElement("div",{className:Xt("".concat(o,"-slider-group"),ut({},"".concat(o,"-slider-group-disabled-alpha"),m))},Se.createElement(xR,Qt({gradientColors:EK,color:g,value:"hsl(".concat(g.toHsb().h,",100%, 50%)"),onChange:function(R){return y(R,"hue")}},E)),!m&&Se.createElement(xR,Qt({type:"alpha",gradientColors:["rgba(255, 0, 4, 0) 0%",C],color:g,value:g.toRgbString(),onChange:function(R){return y(R,"alpha")}},E))),Se.createElement(MM,{color:g.toRgbString(),prefixCls:o})));return Se.createElement("div",{className:S,style:l,ref:e},typeof c=="function"?c(D):D)}),DK="univer-color-picker",RK="univer-color-picker-hidden",IK="univer-color-picker-panel",AK="univer-color-picker-panel-disabled",TK="univer-color-picker-select",wK="univer-color-picker-palette",LK="univer-color-picker-gradient",OK="univer-color-picker-saturation",PK="univer-color-picker-handler",MK="univer-color-picker-slider",NK="univer-color-picker-color-blocks",xK="univer-color-picker-color-block",FK="univer-color-picker-color-block-inner",$K="univer-color-picker-slider-container",kK="univer-color-picker-slider-group",BK="univer-color-picker-slider-group-disabled-alpha",qp={colorPicker:DK,colorPickerHidden:RK,colorPickerPanel:IK,colorPickerPanelDisabled:AK,colorPickerSelect:TK,colorPickerPalette:wK,colorPickerGradient:LK,colorPickerSaturation:OK,colorPickerHandler:PK,colorPickerSlider:MK,colorPickerColorBlocks:NK,colorPickerColorBlock:xK,colorPickerColorBlockInner:FK,colorPickerSliderContainer:$K,colorPickerSliderGroup:kK,colorPickerSliderGroupDisabledAlpha:BK},UK=["#35322B","#505050","#606060","#6F6F6F","#8B8B8B","#B2B2B2","#CCCCCC","#E5E5E5","#F5F5F5","#FFFFFF","#9D0000","#B20000","#CD0F0F","#E30909","#F30B0B","#FE4B4B","#FA7979","#FB9D9D","#FDCECE","#FEE7E7","#B24000","#CC4F10","#DF5D00","#F96800","#FB8937","#FF8C51","#FCA669","#FDC49B","#FEE1CD","#FEF0E6","#B19401","#C5A300","#D8B300","#EBC301","#F9D700","#FBE137","#FCE869","#FDF09B","#FEF7CD","#FEFBE6","#58770A","#688C0D","#7AA017","#8BBB11","#A4DC16","#BEEE44","#CEF273","#DEF6A2","#EFFBD0","#F7FDE8","#007676","#008A8A","#009E9E","#00BBBB","#1CD8D8","#2AEAEA","#76EFEF","#A3F5F5","#D1FAFA","#E8FCFC","#001F9C","#0025B7","#012BD2","#133DE3","#2F55EB","#4567ED","#738DF2","#A2B3F6","#D0D9FB","#E8ECFD","#3F0198","#510EB0","#6721CB","#7735D4","#894EDE","#9E6DE3","#AA82E3","#C7ABED","#E3D5F6","#F1EAFA","#8F0550","#A1095C","#C1026B","#D4157E","#E7258F","#F248A6","#F273B9","#F6A2D0","#FBD0E8","#FDE8F3"];function $S(t){const{onChange:e}=t;function n(i){i.stopPropagation()}function r(i){var o;const a=(o=typeof i=="string"?i:i.toHexString())!=null?o:"";e==null||e(a)}return Se.createElement("section",null,Se.createElement("div",null,Se.createElement("div",{className:qp.colorPickerColorBlocks},UK.map(i=>Se.createElement(MM,{key:i,prefixCls:qp.colorPicker,color:i,onClick:()=>r(i)})))),Se.createElement("section",{onClick:n},Se.createElement(yK,{prefixCls:qp.colorPicker,disabledAlpha:!0,onChangeComplete:r})))}const VK={design:{Confirm:{cancel:"cancel",confirm:"ok"},Slider:{resetTo:"Reset to"}}},kM=VK,su=_.createContext({locale:kM,mountContainer:document.body});function HK(t){const{children:e,locale:n,mountContainer:r}=t;let i;return Object.prototype.hasOwnProperty.call(n,"design")?i=n:i=kM,Se.createElement(su.Provider,{value:{locale:i,mountContainer:r}},e)}function h1(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Ab={},jK=function(t){};function zK(t,e){}function WK(t,e){}function YK(){Ab={}}function BM(t,e,n){!e&&!Ab[n]&&(t(!1,n),Ab[n]=!0)}function wl(t,e){BM(zK,t,e)}function XK(t,e){BM(WK,t,e)}wl.preMessage=jK;wl.resetWarned=YK;wl.noteOnce=XK;var UM={exports:{}},Cr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kS=Symbol.for("react.element"),BS=Symbol.for("react.portal"),D5=Symbol.for("react.fragment"),R5=Symbol.for("react.strict_mode"),I5=Symbol.for("react.profiler"),A5=Symbol.for("react.provider"),T5=Symbol.for("react.context"),qK=Symbol.for("react.server_context"),w5=Symbol.for("react.forward_ref"),L5=Symbol.for("react.suspense"),O5=Symbol.for("react.suspense_list"),P5=Symbol.for("react.memo"),M5=Symbol.for("react.lazy"),GK=Symbol.for("react.offscreen"),VM;VM=Symbol.for("react.module.reference");function Za(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case kS:switch(t=t.type,t){case D5:case I5:case R5:case L5:case O5:return t;default:switch(t=t&&t.$$typeof,t){case qK:case T5:case w5:case M5:case P5:case A5:return t;default:return e}}case BS:return e}}}Cr.ContextConsumer=T5;Cr.ContextProvider=A5;Cr.Element=kS;Cr.ForwardRef=w5;Cr.Fragment=D5;Cr.Lazy=M5;Cr.Memo=P5;Cr.Portal=BS;Cr.Profiler=I5;Cr.StrictMode=R5;Cr.Suspense=L5;Cr.SuspenseList=O5;Cr.isAsyncMode=function(){return!1};Cr.isConcurrentMode=function(){return!1};Cr.isContextConsumer=function(t){return Za(t)===T5};Cr.isContextProvider=function(t){return Za(t)===A5};Cr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===kS};Cr.isForwardRef=function(t){return Za(t)===w5};Cr.isFragment=function(t){return Za(t)===D5};Cr.isLazy=function(t){return Za(t)===M5};Cr.isMemo=function(t){return Za(t)===P5};Cr.isPortal=function(t){return Za(t)===BS};Cr.isProfiler=function(t){return Za(t)===I5};Cr.isStrictMode=function(t){return Za(t)===R5};Cr.isSuspense=function(t){return Za(t)===L5};Cr.isSuspenseList=function(t){return Za(t)===O5};Cr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===D5||t===I5||t===R5||t===L5||t===O5||t===GK||typeof t=="object"&&t!==null&&(t.$$typeof===M5||t.$$typeof===P5||t.$$typeof===A5||t.$$typeof===T5||t.$$typeof===w5||t.$$typeof===VM||t.getModuleId!==void 0)};Cr.typeOf=Za;UM.exports=Cr;var L4=UM.exports;function US(t,e,n){var r=_.useRef({});return(!("value"in r.current)||n(r.current.condition,e))&&(r.current.value=t(),r.current.condition=e),r.current.value}function VS(t,e){typeof t=="function"?t(e):Pr(t)==="object"&&t&&"current"in t&&(t.current=e)}function zc(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.filter(function(i){return i});return r.length<=1?r[0]:function(i){e.forEach(function(o){VS(o,i)})}}function nd(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return US(function(){return zc.apply(void 0,e)},e,function(r,i){return r.length!==i.length||r.every(function(o,a){return o!==i[a]})})}function rd(t){var e,n,r=L4.isMemo(t)?t.type.type:t.type;return!(typeof r=="function"&&!((e=r.prototype)!==null&&e!==void 0&&e.render)&&r.$$typeof!==L4.ForwardRef||typeof t=="function"&&!((n=t.prototype)!==null&&n!==void 0&&n.render)&&t.$$typeof!==L4.ForwardRef)}var HM=_.createContext(null);function KK(t){if(Array.isArray(t))return Rb(t)}function jM(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ZK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wr(t){return KK(t)||jM(t)||FS(t)||ZK()}var $R=h1()?_.useLayoutEffect:_.useEffect,Kr=function(t,e){var n=_.useRef(!0);$R(function(){return t(n.current)},e),$R(function(){return n.current=!1,function(){n.current=!0}},[])},k6=function(t,e){Kr(function(n){if(!n)return t()},e)},kR=[];function QK(t,e){var n=_.useState(function(){if(!h1())return null;var h=document.createElement("div");return h}),r=Qe(n,1),i=r[0],o=_.useRef(!1),a=_.useContext(HM),s=_.useState(kR),u=Qe(s,2),l=u[0],c=u[1],d=a||(o.current?void 0:function(h){c(function(p){var v=[h].concat(Wr(p));return v})});function m(){i.parentElement||document.body.appendChild(i),o.current=!0}function f(){var h;(h=i.parentElement)===null||h===void 0||h.removeChild(i),o.current=!1}return Kr(function(){return t?a?a(m):m():f(),f},[t]),Kr(function(){l.length&&(l.forEach(function(h){return h()}),c(kR))},[l]),[i,d]}function Tb(t,e){if(!t)return!1;if(t.contains)return t.contains(e);for(var n=e;n;){if(n===t)return!0;n=n.parentNode}return!1}var BR="data-rc-order",UR="data-rc-priority",JK="rc-util-key",wb=new Map;function zM(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mark;return e?e.startsWith("data-")?e:"data-".concat(e):JK}function N5(t){if(t.attachTo)return t.attachTo;var e=document.querySelector("head");return e||document.body}function eZ(t){return t==="queue"?"prependQueue":t?"prepend":"append"}function HS(t){return Array.from((wb.get(t)||t).children).filter(function(e){return e.tagName==="STYLE"})}function WM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!h1())return null;var n=e.csp,r=e.prepend,i=e.priority,o=i===void 0?0:i,a=eZ(r),s=a==="prependQueue",u=document.createElement("style");u.setAttribute(BR,a),s&&o&&u.setAttribute(UR,"".concat(o)),n!=null&&n.nonce&&(u.nonce=n==null?void 0:n.nonce),u.innerHTML=t;var l=N5(e),c=l.firstChild;if(r){if(s){var d=(e.styles||HS(l)).filter(function(m){if(!["prepend","prependQueue"].includes(m.getAttribute(BR)))return!1;var f=Number(m.getAttribute(UR)||0);return o>=f});if(d.length)return l.insertBefore(u,d[d.length-1].nextSibling),u}l.insertBefore(u,c)}else l.appendChild(u);return u}function YM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=N5(e);return(e.styles||HS(n)).find(function(r){return r.getAttribute(zM(e))===t})}function VR(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=YM(t,e);if(n){var r=N5(e);r.removeChild(n)}}function tZ(t,e){var n=wb.get(t);if(!n||!Tb(document,n)){var r=WM("",e),i=r.parentNode;wb.set(t,i),t.removeChild(r)}}function nZ(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=N5(n),i=HS(r),o=$e($e({},n),{},{styles:i});tZ(r,o);var a=YM(e,o);if(a){var s,u;if((s=o.csp)!==null&&s!==void 0&&s.nonce&&a.nonce!==((u=o.csp)===null||u===void 0?void 0:u.nonce)){var l;a.nonce=(l=o.csp)===null||l===void 0?void 0:l.nonce}return a.innerHTML!==t&&(a.innerHTML=t),a}var c=WM(t,o);return c.setAttribute(zM(o),e),c}var Gp;function rZ(t){if(typeof document>"u")return 0;if(t||Gp===void 0){var e=document.createElement("div");e.style.width="100%",e.style.height="200px";var n=document.createElement("div"),r=n.style;r.position="absolute",r.top="0",r.left="0",r.pointerEvents="none",r.visibility="hidden",r.width="200px",r.height="150px",r.overflow="hidden",n.appendChild(e),document.body.appendChild(n);var i=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;i===o&&(o=n.clientWidth),document.body.removeChild(n),Gp=i-o}return Gp}function HR(t){var e=t.match(/^(.*)px$/),n=Number(e==null?void 0:e[1]);return Number.isNaN(n)?rZ():n}function iZ(t){if(typeof document>"u"||!t||!(t instanceof Element))return{width:0,height:0};var e=getComputedStyle(t,"::-webkit-scrollbar"),n=e.width,r=e.height;return{width:HR(n),height:HR(r)}}function oZ(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var aZ="rc-util-locker-".concat(Date.now()),jR=0;function sZ(t){var e=!!t,n=_.useState(function(){return jR+=1,"".concat(aZ,"_").concat(jR)}),r=Qe(n,1),i=r[0];Kr(function(){if(e){var o=iZ(document.body).width,a=oZ();nZ(`
html body {
  overflow-y: hidden;
  `.concat(a?"width: calc(100% - ".concat(o,"px);"):"",`
}`),i)}else VR(i);return function(){VR(i)}},[e,i])}var zR=!1;function uZ(t){return typeof t=="boolean"&&(zR=t),zR}var WR=function(t){return t===!1?!1:!h1()||!t?null:typeof t=="string"?document.querySelector(t):typeof t=="function"?t():t},jS=_.forwardRef(function(t,e){var n=t.open,r=t.autoLock,i=t.getContainer;t.debug;var o=t.autoDestroy,a=o===void 0?!0:o,s=t.children,u=_.useState(n),l=Qe(u,2),c=l[0],d=l[1],m=c||n;_.useEffect(function(){(a||n)&&d(n)},[n,a]);var f=_.useState(function(){return WR(i)}),h=Qe(f,2),p=h[0],v=h[1];_.useEffect(function(){var P=WR(i);v(P??null)});var g=QK(m&&!p),b=Qe(g,2),C=b[0],S=b[1],E=p??C;sZ(r&&n&&h1()&&(E===C||E===document.body));var y=null;if(s&&rd(s)&&e){var D=s;y=D.ref}var R=nd(y,e);if(!m||!h1()||p===void 0)return null;var I=E===!1||uZ(),T=s;return e&&(T=_.cloneElement(s,{ref:R})),_.createElement(HM.Provider,{value:S},I?T:Ac.createPortal(T,E))}),XM=_.createContext({});function lZ(){var t=$e({},cX);return t.useId}var YR=0,XR=lZ();const qM=XR?function(t){var e=XR();return t||e}:function(t){var e=_.useState("ssr-id"),n=Qe(e,2),r=n[0],i=n[1];return _.useEffect(function(){var o=YR;YR+=1,i("rc_unique_".concat(o))},[]),t||r};var lt={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){var e=t.keyCode;if(t.altKey&&!t.ctrlKey||t.metaKey||e>=lt.F1&&e<=lt.F12)return!1;switch(e){case lt.ALT:case lt.CAPS_LOCK:case lt.CONTEXT_MENU:case lt.CTRL:case lt.DOWN:case lt.END:case lt.ESC:case lt.HOME:case lt.INSERT:case lt.LEFT:case lt.MAC_FF_META:case lt.META:case lt.NUMLOCK:case lt.NUM_CENTER:case lt.PAGE_DOWN:case lt.PAGE_UP:case lt.PAUSE:case lt.PRINT_SCREEN:case lt.RIGHT:case lt.SHIFT:case lt.UP:case lt.WIN_KEY:case lt.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=lt.ZERO&&t<=lt.NINE||t>=lt.NUM_ZERO&&t<=lt.NUM_MULTIPLY||t>=lt.A&&t<=lt.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case lt.SPACE:case lt.QUESTION_MARK:case lt.NUM_PLUS:case lt.NUM_MINUS:case lt.NUM_PERIOD:case lt.NUM_DIVISION:case lt.SEMICOLON:case lt.DASH:case lt.EQUALS:case lt.COMMA:case lt.PERIOD:case lt.SLASH:case lt.APOSTROPHE:case lt.SINGLE_QUOTE:case lt.OPEN_SQUARE_BRACKET:case lt.BACKSLASH:case lt.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},cZ=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,dZ=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,mZ="".concat(cZ," ").concat(dZ).split(/[\s\n]+/),fZ="aria-",hZ="data-";function qR(t,e){return t.indexOf(e)===0}function Cm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n;e===!1?n={aria:!0,data:!0,attr:!0}:e===!0?n={aria:!0}:n=$e({},e);var r={};return Object.keys(t).forEach(function(i){(n.aria&&(i==="role"||qR(i,fZ))||n.data&&qR(i,hZ)||n.attr&&mZ.includes(i))&&(r[i]=t[i])}),r}function GR(t,e,n){var r=e;return!r&&n&&(r="".concat(t,"-").concat(n)),r}function KR(t,e){var n=t["page".concat(e?"Y":"X","Offset")],r="scroll".concat(e?"Top":"Left");if(typeof n!="number"){var i=t.document;n=i.documentElement[r],typeof n!="number"&&(n=i.body[r])}return n}function pZ(t){var e=t.getBoundingClientRect(),n={left:e.left,top:e.top},r=t.ownerDocument,i=r.defaultView||r.parentWindow;return n.left+=KR(i),n.top+=KR(i,!0),n}function i9(t){return t instanceof HTMLElement||t instanceof SVGElement}function B6(t){return i9(t)?t:t instanceof Se.Component?o1.findDOMNode(t):null}var gZ=_.createContext({}),vZ=function(t){tf(n,t);var e=nf(n);function n(){return Al(this,n),e.apply(this,arguments)}return Tl(n,[{key:"render",value:function(){return this.props.children}}]),n}(_.Component);function p0(t){var e=_.useRef(!1),n=_.useState(t),r=Qe(n,2),i=r[0],o=r[1];_.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function a(s,u){u&&e.current||o(s)}return[i,a]}var ql="none",S3="appear",E3="enter",y3="leave",ZR="none",ds="prepare",Q2="start",J2="active",zS="end",GM="prepared";function QR(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function bZ(t,e){var n={animationend:QR("Animation","AnimationEnd"),transitionend:QR("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var _Z=bZ(h1(),typeof window<"u"?window:{}),KM={};if(h1()){var CZ=document.createElement("div");KM=CZ.style}var D3={};function ZM(t){if(D3[t])return D3[t];var e=_Z[t];if(e)for(var n=Object.keys(e),r=n.length,i=0;i<r;i+=1){var o=n[i];if(Object.prototype.hasOwnProperty.call(e,o)&&o in KM)return D3[t]=e[o],D3[t]}return""}var QM=ZM("animationend"),JM=ZM("transitionend"),eN=!!(QM&&JM),JR=QM||"animationend",eI=JM||"transitionend";function tI(t,e){if(!t)return null;if(Pr(t)==="object"){var n=e.replace(/-\w/g,function(r){return r[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const SZ=function(t){var e=_.useRef(),n=_.useRef(t);n.current=t;var r=_.useCallback(function(a){n.current(a)},[]);function i(a){a&&(a.removeEventListener(eI,r),a.removeEventListener(JR,r))}function o(a){e.current&&e.current!==a&&i(e.current),a&&a!==e.current&&(a.addEventListener(eI,r),a.addEventListener(JR,r),e.current=a)}return _.useEffect(function(){return function(){i(e.current)}},[]),[o,i]};var tN=h1()?_.useLayoutEffect:_.useEffect,nN=function(t){return+setTimeout(t,16)},rN=function(t){return clearTimeout(t)};typeof window<"u"&&"requestAnimationFrame"in window&&(nN=function(t){return window.requestAnimationFrame(t)},rN=function(t){return window.cancelAnimationFrame(t)});var nI=0,WS=new Map;function iN(t){WS.delete(t)}var Or=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;nI+=1;var n=nI;function r(i){if(i===0)iN(n),t();else{var o=nN(function(){r(i-1)});WS.set(n,o)}}return r(e),n};Or.cancel=function(t){var e=WS.get(t);return iN(t),rN(e)};const EZ=function(){var t=_.useRef(null);function e(){Or.cancel(t.current)}function n(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=Or(function(){i<=1?r({isCanceled:function(){return o!==t.current}}):n(r,i-1)});t.current=o}return _.useEffect(function(){return function(){e()}},[]),[n,e]};var yZ=[ds,Q2,J2,zS],DZ=[ds,GM],oN=!1,RZ=!0;function aN(t){return t===J2||t===zS}const IZ=function(t,e,n){var r=p0(ZR),i=Qe(r,2),o=i[0],a=i[1],s=EZ(),u=Qe(s,2),l=u[0],c=u[1];function d(){a(ds,!0)}var m=e?DZ:yZ;return tN(function(){if(o!==ZR&&o!==zS){var f=m.indexOf(o),h=m[f+1],p=n(o);p===oN?a(h,!0):h&&l(function(v){function g(){v.isCanceled()||a(h,!0)}p===!0?g():Promise.resolve(p).then(g)})}},[t,o]),_.useEffect(function(){return function(){c()}},[]),[d,o]};function AZ(t,e,n,r){var i=r.motionEnter,o=i===void 0?!0:i,a=r.motionAppear,s=a===void 0?!0:a,u=r.motionLeave,l=u===void 0?!0:u,c=r.motionDeadline,d=r.motionLeaveImmediately,m=r.onAppearPrepare,f=r.onEnterPrepare,h=r.onLeavePrepare,p=r.onAppearStart,v=r.onEnterStart,g=r.onLeaveStart,b=r.onAppearActive,C=r.onEnterActive,S=r.onLeaveActive,E=r.onAppearEnd,y=r.onEnterEnd,D=r.onLeaveEnd,R=r.onVisibleChanged,I=p0(),T=Qe(I,2),P=T[0],N=T[1],B=p0(ql),W=Qe(B,2),G=W[0],Q=W[1],te=p0(null),X=Qe(te,2),x=X[0],O=X[1],M=_.useRef(!1),V=_.useRef(null);function q(){return n()}var ie=_.useRef(!1);function ce(){Q(ql,!0),O(null,!0)}function pe(_e){var He=q();if(!(_e&&!_e.deadline&&_e.target!==He)){var et=ie.current,Dt;G===S3&&et?Dt=E==null?void 0:E(He,_e):G===E3&&et?Dt=y==null?void 0:y(He,_e):G===y3&&et&&(Dt=D==null?void 0:D(He,_e)),G!==ql&&et&&Dt!==!1&&ce()}}var oe=SZ(pe),he=Qe(oe,1),fe=he[0],ve=function(_e){var He,et,Dt;switch(_e){case S3:return He={},ut(He,ds,m),ut(He,Q2,p),ut(He,J2,b),He;case E3:return et={},ut(et,ds,f),ut(et,Q2,v),ut(et,J2,C),et;case y3:return Dt={},ut(Dt,ds,h),ut(Dt,Q2,g),ut(Dt,J2,S),Dt;default:return{}}},Ue=_.useMemo(function(){return ve(G)},[G]),ke=IZ(G,!t,function(_e){if(_e===ds){var He=Ue[ds];return He?He(q()):oN}if(rt in Ue){var et;O(((et=Ue[rt])===null||et===void 0?void 0:et.call(Ue,q(),null))||null)}return rt===J2&&(fe(q()),c>0&&(clearTimeout(V.current),V.current=setTimeout(function(){pe({deadline:!0})},c))),rt===GM&&ce(),RZ}),Te=Qe(ke,2),Re=Te[0],rt=Te[1],_t=aN(rt);ie.current=_t,tN(function(){N(e);var _e=M.current;M.current=!0;var He;!_e&&e&&s&&(He=S3),_e&&e&&o&&(He=E3),(_e&&!e&&l||!_e&&d&&!e&&l)&&(He=y3);var et=ve(He);He&&(t||et[ds])?(Q(He),Re()):Q(ql)},[e]),_.useEffect(function(){(G===S3&&!s||G===E3&&!o||G===y3&&!l)&&Q(ql)},[s,o,l]),_.useEffect(function(){return function(){M.current=!1,clearTimeout(V.current)}},[]);var mt=_.useRef(!1);_.useEffect(function(){P&&(mt.current=!0),P!==void 0&&G===ql&&((mt.current||P)&&(R==null||R(P)),mt.current=!0)},[P,G]);var nt=x;return Ue[ds]&&rt===Q2&&(nt=$e({transition:"none"},nt)),[G,rt,nt,P??e]}function TZ(t){var e=t;Pr(t)==="object"&&(e=t.transitionSupport);function n(i,o){return!!(i.motionName&&e&&o!==!1)}var r=_.forwardRef(function(i,o){var a=i.visible,s=a===void 0?!0:a,u=i.removeOnLeave,l=u===void 0?!0:u,c=i.forceRender,d=i.children,m=i.motionName,f=i.leavedClassName,h=i.eventProps,p=_.useContext(gZ),v=p.motion,g=n(i,v),b=_.useRef(),C=_.useRef();function S(){try{return b.current instanceof HTMLElement?b.current:B6(C.current)}catch{return null}}var E=AZ(g,s,S,i),y=Qe(E,4),D=y[0],R=y[1],I=y[2],T=y[3],P=_.useRef(T);T&&(P.current=!0);var N=_.useCallback(function(O){b.current=O,VS(o,O)},[o]),B,W=$e($e({},h),{},{visible:s});if(!d)B=null;else if(D===ql)T?B=d($e({},W),N):!l&&P.current&&f?B=d($e($e({},W),{},{className:f}),N):c||!l&&!f?B=d($e($e({},W),{},{style:{display:"none"}}),N):B=null;else{var G,Q;R===ds?Q="prepare":aN(R)?Q="active":R===Q2&&(Q="start");var te=tI(m,"".concat(D,"-").concat(Q));B=d($e($e({},W),{},{className:Xt(tI(m,D),(G={},ut(G,te,te&&Q),ut(G,m,typeof m=="string"),G)),style:I}),N)}if(_.isValidElement(B)&&rd(B)){var X=B,x=X.ref;x||(B=_.cloneElement(B,{ref:N}))}return _.createElement(vZ,{ref:C},B)});return r.displayName="CSSMotion",r}const id=TZ(eN);var Lb="add",Ob="keep",Pb="remove",Kp="removed";function wZ(t){var e;return t&&Pr(t)==="object"&&"key"in t?e=t:e={key:t},$e($e({},e),{},{key:String(e.key)})}function Mb(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(wZ)}function LZ(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],r=0,i=e.length,o=Mb(t),a=Mb(e);o.forEach(function(l){for(var c=!1,d=r;d<i;d+=1){var m=a[d];if(m.key===l.key){r<d&&(n=n.concat(a.slice(r,d).map(function(f){return $e($e({},f),{},{status:Lb})})),r=d),n.push($e($e({},m),{},{status:Ob})),r+=1,c=!0;break}}c||n.push($e($e({},l),{},{status:Pb}))}),r<i&&(n=n.concat(a.slice(r).map(function(l){return $e($e({},l),{},{status:Lb})})));var s={};n.forEach(function(l){var c=l.key;s[c]=(s[c]||0)+1});var u=Object.keys(s).filter(function(l){return s[l]>1});return u.forEach(function(l){n=n.filter(function(c){var d=c.key,m=c.status;return d!==l||m!==Pb}),n.forEach(function(c){c.key===l&&(c.status=Ob)})}),n}var OZ=["component","children","onVisibleChanged","onAllRemoved"],PZ=["status"],MZ=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function NZ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:id,n=function(r){tf(o,r);var i=nf(o);function o(){var a;Al(this,o);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return a=i.call.apply(i,[this].concat(u)),ut(r9(a),"state",{keyEntities:[]}),ut(r9(a),"removeKey",function(c){var d=a.state.keyEntities,m=d.map(function(f){return f.key!==c?f:$e($e({},f),{},{status:Kp})});return a.setState({keyEntities:m}),m.filter(function(f){var h=f.status;return h!==Kp}).length}),a}return Tl(o,[{key:"render",value:function(){var a=this,s=this.state.keyEntities,u=this.props,l=u.component,c=u.children,d=u.onVisibleChanged,m=u.onAllRemoved,f=Qn(u,OZ),h=l||_.Fragment,p={};return MZ.forEach(function(v){p[v]=f[v],delete f[v]}),delete f.keys,_.createElement(h,f,s.map(function(v,g){var b=v.status,C=Qn(v,PZ),S=b===Lb||b===Ob;return _.createElement(e,Qt({},p,{key:C.key,visible:S,eventProps:C,onVisibleChanged:function(E){if(d==null||d(E,{key:C.key}),!E){var y=a.removeKey(C.key);y===0&&m&&m()}}}),function(E,y){return c($e($e({},E),{},{index:g}),y)})}))}}],[{key:"getDerivedStateFromProps",value:function(a,s){var u=a.keys,l=s.keyEntities,c=Mb(u),d=LZ(l,c);return{keyEntities:d.filter(function(m){var f=l.find(function(h){var p=h.key;return m.key===p});return!(f&&f.status===Kp&&m.status===Pb)})}}}]),o}(_.Component);return ut(n,"defaultProps",{component:"div"}),n}NZ(eN);const xZ=_.memo(function(t){var e=t.children;return e},function(t,e){var n=e.shouldUpdate;return!n});var rI={width:0,height:0,overflow:"hidden",outline:"none"},FZ=Se.forwardRef(function(t,e){var n=t.prefixCls,r=t.className,i=t.style,o=t.title,a=t.ariaId,s=t.footer,u=t.closable,l=t.closeIcon,c=t.onClose,d=t.children,m=t.bodyStyle,f=t.bodyProps,h=t.modalRender,p=t.onMouseDown,v=t.onMouseUp,g=t.holderRef,b=t.visible,C=t.forceRender,S=t.width,E=t.height,y=t.classNames,D=t.styles,R=Se.useContext(XM),I=R.panel,T=nd(g,I),P=_.useRef(),N=_.useRef();Se.useImperativeHandle(e,function(){return{focus:function(){var X;(X=P.current)===null||X===void 0||X.focus()},changeActive:function(X){var x=document,O=x.activeElement;X&&O===N.current?P.current.focus():!X&&O===P.current&&N.current.focus()}}});var B={};S!==void 0&&(B.width=S),E!==void 0&&(B.height=E);var W;s&&(W=Se.createElement("div",{className:Xt("".concat(n,"-footer"),y==null?void 0:y.footer),style:$e({},D==null?void 0:D.footer)},s));var G;o&&(G=Se.createElement("div",{className:Xt("".concat(n,"-header"),y==null?void 0:y.header),style:$e({},D==null?void 0:D.header)},Se.createElement("div",{className:"".concat(n,"-title"),id:a},o)));var Q;u&&(Q=Se.createElement("button",{type:"button",onClick:c,"aria-label":"Close",className:"".concat(n,"-close")},l||Se.createElement("span",{className:"".concat(n,"-close-x")})));var te=Se.createElement("div",{className:Xt("".concat(n,"-content"),y==null?void 0:y.content),style:D==null?void 0:D.content},Q,G,Se.createElement("div",Qt({className:Xt("".concat(n,"-body"),y==null?void 0:y.body),style:$e($e({},m),D==null?void 0:D.body)},f),d),W);return Se.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":o?a:null,"aria-modal":"true",ref:T,style:$e($e({},i),B),className:Xt(n,r),onMouseDown:p,onMouseUp:v},Se.createElement("div",{tabIndex:0,ref:P,style:rI,"aria-hidden":"true"}),Se.createElement(xZ,{shouldUpdate:b||C},h?h(te):te),Se.createElement("div",{tabIndex:0,ref:N,style:rI,"aria-hidden":"true"}))}),sN=_.forwardRef(function(t,e){var n=t.prefixCls,r=t.title,i=t.style,o=t.className,a=t.visible,s=t.forceRender,u=t.destroyOnClose,l=t.motionName,c=t.ariaId,d=t.onVisibleChanged,m=t.mousePosition,f=_.useRef(),h=_.useState(),p=Qe(h,2),v=p[0],g=p[1],b={};v&&(b.transformOrigin=v);function C(){var S=pZ(f.current);g(m?"".concat(m.x-S.left,"px ").concat(m.y-S.top,"px"):"")}return _.createElement(id,{visible:a,onVisibleChanged:d,onAppearPrepare:C,onEnterPrepare:C,forceRender:s,motionName:l,removeOnLeave:u,ref:f},function(S,E){var y=S.className,D=S.style;return _.createElement(FZ,Qt({},t,{ref:e,title:r,ariaId:c,prefixCls:n,holderRef:E,style:$e($e($e({},D),i),b),className:Xt(o,y)}))})});sN.displayName="Content";function $Z(t){var e=t.prefixCls,n=t.style,r=t.visible,i=t.maskProps,o=t.motionName,a=t.className;return _.createElement(id,{key:"mask",visible:r,motionName:o,leavedClassName:"".concat(e,"-mask-hidden")},function(s,u){var l=s.className,c=s.style;return _.createElement("div",Qt({ref:u,style:$e($e({},c),n),className:Xt("".concat(e,"-mask"),l,a)},i))})}function kZ(t){var e=t.prefixCls,n=e===void 0?"rc-dialog":e,r=t.zIndex,i=t.visible,o=i===void 0?!1:i,a=t.keyboard,s=a===void 0?!0:a,u=t.focusTriggerAfterClose,l=u===void 0?!0:u,c=t.wrapStyle,d=t.wrapClassName,m=t.wrapProps,f=t.onClose,h=t.afterOpenChange,p=t.afterClose,v=t.transitionName,g=t.animation,b=t.closable,C=b===void 0?!0:b,S=t.mask,E=S===void 0?!0:S,y=t.maskTransitionName,D=t.maskAnimation,R=t.maskClosable,I=R===void 0?!0:R,T=t.maskStyle,P=t.maskProps,N=t.rootClassName,B=t.classNames,W=t.styles,G=_.useRef(),Q=_.useRef(),te=_.useRef(),X=_.useState(o),x=Qe(X,2),O=x[0],M=x[1],V=qM();function q(){Tb(Q.current,document.activeElement)||(G.current=document.activeElement)}function ie(){if(!Tb(Q.current,document.activeElement)){var Te;(Te=te.current)===null||Te===void 0||Te.focus()}}function ce(Te){if(Te)ie();else{if(M(!1),E&&G.current&&l){try{G.current.focus({preventScroll:!0})}catch{}G.current=null}O&&(p==null||p())}h==null||h(Te)}function pe(Te){f==null||f(Te)}var oe=_.useRef(!1),he=_.useRef(),fe=function(){clearTimeout(he.current),oe.current=!0},ve=function(){he.current=setTimeout(function(){oe.current=!1})},Ue=null;I&&(Ue=function(Te){oe.current?oe.current=!1:Q.current===Te.target&&pe(Te)});function ke(Te){if(s&&Te.keyCode===lt.ESC){Te.stopPropagation(),pe(Te);return}o&&Te.keyCode===lt.TAB&&te.current.changeActive(!Te.shiftKey)}return _.useEffect(function(){o&&(M(!0),q())},[o]),_.useEffect(function(){return function(){clearTimeout(he.current)}},[]),_.createElement("div",Qt({className:Xt("".concat(n,"-root"),N)},Cm(t,{data:!0})),_.createElement($Z,{prefixCls:n,visible:E&&o,motionName:GR(n,y,D),style:$e($e({zIndex:r},T),W==null?void 0:W.mask),maskProps:P,className:B==null?void 0:B.mask}),_.createElement("div",Qt({tabIndex:-1,onKeyDown:ke,className:Xt("".concat(n,"-wrap"),d,B==null?void 0:B.wrapper),ref:Q,onClick:Ue,style:$e($e($e({zIndex:r},c),W==null?void 0:W.wrapper),{},{display:O?null:"none"})},m),_.createElement(sN,Qt({},t,{onMouseDown:fe,onMouseUp:ve,ref:te,closable:C,ariaId:V,prefixCls:n,visible:o&&O,onClose:pe,onVisibleChanged:ce,motionName:GR(n,v,g)}))))}var uN=function(t){var e=t.visible,n=t.getContainer,r=t.forceRender,i=t.destroyOnClose,o=i===void 0?!1:i,a=t.afterClose,s=t.panelRef,u=_.useState(e),l=Qe(u,2),c=l[0],d=l[1],m=_.useMemo(function(){return{panel:s}},[s]);return _.useEffect(function(){e&&d(!0)},[e]),!r&&o&&!c?null:_.createElement(XM.Provider,{value:m},_.createElement(jS,{open:e||r||c,autoDestroy:!1,getContainer:n,autoLock:e||c},_.createElement(kZ,Qt({},t,{destroyOnClose:o,afterClose:function(){a==null||a(),d(!1)}}))))};uN.displayName="Dialog";var x5={exports:{}},lN={},cN={exports:{}},BZ="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",UZ=BZ,VZ=UZ;function dN(){}function mN(){}mN.resetWarningCache=dN;var HZ=function(){function t(r,i,o,a,s,u){if(u!==VZ){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:mN,resetWarningCache:dN};return n.PropTypes=n,n};cN.exports=HZ();var fN=cN.exports,Jr={},_1={};Object.defineProperty(_1,"__esModule",{value:!0});_1.dontSetMe=XZ;_1.findInArray=jZ;_1.int=YZ;_1.isFunction=zZ;_1.isNum=WZ;function jZ(t,e){for(let n=0,r=t.length;n<r;n++)if(e.apply(e,[t[n],n,t]))return t[n]}function zZ(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function WZ(t){return typeof t=="number"&&!isNaN(t)}function YZ(t){return parseInt(t,10)}function XZ(t,e,n){if(t[e])return new Error("Invalid prop ".concat(e," passed to ").concat(n," - do not set this, set it on the child."))}var Wc={};Object.defineProperty(Wc,"__esModule",{value:!0});Wc.browserPrefixToKey=pN;Wc.browserPrefixToStyle=qZ;Wc.default=void 0;Wc.getPrefix=hN;const Zp=["Moz","Webkit","O","ms"];function hN(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const n=(t=window.document)===null||t===void 0||(t=t.documentElement)===null||t===void 0?void 0:t.style;if(!n||e in n)return"";for(let r=0;r<Zp.length;r++)if(pN(e,Zp[r])in n)return Zp[r];return""}function pN(t,e){return e?"".concat(e).concat(GZ(t)):t}function qZ(t,e){return e?"-".concat(e.toLowerCase(),"-").concat(t):t}function GZ(t){let e="",n=!0;for(let r=0;r<t.length;r++)n?(e+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:e+=t[r];return e}Wc.default=hN();Object.defineProperty(Jr,"__esModule",{value:!0});Jr.addClassName=bN;Jr.addEvent=QZ;Jr.addUserSelectStyles=lQ;Jr.createCSSTransform=oQ;Jr.createSVGTransform=aQ;Jr.getTouch=sQ;Jr.getTouchIdentifier=uQ;Jr.getTranslation=YS;Jr.innerHeight=nQ;Jr.innerWidth=rQ;Jr.matchesSelector=vN;Jr.matchesSelectorAndParentsTo=ZZ;Jr.offsetXYFromParent=iQ;Jr.outerHeight=eQ;Jr.outerWidth=tQ;Jr.removeClassName=_N;Jr.removeEvent=JZ;Jr.removeUserSelectStyles=cQ;var fa=_1,iI=KZ(Wc);function gN(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(gN=function(r){return r?n:e})(t)}function KZ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=gN(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}let R3="";function vN(t,e){return R3||(R3=(0,fa.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,fa.isFunction)(t[n])})),(0,fa.isFunction)(t[R3])?t[R3](e):!1}function ZZ(t,e,n){let r=t;do{if(vN(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function QZ(t,e,n,r){if(!t)return;const i={capture:!0,...r};t.addEventListener?t.addEventListener(e,n,i):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}function JZ(t,e,n,r){if(!t)return;const i={capture:!0,...r};t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}function eQ(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,fa.int)(n.borderTopWidth),e+=(0,fa.int)(n.borderBottomWidth),e}function tQ(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,fa.int)(n.borderLeftWidth),e+=(0,fa.int)(n.borderRightWidth),e}function nQ(t){let e=t.clientHeight;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,fa.int)(n.paddingTop),e-=(0,fa.int)(n.paddingBottom),e}function rQ(t){let e=t.clientWidth;const n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,fa.int)(n.paddingLeft),e-=(0,fa.int)(n.paddingRight),e}function iQ(t,e,n){const r=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),i=(t.clientX+e.scrollLeft-r.left)/n,o=(t.clientY+e.scrollTop-r.top)/n;return{x:i,y:o}}function oQ(t,e){const n=YS(t,e,"px");return{[(0,iI.browserPrefixToKey)("transform",iI.default)]:n}}function aQ(t,e){return YS(t,e,"")}function YS(t,e,n){let{x:r,y:i}=t,o="translate(".concat(r).concat(n,",").concat(i).concat(n,")");if(e){const a="".concat(typeof e.x=="string"?e.x:e.x+n),s="".concat(typeof e.y=="string"?e.y:e.y+n);o="translate(".concat(a,", ").concat(s,")")+o}return o}function sQ(t,e){return t.targetTouches&&(0,fa.findInArray)(t.targetTouches,n=>e===n.identifier)||t.changedTouches&&(0,fa.findInArray)(t.changedTouches,n=>e===n.identifier)}function uQ(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function lQ(t){if(!t)return;let e=t.getElementById("react-draggable-style-el");e||(e=t.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(e)),t.body&&bN(t.body,"react-draggable-transparent-selection")}function cQ(t){if(t)try{if(t.body&&_N(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{const e=(t.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function bN(t,e){t.classList?t.classList.add(e):t.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(t.className+=" ".concat(e))}function _N(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var C1={};Object.defineProperty(C1,"__esModule",{value:!0});C1.canDragX=fQ;C1.canDragY=hQ;C1.createCoreData=gQ;C1.createDraggableData=vQ;C1.getBoundPosition=dQ;C1.getControlPosition=pQ;C1.snapToGrid=mQ;var ra=_1,e0=Jr;function dQ(t,e,n){if(!t.props.bounds)return[e,n];let{bounds:r}=t.props;r=typeof r=="string"?r:bQ(r);const i=XS(t);if(typeof r=="string"){const{ownerDocument:o}=i,a=o.defaultView;let s;if(r==="parent"?s=i.parentNode:s=o.querySelector(r),!(s instanceof a.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const u=s,l=a.getComputedStyle(i),c=a.getComputedStyle(u);r={left:-i.offsetLeft+(0,ra.int)(c.paddingLeft)+(0,ra.int)(l.marginLeft),top:-i.offsetTop+(0,ra.int)(c.paddingTop)+(0,ra.int)(l.marginTop),right:(0,e0.innerWidth)(u)-(0,e0.outerWidth)(i)-i.offsetLeft+(0,ra.int)(c.paddingRight)-(0,ra.int)(l.marginRight),bottom:(0,e0.innerHeight)(u)-(0,e0.outerHeight)(i)-i.offsetTop+(0,ra.int)(c.paddingBottom)-(0,ra.int)(l.marginBottom)}}return(0,ra.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,ra.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,ra.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,ra.isNum)(r.top)&&(n=Math.max(n,r.top)),[e,n]}function mQ(t,e,n){const r=Math.round(e/t[0])*t[0],i=Math.round(n/t[1])*t[1];return[r,i]}function fQ(t){return t.props.axis==="both"||t.props.axis==="x"}function hQ(t){return t.props.axis==="both"||t.props.axis==="y"}function pQ(t,e,n){const r=typeof e=="number"?(0,e0.getTouch)(t,e):null;if(typeof e=="number"&&!r)return null;const i=XS(n),o=n.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,e0.offsetXYFromParent)(r||t,o,n.props.scale)}function gQ(t,e,n){const r=!(0,ra.isNum)(t.lastX),i=XS(t);return r?{node:i,deltaX:0,deltaY:0,lastX:e,lastY:n,x:e,y:n}:{node:i,deltaX:e-t.lastX,deltaY:n-t.lastY,lastX:t.lastX,lastY:t.lastY,x:e,y:n}}function vQ(t,e){const n=t.props.scale;return{node:e.node,x:t.state.x+e.deltaX/n,y:t.state.y+e.deltaY/n,deltaX:e.deltaX/n,deltaY:e.deltaY/n,lastX:t.state.x,lastY:t.state.y}}function bQ(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function XS(t){const e=t.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var F5={},$5={};Object.defineProperty($5,"__esModule",{value:!0});$5.default=_Q;function _Q(){}Object.defineProperty(F5,"__esModule",{value:!0});F5.default=void 0;var Qp=SQ(Se),Po=qS(fN),CQ=qS(o1),Gi=Jr,vu=C1,Jp=_1,xd=qS($5);function qS(t){return t&&t.__esModule?t:{default:t}}function CN(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(CN=function(r){return r?n:e})(t)}function SQ(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=CN(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}function co(t,e,n){return e=EQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EQ(t){var e=yQ(t,"string");return typeof e=="symbol"?e:String(e)}function yQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const as={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let bu=as.mouse,k5=class extends Qp.Component{constructor(){super(...arguments),co(this,"dragging",!1),co(this,"lastX",NaN),co(this,"lastY",NaN),co(this,"touchIdentifier",null),co(this,"mounted",!1),co(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const n=this.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=n;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,Gi.matchesSelectorAndParentsTo)(e.target,this.props.handle,n)||this.props.cancel&&(0,Gi.matchesSelectorAndParentsTo)(e.target,this.props.cancel,n))return;e.type==="touchstart"&&e.preventDefault();const i=(0,Gi.getTouchIdentifier)(e);this.touchIdentifier=i;const o=(0,vu.getControlPosition)(e,i,this);if(o==null)return;const{x:a,y:s}=o,u=(0,vu.createCoreData)(this,a,s);(0,xd.default)("DraggableCore: handleDragStart: %j",u),(0,xd.default)("calling",this.props.onStart),!(this.props.onStart(e,u)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,Gi.addUserSelectStyles)(r),this.dragging=!0,this.lastX=a,this.lastY=s,(0,Gi.addEvent)(r,bu.move,this.handleDrag),(0,Gi.addEvent)(r,bu.stop,this.handleDragStop))}),co(this,"handleDrag",e=>{const n=(0,vu.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:i}=n;if(Array.isArray(this.props.grid)){let a=r-this.lastX,s=i-this.lastY;if([a,s]=(0,vu.snapToGrid)(this.props.grid,a,s),!a&&!s)return;r=this.lastX+a,i=this.lastY+s}const o=(0,vu.createCoreData)(this,r,i);if((0,xd.default)("DraggableCore: handleDrag: %j",o),this.props.onDrag(e,o)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const a=document.createEvent("MouseEvents");a.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(a)}return}this.lastX=r,this.lastY=i}),co(this,"handleDragStop",e=>{if(!this.dragging)return;const n=(0,vu.getControlPosition)(e,this.touchIdentifier,this);if(n==null)return;let{x:r,y:i}=n;if(Array.isArray(this.props.grid)){let s=r-this.lastX||0,u=i-this.lastY||0;[s,u]=(0,vu.snapToGrid)(this.props.grid,s,u),r=this.lastX+s,i=this.lastY+u}const o=(0,vu.createCoreData)(this,r,i);if(this.props.onStop(e,o)===!1||this.mounted===!1)return!1;const a=this.findDOMNode();a&&this.props.enableUserSelectHack&&(0,Gi.removeUserSelectStyles)(a.ownerDocument),(0,xd.default)("DraggableCore: handleDragStop: %j",o),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,a&&((0,xd.default)("DraggableCore: Removing handlers"),(0,Gi.removeEvent)(a.ownerDocument,bu.move,this.handleDrag),(0,Gi.removeEvent)(a.ownerDocument,bu.stop,this.handleDragStop))}),co(this,"onMouseDown",e=>(bu=as.mouse,this.handleDragStart(e))),co(this,"onMouseUp",e=>(bu=as.mouse,this.handleDragStop(e))),co(this,"onTouchStart",e=>(bu=as.touch,this.handleDragStart(e))),co(this,"onTouchEnd",e=>(bu=as.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,Gi.addEvent)(e,as.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:n}=e;(0,Gi.removeEvent)(n,as.mouse.move,this.handleDrag),(0,Gi.removeEvent)(n,as.touch.move,this.handleDrag),(0,Gi.removeEvent)(n,as.mouse.stop,this.handleDragStop),(0,Gi.removeEvent)(n,as.touch.stop,this.handleDragStop),(0,Gi.removeEvent)(e,as.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Gi.removeUserSelectStyles)(n)}}findDOMNode(){var e,n;return(e=this.props)!==null&&e!==void 0&&e.nodeRef?(n=this.props)===null||n===void 0||(n=n.nodeRef)===null||n===void 0?void 0:n.current:CQ.default.findDOMNode(this)}render(){return Qp.cloneElement(Qp.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};F5.default=k5;co(k5,"displayName","DraggableCore");co(k5,"propTypes",{allowAnyClick:Po.default.bool,children:Po.default.node.isRequired,disabled:Po.default.bool,enableUserSelectHack:Po.default.bool,offsetParent:function(t,e){if(t[e]&&t[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Po.default.arrayOf(Po.default.number),handle:Po.default.string,cancel:Po.default.string,nodeRef:Po.default.object,onStart:Po.default.func,onDrag:Po.default.func,onStop:Po.default.func,onMouseDown:Po.default.func,scale:Po.default.number,className:Jp.dontSetMe,style:Jp.dontSetMe,transform:Jp.dontSetMe});co(k5,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var e=m(Se),n=c(fN),r=c(o1),i=c(Ci),o=Jr,a=C1,s=_1,u=c(F5),l=c($5);function c(b){return b&&b.__esModule?b:{default:b}}function d(b){if(typeof WeakMap!="function")return null;var C=new WeakMap,S=new WeakMap;return(d=function(E){return E?S:C})(b)}function m(b,C){if(!C&&b&&b.__esModule)return b;if(b===null||typeof b!="object"&&typeof b!="function")return{default:b};var S=d(C);if(S&&S.has(b))return S.get(b);var E={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in b)if(D!=="default"&&Object.prototype.hasOwnProperty.call(b,D)){var R=y?Object.getOwnPropertyDescriptor(b,D):null;R&&(R.get||R.set)?Object.defineProperty(E,D,R):E[D]=b[D]}return E.default=b,S&&S.set(b,E),E}function f(){return f=Object.assign?Object.assign.bind():function(b){for(var C=1;C<arguments.length;C++){var S=arguments[C];for(var E in S)Object.prototype.hasOwnProperty.call(S,E)&&(b[E]=S[E])}return b},f.apply(this,arguments)}function h(b,C,S){return C=p(C),C in b?Object.defineProperty(b,C,{value:S,enumerable:!0,configurable:!0,writable:!0}):b[C]=S,b}function p(b){var C=v(b,"string");return typeof C=="symbol"?C:String(C)}function v(b,C){if(typeof b!="object"||b===null)return b;var S=b[Symbol.toPrimitive];if(S!==void 0){var E=S.call(b,C||"default");if(typeof E!="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return(C==="string"?String:Number)(b)}class g extends e.Component{static getDerivedStateFromProps(C,S){let{position:E}=C,{prevPropsPosition:y}=S;return E&&(!y||E.x!==y.x||E.y!==y.y)?((0,l.default)("Draggable: getDerivedStateFromProps %j",{position:E,prevPropsPosition:y}),{x:E.x,y:E.y,prevPropsPosition:{...E}}):null}constructor(C){super(C),h(this,"onDragStart",(S,E)=>{if((0,l.default)("Draggable: onDragStart: %j",E),this.props.onStart(S,(0,a.createDraggableData)(this,E))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),h(this,"onDrag",(S,E)=>{if(!this.state.dragging)return!1;(0,l.default)("Draggable: onDrag: %j",E);const y=(0,a.createDraggableData)(this,E),D={x:y.x,y:y.y,slackX:0,slackY:0};if(this.props.bounds){const{x:R,y:I}=D;D.x+=this.state.slackX,D.y+=this.state.slackY;const[T,P]=(0,a.getBoundPosition)(this,D.x,D.y);D.x=T,D.y=P,D.slackX=this.state.slackX+(R-D.x),D.slackY=this.state.slackY+(I-D.y),y.x=D.x,y.y=D.y,y.deltaX=D.x-this.state.x,y.deltaY=D.y-this.state.y}if(this.props.onDrag(S,y)===!1)return!1;this.setState(D)}),h(this,"onDragStop",(S,E)=>{if(!this.state.dragging||this.props.onStop(S,(0,a.createDraggableData)(this,E))===!1)return!1;(0,l.default)("Draggable: onDragStop: %j",E);const y={dragging:!1,slackX:0,slackY:0};if(this.props.position){const{x:D,y:R}=this.props.position;y.x=D,y.y=R}this.setState(y)}),this.state={dragging:!1,dragged:!1,x:C.position?C.position.x:C.defaultPosition.x,y:C.position?C.position.y:C.defaultPosition.y,prevPropsPosition:{...C.position},slackX:0,slackY:0,isElementSVG:!1},C.position&&!(C.onDrag||C.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var C,S;return(C=(S=this.props)===null||S===void 0||(S=S.nodeRef)===null||S===void 0?void 0:S.current)!==null&&C!==void 0?C:r.default.findDOMNode(this)}render(){const{axis:C,bounds:S,children:E,defaultPosition:y,defaultClassName:D,defaultClassNameDragging:R,defaultClassNameDragged:I,position:T,positionOffset:P,scale:N,...B}=this.props;let W={},G=null;const Q=!T||this.state.dragging,te=T||y,X={x:(0,a.canDragX)(this)&&Q?this.state.x:te.x,y:(0,a.canDragY)(this)&&Q?this.state.y:te.y};this.state.isElementSVG?G=(0,o.createSVGTransform)(X,P):W=(0,o.createCSSTransform)(X,P);const x=(0,i.default)(E.props.className||"",D,{[R]:this.state.dragging,[I]:this.state.dragged});return e.createElement(u.default,f({},B,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(E),{className:x,style:{...E.props.style,...W},transform:G}))}}t.default=g,h(g,"displayName","Draggable"),h(g,"propTypes",{...u.default.propTypes,axis:n.default.oneOf(["both","x","y","none"]),bounds:n.default.oneOfType([n.default.shape({left:n.default.number,right:n.default.number,top:n.default.number,bottom:n.default.number}),n.default.string,n.default.oneOf([!1])]),defaultClassName:n.default.string,defaultClassNameDragging:n.default.string,defaultClassNameDragged:n.default.string,defaultPosition:n.default.shape({x:n.default.number,y:n.default.number}),positionOffset:n.default.shape({x:n.default.oneOfType([n.default.number,n.default.string]),y:n.default.oneOfType([n.default.number,n.default.string])}),position:n.default.shape({x:n.default.number,y:n.default.number}),className:s.dontSetMe,style:s.dontSetMe,transform:s.dontSetMe}),h(g,"defaultProps",{...u.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(lN);const{default:SN,DraggableCore:DQ}=lN;x5.exports=SN;x5.exports.default=SN;x5.exports.DraggableCore=DQ;var RQ=x5.exports;const IQ=OM(RQ),AQ="univer-dialog",TQ="univer-dialog-wrap",wQ="univer-dialog-title",LQ="univer-dialog-content",OQ="univer-dialog-close",PQ="univer-dialog-header",MQ="univer-dialog-body",NQ="univer-dialog-footer",xQ="univer-dialog-zoom-enter",FQ="univer-dialog-zoom-appear",$Q="univer-dialog-zoom-leave",kQ="univer-dialog-zoom-enter-active",BQ="univer-dialog-zoom-appear-active",UQ="univer-dialog-zoom-in",VQ="univer-dialog-zoom-leave-active",HQ="univer-dialog-zoom-out",jQ="univer-dialog-mask",zQ="univer-dialog-mask-hidden",WQ="univer-dialog-fade-enter",YQ="univer-dialog-fade-appear",XQ="univer-dialog-fade-leave",qQ="univer-dialog-fade-enter-active",GQ="univer-dialog-fade-appear-active",KQ="univer-dialog-fade-in",ZQ="univer-dialog-fade-leave-active",QQ="univer-dialog-fade-out",JQ="univer-dialog-root-draggable",eg={dialog:AQ,dialogWrap:TQ,dialogTitle:wQ,dialogContent:LQ,dialogClose:OQ,dialogHeader:PQ,dialogBody:MQ,dialogFooter:NQ,dialogZoomEnter:xQ,dialogZoomAppear:FQ,dialogZoomLeave:$Q,dialogZoomEnterActive:kQ,dialogZoomAppearActive:BQ,dialogZoomIn:UQ,dialogZoomLeaveActive:VQ,dialogZoomOut:HQ,dialogMask:jQ,dialogMaskHidden:zQ,dialogFadeEnter:WQ,dialogFadeAppear:YQ,dialogFadeLeave:XQ,dialogFadeEnterActive:qQ,dialogFadeAppearActive:GQ,dialogFadeIn:KQ,dialogFadeLeaveActive:ZQ,dialogFadeOut:QQ,dialogRootDraggable:JQ};function EN(t){const{children:e,style:n,visible:r=!1,title:i,width:o,draggable:a=!1,closeIcon:s=Se.createElement(vM,null),destroyOnClose:u=!1,footer:l,onClose:c}=t,[d,m]=_.useState(!1),{mountContainer:f}=_.useContext(su),h=a?Se.createElement("div",{style:{width:"100%",cursor:"pointer"},onMouseOver:()=>{d&&m(!1)},onMouseOut:()=>{m(!0)},onFocus:()=>{},onBlur:()=>{}},i):i,p=v=>a?Se.createElement(IQ,{disabled:d},v):v;return Se.createElement(uN,{width:o,prefixCls:eg.dialog,rootClassName:a?eg.dialogRootDraggable:eg.dialogRoot,getContainer:()=>f,visible:r,title:h,modalRender:p,closeIcon:s,destroyOnClose:u,footer:l,mask:!a,style:n,onClose:c},e)}const eJ="univer-confirm-footer",tJ={confirmFooter:eJ};function nJ(t){const{children:e,visible:n=!1,title:r,cancelText:i,confirmText:o,onClose:a,onConfirm:s}=t,{locale:u}=_.useContext(su);function l(){return Se.createElement("footer",{className:tJ.confirmFooter},Se.createElement(X1,{onClick:a},i??u.design.Confirm.cancel),Se.createElement(X1,{type:"primary",onClick:s},o??u.design.Confirm.confirm))}return Se.createElement(EN,{visible:n,title:r,footer:Se.createElement(l,null),onClose:a},e)}_.forwardRef((t,e)=>{const{children:n,className:r,style:i,onClick:o,onContextMenu:a}=t;return Se.createElement("section",{ref:e,className:r,style:i,onClick:o,onContextMenu:a},n)});function Sm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];return Se.Children.forEach(t,function(r){r==null&&!e.keepEmpty||(Array.isArray(r)?n=n.concat(Sm(r)):L4.isFragment(r)&&r.props?n=n.concat(Sm(r.props.children,e)):n.push(r))}),n}var Nb=_.createContext(null);function rJ(t){var e=t.children,n=t.onBatchResize,r=_.useRef(0),i=_.useRef([]),o=_.useContext(Nb),a=_.useCallback(function(s,u,l){r.current+=1;var c=r.current;i.current.push({size:s,element:u,data:l}),Promise.resolve().then(function(){c===r.current&&(n==null||n(i.current),i.current=[])}),o==null||o(s,u,l)},[n,o]);return _.createElement(Nb.Provider,{value:a},e)}var yN=function(){if(typeof Map<"u")return Map;function t(e,n){var r=-1;return e.some(function(i,o){return i[0]===n?(r=o,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var r=t(this.__entries__,n),i=this.__entries__[r];return i&&i[1]},e.prototype.set=function(n,r){var i=t(this.__entries__,n);~i?this.__entries__[i][1]=r:this.__entries__.push([n,r])},e.prototype.delete=function(n){var r=this.__entries__,i=t(r,n);~i&&r.splice(i,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var i=0,o=this.__entries__;i<o.length;i++){var a=o[i];n.call(r,a[1],a[0])}},e}()}(),xb=typeof window<"u"&&typeof document<"u"&&window.document===document,o9=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),iJ=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(o9):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),oJ=2;function aJ(t,e){var n=!1,r=!1,i=0;function o(){n&&(n=!1,t()),r&&s()}function a(){iJ(o)}function s(){var u=Date.now();if(n){if(u-i<oJ)return;r=!0}else n=!0,r=!1,setTimeout(a,e);i=u}return s}var sJ=20,uJ=["top","right","bottom","left","width","height","size","weight"],lJ=typeof MutationObserver<"u",cJ=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=aJ(this.refresh.bind(this),sJ)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,r=n.indexOf(e);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!xb||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),lJ?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!xb||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,r=n===void 0?"":n,i=uJ.some(function(o){return!!~r.indexOf(o)});i&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),DN=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},O0=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||o9},RN=B5(0,0,0,0);function a9(t){return parseFloat(t)||0}function oI(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(r,i){var o=t["border-"+i+"-width"];return r+a9(o)},0)}function dJ(t){for(var e=["top","right","bottom","left"],n={},r=0,i=e;r<i.length;r++){var o=i[r],a=t["padding-"+o];n[o]=a9(a)}return n}function mJ(t){var e=t.getBBox();return B5(0,0,e.width,e.height)}function fJ(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return RN;var r=O0(t).getComputedStyle(t),i=dJ(r),o=i.left+i.right,a=i.top+i.bottom,s=a9(r.width),u=a9(r.height);if(r.boxSizing==="border-box"&&(Math.round(s+o)!==e&&(s-=oI(r,"left","right")+o),Math.round(u+a)!==n&&(u-=oI(r,"top","bottom")+a)),!pJ(t)){var l=Math.round(s+o)-e,c=Math.round(u+a)-n;Math.abs(l)!==1&&(s-=l),Math.abs(c)!==1&&(u-=c)}return B5(i.left,i.top,s,u)}var hJ=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof O0(t).SVGGraphicsElement}:function(t){return t instanceof O0(t).SVGElement&&typeof t.getBBox=="function"}}();function pJ(t){return t===O0(t).document.documentElement}function gJ(t){return xb?hJ(t)?mJ(t):fJ(t):RN}function vJ(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return DN(a,{x:e,y:n,width:r,height:i,top:n,right:e+r,bottom:i+n,left:e}),a}function B5(t,e,n,r){return{x:t,y:e,width:n,height:r}}var bJ=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=B5(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=gJ(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),_J=function(){function t(e,n){var r=vJ(n);DN(this,{target:e,contentRect:r})}return t}(),CJ=function(){function t(e,n,r){if(this.activeObservations_=[],this.observations_=new yN,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof O0(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new bJ(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof O0(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new _J(r.target,r.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),IN=typeof WeakMap<"u"?new WeakMap:new yN,AN=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=cJ.getInstance(),r=new CJ(e,n,this);IN.set(this,r)}return t}();["observe","unobserve","disconnect"].forEach(function(t){AN.prototype[t]=function(){var e;return(e=IN.get(this))[t].apply(e,arguments)}});var SJ=function(){return typeof o9.ResizeObserver<"u"?o9.ResizeObserver:AN}(),$u=new Map;function EJ(t){t.forEach(function(e){var n,r=e.target;(n=$u.get(r))===null||n===void 0||n.forEach(function(i){return i(r)})})}var TN=new SJ(EJ);function yJ(t,e){$u.has(t)||($u.set(t,new Set),TN.observe(t)),$u.get(t).add(e)}function DJ(t,e){$u.has(t)&&($u.get(t).delete(e),$u.get(t).size||(TN.unobserve(t),$u.delete(t)))}var RJ=function(t){tf(n,t);var e=nf(n);function n(){return Al(this,n),e.apply(this,arguments)}return Tl(n,[{key:"render",value:function(){return this.props.children}}]),n}(_.Component);function IJ(t,e){var n=t.children,r=t.disabled,i=_.useRef(null),o=_.useRef(null),a=_.useContext(Nb),s=typeof n=="function",u=s?n(i):n,l=_.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),c=!s&&_.isValidElement(u)&&rd(u),d=c?u.ref:null,m=nd(d,i),f=function(){var v;return B6(i.current)||(i.current&&Pr(i.current)==="object"?B6((v=i.current)===null||v===void 0?void 0:v.nativeElement):null)||B6(o.current)};_.useImperativeHandle(e,function(){return f()});var h=_.useRef(t);h.current=t;var p=_.useCallback(function(v){var g=h.current,b=g.onResize,C=g.data,S=v.getBoundingClientRect(),E=S.width,y=S.height,D=v.offsetWidth,R=v.offsetHeight,I=Math.floor(E),T=Math.floor(y);if(l.current.width!==I||l.current.height!==T||l.current.offsetWidth!==D||l.current.offsetHeight!==R){var P={width:I,height:T,offsetWidth:D,offsetHeight:R};l.current=P;var N=D===Math.round(E)?E:D,B=R===Math.round(y)?y:R,W=$e($e({},P),{},{offsetWidth:N,offsetHeight:B});a==null||a(W,v,C),b&&Promise.resolve().then(function(){b(W,v)})}},[]);return _.useEffect(function(){var v=f();return v&&!r&&yJ(v,p),function(){return DJ(v,p)}},[i.current,r]),_.createElement(RJ,{ref:o},c?_.cloneElement(u,{ref:m}):u)}var AJ=_.forwardRef(IJ),TJ="rc-observer-key";function wJ(t,e){var n=t.children,r=typeof n=="function"?[n]:Sm(n);return r.map(function(i,o){var a=(i==null?void 0:i.key)||"".concat(TJ,"-").concat(o);return _.createElement(AJ,Qt({},t,{key:a,ref:o===0?e:void 0}),i)})}var Yc=_.forwardRef(wJ);Yc.Collection=rJ;function wN(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}function LJ(t){return wN(t)instanceof ShadowRoot}function Fb(t){return LJ(t)?wN(t):null}function Na(t){var e=_.useRef();e.current=t;var n=_.useCallback(function(){for(var r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(o))},[]);return n}const GS=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t==null?void 0:t.substr(0,4))};function OJ(t){var e=t.prefixCls,n=t.align,r=t.arrow,i=t.arrowPos,o=r||{},a=o.className,s=o.content,u=i.x,l=u===void 0?0:u,c=i.y,d=c===void 0?0:c,m=_.useRef();if(!n||!n.points)return null;var f={position:"absolute"};if(n.autoArrow!==!1){var h=n.points[0],p=n.points[1],v=h[0],g=h[1],b=p[0],C=p[1];v===b||!["t","b"].includes(v)?f.top=d:v==="t"?f.top=0:f.bottom=0,g===C||!["l","r"].includes(g)?f.left=l:g==="l"?f.left=0:f.right=0}return _.createElement("div",{ref:m,className:Xt("".concat(e,"-arrow"),a),style:f},s)}function PJ(t){var e=t.prefixCls,n=t.open,r=t.zIndex,i=t.mask,o=t.motion;return i?_.createElement(id,Qt({},o,{motionAppear:!0,visible:n,removeOnLeave:!0}),function(a){var s=a.className;return _.createElement("div",{style:{zIndex:r},className:Xt("".concat(e,"-mask"),s)})}):null}var MJ=_.memo(function(t){var e=t.children;return e},function(t,e){return e.cache}),NJ=_.forwardRef(function(t,e){var n=t.popup,r=t.className,i=t.prefixCls,o=t.style,a=t.target,s=t.onVisibleChanged,u=t.open,l=t.keepDom,c=t.fresh,d=t.onClick,m=t.mask,f=t.arrow,h=t.arrowPos,p=t.align,v=t.motion,g=t.maskMotion,b=t.forceRender,C=t.getPopupContainer,S=t.autoDestroy,E=t.portal,y=t.zIndex,D=t.onMouseEnter,R=t.onMouseLeave,I=t.onPointerEnter,T=t.ready,P=t.offsetX,N=t.offsetY,B=t.offsetR,W=t.offsetB,G=t.onAlign,Q=t.onPrepare,te=t.stretch,X=t.targetWidth,x=t.targetHeight,O=typeof n=="function"?n():n,M=u||l,V=(C==null?void 0:C.length)>0,q=_.useState(!C||!V),ie=Qe(q,2),ce=ie[0],pe=ie[1];if(Kr(function(){!ce&&V&&a&&pe(!0)},[ce,V,a]),!ce)return null;var oe="auto",he={left:"-1000vw",top:"-1000vh",right:oe,bottom:oe};if(T||!u){var fe,ve=p.points,Ue=p.dynamicInset||((fe=p._experimental)===null||fe===void 0?void 0:fe.dynamicInset),ke=Ue&&ve[0][1]==="r",Te=Ue&&ve[0][0]==="b";ke?(he.right=B,he.left=oe):(he.left=P,he.right=oe),Te?(he.bottom=W,he.top=oe):(he.top=N,he.bottom=oe)}var Re={};return te&&(te.includes("height")&&x?Re.height=x:te.includes("minHeight")&&x&&(Re.minHeight=x),te.includes("width")&&X?Re.width=X:te.includes("minWidth")&&X&&(Re.minWidth=X)),u||(Re.pointerEvents="none"),_.createElement(E,{open:b||M,getContainer:C&&function(){return C(a)},autoDestroy:S},_.createElement(PJ,{prefixCls:i,open:u,zIndex:y,mask:m,motion:g}),_.createElement(Yc,{onResize:G,disabled:!u},function(rt){return _.createElement(id,Qt({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:b,leavedClassName:"".concat(i,"-hidden")},v,{onAppearPrepare:Q,onEnterPrepare:Q,visible:u,onVisibleChanged:function(_t){var mt;v==null||(mt=v.onVisibleChanged)===null||mt===void 0||mt.call(v,_t),s(_t)}}),function(_t,mt){var nt=_t.className,_e=_t.style,He=Xt(i,nt,r);return _.createElement("div",{ref:zc(rt,e,mt),className:He,style:$e($e($e($e({"--arrow-x":"".concat(h.x||0,"px"),"--arrow-y":"".concat(h.y||0,"px")},he),Re),_e),{},{boxSizing:"border-box",zIndex:y},o),onMouseEnter:D,onMouseLeave:R,onPointerEnter:I,onClick:d},f&&_.createElement(OJ,{prefixCls:i,arrow:f,arrowPos:h,align:p}),_.createElement(MJ,{cache:!u&&!c},O))})}))}),xJ=_.forwardRef(function(t,e){var n=t.children,r=t.getTriggerDOMNode,i=rd(n),o=_.useCallback(function(s){VS(e,r?r(s):s)},[r]),a=nd(o,n.ref);return i?_.cloneElement(n,{ref:a}):n}),aI=_.createContext(null);function sI(t){return t?Array.isArray(t)?t:[t]:[]}function FJ(t,e,n,r){return _.useMemo(function(){var i=sI(n??e),o=sI(r??e),a=new Set(i),s=new Set(o);return t&&(a.has("hover")&&(a.delete("hover"),a.add("click")),s.has("hover")&&(s.delete("hover"),s.add("click"))),[a,s]},[t,e,n,r])}const LN=function(t){if(!t)return!1;if(t instanceof Element){if(t.offsetParent)return!0;if(t.getBBox){var e=t.getBBox(),n=e.width,r=e.height;if(n||r)return!0}if(t.getBoundingClientRect){var i=t.getBoundingClientRect(),o=i.width,a=i.height;if(o||a)return!0}}return!1};function $J(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return n?t[0]===e[0]:t[0]===e[0]&&t[1]===e[1]}function kJ(t,e,n,r){for(var i=n.points,o=Object.keys(t),a=0;a<o.length;a+=1){var s,u=o[a];if($J((s=t[u])===null||s===void 0?void 0:s.points,i,r))return"".concat(e,"-placement-").concat(u)}return""}function uI(t,e,n,r){return e||(n?{motionName:"".concat(t,"-").concat(n)}:r?{motionName:r}:null)}function rf(t){return t.ownerDocument.defaultView}function $b(t){for(var e=[],n=t==null?void 0:t.parentElement,r=["hidden","scroll","clip","auto"];n;){var i=rf(n).getComputedStyle(n),o=i.overflowX,a=i.overflowY,s=i.overflow;[o,a,s].some(function(u){return r.includes(u)})&&e.push(n),n=n.parentElement}return e}function Em(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(t)?e:t}function Fd(t){return Em(parseFloat(t),0)}function lI(t,e){var n=$e({},t);return(e||[]).forEach(function(r){if(!(r instanceof HTMLBodyElement||r instanceof HTMLHtmlElement)){var i=rf(r).getComputedStyle(r),o=i.overflow,a=i.overflowClipMargin,s=i.borderTopWidth,u=i.borderBottomWidth,l=i.borderLeftWidth,c=i.borderRightWidth,d=r.getBoundingClientRect(),m=r.offsetHeight,f=r.clientHeight,h=r.offsetWidth,p=r.clientWidth,v=Fd(s),g=Fd(u),b=Fd(l),C=Fd(c),S=Em(Math.round(d.width/h*1e3)/1e3),E=Em(Math.round(d.height/m*1e3)/1e3),y=(h-p-b-C)*S,D=(m-f-v-g)*E,R=v*E,I=g*E,T=b*S,P=C*S,N=0,B=0;if(o==="clip"){var W=Fd(a);N=W*S,B=W*E}var G=d.x+T-N,Q=d.y+R-B,te=G+d.width+2*N-T-P-y,X=Q+d.height+2*B-R-I-D;n.left=Math.max(n.left,G),n.top=Math.max(n.top,Q),n.right=Math.min(n.right,te),n.bottom=Math.min(n.bottom,X)}}),n}function cI(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n="".concat(e),r=n.match(/^(.*)\%$/);return r?t*(parseFloat(r[1])/100):parseFloat(n)}function dI(t,e){var n=e||[],r=Qe(n,2),i=r[0],o=r[1];return[cI(t.width,i),cI(t.height,o)]}function mI(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[t[0],t[1]]}function u2(t,e){var n=e[0],r=e[1],i,o;return n==="t"?o=t.y:n==="b"?o=t.y+t.height:o=t.y+t.height/2,r==="l"?i=t.x:r==="r"?i=t.x+t.width:i=t.x+t.width/2,{x:i,y:o}}function _u(t,e){var n={t:"b",b:"t",l:"r",r:"l"};return t.map(function(r,i){return i===e?n[r]||"c":r}).join("")}function BJ(t,e,n,r,i,o,a){var s=_.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:i[r]||{}}),u=Qe(s,2),l=u[0],c=u[1],d=_.useRef(0),m=_.useMemo(function(){return e?$b(e):[]},[e]),f=_.useRef({}),h=function(){f.current={}};t||h();var p=Na(function(){if(e&&n&&t){let Xn=function(Wi,Nl){var du=arguments.length>2&&arguments[2]!==void 0?arguments[2]:He,mu=O.x+Wi,fu=O.y+Nl,Rd=mu+fe,Yf=fu+he,J8=Math.max(mu,du.left),ep=Math.max(fu,du.top),tp=Math.min(Rd,du.right),np=Math.min(Yf,du.bottom);return Math.max(0,(tp-J8)*(np-ep))},Oi=function(){St=O.y+be,Ln=St+he,Yn=O.x+Ne,tn=Yn+fe};var b,C,S=e,E=S.ownerDocument,y=rf(S),D=y.getComputedStyle(S),R=D.width,I=D.height,T=D.position,P=S.style.left,N=S.style.top,B=S.style.right,W=S.style.bottom,G=S.style.overflow,Q=$e($e({},i[r]),o),te=E.createElement("div");(b=S.parentElement)===null||b===void 0||b.appendChild(te),te.style.left="".concat(S.offsetLeft,"px"),te.style.top="".concat(S.offsetTop,"px"),te.style.position=T,te.style.height="".concat(S.offsetHeight,"px"),te.style.width="".concat(S.offsetWidth,"px"),S.style.left="0",S.style.top="0",S.style.right="auto",S.style.bottom="auto",S.style.overflow="hidden";var X;if(Array.isArray(n))X={x:n[0],y:n[1],width:0,height:0};else{var x=n.getBoundingClientRect();X={x:x.x,y:x.y,width:x.width,height:x.height}}var O=S.getBoundingClientRect(),M=E.documentElement,V=M.clientWidth,q=M.clientHeight,ie=M.scrollWidth,ce=M.scrollHeight,pe=M.scrollTop,oe=M.scrollLeft,he=O.height,fe=O.width,ve=X.height,Ue=X.width,ke={left:0,top:0,right:V,bottom:q},Te={left:-oe,top:-pe,right:ie-oe,bottom:ce-pe},Re=Q.htmlRegion,rt="visible",_t="visibleFirst";Re!=="scroll"&&Re!==_t&&(Re=rt);var mt=Re===_t,nt=lI(Te,m),_e=lI(ke,m),He=Re===rt?_e:nt,et=mt?_e:He;S.style.left="auto",S.style.top="auto",S.style.right="0",S.style.bottom="0";var Dt=S.getBoundingClientRect();S.style.left=P,S.style.top=N,S.style.right=B,S.style.bottom=W,S.style.overflow=G,(C=S.parentElement)===null||C===void 0||C.removeChild(te);var Mt=Em(Math.round(fe/parseFloat(R)*1e3)/1e3),Bt=Em(Math.round(he/parseFloat(I)*1e3)/1e3);if(Mt===0||Bt===0||i9(n)&&!LN(n))return;var Zt=Q.offset,It=Q.targetOffset,pn=dI(O,Zt),yn=Qe(pn,2),$t=yn[0],Ht=yn[1],Nt=dI(X,It),Ot=Qe(Nt,2),En=Ot[0],Y=Ot[1];X.x-=En,X.y-=Y;var z=Q.points||[],ne=Qe(z,2),Ce=ne[0],Ve=ne[1],Ke=mI(Ve),Pe=mI(Ce),Be=u2(X,Ke),me=u2(O,Pe),De=$e({},Q),Ne=Be.x-me.x+$t,be=Be.y-me.y+Ht,ft=Xn(Ne,be),Ze=Xn(Ne,be,_e),st=u2(X,["t","l"]),Me=u2(O,["t","l"]),Le=u2(X,["b","r"]),Je=u2(O,["b","r"]),Xe=Q.overflow||{},Et=Xe.adjustX,wt=Xe.adjustY,Cn=Xe.shiftX,jn=Xe.shiftY,nr=function(Wi){return typeof Wi=="boolean"?Wi:Wi>=0},St,Ln,Yn,tn;Oi();var at=nr(wt),xe=Pe[0]===Ke[0];if(at&&Pe[0]==="t"&&(Ln>et.bottom||f.current.bt)){var An=be;xe?An-=he-ve:An=st.y-Je.y-Ht;var vn=Xn(Ne,An),Rr=Xn(Ne,An,_e);vn>ft||vn===ft&&(!mt||Rr>=Ze)?(f.current.bt=!0,be=An,Ht=-Ht,De.points=[_u(Pe,0),_u(Ke,0)]):f.current.bt=!1}if(at&&Pe[0]==="b"&&(St<et.top||f.current.tb)){var Nr=be;xe?Nr+=he-ve:Nr=Le.y-Me.y-Ht;var wi=Xn(Ne,Nr),di=Xn(Ne,Nr,_e);wi>ft||wi===ft&&(!mt||di>=Ze)?(f.current.tb=!0,be=Nr,Ht=-Ht,De.points=[_u(Pe,0),_u(Ke,0)]):f.current.tb=!1}var uo=nr(Et),Li=Pe[1]===Ke[1];if(uo&&Pe[1]==="l"&&(tn>et.right||f.current.rl)){var Ei=Ne;Li?Ei-=fe-Ue:Ei=st.x-Je.x-$t;var lo=Xn(Ei,be),Vs=Xn(Ei,be,_e);lo>ft||lo===ft&&(!mt||Vs>=Ze)?(f.current.rl=!0,Ne=Ei,$t=-$t,De.points=[_u(Pe,1),_u(Ke,1)]):f.current.rl=!1}if(uo&&Pe[1]==="r"&&(Yn<et.left||f.current.lr)){var oi=Ne;Li?oi+=fe-Ue:oi=Le.x-Me.x-$t;var ya=Xn(oi,be),ea=Xn(oi,be,_e);ya>ft||ya===ft&&(!mt||ea>=Ze)?(f.current.lr=!0,Ne=oi,$t=-$t,De.points=[_u(Pe,1),_u(Ke,1)]):f.current.lr=!1}Oi();var ji=Cn===!0?0:Cn;typeof ji=="number"&&(Yn<_e.left&&(Ne-=Yn-_e.left-$t,X.x+Ue<_e.left+ji&&(Ne+=X.x-_e.left+Ue-ji)),tn>_e.right&&(Ne-=tn-_e.right-$t,X.x>_e.right-ji&&(Ne+=X.x-_e.right+ji)));var zi=jn===!0?0:jn;typeof zi=="number"&&(St<_e.top&&(be-=St-_e.top-Ht,X.y+ve<_e.top+zi&&(be+=X.y-_e.top+ve-zi)),Ln>_e.bottom&&(be-=Ln-_e.bottom-Ht,X.y>_e.bottom-zi&&(be+=X.y-_e.bottom+zi)));var ta=O.x+Ne,Da=ta+fe,$=O.y+be,J=$+he,Z=X.x,le=Z+Ue,de=X.y,re=de+ve,Ee=Math.max(ta,Z),ze=Math.min(Da,le),qe=(Ee+ze)/2,tt=qe-ta,it=Math.max($,de),Pt=Math.min(J,re),sn=(it+Pt)/2,On=sn-$;a==null||a(e,De);var Dn=Dt.right-O.x-(Ne+O.width),gr=Dt.bottom-O.y-(be+O.height);c({ready:!0,offsetX:Ne/Mt,offsetY:be/Bt,offsetR:Dn/Mt,offsetB:gr/Bt,arrowX:tt/Mt,arrowY:On/Bt,scaleX:Mt,scaleY:Bt,align:De})}}),v=function(){d.current+=1;var b=d.current;Promise.resolve().then(function(){d.current===b&&p()})},g=function(){c(function(b){return $e($e({},b),{},{ready:!1})})};return Kr(g,[r]),Kr(function(){t||g()},[t]),[l.ready,l.offsetX,l.offsetY,l.offsetR,l.offsetB,l.arrowX,l.arrowY,l.scaleX,l.scaleY,l.align,v]}function UJ(t,e,n,r,i){Kr(function(){if(t&&e&&n){let d=function(){r(),i()};var o=e,a=n,s=$b(o),u=$b(a),l=rf(a),c=new Set([l].concat(Wr(s),Wr(u)));return c.forEach(function(m){m.addEventListener("scroll",d,{passive:!0})}),l.addEventListener("resize",d,{passive:!0}),r(),function(){c.forEach(function(m){m.removeEventListener("scroll",d),l.removeEventListener("resize",d)})}}},[t,e,n])}function VJ(t,e,n,r,i,o,a,s){var u=_.useRef(t),l=_.useRef(!1);u.current!==t&&(l.current=!0,u.current=t),_.useEffect(function(){var c=Or(function(){l.current=!1});return function(){Or.cancel(c)}},[t]),_.useEffect(function(){if(e&&r&&(!i||o)){var c=function(){var E=!1,y=function(R){var I=R.target;E=a(I)},D=function(R){var I=R.target;!l.current&&u.current&&!E&&!a(I)&&s(!1)};return[y,D]},d=c(),m=Qe(d,2),f=m[0],h=m[1],p=c(),v=Qe(p,2),g=v[0],b=v[1],C=rf(r);C.addEventListener("mousedown",f,!0),C.addEventListener("click",h,!0),C.addEventListener("contextmenu",h,!0);var S=Fb(n);return S&&(S.addEventListener("mousedown",g,!0),S.addEventListener("click",b,!0),S.addEventListener("contextmenu",b,!0)),function(){C.removeEventListener("mousedown",f,!0),C.removeEventListener("click",h,!0),C.removeEventListener("contextmenu",h,!0),S&&(S.removeEventListener("mousedown",g,!0),S.removeEventListener("click",b,!0),S.removeEventListener("contextmenu",b,!0))}}},[e,n,r,i,o])}var HJ=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function jJ(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jS,e=_.forwardRef(function(n,r){var i=n.prefixCls,o=i===void 0?"rc-trigger-popup":i,a=n.children,s=n.action,u=s===void 0?"hover":s,l=n.showAction,c=n.hideAction,d=n.popupVisible,m=n.defaultPopupVisible,f=n.onPopupVisibleChange,h=n.afterPopupVisibleChange,p=n.mouseEnterDelay,v=n.mouseLeaveDelay,g=v===void 0?.1:v,b=n.focusDelay,C=n.blurDelay,S=n.mask,E=n.maskClosable,y=E===void 0?!0:E,D=n.getPopupContainer,R=n.forceRender,I=n.autoDestroy,T=n.destroyPopupOnHide,P=n.popup,N=n.popupClassName,B=n.popupStyle,W=n.popupPlacement,G=n.builtinPlacements,Q=G===void 0?{}:G,te=n.popupAlign,X=n.zIndex,x=n.stretch,O=n.getPopupClassNameFromAlign,M=n.fresh,V=n.alignPoint,q=n.onPopupClick,ie=n.onPopupAlign,ce=n.arrow,pe=n.popupMotion,oe=n.maskMotion,he=n.popupTransitionName,fe=n.popupAnimation,ve=n.maskTransitionName,Ue=n.maskAnimation,ke=n.className,Te=n.getTriggerDOMNode,Re=Qn(n,HJ),rt=I||T||!1,_t=_.useState(!1),mt=Qe(_t,2),nt=mt[0],_e=mt[1];Kr(function(){_e(GS())},[]);var He=_.useRef({}),et=_.useContext(aI),Dt=_.useMemo(function(){return{registerSubPopup:function(xt,er){He.current[xt]=er,et==null||et.registerSubPopup(xt,er)}}},[et]),Mt=qM(),Bt=_.useState(null),Zt=Qe(Bt,2),It=Zt[0],pn=Zt[1],yn=Na(function(xt){i9(xt)&&It!==xt&&pn(xt),et==null||et.registerSubPopup(Mt,xt)}),$t=_.useState(null),Ht=Qe($t,2),Nt=Ht[0],Ot=Ht[1],En=_.useRef(null),Y=Na(function(xt){i9(xt)&&Nt!==xt&&(Ot(xt),En.current=xt)}),z=_.Children.only(a),ne=(z==null?void 0:z.props)||{},Ce={},Ve=Na(function(xt){var er,Yi,Pi=Nt;return(Pi==null?void 0:Pi.contains(xt))||((er=Fb(Pi))===null||er===void 0?void 0:er.host)===xt||xt===Pi||(It==null?void 0:It.contains(xt))||((Yi=Fb(It))===null||Yi===void 0?void 0:Yi.host)===xt||xt===It||Object.values(He.current).some(function(ti){return(ti==null?void 0:ti.contains(xt))||xt===ti})}),Ke=uI(o,pe,fe,he),Pe=uI(o,oe,Ue,ve),Be=_.useState(m||!1),me=Qe(Be,2),De=me[0],Ne=me[1],be=d??De,ft=Na(function(xt){d===void 0&&Ne(xt)});Kr(function(){Ne(d||!1)},[d]);var Ze=_.useRef(be);Ze.current=be;var st=_.useRef([]);st.current=[];var Me=Na(function(xt){var er;ft(xt),((er=st.current[st.current.length-1])!==null&&er!==void 0?er:be)!==xt&&(st.current.push(xt),f==null||f(xt))}),Le=_.useRef(),Je=function(){clearTimeout(Le.current)},Xe=function(xt){var er=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Je(),er===0?Me(xt):Le.current=setTimeout(function(){Me(xt)},er*1e3)};_.useEffect(function(){return Je},[]);var Et=_.useState(!1),wt=Qe(Et,2),Cn=wt[0],jn=wt[1];Kr(function(xt){(!xt||be)&&jn(!0)},[be]);var nr=_.useState(null),St=Qe(nr,2),Ln=St[0],Yn=St[1],tn=_.useState([0,0]),at=Qe(tn,2),xe=at[0],An=at[1],vn=function(xt){An([xt.clientX,xt.clientY])},Rr=BJ(be,It,V?xe:Nt,W,Q,te,ie),Nr=Qe(Rr,11),wi=Nr[0],di=Nr[1],uo=Nr[2],Li=Nr[3],Ei=Nr[4],lo=Nr[5],Vs=Nr[6],oi=Nr[7],ya=Nr[8],ea=Nr[9],ji=Nr[10],zi=FJ(nt,u,l,c),ta=Qe(zi,2),Da=ta[0],$=ta[1],J=Da.has("click"),Z=$.has("click")||$.has("contextMenu"),le=Na(function(){Cn||ji()}),de=function(){Ze.current&&V&&Z&&Xe(!1)};UJ(be,Nt,It,le,de),Kr(function(){le()},[xe,W]),Kr(function(){be&&!(Q!=null&&Q[W])&&le()},[JSON.stringify(te)]);var re=_.useMemo(function(){var xt=kJ(Q,o,ea,V);return Xt(xt,O==null?void 0:O(ea))},[ea,O,Q,o,V]);_.useImperativeHandle(r,function(){return{nativeElement:En.current,forceAlign:le}});var Ee=_.useState(0),ze=Qe(Ee,2),qe=ze[0],tt=ze[1],it=_.useState(0),Pt=Qe(it,2),sn=Pt[0],On=Pt[1],Dn=function(){if(x&&Nt){var xt=Nt.getBoundingClientRect();tt(xt.width),On(xt.height)}},gr=function(){Dn(),le()},Xn=function(xt){jn(!1),ji(),h==null||h(xt)},Oi=function(){return new Promise(function(xt){Dn(),Yn(function(){return xt})})};Kr(function(){Ln&&(ji(),Ln(),Yn(null))},[Ln]);function Wi(xt,er,Yi,Pi){Ce[xt]=function(ti){var Xf;Pi==null||Pi(ti),Xe(er,Yi);for(var rp=arguments.length,xy=new Array(rp>1?rp-1:0),qf=1;qf<rp;qf++)xy[qf-1]=arguments[qf];(Xf=ne[xt])===null||Xf===void 0||Xf.call.apply(Xf,[ne,ti].concat(xy))}}(J||Z)&&(Ce.onClick=function(xt){var er;Ze.current&&Z?Xe(!1):!Ze.current&&J&&(vn(xt),Xe(!0));for(var Yi=arguments.length,Pi=new Array(Yi>1?Yi-1:0),ti=1;ti<Yi;ti++)Pi[ti-1]=arguments[ti];(er=ne.onClick)===null||er===void 0||er.call.apply(er,[ne,xt].concat(Pi))}),VJ(be,Z,Nt,It,S,y,Ve,Xe);var Nl=Da.has("hover"),du=$.has("hover"),mu,fu;Nl&&(Wi("onMouseEnter",!0,p,function(xt){vn(xt)}),Wi("onPointerEnter",!0,p,function(xt){vn(xt)}),mu=function(xt){(be||Cn)&&It!==null&&It!==void 0&&It.contains(xt.target)&&Xe(!0,p)},V&&(Ce.onMouseMove=function(xt){var er;(er=ne.onMouseMove)===null||er===void 0||er.call(ne,xt)})),du&&(Wi("onMouseLeave",!1,g),Wi("onPointerLeave",!1,g),fu=function(){Xe(!1,g)}),Da.has("focus")&&Wi("onFocus",!0,b),$.has("focus")&&Wi("onBlur",!1,C),Da.has("contextMenu")&&(Ce.onContextMenu=function(xt){var er;Ze.current&&$.has("contextMenu")?Xe(!1):(vn(xt),Xe(!0)),xt.preventDefault();for(var Yi=arguments.length,Pi=new Array(Yi>1?Yi-1:0),ti=1;ti<Yi;ti++)Pi[ti-1]=arguments[ti];(er=ne.onContextMenu)===null||er===void 0||er.call.apply(er,[ne,xt].concat(Pi))}),ke&&(Ce.className=Xt(ne.className,ke));var Rd=$e($e({},ne),Ce),Yf={},J8=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];J8.forEach(function(xt){Re[xt]&&(Yf[xt]=function(){for(var er,Yi=arguments.length,Pi=new Array(Yi),ti=0;ti<Yi;ti++)Pi[ti]=arguments[ti];(er=Rd[xt])===null||er===void 0||er.call.apply(er,[Rd].concat(Pi)),Re[xt].apply(Re,Pi)})});var ep=_.cloneElement(z,$e($e({},Rd),Yf)),tp={x:lo,y:Vs},np=ce?$e({},ce!==!0?ce:{}):null;return _.createElement(_.Fragment,null,_.createElement(Yc,{disabled:!be,ref:Y,onResize:gr},_.createElement(xJ,{getTriggerDOMNode:Te},ep)),_.createElement(aI.Provider,{value:Dt},_.createElement(NJ,{portal:t,ref:yn,prefixCls:o,popup:P,className:Xt(N,re),style:B,target:Nt,onMouseEnter:mu,onMouseLeave:fu,onPointerEnter:mu,zIndex:X,open:be,keepDom:Cn,fresh:M,onClick:q,mask:S,motion:Ke,maskMotion:Pe,onVisibleChanged:Xn,onPrepare:Oi,forceRender:R,autoDestroy:rt,getPopupContainer:D,align:ea,arrow:np,arrowPos:tp,ready:wi,offsetX:di,offsetY:uo,offsetR:Li,offsetB:Ei,onAlign:le,stretch:x,targetWidth:qe/oi,targetHeight:sn/ya})))});return e}const U5=jJ(jS);var zJ=lt.ESC,WJ=lt.TAB;function YJ(t){var e=t.visible,n=t.triggerRef,r=t.onVisibleChange,i=t.autoFocus,o=t.overlayRef,a=_.useRef(!1),s=function(){if(e){var c,d;(c=n.current)===null||c===void 0||(d=c.focus)===null||d===void 0||d.call(c),r==null||r(!1)}},u=function(){var c;return(c=o.current)!==null&&c!==void 0&&c.focus?(o.current.focus(),a.current=!0,!0):!1},l=function(c){switch(c.keyCode){case zJ:s();break;case WJ:{var d=!1;a.current||(d=u()),d?c.preventDefault():s();break}}};_.useEffect(function(){return e?(window.addEventListener("keydown",l),i&&Or(u,3),function(){window.removeEventListener("keydown",l),a.current=!1}):function(){a.current=!1}},[e])}var XJ=_.forwardRef(function(t,e){var n=t.overlay,r=t.arrow,i=t.prefixCls,o=_.useMemo(function(){var s;return typeof n=="function"?s=n():s=n,s},[n]),a=zc(e,o==null?void 0:o.ref);return Se.createElement(Se.Fragment,null,r&&Se.createElement("div",{className:"".concat(i,"-arrow")}),Se.cloneElement(o,{ref:rd(o)?a:void 0}))}),l2={adjustX:1,adjustY:1},c2=[0,0],qJ={topLeft:{points:["bl","tl"],overflow:l2,offset:[0,-4],targetOffset:c2},top:{points:["bc","tc"],overflow:l2,offset:[0,-4],targetOffset:c2},topRight:{points:["br","tr"],overflow:l2,offset:[0,-4],targetOffset:c2},bottomLeft:{points:["tl","bl"],overflow:l2,offset:[0,4],targetOffset:c2},bottom:{points:["tc","bc"],overflow:l2,offset:[0,4],targetOffset:c2},bottomRight:{points:["tr","br"],overflow:l2,offset:[0,4],targetOffset:c2}},GJ=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function KJ(t,e){var n,r=t.arrow,i=r===void 0?!1:r,o=t.prefixCls,a=o===void 0?"rc-dropdown":o,s=t.transitionName,u=t.animation,l=t.align,c=t.placement,d=c===void 0?"bottomLeft":c,m=t.placements,f=m===void 0?qJ:m,h=t.getPopupContainer,p=t.showAction,v=t.hideAction,g=t.overlayClassName,b=t.overlayStyle,C=t.visible,S=t.trigger,E=S===void 0?["hover"]:S,y=t.autoFocus,D=t.overlay,R=t.children,I=t.onVisibleChange,T=Qn(t,GJ),P=Se.useState(),N=Qe(P,2),B=N[0],W=N[1],G="visible"in t?C:B,Q=Se.useRef(null),te=Se.useRef(null),X=Se.useRef(null);Se.useImperativeHandle(e,function(){return Q.current});var x=function(oe){W(oe),I==null||I(oe)};YJ({visible:G,triggerRef:X,onVisibleChange:x,autoFocus:y,overlayRef:te});var O=function(oe){var he=t.onOverlayClick;W(!1),he&&he(oe)},M=function(){return Se.createElement(XJ,{ref:te,overlay:D,prefixCls:a,arrow:i})},V=function(){return typeof D=="function"?M:M()},q=function(){var oe=t.minOverlayWidthMatchTrigger,he=t.alignPoint;return"minOverlayWidthMatchTrigger"in t?oe:!he},ie=function(){var oe=t.openClassName;return oe!==void 0?oe:"".concat(a,"-open")},ce=Se.cloneElement(R,{className:Xt((n=R.props)===null||n===void 0?void 0:n.className,G&&ie()),ref:rd(R)?zc(X,R.ref):void 0}),pe=v;return!pe&&E.indexOf("contextMenu")!==-1&&(pe=["click"]),Se.createElement(U5,Qt({builtinPlacements:f},T,{prefixCls:a,ref:Q,popupClassName:Xt(g,ut({},"".concat(a,"-show-arrow"),i)),popupStyle:b,action:E,showAction:p,hideAction:pe,popupPlacement:d,popupAlign:l,popupTransitionName:s,popupAnimation:u,popupVisible:G,stretch:q()?"minWidth":"",popup:V(),onPopupVisibleChange:x,onPopupClick:O,getPopupContainer:h}),ce)}const ZJ=Se.forwardRef(KJ),QJ="univer-dropdown",JJ="univer-dropdown-hidden",eee="univer-dropdown-slide-up-enter",tee="univer-dropdown-slide-up-appear",nee="univer-dropdown-slide-up-leave",ree="univer-dropdown-slide-up-enter-active",iee="univer-dropdown-placement-bottomLeft",oee="univer-dropdown-slide-up-appear-active",aee="univer-dropdown-placement-bottomCenter",see="univer-dropdown-placement-bottomRight",uee="univer-dropdown-slide-up-in",lee="univer-dropdown-placement-topLeft",cee="univer-dropdown-placement-topCenter",dee="univer-dropdown-placement-topRight",mee="univer-dropdown-slide-down-in",fee="univer-dropdown-slide-up-leave-active",hee="univer-dropdown-slide-up-out",pee="univer-dropdown-slide-down-out",gee={dropdown:QJ,dropdownHidden:JJ,dropdownSlideUpEnter:eee,dropdownSlideUpAppear:tee,dropdownSlideUpLeave:nee,dropdownSlideUpEnterActive:ree,dropdownPlacementBottomLeft:iee,dropdownSlideUpAppearActive:oee,dropdownPlacementBottomCenter:aee,dropdownPlacementBottomRight:see,dropdownSlideUpIn:uee,dropdownPlacementTopLeft:lee,dropdownPlacementTopCenter:cee,dropdownPlacementTopRight:dee,dropdownSlideDownIn:mee,dropdownSlideUpLeaveActive:fee,dropdownSlideUpOut:hee,dropdownSlideDownOut:pee};function eu(t){const{className:e,trigger:n=["click"],placement:r,children:i,overlay:o,alignPoint:a=!1,align:s,onVisibleChange:u}=t,{mountContainer:l}=_.useContext(su);return Se.createElement(ZJ,{...t,overlayClassName:e,prefixCls:gee.dropdown,getPopupContainer:()=>l,trigger:n,animation:"slide-up",placement:r,overlay:o,alignPoint:a,align:s,onVisibleChange:u},i)}function vee(t){return!!(t.addonBefore||t.addonAfter)}function bee(t){return!!(t.prefix||t.suffix||t.allowClear)}function fI(t,e,n,r){if(n){var i=e;if(e.type==="click"){var o=t.cloneNode(!0);i=Object.create(e,{target:{value:o},currentTarget:{value:o}}),o.value="",n(i);return}if(t.type!=="file"&&r!==void 0){var a=t.cloneNode(!0);i=Object.create(e,{target:{value:a},currentTarget:{value:a}}),a.value=r,n(i);return}n(i)}}function ON(t,e){if(t){t.focus(e);var n=e||{},r=n.cursor;if(r){var i=t.value.length;switch(r){case"start":t.setSelectionRange(0,0);break;case"end":t.setSelectionRange(i,i);break;default:t.setSelectionRange(0,i)}}}}var PN=function(t){var e,n,r=t.inputElement,i=t.children,o=t.prefixCls,a=t.prefix,s=t.suffix,u=t.addonBefore,l=t.addonAfter,c=t.className,d=t.style,m=t.disabled,f=t.readOnly,h=t.focused,p=t.triggerFocus,v=t.allowClear,g=t.value,b=t.handleReset,C=t.hidden,S=t.classes,E=t.classNames,y=t.dataAttrs,D=t.styles,R=t.components,I=i??r,T=(R==null?void 0:R.affixWrapper)||"span",P=(R==null?void 0:R.groupWrapper)||"span",N=(R==null?void 0:R.wrapper)||"span",B=(R==null?void 0:R.groupAddon)||"span",W=_.useRef(null),G=function(ke){var Te;(Te=W.current)!==null&&Te!==void 0&&Te.contains(ke.target)&&(p==null||p())},Q=bee(t),te=_.cloneElement(I,{value:g,className:Xt(I.props.className,!Q&&(E==null?void 0:E.variant))||null});if(Q){var X,x=null;if(v){var O,M=!m&&!f&&g,V="".concat(o,"-clear-icon"),q=Pr(v)==="object"&&v!==null&&v!==void 0&&v.clearIcon?v.clearIcon:"✖";x=Se.createElement("span",{onClick:b,onMouseDown:function(ke){return ke.preventDefault()},className:Xt(V,(O={},ut(O,"".concat(V,"-hidden"),!M),ut(O,"".concat(V,"-has-suffix"),!!s),O)),role:"button",tabIndex:-1},q)}var ie="".concat(o,"-affix-wrapper"),ce=Xt(ie,(X={},ut(X,"".concat(o,"-disabled"),m),ut(X,"".concat(ie,"-disabled"),m),ut(X,"".concat(ie,"-focused"),h),ut(X,"".concat(ie,"-readonly"),f),ut(X,"".concat(ie,"-input-with-clear-btn"),s&&v&&g),X),S==null?void 0:S.affixWrapper,E==null?void 0:E.affixWrapper,E==null?void 0:E.variant),pe=(s||v)&&Se.createElement("span",{className:Xt("".concat(o,"-suffix"),E==null?void 0:E.suffix),style:D==null?void 0:D.suffix},x,s);te=Se.createElement(T,Qt({className:ce,style:D==null?void 0:D.affixWrapper,onClick:G},y==null?void 0:y.affixWrapper,{ref:W}),a&&Se.createElement("span",{className:Xt("".concat(o,"-prefix"),E==null?void 0:E.prefix),style:D==null?void 0:D.prefix},a),te,pe)}if(vee(t)){var oe="".concat(o,"-group"),he="".concat(oe,"-addon"),fe="".concat(oe,"-wrapper"),ve=Xt("".concat(o,"-wrapper"),oe,S==null?void 0:S.wrapper,E==null?void 0:E.wrapper),Ue=Xt(fe,ut({},"".concat(fe,"-disabled"),m),S==null?void 0:S.group,E==null?void 0:E.groupWrapper);te=Se.createElement(P,{className:Ue},Se.createElement(N,{className:ve},u&&Se.createElement(B,{className:he},u),te,l&&Se.createElement(B,{className:he},l)))}return Se.cloneElement(te,{className:Xt((e=te.props)===null||e===void 0?void 0:e.className,c)||null,style:$e($e({},(n=te.props)===null||n===void 0?void 0:n.style),d),hidden:C})};function tg(t){return t!==void 0}function Qu(t,e){var n=e||{},r=n.defaultValue,i=n.value,o=n.onChange,a=n.postState,s=p0(function(){return tg(i)?i:tg(r)?typeof r=="function"?r():r:typeof t=="function"?t():t}),u=Qe(s,2),l=u[0],c=u[1],d=i!==void 0?i:l,m=a?a(d):d,f=Na(o),h=p0([d]),p=Qe(h,2),v=p[0],g=p[1];k6(function(){var C=v[0];l!==C&&f(l,C)},[v]),k6(function(){tg(i)||c(i)},[i]);var b=Na(function(C,S){c(C,S),g([d],S)});return[m,b]}function V5(t,e){var n=$e({},t);return Array.isArray(e)&&e.forEach(function(r){delete n[r]}),n}var _ee=["show"];function Cee(t,e){return _.useMemo(function(){var n={};e&&(n.show=Pr(e)==="object"&&e.formatter?e.formatter:!!e),n=$e($e({},n),t);var r=n,i=r.show,o=Qn(r,_ee);return $e($e({},o),{},{show:!!i,showFormatter:typeof i=="function"?i:void 0,strategy:o.strategy||function(a){return a.length}})},[t,e])}var See=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],Eee=_.forwardRef(function(t,e){var n=t.autoComplete,r=t.onChange,i=t.onFocus,o=t.onBlur,a=t.onPressEnter,s=t.onKeyDown,u=t.prefixCls,l=u===void 0?"rc-input":u,c=t.disabled,d=t.htmlSize,m=t.className,f=t.maxLength,h=t.suffix,p=t.showCount,v=t.count,g=t.type,b=g===void 0?"text":g,C=t.classes,S=t.classNames,E=t.styles,y=t.onCompositionStart,D=t.onCompositionEnd,R=Qn(t,See),I=_.useState(!1),T=Qe(I,2),P=T[0],N=T[1],B=_.useRef(!1),W=_.useRef(null),G=function(_e){W.current&&ON(W.current,_e)},Q=Qu(t.defaultValue,{value:t.value}),te=Qe(Q,2),X=te[0],x=te[1],O=X==null?"":String(X),M=_.useState(null),V=Qe(M,2),q=V[0],ie=V[1],ce=Cee(v,p),pe=ce.max||f,oe=ce.strategy(O),he=!!pe&&oe>pe;_.useImperativeHandle(e,function(){return{focus:G,blur:function(){var _e;(_e=W.current)===null||_e===void 0||_e.blur()},setSelectionRange:function(_e,He,et){var Dt;(Dt=W.current)===null||Dt===void 0||Dt.setSelectionRange(_e,He,et)},select:function(){var _e;(_e=W.current)===null||_e===void 0||_e.select()},input:W.current}}),_.useEffect(function(){N(function(_e){return _e&&c?!1:_e})},[c]);var fe=function(_e,He,et){var Dt=He;if(!B.current&&ce.exceedFormatter&&ce.max&&ce.strategy(He)>ce.max){if(Dt=ce.exceedFormatter(He,{max:ce.max}),He!==Dt){var Mt,Bt;ie([((Mt=W.current)===null||Mt===void 0?void 0:Mt.selectionStart)||0,((Bt=W.current)===null||Bt===void 0?void 0:Bt.selectionEnd)||0])}}else if(et.source==="compositionEnd")return;x(Dt),W.current&&fI(W.current,_e,r,Dt)};_.useEffect(function(){if(q){var _e;(_e=W.current)===null||_e===void 0||_e.setSelectionRange.apply(_e,Wr(q))}},[q]);var ve=function(_e){fe(_e,_e.target.value,{source:"change"})},Ue=function(_e){B.current=!1,fe(_e,_e.currentTarget.value,{source:"compositionEnd"}),D==null||D(_e)},ke=function(_e){a&&_e.key==="Enter"&&a(_e),s==null||s(_e)},Te=function(_e){N(!0),i==null||i(_e)},Re=function(_e){N(!1),o==null||o(_e)},rt=function(_e){x(""),G(),W.current&&fI(W.current,_e,r)},_t=he&&"".concat(l,"-out-of-range"),mt=function(){var _e=V5(t,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames"]);return Se.createElement("input",Qt({autoComplete:n},_e,{onChange:ve,onFocus:Te,onBlur:Re,onKeyDown:ke,className:Xt(l,ut({},"".concat(l,"-disabled"),c),S==null?void 0:S.input),style:E==null?void 0:E.input,ref:W,size:d,type:b,onCompositionStart:function(He){B.current=!0,y==null||y(He)},onCompositionEnd:Ue}))},nt=function(){var _e=Number(pe)>0;if(h||ce.show){var He=ce.showFormatter?ce.showFormatter({value:O,count:oe,maxLength:pe}):"".concat(oe).concat(_e?" / ".concat(pe):"");return Se.createElement(Se.Fragment,null,ce.show&&Se.createElement("span",{className:Xt("".concat(l,"-show-count-suffix"),ut({},"".concat(l,"-show-count-has-suffix"),!!h),S==null?void 0:S.count),style:$e({},E==null?void 0:E.count)},He),h)}return null};return Se.createElement(PN,Qt({},R,{prefixCls:l,className:Xt(m,_t),handleReset:rt,value:O,focused:P,triggerFocus:G,suffix:nt(),disabled:c,classes:C,classNames:S,styles:E}),mt())});const yee="univer-input",Dee="univer-input-affix-wrapper",Ree="univer-input-affix-wrapper-mini",Iee="univer-input-affix-wrapper-small",Aee="univer-input-affix-wrapper-middle",Tee="univer-input-affix-wrapper-large",wee="univer-input-affix-wrapper-disabled",Lee="univer-input-suffix",Oee="univer-input-clear-icon",Pee="univer-input-clear-icon-hidden",Mee="univer-input-slot-container",Nee="univer-input-slot",$d={input:yee,inputAffixWrapper:Dee,inputAffixWrapperMini:Ree,inputAffixWrapperSmall:Iee,inputAffixWrapperMiddle:Aee,inputAffixWrapperLarge:Tee,inputAffixWrapperDisabled:wee,inputSuffix:Lee,inputClearIcon:Oee,inputClearIconHidden:Pee,inputSlotContainer:Mee,inputSlot:Nee};function xee(t){const{affixWrapperStyle:e,type:n="text",placeholder:r,value:i,size:o="middle",allowClear:a,disabled:s=!1,onClick:u,onKeyDown:l,onChange:c,autoFocus:d}=t;function m(h){const{value:p}=h.target;c==null||c(p)}const f=Ci({[$d.inputAffixWrapperMini]:o==="mini",[$d.inputAffixWrapperSmall]:o==="small",[$d.inputAffixWrapperMiddle]:o==="middle",[$d.inputAffixWrapperLarge]:o==="large"});return Se.createElement(Eee,{prefixCls:$d.input,classNames:{affixWrapper:f},styles:{affixWrapper:e},autoFocus:d,type:n,placeholder:r,value:i,disabled:s,onClick:u,onKeyDown:l,onChange:m,allowClear:{clearIcon:a?Se.createElement(vM,null):Se.createElement(Se.Fragment,null)}})}function kb(){return typeof BigInt=="function"}function MN(t){return!t&&t!==0&&!Number.isNaN(t)||!String(t).trim()}function hc(t){var e=t.trim(),n=e.startsWith("-");n&&(e=e.slice(1)),e=e.replace(/(\.\d*[^0])0*$/,"$1").replace(/\.0*$/,"").replace(/^0+/,""),e.startsWith(".")&&(e="0".concat(e));var r=e||"0",i=r.split("."),o=i[0]||"0",a=i[1]||"0";o==="0"&&a==="0"&&(n=!1);var s=n?"-":"";return{negative:n,negativeStr:s,trimStr:r,integerStr:o,decimalStr:a,fullStr:"".concat(s).concat(r)}}function KS(t){var e=String(t);return!Number.isNaN(Number(e))&&e.includes("e")}function uc(t){var e=String(t);if(KS(t)){var n=Number(e.slice(e.indexOf("e-")+2)),r=e.match(/\.(\d+)/);return r!=null&&r[1]&&(n+=r[1].length),n}return e.includes(".")&&ZS(e)?e.length-e.indexOf(".")-1:0}function H5(t){var e=String(t);if(KS(t)){if(t>Number.MAX_SAFE_INTEGER)return String(kb()?BigInt(t).toString():Number.MAX_SAFE_INTEGER);if(t<Number.MIN_SAFE_INTEGER)return String(kb()?BigInt(t).toString():Number.MIN_SAFE_INTEGER);e=t.toFixed(uc(e))}return hc(e).fullStr}function ZS(t){return typeof t=="number"?!Number.isNaN(t):t?/^\s*-?\d+(\.\d+)?\s*$/.test(t)||/^\s*-?\d+\.\s*$/.test(t)||/^\s*-?\.\d+\s*$/.test(t):!1}var Fee=function(){function t(e){if(Al(this,t),ut(this,"origin",""),ut(this,"negative",void 0),ut(this,"integer",void 0),ut(this,"decimal",void 0),ut(this,"decimalLen",void 0),ut(this,"empty",void 0),ut(this,"nan",void 0),MN(e)){this.empty=!0;return}if(this.origin=String(e),e==="-"||Number.isNaN(e)){this.nan=!0;return}var n=e;if(KS(n)&&(n=Number(n)),n=typeof n=="string"?n:H5(n),ZS(n)){var r=hc(n);this.negative=r.negative;var i=r.trimStr.split(".");this.integer=BigInt(i[0]);var o=i[1]||"0";this.decimal=BigInt(o),this.decimalLen=o.length}else this.nan=!0}return Tl(t,[{key:"getMark",value:function(){return this.negative?"-":""}},{key:"getIntegerStr",value:function(){return this.integer.toString()}},{key:"getDecimalStr",value:function(){return this.decimal.toString().padStart(this.decimalLen,"0")}},{key:"alignDecimal",value:function(e){var n="".concat(this.getMark()).concat(this.getIntegerStr()).concat(this.getDecimalStr().padEnd(e,"0"));return BigInt(n)}},{key:"negate",value:function(){var e=new t(this.toString());return e.negative=!e.negative,e}},{key:"cal",value:function(e,n,r){var i=Math.max(this.getDecimalStr().length,e.getDecimalStr().length),o=this.alignDecimal(i),a=e.alignDecimal(i),s=n(o,a).toString(),u=r(i),l=hc(s),c=l.negativeStr,d=l.trimStr,m="".concat(c).concat(d.padStart(u+1,"0"));return new t("".concat(m.slice(0,-u),".").concat(m.slice(-u)))}},{key:"add",value:function(e){if(this.isInvalidate())return new t(e);var n=new t(e);return n.isInvalidate()?this:this.cal(n,function(r,i){return r+i},function(r){return r})}},{key:"multi",value:function(e){var n=new t(e);return this.isInvalidate()||n.isInvalidate()?new t(NaN):this.cal(n,function(r,i){return r*i},function(r){return r*2})}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return this.nan}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(e){return this.toString()===(e==null?void 0:e.toString())}},{key:"lessEquals",value:function(e){return this.add(e.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.isNaN()?NaN:Number(this.toString())}},{key:"toString",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return e?this.isInvalidate()?"":hc("".concat(this.getMark()).concat(this.getIntegerStr(),".").concat(this.getDecimalStr())).fullStr:this.origin}}]),t}(),$ee=function(){function t(e){if(Al(this,t),ut(this,"origin",""),ut(this,"number",void 0),ut(this,"empty",void 0),MN(e)){this.empty=!0;return}this.origin=String(e),this.number=Number(e)}return Tl(t,[{key:"negate",value:function(){return new t(-this.toNumber())}},{key:"add",value:function(e){if(this.isInvalidate())return new t(e);var n=Number(e);if(Number.isNaN(n))return this;var r=this.number+n;if(r>Number.MAX_SAFE_INTEGER)return new t(Number.MAX_SAFE_INTEGER);if(r<Number.MIN_SAFE_INTEGER)return new t(Number.MIN_SAFE_INTEGER);var i=Math.max(uc(this.number),uc(n));return new t(r.toFixed(i))}},{key:"multi",value:function(e){var n=Number(e);if(this.isInvalidate()||Number.isNaN(n))return new t(NaN);var r=this.number*n;if(r>Number.MAX_SAFE_INTEGER)return new t(Number.MAX_SAFE_INTEGER);if(r<Number.MIN_SAFE_INTEGER)return new t(Number.MIN_SAFE_INTEGER);var i=Math.max(uc(this.number),uc(n));return new t(r.toFixed(i))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return Number.isNaN(this.number)}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(e){return this.toNumber()===(e==null?void 0:e.toNumber())}},{key:"lessEquals",value:function(e){return this.add(e.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return e?this.isInvalidate()?"":H5(this.number):this.origin}}]),t}();function ss(t){return kb()?new Fee(t):new $ee(t)}function O4(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t==="")return"";var i=hc(t),o=i.negativeStr,a=i.integerStr,s=i.decimalStr,u="".concat(e).concat(s),l="".concat(o).concat(a);if(n>=0){var c=Number(s[n]);if(c>=5&&!r){var d=ss(t).add("".concat(o,"0.").concat("0".repeat(n)).concat(10-c));return O4(d.toString(),e,n,r)}return n===0?l:"".concat(l).concat(e).concat(s.padEnd(n,"0").slice(0,n))}return u===".0"?l:"".concat(l).concat(u)}function kee(t,e){var n=_.useRef(null);function r(){try{var o=t.selectionStart,a=t.selectionEnd,s=t.value,u=s.substring(0,o),l=s.substring(a);n.current={start:o,end:a,value:s,beforeTxt:u,afterTxt:l}}catch{}}function i(){if(t&&n.current&&e)try{var o=t.value,a=n.current,s=a.beforeTxt,u=a.afterTxt,l=a.start,c=o.length;if(o.endsWith(u))c=o.length-n.current.afterTxt.length;else if(o.startsWith(s))c=s.length;else{var d=s[l-1],m=o.indexOf(d,l-1);m!==-1&&(c=m+1)}t.setSelectionRange(c,c)}catch(f){wl(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(f.message))}}return[r,i]}var Bee=function(){var t=_.useState(!1),e=Qe(t,2),n=e[0],r=e[1];return Kr(function(){r(GS())},[]),n},Uee=200,Vee=600;function Hee(t){var e=t.prefixCls,n=t.upNode,r=t.downNode,i=t.upDisabled,o=t.downDisabled,a=t.onStep,s=_.useRef(),u=_.useRef([]),l=_.useRef();l.current=a;var c=function(){clearTimeout(s.current)},d=function(b,C){b.preventDefault(),c(),l.current(C);function S(){l.current(C),s.current=setTimeout(S,Uee)}s.current=setTimeout(S,Vee)};_.useEffect(function(){return function(){c(),u.current.forEach(function(b){return Or.cancel(b)})}},[]);var m=Bee();if(m)return null;var f="".concat(e,"-handler"),h=Xt(f,"".concat(f,"-up"),ut({},"".concat(f,"-up-disabled"),i)),p=Xt(f,"".concat(f,"-down"),ut({},"".concat(f,"-down-disabled"),o)),v=function(){return u.current.push(Or(c))},g={unselectable:"on",role:"button",onMouseUp:v,onMouseLeave:v};return _.createElement("div",{className:"".concat(f,"-wrap")},_.createElement("span",Qt({},g,{onMouseDown:function(b){d(b,!0)},"aria-label":"Increase Value","aria-disabled":i,className:h}),n||_.createElement("span",{unselectable:"on",className:"".concat(e,"-handler-up-inner")})),_.createElement("span",Qt({},g,{onMouseDown:function(b){d(b,!1)},"aria-label":"Decrease Value","aria-disabled":o,className:p}),r||_.createElement("span",{unselectable:"on",className:"".concat(e,"-handler-down-inner")})))}function hI(t){var e=typeof t=="number"?H5(t):hc(t).fullStr,n=e.includes(".");return n?hc(e.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:t+"0"}const jee=function(){var t=_.useRef(0),e=function(){Or.cancel(t.current)};return _.useEffect(function(){return e},[]),function(n){e(),t.current=Or(function(){n()})}};var zee=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","changeOnWheel","controls","classNames","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep","changeOnBlur"],Wee=["disabled","style","prefixCls","value","prefix","suffix","addonBefore","addonAfter","className","classNames"],pI=function(t,e){return t||e.isEmpty()?e.toString():e.toNumber()},gI=function(t){var e=ss(t);return e.isInvalidate()?null:e},Yee=_.forwardRef(function(t,e){var n,r=t.prefixCls,i=r===void 0?"rc-input-number":r,o=t.className,a=t.style,s=t.min,u=t.max,l=t.step,c=l===void 0?1:l,d=t.defaultValue,m=t.value,f=t.disabled,h=t.readOnly,p=t.upHandler,v=t.downHandler,g=t.keyboard,b=t.changeOnWheel,C=b===void 0?!1:b,S=t.controls,E=S===void 0?!0:S;t.classNames;var y=t.stringMode,D=t.parser,R=t.formatter,I=t.precision,T=t.decimalSeparator,P=t.onChange,N=t.onInput,B=t.onPressEnter,W=t.onStep,G=t.changeOnBlur,Q=G===void 0?!0:G,te=Qn(t,zee),X="".concat(i,"-input"),x=_.useRef(null),O=_.useState(!1),M=Qe(O,2),V=M[0],q=M[1],ie=_.useRef(!1),ce=_.useRef(!1),pe=_.useRef(!1),oe=_.useState(function(){return ss(m??d)}),he=Qe(oe,2),fe=he[0],ve=he[1];function Ue(De){m===void 0&&ve(De)}var ke=_.useCallback(function(De,Ne){if(!Ne)return I>=0?I:Math.max(uc(De),uc(c))},[I,c]),Te=_.useCallback(function(De){var Ne=String(De);if(D)return D(Ne);var be=Ne;return T&&(be=be.replace(T,".")),be.replace(/[^\w.-]+/g,"")},[D,T]),Re=_.useRef(""),rt=_.useCallback(function(De,Ne){if(R)return R(De,{userTyping:Ne,input:String(Re.current)});var be=typeof De=="number"?H5(De):De;if(!Ne){var ft=ke(be,Ne);if(ZS(be)&&(T||ft>=0)){var Ze=T||".";be=O4(be,Ze,ft)}}return be},[R,ke,T]),_t=_.useState(function(){var De=d??m;return fe.isInvalidate()&&["string","number"].includes(Pr(De))?Number.isNaN(De)?"":De:rt(fe.toString(),!1)}),mt=Qe(_t,2),nt=mt[0],_e=mt[1];Re.current=nt;function He(De,Ne){_e(rt(De.isInvalidate()?De.toString(!1):De.toString(!Ne),Ne))}var et=_.useMemo(function(){return gI(u)},[u,I]),Dt=_.useMemo(function(){return gI(s)},[s,I]),Mt=_.useMemo(function(){return!et||!fe||fe.isInvalidate()?!1:et.lessEquals(fe)},[et,fe]),Bt=_.useMemo(function(){return!Dt||!fe||fe.isInvalidate()?!1:fe.lessEquals(Dt)},[Dt,fe]),Zt=kee(x.current,V),It=Qe(Zt,2),pn=It[0],yn=It[1],$t=function(De){return et&&!De.lessEquals(et)?et:Dt&&!Dt.lessEquals(De)?Dt:null},Ht=function(De){return!$t(De)},Nt=function(De,Ne){var be=De,ft=Ht(be)||be.isEmpty();if(!be.isEmpty()&&!Ne&&(be=$t(be)||be,ft=!0),!h&&!f&&ft){var Ze=be.toString(),st=ke(Ze,Ne);return st>=0&&(be=ss(O4(Ze,".",st)),Ht(be)||(be=ss(O4(Ze,".",st,!0)))),be.equals(fe)||(Ue(be),P==null||P(be.isEmpty()?null:pI(y,be)),m===void 0&&He(be,Ne)),be}return fe},Ot=jee(),En=function De(Ne){if(pn(),Re.current=Ne,_e(Ne),!ce.current){var be=Te(Ne),ft=ss(be);ft.isNaN()||Nt(ft,!0)}N==null||N(Ne),Ot(function(){var Ze=Ne;D||(Ze=Ne.replace(/。/g,".")),Ze!==Ne&&De(Ze)})},Y=function(){ce.current=!0},z=function(){ce.current=!1,En(x.current.value)},ne=function(De){En(De.target.value)},Ce=function(De){var Ne;if(!(De&&Mt||!De&&Bt)){ie.current=!1;var be=ss(pe.current?hI(c):c);De||(be=be.negate());var ft=(fe||ss(0)).add(be.toString()),Ze=Nt(ft,!1);W==null||W(pI(y,Ze),{offset:pe.current?hI(c):c,type:De?"up":"down"}),(Ne=x.current)===null||Ne===void 0||Ne.focus()}},Ve=function(De){var Ne=ss(Te(nt)),be=Ne;Ne.isNaN()?be=Nt(fe,De):be=Nt(Ne,De),m!==void 0?He(fe,!1):be.isNaN()||He(be,!1)},Ke=function(){ie.current=!0},Pe=function(De){var Ne=De.key,be=De.shiftKey;ie.current=!0,pe.current=be,Ne==="Enter"&&(ce.current||(ie.current=!1),Ve(!1),B==null||B(De)),g!==!1&&!ce.current&&["Up","ArrowUp","Down","ArrowDown"].includes(Ne)&&(Ce(Ne==="Up"||Ne==="ArrowUp"),De.preventDefault())},Be=function(){ie.current=!1,pe.current=!1};_.useEffect(function(){if(C&&V){var De=function(be){Ce(be.deltaY<0),be.preventDefault()},Ne=x.current;if(Ne)return Ne.addEventListener("wheel",De,{passive:!1}),function(){return Ne.removeEventListener("wheel",De)}}});var me=function(){Q&&Ve(!1),q(!1),ie.current=!1};return k6(function(){fe.isInvalidate()||He(fe,!1)},[I,R]),k6(function(){var De=ss(m);ve(De);var Ne=ss(Te(nt));(!De.equals(Ne)||!ie.current||R)&&He(De,ie.current)},[m]),k6(function(){R&&yn()},[nt]),_.createElement("div",{className:Xt(i,o,(n={},ut(n,"".concat(i,"-focused"),V),ut(n,"".concat(i,"-disabled"),f),ut(n,"".concat(i,"-readonly"),h),ut(n,"".concat(i,"-not-a-number"),fe.isNaN()),ut(n,"".concat(i,"-out-of-range"),!fe.isInvalidate()&&!Ht(fe)),n)),style:a,onFocus:function(){q(!0)},onBlur:me,onKeyDown:Pe,onKeyUp:Be,onCompositionStart:Y,onCompositionEnd:z,onBeforeInput:Ke},E&&_.createElement(Hee,{prefixCls:i,upNode:p,downNode:v,upDisabled:Mt,downDisabled:Bt,onStep:Ce}),_.createElement("div",{className:"".concat(X,"-wrap")},_.createElement("input",Qt({autoComplete:"off",role:"spinbutton","aria-valuemin":s,"aria-valuemax":u,"aria-valuenow":fe.isInvalidate()?null:fe.toString(),step:c},te,{ref:zc(x,e),className:X,value:nt,onChange:ne,disabled:f,readOnly:h}))))}),NN=_.forwardRef(function(t,e){var n=t.disabled,r=t.style,i=t.prefixCls,o=t.value,a=t.prefix,s=t.suffix,u=t.addonBefore,l=t.addonAfter,c=t.className,d=t.classNames,m=Qn(t,Wee),f=_.useRef(null),h=function(p){f.current&&ON(f.current,p)};return _.createElement(PN,{className:c,triggerFocus:h,prefixCls:i,value:o,disabled:n,style:r,prefix:a,suffix:s,addonAfter:l,addonBefore:u,classNames:d,components:{affixWrapper:"div",groupWrapper:"div",wrapper:"div",groupAddon:"div"}},_.createElement(Yee,Qt({prefixCls:i,disabled:n,ref:zc(f,e),className:d==null?void 0:d.input},m)))});NN.displayName="InputNumber";const Xee="univer-input-number",qee="univer-input-number-focused",Gee="univer-input-number-handler-up",Kee="univer-input-number-handler-wrap",Zee="univer-input-number-handler",Qee="univer-input-number-handler-up-inner",Jee="univer-input-number-handler-down-inner",ete="univer-input-number-disabled",tte="univer-input-number-input-wrap",nte="univer-input-number-input",rte="univer-input-number-handler-down",ite="univer-input-number-handler-down-disabled",ote="univer-input-number-handler-up-disabled",ate={inputNumber:Xee,inputNumberFocused:qee,inputNumberHandlerUp:Gee,inputNumberHandlerWrap:Kee,inputNumberHandler:Zee,inputNumberHandlerUpInner:Qee,inputNumberHandlerDownInner:Jee,inputNumberDisabled:ete,inputNumberInputWrap:tte,inputNumberInput:nte,inputNumberHandlerDown:rte,inputNumberHandlerDownDisabled:ite,inputNumberHandlerUpDisabled:ote};function of(t){const{className:e,value:n,max:r,min:i,step:o=1,precision:a,disabled:s=!1,controls:u=!0,onClick:l,onKeyDown:c,onChange:d,onPressEnter:m}=t;function f(h){h!==null&&(d==null||d(h))}return Se.createElement(NN,{prefixCls:ate.inputNumber,className:e,value:n,max:r,min:i,step:o,precision:a,disabled:s,controls:u,onClick:l,onKeyDown:c,onChange:f,onPressEnter:m})}var ste=["prefixCls","invalidate","item","renderItem","responsive","responsiveDisabled","registerSize","itemKey","className","style","children","display","order","component"],d2=void 0;function ute(t,e){var n=t.prefixCls,r=t.invalidate,i=t.item,o=t.renderItem,a=t.responsive,s=t.responsiveDisabled,u=t.registerSize,l=t.itemKey,c=t.className,d=t.style,m=t.children,f=t.display,h=t.order,p=t.component,v=p===void 0?"div":p,g=Qn(t,ste),b=a&&!f;function C(R){u(l,R)}_.useEffect(function(){return function(){C(null)}},[]);var S=o&&i!==d2?o(i):m,E;r||(E={opacity:b?0:1,height:b?0:d2,overflowY:b?"hidden":d2,order:a?h:d2,pointerEvents:b?"none":d2,position:b?"absolute":d2});var y={};b&&(y["aria-hidden"]=!0);var D=_.createElement(v,Qt({className:Xt(!r&&n,c),style:$e($e({},E),d)},y,g,{ref:e}),S);return a&&(D=_.createElement(Yc,{onResize:function(R){var I=R.offsetWidth;C(I)},disabled:s},D)),D}var U6=_.forwardRef(ute);U6.displayName="Item";function lte(t){if(typeof MessageChannel>"u")Or(t);else{var e=new MessageChannel;e.port1.onmessage=function(){return t()},e.port2.postMessage(void 0)}}function cte(){var t=_.useRef(null),e=function(n){t.current||(t.current=[],lte(function(){Ac.unstable_batchedUpdates(function(){t.current.forEach(function(r){r()}),t.current=null})})),t.current.push(n)};return e}function kd(t,e){var n=_.useState(e),r=Qe(n,2),i=r[0],o=r[1],a=Na(function(s){t(function(){o(s)})});return[i,a]}var s9=Se.createContext(null),dte=["component"],mte=["className"],fte=["className"],hte=function(t,e){var n=_.useContext(s9);if(!n){var r=t.component,i=r===void 0?"div":r,o=Qn(t,dte);return _.createElement(i,Qt({},o,{ref:e}))}var a=n.className,s=Qn(n,mte),u=t.className,l=Qn(t,fte);return _.createElement(s9.Provider,{value:null},_.createElement(U6,Qt({ref:e,className:Xt(a,u)},s,l)))},xN=_.forwardRef(hte);xN.displayName="RawItem";var pte=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],FN="responsive",$N="invalidate";function gte(t){return"+ ".concat(t.length," ...")}function vte(t,e){var n=t.prefixCls,r=n===void 0?"rc-overflow":n,i=t.data,o=i===void 0?[]:i,a=t.renderItem,s=t.renderRawItem,u=t.itemKey,l=t.itemWidth,c=l===void 0?10:l,d=t.ssr,m=t.style,f=t.className,h=t.maxCount,p=t.renderRest,v=t.renderRawRest,g=t.suffix,b=t.component,C=b===void 0?"div":b,S=t.itemComponent,E=t.onVisibleChange,y=Qn(t,pte),D=d==="full",R=cte(),I=kd(R,null),T=Qe(I,2),P=T[0],N=T[1],B=P||0,W=kd(R,new Map),G=Qe(W,2),Q=G[0],te=G[1],X=kd(R,0),x=Qe(X,2),O=x[0],M=x[1],V=kd(R,0),q=Qe(V,2),ie=q[0],ce=q[1],pe=kd(R,0),oe=Qe(pe,2),he=oe[0],fe=oe[1],ve=_.useState(null),Ue=Qe(ve,2),ke=Ue[0],Te=Ue[1],Re=_.useState(null),rt=Qe(Re,2),_t=rt[0],mt=rt[1],nt=_.useMemo(function(){return _t===null&&D?Number.MAX_SAFE_INTEGER:_t||0},[_t,P]),_e=_.useState(!1),He=Qe(_e,2),et=He[0],Dt=He[1],Mt="".concat(r,"-item"),Bt=Math.max(O,ie),Zt=h===FN,It=o.length&&Zt,pn=h===$N,yn=It||typeof h=="number"&&o.length>h,$t=_.useMemo(function(){var Ze=o;return It?P===null&&D?Ze=o:Ze=o.slice(0,Math.min(o.length,B/c)):typeof h=="number"&&(Ze=o.slice(0,h)),Ze},[o,c,P,h,It]),Ht=_.useMemo(function(){return It?o.slice(nt+1):o.slice($t.length)},[o,$t,It,nt]),Nt=_.useCallback(function(Ze,st){var Me;return typeof u=="function"?u(Ze):(Me=u&&(Ze==null?void 0:Ze[u]))!==null&&Me!==void 0?Me:st},[u]),Ot=_.useCallback(a||function(Ze){return Ze},[a]);function En(Ze,st,Me){_t===Ze&&(st===void 0||st===ke)||(mt(Ze),Me||(Dt(Ze<o.length-1),E==null||E(Ze)),st!==void 0&&Te(st))}function Y(Ze,st){N(st.clientWidth)}function z(Ze,st){te(function(Me){var Le=new Map(Me);return st===null?Le.delete(Ze):Le.set(Ze,st),Le})}function ne(Ze,st){ce(st),M(ie)}function Ce(Ze,st){fe(st)}function Ve(Ze){return Q.get(Nt($t[Ze],Ze))}Kr(function(){if(B&&typeof Bt=="number"&&$t){var Ze=he,st=$t.length,Me=st-1;if(!st){En(0,null);return}for(var Le=0;Le<st;Le+=1){var Je=Ve(Le);if(D&&(Je=Je||0),Je===void 0){En(Le-1,void 0,!0);break}if(Ze+=Je,Me===0&&Ze<=B||Le===Me-1&&Ze+Ve(Me)<=B){En(Me,null);break}else if(Ze+Bt>B){En(Le-1,Ze-Je-he+ie);break}}g&&Ve(0)+he>B&&Te(null)}},[B,Q,ie,he,Nt,$t]);var Ke=et&&!!Ht.length,Pe={};ke!==null&&It&&(Pe={position:"absolute",left:ke,top:0});var Be={prefixCls:Mt,responsive:It,component:S,invalidate:pn},me=s?function(Ze,st){var Me=Nt(Ze,st);return _.createElement(s9.Provider,{key:Me,value:$e($e({},Be),{},{order:st,item:Ze,itemKey:Me,registerSize:z,display:st<=nt})},s(Ze,st))}:function(Ze,st){var Me=Nt(Ze,st);return _.createElement(U6,Qt({},Be,{order:st,key:Me,item:Ze,renderItem:Ot,itemKey:Me,registerSize:z,display:st<=nt}))},De,Ne={order:Ke?nt:Number.MAX_SAFE_INTEGER,className:"".concat(Mt,"-rest"),registerSize:ne,display:Ke};if(v)v&&(De=_.createElement(s9.Provider,{value:$e($e({},Be),Ne)},v(Ht)));else{var be=p||gte;De=_.createElement(U6,Qt({},Be,Ne),typeof be=="function"?be(Ht):be)}var ft=_.createElement(C,Qt({className:Xt(!pn&&r,f),style:m,ref:e},y),$t.map(me),yn?De:null,g&&_.createElement(U6,Qt({},Be,{responsive:Zt,responsiveDisabled:!It,order:nt,className:"".concat(Mt,"-suffix"),registerSize:Ce,display:!0,style:Pe}),g));return Zt&&(ft=_.createElement(Yc,{onResize:Y,disabled:!It},ft)),ft}var u1=_.forwardRef(vte);u1.displayName="Overflow";u1.Item=xN;u1.RESPONSIVE=FN;u1.INVALIDATE=$N;function kN(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=new Set;function i(o,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,u=r.has(o);if(wl(!u,"Warning: There may be circular references"),u)return!1;if(o===a)return!0;if(n&&s>1)return!1;r.add(o);var l=s+1;if(Array.isArray(o)){if(!Array.isArray(a)||o.length!==a.length)return!1;for(var c=0;c<o.length;c++)if(!i(o[c],a[c],l))return!1;return!0}if(o&&a&&Pr(o)==="object"&&Pr(a)==="object"){var d=Object.keys(o);return d.length!==Object.keys(a).length?!1:d.every(function(m){return i(o[m],a[m],l)})}return!1}return i(t,e)}var BN=_.createContext(null);function UN(t,e){return t===void 0?null:"".concat(t,"-").concat(e)}function VN(t){var e=_.useContext(BN);return UN(e,t)}var bte=["children","locked"],Os=_.createContext(null);function _te(t,e){var n=$e({},t);return Object.keys(e).forEach(function(r){var i=e[r];i!==void 0&&(n[r]=i)}),n}function ym(t){var e=t.children,n=t.locked,r=Qn(t,bte),i=_.useContext(Os),o=US(function(){return _te(i,r)},[i,r],function(a,s){return!n&&(a[0]!==s[0]||!kN(a[1],s[1],!0))});return _.createElement(Os.Provider,{value:o},e)}var Cte=[],HN=_.createContext(null);function j5(){return _.useContext(HN)}var jN=_.createContext(Cte);function af(t){var e=_.useContext(jN);return _.useMemo(function(){return t!==void 0?[].concat(Wr(e),[t]):e},[e,t])}var zN=_.createContext(null),QS=_.createContext({});function vI(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(LN(t)){var n=t.nodeName.toLowerCase(),r=["input","select","textarea","button"].includes(n)||t.isContentEditable||n==="a"&&!!t.getAttribute("href"),i=t.getAttribute("tabindex"),o=Number(i),a=null;return i&&!Number.isNaN(o)?a=o:r&&a===null&&(a=0),r&&t.disabled&&(a=null),a!==null&&(a>=0||e&&a<0)}return!1}function Ste(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Wr(t.querySelectorAll("*")).filter(function(r){return vI(r,e)});return vI(t,e)&&n.unshift(t),n}var Bb=lt.LEFT,Ub=lt.RIGHT,Vb=lt.UP,P4=lt.DOWN,M4=lt.ENTER,WN=lt.ESC,Bd=lt.HOME,Ud=lt.END,bI=[Vb,P4,Bb,Ub];function Ete(t,e,n,r){var i,o,a,s,u="prev",l="next",c="children",d="parent";if(t==="inline"&&r===M4)return{inlineTrigger:!0};var m=(i={},ut(i,Vb,u),ut(i,P4,l),i),f=(o={},ut(o,Bb,n?l:u),ut(o,Ub,n?u:l),ut(o,P4,c),ut(o,M4,c),o),h=(a={},ut(a,Vb,u),ut(a,P4,l),ut(a,M4,c),ut(a,WN,d),ut(a,Bb,n?c:d),ut(a,Ub,n?d:c),a),p={inline:m,horizontal:f,vertical:h,inlineSub:m,horizontalSub:h,verticalSub:h},v=(s=p["".concat(t).concat(e?"":"Sub")])===null||s===void 0?void 0:s[r];switch(v){case u:return{offset:-1,sibling:!0};case l:return{offset:1,sibling:!0};case d:return{offset:-1,sibling:!1};case c:return{offset:1,sibling:!1};default:return null}}function yte(t){for(var e=t;e;){if(e.getAttribute("data-menu-list"))return e;e=e.parentElement}return null}function Dte(t,e){for(var n=t||document.activeElement;n;){if(e.has(n))return n;n=n.parentElement}return null}function JS(t,e){var n=Ste(t,!0);return n.filter(function(r){return e.has(r)})}function _I(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!t)return null;var i=JS(t,e),o=i.length,a=i.findIndex(function(s){return n===s});return r<0?a===-1?a=o-1:a-=1:r>0&&(a+=1),a=(a+o)%o,i[a]}var Hb=function(t,e){var n=new Set,r=new Map,i=new Map;return t.forEach(function(o){var a=document.querySelector("[data-menu-id='".concat(UN(e,o),"']"));a&&(n.add(a),i.set(a,o),r.set(o,a))}),{elements:n,key2element:r,element2key:i}};function Rte(t,e,n,r,i,o,a,s,u,l){var c=_.useRef(),d=_.useRef();d.current=e;var m=function(){Or.cancel(c.current)};return _.useEffect(function(){return function(){m()}},[]),function(f){var h=f.which;if([].concat(bI,[M4,WN,Bd,Ud]).includes(h)){var p=o(),v=Hb(p,r),g=v,b=g.elements,C=g.key2element,S=g.element2key,E=C.get(e),y=Dte(E,b),D=S.get(y),R=Ete(t,a(D,!0).length===1,n,h);if(!R&&h!==Bd&&h!==Ud)return;(bI.includes(h)||[Bd,Ud].includes(h))&&f.preventDefault();var I=function(Q){if(Q){var te=Q,X=Q.querySelector("a");X!=null&&X.getAttribute("href")&&(te=X);var x=S.get(Q);s(x),m(),c.current=Or(function(){d.current===x&&te.focus()})}};if([Bd,Ud].includes(h)||R.sibling||!y){var T;!y||t==="inline"?T=i.current:T=yte(y);var P,N=JS(T,b);h===Bd?P=N[0]:h===Ud?P=N[N.length-1]:P=_I(T,b,y,R.offset),I(P)}else if(R.inlineTrigger)u(D);else if(R.offset>0)u(D,!0),m(),c.current=Or(function(){v=Hb(p,r);var Q=y.getAttribute("aria-controls"),te=document.getElementById(Q),X=_I(te,v.elements);I(X)},5);else if(R.offset<0){var B=a(D,!0),W=B[B.length-2],G=C.get(W);u(W,!1),I(G)}}l==null||l(f)}}function Ite(t){Promise.resolve().then(t)}var eE="__RC_UTIL_PATH_SPLIT__",CI=function(t){return t.join(eE)},Ate=function(t){return t.split(eE)},jb="rc-menu-more";function Tte(){var t=_.useState({}),e=Qe(t,2),n=e[1],r=_.useRef(new Map),i=_.useRef(new Map),o=_.useState([]),a=Qe(o,2),s=a[0],u=a[1],l=_.useRef(0),c=_.useRef(!1),d=function(){c.current||n({})},m=_.useCallback(function(C,S){var E=CI(S);i.current.set(E,C),r.current.set(C,E),l.current+=1;var y=l.current;Ite(function(){y===l.current&&d()})},[]),f=_.useCallback(function(C,S){var E=CI(S);i.current.delete(E),r.current.delete(C)},[]),h=_.useCallback(function(C){u(C)},[]),p=_.useCallback(function(C,S){var E=r.current.get(C)||"",y=Ate(E);return S&&s.includes(y[0])&&y.unshift(jb),y},[s]),v=_.useCallback(function(C,S){return C.some(function(E){var y=p(E,!0);return y.includes(S)})},[p]),g=function(){var C=Wr(r.current.keys());return s.length&&C.push(jb),C},b=_.useCallback(function(C){var S="".concat(r.current.get(C)).concat(eE),E=new Set;return Wr(i.current.keys()).forEach(function(y){y.startsWith(S)&&E.add(i.current.get(y))}),E},[]);return _.useEffect(function(){return function(){c.current=!0}},[]),{registerPath:m,unregisterPath:f,refreshOverflowKeys:h,isSubPathKey:v,getKeyPath:p,getKeys:g,getSubPathKeys:b}}function h6(t){var e=_.useRef(t);e.current=t;var n=_.useCallback(function(){for(var r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(o))},[]);return t?n:void 0}var wte=Math.random().toFixed(5).toString().slice(2),SI=0;function Lte(t){var e=Qu(t,{value:t}),n=Qe(e,2),r=n[0],i=n[1];return _.useEffect(function(){SI+=1;var o="".concat(wte,"-").concat(SI);i("rc-menu-uuid-".concat(o))},[]),r}function YN(t,e,n,r){var i=_.useContext(Os),o=i.activeKey,a=i.onActive,s=i.onInactive,u={active:o===t};return e||(u.onMouseEnter=function(l){n==null||n({key:t,domEvent:l}),a(t)},u.onMouseLeave=function(l){r==null||r({key:t,domEvent:l}),s(t)}),u}function XN(t){var e=_.useContext(Os),n=e.mode,r=e.rtl,i=e.inlineIndent;if(n!=="inline")return null;var o=t;return r?{paddingRight:o*i}:{paddingLeft:o*i}}function qN(t){var e=t.icon,n=t.props,r=t.children,i;return e===null||e===!1?null:(typeof e=="function"?i=_.createElement(e,$e({},n)):typeof e!="boolean"&&(i=e),i||r||null)}var Ote=["item"];function u9(t){var e=t.item,n=Qn(t,Ote);return Object.defineProperty(n,"item",{get:function(){return wl(!1,"`info.item` is deprecated since we will move to function component that not provides React Node instance in future."),e}}),n}var Pte=["title","attribute","elementRef"],Mte=["style","className","eventKey","warnKey","disabled","itemIcon","children","role","onMouseEnter","onMouseLeave","onClick","onKeyDown","onFocus"],Nte=["active"],xte=function(t){tf(n,t);var e=nf(n);function n(){return Al(this,n),e.apply(this,arguments)}return Tl(n,[{key:"render",value:function(){var r=this.props,i=r.title,o=r.attribute,a=r.elementRef,s=Qn(r,Pte),u=V5(s,["eventKey","popupClassName","popupOffset","onTitleClick"]);return wl(!o,"`attribute` of Menu.Item is deprecated. Please pass attribute directly."),_.createElement(u1.Item,Qt({},o,{title:typeof i=="string"?i:void 0},u,{ref:a}))}}]),n}(_.Component),Fte=_.forwardRef(function(t,e){var n,r=t.style,i=t.className,o=t.eventKey;t.warnKey;var a=t.disabled,s=t.itemIcon,u=t.children,l=t.role,c=t.onMouseEnter,d=t.onMouseLeave,m=t.onClick,f=t.onKeyDown,h=t.onFocus,p=Qn(t,Mte),v=VN(o),g=_.useContext(Os),b=g.prefixCls,C=g.onItemClick,S=g.disabled,E=g.overflowDisabled,y=g.itemIcon,D=g.selectedKeys,R=g.onActive,I=_.useContext(QS),T=I._internalRenderMenuItem,P="".concat(b,"-item"),N=_.useRef(),B=_.useRef(),W=S||a,G=nd(e,B),Q=af(o),te=function(fe){return{key:o,keyPath:Wr(Q).reverse(),item:N.current,domEvent:fe}},X=s||y,x=YN(o,W,c,d),O=x.active,M=Qn(x,Nte),V=D.includes(o),q=XN(Q.length),ie=function(fe){if(!W){var ve=te(fe);m==null||m(u9(ve)),C(ve)}},ce=function(fe){if(f==null||f(fe),fe.which===lt.ENTER){var ve=te(fe);m==null||m(u9(ve)),C(ve)}},pe=function(fe){R(o),h==null||h(fe)},oe={};t.role==="option"&&(oe["aria-selected"]=V);var he=_.createElement(xte,Qt({ref:N,elementRef:G,role:l===null?"none":l||"menuitem",tabIndex:a?null:-1,"data-menu-id":E&&v?null:v},p,M,oe,{component:"li","aria-disabled":a,style:$e($e({},q),r),className:Xt(P,(n={},ut(n,"".concat(P,"-active"),O),ut(n,"".concat(P,"-selected"),V),ut(n,"".concat(P,"-disabled"),W),n),i),onClick:ie,onKeyDown:ce,onFocus:pe}),u,_.createElement(qN,{props:$e($e({},t),{},{isSelected:V}),icon:X}));return T&&(he=T(he,t,{selected:V})),he});function $te(t,e){var n=t.eventKey,r=j5(),i=af(n);return _.useEffect(function(){if(r)return r.registerPath(n,i),function(){r.unregisterPath(n,i)}},[i]),r?null:_.createElement(Fte,Qt({},t,{ref:e}))}const z5=_.forwardRef($te);var kte=["className","children"],Bte=function(t,e){var n=t.className,r=t.children,i=Qn(t,kte),o=_.useContext(Os),a=o.prefixCls,s=o.mode,u=o.rtl;return _.createElement("ul",Qt({className:Xt(a,u&&"".concat(a,"-rtl"),"".concat(a,"-sub"),"".concat(a,"-").concat(s==="inline"?"inline":"vertical"),n),role:"menu"},i,{"data-menu-list":!0,ref:e}),r)},tE=_.forwardRef(Bte);tE.displayName="SubMenuList";function nE(t,e){return Sm(t).map(function(n,r){if(_.isValidElement(n)){var i,o,a=n.key,s=(i=(o=n.props)===null||o===void 0?void 0:o.eventKey)!==null&&i!==void 0?i:a,u=s==null;u&&(s="tmp_key-".concat([].concat(Wr(e),[r]).join("-")));var l={key:s,eventKey:s};return _.cloneElement(n,l)}return n})}var Qi={adjustX:1,adjustY:1},Ute={topLeft:{points:["bl","tl"],overflow:Qi},topRight:{points:["br","tr"],overflow:Qi},bottomLeft:{points:["tl","bl"],overflow:Qi},bottomRight:{points:["tr","br"],overflow:Qi},leftTop:{points:["tr","tl"],overflow:Qi},leftBottom:{points:["br","bl"],overflow:Qi},rightTop:{points:["tl","tr"],overflow:Qi},rightBottom:{points:["bl","br"],overflow:Qi}},Vte={topLeft:{points:["bl","tl"],overflow:Qi},topRight:{points:["br","tr"],overflow:Qi},bottomLeft:{points:["tl","bl"],overflow:Qi},bottomRight:{points:["tr","br"],overflow:Qi},rightTop:{points:["tr","tl"],overflow:Qi},rightBottom:{points:["br","bl"],overflow:Qi},leftTop:{points:["tl","tr"],overflow:Qi},leftBottom:{points:["bl","br"],overflow:Qi}};function GN(t,e,n){if(e)return e;if(n)return n[t]||n.other}var Hte={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"};function jte(t){var e=t.prefixCls,n=t.visible,r=t.children,i=t.popup,o=t.popupStyle,a=t.popupClassName,s=t.popupOffset,u=t.disabled,l=t.mode,c=t.onVisibleChange,d=_.useContext(Os),m=d.getPopupContainer,f=d.rtl,h=d.subMenuOpenDelay,p=d.subMenuCloseDelay,v=d.builtinPlacements,g=d.triggerSubMenuAction,b=d.forceSubMenuRender,C=d.rootClassName,S=d.motion,E=d.defaultMotions,y=_.useState(!1),D=Qe(y,2),R=D[0],I=D[1],T=$e(f?$e({},Vte):$e({},Ute),v),P=Hte[l],N=GN(l,S,E),B=_.useRef(N);l!=="inline"&&(B.current=N);var W=$e($e({},B.current),{},{leavedClassName:"".concat(e,"-hidden"),removeOnLeave:!1,motionAppear:!0}),G=_.useRef();return _.useEffect(function(){return G.current=Or(function(){I(n)}),function(){Or.cancel(G.current)}},[n]),_.createElement(U5,{prefixCls:e,popupClassName:Xt("".concat(e,"-popup"),ut({},"".concat(e,"-rtl"),f),a,C),stretch:l==="horizontal"?"minWidth":null,getPopupContainer:m,builtinPlacements:T,popupPlacement:P,popupVisible:R,popup:i,popupStyle:o,popupAlign:s&&{offset:s},action:u?[]:[g],mouseEnterDelay:h,mouseLeaveDelay:p,onPopupVisibleChange:c,forceRender:b,popupMotion:W,fresh:!0},r)}function zte(t){var e=t.id,n=t.open,r=t.keyPath,i=t.children,o="inline",a=_.useContext(Os),s=a.prefixCls,u=a.forceSubMenuRender,l=a.motion,c=a.defaultMotions,d=a.mode,m=_.useRef(!1);m.current=d===o;var f=_.useState(!m.current),h=Qe(f,2),p=h[0],v=h[1],g=m.current?n:!1;_.useEffect(function(){m.current&&v(!1)},[d]);var b=$e({},GN(o,l,c));r.length>1&&(b.motionAppear=!1);var C=b.onVisibleChanged;return b.onVisibleChanged=function(S){return!m.current&&!S&&v(!0),C==null?void 0:C(S)},p?null:_.createElement(ym,{mode:o,locked:!m.current},_.createElement(id,Qt({visible:g},b,{forceRender:u,removeOnLeave:!1,leavedClassName:"".concat(s,"-hidden")}),function(S){var E=S.className,y=S.style;return _.createElement(tE,{id:e,className:E,style:y},i)}))}var Wte=["style","className","title","eventKey","warnKey","disabled","internalPopupClose","children","itemIcon","expandIcon","popupClassName","popupOffset","popupStyle","onClick","onMouseEnter","onMouseLeave","onTitleClick","onTitleMouseEnter","onTitleMouseLeave"],Yte=["active"],Xte=function(t){var e,n=t.style,r=t.className,i=t.title,o=t.eventKey;t.warnKey;var a=t.disabled,s=t.internalPopupClose,u=t.children,l=t.itemIcon,c=t.expandIcon,d=t.popupClassName,m=t.popupOffset,f=t.popupStyle,h=t.onClick,p=t.onMouseEnter,v=t.onMouseLeave,g=t.onTitleClick,b=t.onTitleMouseEnter,C=t.onTitleMouseLeave,S=Qn(t,Wte),E=VN(o),y=_.useContext(Os),D=y.prefixCls,R=y.mode,I=y.openKeys,T=y.disabled,P=y.overflowDisabled,N=y.activeKey,B=y.selectedKeys,W=y.itemIcon,G=y.expandIcon,Q=y.onItemClick,te=y.onOpenChange,X=y.onActive,x=_.useContext(QS),O=x._internalRenderSubMenuItem,M=_.useContext(zN),V=M.isSubPathKey,q=af(),ie="".concat(D,"-submenu"),ce=T||a,pe=_.useRef(),oe=_.useRef(),he=l??W,fe=c??G,ve=I.includes(o),Ue=!P&&ve,ke=V(B,o),Te=YN(o,ce,b,C),Re=Te.active,rt=Qn(Te,Yte),_t=_.useState(!1),mt=Qe(_t,2),nt=mt[0],_e=mt[1],He=function(Y){ce||_e(Y)},et=function(Y){He(!0),p==null||p({key:o,domEvent:Y})},Dt=function(Y){He(!1),v==null||v({key:o,domEvent:Y})},Mt=_.useMemo(function(){return Re||(R!=="inline"?nt||V([N],o):!1)},[R,Re,N,nt,o,V]),Bt=XN(q.length),Zt=function(Y){ce||(g==null||g({key:o,domEvent:Y}),R==="inline"&&te(o,!ve))},It=h6(function(Y){h==null||h(u9(Y)),Q(Y)}),pn=function(Y){R!=="inline"&&te(o,Y)},yn=function(){X(o)},$t=E&&"".concat(E,"-popup"),Ht=_.createElement("div",Qt({role:"menuitem",style:Bt,className:"".concat(ie,"-title"),tabIndex:ce?null:-1,ref:pe,title:typeof i=="string"?i:null,"data-menu-id":P&&E?null:E,"aria-expanded":Ue,"aria-haspopup":!0,"aria-controls":$t,"aria-disabled":ce,onClick:Zt,onFocus:yn},rt),i,_.createElement(qN,{icon:R!=="horizontal"?fe:void 0,props:$e($e({},t),{},{isOpen:Ue,isSubMenu:!0})},_.createElement("i",{className:"".concat(ie,"-arrow")}))),Nt=_.useRef(R);if(R!=="inline"&&q.length>1?Nt.current="vertical":Nt.current=R,!P){var Ot=Nt.current;Ht=_.createElement(jte,{mode:Ot,prefixCls:ie,visible:!s&&Ue&&R!=="inline",popupClassName:d,popupOffset:m,popupStyle:f,popup:_.createElement(ym,{mode:Ot==="horizontal"?"vertical":Ot},_.createElement(tE,{id:$t,ref:oe},u)),disabled:ce,onVisibleChange:pn},Ht)}var En=_.createElement(u1.Item,Qt({role:"none"},S,{component:"li",style:n,className:Xt(ie,"".concat(ie,"-").concat(R),r,(e={},ut(e,"".concat(ie,"-open"),Ue),ut(e,"".concat(ie,"-active"),Mt),ut(e,"".concat(ie,"-selected"),ke),ut(e,"".concat(ie,"-disabled"),ce),e)),onMouseEnter:et,onMouseLeave:Dt}),Ht,!P&&_.createElement(zte,{id:$t,open:Ue,keyPath:q},u));return O&&(En=O(En,t,{selected:ke,active:Mt,open:Ue,disabled:ce})),_.createElement(ym,{onItemClick:It,mode:R==="horizontal"?"vertical":R,itemIcon:he,expandIcon:fe},En)};function W5(t){var e=t.eventKey,n=t.children,r=af(e),i=nE(n,r),o=j5();_.useEffect(function(){if(o)return o.registerPath(e,r),function(){o.unregisterPath(e,r)}},[r]);var a;return o?a=i:a=_.createElement(Xte,t,i),_.createElement(jN.Provider,{value:r},a)}var qte=["className","title","eventKey","children"],Gte=["children"],Kte=function(t){var e=t.className,n=t.title;t.eventKey;var r=t.children,i=Qn(t,qte),o=_.useContext(Os),a=o.prefixCls,s="".concat(a,"-item-group");return _.createElement("li",Qt({role:"presentation"},i,{onClick:function(u){return u.stopPropagation()},className:Xt(s,e)}),_.createElement("div",{role:"presentation",className:"".concat(s,"-title"),title:typeof n=="string"?n:void 0},n),_.createElement("ul",{role:"group",className:"".concat(s,"-list")},r))};function rE(t){var e=t.children,n=Qn(t,Gte),r=af(n.eventKey),i=nE(e,r),o=j5();return o?i:_.createElement(Kte,V5(n,["warnKey"]),i)}function KN(t){var e=t.className,n=t.style,r=_.useContext(Os),i=r.prefixCls,o=j5();return o?null:_.createElement("li",{role:"separator",className:Xt("".concat(i,"-item-divider"),e),style:n})}var Zte=["label","children","key","type"];function zb(t){return(t||[]).map(function(e,n){if(e&&Pr(e)==="object"){var r=e,i=r.label,o=r.children,a=r.key,s=r.type,u=Qn(r,Zte),l=a??"tmp-".concat(n);return o||s==="group"?s==="group"?_.createElement(rE,Qt({key:l},u,{title:i}),zb(o)):_.createElement(W5,Qt({key:l},u,{title:i}),zb(o)):s==="divider"?_.createElement(KN,Qt({key:l},u)):_.createElement(z5,Qt({key:l},u),i)}return null}).filter(function(e){return e})}function Qte(t,e,n){var r=t;return e&&(r=zb(e)),nE(r,n)}var Jte=["prefixCls","rootClassName","style","className","tabIndex","items","children","direction","id","mode","inlineCollapsed","disabled","disabledOverflow","subMenuOpenDelay","subMenuCloseDelay","forceSubMenuRender","defaultOpenKeys","openKeys","activeKey","defaultActiveFirst","selectable","multiple","defaultSelectedKeys","selectedKeys","onSelect","onDeselect","inlineIndent","motion","defaultMotions","triggerSubMenuAction","builtinPlacements","itemIcon","expandIcon","overflowedIndicator","overflowedIndicatorPopupClassName","getPopupContainer","onClick","onOpenChange","onKeyDown","openAnimation","openTransitionName","_internalRenderMenuItem","_internalRenderSubMenuItem"],m2=[],ene=_.forwardRef(function(t,e){var n,r,i=t,o=i.prefixCls,a=o===void 0?"rc-menu":o,s=i.rootClassName,u=i.style,l=i.className,c=i.tabIndex,d=c===void 0?0:c,m=i.items,f=i.children,h=i.direction,p=i.id,v=i.mode,g=v===void 0?"vertical":v,b=i.inlineCollapsed,C=i.disabled,S=i.disabledOverflow,E=i.subMenuOpenDelay,y=E===void 0?.1:E,D=i.subMenuCloseDelay,R=D===void 0?.1:D,I=i.forceSubMenuRender,T=i.defaultOpenKeys,P=i.openKeys,N=i.activeKey,B=i.defaultActiveFirst,W=i.selectable,G=W===void 0?!0:W,Q=i.multiple,te=Q===void 0?!1:Q,X=i.defaultSelectedKeys,x=i.selectedKeys,O=i.onSelect,M=i.onDeselect,V=i.inlineIndent,q=V===void 0?24:V,ie=i.motion,ce=i.defaultMotions,pe=i.triggerSubMenuAction,oe=pe===void 0?"hover":pe,he=i.builtinPlacements,fe=i.itemIcon,ve=i.expandIcon,Ue=i.overflowedIndicator,ke=Ue===void 0?"...":Ue,Te=i.overflowedIndicatorPopupClassName,Re=i.getPopupContainer,rt=i.onClick,_t=i.onOpenChange,mt=i.onKeyDown;i.openAnimation,i.openTransitionName;var nt=i._internalRenderMenuItem,_e=i._internalRenderSubMenuItem,He=Qn(i,Jte),et=_.useMemo(function(){return Qte(f,m,m2)},[f,m]),Dt=_.useState(!1),Mt=Qe(Dt,2),Bt=Mt[0],Zt=Mt[1],It=_.useRef(),pn=Lte(p),yn=h==="rtl",$t=Qu(T,{value:P,postState:function(le){return le||m2}}),Ht=Qe($t,2),Nt=Ht[0],Ot=Ht[1],En=function(le){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;function re(){Ot(le),_t==null||_t(le)}de?Ac.flushSync(re):re()},Y=_.useState(Nt),z=Qe(Y,2),ne=z[0],Ce=z[1],Ve=_.useRef(!1),Ke=_.useMemo(function(){return(g==="inline"||g==="vertical")&&b?["vertical",b]:[g,!1]},[g,b]),Pe=Qe(Ke,2),Be=Pe[0],me=Pe[1],De=Be==="inline",Ne=_.useState(Be),be=Qe(Ne,2),ft=be[0],Ze=be[1],st=_.useState(me),Me=Qe(st,2),Le=Me[0],Je=Me[1];_.useEffect(function(){Ze(Be),Je(me),Ve.current&&(De?Ot(ne):En(m2))},[Be,me]);var Xe=_.useState(0),Et=Qe(Xe,2),wt=Et[0],Cn=Et[1],jn=wt>=et.length-1||ft!=="horizontal"||S;_.useEffect(function(){De&&Ce(Nt)},[Nt]),_.useEffect(function(){return Ve.current=!0,function(){Ve.current=!1}},[]);var nr=Tte(),St=nr.registerPath,Ln=nr.unregisterPath,Yn=nr.refreshOverflowKeys,tn=nr.isSubPathKey,at=nr.getKeyPath,xe=nr.getKeys,An=nr.getSubPathKeys,vn=_.useMemo(function(){return{registerPath:St,unregisterPath:Ln}},[St,Ln]),Rr=_.useMemo(function(){return{isSubPathKey:tn}},[tn]);_.useEffect(function(){Yn(jn?m2:et.slice(wt+1).map(function(le){return le.key}))},[wt,jn]);var Nr=Qu(N||B&&((n=et[0])===null||n===void 0?void 0:n.key),{value:N}),wi=Qe(Nr,2),di=wi[0],uo=wi[1],Li=h6(function(le){uo(le)}),Ei=h6(function(){uo(void 0)});_.useImperativeHandle(e,function(){return{list:It.current,focus:function(le){var de,re=xe(),Ee=Hb(re,pn),ze=Ee.elements,qe=Ee.key2element,tt=Ee.element2key,it=JS(It.current,ze),Pt=di??(it[0]?tt.get(it[0]):(de=et.find(function(Dn){return!Dn.props.disabled}))===null||de===void 0?void 0:de.key),sn=qe.get(Pt);if(Pt&&sn){var On;sn==null||(On=sn.focus)===null||On===void 0||On.call(sn,le)}}}});var lo=Qu(X||[],{value:x,postState:function(le){return Array.isArray(le)?le:le==null?m2:[le]}}),Vs=Qe(lo,2),oi=Vs[0],ya=Vs[1],ea=function(le){if(G){var de=le.key,re=oi.includes(de),Ee;te?re?Ee=oi.filter(function(qe){return qe!==de}):Ee=[].concat(Wr(oi),[de]):Ee=[de],ya(Ee);var ze=$e($e({},le),{},{selectedKeys:Ee});re?M==null||M(ze):O==null||O(ze)}!te&&Nt.length&&ft!=="inline"&&En(m2)},ji=h6(function(le){rt==null||rt(u9(le)),ea(le)}),zi=h6(function(le,de){var re=Nt.filter(function(ze){return ze!==le});if(de)re.push(le);else if(ft!=="inline"){var Ee=An(le);re=re.filter(function(ze){return!Ee.has(ze)})}kN(Nt,re,!0)||En(re,!0)}),ta=function(le,de){var re=de??!Nt.includes(le);zi(le,re)},Da=Rte(ft,di,yn,pn,It,xe,at,uo,ta,mt);_.useEffect(function(){Zt(!0)},[]);var $=_.useMemo(function(){return{_internalRenderMenuItem:nt,_internalRenderSubMenuItem:_e}},[nt,_e]),J=ft!=="horizontal"||S?et:et.map(function(le,de){return _.createElement(ym,{key:le.key,overflowDisabled:de>wt},le)}),Z=_.createElement(u1,Qt({id:p,ref:It,prefixCls:"".concat(a,"-overflow"),component:"ul",itemComponent:z5,className:Xt(a,"".concat(a,"-root"),"".concat(a,"-").concat(ft),l,(r={},ut(r,"".concat(a,"-inline-collapsed"),Le),ut(r,"".concat(a,"-rtl"),yn),r),s),dir:h,style:u,role:"menu",tabIndex:d,data:J,renderRawItem:function(le){return le},renderRawRest:function(le){var de=le.length,re=de?et.slice(-de):null;return _.createElement(W5,{eventKey:jb,title:ke,disabled:jn,internalPopupClose:de===0,popupClassName:Te},re)},maxCount:ft!=="horizontal"||S?u1.INVALIDATE:u1.RESPONSIVE,ssr:"full","data-menu-list":!0,onVisibleChange:function(le){Cn(le)},onKeyDown:Da},He));return _.createElement(QS.Provider,{value:$},_.createElement(BN.Provider,{value:pn},_.createElement(ym,{prefixCls:a,rootClassName:s,mode:ft,openKeys:Nt,rtl:yn,disabled:C,motion:Bt?ie:null,defaultMotions:Bt?ce:null,activeKey:di,onActive:Li,onInactive:Ei,selectedKeys:oi,inlineIndent:q,subMenuOpenDelay:y,subMenuCloseDelay:R,forceSubMenuRender:I,builtinPlacements:he,triggerSubMenuAction:oe,getPopupContainer:Re,itemIcon:fe,expandIcon:ve,onItemClick:ji,onOpenChange:zi},_.createElement(zN.Provider,{value:Rr},Z),_.createElement("div",{style:{display:"none"},"aria-hidden":!0},_.createElement(HN.Provider,{value:vn},et)))))}),sf=ene;sf.Item=z5;sf.SubMenu=W5;sf.ItemGroup=rE;sf.Divider=KN;const tne="univer-menu",nne="univer-menu-vertical",rne="univer-menu-hidden",ine="univer-menu-submenu-hidden",one="univer-menu-item-group",ane="univer-menu-item-group-list",sne="univer-menu-item-group-title",une="univer-menu-item-active",lne="univer-menu-submenu-active",cne="univer-menu-item-selected",dne="univer-menu-submenu-selected",mne="univer-menu-submenu",fne="univer-menu-horizontal",hne="univer-menu-sub",pne="univer-menu-vertical-left",gne="univer-menu-vertical-right",vne="univer-menu-item",bne="univer-menu-item-disabled",_ne="univer-menu-submenu-disabled",Cne="univer-menu-submenu-popup",Sne="univer-submenu-title-wrapper",Ene="univer-menu-submenu-title",yne="univer-menu-submenu-title-more-icon",Dne="univer-menu-item-more-icon",Rne="univer-menu-inline",Ine="univer-menu-submenu-arrow",Ane="univer-menu-open-slide-up-enter",Tne="univer-menu-open-slide-up-appear",wne="univer-menu-open-slide-up-leave",Lne="univer-menu-open-slide-up-enter-active",One="univer-menu-open-slide-up-appear-active",Pne="univer-menu-open-slide-up-in",Mne="univer-menu-open-slide-up-leave-active",Nne="univer-menu-open-slide-up-out",xne="univer-menu-open-zoom-enter",Fne="univer-menu-open-zoom-appear",$ne="univer-menu-open-zoom-leave",kne="univer-menu-open-zoom-enter-active",Bne="univer-menu-open-zoom-appear-active",Une="univer-menu-open-zoom-in",Vne="univer-menu-open-zoom-leave-active",Hne="univer-menu-open-zoom-out",jne={menu:tne,menuVertical:nne,menuHidden:rne,menuSubmenuHidden:ine,menuItemGroup:one,menuItemGroupList:ane,menuItemGroupTitle:sne,menuItemActive:une,menuSubmenuActive:lne,menuItemSelected:cne,menuSubmenuSelected:dne,menuSubmenu:mne,menuHorizontal:fne,menuSub:hne,menuVerticalLeft:pne,menuVerticalRight:gne,menuItem:vne,menuItemDisabled:bne,menuSubmenuDisabled:_ne,menuSubmenuPopup:Cne,submenuTitleWrapper:Sne,menuSubmenuTitle:Ene,menuSubmenuTitleMoreIcon:yne,menuItemMoreIcon:Dne,menuInline:Rne,menuSubmenuArrow:Ine,menuOpenSlideUpEnter:Ane,menuOpenSlideUpAppear:Tne,menuOpenSlideUpLeave:wne,menuOpenSlideUpEnterActive:Lne,menuOpenSlideUpAppearActive:One,menuOpenSlideUpIn:Pne,menuOpenSlideUpLeaveActive:Mne,menuOpenSlideUpOut:Nne,menuOpenZoomEnter:xne,menuOpenZoomAppear:Fne,menuOpenZoomLeave:$ne,menuOpenZoomEnterActive:kne,menuOpenZoomAppearActive:Bne,menuOpenZoomIn:Une,menuOpenZoomLeaveActive:Vne,menuOpenZoomOut:Hne};function ZN(t){const{mountContainer:e}=_.useContext(su);return Se.cloneElement(Se.createElement(sf,{prefixCls:jne.menu,getPopupContainer:()=>e}),{...t})}function l9(t){return Se.cloneElement(Se.createElement(z5,null),{...t})}function EI(t){return Se.cloneElement(Se.createElement(W5,null),{...t})}function zne(t){return Se.cloneElement(Se.createElement(rE,null),{...t})}var uf={},QN={exports:{}},JN={exports:{}};(function(t){function e(n){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(JN);var lf=JN.exports;(function(t){var e=lf.default;function n(i){if(typeof WeakMap!="function")return null;var o=new WeakMap,a=new WeakMap;return(n=function(s){return s?a:o})(i)}function r(i,o){if(!o&&i&&i.__esModule)return i;if(i===null||e(i)!="object"&&typeof i!="function")return{default:i};var a=n(o);if(a&&a.has(i))return a.get(i);var s={__proto__:null},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in i)if(l!=="default"&&Object.prototype.hasOwnProperty.call(i,l)){var c=u?Object.getOwnPropertyDescriptor(i,l):null;c&&(c.get||c.set)?Object.defineProperty(s,l,c):s[l]=i[l]}return s.default=i,a&&a.set(i,s),s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(QN);var Wne=QN.exports,ex={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(ex);var Yne=ex.exports,tx={exports:{}};(function(t){var e=lf.default;function n(){t.exports=n=function(){return i},t.exports.__esModule=!0,t.exports.default=t.exports;var r,i={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(x,O,M){x[O]=M.value},u=typeof Symbol=="function"?Symbol:{},l=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",d=u.toStringTag||"@@toStringTag";function m(x,O,M){return Object.defineProperty(x,O,{value:M,enumerable:!0,configurable:!0,writable:!0}),x[O]}try{m({},"")}catch{m=function(x,O,M){return x[O]=M}}function f(x,O,M,V){var q=O&&O.prototype instanceof S?O:S,ie=Object.create(q.prototype),ce=new te(V||[]);return s(ie,"_invoke",{value:B(x,M,ce)}),ie}function h(x,O,M){try{return{type:"normal",arg:x.call(O,M)}}catch(V){return{type:"throw",arg:V}}}i.wrap=f;var p="suspendedStart",v="suspendedYield",g="executing",b="completed",C={};function S(){}function E(){}function y(){}var D={};m(D,l,function(){return this});var R=Object.getPrototypeOf,I=R&&R(R(X([])));I&&I!==o&&a.call(I,l)&&(D=I);var T=y.prototype=S.prototype=Object.create(D);function P(x){["next","throw","return"].forEach(function(O){m(x,O,function(M){return this._invoke(O,M)})})}function N(x,O){function M(q,ie,ce,pe){var oe=h(x[q],x,ie);if(oe.type!=="throw"){var he=oe.arg,fe=he.value;return fe&&e(fe)=="object"&&a.call(fe,"__await")?O.resolve(fe.__await).then(function(ve){M("next",ve,ce,pe)},function(ve){M("throw",ve,ce,pe)}):O.resolve(fe).then(function(ve){he.value=ve,ce(he)},function(ve){return M("throw",ve,ce,pe)})}pe(oe.arg)}var V;s(this,"_invoke",{value:function(q,ie){function ce(){return new O(function(pe,oe){M(q,ie,pe,oe)})}return V=V?V.then(ce,ce):ce()}})}function B(x,O,M){var V=p;return function(q,ie){if(V===g)throw new Error("Generator is already running");if(V===b){if(q==="throw")throw ie;return{value:r,done:!0}}for(M.method=q,M.arg=ie;;){var ce=M.delegate;if(ce){var pe=W(ce,M);if(pe){if(pe===C)continue;return pe}}if(M.method==="next")M.sent=M._sent=M.arg;else if(M.method==="throw"){if(V===p)throw V=b,M.arg;M.dispatchException(M.arg)}else M.method==="return"&&M.abrupt("return",M.arg);V=g;var oe=h(x,O,M);if(oe.type==="normal"){if(V=M.done?b:v,oe.arg===C)continue;return{value:oe.arg,done:M.done}}oe.type==="throw"&&(V=b,M.method="throw",M.arg=oe.arg)}}}function W(x,O){var M=O.method,V=x.iterator[M];if(V===r)return O.delegate=null,M==="throw"&&x.iterator.return&&(O.method="return",O.arg=r,W(x,O),O.method==="throw")||M!=="return"&&(O.method="throw",O.arg=new TypeError("The iterator does not provide a '"+M+"' method")),C;var q=h(V,x.iterator,O.arg);if(q.type==="throw")return O.method="throw",O.arg=q.arg,O.delegate=null,C;var ie=q.arg;return ie?ie.done?(O[x.resultName]=ie.value,O.next=x.nextLoc,O.method!=="return"&&(O.method="next",O.arg=r),O.delegate=null,C):ie:(O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,C)}function G(x){var O={tryLoc:x[0]};1 in x&&(O.catchLoc=x[1]),2 in x&&(O.finallyLoc=x[2],O.afterLoc=x[3]),this.tryEntries.push(O)}function Q(x){var O=x.completion||{};O.type="normal",delete O.arg,x.completion=O}function te(x){this.tryEntries=[{tryLoc:"root"}],x.forEach(G,this),this.reset(!0)}function X(x){if(x||x===""){var O=x[l];if(O)return O.call(x);if(typeof x.next=="function")return x;if(!isNaN(x.length)){var M=-1,V=function q(){for(;++M<x.length;)if(a.call(x,M))return q.value=x[M],q.done=!1,q;return q.value=r,q.done=!0,q};return V.next=V}}throw new TypeError(e(x)+" is not iterable")}return E.prototype=y,s(T,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:E,configurable:!0}),E.displayName=m(y,d,"GeneratorFunction"),i.isGeneratorFunction=function(x){var O=typeof x=="function"&&x.constructor;return!!O&&(O===E||(O.displayName||O.name)==="GeneratorFunction")},i.mark=function(x){return Object.setPrototypeOf?Object.setPrototypeOf(x,y):(x.__proto__=y,m(x,d,"GeneratorFunction")),x.prototype=Object.create(T),x},i.awrap=function(x){return{__await:x}},P(N.prototype),m(N.prototype,c,function(){return this}),i.AsyncIterator=N,i.async=function(x,O,M,V,q){q===void 0&&(q=Promise);var ie=new N(f(x,O,M,V),q);return i.isGeneratorFunction(O)?ie:ie.next().then(function(ce){return ce.done?ce.value:ie.next()})},P(T),m(T,d,"Generator"),m(T,l,function(){return this}),m(T,"toString",function(){return"[object Generator]"}),i.keys=function(x){var O=Object(x),M=[];for(var V in O)M.push(V);return M.reverse(),function q(){for(;M.length;){var ie=M.pop();if(ie in O)return q.value=ie,q.done=!1,q}return q.done=!0,q}},i.values=X,te.prototype={constructor:te,reset:function(x){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(Q),!x)for(var O in this)O.charAt(0)==="t"&&a.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=r)},stop:function(){this.done=!0;var x=this.tryEntries[0].completion;if(x.type==="throw")throw x.arg;return this.rval},dispatchException:function(x){if(this.done)throw x;var O=this;function M(oe,he){return ie.type="throw",ie.arg=x,O.next=oe,he&&(O.method="next",O.arg=r),!!he}for(var V=this.tryEntries.length-1;V>=0;--V){var q=this.tryEntries[V],ie=q.completion;if(q.tryLoc==="root")return M("end");if(q.tryLoc<=this.prev){var ce=a.call(q,"catchLoc"),pe=a.call(q,"finallyLoc");if(ce&&pe){if(this.prev<q.catchLoc)return M(q.catchLoc,!0);if(this.prev<q.finallyLoc)return M(q.finallyLoc)}else if(ce){if(this.prev<q.catchLoc)return M(q.catchLoc,!0)}else{if(!pe)throw new Error("try statement without catch or finally");if(this.prev<q.finallyLoc)return M(q.finallyLoc)}}}},abrupt:function(x,O){for(var M=this.tryEntries.length-1;M>=0;--M){var V=this.tryEntries[M];if(V.tryLoc<=this.prev&&a.call(V,"finallyLoc")&&this.prev<V.finallyLoc){var q=V;break}}q&&(x==="break"||x==="continue")&&q.tryLoc<=O&&O<=q.finallyLoc&&(q=null);var ie=q?q.completion:{};return ie.type=x,ie.arg=O,q?(this.method="next",this.next=q.finallyLoc,C):this.complete(ie)},complete:function(x,O){if(x.type==="throw")throw x.arg;return x.type==="break"||x.type==="continue"?this.next=x.arg:x.type==="return"?(this.rval=this.arg=x.arg,this.method="return",this.next="end"):x.type==="normal"&&O&&(this.next=O),C},finish:function(x){for(var O=this.tryEntries.length-1;O>=0;--O){var M=this.tryEntries[O];if(M.finallyLoc===x)return this.complete(M.completion,M.afterLoc),Q(M),C}},catch:function(x){for(var O=this.tryEntries.length-1;O>=0;--O){var M=this.tryEntries[O];if(M.tryLoc===x){var V=M.completion;if(V.type==="throw"){var q=V.arg;Q(M)}return q}}throw new Error("illegal catch attempt")},delegateYield:function(x,O,M){return this.delegate={iterator:X(x),resultName:O,nextLoc:M},this.method==="next"&&(this.arg=r),C}},i}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(tx);var Xne=tx.exports,nx={exports:{}};(function(t){function e(r,i,o,a,s,u,l){try{var c=r[u](l),d=c.value}catch(m){o(m);return}c.done?i(d):Promise.resolve(d).then(a,s)}function n(r){return function(){var i=this,o=arguments;return new Promise(function(a,s){var u=r.apply(i,o);function l(d){e(u,a,s,l,c,"next",d)}function c(d){e(u,a,s,l,c,"throw",d)}l(void 0)})}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(nx);var qne=nx.exports,rx={exports:{}},ix={exports:{}},ox={exports:{}},ax={exports:{}};(function(t){var e=lf.default;function n(r,i){if(e(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var a=o.call(r,i||"default");if(e(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ax);var Gne=ax.exports;(function(t){var e=lf.default,n=Gne;function r(i){var o=n(i,"string");return e(o)=="symbol"?o:String(o)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(ox);var Kne=ox.exports;(function(t){var e=Kne;function n(r,i,o){return i=e(i),i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(ix);var Zne=ix.exports;(function(t){var e=Zne;function n(i,o){var a=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);o&&(s=s.filter(function(u){return Object.getOwnPropertyDescriptor(i,u).enumerable})),a.push.apply(a,s)}return a}function r(i){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?n(Object(a),!0).forEach(function(s){e(i,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(a,s))})}return i}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(rx);var Qne=rx.exports,Jne=Wne.default,Y5=Yne.default;Object.defineProperty(uf,"__esModule",{value:!0});uf._r=cre;uf._u=hre;var ere=uf.render=dre;uf.unmount=pre;var c9=Y5(Xne),sx=Y5(qne),tre=Y5(lf),nre=Y5(Qne),rre=Jne(o1),cf=(0,nre.default)({},rre),ire=cf.version,ore=cf.render,are=cf.unmountComponentAtNode,X5;try{var sre=Number((ire||"").split(".")[0]);sre>=18&&(X5=cf.createRoot)}catch{}function yI(t){var e=cf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&(0,tre.default)(e)==="object"&&(e.usingClientEntryPoint=t)}var d9="__rc_react_root__";function ure(t,e){yI(!0);var n=e[d9]||X5(e);yI(!1),n.render(t),e[d9]=n}function lre(t,e){ore(t,e)}function cre(t,e){}function dre(t,e){if(X5){ure(t,e);return}lre(t,e)}function mre(t){return Wb.apply(this,arguments)}function Wb(){return Wb=(0,sx.default)((0,c9.default)().mark(function t(e){return(0,c9.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Promise.resolve().then(function(){var r;(r=e[d9])===null||r===void 0||r.unmount(),delete e[d9]}));case 1:case"end":return n.stop()}},t)})),Wb.apply(this,arguments)}function fre(t){are(t)}function hre(t){}function pre(t){return Yb.apply(this,arguments)}function Yb(){return Yb=(0,sx.default)((0,c9.default)().mark(function t(e){return(0,c9.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(X5===void 0){n.next=2;break}return n.abrupt("return",mre(e));case 2:fre(e);case 3:case"end":return n.stop()}},t)})),Yb.apply(this,arguments)}function iE(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t9(t,e)}function gre(t,e){return t.classList?!!e&&t.classList.contains(e):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")!==-1}function vre(t,e){t.classList?t.classList.add(e):gre(t,e)||(typeof t.className=="string"?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))}function DI(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function bre(t,e){t.classList?t.classList.remove(e):typeof t.className=="string"?t.className=DI(t.className,e):t.setAttribute("class",DI(t.className&&t.className.baseVal||"",e))}const RI={disabled:!1},m9=Se.createContext(null);var ux=function(t){return t.scrollTop},p6="unmounted",Gl="exited",Kl="entering",x2="entered",Xb="exiting",uu=function(t){iE(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var a=i,s=a&&!a.isMounting?r.enter:r.appear,u;return o.appearStatus=null,r.in?s?(u=Gl,o.appearStatus=Kl):u=x2:r.unmountOnExit||r.mountOnEnter?u=p6:u=Gl,o.state={status:u},o.nextCallback=null,o}e.getDerivedStateFromProps=function(r,i){var o=r.in;return o&&i.status===p6?{status:Gl}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(r){var i=null;if(r!==this.props){var o=this.state.status;this.props.in?o!==Kl&&o!==x2&&(i=Kl):(o===Kl||o===x2)&&(i=Xb)}this.updateStatus(!1,i)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var r=this.props.timeout,i,o,a;return i=o=a=r,r!=null&&typeof r!="number"&&(i=r.exit,o=r.enter,a=r.appear!==void 0?r.appear:o),{exit:i,enter:o,appear:a}},n.updateStatus=function(r,i){if(r===void 0&&(r=!1),i!==null)if(this.cancelNextCallback(),i===Kl){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:o1.findDOMNode(this);o&&ux(o)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Gl&&this.setState({status:p6})},n.performEnter=function(r){var i=this,o=this.props.enter,a=this.context?this.context.isMounting:r,s=this.props.nodeRef?[a]:[o1.findDOMNode(this),a],u=s[0],l=s[1],c=this.getTimeouts(),d=a?c.appear:c.enter;if(!r&&!o||RI.disabled){this.safeSetState({status:x2},function(){i.props.onEntered(u)});return}this.props.onEnter(u,l),this.safeSetState({status:Kl},function(){i.props.onEntering(u,l),i.onTransitionEnd(d,function(){i.safeSetState({status:x2},function(){i.props.onEntered(u,l)})})})},n.performExit=function(){var r=this,i=this.props.exit,o=this.getTimeouts(),a=this.props.nodeRef?void 0:o1.findDOMNode(this);if(!i||RI.disabled){this.safeSetState({status:Gl},function(){r.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:Xb},function(){r.props.onExiting(a),r.onTransitionEnd(o.exit,function(){r.safeSetState({status:Gl},function(){r.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(r,i){i=this.setNextCallback(i),this.setState(r,i)},n.setNextCallback=function(r){var i=this,o=!0;return this.nextCallback=function(a){o&&(o=!1,i.nextCallback=null,r(a))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},n.onTransitionEnd=function(r,i){this.setNextCallback(i);var o=this.props.nodeRef?this.props.nodeRef.current:o1.findDOMNode(this),a=r==null&&!this.props.addEndListener;if(!o||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var s=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],u=s[0],l=s[1];this.props.addEndListener(u,l)}r!=null&&setTimeout(this.nextCallback,r)},n.render=function(){var r=this.state.status;if(r===p6)return null;var i=this.props,o=i.children;i.in,i.mountOnEnter,i.unmountOnExit,i.appear,i.enter,i.exit,i.timeout,i.addEndListener,i.onEnter,i.onEntering,i.onEntered,i.onExit,i.onExiting,i.onExited,i.nodeRef;var a=y5(i,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Se.createElement(m9.Provider,{value:null},typeof o=="function"?o(r,a):Se.cloneElement(Se.Children.only(o),a))},e}(Se.Component);uu.contextType=m9;uu.propTypes={};function f2(){}uu.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:f2,onEntering:f2,onEntered:f2,onExit:f2,onExiting:f2,onExited:f2};uu.UNMOUNTED=p6;uu.EXITED=Gl;uu.ENTERING=Kl;uu.ENTERED=x2;uu.EXITING=Xb;const _re=uu;var Cre=function(t,e){return t&&e&&e.split(" ").forEach(function(n){return vre(t,n)})},ng=function(t,e){return t&&e&&e.split(" ").forEach(function(n){return bre(t,n)})},oE=function(t){iE(e,t);function e(){for(var r,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=t.call.apply(t,[this].concat(o))||this,r.appliedClasses={appear:{},enter:{},exit:{}},r.onEnter=function(s,u){var l=r.resolveArguments(s,u),c=l[0],d=l[1];r.removeClasses(c,"exit"),r.addClass(c,d?"appear":"enter","base"),r.props.onEnter&&r.props.onEnter(s,u)},r.onEntering=function(s,u){var l=r.resolveArguments(s,u),c=l[0],d=l[1],m=d?"appear":"enter";r.addClass(c,m,"active"),r.props.onEntering&&r.props.onEntering(s,u)},r.onEntered=function(s,u){var l=r.resolveArguments(s,u),c=l[0],d=l[1],m=d?"appear":"enter";r.removeClasses(c,m),r.addClass(c,m,"done"),r.props.onEntered&&r.props.onEntered(s,u)},r.onExit=function(s){var u=r.resolveArguments(s),l=u[0];r.removeClasses(l,"appear"),r.removeClasses(l,"enter"),r.addClass(l,"exit","base"),r.props.onExit&&r.props.onExit(s)},r.onExiting=function(s){var u=r.resolveArguments(s),l=u[0];r.addClass(l,"exit","active"),r.props.onExiting&&r.props.onExiting(s)},r.onExited=function(s){var u=r.resolveArguments(s),l=u[0];r.removeClasses(l,"exit"),r.addClass(l,"exit","done"),r.props.onExited&&r.props.onExited(s)},r.resolveArguments=function(s,u){return r.props.nodeRef?[r.props.nodeRef.current,s]:[s,u]},r.getClassNames=function(s){var u=r.props.classNames,l=typeof u=="string",c=l&&u?u+"-":"",d=l?""+c+s:u[s],m=l?d+"-active":u[s+"Active"],f=l?d+"-done":u[s+"Done"];return{baseClassName:d,activeClassName:m,doneClassName:f}},r}var n=e.prototype;return n.addClass=function(r,i,o){var a=this.getClassNames(i)[o+"ClassName"],s=this.getClassNames("enter"),u=s.doneClassName;i==="appear"&&o==="done"&&u&&(a+=" "+u),o==="active"&&r&&ux(r),a&&(this.appliedClasses[i][o]=a,Cre(r,a))},n.removeClasses=function(r,i){var o=this.appliedClasses[i],a=o.base,s=o.active,u=o.done;this.appliedClasses[i]={},a&&ng(r,a),s&&ng(r,s),u&&ng(r,u)},n.render=function(){var r=this.props;r.classNames;var i=y5(r,["classNames"]);return Se.createElement(_re,Qt({},i,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},e}(Se.Component);oE.defaultProps={classNames:""};oE.propTypes={};const lx=oE;function aE(t,e){var n=function(i){return e&&_.isValidElement(i)?e(i):i},r=Object.create(null);return t&&_.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function Sre(t,e){t=t||{},e=e||{};function n(c){return c in e?e[c]:t[c]}var r=Object.create(null),i=[];for(var o in t)o in e?i.length&&(r[o]=i,i=[]):i.push(o);var a,s={};for(var u in e){if(r[u])for(a=0;a<r[u].length;a++){var l=r[u][a];s[r[u][a]]=n(l)}s[u]=n(u)}for(a=0;a<i.length;a++)s[i[a]]=n(i[a]);return s}function lc(t,e,n){return n[e]!=null?n[e]:t.props[e]}function Ere(t,e){return aE(t.children,function(n){return _.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:lc(n,"appear",t),enter:lc(n,"enter",t),exit:lc(n,"exit",t)})})}function yre(t,e,n){var r=aE(t.children),i=Sre(e,r);return Object.keys(i).forEach(function(o){var a=i[o];if(_.isValidElement(a)){var s=o in e,u=o in r,l=e[o],c=_.isValidElement(l)&&!l.props.in;u&&(!s||c)?i[o]=_.cloneElement(a,{onExited:n.bind(null,a),in:!0,exit:lc(a,"exit",t),enter:lc(a,"enter",t)}):!u&&s&&!c?i[o]=_.cloneElement(a,{in:!1}):u&&s&&_.isValidElement(l)&&(i[o]=_.cloneElement(a,{onExited:n.bind(null,a),in:l.props.in,exit:lc(a,"exit",t),enter:lc(a,"enter",t)}))}}),i}var Dre=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},Rre={component:"div",childFactory:function(t){return t}},sE=function(t){iE(e,t);function e(r,i){var o;o=t.call(this,r,i)||this;var a=o.handleExited.bind(r9(o));return o.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(r,i){var o=i.children,a=i.handleExited,s=i.firstRender;return{children:s?Ere(r,a):yre(r,o,a),firstRender:!1}},n.handleExited=function(r,i){var o=aE(this.props.children);r.key in o||(r.props.onExited&&r.props.onExited(i),this.mounted&&this.setState(function(a){var s=Qt({},a.children);return delete s[r.key],{children:s}}))},n.render=function(){var r=this.props,i=r.component,o=r.childFactory,a=y5(r,["component","childFactory"]),s=this.state.contextValue,u=Dre(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,i===null?Se.createElement(m9.Provider,{value:s},u):Se.createElement(m9.Provider,{value:s},Se.createElement(i,a,u))},e}(Se.Component);sE.propTypes={};sE.defaultProps=Rre;const Ire=sE,Are="univer-message",Tre="univer-message-item",wre="univer-enter-active",Lre="univer-enter-done",Ore="univer-exit",Pre="univer-exit-active",Mre="univer-message-icon",Nre="univer-message-icon-success",xre="univer-message-icon-warning",Fre="univer-message-icon-error",$re="univer-message-content",hs={message:Are,messageItem:Tre,enterActive:wre,enterDone:Lre,exit:Ore,exitActive:Pre,messageIcon:Mre,messageIconSuccess:Nre,messageIconWarning:xre,messageIconError:Fre,messageContent:$re};var q5=(t=>(t.Success="success",t.Warning="warning",t.Error="error",t))(q5||{});const kre={success:Se.createElement(XG,{className:hs.messageIconSuccess}),warning:Se.createElement(GG,{className:hs.messageIconWarning}),error:Se.createElement(xG,{className:hs.messageIconError})},Bre=t=>{const{type:e,content:n}=t;return Se.createElement("div",{className:hs.messageItem},Se.createElement("div",{className:hs.messageContent},Se.createElement("span",{className:hs.messageIcon},kre[e]),Se.createElement("span",null,n)))},Ure=t=>{const{messages:e}=t;return Se.createElement(Ire,{className:hs.message},e.map(n=>Se.createElement(lx,{key:n.key,timeout:200,classNames:{enterActive:hs.enterActive,enterDone:hs.enterDone,exitActive:hs.exit,exitDone:hs.exitActive}},Se.createElement(Bre,{...n}))))};class Vre{constructor(e){e9(this,"_div"),e9(this,"_messages",[]),this._div=document.createElement("div"),e.appendChild(this._div),this.render()}append(e,n){const{content:r,delay:i=3e3}=n,o=Date.now();this._messages.push({key:o,type:e,content:r}),setTimeout(()=>{this.teardown(o)},i),this.render()}teardown(e){this._messages=this._messages.filter(n=>n.key!==e),this.render()}render(){ere(Se.createElement(Ure,{messages:this._messages}),this._div)}success(e){this.append("success",e)}warning(e){this.append("warning",e)}error(e){this.append("error",e)}}const Hre="univer-popup",jre="univer-popup-enter",zre="univer-popup-enter-active",Wre="univer-popup-slide-up-in",Yre="univer-popup-exit",Xre="univer-popup-slide-up-out",qre="univer-popup-exit-active",h2={popup:Hre,popupEnter:jre,popupEnterActive:zre,popupSlideUpIn:Wre,popupExit:Yre,popupSlideUpOut:Xre,popupExitActive:qre};function uE(t){const{children:e,visible:n=!1,offset:r=[0,0]}=t,i=_.useRef(null),[o,a]=_.useState(r);_.useEffect(()=>{if(!n){a([-9999,-9999]);return}const[u,l]=r,{clientWidth:c,clientHeight:d}=i.current,{innerWidth:m,innerHeight:f}=window,h=u+c>m?m-c:u,p=l+d>f?f-d:l;a([h,p])},[r,n]);function s(u){u.preventDefault()}return Se.createElement(lx,{in:n,nodeRef:i,timeout:500,classNames:{enter:h2.popupEnter,enterActive:h2.popupEnterActive,enterDone:h2.popupEnterDone,exitActive:h2.popupExit,exitDone:h2.popupExitActive}},Se.createElement("section",{ref:i,className:h2.popup,style:{left:o[0]+2,top:o[1]+2},onContextMenu:s},e))}var G5=function(t){var e=t.className,n=t.customizeIcon,r=t.customizeIconProps,i=t.children,o=t.onMouseDown,a=t.onClick,s=typeof n=="function"?n(r):n;return _.createElement("span",{className:e,onMouseDown:function(u){u.preventDefault(),o==null||o(u)},style:{userSelect:"none",WebkitUserSelect:"none"},unselectable:"on",onClick:a,"aria-hidden":!0},s!==void 0?s:_.createElement("span",{className:Xt(e.split(/\s+/).map(function(u){return"".concat(u,"-icon")}))},i))},Gre=function(t,e,n,r,i){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=Se.useMemo(function(){if(Pr(r)==="object")return r.clearIcon;if(i)return i},[r,i]),l=Se.useMemo(function(){return!!(!o&&r&&(n.length||a)&&!(s==="combobox"&&a===""))},[r,o,n.length,a,s]);return{allowClear:l,clearIcon:Se.createElement(G5,{className:"".concat(t,"-clear"),onMouseDown:e,customizeIcon:u},"×")}},cx=_.createContext(null);function Kre(){return _.useContext(cx)}function Zre(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,e=_.useState(!1),n=Qe(e,2),r=n[0],i=n[1],o=_.useRef(null),a=function(){window.clearTimeout(o.current)};_.useEffect(function(){return a},[]);var s=function(u,l){a(),o.current=window.setTimeout(function(){i(u),l&&l()},t)};return[r,s,a]}function dx(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:250,e=_.useRef(null),n=_.useRef(null);_.useEffect(function(){return function(){window.clearTimeout(n.current)}},[]);function r(i){(i||e.current===null)&&(e.current=i),window.clearTimeout(n.current),n.current=window.setTimeout(function(){e.current=null},t)}return[function(){return e.current},r]}function Qre(t,e,n,r){var i=_.useRef(null);i.current={open:e,triggerOpen:n,customizedTrigger:r},_.useEffect(function(){function o(a){var s;if(!((s=i.current)!==null&&s!==void 0&&s.customizedTrigger)){var u=a.target;u.shadowRoot&&a.composed&&(u=a.composedPath()[0]||u),i.current.open&&t().filter(function(l){return l}).every(function(l){return!l.contains(u)&&l!==u})&&i.current.triggerOpen(!1)}}return window.addEventListener("mousedown",o),function(){return window.removeEventListener("mousedown",o)}},[])}var Jre=function(t,e){var n,r=t.prefixCls,i=t.id,o=t.inputElement,a=t.disabled,s=t.tabIndex,u=t.autoFocus,l=t.autoComplete,c=t.editable,d=t.activeDescendantId,m=t.value,f=t.maxLength,h=t.onKeyDown,p=t.onMouseDown,v=t.onChange,g=t.onPaste,b=t.onCompositionStart,C=t.onCompositionEnd,S=t.open,E=t.attrs,y=o||_.createElement("input",null),D=y,R=D.ref,I=D.props,T=I.onKeyDown,P=I.onChange,N=I.onMouseDown,B=I.onCompositionStart,W=I.onCompositionEnd,G=I.style;return"maxLength"in y.props,y=_.cloneElement(y,$e($e($e({type:"search"},I),{},{id:i,ref:zc(e,R),disabled:a,tabIndex:s,autoComplete:l||"off",autoFocus:u,className:Xt("".concat(r,"-selection-search-input"),(n=y)===null||n===void 0||(n=n.props)===null||n===void 0?void 0:n.className),role:"combobox","aria-expanded":S||!1,"aria-haspopup":"listbox","aria-owns":"".concat(i,"_list"),"aria-autocomplete":"list","aria-controls":"".concat(i,"_list"),"aria-activedescendant":S?d:void 0},E),{},{value:c?m:"",maxLength:f,readOnly:!c,unselectable:c?null:"on",style:$e($e({},G),{},{opacity:c?null:0}),onKeyDown:function(Q){h(Q),T&&T(Q)},onMouseDown:function(Q){p(Q),N&&N(Q)},onChange:function(Q){v(Q),P&&P(Q)},onCompositionStart:function(Q){b(Q),B&&B(Q)},onCompositionEnd:function(Q){C(Q),W&&W(Q)},onPaste:g})),y},mx=_.forwardRef(Jre);function fx(t){return Array.isArray(t)?t:t!==void 0?[t]:[]}var eie=typeof window<"u"&&window.document&&window.document.documentElement,tie=eie;function nie(t){return t!=null}function rie(t){return!t&&t!==0}function II(t){return["string","number"].includes(Pr(t))}function hx(t){var e=void 0;return t&&(II(t.title)?e=t.title.toString():II(t.label)&&(e=t.label.toString())),e}function iie(t,e){tie?_.useLayoutEffect(t,e):_.useEffect(t,e)}function oie(t){var e;return(e=t.key)!==null&&e!==void 0?e:t.value}var AI=function(t){t.preventDefault(),t.stopPropagation()},aie=function(t){var e=t.id,n=t.prefixCls,r=t.values,i=t.open,o=t.searchValue,a=t.autoClearSearchValue,s=t.inputRef,u=t.placeholder,l=t.disabled,c=t.mode,d=t.showSearch,m=t.autoFocus,f=t.autoComplete,h=t.activeDescendantId,p=t.tabIndex,v=t.removeIcon,g=t.maxTagCount,b=t.maxTagTextLength,C=t.maxTagPlaceholder,S=C===void 0?function(ke){return"+ ".concat(ke.length," ...")}:C,E=t.tagRender,y=t.onToggleOpen,D=t.onRemove,R=t.onInputChange,I=t.onInputPaste,T=t.onInputKeyDown,P=t.onInputMouseDown,N=t.onInputCompositionStart,B=t.onInputCompositionEnd,W=_.useRef(null),G=_.useState(0),Q=Qe(G,2),te=Q[0],X=Q[1],x=_.useState(!1),O=Qe(x,2),M=O[0],V=O[1],q="".concat(n,"-selection"),ie=i||c==="multiple"&&a===!1||c==="tags"?o:"",ce=c==="tags"||c==="multiple"&&a===!1||d&&(i||M);iie(function(){X(W.current.scrollWidth)},[ie]);var pe=function(ke,Te,Re,rt,_t){return _.createElement("span",{title:hx(ke),className:Xt("".concat(q,"-item"),ut({},"".concat(q,"-item-disabled"),Re))},_.createElement("span",{className:"".concat(q,"-item-content")},Te),rt&&_.createElement(G5,{className:"".concat(q,"-item-remove"),onMouseDown:AI,onClick:_t,customizeIcon:v},"×"))},oe=function(ke,Te,Re,rt,_t){var mt=function(nt){AI(nt),y(!i)};return _.createElement("span",{onMouseDown:mt},E({label:Te,value:ke,disabled:Re,closable:rt,onClose:_t}))},he=function(ke){var Te=ke.disabled,Re=ke.label,rt=ke.value,_t=!l&&!Te,mt=Re;if(typeof b=="number"&&(typeof Re=="string"||typeof Re=="number")){var nt=String(mt);nt.length>b&&(mt="".concat(nt.slice(0,b),"..."))}var _e=function(He){He&&He.stopPropagation(),D(ke)};return typeof E=="function"?oe(rt,mt,Te,_t,_e):pe(ke,mt,Te,_t,_e)},fe=function(ke){var Te=typeof S=="function"?S(ke):S;return pe({title:Te},Te,!1)},ve=_.createElement("div",{className:"".concat(q,"-search"),style:{width:te},onFocus:function(){V(!0)},onBlur:function(){V(!1)}},_.createElement(mx,{ref:s,open:i,prefixCls:n,id:e,inputElement:null,disabled:l,autoFocus:m,autoComplete:f,editable:ce,activeDescendantId:h,value:ie,onKeyDown:T,onMouseDown:P,onChange:R,onPaste:I,onCompositionStart:N,onCompositionEnd:B,tabIndex:p,attrs:Cm(t,!0)}),_.createElement("span",{ref:W,className:"".concat(q,"-search-mirror"),"aria-hidden":!0},ie," ")),Ue=_.createElement(u1,{prefixCls:"".concat(q,"-overflow"),data:r,renderItem:he,renderRest:fe,suffix:ve,itemKey:oie,maxCount:g});return _.createElement(_.Fragment,null,Ue,!r.length&&!ie&&_.createElement("span",{className:"".concat(q,"-placeholder")},u))},sie=function(t){var e=t.inputElement,n=t.prefixCls,r=t.id,i=t.inputRef,o=t.disabled,a=t.autoFocus,s=t.autoComplete,u=t.activeDescendantId,l=t.mode,c=t.open,d=t.values,m=t.placeholder,f=t.tabIndex,h=t.showSearch,p=t.searchValue,v=t.activeValue,g=t.maxLength,b=t.onInputKeyDown,C=t.onInputMouseDown,S=t.onInputChange,E=t.onInputPaste,y=t.onInputCompositionStart,D=t.onInputCompositionEnd,R=t.title,I=_.useState(!1),T=Qe(I,2),P=T[0],N=T[1],B=l==="combobox",W=B||h,G=d[0],Q=p||"";B&&v&&!P&&(Q=v),_.useEffect(function(){B&&N(!1)},[B,v]);var te=l!=="combobox"&&!c&&!h?!1:!!Q,X=R===void 0?hx(G):R,x=_.useMemo(function(){return G?null:_.createElement("span",{className:"".concat(n,"-selection-placeholder"),style:te?{visibility:"hidden"}:void 0},m)},[G,te,m,n]);return _.createElement(_.Fragment,null,_.createElement("span",{className:"".concat(n,"-selection-search")},_.createElement(mx,{ref:i,prefixCls:n,id:r,open:c,inputElement:e,disabled:o,autoFocus:a,autoComplete:s,editable:W,activeDescendantId:u,value:Q,onKeyDown:b,onMouseDown:C,onChange:function(O){N(!0),S(O)},onPaste:E,onCompositionStart:y,onCompositionEnd:D,tabIndex:f,attrs:Cm(t,!0),maxLength:B?g:void 0})),!B&&G?_.createElement("span",{className:"".concat(n,"-selection-item"),title:X,style:te?{visibility:"hidden"}:void 0},G.label):null,x)};function uie(t){return![lt.ESC,lt.SHIFT,lt.BACKSPACE,lt.TAB,lt.WIN_KEY,lt.ALT,lt.META,lt.WIN_KEY_RIGHT,lt.CTRL,lt.SEMICOLON,lt.EQUALS,lt.CAPS_LOCK,lt.CONTEXT_MENU,lt.F1,lt.F2,lt.F3,lt.F4,lt.F5,lt.F6,lt.F7,lt.F8,lt.F9,lt.F10,lt.F11,lt.F12].includes(t)}var lie=function(t,e){var n=_.useRef(null),r=_.useRef(!1),i=t.prefixCls,o=t.open,a=t.mode,s=t.showSearch,u=t.tokenWithEnter,l=t.autoClearSearchValue,c=t.onSearch,d=t.onSearchSubmit,m=t.onToggleOpen,f=t.onInputKeyDown,h=t.domRef;_.useImperativeHandle(e,function(){return{focus:function(){n.current.focus()},blur:function(){n.current.blur()}}});var p=dx(0),v=Qe(p,2),g=v[0],b=v[1],C=function(G){var Q=G.which;(Q===lt.UP||Q===lt.DOWN)&&G.preventDefault(),f&&f(G),Q===lt.ENTER&&a==="tags"&&!r.current&&!o&&(d==null||d(G.target.value)),uie(Q)&&m(!0)},S=function(){b(!0)},E=_.useRef(null),y=function(G){c(G,!0,r.current)!==!1&&m(!0)},D=function(){r.current=!0},R=function(G){r.current=!1,a!=="combobox"&&y(G.target.value)},I=function(G){var Q=G.target.value;if(u&&E.current&&/[\r\n]/.test(E.current)){var te=E.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");Q=Q.replace(te,E.current)}E.current=null,y(Q)},T=function(G){var Q=G.clipboardData,te=Q==null?void 0:Q.getData("text");E.current=te||""},P=function(G){var Q=G.target;if(Q!==n.current){var te=document.body.style.msTouchAction!==void 0;te?setTimeout(function(){n.current.focus()}):n.current.focus()}},N=function(G){var Q=g();G.target!==n.current&&!Q&&a!=="combobox"&&G.preventDefault(),(a!=="combobox"&&(!s||!Q)||!o)&&(o&&l!==!1&&c("",!0,!1),m())},B={inputRef:n,onInputKeyDown:C,onInputMouseDown:S,onInputChange:I,onInputPaste:T,onInputCompositionStart:D,onInputCompositionEnd:R},W=a==="multiple"||a==="tags"?_.createElement(aie,Qt({},t,B)):_.createElement(sie,Qt({},t,B));return _.createElement("div",{ref:h,className:"".concat(i,"-selector"),onClick:P,onMouseDown:N},W)},cie=_.forwardRef(lie),die=["prefixCls","disabled","visible","children","popupElement","animation","transitionName","dropdownStyle","dropdownClassName","direction","placement","builtinPlacements","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","getPopupContainer","empty","getTriggerDOMNode","onPopupVisibleChange","onPopupMouseEnter"],mie=function(t){var e=t===!0?0:1;return{bottomLeft:{points:["tl","bl"],offset:[0,4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"},bottomRight:{points:["tr","br"],offset:[0,4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"},topLeft:{points:["bl","tl"],offset:[0,-4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"},topRight:{points:["br","tr"],offset:[0,-4],overflow:{adjustX:e,adjustY:1},htmlRegion:"scroll"}}},fie=function(t,e){var n=t.prefixCls;t.disabled;var r=t.visible,i=t.children,o=t.popupElement,a=t.animation,s=t.transitionName,u=t.dropdownStyle,l=t.dropdownClassName,c=t.direction,d=c===void 0?"ltr":c,m=t.placement,f=t.builtinPlacements,h=t.dropdownMatchSelectWidth,p=t.dropdownRender,v=t.dropdownAlign,g=t.getPopupContainer,b=t.empty,C=t.getTriggerDOMNode,S=t.onPopupVisibleChange,E=t.onPopupMouseEnter,y=Qn(t,die),D="".concat(n,"-dropdown"),R=o;p&&(R=p(o));var I=_.useMemo(function(){return f||mie(h)},[f,h]),T=a?"".concat(D,"-").concat(a):s,P=typeof h=="number",N=_.useMemo(function(){return P?null:h===!1?"minWidth":"width"},[h,P]),B=u;P&&(B=$e($e({},B),{},{width:h}));var W=_.useRef(null);return _.useImperativeHandle(e,function(){return{getPopupElement:function(){return W.current}}}),_.createElement(U5,Qt({},y,{showAction:S?["click"]:[],hideAction:S?["click"]:[],popupPlacement:m||(d==="rtl"?"bottomRight":"bottomLeft"),builtinPlacements:I,prefixCls:D,popupTransitionName:T,popup:_.createElement("div",{ref:W,onMouseEnter:E},R),stretch:N,popupAlign:v,popupVisible:r,getPopupContainer:g,popupClassName:Xt(l,ut({},"".concat(D,"-empty"),b)),popupStyle:B,getTriggerDOMNode:C,onPopupVisibleChange:S}),i)},hie=_.forwardRef(fie);function pie(t){return RM(t)||jM(t)||FS(t)||IM()}function TI(t,e){var n=t.key,r;return"value"in t&&(r=t.value),n??(r!==void 0?r:"rc-index-key-".concat(e))}function px(t,e){var n=t||{},r=n.label,i=n.value,o=n.options,a=n.groupLabel,s=r||(e?"children":"label");return{label:s,value:i||"value",options:o||"options",groupLabel:a||s}}function gie(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.fieldNames,r=e.childrenAsData,i=[],o=px(n,!1),a=o.label,s=o.value,u=o.options,l=o.groupLabel;function c(d,m){Array.isArray(d)&&d.forEach(function(f){if(m||!(u in f)){var h=f[s];i.push({key:TI(f,i.length),groupOption:m,data:f,label:f[a],value:h})}else{var p=f[l];p===void 0&&r&&(p=f.label),i.push({key:TI(f,i.length),group:!0,data:f,label:p}),c(f[u],!0)}})}return c(t,!1),i}function qb(t){var e=$e({},t);return"props"in e||Object.defineProperty(e,"props",{get:function(){return wl(!1,"Return type is option instead of Option instance. Please read value directly instead of reading from `props`."),e}}),e}var vie=function(t,e,n){if(!e||!e.length)return null;var r=!1,i=function a(s,u){var l=pie(u),c=l[0],d=l.slice(1);if(!c)return[s];var m=s.split(c);return r=r||m.length>1,m.reduce(function(f,h){return[].concat(Wr(f),Wr(a(h,d)))},[]).filter(Boolean)},o=i(t,e);return r?typeof n<"u"?o.slice(0,n):o:null},lE=_.createContext(null),bie=["id","prefixCls","className","showSearch","tagRender","direction","omitDomProps","displayValues","onDisplayValuesChange","emptyOptions","notFoundContent","onClear","mode","disabled","loading","getInputElement","getRawInputElement","open","defaultOpen","onDropdownVisibleChange","activeValue","onActiveValueChange","activeDescendantId","searchValue","autoClearSearchValue","onSearch","onSearchSplit","tokenSeparators","allowClear","suffixIcon","clearIcon","OptionList","animation","transitionName","dropdownStyle","dropdownClassName","dropdownMatchSelectWidth","dropdownRender","dropdownAlign","placement","builtinPlacements","getPopupContainer","showAction","onFocus","onBlur","onKeyUp","onKeyDown","onMouseDown"],_ie=["value","onChange","removeIcon","placeholder","autoFocus","maxTagCount","maxTagTextLength","maxTagPlaceholder","choiceTransitionName","onInputKeyDown","onPopupScroll","tabIndex"],Gb=function(t){return t==="tags"||t==="multiple"},Cie=_.forwardRef(function(t,e){var n,r,i=t.id,o=t.prefixCls,a=t.className,s=t.showSearch,u=t.tagRender,l=t.direction,c=t.omitDomProps,d=t.displayValues,m=t.onDisplayValuesChange,f=t.emptyOptions,h=t.notFoundContent,p=h===void 0?"Not Found":h,v=t.onClear,g=t.mode,b=t.disabled,C=t.loading,S=t.getInputElement,E=t.getRawInputElement,y=t.open,D=t.defaultOpen,R=t.onDropdownVisibleChange,I=t.activeValue,T=t.onActiveValueChange,P=t.activeDescendantId,N=t.searchValue,B=t.autoClearSearchValue,W=t.onSearch,G=t.onSearchSplit,Q=t.tokenSeparators,te=t.allowClear,X=t.suffixIcon,x=t.clearIcon,O=t.OptionList,M=t.animation,V=t.transitionName,q=t.dropdownStyle,ie=t.dropdownClassName,ce=t.dropdownMatchSelectWidth,pe=t.dropdownRender,oe=t.dropdownAlign,he=t.placement,fe=t.builtinPlacements,ve=t.getPopupContainer,Ue=t.showAction,ke=Ue===void 0?[]:Ue,Te=t.onFocus,Re=t.onBlur,rt=t.onKeyUp,_t=t.onKeyDown,mt=t.onMouseDown,nt=Qn(t,bie),_e=Gb(g),He=(s!==void 0?s:_e)||g==="combobox",et=$e({},nt);_ie.forEach(function(re){delete et[re]}),c==null||c.forEach(function(re){delete et[re]});var Dt=_.useState(!1),Mt=Qe(Dt,2),Bt=Mt[0],Zt=Mt[1];_.useEffect(function(){Zt(GS())},[]);var It=_.useRef(null),pn=_.useRef(null),yn=_.useRef(null),$t=_.useRef(null),Ht=_.useRef(null),Nt=_.useRef(!1),Ot=Zre(),En=Qe(Ot,3),Y=En[0],z=En[1],ne=En[2];_.useImperativeHandle(e,function(){var re,Ee;return{focus:(re=$t.current)===null||re===void 0?void 0:re.focus,blur:(Ee=$t.current)===null||Ee===void 0?void 0:Ee.blur,scrollTo:function(ze){var qe;return(qe=Ht.current)===null||qe===void 0?void 0:qe.scrollTo(ze)}}});var Ce=_.useMemo(function(){var re;if(g!=="combobox")return N;var Ee=(re=d[0])===null||re===void 0?void 0:re.value;return typeof Ee=="string"||typeof Ee=="number"?String(Ee):""},[N,g,d]),Ve=g==="combobox"&&typeof S=="function"&&S()||null,Ke=typeof E=="function"&&E(),Pe=nd(pn,Ke==null||(n=Ke.props)===null||n===void 0?void 0:n.ref),Be=_.useState(!1),me=Qe(Be,2),De=me[0],Ne=me[1];Kr(function(){Ne(!0)},[]);var be=Qu(!1,{defaultValue:D,value:y}),ft=Qe(be,2),Ze=ft[0],st=ft[1],Me=De?Ze:!1,Le=!p&&f;(b||Le&&Me&&g==="combobox")&&(Me=!1);var Je=Le?!1:Me,Xe=_.useCallback(function(re){var Ee=re!==void 0?re:!Me;b||(st(Ee),Me!==Ee&&(R==null||R(Ee)))},[b,Me,st,R]),Et=_.useMemo(function(){return(Q||[]).some(function(re){return[`
`,`\r
`].includes(re)})},[Q]),wt=_.useContext(lE)||{},Cn=wt.maxCount,jn=wt.rawValues,nr=function(re,Ee,ze){if(!((jn==null?void 0:jn.size)>=Cn)){var qe=!0,tt=re;T==null||T(null);var it=vie(re,Q,Cn&&Cn-jn.size),Pt=ze?null:it;return g!=="combobox"&&Pt&&(tt="",G==null||G(Pt),Xe(!1),qe=!1),W&&Ce!==tt&&W(tt,{source:Ee?"typing":"effect"}),qe}},St=function(re){!re||!re.trim()||W(re,{source:"submit"})};_.useEffect(function(){!Me&&!_e&&g!=="combobox"&&nr("",!1,!1)},[Me]),_.useEffect(function(){Ze&&b&&st(!1),b&&!Nt.current&&z(!1)},[b]);var Ln=dx(),Yn=Qe(Ln,2),tn=Yn[0],at=Yn[1],xe=function(re){var Ee=tn(),ze=re.which;if(ze===lt.ENTER&&(g!=="combobox"&&re.preventDefault(),Me||Xe(!0)),at(!!Ce),ze===lt.BACKSPACE&&!Ee&&_e&&!Ce&&d.length){for(var qe=Wr(d),tt=null,it=qe.length-1;it>=0;it-=1){var Pt=qe[it];if(!Pt.disabled){qe.splice(it,1),tt=Pt;break}}tt&&m(qe,{type:"remove",values:[tt]})}for(var sn=arguments.length,On=new Array(sn>1?sn-1:0),Dn=1;Dn<sn;Dn++)On[Dn-1]=arguments[Dn];if(Me){var gr;(gr=Ht.current)===null||gr===void 0||gr.onKeyDown.apply(gr,[re].concat(On))}_t==null||_t.apply(void 0,[re].concat(On))},An=function(re){for(var Ee=arguments.length,ze=new Array(Ee>1?Ee-1:0),qe=1;qe<Ee;qe++)ze[qe-1]=arguments[qe];if(Me){var tt;(tt=Ht.current)===null||tt===void 0||tt.onKeyUp.apply(tt,[re].concat(ze))}rt==null||rt.apply(void 0,[re].concat(ze))},vn=function(re){var Ee=d.filter(function(ze){return ze!==re});m(Ee,{type:"remove",values:[re]})},Rr=_.useRef(!1),Nr=function(){z(!0),b||(Te&&!Rr.current&&Te.apply(void 0,arguments),ke.includes("focus")&&Xe(!0)),Rr.current=!0},wi=function(){Nt.current=!0,z(!1,function(){Rr.current=!1,Nt.current=!1,Xe(!1)}),!b&&(Ce&&(g==="tags"?W(Ce,{source:"submit"}):g==="multiple"&&W("",{source:"blur"})),Re&&Re.apply(void 0,arguments))},di=[];_.useEffect(function(){return function(){di.forEach(function(re){return clearTimeout(re)}),di.splice(0,di.length)}},[]);var uo=function(re){var Ee,ze=re.target,qe=(Ee=yn.current)===null||Ee===void 0?void 0:Ee.getPopupElement();if(qe&&qe.contains(ze)){var tt=setTimeout(function(){var On=di.indexOf(tt);if(On!==-1&&di.splice(On,1),ne(),!Bt&&!qe.contains(document.activeElement)){var Dn;(Dn=$t.current)===null||Dn===void 0||Dn.focus()}});di.push(tt)}for(var it=arguments.length,Pt=new Array(it>1?it-1:0),sn=1;sn<it;sn++)Pt[sn-1]=arguments[sn];mt==null||mt.apply(void 0,[re].concat(Pt))},Li=_.useState({}),Ei=Qe(Li,2),lo=Ei[1];function Vs(){lo({})}var oi;Ke&&(oi=function(re){Xe(re)}),Qre(function(){var re;return[It.current,(re=yn.current)===null||re===void 0?void 0:re.getPopupElement()]},Je,Xe,!!Ke);var ya=_.useMemo(function(){return $e($e({},t),{},{notFoundContent:p,open:Me,triggerOpen:Je,id:i,showSearch:He,multiple:_e,toggleOpen:Xe})},[t,p,Je,Me,i,He,_e,Xe]),ea=!!X||C,ji;ea&&(ji=_.createElement(G5,{className:Xt("".concat(o,"-arrow"),ut({},"".concat(o,"-arrow-loading"),C)),customizeIcon:X,customizeIconProps:{loading:C,searchValue:Ce,open:Me,focused:Y,showSearch:He}}));var zi=function(){var re;v==null||v(),(re=$t.current)===null||re===void 0||re.focus(),m([],{type:"clear",values:d}),nr("",!1,!1)},ta=Gre(o,zi,d,te,x,b,Ce,g),Da=ta.allowClear,$=ta.clearIcon,J=_.createElement(O,{ref:Ht}),Z=Xt(o,a,(r={},ut(r,"".concat(o,"-focused"),Y),ut(r,"".concat(o,"-multiple"),_e),ut(r,"".concat(o,"-single"),!_e),ut(r,"".concat(o,"-allow-clear"),te),ut(r,"".concat(o,"-show-arrow"),ea),ut(r,"".concat(o,"-disabled"),b),ut(r,"".concat(o,"-loading"),C),ut(r,"".concat(o,"-open"),Me),ut(r,"".concat(o,"-customize-input"),Ve),ut(r,"".concat(o,"-show-search"),He),r)),le=_.createElement(hie,{ref:yn,disabled:b,prefixCls:o,visible:Je,popupElement:J,animation:M,transitionName:V,dropdownStyle:q,dropdownClassName:ie,direction:l,dropdownMatchSelectWidth:ce,dropdownRender:pe,dropdownAlign:oe,placement:he,builtinPlacements:fe,getPopupContainer:ve,empty:f,getTriggerDOMNode:function(){return pn.current},onPopupVisibleChange:oi,onPopupMouseEnter:Vs},Ke?_.cloneElement(Ke,{ref:Pe}):_.createElement(cie,Qt({},t,{domRef:pn,prefixCls:o,inputElement:Ve,ref:$t,id:i,showSearch:He,autoClearSearchValue:B,mode:g,activeDescendantId:P,tagRender:u,values:d,open:Me,onToggleOpen:Xe,activeValue:I,searchValue:Ce,onSearch:nr,onSearchSubmit:St,onRemove:vn,tokenWithEnter:Et}))),de;return Ke?de=le:de=_.createElement("div",Qt({className:Z},et,{ref:It,onMouseDown:uo,onKeyDown:xe,onKeyUp:An,onFocus:Nr,onBlur:wi}),Y&&!Me&&_.createElement("span",{"aria-live":"polite",style:{width:0,height:0,position:"absolute",overflow:"hidden",opacity:0}},"".concat(d.map(function(re){var Ee=re.label,ze=re.value;return["number","string"].includes(Pr(Ee))?Ee:ze}).join(", "))),le,ji,Da&&$),_.createElement(cx.Provider,{value:ya},de)}),gx=function(){return null};gx.isSelectOptGroup=!0;var vx=function(){return null};vx.isSelectOption=!0;var bx=_.forwardRef(function(t,e){var n=t.height,r=t.offsetY,i=t.offsetX,o=t.children,a=t.prefixCls,s=t.onInnerResize,u=t.innerProps,l=t.rtl,c=t.extra,d={},m={display:"flex",flexDirection:"column"};return r!==void 0&&(d={height:n,position:"relative",overflow:"hidden"},m=$e($e({},m),{},ut(ut(ut(ut(ut({transform:"translateY(".concat(r,"px)")},l?"marginRight":"marginLeft",-i),"position","absolute"),"left",0),"right",0),"top",0))),_.createElement("div",{style:d},_.createElement(Yc,{onResize:function(f){var h=f.offsetHeight;h&&s&&s()}},_.createElement("div",Qt({style:m,className:Xt(ut({},"".concat(a,"-holder-inner"),a)),ref:e},u),o,c)))});bx.displayName="Filler";function wI(t,e){var n="touches"in t?t.touches[0]:t;return n[e?"pageX":"pageY"]}var LI=_.forwardRef(function(t,e){var n=t.prefixCls,r=t.rtl,i=t.scrollOffset,o=t.scrollRange,a=t.onStartMove,s=t.onStopMove,u=t.onScroll,l=t.horizontal,c=t.spinSize,d=t.containerSize,m=t.style,f=t.thumbStyle,h=_.useState(!1),p=Qe(h,2),v=p[0],g=p[1],b=_.useState(null),C=Qe(b,2),S=C[0],E=C[1],y=_.useState(null),D=Qe(y,2),R=D[0],I=D[1],T=!r,P=_.useRef(),N=_.useRef(),B=_.useState(!1),W=Qe(B,2),G=W[0],Q=W[1],te=_.useRef(),X=function(){clearTimeout(te.current),Q(!0),te.current=setTimeout(function(){Q(!1)},3e3)},x=o-d||0,O=d-c||0,M=_.useMemo(function(){if(i===0||x===0)return 0;var ve=i/x;return ve*O},[i,x,O]),V=function(ve){ve.stopPropagation(),ve.preventDefault()},q=_.useRef({top:M,dragging:v,pageY:S,startTop:R});q.current={top:M,dragging:v,pageY:S,startTop:R};var ie=function(ve){g(!0),E(wI(ve,l)),I(q.current.top),a(),ve.stopPropagation(),ve.preventDefault()};_.useEffect(function(){var ve=function(Te){Te.preventDefault()},Ue=P.current,ke=N.current;return Ue.addEventListener("touchstart",ve),ke.addEventListener("touchstart",ie),function(){Ue.removeEventListener("touchstart",ve),ke.removeEventListener("touchstart",ie)}},[]);var ce=_.useRef();ce.current=x;var pe=_.useRef();pe.current=O,_.useEffect(function(){if(v){var ve,Ue=function(Te){var Re=q.current,rt=Re.dragging,_t=Re.pageY,mt=Re.startTop;if(Or.cancel(ve),rt){var nt=wI(Te,l)-_t,_e=mt;!T&&l?_e-=nt:_e+=nt;var He=ce.current,et=pe.current,Dt=et?_e/et:0,Mt=Math.ceil(Dt*He);Mt=Math.max(Mt,0),Mt=Math.min(Mt,He),ve=Or(function(){u(Mt,l)})}},ke=function(){g(!1),s()};return window.addEventListener("mousemove",Ue),window.addEventListener("touchmove",Ue),window.addEventListener("mouseup",ke),window.addEventListener("touchend",ke),function(){window.removeEventListener("mousemove",Ue),window.removeEventListener("touchmove",Ue),window.removeEventListener("mouseup",ke),window.removeEventListener("touchend",ke),Or.cancel(ve)}}},[v]),_.useEffect(function(){X()},[i]),_.useImperativeHandle(e,function(){return{delayHidden:X}});var oe="".concat(n,"-scrollbar"),he={position:"absolute",visibility:G?null:"hidden"},fe={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return l?(he.height=8,he.left=0,he.right=0,he.bottom=0,fe.height="100%",fe.width=c,T?fe.left=M:fe.right=M):(he.width=8,he.top=0,he.bottom=0,T?he.right=0:he.left=0,fe.width="100%",fe.height=c,fe.top=M),_.createElement("div",{ref:P,className:Xt(oe,ut(ut(ut({},"".concat(oe,"-horizontal"),l),"".concat(oe,"-vertical"),!l),"".concat(oe,"-visible"),G)),style:$e($e({},he),m),onMouseDown:V,onMouseMove:X},_.createElement("div",{ref:N,className:Xt("".concat(oe,"-thumb"),ut({},"".concat(oe,"-thumb-moving"),v)),style:$e($e({},fe),f),onMouseDown:ie}))});function Sie(t){var e=t.children,n=t.setRef,r=_.useCallback(function(i){n(i)},[]);return _.cloneElement(e,{ref:r})}function Eie(t,e,n,r,i,o,a){var s=a.getKey;return t.slice(e,n+1).map(function(u,l){var c=e+l,d=o(u,c,{style:{width:r}}),m=s(u);return _.createElement(Sie,{key:m,setRef:function(f){return i(u,f)}},d)})}var yie=function(){function t(){Al(this,t),ut(this,"maps",void 0),ut(this,"id",0),this.maps=Object.create(null)}return Tl(t,[{key:"set",value:function(e,n){this.maps[e]=n,this.id+=1}},{key:"get",value:function(e){return this.maps[e]}}]),t}();function Die(t,e,n){var r=_.useState(0),i=Qe(r,2),o=i[0],a=i[1],s=_.useRef(new Map),u=_.useRef(new yie),l=_.useRef();function c(){Or.cancel(l.current)}function d(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;c();var h=function(){s.current.forEach(function(p,v){if(p&&p.offsetParent){var g=B6(p),b=g.offsetHeight;u.current.get(v)!==b&&u.current.set(v,g.offsetHeight)}}),a(function(p){return p+1})};f?h():l.current=Or(h)}function m(f,h){var p=t(f),v=s.current.get(p);h?(s.current.set(p,h),d()):s.current.delete(p),!v!=!h&&(h?e==null||e(f):n==null||n(f))}return _.useEffect(function(){return c},[]),[m,d,u.current,o]}var Rie=10;function Iie(t,e,n,r,i,o,a,s){var u=_.useRef(),l=_.useState(null),c=Qe(l,2),d=c[0],m=c[1];return Kr(function(){if(d&&d.times<Rie){if(!t.current){m(function(x){return $e({},x)});return}o();var f=d.targetAlign,h=d.originAlign,p=d.index,v=d.offset,g=t.current.clientHeight,b=!1,C=f,S=null;if(g){for(var E=f||h,y=0,D=0,R=0,I=Math.min(e.length-1,p),T=0;T<=I;T+=1){var P=i(e[T]);D=y;var N=n.get(P);R=D+(N===void 0?r:N),y=R}for(var B=E==="top"?v:g-v,W=I;W>=0;W-=1){var G=i(e[W]),Q=n.get(G);if(Q===void 0){b=!0;break}if(B-=Q,B<=0)break}switch(E){case"top":S=D-v;break;case"bottom":S=R-g+v;break;default:{var te=t.current.scrollTop,X=te+g;D<te?C="top":R>X&&(C="bottom")}}S!==null&&a(S),S!==d.lastTop&&(b=!0)}b&&m($e($e({},d),{},{times:d.times+1,targetAlign:C,lastTop:S}))}},[d,t.current]),function(f){if(f==null){s();return}if(Or.cancel(u.current),typeof f=="number")a(f);else if(f&&Pr(f)==="object"){var h,p=f.align;"index"in f?h=f.index:h=e.findIndex(function(b){return i(b)===f.key});var v=f.offset,g=v===void 0?0:v;m({times:0,index:h,offset:g,originAlign:p})}}}function Aie(t,e,n){var r=t.length,i=e.length,o,a;if(r===0&&i===0)return null;r<i?(o=t,a=e):(o=e,a=t);var s={__EMPTY_ITEM__:!0};function u(h){return h!==void 0?n(h):s}for(var l=null,c=Math.abs(r-i)!==1,d=0;d<a.length;d+=1){var m=u(o[d]),f=u(a[d]);if(m!==f){l=d,c=c||m!==u(a[d+1]);break}}return l===null?null:{index:l,multiple:c}}function Tie(t,e,n){var r=_.useState(t),i=Qe(r,2),o=i[0],a=i[1],s=_.useState(null),u=Qe(s,2),l=u[0],c=u[1];return _.useEffect(function(){var d=Aie(o||[],t||[],e);(d==null?void 0:d.index)!==void 0&&(n==null||n(d.index),c(t[d.index])),a(t)},[t]),[l]}var OI=(typeof navigator>"u"?"undefined":Pr(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const _x=function(t,e){var n=_.useRef(!1),r=_.useRef(null);function i(){clearTimeout(r.current),n.current=!0,r.current=setTimeout(function(){n.current=!1},50)}var o=_.useRef({top:t,bottom:e});return o.current.top=t,o.current.bottom=e,function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=a<0&&o.current.top||a>0&&o.current.bottom;return s&&u?(clearTimeout(r.current),n.current=!1):(!u||n.current)&&i(),!n.current&&u}};function wie(t,e,n,r,i){var o=_.useRef(0),a=_.useRef(null),s=_.useRef(null),u=_.useRef(!1),l=_x(e,n);function c(v,g){Or.cancel(a.current),o.current+=g,s.current=g,!l(g)&&(OI||v.preventDefault(),a.current=Or(function(){var b=u.current?10:1;i(o.current*b),o.current=0}))}function d(v,g){i(g,!0),OI||v.preventDefault()}var m=_.useRef(null),f=_.useRef(null);function h(v){if(t){Or.cancel(f.current),f.current=Or(function(){m.current=null},2);var g=v.deltaX,b=v.deltaY,C=v.shiftKey,S=g,E=b;(m.current==="sx"||!m.current&&C&&b&&!g)&&(S=b,E=0,m.current="sx");var y=Math.abs(S),D=Math.abs(E);m.current===null&&(m.current=r&&y>D?"x":"y"),m.current==="y"?c(v,E):d(v,S)}}function p(v){t&&(u.current=v.detail===s.current)}return[h,p]}var Lie=14/15;function Oie(t,e,n){var r=_.useRef(!1),i=_.useRef(0),o=_.useRef(null),a=_.useRef(null),s,u=function(d){if(r.current){var m=Math.ceil(d.touches[0].pageY),f=i.current-m;i.current=m,n(f)&&d.preventDefault(),clearInterval(a.current),a.current=setInterval(function(){f*=Lie,(!n(f,!0)||Math.abs(f)<=.1)&&clearInterval(a.current)},16)}},l=function(){r.current=!1,s()},c=function(d){s(),d.touches.length===1&&!r.current&&(r.current=!0,i.current=Math.ceil(d.touches[0].pageY),o.current=d.target,o.current.addEventListener("touchmove",u),o.current.addEventListener("touchend",l))};s=function(){o.current&&(o.current.removeEventListener("touchmove",u),o.current.removeEventListener("touchend",l))},Kr(function(){return t&&e.current.addEventListener("touchstart",c),function(){var d;(d=e.current)===null||d===void 0||d.removeEventListener("touchstart",c),s(),clearInterval(a.current)}},[t])}var Pie=20;function PI(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t/e*t;return isNaN(n)&&(n=0),n=Math.max(n,Pie),Math.floor(n)}function Mie(t,e,n,r){var i=_.useMemo(function(){return[new Map,[]]},[t,n.id,r]),o=Qe(i,2),a=o[0],s=o[1],u=function(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l,d=a.get(l),m=a.get(c);if(d===void 0||m===void 0)for(var f=t.length,h=s.length;h<f;h+=1){var p,v=t[h],g=e(v);a.set(g,h);var b=(p=n.get(g))!==null&&p!==void 0?p:r;if(s[h]=(s[h-1]||0)+b,g===l&&(d=h),g===c&&(m=h),d!==void 0&&m!==void 0)break}return{top:s[d-1]||0,bottom:s[m]}};return u}var Nie=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],xie=[],Fie={overflowY:"auto",overflowAnchor:"none"};function $ie(t,e){var n=t.prefixCls,r=n===void 0?"rc-virtual-list":n,i=t.className,o=t.height,a=t.itemHeight,s=t.fullHeight,u=s===void 0?!0:s,l=t.style,c=t.data,d=t.children,m=t.itemKey,f=t.virtual,h=t.direction,p=t.scrollWidth,v=t.component,g=v===void 0?"div":v,b=t.onScroll,C=t.onVirtualScroll,S=t.onVisibleChange,E=t.innerProps,y=t.extraRender,D=t.styles,R=Qn(t,Nie),I=!!(f!==!1&&o&&a),T=I&&c&&(a*c.length>o||!!p),P=h==="rtl",N=Xt(r,ut({},"".concat(r,"-rtl"),P),i),B=c||xie,W=_.useRef(),G=_.useRef(),Q=_.useState(0),te=Qe(Q,2),X=te[0],x=te[1],O=_.useState(0),M=Qe(O,2),V=M[0],q=M[1],ie=_.useState(!1),ce=Qe(ie,2),pe=ce[0],oe=ce[1],he=function(){oe(!0)},fe=function(){oe(!1)},ve=_.useCallback(function(at){return typeof m=="function"?m(at):at==null?void 0:at[m]},[m]),Ue={getKey:ve};function ke(at){x(function(xe){var An;typeof at=="function"?An=at(xe):An=at;var vn=Pe(An);return W.current.scrollTop=vn,vn})}var Te=_.useRef({start:0,end:B.length}),Re=_.useRef(),rt=Tie(B,ve),_t=Qe(rt,1),mt=_t[0];Re.current=mt;var nt=Die(ve,null,null),_e=Qe(nt,4),He=_e[0],et=_e[1],Dt=_e[2],Mt=_e[3],Bt=_.useMemo(function(){if(!I)return{scrollHeight:void 0,start:0,end:B.length-1,offset:void 0};if(!T){var at;return{scrollHeight:((at=G.current)===null||at===void 0?void 0:at.offsetHeight)||0,start:0,end:B.length-1,offset:void 0}}for(var xe=0,An,vn,Rr,Nr=B.length,wi=0;wi<Nr;wi+=1){var di=B[wi],uo=ve(di),Li=Dt.get(uo),Ei=xe+(Li===void 0?a:Li);Ei>=X&&An===void 0&&(An=wi,vn=xe),Ei>X+o&&Rr===void 0&&(Rr=wi),xe=Ei}return An===void 0&&(An=0,vn=0,Rr=Math.ceil(o/a)),Rr===void 0&&(Rr=B.length-1),Rr=Math.min(Rr+1,B.length-1),{scrollHeight:xe,start:An,end:Rr,offset:vn}},[T,I,X,B,Mt,o]),Zt=Bt.scrollHeight,It=Bt.start,pn=Bt.end,yn=Bt.offset;Te.current.start=It,Te.current.end=pn;var $t=_.useState({width:0,height:o}),Ht=Qe($t,2),Nt=Ht[0],Ot=Ht[1],En=function(at){Ot({width:at.width||at.offsetWidth,height:at.height||at.offsetHeight})},Y=_.useRef(),z=_.useRef(),ne=_.useMemo(function(){return PI(Nt.width,p)},[Nt.width,p]),Ce=_.useMemo(function(){return PI(Nt.height,Zt)},[Nt.height,Zt]),Ve=Zt-o,Ke=_.useRef(Ve);Ke.current=Ve;function Pe(at){var xe=at;return Number.isNaN(Ke.current)||(xe=Math.min(xe,Ke.current)),xe=Math.max(xe,0),xe}var Be=X<=0,me=X>=Ve,De=_x(Be,me),Ne=function(){return{x:P?-V:V,y:X}},be=_.useRef(Ne()),ft=Na(function(){if(C){var at=Ne();(be.current.x!==at.x||be.current.y!==at.y)&&(C(at),be.current=at)}});function Ze(at,xe){var An=at;xe?(Ac.flushSync(function(){q(An)}),ft()):ke(An)}function st(at){var xe=at.currentTarget.scrollTop;xe!==X&&ke(xe),b==null||b(at),ft()}var Me=function(at){var xe=at,An=p-Nt.width;return xe=Math.max(xe,0),xe=Math.min(xe,An),xe},Le=Na(function(at,xe){xe?(Ac.flushSync(function(){q(function(An){var vn=An+(P?-at:at);return Me(vn)})}),ft()):ke(function(An){var vn=An+at;return vn})}),Je=wie(I,Be,me,!!p,Le),Xe=Qe(Je,2),Et=Xe[0],wt=Xe[1];Oie(I,W,function(at,xe){return De(at,xe)?!1:(Et({preventDefault:function(){},deltaY:at}),!0)}),Kr(function(){function at(An){I&&An.preventDefault()}var xe=W.current;return xe.addEventListener("wheel",Et),xe.addEventListener("DOMMouseScroll",wt),xe.addEventListener("MozMousePixelScroll",at),function(){xe.removeEventListener("wheel",Et),xe.removeEventListener("DOMMouseScroll",wt),xe.removeEventListener("MozMousePixelScroll",at)}},[I]),Kr(function(){p&&q(function(at){return Me(at)})},[Nt.width,p]);var Cn=function(){var at,xe;(at=Y.current)===null||at===void 0||at.delayHidden(),(xe=z.current)===null||xe===void 0||xe.delayHidden()},jn=Iie(W,B,Dt,a,ve,function(){return et(!0)},ke,Cn);_.useImperativeHandle(e,function(){return{getScrollInfo:Ne,scrollTo:function(at){function xe(An){return An&&Pr(An)==="object"&&("left"in An||"top"in An)}xe(at)?(at.left!==void 0&&q(Me(at.left)),jn(at.top)):jn(at)}}}),Kr(function(){if(S){var at=B.slice(It,pn+1);S(at,B)}},[It,pn,B]);var nr=Mie(B,ve,Dt,a),St=y==null?void 0:y({start:It,end:pn,virtual:T,offsetX:V,offsetY:yn,rtl:P,getSize:nr}),Ln=Eie(B,It,pn,p,He,d,Ue),Yn=null;o&&(Yn=$e(ut({},u?"height":"maxHeight",o),Fie),I&&(Yn.overflowY="hidden",p&&(Yn.overflowX="hidden"),pe&&(Yn.pointerEvents="none")));var tn={};return P&&(tn.dir="rtl"),_.createElement("div",Qt({style:$e($e({},l),{},{position:"relative"}),className:N},tn,R),_.createElement(Yc,{onResize:En},_.createElement(g,{className:"".concat(r,"-holder"),style:Yn,ref:W,onScroll:st,onMouseEnter:Cn},_.createElement(bx,{prefixCls:r,height:Zt,offsetX:V,offsetY:yn,scrollWidth:p,onInnerResize:et,ref:G,innerProps:E,rtl:P,extra:St},Ln))),T&&Zt>o&&_.createElement(LI,{ref:Y,prefixCls:r,scrollOffset:X,scrollRange:Zt,rtl:P,onScroll:Ze,onStartMove:he,onStopMove:fe,spinSize:Ce,containerSize:Nt.height,style:D==null?void 0:D.verticalScrollBar,thumbStyle:D==null?void 0:D.verticalScrollBarThumb}),T&&p>Nt.width&&_.createElement(LI,{ref:z,prefixCls:r,scrollOffset:V,scrollRange:p,rtl:P,onScroll:Ze,onStartMove:he,onStopMove:fe,spinSize:ne,containerSize:Nt.width,horizontal:!0,style:D==null?void 0:D.horizontalScrollBar,thumbStyle:D==null?void 0:D.horizontalScrollBarThumb}))}var Cx=_.forwardRef($ie);Cx.displayName="List";function kie(){return/(mac\sos|macintosh)/i.test(navigator.appVersion)}var Bie=["disabled","title","children","style","className"];function MI(t){return typeof t=="string"||typeof t=="number"}var Uie=function(t,e){var n=Kre(),r=n.prefixCls,i=n.id,o=n.open,a=n.multiple,s=n.mode,u=n.searchValue,l=n.toggleOpen,c=n.notFoundContent,d=n.onPopupScroll,m=_.useContext(lE),f=m.maxCount,h=m.flattenOptions,p=m.onActiveValue,v=m.defaultActiveFirstOption,g=m.onSelect,b=m.menuItemSelectedIcon,C=m.rawValues,S=m.fieldNames,E=m.virtual,y=m.direction,D=m.listHeight,R=m.listItemHeight,I=m.optionRender,T="".concat(r,"-item"),P=US(function(){return h},[o,h],function(fe,ve){return ve[0]&&fe[1]!==ve[1]}),N=_.useRef(null),B=_.useMemo(function(){return a&&typeof f<"u"&&(C==null?void 0:C.size)>=f},[a,f,C==null?void 0:C.size]),W=function(fe){fe.preventDefault()},G=function(fe){var ve;(ve=N.current)===null||ve===void 0||ve.scrollTo(typeof fe=="number"?{index:fe}:fe)},Q=function(fe){for(var ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Ue=P.length,ke=0;ke<Ue;ke+=1){var Te=(fe+ke*ve+Ue)%Ue,Re=P[Te]||{},rt=Re.group,_t=Re.data;if(!rt&&!(_t!=null&&_t.disabled)&&!B)return Te}return-1},te=_.useState(function(){return Q(0)}),X=Qe(te,2),x=X[0],O=X[1],M=function(fe){var ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;O(fe);var Ue={source:ve?"keyboard":"mouse"},ke=P[fe];if(!ke){p(null,-1,Ue);return}p(ke.value,fe,Ue)};_.useEffect(function(){M(v!==!1?Q(0):-1)},[P.length,u]);var V=_.useCallback(function(fe){return C.has(fe)&&s!=="combobox"},[s,Wr(C).toString(),C.size]);_.useEffect(function(){var fe=setTimeout(function(){if(!a&&o&&C.size===1){var Ue=Array.from(C)[0],ke=P.findIndex(function(Te){var Re=Te.data;return Re.value===Ue});ke!==-1&&(M(ke),G(ke))}});if(o){var ve;(ve=N.current)===null||ve===void 0||ve.scrollTo(void 0)}return function(){return clearTimeout(fe)}},[o,u]);var q=function(fe){fe!==void 0&&g(fe,{selected:!C.has(fe)}),a||l(!1)};if(_.useImperativeHandle(e,function(){return{onKeyDown:function(fe){var ve=fe.which,Ue=fe.ctrlKey;switch(ve){case lt.N:case lt.P:case lt.UP:case lt.DOWN:{var ke=0;if(ve===lt.UP?ke=-1:ve===lt.DOWN?ke=1:kie()&&Ue&&(ve===lt.N?ke=1:ve===lt.P&&(ke=-1)),ke!==0){var Te=Q(x+ke,ke);G(Te),M(Te,!0)}break}case lt.ENTER:{var Re,rt=P[x];rt&&!(rt!=null&&(Re=rt.data)!==null&&Re!==void 0&&Re.disabled)&&!B?q(rt.value):q(void 0),o&&fe.preventDefault();break}case lt.ESC:l(!1),o&&fe.stopPropagation()}},onKeyUp:function(){},scrollTo:function(fe){G(fe)}}}),P.length===0)return _.createElement("div",{role:"listbox",id:"".concat(i,"_list"),className:"".concat(T,"-empty"),onMouseDown:W},c);var ie=Object.keys(S).map(function(fe){return S[fe]}),ce=function(fe){return fe.label};function pe(fe,ve){var Ue=fe.group;return{role:Ue?"presentation":"option",id:"".concat(i,"_list_").concat(ve)}}var oe=function(fe){var ve=P[fe];if(!ve)return null;var Ue=ve.data||{},ke=Ue.value,Te=ve.group,Re=Cm(Ue,!0),rt=ce(ve);return ve?_.createElement("div",Qt({"aria-label":typeof rt=="string"&&!Te?rt:null},Re,{key:fe},pe(ve,fe),{"aria-selected":V(ke)}),ke):null},he={role:"listbox",id:"".concat(i,"_list")};return _.createElement(_.Fragment,null,E&&_.createElement("div",Qt({},he,{style:{height:0,width:0,overflow:"hidden"}}),oe(x-1),oe(x),oe(x+1)),_.createElement(Cx,{itemKey:"key",ref:N,data:P,height:D,itemHeight:R,fullHeight:!1,onMouseDown:W,onScroll:d,virtual:E,direction:y,innerProps:E?null:he},function(fe,ve){var Ue,ke=fe.group,Te=fe.groupOption,Re=fe.data,rt=fe.label,_t=fe.value,mt=Re.key;if(ke){var nt,_e=(nt=Re.title)!==null&&nt!==void 0?nt:MI(rt)?rt.toString():void 0;return _.createElement("div",{className:Xt(T,"".concat(T,"-group")),title:_e},rt!==void 0?rt:mt)}var He=Re.disabled,et=Re.title;Re.children;var Dt=Re.style,Mt=Re.className,Bt=Qn(Re,Bie),Zt=V5(Bt,ie),It=V(_t),pn=He||!It&&B,yn="".concat(T,"-option"),$t=Xt(T,yn,Mt,(Ue={},ut(Ue,"".concat(yn,"-grouped"),Te),ut(Ue,"".concat(yn,"-active"),x===ve&&!pn),ut(Ue,"".concat(yn,"-disabled"),pn),ut(Ue,"".concat(yn,"-selected"),It),Ue)),Ht=ce(fe),Nt=!b||typeof b=="function"||It,Ot=typeof Ht=="number"?Ht:Ht||_t,En=MI(Ot)?Ot.toString():void 0;return et!==void 0&&(En=et),_.createElement("div",Qt({},Cm(Zt),E?{}:pe(fe,ve),{"aria-selected":It,className:$t,title:En,onMouseMove:function(){x===ve||pn||M(ve)},onClick:function(){pn||q(_t)},style:Dt}),_.createElement("div",{className:"".concat(yn,"-content")},typeof I=="function"?I(fe,{index:ve}):Ot),_.isValidElement(b)||It,Nt&&_.createElement(G5,{className:"".concat(T,"-option-state"),customizeIcon:b,customizeIconProps:{value:_t,disabled:pn,isSelected:It}},It?"✓":null))}))},Vie=_.forwardRef(Uie);const Hie=function(t,e){var n=_.useRef({values:new Map,options:new Map}),r=_.useMemo(function(){var o=n.current,a=o.values,s=o.options,u=t.map(function(d){if(d.label===void 0){var m;return $e($e({},d),{},{label:(m=a.get(d.value))===null||m===void 0?void 0:m.label})}return d}),l=new Map,c=new Map;return u.forEach(function(d){l.set(d.value,d),c.set(d.value,e.get(d.value)||s.get(d.value))}),n.current.values=l,n.current.options=c,u},[t,e]),i=_.useCallback(function(o){return e.get(o)||n.current.options.get(o)},[e]);return[r,i]};function rg(t,e){return fx(t).join("").toUpperCase().includes(e)}const jie=function(t,e,n,r,i){return _.useMemo(function(){if(!n||r===!1)return t;var o=e.options,a=e.label,s=e.value,u=[],l=typeof r=="function",c=n.toUpperCase(),d=l?r:function(f,h){return i?rg(h[i],c):h[o]?rg(h[a!=="children"?a:"label"],c):rg(h[s],c)},m=l?function(f){return qb(f)}:function(f){return f};return t.forEach(function(f){if(f[o]){var h=d(n,m(f));if(h)u.push(f);else{var p=f[o].filter(function(v){return d(n,m(v))});p.length&&u.push($e($e({},f),{},ut({},o,p)))}return}d(n,m(f))&&u.push(f)}),u},[t,r,i,n,e])};var NI=0,zie=h1();function Wie(){var t;return zie?(t=NI,NI+=1):t="TEST_OR_SSR",t}function Yie(t){var e=_.useState(),n=Qe(e,2),r=n[0],i=n[1];return _.useEffect(function(){i("rc_select_".concat(Wie()))},[]),t||r}var Xie=["children","value"],qie=["children"];function Gie(t){var e=t,n=e.key,r=e.props,i=r.children,o=r.value,a=Qn(r,Xie);return $e({key:n,value:o!==void 0?o:n,children:i},a)}function Sx(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Sm(t).map(function(n,r){if(!_.isValidElement(n)||!n.type)return null;var i=n,o=i.type.isSelectOptGroup,a=i.key,s=i.props,u=s.children,l=Qn(s,qie);return e||!o?Gie(n):$e($e({key:"__RC_SELECT_GRP__".concat(a===null?r:a,"__"),label:a},l),{},{options:Sx(u)})}).filter(function(n){return n})}var Kie=function(t,e,n,r,i){return _.useMemo(function(){var o=t,a=!t;a&&(o=Sx(e));var s=new Map,u=new Map,l=function(d,m,f){f&&typeof f=="string"&&d.set(m[f],m)},c=function d(m){for(var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,h=0;h<m.length;h+=1){var p=m[h];!p[n.options]||f?(s.set(p[n.value],p),l(u,p,n.label),l(u,p,r),l(u,p,i)):d(p[n.options],!0)}};return c(o),{options:o,valueOptions:s,labelOptions:u}},[t,e,n,r,i])};function xI(t){var e=_.useRef();e.current=t;var n=_.useCallback(function(){return e.current.apply(e,arguments)},[]);return n}var Zie=["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","optionRender","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","direction","listHeight","listItemHeight","value","defaultValue","labelInValue","onChange","maxCount"],Qie=["inputValue"];function Jie(t){return!t||Pr(t)!=="object"}var eoe=_.forwardRef(function(t,e){var n=t.id,r=t.mode,i=t.prefixCls,o=i===void 0?"rc-select":i,a=t.backfill,s=t.fieldNames,u=t.inputValue,l=t.searchValue,c=t.onSearch,d=t.autoClearSearchValue,m=d===void 0?!0:d,f=t.onSelect,h=t.onDeselect,p=t.dropdownMatchSelectWidth,v=p===void 0?!0:p,g=t.filterOption,b=t.filterSort,C=t.optionFilterProp,S=t.optionLabelProp,E=t.options,y=t.optionRender,D=t.children,R=t.defaultActiveFirstOption,I=t.menuItemSelectedIcon,T=t.virtual,P=t.direction,N=t.listHeight,B=N===void 0?200:N,W=t.listItemHeight,G=W===void 0?20:W,Q=t.value,te=t.defaultValue,X=t.labelInValue,x=t.onChange,O=t.maxCount,M=Qn(t,Zie),V=Yie(n),q=Gb(r),ie=!!(!E&&D),ce=_.useMemo(function(){return g===void 0&&r==="combobox"?!1:g},[g,r]),pe=_.useMemo(function(){return px(s,ie)},[JSON.stringify(s),ie]),oe=Qu("",{value:l!==void 0?l:u,postState:function(Le){return Le||""}}),he=Qe(oe,2),fe=he[0],ve=he[1],Ue=Kie(E,D,pe,C,S),ke=Ue.valueOptions,Te=Ue.labelOptions,Re=Ue.options,rt=_.useCallback(function(Le){var Je=fx(Le);return Je.map(function(Xe){var Et,wt,Cn,jn,nr;if(Jie(Xe))Et=Xe;else{var St;Cn=Xe.key,wt=Xe.label,Et=(St=Xe.value)!==null&&St!==void 0?St:Cn}var Ln=ke.get(Et);if(Ln){var Yn;wt===void 0&&(wt=Ln==null?void 0:Ln[S||pe.label]),Cn===void 0&&(Cn=(Yn=Ln==null?void 0:Ln.key)!==null&&Yn!==void 0?Yn:Et),jn=Ln==null?void 0:Ln.disabled,nr=Ln==null?void 0:Ln.title}return{label:wt,value:Et,key:Cn,disabled:jn,title:nr}})},[pe,S,ke]),_t=Qu(te,{value:Q}),mt=Qe(_t,2),nt=mt[0],_e=mt[1],He=_.useMemo(function(){var Le,Je=q&&nt===null?[]:nt,Xe=rt(Je);return r==="combobox"&&rie((Le=Xe[0])===null||Le===void 0?void 0:Le.value)?[]:Xe},[nt,rt,r,q]),et=Hie(He,ke),Dt=Qe(et,2),Mt=Dt[0],Bt=Dt[1],Zt=_.useMemo(function(){if(!r&&Mt.length===1){var Le=Mt[0];if(Le.value===null&&(Le.label===null||Le.label===void 0))return[]}return Mt.map(function(Je){var Xe;return $e($e({},Je),{},{label:(Xe=Je.label)!==null&&Xe!==void 0?Xe:Je.value})})},[r,Mt]),It=_.useMemo(function(){return new Set(Mt.map(function(Le){return Le.value}))},[Mt]);_.useEffect(function(){if(r==="combobox"){var Le,Je=(Le=Mt[0])===null||Le===void 0?void 0:Le.value;ve(nie(Je)?String(Je):"")}},[Mt]);var pn=xI(function(Le,Je){var Xe,Et=Je??Le;return Xe={},ut(Xe,pe.value,Le),ut(Xe,pe.label,Et),Xe}),yn=_.useMemo(function(){if(r!=="tags")return Re;var Le=Wr(Re),Je=function(Xe){return ke.has(Xe)};return Wr(Mt).sort(function(Xe,Et){return Xe.value<Et.value?-1:1}).forEach(function(Xe){var Et=Xe.value;Je(Et)||Le.push(pn(Et,Xe.label))}),Le},[pn,Re,ke,Mt,r]),$t=jie(yn,pe,fe,ce,C),Ht=_.useMemo(function(){return r!=="tags"||!fe||$t.some(function(Le){return Le[C||"value"]===fe})||$t.some(function(Le){return Le[pe.value]===fe})?$t:[pn(fe)].concat(Wr($t))},[pn,C,r,$t,fe,pe]),Nt=_.useMemo(function(){return b?Wr(Ht).sort(function(Le,Je){return b(Le,Je)}):Ht},[Ht,b]),Ot=_.useMemo(function(){return gie(Nt,{fieldNames:pe,childrenAsData:ie})},[Nt,pe,ie]),En=function(Le){var Je=rt(Le);if(_e(Je),x&&(Je.length!==Mt.length||Je.some(function(wt,Cn){var jn;return((jn=Mt[Cn])===null||jn===void 0?void 0:jn.value)!==(wt==null?void 0:wt.value)}))){var Xe=X?Je:Je.map(function(wt){return wt.value}),Et=Je.map(function(wt){return qb(Bt(wt.value))});x(q?Xe:Xe[0],q?Et:Et[0])}},Y=_.useState(null),z=Qe(Y,2),ne=z[0],Ce=z[1],Ve=_.useState(0),Ke=Qe(Ve,2),Pe=Ke[0],Be=Ke[1],me=R!==void 0?R:r!=="combobox",De=_.useCallback(function(Le,Je){var Xe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Et=Xe.source,wt=Et===void 0?"keyboard":Et;Be(Je),a&&r==="combobox"&&Le!==null&&wt==="keyboard"&&Ce(String(Le))},[a,r]),Ne=function(Le,Je,Xe){var Et=function(){var at,xe=Bt(Le);return[X?{label:xe==null?void 0:xe[pe.label],value:Le,key:(at=xe==null?void 0:xe.key)!==null&&at!==void 0?at:Le}:Le,qb(xe)]};if(Je&&f){var wt=Et(),Cn=Qe(wt,2),jn=Cn[0],nr=Cn[1];f(jn,nr)}else if(!Je&&h&&Xe!=="clear"){var St=Et(),Ln=Qe(St,2),Yn=Ln[0],tn=Ln[1];h(Yn,tn)}},be=xI(function(Le,Je){var Xe,Et=q?Je.selected:!0;Et?Xe=q?[].concat(Wr(Mt),[Le]):[Le]:Xe=Mt.filter(function(wt){return wt.value!==Le}),En(Xe),Ne(Le,Et),r==="combobox"?Ce(""):(!Gb||m)&&(ve(""),Ce(""))}),ft=function(Le,Je){En(Le);var Xe=Je.type,Et=Je.values;(Xe==="remove"||Xe==="clear")&&Et.forEach(function(wt){Ne(wt.value,!1,Xe)})},Ze=function(Le,Je){if(ve(Le),Ce(null),Je.source==="submit"){var Xe=(Le||"").trim();if(Xe){var Et=Array.from(new Set([].concat(Wr(It),[Xe])));En(Et),Ne(Xe,!0),ve("")}return}Je.source!=="blur"&&(r==="combobox"&&En(Le),c==null||c(Le))},st=function(Le){var Je=Le;r!=="tags"&&(Je=Le.map(function(Et){var wt=Te.get(Et);return wt==null?void 0:wt.value}).filter(function(Et){return Et!==void 0}));var Xe=Array.from(new Set([].concat(Wr(It),Wr(Je))));En(Xe),Xe.forEach(function(Et){Ne(Et,!0)})},Me=_.useMemo(function(){var Le=T!==!1&&v!==!1;return $e($e({},Ue),{},{flattenOptions:Ot,onActiveValue:De,defaultActiveFirstOption:me,onSelect:be,menuItemSelectedIcon:I,rawValues:It,fieldNames:pe,virtual:Le,direction:P,listHeight:B,listItemHeight:G,childrenAsData:ie,maxCount:O,optionRender:y})},[O,Ue,Ot,De,me,be,I,It,pe,T,v,P,B,G,ie,y]);return _.createElement(lE.Provider,{value:Me},_.createElement(Cie,Qt({},M,{id:V,prefixCls:o,ref:e,omitDomProps:Qie,mode:r,displayValues:Zt,onDisplayValuesChange:ft,direction:P,searchValue:fe,onSearch:Ze,autoClearSearchValue:m,onSearchSplit:st,dropdownMatchSelectWidth:v,OptionList:Vie,emptyOptions:!Ot.length,activeValue:ne,activeDescendantId:"".concat(V,"_list_").concat(Pe)})))}),cE=eoe;cE.Option=vx;cE.OptGroup=gx;const toe="univer-select",noe="univer-select-disabled",roe="univer-select-selector",ioe="univer-select-show-arrow",ooe="univer-select-loading",aoe="univer-select-arrow-icon",soe="univer-select-loading-icon",uoe="univer-select-selection-placeholder",loe="univer-select-selection-search-input",coe="univer-select-single",doe="univer-select-selection-search",moe="univer-select-selection-item",foe="univer-select-customize-input",hoe="univer-select-multiple",poe="univer-select-selection-item-disabled",goe="univer-select-selection-overflow",voe="univer-select-selection-overflow-item",boe="univer-select-selection-search-mirror",_oe="univer-select-allow-clear",Coe="univer-select-clear",Soe="univer-select-arrow",Eoe="univer-select-focused",yoe="univer-select-dropdown",Doe="univer-select-dropdown-hidden",Roe="univer-select-item",Ioe="univer-select-item-group",Aoe="univer-select-item-option",Toe="univer-select-item-option-state",woe="univer-select-item-option-active",Loe="univer-select-item-option-disabled",Ooe="univer-select-item-empty",Poe="univer-select-selection__choice-zoom",Moe="univer-select-selection__choice-zoom-appear",Noe="univer-select-selection__choice-zoom-appear-active",xoe="univer-select-selection__choice-zoom-leave",Foe="univer-select-selection__choice-zoom-leave-active",$oe="univer-select-dropdown-slide-up-enter",koe="univer-select-dropdown-slide-up-appear",Boe="univer-select-dropdown-slide-up-leave",Uoe="univer-select-dropdown-slide-up-enter-active",Voe="univer-select-dropdown-placement-bottomLeft",Hoe="univer-select-dropdown-slide-up-appear-active",joe="univer-select-dropdown-placement-bottomRight",zoe="univer-select-dropdown-slide-up-in",Woe="univer-select-dropdown-slide-up-leave-active",Yoe="univer-select-dropdown-slide-up-out",Xoe="univer-select-dropdown-placement-topLeft",qoe="univer-select-dropdown-placement-topRight",Goe="univer-select-dropdown-slide-down-in",Koe="univer-select-dropdown-slide-down-out",Zoe={select:toe,selectDisabled:noe,selectSelector:roe,selectShowArrow:ioe,selectLoading:ooe,selectArrowIcon:aoe,selectLoadingIcon:soe,selectSelectionPlaceholder:uoe,selectSelectionSearchInput:loe,selectSingle:coe,selectSelectionSearch:doe,selectSelectionItem:moe,selectCustomizeInput:foe,selectMultiple:hoe,selectSelectionItemDisabled:poe,selectSelectionOverflow:goe,selectSelectionOverflowItem:voe,selectSelectionSearchMirror:boe,selectAllowClear:_oe,selectClear:Coe,selectArrow:Soe,selectFocused:Eoe,selectDropdown:yoe,selectDropdownHidden:Doe,selectItem:Roe,selectItemGroup:Ioe,selectItemOption:Aoe,selectItemOptionState:Toe,selectItemOptionActive:woe,selectItemOptionDisabled:Loe,selectItemEmpty:Ooe,selectSelectionChoiceZoom:Poe,selectSelectionChoiceZoomAppear:Moe,selectSelectionChoiceZoomAppearActive:Noe,selectSelectionChoiceZoomLeave:xoe,selectSelectionChoiceZoomLeaveActive:Foe,selectDropdownSlideUpEnter:$oe,selectDropdownSlideUpAppear:koe,selectDropdownSlideUpLeave:Boe,selectDropdownSlideUpEnterActive:Uoe,selectDropdownPlacementBottomLeft:Voe,selectDropdownSlideUpAppearActive:Hoe,selectDropdownPlacementBottomRight:joe,selectDropdownSlideUpIn:zoe,selectDropdownSlideUpLeaveActive:Woe,selectDropdownSlideUpOut:Yoe,selectDropdownPlacementTopLeft:Xoe,selectDropdownPlacementTopRight:qoe,selectDropdownSlideDownIn:Goe,selectDropdownSlideDownOut:Koe};function K5(t){const{value:e,options:n=[],onChange:r,style:i,className:o,mode:a,dropdownRender:s}=t,{mountContainer:u}=_.useContext(su);return Se.createElement(cE,{mode:a,prefixCls:Zoe.select,getPopupContainer:()=>u,options:n,value:e,menuItemSelectedIcon:null,suffixIcon:Se.createElement(BG,null),onChange:r,style:i,className:o,dropdownRender:s})}const Qoe="univer-select-list",Joe="univer-select-list-item",eae="univer-select-list-item-icon",tae="univer-select-list-item-select",I3={selectList:Qoe,selectListItem:Joe,selectListItemIcon:eae,selectListItemSelect:tae};function dE(t){const{value:e,options:n=[],hideCheckMark:r=!1,onChange:i}=t;function o(a){i(a)}return Se.createElement("ul",{className:I3.selectList},n.map((a,s)=>Se.createElement("li",{key:s,className:Ci(I3.selectListItem,{[I3.selectListItemSelect]:e===a.value})},Se.createElement("a",{onClick:()=>o(a.value)},!r&&Se.createElement("span",{className:I3.selectListItemIcon},e===a.value&&Se.createElement(LG,null)),Se.createElement("span",{style:{color:a.color}},a.label)))))}function nae(t){var e=t.children,n=t.prefixCls,r=t.id,i=t.overlayInnerStyle,o=t.className,a=t.style;return _.createElement("div",{className:Xt("".concat(n,"-content"),o),style:a},_.createElement("div",{className:"".concat(n,"-inner"),id:r,role:"tooltip",style:i},typeof e=="function"?e():e))}var p2={shiftX:64,adjustY:1},g2={adjustX:1,shiftY:!0},Ra=[0,0],rae={left:{points:["cr","cl"],overflow:g2,offset:[-4,0],targetOffset:Ra},right:{points:["cl","cr"],overflow:g2,offset:[4,0],targetOffset:Ra},top:{points:["bc","tc"],overflow:p2,offset:[0,-4],targetOffset:Ra},bottom:{points:["tc","bc"],overflow:p2,offset:[0,4],targetOffset:Ra},topLeft:{points:["bl","tl"],overflow:p2,offset:[0,-4],targetOffset:Ra},leftTop:{points:["tr","tl"],overflow:g2,offset:[-4,0],targetOffset:Ra},topRight:{points:["br","tr"],overflow:p2,offset:[0,-4],targetOffset:Ra},rightTop:{points:["tl","tr"],overflow:g2,offset:[4,0],targetOffset:Ra},bottomRight:{points:["tr","br"],overflow:p2,offset:[0,4],targetOffset:Ra},rightBottom:{points:["bl","br"],overflow:g2,offset:[4,0],targetOffset:Ra},bottomLeft:{points:["tl","bl"],overflow:p2,offset:[0,4],targetOffset:Ra},leftBottom:{points:["br","bl"],overflow:g2,offset:[-4,0],targetOffset:Ra}},iae=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],oae=function(t,e){var n=t.overlayClassName,r=t.trigger,i=r===void 0?["hover"]:r,o=t.mouseEnterDelay,a=o===void 0?0:o,s=t.mouseLeaveDelay,u=s===void 0?.1:s,l=t.overlayStyle,c=t.prefixCls,d=c===void 0?"rc-tooltip":c,m=t.children,f=t.onVisibleChange,h=t.afterVisibleChange,p=t.transitionName,v=t.animation,g=t.motion,b=t.placement,C=b===void 0?"right":b,S=t.align,E=S===void 0?{}:S,y=t.destroyTooltipOnHide,D=y===void 0?!1:y,R=t.defaultVisible,I=t.getTooltipContainer,T=t.overlayInnerStyle;t.arrowContent;var P=t.overlay,N=t.id,B=t.showArrow,W=B===void 0?!0:B,G=Qn(t,iae),Q=_.useRef(null);_.useImperativeHandle(e,function(){return Q.current});var te=$e({},G);"visible"in t&&(te.popupVisible=t.visible);var X=function(){return _.createElement(nae,{key:"content",prefixCls:d,id:N,overlayInnerStyle:T},P)};return _.createElement(U5,Qt({popupClassName:n,prefixCls:d,popup:X,action:i,builtinPlacements:rae,popupPlacement:C,ref:Q,popupAlign:E,getPopupContainer:I,onPopupVisibleChange:f,afterPopupVisibleChange:h,popupTransitionName:p,popupAnimation:v,popupMotion:g,defaultPopupVisible:R,autoDestroy:D,mouseLeaveDelay:u,popupStyle:l,mouseEnterDelay:a,arrow:W},te),m)};const aae=_.forwardRef(oae),sae="univer-tooltip",uae="univer-tooltip-hidden",lae="univer-tooltip-placement-top",cae="univer-tooltip-placement-right",dae="univer-tooltip-placement-bottom",mae="univer-tooltip-placement-left",fae="univer-tooltip-arrow",hae="univer-tooltip-placement-topLeft",pae="univer-tooltip-placement-topRight",gae="univer-tooltip-inner",FI={tooltip:sae,tooltipHidden:uae,tooltipPlacementTop:lae,tooltipPlacementRight:cae,tooltipPlacementBottom:dae,tooltipPlacementLeft:mae,tooltipArrow:fae,tooltipPlacementTopLeft:hae,tooltipPlacementTopRight:pae,tooltipInner:gae},$I={shiftX:0,adjustY:1},kI={adjustX:1,shiftY:!0},A3=[0,0],vae={left:{points:["cr","cl"],overflow:kI,offset:[-4,0],targetOffset:A3},right:{points:["cl","cr"],overflow:kI,offset:[4,0],targetOffset:A3},top:{points:["bc","tc"],overflow:$I,offset:[0,-4],targetOffset:A3},bottom:{points:["tc","bc"],overflow:$I,offset:[0,4],targetOffset:A3}},df=_.forwardRef((t,e)=>{const{children:n,visible:r,placement:i="top",title:o,onVisibleChange:a}=t,{mountContainer:s}=_.useContext(su);return Se.createElement(aae,{visible:r,ref:e,prefixCls:FI.tooltip,getTooltipContainer:()=>s,overlay:Se.createElement("div",{className:FI.tooltipContent},typeof o=="function"?o():o),builtinPlacements:vae,placement:i,mouseEnterDelay:.2,showArrow:!0,destroyTooltipOnHide:!0,onVisibleChange:a},n)}),bae="116",_ae="12",Cae="univer-slider",Sae="univer-slider-disabled",Eae="univer-slider-rail",yae="univer-slider-handle",Dae="univer-slider-reset-point",Rae="univer-slider-value",Iae="univer-slider-inner-rail",Aae="univer-dropdown-open",Tae="univer-slider-shortcuts",wae="univer-slider-shortcut",Lae="univer-slider-shortcut-icon",Oae="univer-slider-shortcut-active",Mo={sliderWidth:bae,sliderHandleSize:_ae,slider:Cae,sliderDisabled:Sae,sliderRail:Eae,sliderHandle:yae,sliderResetPoint:Dae,sliderValue:Rae,sliderInnerRail:Iae,dropdownOpen:Aae,sliderShortcuts:Tae,sliderShortcut:wae,sliderShortcutIcon:Lae,sliderShortcutActive:Oae};function Pae(t){const{value:e,min:n=0,max:r=400,disabled:i=!1,resetPoint:o=100,shortcuts:a,onChange:s}=t,u=_.useRef(null),{locale:l}=_.useContext(su);function c(){i||s&&s(o)}function d(h){if(i)return;let p=e+h;e+h<=n?p=n:e+h>=r&&(p=r),s&&s(p)}const m=_.useMemo(()=>{if(e<=o){const h=50/(o-n);return(e-n)*h}if(e<=r)return o*.5+(e-o)/(r-o)*50},[n,r,o,e]);function f(h){if(i)return;h.preventDefault();const p=u.current;let v=!0;function g(S){if(v){let E=S.clientX-p.getBoundingClientRect().x;E<=0?E=0:E>=+Mo.sliderWidth&&(E=+Mo.sliderWidth);const y=E/+Mo.sliderWidth;let D=0;y<=.5?D=n+y*(o-n)*2:D=o+(y-.5)*(r-o)*2,s&&s(Math.ceil(D))}}function b(){v=!1,document.removeEventListener("mousemove",g),window.removeEventListener("mouseup",b)}function C(S){S.relatedTarget===null&&b()}document.addEventListener("mousemove",g),window.addEventListener("mouseup",b),window.addEventListener("mouseout",C)}return Se.createElement("div",{className:Ci(Mo.slider,{[Mo.sliderDisabled]:i})},Se.createElement(X1,{type:"text",size:"small",disabled:e<=n||i,onClick:()=>d(-10)},Se.createElement(WG,null)),Se.createElement("div",{className:Mo.sliderRail},Se.createElement("div",{ref:u,role:"track",className:Mo.sliderInnerRail},Se.createElement(df,{title:`${l.design.Slider.resetTo} ${o}%`},Se.createElement("a",{className:Mo.sliderResetPoint,role:"reset button",onClick:c})),Se.createElement("div",{className:Mo.sliderHandle,role:"handle",style:{left:`${m}%`},onMouseDown:f}))),Se.createElement(X1,{type:"text",size:"small",disabled:e>=r||i,onClick:()=>d(10)},Se.createElement($G,null)),Se.createElement(eu,{placement:"topLeft",overlay:Se.createElement("div",{className:Mo.sliderShortcuts},a==null?void 0:a.map(h=>Se.createElement("a",{key:h,className:Ci(Mo.sliderShortcut,h===e?Mo.sliderShortcutActive:""),onClick:()=>s&&s(h)},h===e&&Se.createElement("span",{className:Mo.sliderShortcutIcon},"✔"),Se.createElement("span",null,h,"%"))))},Se.createElement("a",{className:Mo.sliderValue},e,"%")))}function Mae(t){return typeof t=="function"?t():t}function Nae(t,e){return t.length!==e.length?!0:t.some((n,r)=>n!==e[r])}function xae(t,e,n,r){var i;const o=_.useRef(null),a=_.useRef(null),s=_.useRef(r??void 0),u=_.useRef(!1);let l,c;const d=(()=>{if(typeof s.current<"u"){const h=r??[];return Nae(s.current,h)?(s.current=h,!0):!1}return o.current!==t})();if((!a.current||d)&&(o.current=Mae(t),(i=a.current)==null||i.unsubscribe(),a.current=o.current.subscribe(h=>{l?l(h):(c=h,u.current=!0)})),e&&!u.current)throw new Error("[useObservable]: expect shouldHaveSyncValue but not getting a sync value!");const m=_.useState(c||n),f=m[0];return l=m[1],_.useEffect(()=>()=>{var h;return(h=a.current)==null?void 0:h.unsubscribe()},[]),f}const Fae="#fee7e7",$ae="#fdcece",kae="#fb9d9d",Bae="#fa7979",Uae="#fe4b4b",Vae="#f30b0b",Hae="#e30909",jae="#cd0f0f",zae="#b20000",Wae="#9d0000",Yae="#fef0e6",Xae="#fee1cd",qae="#fdc49b",Gae="#fca669",Kae="#ff8c51",Zae="#fb8937",Qae="#f96800",Jae="#df5d00",ese="#cc4f10",tse="#b24000",nse="#fef6e6",rse="#feeecd",ise="#fddc9b",ose="#fccb69",ase="#ffbd37",sse="#faad14",use="#e59b07",lse="#c68400",cse="#a97100",dse="#8f5f00",mse="#fefbe6",fse="#fef7cd",hse="#fdf09b",pse="#fce869",gse="#fbe137",vse="#f9d700",bse="#ebc301",_se="#d8b300",Cse="#c5a300",Sse="#b19401",Ese="#f7fde8",yse="#effbd0",Dse="#def6a2",Rse="#cef273",Ise="#beee44",Ase="#a4dc16",Tse="#8bbb11",wse="#7aa017",Lse="#688c0d",Ose="#58770a",Pse="#effce8",Mse="#dff9d2",Nse="#bff3a5",xse="#9fed78",Fse="#7fe74b",$se="#59d01e",kse="#49b811",Bse="#409f11",Use="#398712",Vse="#317310",Hse="#e5fffb",jse="#ccfff7",zse="#a9fff2",Wse="#78fce8",Yse="#2afede",Xse="#10e8c7",qse="#00d2b2",Gse="#00b298",Kse="#009e87",Zse="#008b76",Qse="#e4f4fe",Jse="#d0edff",e1e="#9fdaff",t1e="#62c2ff",n1e="#2daeff",r1e="#0b9efb",i1e="#0493ee",o1e="#0080d2",a1e="#006cae",s1e="#005f9a",u1e="#e8ecfd",l1e="#d0d9fb",c1e="#a2b3f6",d1e="#738df2",m1e="#3a60f7",f1e="#274fee",h1e="#143ee3",p1e="#012bd2",g1e="#0025b7",v1e="#001f9c",b1e="#f1eafa",_1e="#e3d5f6",C1e="#c7abed",S1e="#aa82e3",E1e="#9e6de3",y1e="#894ede",D1e="#7735d4",R1e="#6721cb",I1e="#510eb0",A1e="#3f0198",T1e="#fde8f3",w1e="#fbd0e8",L1e="#f6a2d0",O1e="#f273b9",P1e="#f248a6",M1e="#e7258f",N1e="#d4157e",x1e="#c1026b",F1e="#a1095c",$1e="#8f0550",k1e="#f5f5f5",B1e="#ececec",U1e="#e5e5e5",V1e="#d8d8d8",H1e="#bcbcbc",j1e="#999999",z1e="#7a7a7a",W1e="#656565",Y1e="#565656",X1e="#4b4b4b",q1e="#1e222b",G1e="#ffffff",K1e="0 4px 12px rgba(30, 34, 43, 0.08)",Z1e="0 4px 24px 0 rgba(30, 34, 43, 0.08)",Q1e="#ececec",J1e="#d8d8d8",eue="#ffffff",tue="#1e222b",nue="#7a7a7a",rue="#4b4b4b",iue="#bcbcbc",oue="#e5e5e5",aue="#bcbcbc",sue="#999999",uue="#7a7a7a",lue="4px",cue="8px",due="12px",mue="24px",fue="20px",hue="16px",pue="12px",gue="8px",vue="4px",bue="20px",_ue="16px",Cue="12px",Sue="8px",Eue="4px",yue="20px",Due="18px",Rue="16px",Iue="15px",Aue="14px",Tue="13px",wue="12px",Lue="768px",Oue="1024px",Pue="1280px",Mue="1536px",Nue="#2daeff",xue="#59d01e",Fue="#ffbd37",$ue="#fe4b4b",kue="#274fee",Bue="#3a60f7",Uue="#0b9efb",Vue="#9e6de3",Hue="#49b811",jue="#0b9efb",zue="#ffbd37",Wue="#f273b9",Yue="#00d2b2",Xue="#ff8c51",que="#565656",Gue="#274fee",Kue="#fa7979",Zue="#8bbb11",Que="#d8b300",Ex={red50:Fae,red100:$ae,red200:kae,red300:Bae,red400:Uae,red500:Vae,red600:Hae,red700:jae,red800:zae,red900:Wae,orange50:Yae,orange100:Xae,orange200:qae,orange300:Gae,orange400:Kae,orange500:Zae,orange600:Qae,orange700:Jae,orange800:ese,orange900:tse,gold50:nse,gold100:rse,gold200:ise,gold300:ose,gold400:ase,gold500:sse,gold600:use,gold700:lse,gold800:cse,gold900:dse,yellow50:mse,yellow100:fse,yellow200:hse,yellow300:pse,yellow400:gse,yellow500:vse,yellow600:bse,yellow700:_se,yellow800:Cse,yellow900:Sse,verdancy50:Ese,verdancy100:yse,verdancy200:Dse,verdancy300:Rse,verdancy400:Ise,verdancy500:Ase,verdancy600:Tse,verdancy700:wse,verdancy800:Lse,verdancy900:Ose,green50:Pse,green100:Mse,green200:Nse,green300:xse,green400:Fse,green500:$se,green600:kse,green700:Bse,green800:Use,green900:Vse,jiqing50:Hse,jiqing100:jse,jiqing200:zse,jiqing300:Wse,jiqing400:Yse,jiqing500:Xse,jiqing600:qse,jiqing700:Gse,jiqing800:Kse,jiqing900:Zse,blue50:Qse,blue100:Jse,blue200:e1e,blue300:t1e,blue400:n1e,blue500:r1e,blue600:i1e,blue700:o1e,blue800:a1e,blue900:s1e,hyacinth50:u1e,hyacinth100:l1e,hyacinth200:c1e,hyacinth300:d1e,hyacinth400:m1e,hyacinth500:f1e,hyacinth600:h1e,hyacinth700:p1e,hyacinth800:g1e,hyacinth900:v1e,purple50:b1e,purple100:_1e,purple200:C1e,purple300:S1e,purple400:E1e,purple500:y1e,purple600:D1e,purple700:R1e,purple800:I1e,purple900:A1e,magenta50:T1e,magenta100:w1e,magenta200:L1e,magenta300:O1e,magenta400:P1e,magenta500:M1e,magenta600:N1e,magenta700:x1e,magenta800:F1e,magenta900:$1e,grey50:k1e,grey100:B1e,grey200:U1e,grey300:V1e,grey400:H1e,grey500:j1e,grey600:z1e,grey700:W1e,grey800:Y1e,grey900:X1e,colorBlack:q1e,colorWhite:G1e,boxShadowBase:K1e,boxShadowLg:Z1e,bgColor:Q1e,bgColorHover:J1e,bgColorSecondary:eue,textColor:tue,textColorSecondary:nue,textColorSecondaryDarker:rue,textColorTertiary:iue,borderColor:oue,scrollbarColor:aue,scrollbarColorHover:sue,scrollbarColorActive:uue,borderRadiusBase:lue,borderRadiusLg:cue,borderRadiusXl:due,marginXl:mue,marginLg:fue,marginBase:hue,marginSm:pue,marginXs:gue,marginXxs:vue,paddingXl:bue,paddingLg:_ue,paddingBase:Cue,paddingSm:Sue,paddingXs:Eue,fontSizeXxl:yue,fontSizeXl:Due,fontSizeLg:Rue,fontSizeBase:Iue,fontSizeSm:Aue,fontSizeXs:Tue,fontSizeXxs:wue,breakpointXs:Lue,breakpointSm:Oue,breakpointBase:Pue,breakpointLg:Mue,infoColor:Nue,successColor:xue,warningColor:Fue,errorColor:$ue,primaryColor:kue,primaryColorHover:Bue,linkColor:Uue,loopColor1:Vue,loopColor2:Hue,loopColor3:jue,loopColor4:zue,loopColor5:Wue,loopColor6:Yue,loopColor7:Xue,loopColor8:que,loopColor9:Gue,loopColor10:Kue,loopColor11:Zue,loopColor12:Que},Jue="univer-theme",ele={theme:Jue};function tle(t){return`--${t.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`).replace(/(\d+)/g,"-$1")}`}function nle(t){if(t.startsWith("#")){const e=t.replace("#",""),n=Number.parseInt(e.substring(0,2),16),r=Number.parseInt(e.substring(2,4),16),i=Number.parseInt(e.substring(4,6),16);return`${n}, ${r}, ${i}`}return t}class rle{constructor(){e9(this,"_styleSheet",null),e9(this,"_themeRootName",ele.theme);const e=document.createElement("style");e.id=this._themeRootName,document.head.appendChild(e),this._styleSheet=e}setTheme(e,n){this._styleSheet&&(e.classList.remove(this._themeRootName),e.classList.add(this._themeRootName),this._styleSheet.innerHTML="",this._styleSheet.innerHTML=`.${this._themeRootName} {${Object.keys(n).map(r=>`${tle(r)}: ${nle(n[r])};`).join("")}}`)}}const BI=new rle;var ile=Object.defineProperty,ole=(t,e,n)=>e in t?ile(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,w=(t,e,n)=>(ole(t,typeof e!="symbol"?e+"":e,n),n),yx=(t=>(t.RECT="rect",t.CIRCLE="circle",t.PATH="path",t))(yx||{}),Zs=(t=>(t.PointerMove="PointerMove",t.PointerDown="PointerDown",t.PointerUp="PointerUp",t.PointerOut="PointerOut",t.PointerLeave="PointerLeave",t.PointerOver="PointerOver",t.PointerEnter="PointerEnter",t.wheel="MouseWheel",t.KeyDown="KeyDown",t.KeyUp="KeyUp",t))(Zs||{});const Dx=1,mE='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',ale="0",UI=1,sle=14;var Jt=(t=>(t.DEFAULT="default",t.AUTO="auto",t.CROSSHAIR="crosshair",t.POINTER="pointer",t.MOVE="move",t.EAST_RESIZE="e-resize",t.NORTH_EAST_RESIZE="ne-resize",t.NORTH_WEST_RESIZE="nw-resize",t.NORTH_RESIZE="n-resize",t.SOUTH_EAST_RESIZE="se-resize",t.SOUTH_WEST_RESIZE="sw-resize",t.SOUTH_RESIZE="s-resize",t.WEST_RESIZE="w-resize",t.TEXT="text",t.WAIT="wait",t.HELP="help",t.CELL="cell",t.NONE="none",t.VERTICAL_TEXT="vertical-text",t.NO_DROP="no-drop",t.GRAB="grab",t.GRABBING="grabbing",t.ALL_SCROLL="all-scroll",t.COLUMN_RESIZE="col-resize",t.ROW_RESIZE="row-resize",t.PROGRESS="progress",t.NOT_ALLOWED="not-allowed",t.ZOOM_IN="zoom-in",t.ZOOM_OUT="zoom-out",t))(Jt||{});const P0="rgb(0,0,0)";var rr=(t=>(t.TOP="t",t.BOTTOM="b",t.LEFT="l",t.RIGHT="r",t.TL_BR="tl_br",t.TL_BC="tl_bc",t.TL_MR="tl_mr",t.BL_TR="bl_tr",t.ML_TR="ml_tr",t.BC_TR="bc_tr",t))(rr||{}),f9=(t=>(t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t))(f9||{}),qt=(t=>(t.ENGINE="Engine",t.SCENE="Scene",t.BASE_OBJECT="BaseObject",t.SCENE_VIEWER="SceneViewer",t.CANVAS="Canvas",t.VIEWPORT="Viewport",t.LAYER="Layer",t.GROUP="Group",t))(qt||{});const ule=1e3,lle=2e3,gi=.5;var eo=(t=>(t[t.translate=0]="translate",t[t.resize=1]="resize",t[t.scale=2]="scale",t[t.skew=3]="skew",t[t.flip=4]="flip",t[t.all=5]="all",t))(eo||{});let cle=class{isEmpty(){return this._isEmpty()}toString(e){if(this.isEmpty())throw new Error("Output is empty.");return this._toString(e)}toRegExp(e){return new RegExp(this.toString(e),e)}},Dm=class g6 extends cle{constructor(...e){super(),this.data=[];for(const n of e)n instanceof g6?this.data.push(...n.data):this.data.push(mle(n));this._unique()}union(...e){return new g6(this,...e)}subtract(...e){const n=this.data.slice(),r=[];let i=0;const{data:o}=new g6(...e);for(;n.length!==0;){const a=n.shift(),[s,u]=a;let l;do{l=!0;const c=o[i];if(c===void 0){r.push(a);break}const[d,m]=c;m<s?(l=!1,i++):u<d?r.push(a):d<=s&&m<u?(i++,n.unshift([m+1,u])):s<d&&m<u?(i++,r.push([s,d-1]),n.unshift([m+1,u])):s<d&&u<=m&&r.push([s,d-1])}while(!l)}return new g6(...r)}intersect(...e){return this.subtract(this.subtract(...e))}_isEmpty(){return this.data.length===0}_toString(e){return hle(this.data,e)}_unique(){this.data.sort(fle);const e=[];let n=null;for(const r of this.data)n===null||n[1]+1<r[0]?(e.push(r),n=r):(e.splice(-1,1,[Math.min(r[0],n[0]),Math.max(r[1],n[1])]),n=e[e.length-1]);this.data=e}};const fE=(...t)=>new Dm(...t);function dle(t){if(t.length!==1){const e=`${t.length} (${JSON.stringify(t)})`;throw new Error(`Expected length = 1, but received ${e}.`)}return t.charCodeAt(0)}function mle(t){if(typeof t=="number"&&(t<0||t>1114111))throw new Error(`Invalid unicode code point detected: ${t<0?t:`0x${t.toString(16)}`}`);const[e]=[t].map(n=>typeof n!="object"?[n,n]:n).map(n=>n.map(r=>typeof r=="string"?dle(r):r));return e}function fle(t,e){return t[0]-e[0]}function hle(t,e=""){if(e.includes("u"))return VI(t,!0);const{normal:n,surrogate:r}=gle(t),i=[];return n.length!==0&&i.push(VI(n,!1)),i.push(...ple(r)),i.join("|")}function VI(t,e){return`[${t.map(([n,r])=>n===r?V6(n,e):`${V6(n,e)}-${V6(r,e)}`).join("")}]`}function ple(t){const e=[];if(t.entire.data.length!==0){const n=t.entire.toString(),r=`[${[56320,57343].map(i=>V6(i,!1)).join("-")}]`;e.push(`${n}${r}`)}for(const{h:n,l:r}of t.partial){const i=V6(n,!1),o=r.toString();e.push(`${i}${o}`)}return e}function gle(t){const e=[],n=[];for(let r=0;r<t.length;r++){const i=t[r],[o,a]=i;if(o>=65536){n.push(...t.slice(r));break}if(a>=65536){e.push([o,65535]),n.push([65536,a],...t.slice(r+1));break}e.push(i)}return{normal:e,surrogate:vle(n)}}function vle(t){const e=[],n=[];for(const[o,a]of t){const s=HI(o),u=HI(a);if(s.h===u.h){i(s.h,s.l,u.l);continue}s.l===56320?r(s.h):i(s.h,s.l,57343);for(let l=s.h+1;l<u.h;l++)r(l);u.l===57343?r(u.h):i(u.h,56320,u.l)}return{entire:new Dm(...e),partial:n.map(({h:o,l:a})=>({h:o,l:new Dm(...a)}))};function r(o){e.push(o)}function i(o,a,s){const u=n[n.length-1];u!==void 0&&u.h===o?u.l.push([a,s]):n.push({h:o,l:[[a,s]]})}}function HI(t){return{h:Math.floor((t-65536)/1024)+55296,l:(t-65536)%1024+56320}}function V6(t,e){const n=t.toString(16);return e?`\\u{${n}}`:`\\u${"0".repeat(4-n.length)}${n}`}const ble=[[0,127]],_le=[[48,57],[65,70],[97,102]],Cle=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,837,[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1456,1469],1471,[1473,1474],[1476,1477],1479,[1488,1514],[1519,1522],[1552,1562],[1568,1623],[1625,1631],[1646,1747],[1749,1756],[1761,1768],[1773,1775],[1786,1788],1791,[1808,1855],[1869,1969],[1994,2026],[2036,2037],2042,[2048,2071],[2074,2092],[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2260,2271],[2275,2281],[2288,2363],[2365,2380],[2382,2384],[2389,2403],[2417,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2493,2500],[2503,2504],[2507,2508],2510,2519,[2524,2525],[2527,2531],[2544,2545],2556,[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2622,2626],[2631,2632],[2635,2636],2641,[2649,2652],2654,[2672,2677],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2749,2757],[2759,2761],[2763,2764],2768,[2784,2787],[2809,2812],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2877,2884],[2887,2888],[2891,2892],[2902,2903],[2908,2909],[2911,2915],2929,[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3020],3024,3031,[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3133,3140],[3142,3144],[3146,3148],[3157,3158],[3160,3162],3165,[3168,3171],[3200,3203],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3261,3268],[3270,3272],[3274,3276],[3285,3286],[3293,3294],[3296,3299],[3313,3315],[3328,3340],[3342,3344],[3346,3386],[3389,3396],[3398,3400],[3402,3404],3406,[3412,3415],[3423,3427],[3450,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3535,3540],3542,[3544,3551],[3570,3571],[3585,3642],[3648,3654],3661,[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3769],[3771,3773],[3776,3780],3782,3789,[3804,3807],3840,[3904,3911],[3913,3948],[3953,3971],[3976,3991],[3993,4028],[4096,4150],4152,[4155,4159],[4176,4239],[4250,4253],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5907],[5919,5939],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6067],[6070,6088],6103,6108,[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6456],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6683],[6688,6750],[6753,6772],6823,[6847,6848],[6860,6862],[6912,6963],[6965,6979],[6981,6988],[7040,7081],[7084,7087],[7098,7141],[7143,7153],[7168,7222],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7655,7668],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],8526,[8544,8584],[9398,9449],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11775],11823,[12293,12295],[12321,12329],[12337,12341],[12344,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42612,42619],[42623,42735],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43013],[43015,43047],[43072,43123],[43136,43203],43205,[43250,43255],43259,[43261,43263],[43274,43306],[43312,43346],[43360,43388],[43392,43442],[43444,43455],43471,[43488,43503],[43514,43518],[43520,43574],[43584,43597],[43616,43638],[43642,43710],43712,43714,[43739,43741],[43744,43759],[43762,43765],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44010],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66426],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68903],[69248,69289],[69291,69292],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69632,69701],[69745,69749],[69760,69816],69826,[69840,69864],[69888,69938],[69956,69959],[69968,70002],70006,[70016,70079],[70081,70084],[70094,70095],70106,70108,[70144,70161],[70163,70196],70199,[70206,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70376],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70461,70468],[70471,70472],[70475,70476],70480,70487,[70493,70499],[70656,70721],[70723,70725],[70727,70730],[70751,70753],[70784,70849],[70852,70853],70855,[71040,71093],[71096,71102],[71128,71133],[71168,71230],71232,71236,[71296,71349],71352,[71424,71450],[71453,71466],[71488,71494],[71680,71736],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,71996],[71999,72002],[72096,72103],[72106,72151],[72154,72159],72161,[72163,72164],[72192,72242],[72245,72254],[72272,72343],72349,[72368,72440],[72704,72712],[72714,72758],[72760,72766],72768,[72818,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73025],73027,[73030,73031],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73110],73112,[73440,73462],[73472,73488],[73490,73530],[73534,73536],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],[94031,94087],[94095,94111],[94176,94177],94179,[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113822,[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125255,125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[127280,127305],[127312,127337],[127344,127369],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],Sle=[[0,1114111]],Ele=[[0,887],[890,895],[900,906],908,[910,929],[931,1327],[1329,1366],[1369,1418],[1421,1423],[1425,1479],[1488,1514],[1519,1524],[1536,1805],[1807,1866],[1869,1969],[1984,2042],[2045,2093],[2096,2110],[2112,2139],2142,[2144,2154],[2160,2190],[2192,2193],[2200,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2558],[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2678],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2801],[2809,2815],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2935],[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3066],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3191,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3407],[3412,3427],[3430,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3572],[3585,3642],[3647,3675],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807],[3840,3911],[3913,3948],[3953,3991],[3993,4028],[4030,4044],[4046,4058],[4096,4293],4295,4301,[4304,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4988],[4992,5017],[5024,5109],[5112,5117],[5120,5788],[5792,5880],[5888,5909],[5919,5942],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6109],[6112,6121],[6128,6137],[6144,6169],[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6459],6464,[6468,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6622,6683],[6686,6750],[6752,6780],[6783,6793],[6800,6809],[6816,6829],[6832,6862],[6912,6988],[6992,7038],[7040,7155],[7164,7223],[7227,7241],[7245,7304],[7312,7354],[7357,7367],[7376,7418],[7424,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],[8192,8292],[8294,8305],[8308,8334],[8336,8348],[8352,8384],[8400,8432],[8448,8587],[8592,9254],[9280,9290],[9312,11123],[11126,11157],[11159,11507],[11513,11557],11559,11565,[11568,11623],[11631,11632],[11647,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11869],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12351],[12353,12438],[12441,12543],[12549,12591],[12593,12686],[12688,12771],[12784,12830],[12832,42124],[42128,42182],[42192,42539],[42560,42743],[42752,42954],[42960,42961],42963,[42965,42969],[42994,43052],[43056,43065],[43072,43127],[43136,43205],[43214,43225],[43232,43347],[43359,43388],[43392,43469],[43471,43481],[43486,43518],[43520,43574],[43584,43597],[43600,43609],[43612,43714],[43739,43766],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43883],[43888,44013],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[55296,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64450],[64467,64911],[64914,64967],64975,[65008,65049],[65056,65106],[65108,65126],[65128,65131],[65136,65140],[65142,65276],65279,[65281,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65504,65510],[65512,65518],[65529,65533],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65792,65794],[65799,65843],[65847,65934],[65936,65948],65952,[66e3,66045],[66176,66204],[66208,66256],[66272,66299],[66304,66339],[66349,66378],[66384,66426],[66432,66461],[66463,66499],[66504,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67671,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67871,67897],67903,[67968,68023],[68028,68047],[68050,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],[68159,68168],[68176,68184],[68192,68255],[68288,68326],[68331,68342],[68352,68405],[68409,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68903],[68912,68921],[69216,69246],[69248,69289],[69291,69293],[69296,69297],[69373,69415],[69424,69465],[69488,69513],[69552,69579],[69600,69622],[69632,69709],[69714,69749],[69759,69826],69837,[69840,69864],[69872,69881],[69888,69940],[69942,69959],[69968,70006],[70016,70111],[70113,70132],[70144,70161],[70163,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313],[70320,70378],[70384,70393],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[70656,70747],[70749,70753],[70784,70855],[70864,70873],[71040,71093],[71096,71133],[71168,71236],[71248,71257],[71264,71276],[71296,71353],[71360,71369],[71424,71450],[71453,71467],[71472,71494],[71680,71739],[71840,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72006],[72016,72025],[72096,72103],[72106,72151],[72154,72164],[72192,72263],[72272,72354],[72368,72440],[72448,72457],[72704,72712],[72714,72758],[72760,72773],[72784,72812],[72816,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129],[73440,73464],[73472,73488],[73490,73530],[73534,73561],73648,[73664,73713],[73727,74649],[74752,74862],[74864,74868],[74880,75075],[77712,77810],[77824,78933],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92782,92862],[92864,92873],[92880,92909],[92912,92917],[92928,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071],[93760,93850],[93952,94026],[94031,94087],[94095,94111],[94176,94180],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113820,113827],[118528,118573],[118576,118598],[118608,118723],[118784,119029],[119040,119078],[119081,119274],[119296,119365],[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,121483],[121499,121503],[121505,121519],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123184,123197],[123200,123209],[123214,123215],[123536,123566],[123584,123641],123647,[124112,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125127,125142],[125184,125259],[125264,125273],[125278,125279],[126065,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],917505,[917536,917631],[917760,917999],[983040,1048573],[1048576,1114109]],yle=[1564,[8206,8207],[8234,8238],[8294,8297]],Dle=[[40,41],60,62,91,93,123,125,171,187,[3898,3901],[5787,5788],[8249,8250],[8261,8262],[8317,8318],[8333,8334],8512,[8705,8708],[8712,8717],8721,[8725,8726],[8730,8733],[8735,8738],8740,8742,[8747,8755],8761,[8763,8780],[8786,8789],[8799,8800],8802,[8804,8811],[8814,8844],[8847,8850],8856,[8866,8867],[8870,8888],[8894,8895],[8905,8909],[8912,8913],[8918,8941],[8944,8959],[8968,8971],[8992,8993],[9001,9002],[10088,10101],10176,[10179,10182],[10184,10185],[10187,10189],[10195,10198],[10204,10206],[10210,10223],[10627,10648],[10651,10656],[10658,10671],10680,[10688,10693],10697,[10702,10706],[10708,10709],[10712,10716],10721,[10723,10725],[10728,10729],[10740,10745],[10748,10749],[10762,10780],[10782,10785],10788,10790,10793,[10795,10798],[10804,10805],[10812,10814],[10839,10840],[10852,10853],[10858,10861],[10863,10864],[10867,10868],[10873,10915],[10918,10925],[10927,10966],10972,10974,[10978,10982],[10988,10990],10995,[10999,11003],11005,11262,[11778,11781],[11785,11786],[11788,11789],[11804,11805],[11808,11817],[11861,11868],[12296,12305],[12308,12315],[65113,65118],[65124,65125],[65288,65289],65308,65310,65339,65341,65371,65373,[65375,65376],[65378,65379],120539,120597,120655,120713,120771],Rle=[39,46,58,94,96,168,173,175,180,[183,184],[688,879],[884,885],890,[900,901],903,[1155,1161],1369,1375,[1425,1469],1471,[1473,1474],[1476,1477],1479,1524,[1536,1541],[1552,1562],1564,1600,[1611,1631],1648,[1750,1757],[1759,1768],[1770,1773],1807,1809,[1840,1866],[1958,1968],[2027,2037],2042,2045,[2070,2093],[2137,2139],2184,[2192,2193],[2200,2207],[2249,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2417,2433,2492,[2497,2500],2509,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,[2901,2902],[2914,2915],2946,3008,3021,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3457,3530,[3538,3540],3542,3633,[3636,3642],[3654,3662],3761,[3764,3772],3782,[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,4348,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6103,6109,[6155,6159],6211,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,6823,[6832,6862],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7288,7293],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7468,7530],7544,[7579,7679],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[8203,8207],[8216,8217],8228,8231,[8234,8238],[8288,8292],[8294,8303],8305,8319,[8336,8348],[8400,8432],[11388,11389],[11503,11505],11631,11647,[11744,11775],11823,12293,[12330,12333],[12337,12341],12347,[12441,12446],[12540,12542],40981,[42232,42237],42508,[42607,42610],[42612,42621],42623,[42652,42655],[42736,42737],[42752,42785],42864,[42888,42890],[42994,42996],[43e3,43001],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43471,[43493,43494],[43561,43566],[43569,43570],[43573,43574],43587,43596,43632,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,43741,[43756,43757],[43763,43764],43766,[43867,43871],[43881,43883],44005,44008,44013,64286,[64434,64450],[65024,65039],65043,[65056,65071],65106,65109,65279,65287,65294,65306,65342,65344,65392,[65438,65439],65507,[65529,65531],66045,66272,[66422,66426],[67456,67461],[67463,67504],[67506,67514],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69821,69826,69837,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,[78896,78912],[78919,78933],[92912,92916],[92976,92982],[92992,92995],94031,[94095,94111],[94176,94177],[94179,94180],[110576,110579],[110581,110587],[110589,110590],[113821,113822],[113824,113827],[118528,118573],[118576,118598],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123184,123197],123566,[123628,123631],[124139,124143],[125136,125142],[125252,125259],[127995,127999],917505,[917536,917631],[917760,917999]],Ile=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,442],[444,447],[452,659],[661,696],[704,705],[736,740],837,[880,883],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],[1376,1416],[4256,4293],4295,4301,[4304,4346],[4348,4351],[5024,5109],[5112,5117],[7296,7304],[7312,7354],[7357,7359],[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8500],8505,[8508,8511],[8517,8521],8526,[8544,8575],[8579,8580],[9398,9449],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[42560,42605],[42624,42653],[42786,42887],[42891,42894],[42896,42954],[42960,42961],42963,[42965,42969],[42994,42998],[43e3,43002],[43824,43866],[43868,43881],[43888,43967],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[66560,66639],[66736,66771],[66776,66811],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],67456,[67459,67461],[67463,67504],[67506,67514],[68736,68786],[68800,68850],[71840,71903],[93760,93823],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122633],[122635,122654],[122661,122666],[122928,122989],[125184,125251],[127280,127305],[127312,127337],[127344,127369]],Ale=[[65,90],181,[192,214],[216,223],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,[329,330],332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,383,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,[452,453],[455,456],[458,459],461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,[497,498],500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,837,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],962,[975,977],[981,982],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,[1008,1009],[1012,1013],1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],1415,[4256,4293],4295,4301,[5112,5117],[7296,7304],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,[7834,7835],7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8064,8111],[8114,8116],[8119,8124],[8130,8132],[8135,8140],[8152,8155],[8168,8172],[8178,8180],[8183,8188],8486,[8490,8491],8498,[8544,8559],8579,[9398,9423],[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[43888,43967],[64256,64262],[64275,64279],[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[125184,125217]],Tle=[[65,90],[97,122],181,[192,214],[216,246],[248,311],[313,396],[398,410],[412,425],[428,441],[444,445],447,[452,544],[546,563],[570,596],[598,599],601,[603,604],[608,609],611,[613,614],[616,620],623,[625,626],629,637,640,[642,643],[647,652],658,[669,670],837,[880,883],[886,887],[891,893],895,902,[904,906],908,[910,929],[931,977],[981,1013],[1015,1019],[1021,1153],[1162,1327],[1329,1366],[1377,1415],[4256,4293],4295,4301,[4304,4346],[4349,4351],[5024,5109],[5112,5117],[7296,7304],[7312,7354],[7357,7359],7545,7549,7566,[7680,7835],7838,[7840,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8486,[8490,8491],8498,8526,[8544,8575],[8579,8580],[9398,9449],[11264,11376],[11378,11379],[11381,11382],[11390,11491],[11499,11502],[11506,11507],[11520,11557],11559,11565,[42560,42605],[42624,42651],[42786,42799],[42802,42863],[42873,42887],[42891,42893],[42896,42900],[42902,42926],[42928,42954],[42960,42961],[42966,42969],[42997,42998],43859,[43888,43967],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[66560,66639],[66736,66771],[66776,66811],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68736,68786],[68800,68850],[71840,71903],[93760,93823],[125184,125251]],wle=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,[452,453],[455,456],[458,459],461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,[497,498],500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8072,8079],[8088,8095],[8104,8111],[8120,8124],[8136,8140],[8152,8155],[8168,8172],[8184,8188],8486,[8490,8491],8498,[8544,8559],8579,[9398,9423],[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[125184,125217]],Lle=[[65,90],160,168,170,173,175,[178,181],[184,186],[188,190],[192,214],[216,223],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,[306,308],310,313,315,317,[319,321],323,325,327,[329,330],332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,383,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,[452,461],463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,[497,500],[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,[688,696],[728,733],[736,740],[832,833],[835,837],847,880,882,884,886,890,[894,895],[900,906],908,[910,911],[913,929],[931,939],962,[975,982],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,[1008,1010],[1012,1013],1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],1415,1564,[1653,1656],[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3635,3763,[3804,3805],3852,3907,3917,3922,3927,3932,3945,3955,[3957,3961],3969,3987,3997,4002,4007,4012,4025,[4256,4293],4295,4301,4348,[4447,4448],[5112,5117],[6068,6069],[6155,6159],[7296,7304],[7312,7354],[7357,7359],[7468,7470],[7472,7482],[7484,7501],[7503,7530],7544,[7579,7615],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,[7834,7835],7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],8049,8051,8053,8055,8057,8059,8061,[8064,8111],[8114,8116],[8119,8132],[8135,8143],8147,[8152,8155],[8157,8159],8163,[8168,8175],[8178,8180],[8183,8190],[8192,8207],8209,8215,[8228,8230],[8234,8239],[8243,8244],[8246,8247],8252,8254,[8263,8265],8279,[8287,8305],[8308,8334],[8336,8348],8360,[8448,8451],[8453,8455],[8457,8467],[8469,8470],[8473,8477],[8480,8482],8484,8486,8488,[8490,8493],[8495,8505],[8507,8512],[8517,8521],[8528,8575],8579,8585,[8748,8749],[8751,8752],[9001,9002],[9312,9450],10764,[10868,10870],10972,[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11388,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,11631,11935,12019,[12032,12245],12288,12342,[12344,12346],[12443,12444],12447,12543,[12593,12686],[12690,12703],[12800,12830],[12832,12871],[12880,12926],[12928,13311],42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,[42652,42653],42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42864,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,[42994,42997],[43e3,43001],[43868,43871],43881,[43888,43967],[63744,64013],64016,64018,[64021,64030],64032,64034,[64037,64038],[64042,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65024,65049],[65072,65092],[65095,65106],[65108,65126],[65128,65131],[65136,65138],65140,[65142,65276],65279,[65281,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65504,65510],[65512,65518],[65520,65528],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[67457,67461],[67463,67504],[67506,67514],[68736,68786],[71840,71871],[93760,93791],[113824,113827],[119134,119140],[119155,119162],[119227,119232],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[122928,122989],[125184,125217],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[127232,127242],[127248,127278],[127280,127311],[127338,127340],127376,[127488,127490],[127504,127547],[127552,127560],[127568,127569],[130032,130041],[194560,195101],[917504,921599]],Ole=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,311,314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,396,402,405,[409,410],414,417,419,421,424,429,432,436,438,441,445,447,452,[454,455],[457,458],460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,497],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,547,549,551,553,555,557,559,561,563,572,[575,576],578,583,585,587,589,[591,596],[598,599],601,[603,604],[608,609],611,[613,614],[616,620],623,[625,626],629,637,640,[642,643],[647,652],658,[669,670],837,881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,1019,[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[5112,5117],[7296,7304],7545,7549,7566,7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7835],7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8526,[8560,8575],8580,[9424,9449],[11312,11359],11361,[11365,11366],11368,11370,11372,11379,11382,11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,11491,11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,42799,42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,42874,42876,42879,42881,42883,42885,42887,42892,42897,[42899,42900],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42967,42969,42998,43859,[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68800,68850],[71872,71903],[93792,93823],[125218,125251]],Ple=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,311,314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,396,402,405,[409,410],414,417,419,421,424,429,432,436,438,441,445,447,[453,454],[456,457],[459,460],462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],[498,499],501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,547,549,551,553,555,557,559,561,563,572,[575,576],578,583,585,587,589,[591,596],[598,599],601,[603,604],[608,609],611,[613,614],[616,620],623,[625,626],629,637,640,[642,643],[647,652],658,[669,670],837,881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,1019,[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1377,1415],[4304,4346],[4349,4351],[5112,5117],[7296,7304],7545,7549,7566,7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7835],7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8116],[8118,8119],8124,8126,[8130,8132],[8134,8135],8140,[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8188,8526,[8560,8575],8580,[9424,9449],[11312,11359],11361,[11365,11366],11368,11370,11372,11379,11382,11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,11491,11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,42799,42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,42874,42876,42879,42881,42883,42885,42887,42892,42897,[42899,42900],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42967,42969,42998,43859,[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68800,68850],[71872,71903],[93792,93823],[125218,125251]],Mle=[[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3907,3917,3922,3927,3932,3945,3958,3960,3987,3997,4002,4007,4012,4025,10972,64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],[119134,119140],[119227,119232]],Nle=[45,1418,1470,5120,6150,[8208,8213],8275,8315,8331,8722,11799,11802,[11834,11835],11840,11869,12316,12336,12448,[65073,65074],65112,65123,65293,69293],xle=[173,847,1564,[4447,4448],[6068,6069],[6155,6159],[8203,8207],[8234,8238],[8288,8303],12644,[65024,65039],65279,65440,[65520,65528],[113824,113827],[119155,119162],[917504,921599]],Fle=[329,1651,3959,3961,[6051,6052],[8298,8303],[9001,9002],917505],$le=[94,96,168,175,180,[183,184],[688,846],[848,855],[861,866],[884,885],890,[900,901],[1155,1159],1369,[1425,1441],[1443,1469],1471,[1473,1474],1476,[1611,1618],[1623,1624],[1759,1760],[1765,1766],[1770,1772],[1840,1866],[1958,1968],[2027,2037],[2072,2073],[2200,2207],[2249,2258],[2275,2302],2364,2381,[2385,2388],2417,2492,2509,2620,2637,2748,2765,[2813,2815],2876,2893,2901,3021,3132,3149,3260,3277,[3387,3388],3405,3530,[3655,3660],3662,3770,[3784,3788],[3864,3865],3893,3895,3897,[3902,3903],[3970,3972],[3974,3975],4038,4151,[4153,4154],[4195,4196],[4201,4205],[4231,4237],4239,[4250,4251],[4957,4959],[5908,5909],[6089,6099],6109,[6457,6459],[6773,6780],6783,[6832,6846],[6849,6859],6964,6980,[7019,7027],[7082,7083],[7222,7223],[7288,7293],[7376,7400],7405,7412,[7415,7417],[7468,7530],[7620,7631],[7669,7679],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[11503,11505],11823,[12330,12335],[12441,12444],12540,42607,[42620,42621],42623,[42652,42653],[42736,42737],[42752,42785],[42888,42890],[43e3,43001],43204,[43232,43249],[43307,43310],43347,43443,43456,43493,[43643,43645],[43711,43714],43766,[43867,43871],[43881,43883],[44012,44013],64286,[65056,65071],65342,65344,65392,[65438,65439],65507,66272,[67456,67461],[67463,67504],[67506,67514],[68325,68326],[68898,68903],[69373,69375],[69446,69456],[69506,69509],69702,69744,[69817,69818],[69939,69940],70003,70080,[70090,70092],[70197,70198],[70377,70378],70460,70477,[70502,70508],[70512,70516],70722,70726,[70850,70851],[71103,71104],71231,[71350,71351],71467,[71737,71738],[71997,71998],72003,72160,72244,72263,72345,72767,73026,[73028,73029],73111,[78919,78933],[92912,92916],[92976,92982],[94095,94111],[94192,94193],[110576,110579],[110581,110587],[110589,110590],[118528,118573],[118576,118598],[119143,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[122928,122989],[123184,123190],123566,[123628,123631],[125136,125142],[125252,125254],[125256,125258]],kle=[35,42,[48,57],169,174,8252,8265,8482,8505,[8596,8601],[8617,8618],[8986,8987],9e3,9167,[9193,9203],[9208,9210],9410,[9642,9643],9654,9664,[9723,9726],[9728,9732],9742,9745,[9748,9749],9752,9757,9760,[9762,9763],9766,9770,[9774,9775],[9784,9786],9792,9794,[9800,9811],[9823,9824],9827,[9829,9830],9832,9851,[9854,9855],[9874,9879],9881,[9883,9884],[9888,9889],9895,[9898,9899],[9904,9905],[9917,9918],[9924,9925],9928,[9934,9935],9937,[9939,9940],[9961,9962],[9968,9973],[9975,9978],9981,9986,9989,[9992,9997],9999,10002,10004,10006,10013,10017,10024,[10035,10036],10052,10055,10060,10062,[10067,10069],10071,[10083,10084],[10133,10135],10145,10160,10175,[10548,10549],[11013,11015],[11035,11036],11088,11093,12336,12349,12951,12953,126980,127183,[127344,127345],[127358,127359],127374,[127377,127386],[127462,127487],[127489,127490],127514,127535,[127538,127546],[127568,127569],[127744,127777],[127780,127891],[127894,127895],[127897,127899],[127902,127984],[127987,127989],[127991,128253],[128255,128317],[128329,128334],[128336,128359],[128367,128368],[128371,128378],128391,[128394,128397],128400,[128405,128406],[128420,128421],128424,[128433,128434],128444,[128450,128452],[128465,128467],[128476,128478],128481,128483,128488,128495,128499,[128506,128591],[128640,128709],[128715,128722],[128725,128727],[128732,128741],128745,[128747,128748],128752,[128755,128764],[128992,129003],129008,[129292,129338],[129340,129349],[129351,129535],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784]],Ble=[35,42,[48,57],8205,8419,65039,[127462,127487],[127995,127999],[129456,129459],[917536,917631]],Ule=[[127995,127999]],Vle=[9757,9977,[9994,9997],127877,[127938,127940],127943,[127946,127948],[128066,128067],[128070,128080],[128102,128120],128124,[128129,128131],[128133,128135],128143,128145,128170,[128372,128373],128378,128400,[128405,128406],[128581,128583],[128587,128591],128675,[128692,128694],128704,128716,129292,129295,[129304,129311],129318,[129328,129337],[129340,129342],129399,[129461,129462],[129464,129465],129467,[129485,129487],[129489,129501],[129731,129733],[129776,129784]],Hle=[[8986,8987],[9193,9196],9200,9203,[9725,9726],[9748,9749],[9800,9811],9855,9875,9889,[9898,9899],[9917,9918],[9924,9925],9934,9940,9962,[9970,9971],9973,9978,9981,9989,[9994,9995],10024,10060,10062,[10067,10069],10071,[10133,10135],10160,10175,[11035,11036],11088,11093,126980,127183,127374,[127377,127386],[127462,127487],127489,127514,127535,[127538,127542],[127544,127546],[127568,127569],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],127988,[127992,128062],128064,[128066,128252],[128255,128317],[128331,128334],[128336,128359],128378,[128405,128406],128420,[128507,128591],[128640,128709],128716,[128720,128722],[128725,128727],[128732,128735],[128747,128748],[128756,128764],[128992,129003],129008,[129292,129338],[129340,129349],[129351,129535],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784]],jle=[836,[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3907,3917,3922,3927,3932,3945,3955,[3957,3958],3960,3969,3987,3997,4002,4007,4012,4025,10972,64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],[119134,119140],[119227,119232]],zle=[[192,197],[199,207],[209,214],[217,221],[224,229],[231,239],[241,246],[249,253],[255,271],[274,293],[296,304],[308,311],[313,318],[323,328],[332,337],[340,357],[360,382],[416,417],[431,432],[461,476],[478,483],[486,496],[500,501],[504,539],[542,543],[550,563],836,[901,902],[904,906],908,[910,912],[938,944],[970,974],[979,980],[1024,1025],1027,1031,[1036,1038],1049,1081,[1104,1105],1107,1111,[1116,1118],[1142,1143],[1217,1218],[1232,1235],[1238,1239],[1242,1247],[1250,1255],[1258,1269],[1272,1273],[1570,1574],1728,1730,1747,2345,2353,2356,[2392,2399],[2507,2508],[2524,2525],2527,2611,2614,[2649,2651],2654,2888,[2891,2892],[2908,2909],2964,[3018,3020],3144,3264,[3271,3272],[3274,3275],[3402,3404],3546,[3548,3550],3907,3917,3922,3927,3932,3945,3955,[3957,3958],3960,3969,3987,3997,4002,4007,4012,4025,4134,6918,6920,6922,6924,6926,6930,6971,6973,[6976,6977],6979,[7680,7833],7835,[7840,7929],[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],[8129,8132],[8134,8147],[8150,8155],[8157,8174],[8178,8180],[8182,8188],8491,[8602,8603],8622,[8653,8655],8708,8713,8716,8740,8742,8769,8772,8775,8777,8800,8802,[8813,8817],[8820,8821],[8824,8825],[8832,8833],[8836,8837],[8840,8841],[8876,8879],[8928,8931],[8938,8941],10972,12364,12366,12368,12370,12372,12374,12376,12378,12380,12382,12384,12386,12389,12391,12393,[12400,12401],[12403,12404],[12406,12407],[12409,12410],[12412,12413],12436,12446,12460,12462,12464,12466,12468,12470,12472,12474,12476,12478,12480,12482,12485,12487,12489,[12496,12497],[12499,12500],[12502,12503],[12505,12506],[12508,12509],12532,[12535,12538],12542,[44032,55203],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],69786,69788,69803,[69934,69935],[70475,70476],[70843,70844],70846,[71098,71099],71992,[119134,119140],[119227,119232]],Wle=[168,175,180,184,[188,190],[306,307],[319,320],329,[452,460],[497,499],[728,733],836,890,[900,901],1415,[1653,1656],[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3635,3763,[3804,3805],3907,3917,3922,3927,3932,3945,3955,[3957,3961],3969,3987,3997,4002,4007,4012,4025,7834,8125,[8127,8129],[8141,8143],[8157,8159],[8173,8174],[8189,8190],8215,[8229,8230],[8243,8244],[8246,8247],8252,8254,[8263,8265],8279,8360,[8448,8449],8451,[8453,8454],8457,8470,[8480,8482],8507,[8528,8543],[8545,8547],[8549,8552],[8554,8555],[8561,8563],[8565,8568],[8570,8571],8585,[8748,8749],[8751,8752],[9321,9397],10764,[10868,10870],10972,[12443,12444],12447,12543,[12800,12830],[12832,12867],[12880,12895],[12924,12925],[12977,13007],[13055,13311],[64256,64262],[64275,64279],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335],64477,[64490,64507],[64512,64829],[64848,64911],[64914,64967],[65008,65020],65049,65072,[65097,65100],[65136,65138],65140,[65142,65151],[65269,65276],65507,[119134,119140],[119227,119232],[127232,127242],[127248,127274],[127277,127278],[127306,127311],[127338,127340],127376,[127488,127489],[127552,127560]],Yle=[168,175,180,184,[188,190],[192,197],[199,207],[209,214],[217,221],[224,229],[231,239],[241,246],[249,253],[255,271],[274,293],[296,304],[306,311],[313,320],[323,329],[332,337],[340,357],[360,382],[416,417],[431,432],[452,476],[478,483],[486,501],[504,539],[542,543],[550,563],[728,733],836,890,[900,902],[904,906],908,[910,912],[938,944],[970,974],[979,980],[1024,1025],1027,1031,[1036,1038],1049,1081,[1104,1105],1107,1111,[1116,1118],[1142,1143],[1217,1218],[1232,1235],[1238,1239],[1242,1247],[1250,1255],[1258,1269],[1272,1273],1415,[1570,1574],[1653,1656],1728,1730,1747,2345,2353,2356,[2392,2399],[2507,2508],[2524,2525],2527,2611,2614,[2649,2651],2654,2888,[2891,2892],[2908,2909],2964,[3018,3020],3144,3264,[3271,3272],[3274,3275],[3402,3404],3546,[3548,3550],3635,3763,[3804,3805],3907,3917,3922,3927,3932,3945,3955,[3957,3961],3969,3987,3997,4002,4007,4012,4025,4134,6918,6920,6922,6924,6926,6930,6971,6973,[6976,6977],6979,[7680,7835],[7840,7929],[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8125],[8127,8132],[8134,8147],[8150,8155],[8157,8174],[8178,8180],[8182,8190],8215,[8229,8230],[8243,8244],[8246,8247],8252,8254,[8263,8265],8279,8360,[8448,8449],8451,[8453,8454],8457,8470,[8480,8482],8491,8507,[8528,8543],[8545,8547],[8549,8552],[8554,8555],[8561,8563],[8565,8568],[8570,8571],8585,[8602,8603],8622,[8653,8655],8708,8713,8716,8740,8742,[8748,8749],[8751,8752],8769,8772,8775,8777,8800,8802,[8813,8817],[8820,8821],[8824,8825],[8832,8833],[8836,8837],[8840,8841],[8876,8879],[8928,8931],[8938,8941],[9321,9397],10764,[10868,10870],10972,12364,12366,12368,12370,12372,12374,12376,12378,12380,12382,12384,12386,12389,12391,12393,[12400,12401],[12403,12404],[12406,12407],[12409,12410],[12412,12413],12436,[12443,12444],[12446,12447],12460,12462,12464,12466,12468,12470,12472,12474,12476,12478,12480,12482,12485,12487,12489,[12496,12497],[12499,12500],[12502,12503],[12505,12506],[12508,12509],12532,[12535,12538],[12542,12543],[12800,12830],[12832,12867],[12880,12895],[12910,12926],[12977,13007],[13055,13311],[44032,55203],[64256,64262],[64275,64279],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335],[64420,64421],[64432,64433],64477,[64490,64507],[64512,64829],[64848,64911],[64914,64967],[65008,65020],65049,65072,[65097,65100],[65136,65138],65140,[65142,65151],[65153,65164],[65269,65276],65507,69786,69788,69803,[69934,69935],[70475,70476],[70843,70844],70846,[71098,71099],71992,[119134,119140],[119227,119232],[127232,127242],[127248,127274],[127277,127278],[127306,127311],[127338,127340],127376,[127488,127489],127507,[127552,127560]],Xle=[169,174,8252,8265,8482,8505,[8596,8601],[8617,8618],[8986,8987],9e3,9096,9167,[9193,9203],[9208,9210],9410,[9642,9643],9654,9664,[9723,9726],[9728,9733],[9735,9746],[9748,9861],[9872,9989],[9992,10002],10004,10006,10013,10017,10024,[10035,10036],10052,10055,10060,10062,[10067,10069],10071,[10083,10087],[10133,10135],10145,10160,10175,[10548,10549],[11013,11015],[11035,11036],11088,11093,12336,12349,12951,12953,[126976,127231],[127245,127247],127279,[127340,127345],[127358,127359],127374,[127377,127386],[127405,127461],[127489,127503],127514,127535,[127538,127546],[127548,127551],[127561,127994],[128e3,128317],[128326,128591],[128640,128767],[128884,128895],[128981,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129279],[129292,129338],[129340,129349],[129351,129791],[130048,131069]],qle=[183,[720,721],1600,2042,2901,3654,3782,6154,6211,6823,7222,7291,12293,[12337,12341],[12445,12446],[12540,12542],40981,42508,43471,43494,43632,43741,[43763,43764],65392,[67457,67458],70493,[71110,71112],72344,[92994,92995],[94176,94177],94179,[123196,123197],[125252,125254]],Gle=[[832,833],[835,836],884,894,903,[2392,2399],[2524,2525],2527,2611,2614,[2649,2651],2654,[2908,2909],3907,3917,3922,3927,3932,3945,3955,[3957,3958],3960,3969,3987,3997,4002,4007,4012,4025,8049,8051,8053,8055,8057,8059,8061,8123,8126,8137,8139,8147,8155,8163,8171,[8174,8175],8185,8187,8189,[8192,8193],8486,[8490,8491],[9001,9002],10972,[63744,64013],64016,64018,[64021,64030],64032,64034,[64037,64038],[64042,64109],[64112,64217],64285,64287,[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64334],[119134,119140],[119227,119232],[194560,195101]],Kle=[[32,126],[160,172],[174,767],[880,887],[890,895],[900,906],908,[910,929],[931,1154],[1162,1327],[1329,1366],[1369,1418],[1421,1423],1470,1472,1475,1478,[1488,1514],[1519,1524],[1542,1551],1563,[1565,1610],[1632,1647],[1649,1749],1758,[1765,1766],1769,[1774,1805],1808,[1810,1839],[1869,1957],1969,[1984,2026],[2036,2042],[2046,2069],2074,2084,2088,[2096,2110],[2112,2136],2142,[2144,2154],[2160,2190],[2208,2249],[2307,2361],2363,[2365,2368],[2377,2380],[2382,2384],[2392,2401],[2404,2432],[2434,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,[2495,2496],[2503,2504],[2507,2508],2510,[2524,2525],[2527,2529],[2534,2557],2563,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2622,2624],[2649,2652],2654,[2662,2671],[2674,2676],2678,2691,[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2749,2752],2761,[2763,2764],2768,[2784,2785],[2790,2801],2809,[2818,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,2880,[2887,2888],[2891,2892],[2908,2909],[2911,2913],[2918,2935],2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3007,[3009,3010],[3014,3016],[3018,3020],3024,[3046,3066],[3073,3075],[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3137,3140],[3160,3162],3165,[3168,3169],[3174,3183],[3191,3200],[3202,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3261,3262],[3264,3265],[3267,3268],[3271,3272],[3274,3275],[3293,3294],[3296,3297],[3302,3311],[3313,3315],[3330,3340],[3342,3344],[3346,3386],3389,[3391,3392],[3398,3400],[3402,3404],[3406,3407],[3412,3414],[3416,3425],[3430,3455],[3458,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3536,3537],[3544,3550],[3558,3567],[3570,3572],[3585,3632],[3634,3635],[3647,3654],[3663,3675],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3792,3801],[3804,3807],[3840,3863],[3866,3892],3894,3896,[3898,3911],[3913,3948],3967,3973,[3976,3980],[4030,4037],[4039,4044],[4046,4058],[4096,4140],4145,4152,[4155,4156],[4159,4183],[4186,4189],[4193,4208],[4213,4225],[4227,4228],[4231,4236],[4238,4252],[4254,4293],4295,4301,[4304,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4960,4988],[4992,5017],[5024,5109],[5112,5117],[5120,5788],[5792,5880],[5888,5905],5909,[5919,5937],[5940,5942],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6070,[6078,6085],[6087,6088],[6100,6108],[6112,6121],[6128,6137],[6144,6154],[6160,6169],[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6435,6438],[6441,6443],[6448,6449],[6451,6456],6464,[6468,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6622,6678],[6681,6682],[6686,6741],6743,6753,[6755,6756],[6765,6770],[6784,6793],[6800,6809],[6816,6829],[6916,6963],6971,[6973,6977],[6979,6988],[6992,7018],[7028,7038],[7042,7073],[7078,7079],7082,[7086,7141],7143,[7146,7148],7150,[7154,7155],[7164,7211],[7220,7221],[7227,7241],[7245,7304],[7312,7354],[7357,7367],7379,7393,[7401,7404],[7406,7411],[7413,7415],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],[8192,8202],[8208,8231],[8239,8287],[8304,8305],[8308,8334],[8336,8348],[8352,8384],[8448,8587],[8592,9254],[9280,9290],[9312,11123],[11126,11157],[11159,11502],[11506,11507],[11513,11557],11559,11565,[11568,11623],[11631,11632],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11776,11869],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12329],[12336,12351],[12353,12438],[12443,12543],[12549,12591],[12593,12686],[12688,12771],[12784,12830],[12832,42124],[42128,42182],[42192,42539],[42560,42606],42611,[42622,42653],[42656,42735],[42738,42743],[42752,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43044],[43047,43051],[43056,43065],[43072,43127],[43136,43203],[43214,43225],[43250,43262],[43264,43301],[43310,43334],[43346,43347],[43359,43388],[43395,43442],[43444,43445],[43450,43451],[43454,43469],[43471,43481],[43486,43492],[43494,43518],[43520,43560],[43567,43568],[43571,43572],[43584,43586],[43588,43595],43597,[43600,43609],[43612,43643],[43645,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43755],[43758,43765],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43883],[43888,44004],[44006,44007],[44009,44012],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64450],[64467,64911],[64914,64967],64975,[65008,65023],[65040,65049],[65072,65106],[65108,65126],[65128,65131],[65136,65140],[65142,65276],[65281,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65504,65510],[65512,65518],[65532,65533],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65792,65794],[65799,65843],[65847,65934],[65936,65948],65952,[66e3,66044],[66176,66204],[66208,66256],[66273,66299],[66304,66339],[66349,66378],[66384,66421],[66432,66461],[66463,66499],[66504,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67671,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67871,67897],67903,[67968,68023],[68028,68047],[68050,68096],[68112,68115],[68117,68119],[68121,68149],[68160,68168],[68176,68184],[68192,68255],[68288,68324],[68331,68342],[68352,68405],[68409,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68899],[68912,68921],[69216,69246],[69248,69289],69293,[69296,69297],[69376,69415],[69424,69445],[69457,69465],[69488,69505],[69510,69513],[69552,69579],[69600,69622],69632,[69634,69687],[69703,69709],[69714,69743],[69745,69746],69749,[69762,69810],[69815,69816],[69819,69820],[69822,69825],[69840,69864],[69872,69881],[69891,69926],69932,[69942,69959],[69968,70002],[70004,70006],[70018,70069],[70079,70088],[70093,70094],[70096,70111],[70113,70132],[70144,70161],[70163,70190],[70194,70195],70197,[70200,70205],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313],[70320,70366],[70368,70370],[70384,70393],[70402,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70463,[70465,70468],[70471,70472],[70475,70477],70480,[70493,70499],[70656,70711],[70720,70721],70725,[70727,70747],70749,[70751,70753],[70784,70831],[70833,70834],70841,[70843,70844],70846,70849,[70852,70855],[70864,70873],[71040,71086],[71088,71089],[71096,71099],71102,[71105,71131],[71168,71218],[71227,71228],71230,[71233,71236],[71248,71257],[71264,71276],[71296,71338],71340,[71342,71343],71350,[71352,71353],[71360,71369],[71424,71450],[71456,71457],71462,[71472,71494],[71680,71726],71736,71739,[71840,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],[71985,71989],[71991,71992],71997,[71999,72002],[72004,72006],[72016,72025],[72096,72103],[72106,72147],[72156,72159],[72161,72164],72192,[72203,72242],[72249,72250],[72255,72262],72272,[72279,72280],[72284,72329],72343,[72346,72354],[72368,72440],[72448,72457],[72704,72712],[72714,72751],72766,[72768,72773],[72784,72812],[72816,72847],72873,72881,72884,[72960,72966],[72968,72969],[72971,73008],73030,[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73107,73108],73110,73112,[73120,73129],[73440,73458],[73461,73464],[73474,73488],[73490,73525],[73534,73535],73537,[73539,73561],73648,[73664,73713],[73727,74649],[74752,74862],[74864,74868],[74880,75075],[77712,77810],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92782,92862],[92864,92873],[92880,92909],92917,[92928,92975],[92983,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071],[93760,93850],[93952,94026],[94032,94087],[94099,94111],[94176,94179],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113820,113823,[118608,118723],[118784,119029],[119040,119078],[119081,119140],119142,[119146,119149],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121483],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],[123200,123209],[123214,123215],[123536,123565],[123584,123627],[123632,123641],123647,[124112,124139],[124144,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125127,125135],[125184,125251],125259,[125264,125273],[125278,125279],[126065,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],Zle=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,2494,[2497,2500],2509,2519,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,[2878,2879],[2881,2884],2893,[2901,2903],[2914,2915],2946,3006,3008,3021,3031,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3266,3270,[3276,3277],[3285,3286],[3298,3299],[3328,3329],[3387,3388],3390,[3393,3396],3405,3415,[3426,3427],3457,3530,3535,[3538,3540],3542,3551,3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6862],[6912,6915],[6964,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],8204,[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],[65438,65439],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69826,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70462,70464,70487,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,70832,[70835,70840],70842,70845,[70847,70848],[70850,70851],71087,[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],71984,[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,78912,[78919,78933],[92912,92916],[92976,92982],94031,[94095,94098],94180,[113821,113822],[118528,118573],[118576,118598],119141,[119143,119145],[119150,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917536,917631],[917760,917999]],Qle=[2381,2509,2637,2765,2893,3021,3149,3277,[3387,3388],3405,3530,3642,3770,3972,[4153,4154],[5908,5909],5940,6098,6752,6980,[7082,7083],[7154,7155],11647,43014,43052,43204,43347,43456,43766,44013,68159,69702,69744,69759,69817,[69939,69940],70080,70197,70378,70477,70722,70850,71103,71231,71350,71467,71737,[71997,71998],72160,72244,72263,72345,72767,[73028,73029],73111,[73537,73538]],Jle=[[48,57],[65,70],[97,102],[65296,65305],[65313,65318],[65345,65350]],ece=[45,173,1418,6150,[8208,8209],11799,12539,65123,65293,65381],tce=[[12272,12273],[12276,12283]],nce=[[12274,12275]],rce=[[48,57],[65,90],95,[97,122],170,181,183,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[768,884],[886,887],[890,893],895,[902,906],908,[910,929],[931,1013],[1015,1153],[1155,1159],[1162,1327],[1329,1366],1369,[1376,1416],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1488,1514],[1519,1522],[1552,1562],[1568,1641],[1646,1747],[1749,1756],[1759,1768],[1770,1788],1791,[1808,1866],[1869,1969],[1984,2037],2042,2045,[2048,2093],[2112,2139],[2144,2154],[2160,2183],[2185,2190],[2200,2273],[2275,2403],[2406,2415],[2417,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2545],2556,2558,[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2677],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2799],[2809,2815],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2927],2929,[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3055],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3200,3203],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3406],[3412,3415],[3423,3427],[3430,3439],[3450,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3571],[3585,3642],[3648,3662],[3664,3673],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807],3840,[3864,3865],[3872,3881],3893,3895,3897,[3902,3911],[3913,3948],[3953,3972],[3974,3991],[3993,4028],4038,[4096,4169],[4176,4253],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4959],[4969,4977],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5909],[5919,5940],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6099],6103,[6108,6109],[6112,6121],[6155,6157],[6159,6169],[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6459],[6470,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6656,6683],[6688,6750],[6752,6780],[6783,6793],[6800,6809],6823,[6832,6845],[6847,6862],[6912,6988],[6992,7001],[7019,7027],[7040,7155],[7168,7223],[7232,7241],[7245,7293],[7296,7304],[7312,7354],[7357,7359],[7376,7378],[7380,7418],[7424,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],[8255,8256],8276,8305,8319,[8336,8348],[8400,8412],8417,[8421,8432],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11507],[11520,11557],11559,11565,[11568,11623],11631,[11647,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11775],[12293,12295],[12321,12335],[12337,12341],[12344,12348],[12353,12438],[12441,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42539],[42560,42607],[42612,42621],[42623,42737],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43047],43052,[43072,43123],[43136,43205],[43216,43225],[43232,43255],43259,[43261,43309],[43312,43347],[43360,43388],[43392,43456],[43471,43481],[43488,43518],[43520,43574],[43584,43597],[43600,43609],[43616,43638],[43642,43714],[43739,43741],[43744,43759],[43762,43766],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44010],[44012,44013],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65024,65039],[65056,65071],[65075,65076],[65101,65103],[65136,65140],[65142,65276],[65296,65305],[65313,65338],65343,[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],66045,[66176,66204],[66208,66256],66272,[66304,66335],[66349,66378],[66384,66426],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],68159,[68192,68220],[68224,68252],[68288,68295],[68297,68326],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68903],[68912,68921],[69248,69289],[69291,69292],[69296,69297],[69373,69404],69415,[69424,69456],[69488,69509],[69552,69572],[69600,69622],[69632,69702],[69734,69749],[69759,69818],69826,[69840,69864],[69872,69881],[69888,69940],[69942,69951],[69956,69959],[69968,70003],70006,[70016,70084],[70089,70092],[70094,70106],70108,[70144,70161],[70163,70199],[70206,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70378],[70384,70393],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[70656,70730],[70736,70745],[70750,70753],[70784,70853],70855,[70864,70873],[71040,71093],[71096,71104],[71128,71133],[71168,71232],71236,[71248,71257],[71296,71352],[71360,71369],[71424,71450],[71453,71467],[71472,71481],[71488,71494],[71680,71738],[71840,71913],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72003],[72016,72025],[72096,72103],[72106,72151],[72154,72161],[72163,72164],[72192,72254],72263,[72272,72345],72349,[72368,72440],[72704,72712],[72714,72758],[72760,72768],[72784,72793],[72818,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129],[73440,73462],[73472,73488],[73490,73530],[73534,73538],[73552,73561],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78912,78933],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92784,92862],[92864,92873],[92880,92909],[92912,92916],[92928,92982],[92992,92995],[93008,93017],[93027,93047],[93053,93071],[93760,93823],[93952,94026],[94031,94087],[94095,94111],[94176,94177],[94179,94180],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[120782,120831],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123184,123197],[123200,123209],123214,[123536,123566],[123584,123641],[124112,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125136,125142],[125184,125259],[125264,125273],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],[917760,917999]],ice=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1488,1514],[1519,1522],[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3654],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6103,6108,[6176,6264],[6272,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],6823,[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[12293,12295],[12321,12329],[12337,12341],[12344,12348],[12353,12438],[12443,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42735],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43488,43492],[43494,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43741],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],oce=[[12294,12295],[12321,12329],[12344,12346],[13312,19903],[19968,40959],[63744,64109],[64112,64217],94180,[94208,100343],[100352,101589],[101632,101640],[110960,111355],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],ace=[[8204,8205]],sce=[[3648,3652],[3776,3780],[6581,6583],6586,[43701,43702],43705,[43707,43708]],uce=[[97,122],170,181,186,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,696],[704,705],[736,740],837,881,883,887,[890,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1376,1416],[4304,4346],[4348,4351],[5112,5117],[7296,7304],[7424,7615],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8305,8319,[8336,8348],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,[8560,8575],8580,[9424,9449],[11312,11359],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11389],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,[42651,42653],42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,[42863,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42927,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42963,42965,42967,42969,[42994,42996],42998,[43e3,43002],[43824,43866],[43868,43881],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],67456,[67459,67461],[67463,67504],[67506,67514],[68800,68850],[71872,71903],[93792,93823],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[122624,122633],[122635,122654],[122661,122666],[122928,122989],[125218,125251]],lce=[43,[60,62],94,124,126,172,177,215,247,[976,978],981,[1008,1009],[1012,1014],[1542,1544],8214,[8242,8244],8256,8260,8274,[8289,8292],[8314,8318],[8330,8334],[8400,8412],8417,[8421,8422],[8427,8431],8450,8455,[8458,8467],8469,[8472,8477],8484,[8488,8489],[8492,8493],[8495,8497],[8499,8504],[8508,8521],8523,[8592,8615],[8617,8622],[8624,8625],[8630,8631],[8636,8667],8669,[8676,8677],[8692,8959],[8968,8971],[8992,8993],9084,[9115,9141],9143,9168,[9180,9186],[9632,9633],[9646,9655],[9660,9665],[9670,9671],[9674,9675],[9679,9683],9698,9700,[9703,9708],[9720,9727],[9733,9734],9792,9794,[9824,9827],[9837,9839],[10176,10239],[10496,11007],[11056,11076],[11079,11084],64297,[65121,65126],65128,65291,[65308,65310],65340,65342,65372,65374,65506,[65513,65516],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705]],cce=[[64976,65007],[65534,65535],[131070,131071],[196606,196607],[262142,262143],[327678,327679],[393214,393215],[458750,458751],[524286,524287],[589822,589823],[655358,655359],[720894,720895],[786430,786431],[851966,851967],[917502,917503],[983038,983039],[1048574,1048575],[1114110,1114111]],dce=[837,[1456,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1623],[1625,1631],1648,[1750,1756],[1761,1764],[1767,1768],1773,1809,[1840,1855],[1958,1968],[2070,2071],[2075,2083],[2085,2087],[2089,2092],[2260,2271],[2275,2281],[2288,2307],[2362,2363],[2366,2380],[2382,2383],[2389,2391],[2402,2403],[2433,2435],[2494,2500],[2503,2504],[2507,2508],2519,[2530,2531],[2561,2563],[2622,2626],[2631,2632],[2635,2636],2641,[2672,2673],2677,[2689,2691],[2750,2757],[2759,2761],[2763,2764],[2786,2787],[2810,2812],[2817,2819],[2878,2884],[2887,2888],[2891,2892],[2902,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3020],3031,[3072,3076],[3134,3140],[3142,3144],[3146,3148],[3157,3158],[3170,3171],[3201,3203],[3262,3268],[3270,3272],[3274,3276],[3285,3286],[3298,3299],3315,[3328,3331],[3390,3396],[3398,3400],[3402,3404],3415,[3426,3427],[3457,3459],[3535,3540],3542,[3544,3551],[3570,3571],3633,[3636,3642],3661,3761,[3764,3769],[3771,3772],3789,[3953,3971],[3981,3991],[3993,4028],[4139,4150],4152,[4155,4158],[4182,4185],[4190,4192],[4194,4196],[4199,4205],[4209,4212],[4226,4237],4239,[4250,4253],[5906,5907],[5938,5939],[5970,5971],[6002,6003],[6070,6088],[6277,6278],6313,[6432,6443],[6448,6456],[6679,6683],[6741,6750],[6753,6772],[6847,6848],[6860,6862],[6912,6916],[6965,6979],[7040,7042],[7073,7081],[7084,7085],[7143,7153],[7204,7222],[7655,7668],[9398,9449],[11744,11775],[42612,42619],[42654,42655],43010,43019,[43043,43047],[43136,43137],[43188,43203],43205,43263,[43302,43306],[43335,43346],[43392,43395],[43444,43455],43493,[43561,43574],43587,[43596,43597],[43643,43645],43696,[43698,43700],[43703,43704],43710,[43755,43759],43765,[44003,44010],64286,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68900,68903],[69291,69292],[69632,69634],[69688,69701],[69747,69748],[69760,69762],[69808,69816],69826,[69888,69890],[69927,69938],[69957,69958],[70016,70018],[70067,70079],[70094,70095],[70188,70196],70199,70206,70209,[70367,70376],[70400,70403],[70462,70468],[70471,70472],[70475,70476],70487,[70498,70499],[70709,70721],[70723,70725],[70832,70849],[71087,71093],[71096,71102],[71132,71133],[71216,71230],71232,[71339,71349],[71453,71466],[71724,71736],[71984,71989],[71991,71992],[71995,71996],72e3,72002,[72145,72151],[72154,72159],72164,[72193,72202],[72245,72249],[72251,72254],[72273,72283],[72330,72343],[72751,72758],[72760,72766],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73025],73027,73031,[73098,73102],[73104,73105],[73107,73110],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73536],94031,[94033,94087],[94095,94098],[94192,94193],113822,[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,125255,[127280,127305],[127312,127337],[127344,127369]],mce=[847,[4447,4448],[6068,6069],8293,12644,65440,[65520,65528],917504,[917506,917535],[917632,917759],[918e3,921599]],fce=[2494,2519,2878,2903,3006,3031,3266,[3285,3286],3390,3415,3535,3551,6965,8204,[12334,12335],[65438,65439],70462,70487,70832,70845,71087,71984,119141,[119150,119154],[917536,917631]],hce=[183,903,[4969,4977],6618],pce=[[6277,6278],8472,8494,[12443,12444]],gce=[170,186,[688,696],[704,705],[736,740],837,890,4348,[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[8560,8575],[9424,9449],[11388,11389],[42652,42653],42864,[42994,42996],[43e3,43001],[43868,43871],43881,67456,[67459,67461],[67463,67504],[67506,67514],[122928,122989]],vce=[94,[976,978],981,[1008,1009],[1012,1013],8214,[8242,8244],8256,[8289,8292],[8317,8318],[8333,8334],[8400,8412],8417,[8421,8422],[8427,8431],8450,8455,[8458,8467],8469,[8473,8477],8484,[8488,8489],[8492,8493],[8495,8497],[8499,8504],[8508,8511],[8517,8521],[8597,8601],[8604,8607],[8609,8610],[8612,8613],8615,[8617,8621],[8624,8625],[8630,8631],[8636,8653],[8656,8657],8659,[8661,8667],8669,[8676,8677],[8968,8971],[9140,9141],9143,9168,9186,[9632,9633],[9646,9654],[9660,9664],[9670,9671],[9674,9675],[9679,9683],9698,9700,[9703,9708],[9733,9734],9792,9794,[9824,9827],[9837,9838],[10181,10182],[10214,10223],[10627,10648],[10712,10715],[10748,10749],65121,65123,65128,65340,65342,[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[120782,120831],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651]],bce=[[8544,8559],[9398,9423],[127280,127305],[127312,127337],[127344,127369]],_ce=[[33,47],[58,64],[91,94],96,[123,126],[161,167],169,[171,172],174,[176,177],182,187,191,215,247,[8208,8231],[8240,8254],[8257,8275],[8277,8286],[8592,9311],[9472,10101],[10132,11263],[11776,11903],[12289,12291],[12296,12320],12336,[64830,64831],[65093,65094]],Cce=[[9,13],32,133,[8206,8207],[8232,8233]],Sce=[[1536,1541],1757,1807,[2192,2193],2274,69821,69837],Ece=[34,39,171,187,[8216,8223],[8249,8250],11842,[12300,12303],[12317,12319],[65089,65092],65282,65287,[65378,65379]],yce=[[11904,11929],[11931,12019],[12032,12245]],Dce=[[127462,127487]],Rce=[33,46,63,1417,[1565,1567],1748,[1792,1794],2041,2103,2105,[2109,2110],[2404,2405],[4170,4171],4962,[4967,4968],5742,[5941,5942],6147,6153,[6468,6469],[6824,6827],[7002,7003],[7006,7007],[7037,7038],[7227,7228],[7294,7295],[8252,8253],[8263,8265],11822,11836,[11859,11860],12290,42239,[42510,42511],42739,42743,[43126,43127],[43214,43215],43311,[43464,43465],[43613,43615],[43760,43761],44011,65106,[65110,65111],65281,65294,65311,65377,[68182,68183],[69461,69465],[69510,69513],[69703,69704],[69822,69825],[69953,69955],[70085,70086],70093,[70110,70111],[70200,70201],[70203,70204],70313,[70731,70732],[71106,71107],[71113,71127],[71233,71234],[71484,71486],72004,72006,[72258,72259],[72347,72348],[72769,72770],[73463,73464],[73539,73540],[92782,92783],92917,[92983,92984],92996,93848,113823,121480],Ice=[[105,106],303,585,616,669,690,1011,1110,1112,7522,7574,7588,7592,7725,7883,8305,[8520,8521],11388,[119842,119843],[119894,119895],[119946,119947],[119998,119999],[120050,120051],[120102,120103],[120154,120155],[120206,120207],[120258,120259],[120310,120311],[120362,120363],[120414,120415],[120466,120467],122650,[122956,122957],122984],Ace=[33,44,46,[58,59],63,894,903,1417,1475,1548,1563,[1565,1567],1748,[1792,1802],1804,[2040,2041],[2096,2110],2142,[2404,2405],[3674,3675],3848,[3853,3858],[4170,4171],[4961,4968],5742,[5867,5869],[5941,5942],[6100,6102],6106,[6146,6149],[6152,6153],[6468,6469],[6824,6827],[7002,7003],[7005,7007],[7037,7038],[7227,7231],[7294,7295],[8252,8253],[8263,8265],11822,11836,11841,11852,[11854,11855],[11859,11860],[12289,12290],[42238,42239],[42509,42511],[42739,42743],[43126,43127],[43214,43215],43311,[43463,43465],[43613,43615],43743,[43760,43761],44011,[65104,65106],[65108,65111],65281,65292,65294,[65306,65307],65311,65377,65380,66463,66512,67671,67871,[68182,68183],[68336,68341],[68410,68415],[68505,68508],[69461,69465],[69510,69513],[69703,69709],[69822,69825],[69953,69955],[70085,70086],70093,[70110,70111],[70200,70204],70313,[70731,70733],[70746,70747],[71106,71109],[71113,71127],[71233,71234],[71484,71486],72004,72006,[72258,72259],[72347,72348],[72353,72354],[72769,72771],72817,[73463,73464],[73539,73540],[74864,74868],[92782,92783],92917,[92983,92985],92996,[93847,93848],113823,[121479,121482]],Tce=[[13312,19903],[19968,40959],[64014,64015],64017,[64019,64020],64031,64033,[64035,64036],[64039,64041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[196608,201546],[201552,205743]],wce=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,[8544,8559],8579,[9398,9423],[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217],[127280,127305],[127312,127337],[127344,127369]],Lce=[[6155,6157],6159,[65024,65039],[917760,917999]],Oce=[[9,13],32,133,160,5760,[8192,8202],[8232,8233],8239,8287,12288],Pce=[[48,57],[65,90],95,[97,122],170,181,183,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[768,884],[886,887],[891,893],895,[902,906],908,[910,929],[931,1013],[1015,1153],[1155,1159],[1162,1327],[1329,1366],1369,[1376,1416],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1488,1514],[1519,1522],[1552,1562],[1568,1641],[1646,1747],[1749,1756],[1759,1768],[1770,1788],1791,[1808,1866],[1869,1969],[1984,2037],2042,2045,[2048,2093],[2112,2139],[2144,2154],[2160,2183],[2185,2190],[2200,2273],[2275,2403],[2406,2415],[2417,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2545],2556,2558,[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2677],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2799],[2809,2815],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2927],2929,[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3055],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3200,3203],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3406],[3412,3415],[3423,3427],[3430,3439],[3450,3455],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3571],[3585,3642],[3648,3662],[3664,3673],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807],3840,[3864,3865],[3872,3881],3893,3895,3897,[3902,3911],[3913,3948],[3953,3972],[3974,3991],[3993,4028],4038,[4096,4169],[4176,4253],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4959],[4969,4977],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5909],[5919,5940],[5952,5971],[5984,5996],[5998,6e3],[6002,6003],[6016,6099],6103,[6108,6109],[6112,6121],[6155,6157],[6159,6169],[6176,6264],[6272,6314],[6320,6389],[6400,6430],[6432,6443],[6448,6459],[6470,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6656,6683],[6688,6750],[6752,6780],[6783,6793],[6800,6809],6823,[6832,6845],[6847,6862],[6912,6988],[6992,7001],[7019,7027],[7040,7155],[7168,7223],[7232,7241],[7245,7293],[7296,7304],[7312,7354],[7357,7359],[7376,7378],[7380,7418],[7424,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],[8255,8256],8276,8305,8319,[8336,8348],[8400,8412],8417,[8421,8432],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11507],[11520,11557],11559,11565,[11568,11623],11631,[11647,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[11744,11775],[12293,12295],[12321,12335],[12337,12341],[12344,12348],[12353,12438],[12441,12442],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42539],[42560,42607],[42612,42621],[42623,42737],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43047],43052,[43072,43123],[43136,43205],[43216,43225],[43232,43255],43259,[43261,43309],[43312,43347],[43360,43388],[43392,43456],[43471,43481],[43488,43518],[43520,43574],[43584,43597],[43600,43609],[43616,43638],[43642,43714],[43739,43741],[43744,43759],[43762,43766],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44010],[44012,44013],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],[64285,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64605],[64612,64829],[64848,64911],[64914,64967],[65008,65017],[65024,65039],[65056,65071],[65075,65076],[65101,65103],65137,65139,65143,65145,65147,65149,[65151,65276],[65296,65305],[65313,65338],65343,[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],66045,[66176,66204],[66208,66256],66272,[66304,66335],[66349,66378],[66384,66426],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],68159,[68192,68220],[68224,68252],[68288,68295],[68297,68326],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68903],[68912,68921],[69248,69289],[69291,69292],[69296,69297],[69373,69404],69415,[69424,69456],[69488,69509],[69552,69572],[69600,69622],[69632,69702],[69734,69749],[69759,69818],69826,[69840,69864],[69872,69881],[69888,69940],[69942,69951],[69956,69959],[69968,70003],70006,[70016,70084],[70089,70092],[70094,70106],70108,[70144,70161],[70163,70199],[70206,70209],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70378],[70384,70393],[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[70656,70730],[70736,70745],[70750,70753],[70784,70853],70855,[70864,70873],[71040,71093],[71096,71104],[71128,71133],[71168,71232],71236,[71248,71257],[71296,71352],[71360,71369],[71424,71450],[71453,71467],[71472,71481],[71488,71494],[71680,71738],[71840,71913],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72003],[72016,72025],[72096,72103],[72106,72151],[72154,72161],[72163,72164],[72192,72254],72263,[72272,72345],72349,[72368,72440],[72704,72712],[72714,72758],[72760,72768],[72784,72793],[72818,72847],[72850,72871],[72873,72886],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129],[73440,73462],[73472,73488],[73490,73530],[73534,73538],[73552,73561],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78912,78933],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92784,92862],[92864,92873],[92880,92909],[92912,92916],[92928,92982],[92992,92995],[93008,93017],[93027,93047],[93053,93071],[93760,93823],[93952,94026],[94031,94087],[94095,94111],[94176,94177],[94179,94180],[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[120782,120831],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122624,122654],[122661,122666],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[122928,122989],123023,[123136,123180],[123184,123197],[123200,123209],123214,[123536,123566],[123584,123641],[124112,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125136,125142],[125184,125259],[125264,125273],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[130032,130041],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],[917760,917999]],Mce=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[880,884],[886,887],[891,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1488,1514],[1519,1522],[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],3634,[3648,3654],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],3762,3773,[3776,3780],3782,[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6103,6108,[6176,6264],[6272,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],6823,[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8472,8477],8484,8486,8488,[8490,8505],[8508,8511],[8517,8521],8526,[8544,8584],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[12293,12295],[12321,12329],[12337,12341],[12344,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42735],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43488,43492],[43494,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43741],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64605],[64612,64829],[64848,64911],[64914,64967],[65008,65017],65137,65139,65143,65145,65147,65149,[65151,65276],[65313,65338],[65345,65370],[65382,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],Nce=Object.freeze(Object.defineProperty({__proto__:null,ASCII:ble,ASCII_Hex_Digit:_le,Alphabetic:Cle,Any:Sle,Assigned:Ele,Bidi_Control:yle,Bidi_Mirrored:Dle,Case_Ignorable:Rle,Cased:Ile,Changes_When_Casefolded:Ale,Changes_When_Casemapped:Tle,Changes_When_Lowercased:wle,Changes_When_NFKC_Casefolded:Lle,Changes_When_Titlecased:Ole,Changes_When_Uppercased:Ple,Composition_Exclusion:Mle,Dash:Nle,Default_Ignorable_Code_Point:xle,Deprecated:Fle,Diacritic:$le,Emoji:kle,Emoji_Component:Ble,Emoji_Modifier:Ule,Emoji_Modifier_Base:Vle,Emoji_Presentation:Hle,Expands_On_NFC:jle,Expands_On_NFD:zle,Expands_On_NFKC:Wle,Expands_On_NFKD:Yle,Extended_Pictographic:Xle,Extender:qle,Full_Composition_Exclusion:Gle,Grapheme_Base:Kle,Grapheme_Extend:Zle,Grapheme_Link:Qle,Hex_Digit:Jle,Hyphen:ece,IDS_Binary_Operator:tce,IDS_Trinary_Operator:nce,ID_Continue:rce,ID_Start:ice,Ideographic:oce,Join_Control:ace,Logical_Order_Exception:sce,Lowercase:uce,Math:lce,Noncharacter_Code_Point:cce,Other_Alphabetic:dce,Other_Default_Ignorable_Code_Point:mce,Other_Grapheme_Extend:fce,Other_ID_Continue:hce,Other_ID_Start:pce,Other_Lowercase:gce,Other_Math:vce,Other_Uppercase:bce,Pattern_Syntax:_ce,Pattern_White_Space:Cce,Prepended_Concatenation_Mark:Sce,Quotation_Mark:Ece,Radical:yce,Regional_Indicator:Dce,Sentence_Terminal:Rce,Soft_Dotted:Ice,Terminal_Punctuation:Ace,Unified_Ideograph:Tce,Uppercase:wce,Variation_Selector:Lce,White_Space:Oce,XID_Continue:Pce,XID_Start:Mce},Symbol.toStringTag,{value:"Module"})),xce=[[65,90],[97,122],181,[192,214],[216,246],[248,442],[444,447],[452,659],[661,687],[880,883],[886,887],[891,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],[1376,1416],[4256,4293],4295,4301,[4304,4346],[4349,4351],[5024,5109],[5112,5117],[7296,7304],[7312,7354],[7357,7359],[7424,7467],[7531,7543],[7545,7578],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8500],8505,[8508,8511],[8517,8521],8526,[8579,8580],[11264,11387],[11390,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[42560,42605],[42624,42651],[42786,42863],[42865,42887],[42891,42894],[42896,42954],[42960,42961],42963,[42965,42969],[42997,42998],43002,[43824,43866],[43872,43880],[43888,43967],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[66560,66639],[66736,66771],[66776,66811],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68736,68786],[68800,68850],[71840,71903],[93760,93823],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122633],[122635,122654],[122661,122666],[125184,125251]],Fce=[41,93,125,3899,3901,5788,8262,8318,8334,8969,8971,9002,10089,10091,10093,10095,10097,10099,10101,10182,10215,10217,10219,10221,10223,10628,10630,10632,10634,10636,10638,10640,10642,10644,10646,10648,10713,10715,10749,11811,11813,11815,11817,11862,11864,11866,11868,12297,12299,12301,12303,12305,12309,12311,12313,12315,[12318,12319],64830,65048,65078,65080,65082,65084,65086,65088,65090,65092,65096,65114,65116,65118,65289,65341,65373,65376,65379],$ce=[95,[8255,8256],8276,[65075,65076],[65101,65103],65343],kce=[[0,31],[127,159]],Bce=[36,[162,165],1423,1547,[2046,2047],[2546,2547],2555,2801,3065,3647,6107,[8352,8384],43064,65020,65129,65284,[65504,65505],[65509,65510],[73693,73696],123647,126128],Uce=[45,1418,1470,5120,6150,[8208,8213],11799,11802,[11834,11835],11840,11869,12316,12336,12448,[65073,65074],65112,65123,65293,69293],Vce=[[48,57],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[68912,68921],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72016,72025],[72784,72793],[73040,73049],[73120,73129],[73552,73561],[92768,92777],[92864,92873],[93008,93017],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125264,125273],[130032,130041]],Hce=[[1160,1161],6846,[8413,8416],[8418,8420],[42608,42610]],jce=[187,8217,8221,8250,11779,11781,11786,11789,11805,11809],zce=[173,[1536,1541],1564,1757,1807,[2192,2193],2274,6158,[8203,8207],[8234,8238],[8288,8292],[8294,8303],65279,[65529,65531],69821,69837,[78896,78911],[113824,113827],[119155,119162],917505,[917536,917631]],Wce=[171,8216,[8219,8220],8223,8249,11778,11780,11785,11788,11804,11808],Yce=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,705],[710,721],[736,740],748,750,[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],1369,[1376,1416],[1488,1514],[1519,1522],[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3654],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6103,6108,[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],6823,[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],8526,[8579,8580],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],11823,[12293,12294],[12337,12341],[12347,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42725],[42775,42783],[42786,42888],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43488,43492],[43494,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43741],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43866],[43868,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],[64256,64262],[64275,64279],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],Xce=[[5870,5872],[8544,8578],[8581,8584],12295,[12321,12329],[12344,12346],[42726,42735],[65856,65908],66369,66378,[66513,66517],[74752,74862]],qce=[8232],Gce=[[97,122],181,[223,246],[248,255],257,259,261,263,265,267,269,271,273,275,277,279,281,283,285,287,289,291,293,295,297,299,301,303,305,307,309,[311,312],314,316,318,320,322,324,326,[328,329],331,333,335,337,339,341,343,345,347,349,351,353,355,357,359,361,363,365,367,369,371,373,375,378,380,[382,384],387,389,392,[396,397],402,405,[409,411],414,417,419,421,424,[426,427],429,432,436,438,[441,442],[445,447],454,457,460,462,464,466,468,470,472,474,[476,477],479,481,483,485,487,489,491,493,[495,496],499,501,505,507,509,511,513,515,517,519,521,523,525,527,529,531,533,535,537,539,541,543,545,547,549,551,553,555,557,559,561,[563,569],572,[575,576],578,583,585,587,589,[591,659],[661,687],881,883,887,[891,893],912,[940,974],[976,977],[981,983],985,987,989,991,993,995,997,999,1001,1003,1005,[1007,1011],1013,1016,[1019,1020],[1072,1119],1121,1123,1125,1127,1129,1131,1133,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1163,1165,1167,1169,1171,1173,1175,1177,1179,1181,1183,1185,1187,1189,1191,1193,1195,1197,1199,1201,1203,1205,1207,1209,1211,1213,1215,1218,1220,1222,1224,1226,1228,[1230,1231],1233,1235,1237,1239,1241,1243,1245,1247,1249,1251,1253,1255,1257,1259,1261,1263,1265,1267,1269,1271,1273,1275,1277,1279,1281,1283,1285,1287,1289,1291,1293,1295,1297,1299,1301,1303,1305,1307,1309,1311,1313,1315,1317,1319,1321,1323,1325,1327,[1376,1416],[4304,4346],[4349,4351],[5112,5117],[7296,7304],[7424,7467],[7531,7543],[7545,7578],7681,7683,7685,7687,7689,7691,7693,7695,7697,7699,7701,7703,7705,7707,7709,7711,7713,7715,7717,7719,7721,7723,7725,7727,7729,7731,7733,7735,7737,7739,7741,7743,7745,7747,7749,7751,7753,7755,7757,7759,7761,7763,7765,7767,7769,7771,7773,7775,7777,7779,7781,7783,7785,7787,7789,7791,7793,7795,7797,7799,7801,7803,7805,7807,7809,7811,7813,7815,7817,7819,7821,7823,7825,7827,[7829,7837],7839,7841,7843,7845,7847,7849,7851,7853,7855,7857,7859,7861,7863,7865,7867,7869,7871,7873,7875,7877,7879,7881,7883,7885,7887,7889,7891,7893,7895,7897,7899,7901,7903,7905,7907,7909,7911,7913,7915,7917,7919,7921,7923,7925,7927,7929,7931,7933,[7935,7943],[7952,7957],[7968,7975],[7984,7991],[8e3,8005],[8016,8023],[8032,8039],[8048,8061],[8064,8071],[8080,8087],[8096,8103],[8112,8116],[8118,8119],8126,[8130,8132],[8134,8135],[8144,8147],[8150,8151],[8160,8167],[8178,8180],[8182,8183],8458,[8462,8463],8467,8495,8500,8505,[8508,8509],[8518,8521],8526,8580,[11312,11359],11361,[11365,11366],11368,11370,11372,11377,[11379,11380],[11382,11387],11393,11395,11397,11399,11401,11403,11405,11407,11409,11411,11413,11415,11417,11419,11421,11423,11425,11427,11429,11431,11433,11435,11437,11439,11441,11443,11445,11447,11449,11451,11453,11455,11457,11459,11461,11463,11465,11467,11469,11471,11473,11475,11477,11479,11481,11483,11485,11487,11489,[11491,11492],11500,11502,11507,[11520,11557],11559,11565,42561,42563,42565,42567,42569,42571,42573,42575,42577,42579,42581,42583,42585,42587,42589,42591,42593,42595,42597,42599,42601,42603,42605,42625,42627,42629,42631,42633,42635,42637,42639,42641,42643,42645,42647,42649,42651,42787,42789,42791,42793,42795,42797,[42799,42801],42803,42805,42807,42809,42811,42813,42815,42817,42819,42821,42823,42825,42827,42829,42831,42833,42835,42837,42839,42841,42843,42845,42847,42849,42851,42853,42855,42857,42859,42861,42863,[42865,42872],42874,42876,42879,42881,42883,42885,42887,42892,42894,42897,[42899,42901],42903,42905,42907,42909,42911,42913,42915,42917,42919,42921,42927,42933,42935,42937,42939,42941,42943,42945,42947,42952,42954,42961,42963,42965,42967,42969,42998,43002,[43824,43866],[43872,43880],[43888,43967],[64256,64262],[64275,64279],[65345,65370],[66600,66639],[66776,66811],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[68800,68850],[71872,71903],[93792,93823],[119834,119859],[119886,119892],[119894,119911],[119938,119963],[119990,119993],119995,[119997,120003],[120005,120015],[120042,120067],[120094,120119],[120146,120171],[120198,120223],[120250,120275],[120302,120327],[120354,120379],[120406,120431],[120458,120485],[120514,120538],[120540,120545],[120572,120596],[120598,120603],[120630,120654],[120656,120661],[120688,120712],[120714,120719],[120746,120770],[120772,120777],120779,[122624,122633],[122635,122654],[122661,122666],[125218,125251]],Kce=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2307],[2362,2364],[2366,2383],[2385,2391],[2402,2403],[2433,2435],2492,[2494,2500],[2503,2504],[2507,2509],2519,[2530,2531],2558,[2561,2563],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2691],2748,[2750,2757],[2759,2761],[2763,2765],[2786,2787],[2810,2815],[2817,2819],2876,[2878,2884],[2887,2888],[2891,2893],[2901,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3021],3031,[3072,3076],3132,[3134,3140],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3203],3260,[3262,3268],[3270,3272],[3274,3277],[3285,3286],[3298,3299],3315,[3328,3331],[3387,3388],[3390,3396],[3398,3400],[3402,3405],3415,[3426,3427],[3457,3459],3530,[3535,3540],3542,[3544,3551],[3570,3571],3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3902,3903],[3953,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4139,4158],[4182,4185],[4190,4192],[4194,4196],[4199,4205],[4209,4212],[4226,4237],4239,[4250,4253],[4957,4959],[5906,5909],[5938,5940],[5970,5971],[6002,6003],[6068,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6443],[6448,6459],[6679,6683],[6741,6750],[6752,6780],6783,[6832,6862],[6912,6916],[6964,6980],[7019,7027],[7040,7042],[7073,7085],[7142,7155],[7204,7223],[7376,7378],[7380,7400],7405,7412,[7415,7417],[7616,7679],[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43043,43047],43052,[43136,43137],[43188,43205],[43232,43249],43263,[43302,43309],[43335,43347],[43392,43395],[43443,43456],43493,[43561,43574],43587,[43596,43597],[43643,43645],43696,[43698,43700],[43703,43704],[43710,43711],43713,[43755,43759],[43765,43766],[44003,44010],[44012,44013],64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],[69632,69634],[69688,69702],69744,[69747,69748],[69759,69762],[69808,69818],69826,[69888,69890],[69927,69940],[69957,69958],70003,[70016,70018],[70067,70080],[70089,70092],[70094,70095],[70188,70199],70206,70209,[70367,70378],[70400,70403],[70459,70460],[70462,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70502,70508],[70512,70516],[70709,70726],70750,[70832,70851],[71087,71093],[71096,71104],[71132,71133],[71216,71232],[71339,71351],[71453,71467],[71724,71738],[71984,71989],[71991,71992],[71995,71998],72e3,[72002,72003],[72145,72151],[72154,72160],72164,[72193,72202],[72243,72249],[72251,72254],72263,[72273,72283],[72330,72345],[72751,72758],[72760,72767],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73098,73102],[73104,73105],[73107,73111],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73538],78912,[78919,78933],[92912,92916],[92976,92982],94031,[94033,94087],[94095,94098],94180,[94192,94193],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917760,917999]],Zce=[43,[60,62],124,126,172,177,215,247,1014,[1542,1544],8260,8274,[8314,8316],[8330,8332],8472,[8512,8516],8523,[8592,8596],[8602,8603],8608,8611,8614,8622,[8654,8655],8658,8660,[8692,8959],[8992,8993],9084,[9115,9139],[9180,9185],9655,9665,[9720,9727],9839,[10176,10180],[10183,10213],[10224,10239],[10496,10626],[10649,10711],[10716,10747],[10750,11007],[11056,11076],[11079,11084],64297,65122,[65124,65126],65291,[65308,65310],65372,65374,65506,[65513,65516],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771,[126704,126705]],Qce=[[688,705],[710,721],[736,740],748,750,884,890,1369,1600,[1765,1766],[2036,2037],2042,2074,2084,2088,2249,2417,3654,3782,4348,6103,6211,6823,[7288,7293],[7468,7530],7544,[7579,7615],8305,8319,[8336,8348],[11388,11389],11631,11823,12293,[12337,12341],12347,[12445,12446],[12540,12542],40981,[42232,42237],42508,42623,[42652,42653],[42775,42783],42864,42888,[42994,42996],[43e3,43001],43471,43494,43632,43741,[43763,43764],[43868,43871],43881,65392,[65438,65439],[67456,67461],[67463,67504],[67506,67514],[92992,92995],[94099,94111],[94176,94177],94179,[110576,110579],[110581,110587],[110589,110590],[122928,122989],[123191,123197],124139,125259],Jce=[94,96,168,175,180,184,[706,709],[722,735],[741,747],749,[751,767],885,[900,901],2184,8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[12443,12444],[42752,42774],[42784,42785],[42889,42890],43867,[43882,43883],[64434,64450],65342,65344,65507,[127995,127999]],e2e=[[768,879],[1155,1159],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,[2901,2902],[2914,2915],2946,3008,3021,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,3263,3270,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3457,3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6845],[6847,6862],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],[8400,8412],8417,[8421,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],42607,[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69826,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],72767,[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,78912,[78919,78933],[92912,92916],[92976,92982],94031,[94095,94098],94180,[113821,113822],[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917760,917999]],t2e=[[48,57],[178,179],185,[188,190],[1632,1641],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2548,2553],[2662,2671],[2790,2799],[2918,2927],[2930,2935],[3046,3058],[3174,3183],[3192,3198],[3302,3311],[3416,3422],[3430,3448],[3558,3567],[3664,3673],[3792,3801],[3872,3891],[4160,4169],[4240,4249],[4969,4988],[5870,5872],[6112,6121],[6128,6137],[6160,6169],[6470,6479],[6608,6618],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],8304,[8308,8313],[8320,8329],[8528,8578],[8581,8585],[9312,9371],[9450,9471],[10102,10131],11517,12295,[12321,12329],[12344,12346],[12690,12693],[12832,12841],[12872,12879],[12881,12895],[12928,12937],[12977,12991],[42528,42537],[42726,42735],[43056,43061],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[65799,65843],[65856,65912],[65930,65931],[66273,66299],[66336,66339],66369,66378,[66513,66517],[66720,66729],[67672,67679],[67705,67711],[67751,67759],[67835,67839],[67862,67867],[68028,68029],[68032,68047],[68050,68095],[68160,68168],[68221,68222],[68253,68255],[68331,68335],[68440,68447],[68472,68479],[68521,68527],[68858,68863],[68912,68921],[69216,69246],[69405,69414],[69457,69460],[69573,69579],[69714,69743],[69872,69881],[69942,69951],[70096,70105],[70113,70132],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71483],[71904,71922],[72016,72025],[72784,72812],[73040,73049],[73120,73129],[73552,73561],[73664,73684],[74752,74862],[92768,92777],[92864,92873],[93008,93017],[93019,93025],[93824,93846],[119488,119507],[119520,119539],[119648,119672],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125127,125135],[125264,125273],[126065,126123],[126125,126127],[126129,126132],[126209,126253],[126255,126269],[127232,127244],[130032,130041]],n2e=[40,91,123,3898,3900,5787,8218,8222,8261,8317,8333,8968,8970,9001,10088,10090,10092,10094,10096,10098,10100,10181,10214,10216,10218,10220,10222,10627,10629,10631,10633,10635,10637,10639,10641,10643,10645,10647,10712,10714,10748,11810,11812,11814,11816,11842,11861,11863,11865,11867,12296,12298,12300,12302,12304,12308,12310,12312,12314,12317,64831,65047,65077,65079,65081,65083,65085,65087,65089,65091,65095,65113,65115,65117,65288,65339,65371,65375,65378],r2e=[[0,31],[127,159],173,[888,889],[896,899],907,909,930,1328,[1367,1368],[1419,1420],1424,[1480,1487],[1515,1518],[1525,1541],1564,1757,[1806,1807],[1867,1868],[1970,1983],[2043,2044],[2094,2095],2111,[2140,2141],2143,[2155,2159],[2191,2199],2274,2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2679,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2802,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],[2936,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3067,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3190],3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3408,3411],[3428,3429],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3573,3584],[3643,3646],[3676,3712],3715,3717,3723,3748,3750,[3774,3775],3781,3783,3791,[3802,3803],[3808,3839],3912,[3949,3952],3992,4029,4045,[4059,4095],4294,[4296,4300],[4302,4303],4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4989,4991],[5018,5023],[5110,5111],[5118,5119],[5789,5791],[5881,5887],[5910,5918],[5943,5951],[5972,5983],5997,6001,[6004,6015],[6110,6111],[6122,6127],[6138,6143],6158,[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6463],[6465,6467],[6510,6511],[6517,6527],[6572,6575],[6602,6607],[6619,6621],[6684,6685],6751,[6781,6782],[6794,6799],[6810,6815],[6830,6831],[6863,6911],[6989,6991],7039,[7156,7163],[7224,7226],[7242,7244],[7305,7311],[7355,7356],[7368,7375],[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8133,[8148,8149],8156,[8176,8177],8181,8191,[8203,8207],[8234,8238],[8288,8303],[8306,8307],8335,[8349,8351],[8385,8399],[8433,8447],[8588,8591],[9255,9279],[9291,9311],[11124,11125],11158,[11508,11512],11558,[11560,11564],[11566,11567],[11624,11630],[11633,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11870,11903],11930,[12020,12031],[12246,12271],[12284,12287],12352,[12439,12440],[12544,12548],12592,12687,[12772,12783],12831,[42125,42127],[42183,42191],[42540,42559],[42744,42751],[42955,42959],42962,42964,[42970,42993],[43053,43055],[43066,43071],[43128,43135],[43206,43213],[43226,43231],[43348,43358],[43389,43391],43470,[43482,43485],43519,[43575,43583],[43598,43599],[43610,43611],[43715,43738],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43884,43887],[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,63743],[64110,64111],[64218,64255],[64263,64274],[64280,64284],64311,64317,64319,64322,64325,[64451,64466],[64912,64913],[64968,64974],[64976,65007],[65050,65055],65107,65127,[65132,65135],65141,[65277,65280],[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65503],65511,[65519,65531],[65534,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65791],[65795,65798],[65844,65846],65935,[65949,65951],[65953,65999],[66046,66175],[66205,66207],[66257,66271],[66300,66303],[66340,66348],[66379,66383],[66427,66431],66462,[66500,66503],[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66926],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],67670,[67743,67750],[67760,67807],67827,[67830,67834],[67868,67870],[67898,67902],[67904,67967],[68024,68027],[68048,68049],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68169,68175],[68185,68191],[68256,68287],[68327,68330],[68343,68351],[68406,68408],[68438,68439],[68467,68471],[68498,68504],[68509,68520],[68528,68607],[68681,68735],[68787,68799],[68851,68857],[68904,68911],[68922,69215],69247,69290,[69294,69295],[69298,69372],[69416,69423],[69466,69487],[69514,69551],[69580,69599],[69623,69631],[69710,69713],[69750,69758],69821,[69827,69839],[69865,69871],[69882,69887],69941,[69960,69967],[70007,70015],70112,[70133,70143],70162,[70210,70271],70279,70281,70286,70302,[70314,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],70748,[70754,70783],[70856,70863],[70874,71039],[71094,71095],[71134,71167],[71237,71247],[71258,71263],[71277,71295],[71354,71359],[71370,71423],[71451,71452],[71468,71471],[71495,71679],[71740,71839],[71923,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72007,72015],[72026,72095],[72104,72105],[72152,72153],[72165,72191],[72264,72271],[72355,72367],[72441,72447],[72458,72703],72713,72759,[72774,72783],[72813,72815],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73465,73471],73489,[73531,73533],[73562,73647],[73649,73663],[73714,73726],[74650,74751],74863,[74869,74879],[75076,77711],[77811,77823],[78896,78911],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92781],92863,[92874,92879],[92910,92911],[92918,92927],[92998,93007],93018,93026,[93048,93052],[93072,93759],[93851,93951],[94027,94030],[94088,94094],[94112,94175],[94181,94191],[94194,94207],[100344,100351],[101590,101631],[101641,110575],110580,110588,110591,[110883,110897],[110899,110927],[110931,110932],[110934,110947],[110952,110959],[111356,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113819],[113824,118527],[118574,118575],[118599,118607],[118724,118783],[119030,119039],[119079,119080],[119155,119162],[119275,119295],[119366,119487],[119508,119519],[119540,119551],[119639,119647],[119673,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],[120780,120781],[121484,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123216,123535],[123567,123583],[123642,123646],[123648,124111],[124154,124895],124903,124908,124911,124927,[125125,125126],[125143,125183],[125260,125263],[125274,125277],[125280,126064],[126133,126208],[126270,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,126703],[126706,126975],[127020,127023],[127124,127135],[127151,127152],127168,127184,[127222,127231],[127406,127461],[127491,127503],[127548,127551],[127561,127567],[127570,127583],[127590,127743],[128728,128731],[128749,128751],[128765,128767],[128887,128890],[128986,128991],[129004,129007],[129009,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129199],[129202,129279],[129620,129631],[129646,129647],[129661,129663],[129673,129679],129726,[129734,129741],[129756,129759],[129769,129775],[129785,129791],129939,[129995,130031],[130042,131071],[173792,173823],[177978,177983],[178206,178207],[183970,183983],[191457,194559],[195102,196607],[201547,201551],[205744,917759],[918e3,1114111]],i2e=[170,186,443,[448,451],660,[1488,1514],[1519,1522],[1568,1599],[1601,1610],[1646,1647],[1649,1747],1749,[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2048,2069],[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2248],[2308,2361],2365,2384,[2392,2401],[2418,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3585,3632],[3634,3635],[3648,3653],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],[3804,3807],3840,[3904,3911],[3913,3948],[3976,3980],[4096,4138],4159,[4176,4181],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4352,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5873,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6108,[6176,6210],[6212,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6480,6509],[6512,6516],[6528,6571],[6576,6601],[6656,6678],[6688,6740],[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7287],[7401,7404],[7406,7411],[7413,7414],7418,[8501,8504],[11568,11623],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],12294,12348,[12353,12438],12447,[12449,12538],12543,[12549,12591],[12593,12686],[12704,12735],[12784,12799],[13312,19903],[19968,40980],[40982,42124],[42192,42231],[42240,42507],[42512,42527],[42538,42539],42606,[42656,42725],42895,42999,[43003,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],[43488,43492],[43495,43503],[43514,43518],[43520,43560],[43584,43586],[43588,43595],[43616,43631],[43633,43638],43642,[43646,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43740],[43744,43754],43762,[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43968,44002],[44032,55203],[55216,55238],[55243,55291],[63744,64109],[64112,64217],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65382,65391],[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[66176,66204],[66208,66256],[66304,66335],[66349,66368],[66370,66377],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66640,66717],[66816,66855],[66864,66915],[67072,67382],[67392,67413],[67424,67431],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71424,71450],[71488,71494],[71680,71723],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[93027,93047],[93053,93071],[93952,94026],94032,[94208,100343],[100352,101589],[101632,101640],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],122634,[123136,123180],123214,[123536,123565],[123584,123627],[124112,124138],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],o2e=[[178,179],185,[188,190],[2548,2553],[2930,2935],[3056,3058],[3192,3198],[3416,3422],[3440,3448],[3882,3891],[4969,4988],[6128,6137],6618,8304,[8308,8313],[8320,8329],[8528,8543],8585,[9312,9371],[9450,9471],[10102,10131],11517,[12690,12693],[12832,12841],[12872,12879],[12881,12895],[12928,12937],[12977,12991],[43056,43061],[65799,65843],[65909,65912],[65930,65931],[66273,66299],[66336,66339],[67672,67679],[67705,67711],[67751,67759],[67835,67839],[67862,67867],[68028,68029],[68032,68047],[68050,68095],[68160,68168],[68221,68222],[68253,68255],[68331,68335],[68440,68447],[68472,68479],[68521,68527],[68858,68863],[69216,69246],[69405,69414],[69457,69460],[69573,69579],[69714,69733],[70113,70132],[71482,71483],[71914,71922],[72794,72812],[73664,73684],[93019,93025],[93824,93846],[119488,119507],[119520,119539],[119648,119672],[125127,125135],[126065,126123],[126125,126127],[126129,126132],[126209,126253],[126255,126269],[127232,127244]],a2e=[[33,35],[37,39],42,44,[46,47],[58,59],[63,64],92,161,167,[182,183],191,894,903,[1370,1375],1417,1472,1475,1478,[1523,1524],[1545,1546],[1548,1549],1563,[1565,1567],[1642,1645],1748,[1792,1805],[2039,2041],[2096,2110],2142,[2404,2405],2416,2557,2678,2800,3191,3204,3572,3663,[3674,3675],[3844,3858],3860,3973,[4048,4052],[4057,4058],[4170,4175],4347,[4960,4968],5742,[5867,5869],[5941,5942],[6100,6102],[6104,6106],[6144,6149],[6151,6154],[6468,6469],[6686,6687],[6816,6822],[6824,6829],[7002,7008],[7037,7038],[7164,7167],[7227,7231],[7294,7295],[7360,7367],7379,[8214,8215],[8224,8231],[8240,8248],[8251,8254],[8257,8259],[8263,8273],8275,[8277,8286],[11513,11516],[11518,11519],11632,[11776,11777],[11782,11784],11787,[11790,11798],[11800,11801],11803,[11806,11807],[11818,11822],[11824,11833],[11836,11839],11841,[11843,11855],[11858,11860],[12289,12291],12349,12539,[42238,42239],[42509,42511],42611,42622,[42738,42743],[43124,43127],[43214,43215],[43256,43258],43260,[43310,43311],43359,[43457,43469],[43486,43487],[43612,43615],[43742,43743],[43760,43761],44011,[65040,65046],65049,65072,[65093,65094],[65097,65100],[65104,65106],[65108,65111],[65119,65121],65128,[65130,65131],[65281,65283],[65285,65287],65290,65292,[65294,65295],[65306,65307],[65311,65312],65340,65377,[65380,65381],[65792,65794],66463,66512,66927,67671,67871,67903,[68176,68184],68223,[68336,68342],[68409,68415],[68505,68508],[69461,69465],[69510,69513],[69703,69709],[69819,69820],[69822,69825],[69952,69955],[70004,70005],[70085,70088],70093,70107,[70109,70111],[70200,70205],70313,[70731,70735],[70746,70747],70749,70854,[71105,71127],[71233,71235],[71264,71276],71353,[71484,71486],71739,[72004,72006],72162,[72255,72262],[72346,72348],[72350,72354],[72448,72457],[72769,72773],[72816,72817],[73463,73464],[73539,73551],73727,[74864,74868],[77809,77810],[92782,92783],92917,[92983,92987],92996,[93847,93850],94178,113823,[121479,121483],[125278,125279]],s2e=[166,169,174,176,1154,[1421,1422],[1550,1551],1758,1769,[1789,1790],2038,2554,2928,[3059,3064],3066,3199,3407,3449,[3841,3843],3859,[3861,3863],[3866,3871],3892,3894,3896,[4030,4037],[4039,4044],[4046,4047],[4053,4056],[4254,4255],[5008,5017],5741,6464,[6622,6655],[7009,7018],[7028,7036],[8448,8449],[8451,8454],[8456,8457],8468,[8470,8471],[8478,8483],8485,8487,8489,8494,[8506,8507],8522,[8524,8525],8527,[8586,8587],[8597,8601],[8604,8607],[8609,8610],[8612,8613],[8615,8621],[8623,8653],[8656,8657],8659,[8661,8691],[8960,8967],[8972,8991],[8994,9e3],[9003,9083],[9085,9114],[9140,9179],[9186,9254],[9280,9290],[9372,9449],[9472,9654],[9656,9664],[9666,9719],[9728,9838],[9840,10087],[10132,10175],[10240,10495],[11008,11055],[11077,11078],[11085,11123],[11126,11157],[11159,11263],[11493,11498],[11856,11857],[11904,11929],[11931,12019],[12032,12245],[12272,12283],12292,[12306,12307],12320,[12342,12343],[12350,12351],[12688,12689],[12694,12703],[12736,12771],[12800,12830],[12842,12871],12880,[12896,12927],[12938,12976],[12992,13311],[19904,19967],[42128,42182],[43048,43051],[43062,43063],43065,[43639,43641],[64832,64847],64975,[65021,65023],65508,65512,[65517,65518],[65532,65533],[65847,65855],[65913,65929],[65932,65934],[65936,65948],65952,[66e3,66044],[67703,67704],68296,71487,[73685,73692],[73697,73713],[92988,92991],92997,113820,[118608,118723],[118784,119029],[119040,119078],[119081,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119552,119638],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121478],123215,126124,126254,[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127245,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127994],[128e3,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994]],u2e=[8233],l2e=[[57344,63743],[983040,1048573],[1048576,1114109]],c2e=[[33,35],[37,42],[44,47],[58,59],[63,64],[91,93],95,123,125,161,167,171,[182,183],187,191,894,903,[1370,1375],[1417,1418],1470,1472,1475,1478,[1523,1524],[1545,1546],[1548,1549],1563,[1565,1567],[1642,1645],1748,[1792,1805],[2039,2041],[2096,2110],2142,[2404,2405],2416,2557,2678,2800,3191,3204,3572,3663,[3674,3675],[3844,3858],3860,[3898,3901],3973,[4048,4052],[4057,4058],[4170,4175],4347,[4960,4968],5120,5742,[5787,5788],[5867,5869],[5941,5942],[6100,6102],[6104,6106],[6144,6154],[6468,6469],[6686,6687],[6816,6822],[6824,6829],[7002,7008],[7037,7038],[7164,7167],[7227,7231],[7294,7295],[7360,7367],7379,[8208,8231],[8240,8259],[8261,8273],[8275,8286],[8317,8318],[8333,8334],[8968,8971],[9001,9002],[10088,10101],[10181,10182],[10214,10223],[10627,10648],[10712,10715],[10748,10749],[11513,11516],[11518,11519],11632,[11776,11822],[11824,11855],[11858,11869],[12289,12291],[12296,12305],[12308,12319],12336,12349,12448,12539,[42238,42239],[42509,42511],42611,42622,[42738,42743],[43124,43127],[43214,43215],[43256,43258],43260,[43310,43311],43359,[43457,43469],[43486,43487],[43612,43615],[43742,43743],[43760,43761],44011,[64830,64831],[65040,65049],[65072,65106],[65108,65121],65123,65128,[65130,65131],[65281,65283],[65285,65290],[65292,65295],[65306,65307],[65311,65312],[65339,65341],65343,65371,65373,[65375,65381],[65792,65794],66463,66512,66927,67671,67871,67903,[68176,68184],68223,[68336,68342],[68409,68415],[68505,68508],69293,[69461,69465],[69510,69513],[69703,69709],[69819,69820],[69822,69825],[69952,69955],[70004,70005],[70085,70088],70093,70107,[70109,70111],[70200,70205],70313,[70731,70735],[70746,70747],70749,70854,[71105,71127],[71233,71235],[71264,71276],71353,[71484,71486],71739,[72004,72006],72162,[72255,72262],[72346,72348],[72350,72354],[72448,72457],[72769,72773],[72816,72817],[73463,73464],[73539,73551],73727,[74864,74868],[77809,77810],[92782,92783],92917,[92983,92987],92996,[93847,93850],94178,113823,[121479,121483],[125278,125279]],d2e=[32,160,5760,[8192,8202],[8232,8233],8239,8287,12288],m2e=[32,160,5760,[8192,8202],8239,8287,12288],f2e=[2307,2363,[2366,2368],[2377,2380],[2382,2383],[2434,2435],[2494,2496],[2503,2504],[2507,2508],2519,2563,[2622,2624],2691,[2750,2752],2761,[2763,2764],[2818,2819],2878,2880,[2887,2888],[2891,2892],2903,[3006,3007],[3009,3010],[3014,3016],[3018,3020],3031,[3073,3075],[3137,3140],[3202,3203],3262,[3264,3268],[3271,3272],[3274,3275],[3285,3286],3315,[3330,3331],[3390,3392],[3398,3400],[3402,3404],3415,[3458,3459],[3535,3537],[3544,3551],[3570,3571],[3902,3903],3967,[4139,4140],4145,4152,[4155,4156],[4182,4183],[4194,4196],[4199,4205],[4227,4228],[4231,4236],4239,[4250,4252],5909,5940,6070,[6078,6085],[6087,6088],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6681,6682],6741,6743,6753,[6755,6756],[6765,6770],6916,6965,6971,[6973,6977],[6979,6980],7042,7073,[7078,7079],7082,7143,[7146,7148],7150,[7154,7155],[7204,7211],[7220,7221],7393,7415,[12334,12335],[43043,43044],43047,[43136,43137],[43188,43203],[43346,43347],43395,[43444,43445],[43450,43451],[43454,43456],[43567,43568],[43571,43572],43597,43643,43645,43755,[43758,43759],43765,[44003,44004],[44006,44007],[44009,44010],44012,69632,69634,69762,[69808,69810],[69815,69816],69932,[69957,69958],70018,[70067,70069],[70079,70080],70094,[70188,70190],[70194,70195],70197,[70368,70370],[70402,70403],[70462,70463],[70465,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70709,70711],[70720,70721],70725,[70832,70834],70841,[70843,70846],70849,[71087,71089],[71096,71099],71102,[71216,71218],[71227,71228],71230,71340,[71342,71343],71350,[71456,71457],71462,[71724,71726],71736,[71984,71989],[71991,71992],71997,72e3,72002,[72145,72147],[72156,72159],72164,72249,[72279,72280],72343,72751,72766,72873,72881,72884,[73098,73102],[73107,73108],73110,[73461,73462],73475,[73524,73525],[73534,73535],73537,[94033,94087],[94192,94193],[119141,119142],[119149,119154]],h2e=[[55296,57343]],p2e=[36,43,[60,62],94,96,124,126,[162,166],[168,169],172,[174,177],180,184,215,247,[706,709],[722,735],[741,747],749,[751,767],885,[900,901],1014,1154,[1421,1423],[1542,1544],1547,[1550,1551],1758,1769,[1789,1790],2038,[2046,2047],2184,[2546,2547],[2554,2555],2801,2928,[3059,3066],3199,3407,3449,3647,[3841,3843],3859,[3861,3863],[3866,3871],3892,3894,3896,[4030,4037],[4039,4044],[4046,4047],[4053,4056],[4254,4255],[5008,5017],5741,6107,6464,[6622,6655],[7009,7018],[7028,7036],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],8260,8274,[8314,8316],[8330,8332],[8352,8384],[8448,8449],[8451,8454],[8456,8457],8468,[8470,8472],[8478,8483],8485,8487,8489,8494,[8506,8507],[8512,8516],[8522,8525],8527,[8586,8587],[8592,8967],[8972,9e3],[9003,9254],[9280,9290],[9372,9449],[9472,10087],[10132,10180],[10183,10213],[10224,10626],[10649,10711],[10716,10747],[10750,11123],[11126,11157],[11159,11263],[11493,11498],[11856,11857],[11904,11929],[11931,12019],[12032,12245],[12272,12283],12292,[12306,12307],12320,[12342,12343],[12350,12351],[12443,12444],[12688,12689],[12694,12703],[12736,12771],[12800,12830],[12842,12871],12880,[12896,12927],[12938,12976],[12992,13311],[19904,19967],[42128,42182],[42752,42774],[42784,42785],[42889,42890],[43048,43051],[43062,43065],[43639,43641],43867,[43882,43883],64297,[64434,64450],[64832,64847],64975,[65020,65023],65122,[65124,65126],65129,65284,65291,[65308,65310],65342,65344,65372,65374,[65504,65510],[65512,65518],[65532,65533],[65847,65855],[65913,65929],[65932,65934],[65936,65948],65952,[66e3,66044],[67703,67704],68296,71487,[73685,73713],[92988,92991],92997,113820,[118608,118723],[118784,119029],[119040,119078],[119081,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119552,119638],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771,[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121478],123215,123647,126124,126128,126254,[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127245,127405],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994]],g2e=[453,456,459,498,[8072,8079],[8088,8095],[8104,8111],8124,8140,8188],v2e=[[888,889],[896,899],907,909,930,1328,[1367,1368],[1419,1420],1424,[1480,1487],[1515,1518],[1525,1535],1806,[1867,1868],[1970,1983],[2043,2044],[2094,2095],2111,[2140,2141],2143,[2155,2159],2191,[2194,2199],2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2679,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2802,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],[2936,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3067,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3190],3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3408,3411],[3428,3429],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3573,3584],[3643,3646],[3676,3712],3715,3717,3723,3748,3750,[3774,3775],3781,3783,3791,[3802,3803],[3808,3839],3912,[3949,3952],3992,4029,4045,[4059,4095],4294,[4296,4300],[4302,4303],4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4989,4991],[5018,5023],[5110,5111],[5118,5119],[5789,5791],[5881,5887],[5910,5918],[5943,5951],[5972,5983],5997,6001,[6004,6015],[6110,6111],[6122,6127],[6138,6143],[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6463],[6465,6467],[6510,6511],[6517,6527],[6572,6575],[6602,6607],[6619,6621],[6684,6685],6751,[6781,6782],[6794,6799],[6810,6815],[6830,6831],[6863,6911],[6989,6991],7039,[7156,7163],[7224,7226],[7242,7244],[7305,7311],[7355,7356],[7368,7375],[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8133,[8148,8149],8156,[8176,8177],8181,8191,8293,[8306,8307],8335,[8349,8351],[8385,8399],[8433,8447],[8588,8591],[9255,9279],[9291,9311],[11124,11125],11158,[11508,11512],11558,[11560,11564],[11566,11567],[11624,11630],[11633,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11870,11903],11930,[12020,12031],[12246,12271],[12284,12287],12352,[12439,12440],[12544,12548],12592,12687,[12772,12783],12831,[42125,42127],[42183,42191],[42540,42559],[42744,42751],[42955,42959],42962,42964,[42970,42993],[43053,43055],[43066,43071],[43128,43135],[43206,43213],[43226,43231],[43348,43358],[43389,43391],43470,[43482,43485],43519,[43575,43583],[43598,43599],[43610,43611],[43715,43738],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43884,43887],[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,55295],[64110,64111],[64218,64255],[64263,64274],[64280,64284],64311,64317,64319,64322,64325,[64451,64466],[64912,64913],[64968,64974],[64976,65007],[65050,65055],65107,65127,[65132,65135],65141,[65277,65278],65280,[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65503],65511,[65519,65528],[65534,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65791],[65795,65798],[65844,65846],65935,[65949,65951],[65953,65999],[66046,66175],[66205,66207],[66257,66271],[66300,66303],[66340,66348],[66379,66383],[66427,66431],66462,[66500,66503],[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66926],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],67670,[67743,67750],[67760,67807],67827,[67830,67834],[67868,67870],[67898,67902],[67904,67967],[68024,68027],[68048,68049],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68169,68175],[68185,68191],[68256,68287],[68327,68330],[68343,68351],[68406,68408],[68438,68439],[68467,68471],[68498,68504],[68509,68520],[68528,68607],[68681,68735],[68787,68799],[68851,68857],[68904,68911],[68922,69215],69247,69290,[69294,69295],[69298,69372],[69416,69423],[69466,69487],[69514,69551],[69580,69599],[69623,69631],[69710,69713],[69750,69758],[69827,69836],[69838,69839],[69865,69871],[69882,69887],69941,[69960,69967],[70007,70015],70112,[70133,70143],70162,[70210,70271],70279,70281,70286,70302,[70314,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],70748,[70754,70783],[70856,70863],[70874,71039],[71094,71095],[71134,71167],[71237,71247],[71258,71263],[71277,71295],[71354,71359],[71370,71423],[71451,71452],[71468,71471],[71495,71679],[71740,71839],[71923,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72007,72015],[72026,72095],[72104,72105],[72152,72153],[72165,72191],[72264,72271],[72355,72367],[72441,72447],[72458,72703],72713,72759,[72774,72783],[72813,72815],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73465,73471],73489,[73531,73533],[73562,73647],[73649,73663],[73714,73726],[74650,74751],74863,[74869,74879],[75076,77711],[77811,77823],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92781],92863,[92874,92879],[92910,92911],[92918,92927],[92998,93007],93018,93026,[93048,93052],[93072,93759],[93851,93951],[94027,94030],[94088,94094],[94112,94175],[94181,94191],[94194,94207],[100344,100351],[101590,101631],[101641,110575],110580,110588,110591,[110883,110897],[110899,110927],[110931,110932],[110934,110947],[110952,110959],[111356,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113819],[113828,118527],[118574,118575],[118599,118607],[118724,118783],[119030,119039],[119079,119080],[119275,119295],[119366,119487],[119508,119519],[119540,119551],[119639,119647],[119673,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],[120780,120781],[121484,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123216,123535],[123567,123583],[123642,123646],[123648,124111],[124154,124895],124903,124908,124911,124927,[125125,125126],[125143,125183],[125260,125263],[125274,125277],[125280,126064],[126133,126208],[126270,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,126703],[126706,126975],[127020,127023],[127124,127135],[127151,127152],127168,127184,[127222,127231],[127406,127461],[127491,127503],[127548,127551],[127561,127567],[127570,127583],[127590,127743],[128728,128731],[128749,128751],[128765,128767],[128887,128890],[128986,128991],[129004,129007],[129009,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129199],[129202,129279],[129620,129631],[129646,129647],[129661,129663],[129673,129679],129726,[129734,129741],[129756,129759],[129769,129775],[129785,129791],129939,[129995,130031],[130042,131071],[173792,173823],[177978,177983],[178206,178207],[183970,183983],[191457,194559],[195102,196607],[201547,201551],[205744,917504],[917506,917535],[917632,917759],[918e3,983039],[1048574,1048575],[1114110,1114111]],b2e=[[65,90],[192,214],[216,222],256,258,260,262,264,266,268,270,272,274,276,278,280,282,284,286,288,290,292,294,296,298,300,302,304,306,308,310,313,315,317,319,321,323,325,327,330,332,334,336,338,340,342,344,346,348,350,352,354,356,358,360,362,364,366,368,370,372,374,[376,377],379,381,[385,386],388,[390,391],[393,395],[398,401],[403,404],[406,408],[412,413],[415,416],418,420,[422,423],425,428,[430,431],[433,435],437,[439,440],444,452,455,458,461,463,465,467,469,471,473,475,478,480,482,484,486,488,490,492,494,497,500,[502,504],506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,[570,571],[573,574],577,[579,582],584,586,588,590,880,882,886,895,902,[904,906],908,[910,911],[913,929],[931,939],975,[978,980],984,986,988,990,992,994,996,998,1e3,1002,1004,1006,1012,1015,[1017,1018],[1021,1071],1120,1122,1124,1126,1128,1130,1132,1134,1136,1138,1140,1142,1144,1146,1148,1150,1152,1162,1164,1166,1168,1170,1172,1174,1176,1178,1180,1182,1184,1186,1188,1190,1192,1194,1196,1198,1200,1202,1204,1206,1208,1210,1212,1214,[1216,1217],1219,1221,1223,1225,1227,1229,1232,1234,1236,1238,1240,1242,1244,1246,1248,1250,1252,1254,1256,1258,1260,1262,1264,1266,1268,1270,1272,1274,1276,1278,1280,1282,1284,1286,1288,1290,1292,1294,1296,1298,1300,1302,1304,1306,1308,1310,1312,1314,1316,1318,1320,1322,1324,1326,[1329,1366],[4256,4293],4295,4301,[5024,5109],[7312,7354],[7357,7359],7680,7682,7684,7686,7688,7690,7692,7694,7696,7698,7700,7702,7704,7706,7708,7710,7712,7714,7716,7718,7720,7722,7724,7726,7728,7730,7732,7734,7736,7738,7740,7742,7744,7746,7748,7750,7752,7754,7756,7758,7760,7762,7764,7766,7768,7770,7772,7774,7776,7778,7780,7782,7784,7786,7788,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812,7814,7816,7818,7820,7822,7824,7826,7828,7838,7840,7842,7844,7846,7848,7850,7852,7854,7856,7858,7860,7862,7864,7866,7868,7870,7872,7874,7876,7878,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912,7914,7916,7918,7920,7922,7924,7926,7928,7930,7932,7934,[7944,7951],[7960,7965],[7976,7983],[7992,7999],[8008,8013],8025,8027,8029,8031,[8040,8047],[8120,8123],[8136,8139],[8152,8155],[8168,8172],[8184,8187],8450,8455,[8459,8461],[8464,8466],8469,[8473,8477],8484,8486,8488,[8490,8493],[8496,8499],[8510,8511],8517,8579,[11264,11311],11360,[11362,11364],11367,11369,11371,[11373,11376],11378,11381,[11390,11392],11394,11396,11398,11400,11402,11404,11406,11408,11410,11412,11414,11416,11418,11420,11422,11424,11426,11428,11430,11432,11434,11436,11438,11440,11442,11444,11446,11448,11450,11452,11454,11456,11458,11460,11462,11464,11466,11468,11470,11472,11474,11476,11478,11480,11482,11484,11486,11488,11490,11499,11501,11506,42560,42562,42564,42566,42568,42570,42572,42574,42576,42578,42580,42582,42584,42586,42588,42590,42592,42594,42596,42598,42600,42602,42604,42624,42626,42628,42630,42632,42634,42636,42638,42640,42642,42644,42646,42648,42650,42786,42788,42790,42792,42794,42796,42798,42802,42804,42806,42808,42810,42812,42814,42816,42818,42820,42822,42824,42826,42828,42830,42832,42834,42836,42838,42840,42842,42844,42846,42848,42850,42852,42854,42856,42858,42860,42862,42873,42875,[42877,42878],42880,42882,42884,42886,42891,42893,42896,42898,42902,42904,42906,42908,42910,42912,42914,42916,42918,42920,[42922,42926],[42928,42932],42934,42936,42938,42940,42942,42944,42946,[42948,42951],42953,42960,42966,42968,42997,[65313,65338],[66560,66599],[66736,66771],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[68736,68786],[71840,71871],[93760,93791],[119808,119833],[119860,119885],[119912,119937],119964,[119966,119967],119970,[119973,119974],[119977,119980],[119982,119989],[120016,120041],[120068,120069],[120071,120074],[120077,120084],[120086,120092],[120120,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120172,120197],[120224,120249],[120276,120301],[120328,120353],[120380,120405],[120432,120457],[120488,120512],[120546,120570],[120604,120628],[120662,120686],[120720,120744],120778,[125184,125217]],_2e=Object.freeze(Object.defineProperty({__proto__:null,Cased_Letter:xce,Close_Punctuation:Fce,Connector_Punctuation:$ce,Control:kce,Currency_Symbol:Bce,Dash_Punctuation:Uce,Decimal_Number:Vce,Enclosing_Mark:Hce,Final_Punctuation:jce,Format:zce,Initial_Punctuation:Wce,Letter:Yce,Letter_Number:Xce,Line_Separator:qce,Lowercase_Letter:Gce,Mark:Kce,Math_Symbol:Zce,Modifier_Letter:Qce,Modifier_Symbol:Jce,Nonspacing_Mark:e2e,Number:t2e,Open_Punctuation:n2e,Other:r2e,Other_Letter:i2e,Other_Number:o2e,Other_Punctuation:a2e,Other_Symbol:s2e,Paragraph_Separator:u2e,Private_Use:l2e,Punctuation:c2e,Separator:d2e,Space_Separator:m2e,Spacing_Mark:f2e,Surrogate:h2e,Symbol:p2e,Titlecase_Letter:g2e,Unassigned:v2e,Uppercase_Letter:b2e},Symbol.toStringTag,{value:"Module"})),C2e=[1544,1547,1549,[1563,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],1969,[2144,2154],[2160,2190],[2208,2249],[64336,64450],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[68864,68899],[69424,69445],[69457,69465],[126065,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651]],S2e=[[1536,1541],[1632,1641],[1643,1644],1757,[2192,2193],2274,[68912,68921],[69216,69246]],E2e=[[0,8],[14,27],[127,132],[134,159],173,6158,[8203,8205],[8288,8292],[8298,8303],65279,[113824,113827],[119155,119162],917505,[917536,917631]],y2e=[44,[46,47],58,160,1548,8239,8260,65104,65106,65109,65292,[65294,65295],65306],D2e=[[48,57],[178,179],185,[1776,1785],8304,[8308,8313],[8320,8329],[9352,9371],[65296,65305],[66273,66299],[120782,120831],[127232,127242],[130032,130041]],R2e=[43,45,[8314,8315],[8330,8331],8722,64297,[65122,65123],65291,65293],I2e=[[35,37],[162,165],[176,177],1423,[1545,1546],1642,[2546,2547],2555,2801,3065,3647,6107,[8240,8244],[8352,8384],8494,8723,[43064,43065],65119,[65129,65130],[65283,65285],[65504,65505],[65509,65510],[73693,73696],123647],A2e=[8296],T2e=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,696],[699,705],[720,721],[736,740],750,[880,883],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1154],[1162,1327],[1329,1366],[1369,1417],[2307,2361],2363,[2365,2368],[2377,2380],[2382,2384],[2392,2401],[2404,2432],[2434,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2493,2496],[2503,2504],[2507,2508],2510,2519,[2524,2525],[2527,2529],[2534,2545],[2548,2554],[2556,2557],2563,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2622,2624],[2649,2652],2654,[2662,2671],[2674,2676],2678,2691,[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2749,2752],2761,[2763,2764],2768,[2784,2785],[2790,2800],2809,[2818,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2877,2878],2880,[2887,2888],[2891,2892],2903,[2908,2909],[2911,2913],[2918,2935],2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3007],[3009,3010],[3014,3016],[3018,3020],3024,3031,[3046,3058],[3073,3075],[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3137,3140],[3160,3162],3165,[3168,3169],[3174,3183],3191,[3199,3200],[3202,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3261,3268],[3270,3272],[3274,3275],[3285,3286],[3293,3294],[3296,3297],[3302,3311],[3313,3315],[3330,3340],[3342,3344],[3346,3386],[3389,3392],[3398,3400],[3402,3404],[3406,3407],[3412,3425],[3430,3455],[3458,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],[3535,3537],[3544,3551],[3558,3567],[3570,3572],[3585,3632],[3634,3635],[3648,3654],[3663,3675],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3760],[3762,3763],3773,[3776,3780],3782,[3792,3801],[3804,3807],[3840,3863],[3866,3892],3894,3896,[3902,3911],[3913,3948],3967,3973,[3976,3980],[4030,4037],[4039,4044],[4046,4058],[4096,4140],4145,4152,[4155,4156],[4159,4183],[4186,4189],[4193,4208],[4213,4225],[4227,4228],[4231,4236],[4238,4252],[4254,4293],4295,4301,[4304,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4960,4988],[4992,5007],[5024,5109],[5112,5117],[5121,5759],[5761,5786],[5792,5880],[5888,5905],5909,[5919,5937],[5940,5942],[5952,5969],[5984,5996],[5998,6e3],[6016,6067],6070,[6078,6085],[6087,6088],[6100,6106],6108,[6112,6121],[6160,6169],[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6435,6438],[6441,6443],[6448,6449],[6451,6456],[6470,6509],[6512,6516],[6528,6571],[6576,6601],[6608,6618],[6656,6678],[6681,6682],[6686,6741],6743,6753,[6755,6756],[6765,6770],[6784,6793],[6800,6809],[6816,6829],[6916,6963],6965,6971,[6973,6977],[6979,6988],[6992,7018],[7028,7038],[7042,7073],[7078,7079],7082,[7086,7141],7143,[7146,7148],7150,[7154,7155],[7164,7211],[7220,7221],[7227,7241],[7245,7304],[7312,7354],[7357,7367],7379,7393,[7401,7404],[7406,7411],[7413,7415],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8206,8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],[8526,8527],[8544,8584],[9014,9082],9109,[9372,9449],9900,[10240,10495],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],[11631,11632],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[12293,12295],[12321,12329],[12334,12335],[12337,12341],[12344,12348],[12353,12438],[12445,12447],[12449,12538],[12540,12543],[12549,12591],[12593,12686],[12688,12735],[12784,12828],[12832,12879],[12896,12923],[12927,12976],[12992,13003],[13008,13174],[13179,13277],[13280,13310],[13312,19903],[19968,42124],[42192,42508],[42512,42539],[42560,42606],[42624,42653],[42656,42735],[42738,42743],[42786,42887],[42889,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43044],43047,[43056,43063],[43072,43123],[43136,43203],[43214,43225],[43250,43262],[43264,43301],[43310,43334],[43346,43347],[43359,43388],[43395,43442],[43444,43445],[43450,43451],[43454,43469],[43471,43481],[43486,43492],[43494,43518],[43520,43560],[43567,43568],[43571,43572],[43584,43586],[43588,43595],43597,[43600,43609],[43612,43643],[43645,43695],43697,[43701,43702],[43705,43709],43712,43714,[43739,43755],[43758,43765],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43881],[43888,44004],[44006,44007],[44009,44012],[44016,44025],[44032,55203],[55216,55238],[55243,55291],[55296,64109],[64112,64217],[64256,64262],[64275,64279],[65313,65338],[65345,65370],[65382,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],65792,65794,[65799,65843],[65847,65855],[65933,65934],[66e3,66044],[66176,66204],[66208,66256],[66304,66339],[66349,66378],[66384,66421],[66432,66461],[66463,66499],[66504,66517],[66560,66717],[66720,66729],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],69632,[69634,69687],[69703,69709],[69734,69743],[69745,69746],69749,[69762,69810],[69815,69816],[69819,69825],69837,[69840,69864],[69872,69881],[69891,69926],69932,[69942,69959],[69968,70002],[70004,70006],[70018,70069],[70079,70088],[70093,70094],[70096,70111],[70113,70132],[70144,70161],[70163,70190],[70194,70195],70197,[70200,70205],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313],[70320,70366],[70368,70370],[70384,70393],[70402,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70461,70463],[70465,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70656,70711],[70720,70721],70725,[70727,70747],70749,[70751,70753],[70784,70834],70841,[70843,70846],70849,[70852,70855],[70864,70873],[71040,71089],[71096,71099],71102,[71105,71131],[71168,71218],[71227,71228],71230,[71233,71236],[71248,71257],[71296,71338],71340,[71342,71343],71350,[71352,71353],[71360,71369],[71424,71450],[71456,71457],71462,[71472,71494],[71680,71726],71736,71739,[71840,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],71997,[71999,72002],[72004,72006],[72016,72025],[72096,72103],[72106,72147],[72156,72159],[72161,72164],72192,[72199,72200],[72203,72242],[72249,72250],[72255,72262],72272,[72279,72280],[72284,72329],72343,[72346,72354],[72368,72440],[72448,72457],[72704,72712],[72714,72751],[72766,72773],[72784,72812],[72816,72847],72873,72881,72884,[72960,72966],[72968,72969],[72971,73008],73030,[73040,73049],[73056,73061],[73063,73064],[73066,73102],[73107,73108],73110,73112,[73120,73129],[73440,73458],[73461,73464],[73474,73488],[73490,73525],[73534,73535],73537,[73539,73561],73648,[73664,73684],[73727,74649],[74752,74862],[74864,74868],[74880,75075],[77712,77810],[77824,78911],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92768,92777],[92782,92862],[92864,92873],[92880,92909],92917,[92928,92975],[92983,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071],[93760,93850],[93952,94026],[94032,94087],[94099,94111],[94176,94177],94179,[94192,94193],[94208,100343],[100352,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110882],110898,[110928,110930],110933,[110948,110951],[110960,111355],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113820,113823,[118608,118723],[118784,119029],[119040,119078],[119081,119142],[119146,119154],[119171,119172],[119180,119209],[119214,119272],[119488,119507],[119520,119539],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120538],[120540,120596],[120598,120654],[120656,120712],[120714,120770],[120772,120779],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121483],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],[123200,123209],[123214,123215],[123536,123565],[123584,123627],[123632,123641],[124112,124139],[124144,124153],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[127248,127278],[127280,127337],[127344,127404],[127462,127490],[127504,127547],[127552,127560],[127568,127569],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743],[983040,1048573],[1048576,1114109]],w2e=[8234],L2e=[8294],O2e=[8237],P2e=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2306],2362,2364,[2369,2376],2381,[2385,2391],[2402,2403],2433,2492,[2497,2500],2509,[2530,2531],2558,[2561,2562],2620,[2625,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2690],2748,[2753,2757],[2759,2760],2765,[2786,2787],[2810,2815],2817,2876,2879,[2881,2884],2893,[2901,2902],[2914,2915],2946,3008,3021,3072,3076,3132,[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],3201,3260,[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],3405,[3426,3427],3457,3530,[3538,3540],3542,3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],4226,[4229,4230],4237,4253,[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],6086,[6089,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6434],[6439,6440],6450,[6457,6459],[6679,6680],6683,6742,[6744,6750],6752,6754,[6757,6764],[6771,6780],6783,[6832,6862],[6912,6915],6964,[6966,6970],6972,6978,[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],7142,[7144,7145],7149,[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],[8400,8432],[11503,11505],11647,[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43045,43046],43052,[43204,43205],[43232,43249],43263,[43302,43309],[43335,43345],[43392,43394],43443,[43446,43449],[43452,43453],43493,[43561,43566],[43569,43570],[43573,43574],43587,43596,43644,43696,[43698,43700],[43703,43704],[43710,43711],43713,[43756,43757],43766,44005,44008,44013,64286,[65024,65039],[65056,65071],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],69633,[69688,69702],69744,[69747,69748],[69759,69761],[69811,69814],[69817,69818],69826,[69888,69890],[69927,69931],[69933,69940],70003,[70016,70017],[70070,70078],[70089,70092],70095,[70191,70193],70196,[70198,70199],70206,70209,70367,[70371,70378],[70400,70401],[70459,70460],70464,[70502,70508],[70512,70516],[70712,70719],[70722,70724],70726,70750,[70835,70840],70842,[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],71229,[71231,71232],71339,71341,[71344,71349],71351,[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[71995,71996],71998,72003,[72148,72151],[72154,72155],72160,[72193,72198],[72201,72202],[72243,72248],[72251,72254],72263,[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73104,73105],73109,73111,[73459,73460],[73472,73473],[73526,73530],73536,73538,78912,[78919,78933],[92912,92916],[92976,92982],94031,[94095,94098],94180,[113821,113822],[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917760,917999]],M2e=[[33,34],[38,42],[59,64],[91,96],[123,126],161,[166,169],[171,172],[174,175],180,[182,184],[187,191],215,247,[697,698],[706,719],[722,735],[741,749],[751,767],[884,885],894,[900,901],903,1014,1418,[1421,1422],[1542,1543],[1550,1551],1758,1769,[2038,2041],[3059,3064],3066,[3192,3198],[3898,3901],[5008,5017],5120,[5787,5788],[6128,6137],[6144,6154],6464,[6468,6469],[6622,6655],8125,[8127,8129],[8141,8143],[8157,8159],[8173,8175],[8189,8190],[8208,8231],[8245,8259],[8261,8286],[8316,8318],[8332,8334],[8448,8449],[8451,8454],[8456,8457],8468,[8470,8472],[8478,8483],8485,8487,8489,[8506,8507],[8512,8516],[8522,8525],[8528,8543],[8585,8587],[8592,8721],[8724,9013],[9083,9108],[9110,9254],[9280,9290],[9312,9351],[9450,9899],[9901,10239],[10496,11123],[11126,11157],[11159,11263],[11493,11498],[11513,11519],[11776,11869],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12289,12292],[12296,12320],12336,[12342,12343],[12349,12351],[12443,12444],12448,12539,[12736,12771],[12829,12830],[12880,12895],[12924,12926],[12977,12991],[13004,13007],[13175,13178],[13278,13279],13311,[19904,19967],[42128,42182],[42509,42511],42611,[42622,42623],[42752,42785],42888,[43048,43051],[43124,43127],[43882,43883],[64830,64847],64975,[65021,65023],[65040,65049],[65072,65103],65105,65108,[65110,65118],[65120,65121],[65124,65126],65128,65131,[65281,65282],[65286,65290],[65307,65312],[65339,65344],[65371,65381],[65506,65508],[65512,65518],[65529,65533],65793,[65856,65932],[65936,65948],65952,67871,[68409,68415],[69714,69733],[71264,71276],[73685,73692],[73697,73713],94178,[119273,119274],[119296,119361],119365,[119552,119638],120539,120597,120655,120713,120771,[126704,126705],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127243,127247],127279,[127338,127343],127405,[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994]],N2e=[10,13,[28,30],133,8233],x2e=[8236],F2e=[8297],$2e=[1470,1472,1475,1478,[1488,1514],[1519,1524],[1984,2026],[2036,2037],2042,[2046,2069],2074,2084,2088,[2096,2110],[2112,2136],2142,8207,64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67671,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67872,67897],67903,[67968,68023],[68028,68047],[68050,68096],[68112,68115],[68117,68119],[68121,68149],[68160,68168],[68176,68184],[68192,68255],[68288,68324],[68331,68342],[68352,68405],[68416,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68863],[69248,69289],69293,[69296,69297],[69376,69415],[69488,69505],[69510,69513],[69552,69579],[69600,69622],[124928,125124],[125127,125135],[125184,125251],125259,[125264,125273],[125278,125279]],k2e=[8235],B2e=[8295],U2e=[8238],V2e=[9,11,31],H2e=[12,32,5760,[8192,8202],8232,8287,12288],j2e=Object.freeze(Object.defineProperty({__proto__:null,Arabic_Letter:C2e,Arabic_Number:S2e,Boundary_Neutral:E2e,Common_Separator:y2e,European_Number:D2e,European_Separator:R2e,European_Terminator:I2e,First_Strong_Isolate:A2e,Left_To_Right:T2e,Left_To_Right_Embedding:w2e,Left_To_Right_Isolate:L2e,Left_To_Right_Override:O2e,Nonspacing_Mark:P2e,Other_Neutral:M2e,Paragraph_Separator:N2e,Pop_Directional_Format:x2e,Pop_Directional_Isolate:F2e,Right_To_Left:$2e,Right_To_Left_Embedding:k2e,Right_To_Left_Isolate:B2e,Right_To_Left_Override:U2e,Segment_Separator:V2e,White_Space:H2e},Symbol.toStringTag,{value:"Module"})),z2e=[[125184,125259],[125264,125273],[125278,125279]],W2e=[[71424,71450],[71453,71467],[71472,71494]],Y2e=[[82944,83526]],X2e=[[1536,1540],[1542,1547],[1549,1562],[1564,1566],[1568,1599],[1601,1610],[1622,1647],[1649,1756],[1758,1791],[1872,1919],[2160,2190],[2192,2193],[2200,2273],[2275,2303],[64336,64450],[64467,64829],[64832,64911],[64914,64967],64975,[65008,65023],[65136,65140],[65142,65276],[69216,69246],[69373,69375],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705]],q2e=[[1329,1366],[1369,1418],[1421,1423],[64275,64279]],G2e=[[68352,68405],[68409,68415]],K2e=[[6912,6988],[6992,7038]],Z2e=[[42656,42743],[92160,92728]],Q2e=[[92880,92909],[92912,92917]],J2e=[[7104,7155],[7164,7167]],e0e=[[2432,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2558]],t0e=[[72704,72712],[72714,72758],[72760,72773],[72784,72812]],n0e=[[746,747],[12549,12591],[12704,12735]],r0e=[[69632,69709],[69714,69749],69759],i0e=[[10240,10495]],o0e=[[6656,6683],[6686,6687]],a0e=[[5952,5971]],s0e=[[5120,5759],[6320,6389],[72368,72383]],u0e=[[66208,66256]],l0e=[[66864,66915],66927],c0e=[[69888,69940],[69942,69959]],d0e=[[43520,43574],[43584,43597],[43600,43609],[43612,43615]],m0e=[[5024,5109],[5112,5117],[43888,43967]],f0e=[[69552,69579]],h0e=[[0,64],[91,96],[123,169],[171,185],[187,191],215,247,[697,735],[741,745],[748,767],884,894,901,903,1541,1548,1563,1567,1600,1757,2274,[2404,2405],3647,[4053,4056],4347,[5867,5869],[5941,5942],[6146,6147],6149,7379,7393,[7401,7404],[7406,7411],[7413,7415],7418,[8192,8203],[8206,8292],[8294,8304],[8308,8318],[8320,8334],[8352,8384],[8448,8485],[8487,8489],[8492,8497],[8499,8525],[8527,8543],[8585,8587],[8592,9254],[9280,9290],[9312,10239],[10496,11123],[11126,11157],[11159,11263],[11776,11869],[12272,12283],[12288,12292],12294,[12296,12320],[12336,12343],[12348,12351],[12443,12444],12448,[12539,12540],[12688,12703],[12736,12771],[12832,12895],[12927,13007],13055,[13144,13311],[19904,19967],[42752,42785],[42888,42890],[43056,43065],43310,43471,43867,[43882,43883],[64830,64831],[65040,65049],[65072,65106],[65108,65126],[65128,65131],65279,[65281,65312],[65339,65344],[65371,65381],65392,[65438,65439],[65504,65510],[65512,65518],[65529,65533],[65792,65794],[65799,65843],[65847,65855],[65936,65948],[66e3,66044],[66273,66299],[113824,113827],[118608,118723],[118784,119029],[119040,119078],[119081,119142],[119146,119162],[119171,119172],[119180,119209],[119214,119274],[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[126065,126132],[126209,126269],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127487],[127489,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],917505,[917536,917631]],p0e=[[994,1007],[11392,11507],[11513,11519]],g0e=[[73728,74649],[74752,74862],[74864,74868],[74880,75075]],v0e=[[67584,67589],67592,[67594,67637],[67639,67640],67644,67647],b0e=[[77712,77810]],_0e=[[1024,1156],[1159,1327],[7296,7304],7467,7544,[11744,11775],[42560,42655],[65070,65071],[122928,122989],123023],C0e=[[66560,66639]],S0e=[[2304,2384],[2389,2403],[2406,2431],[43232,43263],[72448,72457]],E0e=[[71936,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72006],[72016,72025]],y0e=[[71680,71739]],D0e=[[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113820,113823]],R0e=[[77824,78933]],I0e=[[66816,66855]],A0e=[[69600,69622]],T0e=[[4608,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4988],[4992,5017],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[124896,124902],[124904,124907],[124909,124910],[124912,124926]],w0e=[[4256,4293],4295,4301,[4304,4346],[4348,4351],[7312,7354],[7357,7359],[11520,11557],11559,11565],L0e=[[11264,11359],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922]],O0e=[[66352,66378]],P0e=[[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70460,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516]],M0e=[[880,883],[885,887],[890,893],895,900,902,[904,906],908,[910,929],[931,993],[1008,1023],[7462,7466],[7517,7521],[7526,7530],7615,[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],8486,43877,[65856,65934],65952,[119296,119365]],N0e=[[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2801],[2809,2815]],x0e=[[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129]],F0e=[[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2678]],$0e=[[11904,11929],[11931,12019],[12032,12245],12293,12295,[12321,12329],[12344,12347],[13312,19903],[19968,40959],[63744,64109],[64112,64217],[94178,94179],[94192,94193],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],k0e=[[4352,4607],[12334,12335],[12593,12686],[12800,12830],[12896,12926],[43360,43388],[44032,55203],[55216,55238],[55243,55291],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500]],B0e=[[68864,68903],[68912,68921]],U0e=[[5920,5940]],V0e=[[67808,67826],[67828,67829],[67835,67839]],H0e=[[1425,1479],[1488,1514],[1519,1524],[64285,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],j0e=[[12353,12438],[12445,12447],[110593,110879],110898,[110928,110930],127488],z0e=[[67648,67669],[67671,67679]],W0e=[[768,879],[1157,1158],[1611,1621],1648,[2385,2388],[6832,6862],[7376,7378],[7380,7392],[7394,7400],7405,7412,[7416,7417],[7616,7679],[8204,8205],[8400,8432],[12330,12333],[12441,12442],[65024,65039],[65056,65069],66045,66272,70459,[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[917760,917999]],Y0e=[[68448,68466],[68472,68479]],X0e=[[68416,68437],[68440,68447]],q0e=[[43392,43469],[43472,43481],[43486,43487]],G0e=[[69760,69826],69837],K0e=[[3200,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315]],Z0e=[[12449,12538],[12541,12543],[12784,12799],[13008,13054],[13056,13143],[65382,65391],[65393,65437],[110576,110579],[110581,110587],[110589,110590],110592,[110880,110882],110933,[110948,110951]],Q0e=[[73472,73488],[73490,73530],[73534,73561]],J0e=[[43264,43309],43311],ede=[[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],[68159,68168],[68176,68184]],tde=[94180,[101120,101589]],nde=[[6016,6109],[6112,6121],[6128,6137],[6624,6655]],rde=[[70144,70161],[70163,70209]],ide=[[70320,70378],[70384,70393]],ode=[[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807]],ade=[[65,90],[97,122],170,186,[192,214],[216,246],[248,696],[736,740],[7424,7461],[7468,7516],[7522,7525],[7531,7543],[7545,7614],[7680,7935],8305,8319,[8336,8348],[8490,8491],8498,8526,[8544,8584],[11360,11391],[42786,42887],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43007],[43824,43866],[43868,43876],[43878,43881],[64256,64262],[65313,65338],[65345,65370],[67456,67461],[67463,67504],[67506,67514],[122624,122654],[122661,122666]],sde=[[7168,7223],[7227,7241],[7245,7247]],ude=[[6400,6430],[6432,6443],[6448,6459],6464,[6468,6479]],lde=[[67072,67382],[67392,67413],[67424,67431]],cde=[[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786]],dde=[[42192,42239],73648],mde=[[66176,66204]],fde=[[67872,67897],67903],hde=[[69968,70006]],pde=[[73440,73464]],gde=[[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3407],[3412,3427],[3430,3455]],vde=[[2112,2139],2142],bde=[[68288,68326],[68331,68342]],_de=[[72816,72847],[72850,72871],[72873,72886]],Cde=[[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049]],Sde=[[93760,93850]],Ede=[[43744,43766],[43968,44013],[44016,44025]],yde=[[124928,125124],[125127,125142]],Dde=[[68e3,68023],[68028,68047],[68050,68095]],Rde=[[67968,67999]],Ide=[[93952,94026],[94031,94087],[94095,94111]],Ade=[[71168,71236],[71248,71257]],Tde=[[6144,6145],6148,[6150,6169],[6176,6264],[6272,6314],[71264,71276]],wde=[[92736,92766],[92768,92777],[92782,92783]],Lde=[[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313]],Ode=[[4096,4255],[43488,43518],[43616,43647]],Pde=[[67712,67742],[67751,67759]],Mde=[[124112,124153]],Nde=[[72096,72103],[72106,72151],[72154,72164]],xde=[[6528,6571],[6576,6601],[6608,6618],[6622,6623]],Fde=[[70656,70747],[70749,70753]],$de=[[1984,2042],[2045,2047]],kde=[94177,[110960,111355]],Bde=[[123136,123180],[123184,123197],[123200,123209],[123214,123215]],Ude=[[5760,5788]],Vde=[[7248,7295]],Hde=[[68736,68786],[68800,68850],[68858,68863]],jde=[[66304,66339],[66349,66351]],zde=[[68224,68255]],Wde=[[66384,66426]],Yde=[[66464,66499],[66504,66517]],Xde=[[69376,69415]],qde=[[68192,68223]],Gde=[[68608,68680]],Kde=[[69488,69513]],Zde=[[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2935]],Qde=[[66736,66771],[66776,66811]],Jde=[[66688,66717],[66720,66729]],e6e=[[92928,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071]],t6e=[[67680,67711]],n6e=[[72384,72440]],r6e=[[43072,43127]],i6e=[[67840,67867],67871],o6e=[[68480,68497],[68505,68508],[68521,68527]],a6e=[[43312,43347],43359],s6e=[[5792,5866],[5870,5880]],u6e=[[2048,2093],[2096,2110]],l6e=[[43136,43205],[43214,43225]],c6e=[[70016,70111]],d6e=[[66640,66687]],m6e=[[71040,71093],[71096,71133]],f6e=[[120832,121483],[121499,121503],[121505,121519]],h6e=[[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3572],[70113,70132]],p6e=[[69424,69465]],g6e=[[69840,69864],[69872,69881]],v6e=[[72272,72354]],b6e=[[7040,7103],[7360,7367]],_6e=[[43008,43052]],C6e=[[1792,1805],[1807,1866],[1869,1871],[2144,2154]],S6e=[[5888,5909],5919],E6e=[[5984,5996],[5998,6e3],[6002,6003]],y6e=[[6480,6509],[6512,6516]],D6e=[[6688,6750],[6752,6780],[6783,6793],[6800,6809],[6816,6829]],R6e=[[43648,43714],[43739,43743]],I6e=[[71296,71353],[71360,71369]],A6e=[[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3066],[73664,73713],73727],T6e=[[92784,92862],[92864,92873]],w6e=[94176,[94208,100343],[100352,101119],[101632,101640]],L6e=[[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3191,3199]],O6e=[[1920,1969]],P6e=[[3585,3642],[3648,3675]],M6e=[[3840,3911],[3913,3948],[3953,3991],[3993,4028],[4030,4044],[4046,4052],[4057,4058]],N6e=[[11568,11623],[11631,11632],11647],x6e=[[70784,70855],[70864,70873]],F6e=[[123536,123566]],$6e=[[66432,66461],66463],k6e=[[42240,42539]],B6e=[[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004]],U6e=[[123584,123641],123647],V6e=[[71840,71922],71935],H6e=[[69248,69289],[69291,69293],[69296,69297]],j6e=[[40960,42124],[42128,42182]],z6e=[[72192,72263]],W6e=Object.freeze(Object.defineProperty({__proto__:null,Adlam:z2e,Ahom:W2e,Anatolian_Hieroglyphs:Y2e,Arabic:X2e,Armenian:q2e,Avestan:G2e,Balinese:K2e,Bamum:Z2e,Bassa_Vah:Q2e,Batak:J2e,Bengali:e0e,Bhaiksuki:t0e,Bopomofo:n0e,Brahmi:r0e,Braille:i0e,Buginese:o0e,Buhid:a0e,Canadian_Aboriginal:s0e,Carian:u0e,Caucasian_Albanian:l0e,Chakma:c0e,Cham:d0e,Cherokee:m0e,Chorasmian:f0e,Common:h0e,Coptic:p0e,Cuneiform:g0e,Cypriot:v0e,Cypro_Minoan:b0e,Cyrillic:_0e,Deseret:C0e,Devanagari:S0e,Dives_Akuru:E0e,Dogra:y0e,Duployan:D0e,Egyptian_Hieroglyphs:R0e,Elbasan:I0e,Elymaic:A0e,Ethiopic:T0e,Georgian:w0e,Glagolitic:L0e,Gothic:O0e,Grantha:P0e,Greek:M0e,Gujarati:N0e,Gunjala_Gondi:x0e,Gurmukhi:F0e,Han:$0e,Hangul:k0e,Hanifi_Rohingya:B0e,Hanunoo:U0e,Hatran:V0e,Hebrew:H0e,Hiragana:j0e,Imperial_Aramaic:z0e,Inherited:W0e,Inscriptional_Pahlavi:Y0e,Inscriptional_Parthian:X0e,Javanese:q0e,Kaithi:G0e,Kannada:K0e,Katakana:Z0e,Kawi:Q0e,Kayah_Li:J0e,Kharoshthi:ede,Khitan_Small_Script:tde,Khmer:nde,Khojki:rde,Khudawadi:ide,Lao:ode,Latin:ade,Lepcha:sde,Limbu:ude,Linear_A:lde,Linear_B:cde,Lisu:dde,Lycian:mde,Lydian:fde,Mahajani:hde,Makasar:pde,Malayalam:gde,Mandaic:vde,Manichaean:bde,Marchen:_de,Masaram_Gondi:Cde,Medefaidrin:Sde,Meetei_Mayek:Ede,Mende_Kikakui:yde,Meroitic_Cursive:Dde,Meroitic_Hieroglyphs:Rde,Miao:Ide,Modi:Ade,Mongolian:Tde,Mro:wde,Multani:Lde,Myanmar:Ode,Nabataean:Pde,Nag_Mundari:Mde,Nandinagari:Nde,New_Tai_Lue:xde,Newa:Fde,Nko:$de,Nushu:kde,Nyiakeng_Puachue_Hmong:Bde,Ogham:Ude,Ol_Chiki:Vde,Old_Hungarian:Hde,Old_Italic:jde,Old_North_Arabian:zde,Old_Permic:Wde,Old_Persian:Yde,Old_Sogdian:Xde,Old_South_Arabian:qde,Old_Turkic:Gde,Old_Uyghur:Kde,Oriya:Zde,Osage:Qde,Osmanya:Jde,Pahawh_Hmong:e6e,Palmyrene:t6e,Pau_Cin_Hau:n6e,Phags_Pa:r6e,Phoenician:i6e,Psalter_Pahlavi:o6e,Rejang:a6e,Runic:s6e,Samaritan:u6e,Saurashtra:l6e,Sharada:c6e,Shavian:d6e,Siddham:m6e,SignWriting:f6e,Sinhala:h6e,Sogdian:p6e,Sora_Sompeng:g6e,Soyombo:v6e,Sundanese:b6e,Syloti_Nagri:_6e,Syriac:C6e,Tagalog:S6e,Tagbanwa:E6e,Tai_Le:y6e,Tai_Tham:D6e,Tai_Viet:R6e,Takri:I6e,Tamil:A6e,Tangsa:T6e,Tangut:w6e,Telugu:L6e,Thaana:O6e,Thai:P6e,Tibetan:M6e,Tifinagh:N6e,Tirhuta:x6e,Toto:F6e,Ugaritic:$6e,Vai:k6e,Vithkuqi:B6e,Wancho:U6e,Warang_Citi:V6e,Yezidi:H6e,Yi:j6e,Zanabazar_Square:z6e},Symbol.toStringTag,{value:"Module"})),Y6e=[1567,1600,[125184,125259],[125264,125273],[125278,125279]],X6e=[[71424,71450],[71453,71467],[71472,71494]],q6e=[[82944,83526]],G6e=[[1536,1540],[1542,1756],[1758,1791],[1872,1919],[2160,2190],[2192,2193],[2200,2273],[2275,2303],[64336,64450],[64467,64911],[64914,64967],64975,[65008,65023],[65136,65140],[65142,65276],[66272,66299],[69216,69246],[69373,69375],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705]],K6e=[[1329,1366],[1369,1418],[1421,1423],[64275,64279]],Z6e=[[68352,68405],[68409,68415]],Q6e=[[6912,6988],[6992,7038]],J6e=[[42656,42743],[92160,92728]],eme=[[92880,92909],[92912,92917]],tme=[[7104,7155],[7164,7167]],nme=[[2385,2386],[2404,2405],[2432,2435],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],[2492,2500],[2503,2504],[2507,2510],2519,[2524,2525],[2527,2531],[2534,2558],7376,7378,[7381,7382],7384,7393,7402,7405,7410,[7413,7415],43249],rme=[[72704,72712],[72714,72758],[72760,72773],[72784,72812]],ime=[[746,747],[12289,12291],[12296,12305],[12307,12319],[12330,12333],12336,12343,12539,[12549,12591],[12704,12735],[65093,65094],[65377,65381]],ome=[[69632,69709],[69714,69749],69759],ame=[[10240,10495]],sme=[[6656,6683],[6686,6687],43471],ume=[[5941,5942],[5952,5971]],lme=[[5120,5759],[6320,6389],[72368,72383]],cme=[[66208,66256]],dme=[[66864,66915],66927],mme=[[2534,2543],[4160,4169],[69888,69940],[69942,69959]],fme=[[43520,43574],[43584,43597],[43600,43609],[43612,43615]],hme=[[5024,5109],[5112,5117],[43888,43967]],pme=[[69552,69579]],gme=[[0,64],[91,96],[123,169],[171,185],[187,191],215,247,[697,735],[741,745],[748,767],884,894,901,903,1541,1757,2274,3647,[4053,4056],[5867,5869],[8192,8203],[8206,8238],[8240,8292],[8294,8304],[8308,8318],[8320,8334],[8352,8384],[8448,8485],[8487,8489],[8492,8497],[8499,8525],[8527,8543],[8585,8587],[8592,9254],[9280,9290],[9312,10239],[10496,11123],[11126,11157],[11159,11263],[11776,11842],[11844,11869],[12272,12283],12288,12292,12306,12320,12342,[12872,12895],12927,[12977,12991],[13004,13007],[13169,13178],[13184,13279],13311,[19904,19967],[42760,42785],[42888,42890],43867,[43882,43883],[65040,65049],[65072,65092],[65095,65106],[65108,65126],[65128,65131],65279,[65281,65312],[65339,65344],[65371,65376],[65504,65510],[65512,65518],[65529,65533],[65936,65948],[66e3,66044],[118608,118723],[118784,119029],[119040,119078],[119081,119142],[119146,119162],[119171,119172],[119180,119209],[119214,119274],[119488,119507],[119520,119539],[119552,119638],[119666,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120782,120831],[126065,126132],[126209,126269],[126976,127019],[127024,127123],[127136,127150],[127153,127167],[127169,127183],[127185,127221],[127232,127405],[127462,127487],[127489,127490],[127504,127547],[127552,127560],[127584,127589],[127744,128727],[128732,128748],[128752,128764],[128768,128886],[128891,128985],[128992,129003],129008,[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129200,129201],[129280,129619],[129632,129645],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[129792,129938],[129940,129994],[130032,130041],917505,[917536,917631]],vme=[[994,1007],[11392,11507],[11513,11519],[66272,66299]],bme=[[73728,74649],[74752,74862],[74864,74868],[74880,75075]],_me=[[65792,65794],[65799,65843],[65847,65855],[67584,67589],67592,[67594,67637],[67639,67640],67644,67647],Cme=[[65792,65793],[77712,77810]],Sme=[[1024,1327],[7296,7304],7467,7544,7672,[11744,11775],11843,[42560,42655],[65070,65071],[122928,122989],123023],Eme=[[66560,66639]],yme=[[2304,2386],[2389,2431],[7376,7414],[7416,7417],8432,[43056,43065],[43232,43263],[72448,72457]],Dme=[[71936,71942],71945,[71948,71955],[71957,71958],[71960,71989],[71991,71992],[71995,72006],[72016,72025]],Rme=[[2404,2415],[43056,43065],[71680,71739]],Ime=[[113664,113770],[113776,113788],[113792,113800],[113808,113817],[113820,113827]],Ame=[[77824,78933]],Tme=[[66816,66855]],wme=[[69600,69622]],Lme=[[4608,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4957,4988],[4992,5017],[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[124896,124902],[124904,124907],[124909,124910],[124912,124926]],Ome=[[4256,4293],4295,4301,[4304,4351],[7312,7354],[7357,7359],[11520,11557],11559,11565],Pme=[1156,1159,[11264,11359],11843,42607,[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922]],Mme=[[66352,66378]],Nme=[[2385,2386],[2404,2405],[3046,3059],7376,[7378,7379],[7410,7412],[7416,7417],8432,[70400,70403],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],[70459,70468],[70471,70472],[70475,70477],70480,70487,[70493,70499],[70502,70508],[70512,70516],[73680,73681],73683],xme=[834,837,[880,883],[885,887],[890,893],895,900,902,[904,906],908,[910,929],[931,993],[1008,1023],[7462,7466],[7517,7521],[7526,7530],[7615,7617],[7936,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8190],8486,43877,[65856,65934],65952,[119296,119365]],Fme=[[2385,2386],[2404,2405],[2689,2691],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],[2748,2757],[2759,2761],[2763,2765],2768,[2784,2787],[2790,2801],[2809,2815],[43056,43065]],$me=[[2404,2405],[73056,73061],[73063,73064],[73066,73102],[73104,73105],[73107,73112],[73120,73129]],kme=[[2385,2386],[2404,2405],[2561,2563],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2649,2652],2654,[2662,2678],[43056,43065]],Bme=[[11904,11929],[11931,12019],[12032,12245],[12289,12291],[12293,12305],[12307,12319],[12321,12333],12336,[12343,12351],12539,[12688,12703],[12736,12771],[12832,12871],[12928,12976],[12992,13003],13055,[13144,13168],[13179,13183],[13280,13310],[13312,19903],[19968,40959],[42752,42759],[63744,64109],[64112,64217],[65093,65094],[65377,65381],[94178,94179],[94192,94193],[119648,119665],[127568,127569],[131072,173791],[173824,177977],[177984,178205],[178208,183969],[183984,191456],[194560,195101],[196608,201546],[201552,205743]],Ume=[[4352,4607],[12289,12291],[12296,12305],[12307,12319],[12334,12336],12343,12539,[12593,12686],[12800,12830],[12896,12926],[43360,43388],[44032,55203],[55216,55238],[55243,55291],[65093,65094],[65377,65381],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500]],Vme=[1548,1563,1567,1600,1748,[68864,68903],[68912,68921]],Hme=[[5920,5942]],jme=[[67808,67826],[67828,67829],[67835,67839]],zme=[[1425,1479],[1488,1514],[1519,1524],[64285,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],Wme=[[12289,12291],[12296,12305],[12307,12319],[12336,12341],12343,[12348,12349],[12353,12438],[12441,12448],[12539,12540],[65093,65094],[65377,65381],65392,[65438,65439],[110593,110879],110898,[110928,110930],127488],Yme=[[67648,67669],[67671,67679]],Xme=[[768,833],[835,836],[838,866],[2387,2388],[6832,6862],[7618,7671],7673,[7675,7679],[8204,8205],[8400,8431],[65024,65039],[65056,65069],66045,[118528,118573],[118576,118598],[119143,119145],[119163,119170],[119173,119179],[119210,119213],[917760,917999]],qme=[[68448,68466],[68472,68479]],Gme=[[68416,68437],[68440,68447]],Kme=[[43392,43469],[43471,43481],[43486,43487]],Zme=[[2406,2415],[43056,43065],[69760,69826],69837],Qme=[[2385,2386],[2404,2405],[3200,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],[3260,3268],[3270,3272],[3274,3277],[3285,3286],[3293,3294],[3296,3299],[3302,3311],[3313,3315],7376,7378,7386,7410,7412,[43056,43061]],Jme=[[12289,12291],[12296,12305],[12307,12319],[12336,12341],12343,[12348,12349],[12441,12444],[12448,12543],[12784,12799],[13008,13054],[13056,13143],[65093,65094],[65377,65439],[110576,110579],[110581,110587],[110589,110590],110592,[110880,110882],110933,[110948,110951]],efe=[[73472,73488],[73490,73530],[73534,73561]],tfe=[[43264,43311]],nfe=[[68096,68099],[68101,68102],[68108,68115],[68117,68119],[68121,68149],[68152,68154],[68159,68168],[68176,68184]],rfe=[94180,[101120,101589]],ife=[[6016,6109],[6112,6121],[6128,6137],[6624,6655]],ofe=[[2790,2799],[43056,43065],[70144,70161],[70163,70209]],afe=[[2404,2405],[43056,43065],[70320,70378],[70384,70393]],sfe=[[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3792,3801],[3804,3807]],ufe=[[65,90],[97,122],170,186,[192,214],[216,246],[248,696],[736,740],[867,879],[1157,1158],[2385,2386],4347,[7424,7461],[7468,7516],[7522,7525],[7531,7543],[7545,7614],[7680,7935],8239,8305,8319,[8336,8348],8432,[8490,8491],8498,8526,[8544,8584],[11360,11391],[42752,42759],[42786,42887],[42891,42954],[42960,42961],42963,[42965,42969],[42994,43007],43310,[43824,43866],[43868,43876],[43878,43881],[64256,64262],[65313,65338],[65345,65370],[67456,67461],[67463,67504],[67506,67514],[122624,122654],[122661,122666]],lfe=[[7168,7223],[7227,7241],[7245,7247]],cfe=[2405,[6400,6430],[6432,6443],[6448,6459],6464,[6468,6479]],dfe=[[65799,65843],[67072,67382],[67392,67413],[67424,67431]],mfe=[[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65792,65794],[65799,65843],[65847,65855]],ffe=[[42192,42239],73648],hfe=[[66176,66204]],pfe=[[67872,67897],67903],gfe=[[2404,2415],[43056,43065],[69968,70006]],vfe=[[73440,73464]],bfe=[[2385,2386],[2404,2405],[3328,3340],[3342,3344],[3346,3396],[3398,3400],[3402,3407],[3412,3427],[3430,3455],7386,[43056,43058]],_fe=[1600,[2112,2139],2142],Cfe=[1600,[68288,68326],[68331,68342]],Sfe=[[72816,72847],[72850,72871],[72873,72886]],Efe=[[2404,2405],[72960,72966],[72968,72969],[72971,73014],73018,[73020,73021],[73023,73031],[73040,73049]],yfe=[[93760,93850]],Dfe=[[43744,43766],[43968,44013],[44016,44025]],Rfe=[[124928,125124],[125127,125142]],Ife=[[68e3,68023],[68028,68047],[68050,68095]],Afe=[[67968,67999]],Tfe=[[93952,94026],[94031,94087],[94095,94111]],wfe=[[43056,43065],[71168,71236],[71248,71257]],Lfe=[[6144,6169],[6176,6264],[6272,6314],8239,[71264,71276]],Ofe=[[92736,92766],[92768,92777],[92782,92783]],Pfe=[[2662,2671],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70313]],Mfe=[[4096,4255],43310,[43488,43518],[43616,43647]],Nfe=[[67712,67742],[67751,67759]],xfe=[[124112,124153]],Ffe=[[2404,2405],[3302,3311],7401,7410,7418,[43056,43061],[72096,72103],[72106,72151],[72154,72164]],$fe=[[6528,6571],[6576,6601],[6608,6618],[6622,6623]],kfe=[[70656,70747],[70749,70753]],Bfe=[1548,1563,1567,[1984,2042],[2045,2047],[64830,64831]],Ufe=[94177,[110960,111355]],Vfe=[[123136,123180],[123184,123197],[123200,123209],[123214,123215]],Hfe=[[5760,5788]],jfe=[[7248,7295]],zfe=[[68736,68786],[68800,68850],[68858,68863]],Wfe=[[66304,66339],[66349,66351]],Yfe=[[68224,68255]],Xfe=[1155,[66384,66426]],qfe=[[66464,66499],[66504,66517]],Gfe=[[69376,69415]],Kfe=[[68192,68223]],Zfe=[[68608,68680]],Qfe=[1600,68338,[69488,69513]],Jfe=[[2385,2386],[2404,2405],[2817,2819],[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],[2876,2884],[2887,2888],[2891,2893],[2901,2903],[2908,2909],[2911,2915],[2918,2935],7386,7410],e3e=[[66736,66771],[66776,66811]],t3e=[[66688,66717],[66720,66729]],n3e=[[92928,92997],[93008,93017],[93019,93025],[93027,93047],[93053,93071]],r3e=[[67680,67711]],i3e=[[72384,72440]],o3e=[[6146,6147],6149,[43072,43127]],a3e=[[67840,67867],67871],s3e=[1600,[68480,68497],[68505,68508],[68521,68527]],u3e=[[43312,43347],43359],l3e=[[5792,5866],[5870,5880]],c3e=[[2048,2093],[2096,2110]],d3e=[[43136,43205],[43214,43225]],m3e=[2385,7383,7385,[7388,7389],7392,[70016,70111]],f3e=[[66640,66687]],h3e=[[71040,71093],[71096,71133]],p3e=[[120832,121483],[121499,121503],[121505,121519]],g3e=[[2404,2405],[3457,3459],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3530,[3535,3540],3542,[3544,3551],[3558,3567],[3570,3572],[70113,70132]],v3e=[1600,[69424,69465]],b3e=[[69840,69864],[69872,69881]],_3e=[[72272,72354]],C3e=[[7040,7103],[7360,7367]],S3e=[[2404,2405],[2534,2543],[43008,43052]],E3e=[1548,[1563,1564],1567,1600,[1611,1621],1648,[1792,1805],[1807,1866],[1869,1871],[2144,2154],7672,7674],y3e=[[5888,5909],5919,[5941,5942]],D3e=[[5941,5942],[5984,5996],[5998,6e3],[6002,6003]],R3e=[[4160,4169],[6480,6509],[6512,6516]],I3e=[[6688,6750],[6752,6780],[6783,6793],[6800,6809],[6816,6829]],A3e=[[43648,43714],[43739,43743]],T3e=[[2404,2405],[43056,43065],[71296,71353],[71360,71369]],w3e=[[2385,2386],[2404,2405],[2946,2947],[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],[3006,3010],[3014,3016],[3018,3021],3024,3031,[3046,3066],7386,43251,70401,70403,[70459,70460],[73664,73713],73727],L3e=[[92784,92862],[92864,92873]],O3e=[94176,[94208,100343],[100352,101119],[101632,101640]],P3e=[[2385,2386],[2404,2405],[3072,3084],[3086,3088],[3090,3112],[3114,3129],[3132,3140],[3142,3144],[3146,3149],[3157,3158],[3160,3162],3165,[3168,3171],[3174,3183],[3191,3199],7386,7410],M3e=[1548,[1563,1564],1567,[1632,1641],[1920,1969],65010,65021],N3e=[[3585,3642],[3648,3675]],x3e=[[3840,3911],[3913,3948],[3953,3991],[3993,4028],[4030,4044],[4046,4052],[4057,4058]],F3e=[[11568,11623],[11631,11632],11647],$3e=[[2385,2386],[2404,2405],7410,[43056,43065],[70784,70855],[70864,70873]],k3e=[[123536,123566]],B3e=[[66432,66461],66463],U3e=[[42240,42539]],V3e=[[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004]],H3e=[[123584,123641],123647],j3e=[[71840,71922],71935],z3e=[1548,1563,1567,[1632,1641],[69248,69289],[69291,69293],[69296,69297]],W3e=[[12289,12290],[12296,12305],[12308,12315],12539,[40960,42124],[42128,42182],[65377,65381]],Y3e=[[72192,72263]],X3e=Object.freeze(Object.defineProperty({__proto__:null,Adlam:Y6e,Ahom:X6e,Anatolian_Hieroglyphs:q6e,Arabic:G6e,Armenian:K6e,Avestan:Z6e,Balinese:Q6e,Bamum:J6e,Bassa_Vah:eme,Batak:tme,Bengali:nme,Bhaiksuki:rme,Bopomofo:ime,Brahmi:ome,Braille:ame,Buginese:sme,Buhid:ume,Canadian_Aboriginal:lme,Carian:cme,Caucasian_Albanian:dme,Chakma:mme,Cham:fme,Cherokee:hme,Chorasmian:pme,Common:gme,Coptic:vme,Cuneiform:bme,Cypriot:_me,Cypro_Minoan:Cme,Cyrillic:Sme,Deseret:Eme,Devanagari:yme,Dives_Akuru:Dme,Dogra:Rme,Duployan:Ime,Egyptian_Hieroglyphs:Ame,Elbasan:Tme,Elymaic:wme,Ethiopic:Lme,Georgian:Ome,Glagolitic:Pme,Gothic:Mme,Grantha:Nme,Greek:xme,Gujarati:Fme,Gunjala_Gondi:$me,Gurmukhi:kme,Han:Bme,Hangul:Ume,Hanifi_Rohingya:Vme,Hanunoo:Hme,Hatran:jme,Hebrew:zme,Hiragana:Wme,Imperial_Aramaic:Yme,Inherited:Xme,Inscriptional_Pahlavi:qme,Inscriptional_Parthian:Gme,Javanese:Kme,Kaithi:Zme,Kannada:Qme,Katakana:Jme,Kawi:efe,Kayah_Li:tfe,Kharoshthi:nfe,Khitan_Small_Script:rfe,Khmer:ife,Khojki:ofe,Khudawadi:afe,Lao:sfe,Latin:ufe,Lepcha:lfe,Limbu:cfe,Linear_A:dfe,Linear_B:mfe,Lisu:ffe,Lycian:hfe,Lydian:pfe,Mahajani:gfe,Makasar:vfe,Malayalam:bfe,Mandaic:_fe,Manichaean:Cfe,Marchen:Sfe,Masaram_Gondi:Efe,Medefaidrin:yfe,Meetei_Mayek:Dfe,Mende_Kikakui:Rfe,Meroitic_Cursive:Ife,Meroitic_Hieroglyphs:Afe,Miao:Tfe,Modi:wfe,Mongolian:Lfe,Mro:Ofe,Multani:Pfe,Myanmar:Mfe,Nabataean:Nfe,Nag_Mundari:xfe,Nandinagari:Ffe,New_Tai_Lue:$fe,Newa:kfe,Nko:Bfe,Nushu:Ufe,Nyiakeng_Puachue_Hmong:Vfe,Ogham:Hfe,Ol_Chiki:jfe,Old_Hungarian:zfe,Old_Italic:Wfe,Old_North_Arabian:Yfe,Old_Permic:Xfe,Old_Persian:qfe,Old_Sogdian:Gfe,Old_South_Arabian:Kfe,Old_Turkic:Zfe,Old_Uyghur:Qfe,Oriya:Jfe,Osage:e3e,Osmanya:t3e,Pahawh_Hmong:n3e,Palmyrene:r3e,Pau_Cin_Hau:i3e,Phags_Pa:o3e,Phoenician:a3e,Psalter_Pahlavi:s3e,Rejang:u3e,Runic:l3e,Samaritan:c3e,Saurashtra:d3e,Sharada:m3e,Shavian:f3e,Siddham:h3e,SignWriting:p3e,Sinhala:g3e,Sogdian:v3e,Sora_Sompeng:b3e,Soyombo:_3e,Sundanese:C3e,Syloti_Nagri:S3e,Syriac:E3e,Tagalog:y3e,Tagbanwa:D3e,Tai_Le:R3e,Tai_Tham:I3e,Tai_Viet:A3e,Takri:T3e,Tamil:w3e,Tangsa:L3e,Tangut:O3e,Telugu:P3e,Thaana:M3e,Thai:N3e,Tibetan:x3e,Tifinagh:F3e,Tirhuta:$3e,Toto:k3e,Ugaritic:B3e,Vai:U3e,Vithkuqi:V3e,Wancho:H3e,Warang_Citi:j3e,Yezidi:z3e,Yi:W3e,Zanabazar_Square:Y3e},Symbol.toStringTag,{value:"Module"})),q3e=[],G3e=[],K3e=[],Z3e=[],Q3e=Object.freeze(Object.defineProperty({__proto__:null,C:q3e,F:G3e,S:K3e,T:Z3e},Symbol.toStringTag,{value:"Module"})),J3e=[[125184,125279]],e4e=[[65792,65855]],t4e=[[71424,71503]],n4e=[[128768,128895]],r4e=[[64256,64335]],i4e=[[82944,83583]],o4e=[[119296,119375]],a4e=[[65856,65935]],s4e=[[65936,65999]],u4e=[[1536,1791]],l4e=[[2208,2303]],c4e=[[126464,126719]],d4e=[[64336,65023]],m4e=[[65136,65279]],f4e=[[1872,1919]],h4e=[[1328,1423]],p4e=[[8592,8703]],g4e=[[68352,68415]],v4e=[[6912,7039]],b4e=[[42656,42751]],_4e=[[92160,92735]],C4e=[[0,127]],S4e=[[92880,92927]],E4e=[[7104,7167]],y4e=[[2432,2559]],D4e=[[72704,72815]],R4e=[[9600,9631]],I4e=[[12544,12591]],A4e=[[12704,12735]],T4e=[[9472,9599]],w4e=[[69632,69759]],L4e=[[10240,10495]],O4e=[[6656,6687]],P4e=[[5952,5983]],M4e=[[118784,119039]],N4e=[[13056,13311]],x4e=[[65072,65103]],F4e=[[63744,64255]],$4e=[[194560,195103]],k4e=[[11904,12031]],B4e=[[12736,12783]],U4e=[[12288,12351]],V4e=[[19968,40959]],H4e=[[13312,19903]],j4e=[[131072,173791]],z4e=[[173824,177983]],W4e=[[177984,178207]],Y4e=[[178208,183983]],X4e=[[183984,191471]],q4e=[[66208,66271]],G4e=[[66864,66927]],K4e=[[69888,69967]],Z4e=[[43520,43615]],Q4e=[[5024,5119]],J4e=[[43888,43967]],e7e=[[129536,129647]],t7e=[[768,879]],n7e=[[6832,6911]],r7e=[[8400,8447]],i7e=[[7616,7679]],o7e=[[65056,65071]],a7e=[[43056,43071]],s7e=[[9216,9279]],u7e=[[11392,11519]],l7e=[[66272,66303]],c7e=[[119648,119679]],d7e=[[73728,74751]],m7e=[[74752,74879]],f7e=[[8352,8399]],h7e=[[67584,67647]],p7e=[[1024,1279]],g7e=[[11744,11775]],v7e=[[42560,42655]],b7e=[[7296,7311]],_7e=[[1280,1327]],C7e=[[66560,66639]],S7e=[[2304,2431]],E7e=[[43232,43263]],y7e=[[9984,10175]],D7e=[[71680,71759]],R7e=[[127024,127135]],I7e=[[113664,113823]],A7e=[[74880,75087]],T7e=[[77824,78895]],w7e=[[66816,66863]],L7e=[[128512,128591]],O7e=[[127232,127487]],P7e=[[9312,9471]],M7e=[[12800,13055]],N7e=[[127488,127743]],x7e=[[4608,4991]],F7e=[[11648,11743]],$7e=[[43776,43823]],k7e=[[4992,5023]],B7e=[[8192,8303]],U7e=[[9632,9727]],V7e=[[128896,129023]],H7e=[[4256,4351]],j7e=[[7312,7359]],z7e=[[11520,11567]],W7e=[[11264,11359]],Y7e=[[122880,122927]],X7e=[[66352,66383]],q7e=[[70400,70527]],G7e=[[880,1023]],K7e=[[7936,8191]],Z7e=[[2688,2815]],Q7e=[[73056,73135]],J7e=[[2560,2687]],ehe=[[65280,65519]],the=[[12592,12687]],nhe=[[4352,4607]],rhe=[[43360,43391]],ihe=[[55216,55295]],ohe=[[44032,55215]],ahe=[[68864,68927]],she=[[5920,5951]],uhe=[[67808,67839]],lhe=[[1424,1535]],che=[[56192,56319]],dhe=[[55296,56191]],mhe=[[12352,12447]],fhe=[[592,687]],hhe=[[12272,12287]],phe=[[94176,94207]],ghe=[[67648,67679]],vhe=[[126064,126143]],bhe=[[68448,68479]],_he=[[68416,68447]],Che=[[43392,43487]],She=[[69760,69839]],Ehe=[[110848,110895]],yhe=[[110592,110847]],Dhe=[[12688,12703]],Rhe=[[12032,12255]],Ihe=[[3200,3327]],Ahe=[[12448,12543]],The=[[12784,12799]],whe=[[43264,43311]],Lhe=[[68096,68191]],Ohe=[[6016,6143]],Phe=[[6624,6655]],Mhe=[[70144,70223]],Nhe=[[70320,70399]],xhe=[[3712,3839]],Fhe=[[128,255]],$he=[[256,383]],khe=[[7680,7935]],Bhe=[[384,591]],Uhe=[[11360,11391]],Vhe=[[42784,43007]],Hhe=[[43824,43887]],jhe=[[7168,7247]],zhe=[[8448,8527]],Whe=[[6400,6479]],Yhe=[[67072,67455]],Xhe=[[65664,65791]],qhe=[[65536,65663]],Ghe=[[42192,42239]],Khe=[[56320,57343]],Zhe=[[66176,66207]],Qhe=[[67872,67903]],Jhe=[[69968,70015]],e9e=[[126976,127023]],t9e=[[73440,73471]],n9e=[[3328,3455]],r9e=[[2112,2143]],i9e=[[68288,68351]],o9e=[[72816,72895]],a9e=[[72960,73055]],s9e=[[119808,120831]],u9e=[[8704,8959]],l9e=[[119520,119551]],c9e=[[93760,93855]],d9e=[[43968,44031]],m9e=[[43744,43775]],f9e=[[124928,125151]],h9e=[[68e3,68095]],p9e=[[67968,67999]],g9e=[[93952,94111]],v9e=[[10176,10223]],b9e=[[10624,10751]],_9e=[[9728,9983]],C9e=[[11008,11263]],S9e=[[127744,128511]],E9e=[[8960,9215]],y9e=[[71168,71263]],D9e=[[42752,42783]],R9e=[[6144,6319]],I9e=[[71264,71295]],A9e=[[92736,92783]],T9e=[[70272,70319]],w9e=[[119040,119295]],L9e=[[4096,4255]],O9e=[[43616,43647]],P9e=[[43488,43519]],M9e=[[1984,2047]],N9e=[[67712,67759]],x9e=[[6528,6623]],F9e=[[70656,70783]],$9e=[[8528,8591]],k9e=[[110960,111359]],B9e=[[5760,5791]],U9e=[[7248,7295]],V9e=[[68736,68863]],H9e=[[66304,66351]],j9e=[[68224,68255]],z9e=[[66384,66431]],W9e=[[66464,66527]],Y9e=[[69376,69423]],X9e=[[68192,68223]],q9e=[[68608,68687]],G9e=[[9280,9311]],K9e=[[2816,2943]],Z9e=[[128592,128639]],Q9e=[[66736,66815]],J9e=[[66688,66735]],e5e=[[92928,93071]],t5e=[[67680,67711]],n5e=[[72384,72447]],r5e=[[43072,43135]],i5e=[[66e3,66047]],o5e=[[67840,67871]],a5e=[[7424,7551]],s5e=[[7552,7615]],u5e=[[127136,127231]],l5e=[[57344,63743]],c5e=[[68480,68527]],d5e=[[43312,43359]],m5e=[[69216,69247]],f5e=[[5792,5887]],h5e=[[2048,2111]],p5e=[[43136,43231]],g5e=[[70016,70111]],v5e=[[66640,66687]],b5e=[[113824,113839]],_5e=[[71040,71167]],C5e=[[3456,3583]],S5e=[[70112,70143]],E5e=[[65104,65135]],y5e=[[69424,69487]],D5e=[[69840,69887]],R5e=[[72272,72367]],I5e=[[688,767]],A5e=[[65520,65535]],T5e=[[7040,7103]],w5e=[[7360,7375]],L5e=[[8304,8351]],O5e=[[10224,10239]],P5e=[[10496,10623]],M5e=[[129024,129279]],N5e=[[10752,11007]],x5e=[[11776,11903]],F5e=[[129280,129535]],$5e=[[983040,1048575]],k5e=[[1048576,1114111]],B5e=[[120832,121519]],U5e=[[43008,43055]],V5e=[[1792,1871]],H5e=[[2144,2159]],j5e=[[5888,5919]],z5e=[[5984,6015]],W5e=[[917504,917631]],Y5e=[[6480,6527]],X5e=[[6688,6831]],q5e=[[43648,43743]],G5e=[[119552,119647]],K5e=[[71296,71375]],Z5e=[[2944,3071]],Q5e=[[94208,100351]],J5e=[[100352,101119]],e8e=[[3072,3199]],t8e=[[1920,1983]],n8e=[[3584,3711]],r8e=[[3840,4095]],i8e=[[11568,11647]],o8e=[[70784,70879]],a8e=[[128640,128767]],s8e=[[66432,66463]],u8e=[[5120,5759]],l8e=[[6320,6399]],c8e=[[42240,42559]],d8e=[[65024,65039]],m8e=[[917760,917999]],f8e=[[7376,7423]],h8e=[[65040,65055]],p8e=[[71840,71935]],g8e=[[42128,42191]],v8e=[[40960,42127]],b8e=[[19904,19967]],_8e=[[72192,72271]],C8e=[[2160,2207],[66928,67007],[67456,67519],[69248,69375],[69488,69631],[71936,72031],[72096,72191],[72368,72383],[72448,72543],[73472,73567],[73648,73727],[77712,77823],[78896,78943],[92784,92879],[101120,101759],[110576,110591],[110896,110959],[118528,118735],[119488,119519],[122624,122879],[122928,123023],[123136,123215],[123536,123647],[124112,124159],[124896,124927],[126208,126287],[129648,130047],[196608,205743]],S8e=Object.freeze(Object.defineProperty({__proto__:null,Adlam:J3e,Aegean_Numbers:e4e,Ahom:t4e,Alchemical_Symbols:n4e,Alphabetic_Presentation_Forms:r4e,Anatolian_Hieroglyphs:i4e,Ancient_Greek_Musical_Notation:o4e,Ancient_Greek_Numbers:a4e,Ancient_Symbols:s4e,Arabic:u4e,Arabic_Extended_A:l4e,Arabic_Mathematical_Alphabetic_Symbols:c4e,Arabic_Presentation_Forms_A:d4e,Arabic_Presentation_Forms_B:m4e,Arabic_Supplement:f4e,Armenian:h4e,Arrows:p4e,Avestan:g4e,Balinese:v4e,Bamum:b4e,Bamum_Supplement:_4e,Basic_Latin:C4e,Bassa_Vah:S4e,Batak:E4e,Bengali:y4e,Bhaiksuki:D4e,Block_Elements:R4e,Bopomofo:I4e,Bopomofo_Extended:A4e,Box_Drawing:T4e,Brahmi:w4e,Braille_Patterns:L4e,Buginese:O4e,Buhid:P4e,Byzantine_Musical_Symbols:M4e,CJK_Compatibility:N4e,CJK_Compatibility_Forms:x4e,CJK_Compatibility_Ideographs:F4e,CJK_Compatibility_Ideographs_Supplement:$4e,CJK_Radicals_Supplement:k4e,CJK_Strokes:B4e,CJK_Symbols_And_Punctuation:U4e,CJK_Unified_Ideographs:V4e,CJK_Unified_Ideographs_Extension_A:H4e,CJK_Unified_Ideographs_Extension_B:j4e,CJK_Unified_Ideographs_Extension_C:z4e,CJK_Unified_Ideographs_Extension_D:W4e,CJK_Unified_Ideographs_Extension_E:Y4e,CJK_Unified_Ideographs_Extension_F:X4e,Carian:q4e,Caucasian_Albanian:G4e,Chakma:K4e,Cham:Z4e,Cherokee:Q4e,Cherokee_Supplement:J4e,Chess_Symbols:e7e,Combining_Diacritical_Marks:t7e,Combining_Diacritical_Marks_Extended:n7e,Combining_Diacritical_Marks_For_Symbols:r7e,Combining_Diacritical_Marks_Supplement:i7e,Combining_Half_Marks:o7e,Common_Indic_Number_Forms:a7e,Control_Pictures:s7e,Coptic:u7e,Coptic_Epact_Numbers:l7e,Counting_Rod_Numerals:c7e,Cuneiform:d7e,Cuneiform_Numbers_And_Punctuation:m7e,Currency_Symbols:f7e,Cypriot_Syllabary:h7e,Cyrillic:p7e,Cyrillic_Extended_A:g7e,Cyrillic_Extended_B:v7e,Cyrillic_Extended_C:b7e,Cyrillic_Supplement:_7e,Deseret:C7e,Devanagari:S7e,Devanagari_Extended:E7e,Dingbats:y7e,Dogra:D7e,Domino_Tiles:R7e,Duployan:I7e,Early_Dynastic_Cuneiform:A7e,Egyptian_Hieroglyphs:T7e,Elbasan:w7e,Emoticons:L7e,Enclosed_Alphanumeric_Supplement:O7e,Enclosed_Alphanumerics:P7e,Enclosed_CJK_Letters_And_Months:M7e,Enclosed_Ideographic_Supplement:N7e,Ethiopic:x7e,Ethiopic_Extended:F7e,Ethiopic_Extended_A:$7e,Ethiopic_Supplement:k7e,General_Punctuation:B7e,Geometric_Shapes:U7e,Geometric_Shapes_Extended:V7e,Georgian:H7e,Georgian_Extended:j7e,Georgian_Supplement:z7e,Glagolitic:W7e,Glagolitic_Supplement:Y7e,Gothic:X7e,Grantha:q7e,Greek_And_Coptic:G7e,Greek_Extended:K7e,Gujarati:Z7e,Gunjala_Gondi:Q7e,Gurmukhi:J7e,Halfwidth_And_Fullwidth_Forms:ehe,Hangul_Compatibility_Jamo:the,Hangul_Jamo:nhe,Hangul_Jamo_Extended_A:rhe,Hangul_Jamo_Extended_B:ihe,Hangul_Syllables:ohe,Hanifi_Rohingya:ahe,Hanunoo:she,Hatran:uhe,Hebrew:lhe,High_Private_Use_Surrogates:che,High_Surrogates:dhe,Hiragana:mhe,IPA_Extensions:fhe,Ideographic_Description_Characters:hhe,Ideographic_Symbols_And_Punctuation:phe,Imperial_Aramaic:ghe,Indic_Siyaq_Numbers:vhe,Inscriptional_Pahlavi:bhe,Inscriptional_Parthian:_he,Javanese:Che,Kaithi:She,Kana_Extended_A:Ehe,Kana_Supplement:yhe,Kanbun:Dhe,Kangxi_Radicals:Rhe,Kannada:Ihe,Katakana:Ahe,Katakana_Phonetic_Extensions:The,Kayah_Li:whe,Kharoshthi:Lhe,Khmer:Ohe,Khmer_Symbols:Phe,Khojki:Mhe,Khudawadi:Nhe,Lao:xhe,Latin_1_Supplement:Fhe,Latin_Extended_A:$he,Latin_Extended_Additional:khe,Latin_Extended_B:Bhe,Latin_Extended_C:Uhe,Latin_Extended_D:Vhe,Latin_Extended_E:Hhe,Lepcha:jhe,Letterlike_Symbols:zhe,Limbu:Whe,Linear_A:Yhe,Linear_B_Ideograms:Xhe,Linear_B_Syllabary:qhe,Lisu:Ghe,Low_Surrogates:Khe,Lycian:Zhe,Lydian:Qhe,Mahajani:Jhe,Mahjong_Tiles:e9e,Makasar:t9e,Malayalam:n9e,Mandaic:r9e,Manichaean:i9e,Marchen:o9e,Masaram_Gondi:a9e,Mathematical_Alphanumeric_Symbols:s9e,Mathematical_Operators:u9e,Mayan_Numerals:l9e,Medefaidrin:c9e,Meetei_Mayek:d9e,Meetei_Mayek_Extensions:m9e,Mende_Kikakui:f9e,Meroitic_Cursive:h9e,Meroitic_Hieroglyphs:p9e,Miao:g9e,Miscellaneous_Mathematical_Symbols_A:v9e,Miscellaneous_Mathematical_Symbols_B:b9e,Miscellaneous_Symbols:_9e,Miscellaneous_Symbols_And_Arrows:C9e,Miscellaneous_Symbols_And_Pictographs:S9e,Miscellaneous_Technical:E9e,Modi:y9e,Modifier_Tone_Letters:D9e,Mongolian:R9e,Mongolian_Supplement:I9e,Mro:A9e,Multani:T9e,Musical_Symbols:w9e,Myanmar:L9e,Myanmar_Extended_A:O9e,Myanmar_Extended_B:P9e,NKo:M9e,Nabataean:N9e,New_Tai_Lue:x9e,Newa:F9e,Number_Forms:$9e,Nushu:k9e,Ogham:B9e,Ol_Chiki:U9e,Old_Hungarian:V9e,Old_Italic:H9e,Old_North_Arabian:j9e,Old_Permic:z9e,Old_Persian:W9e,Old_Sogdian:Y9e,Old_South_Arabian:X9e,Old_Turkic:q9e,Optical_Character_Recognition:G9e,Oriya:K9e,Ornamental_Dingbats:Z9e,Osage:Q9e,Osmanya:J9e,Pahawh_Hmong:e5e,Palmyrene:t5e,Pau_Cin_Hau:n5e,Phags_Pa:r5e,Phaistos_Disc:i5e,Phoenician:o5e,Phonetic_Extensions:a5e,Phonetic_Extensions_Supplement:s5e,Playing_Cards:u5e,Private_Use_Area:l5e,Psalter_Pahlavi:c5e,Rejang:d5e,Rumi_Numeral_Symbols:m5e,Runic:f5e,Samaritan:h5e,Saurashtra:p5e,Sharada:g5e,Shavian:v5e,Shorthand_Format_Controls:b5e,Siddham:_5e,Sinhala:C5e,Sinhala_Archaic_Numbers:S5e,Small_Form_Variants:E5e,Sogdian:y5e,Sora_Sompeng:D5e,Soyombo:R5e,Spacing_Modifier_Letters:I5e,Specials:A5e,Sundanese:T5e,Sundanese_Supplement:w5e,Superscripts_And_Subscripts:L5e,Supplemental_Arrows_A:O5e,Supplemental_Arrows_B:P5e,Supplemental_Arrows_C:M5e,Supplemental_Mathematical_Operators:N5e,Supplemental_Punctuation:x5e,Supplemental_Symbols_And_Pictographs:F5e,Supplementary_Private_Use_Area_A:$5e,Supplementary_Private_Use_Area_B:k5e,Sutton_SignWriting:B5e,Syloti_Nagri:U5e,Syriac:V5e,Syriac_Supplement:H5e,Tagalog:j5e,Tagbanwa:z5e,Tags:W5e,Tai_Le:Y5e,Tai_Tham:X5e,Tai_Viet:q5e,Tai_Xuan_Jing_Symbols:G5e,Takri:K5e,Tamil:Z5e,Tangut:Q5e,Tangut_Components:J5e,Telugu:e8e,Thaana:t8e,Thai:n8e,Tibetan:r8e,Tifinagh:i8e,Tirhuta:o8e,Transport_And_Map_Symbols:a8e,Ugaritic:s8e,Unified_Canadian_Aboriginal_Syllabics:u8e,Unified_Canadian_Aboriginal_Syllabics_Extended:l8e,Vai:c8e,Variation_Selectors:d8e,Variation_Selectors_Supplement:m8e,Vedic_Extensions:f8e,Vertical_Forms:h8e,Warang_Citi:p8e,Yi_Radicals:g8e,Yi_Syllables:v8e,Yijing_Hexagram_Symbols:b8e,Zanabazar_Square:_8e,undefined:C8e},Symbol.toStringTag,{value:"Module"})),E8e=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),y8e=[41,93,125,3899,3901,5788,8262,8318,8334,8969,8971,9002,10089,10091,10093,10095,10097,10099,10101,10182,10215,10217,10219,10221,10223,10628,10630,10632,10634,10636,10638,10640,10642,10644,10646,10648,10713,10715,10749,11811,11813,11815,11817,11862,11864,11866,11868,12297,12299,12301,12303,12305,12309,12311,12313,12315,65114,65116,65118,65289,65341,65373,65376,65379],D8e=[[0,39],[42,90],92,[94,122],124,[126,3897],[3902,5786],[5789,8260],[8263,8316],[8319,8332],[8335,8967],[8972,9e3],[9003,10087],[10102,10180],[10183,10213],[10224,10626],[10649,10711],[10716,10747],[10750,11809],[11818,11860],[11869,12295],[12306,12307],[12316,65112],[65119,65287],[65290,65338],65340,[65342,65370],65372,65374,65377,[65380,1114111]],R8e=[40,91,123,3898,3900,5787,8261,8317,8333,8968,8970,9001,10088,10090,10092,10094,10096,10098,10100,10181,10214,10216,10218,10220,10222,10627,10629,10631,10633,10635,10637,10639,10641,10643,10645,10647,10712,10714,10748,11810,11812,11814,11816,11861,11863,11865,11867,12296,12298,12300,12302,12304,12308,12310,12312,12314,65113,65115,65117,65288,65339,65371,65375,65378],I8e=Object.freeze(Object.defineProperty({__proto__:null,Close:y8e,None:D8e,Open:R8e},Symbol.toStringTag,{value:"Module"})),A8e=[35,38,42,[60,62],[64,90],[94,122],126,166,169,172,[174,175],181,[192,214],[216,246],[248,710],[718,719],[721,727],732,734,[736,767],[880,887],[890,893],895,[900,906],908,[910,929],[931,1154],[1162,1327],[1329,1366],[1369,1416],[1421,1422],1472,1475,[1523,1524],[1536,1544],[1550,1551],[1568,1610],[1645,1647],[1649,1747],1749,[1757,1758],[1765,1766],1769,[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],1969,[1994,2026],[2036,2039],2042,[2048,2069],2074,2084,2088,[2096,2110],[2112,2136],2142,[2144,2154],[2160,2190],[2192,2193],[2208,2249],2274,[2308,2361],2365,2384,[2392,2401],[2416,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],[2548,2552],2554,[2556,2557],[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],2678,[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2800,2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],[2928,2935],2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3056,3064],3066,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],[3192,3200],[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,[3406,3407],[3412,3414],[3416,3425],[3440,3448],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3572,3663,3840,3845,3859,[3861,3863],[3866,3871],[3882,3891],3894,3896,[3904,3911],[3913,3948],[3976,3980],[4032,4037],[4039,4044],[4046,4047],[4052,4056],[4172,4175],[4256,4293],4295,4301,[4304,4351],[4608,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],4960,[4962,4988],[4992,5017],[5024,5109],[5112,5117],[5121,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],6105,[6128,6137],[6144,6145],6151,6154,[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],6464,[6624,6678],[6686,6687],[6917,6963],[6981,6988],7004,[7009,7018],[7028,7036],[7043,7072],[7086,7087],[7098,7141],[7164,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7367],7379,[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8132],[8134,8147],[8150,8155],[8157,8175],[8178,8180],[8182,8188],8190,8215,[8226,8227],8248,[8254,8259],[8266,8277],8284,[8289,8292],[8304,8305],[8309,8316],8320,[8325,8332],[8336,8348],[8448,8450],8452,[8454,8456],[8458,8466],[8468,8469],[8471,8480],[8483,8490],[8492,8531],[8534,8538],[8540,8541],8543,[8556,8559],[8570,8584],[8586,8587],[8602,8657],8659,[8661,8703],8705,[8708,8710],[8713,8714],[8716,8718],8720,8724,[8726,8729],[8731,8732],[8737,8738],8740,8742,8749,[8751,8755],[8760,8763],[8766,8775],[8777,8779],[8781,8785],[8787,8799],[8802,8803],[8808,8809],[8812,8813],[8816,8833],[8836,8837],[8840,8852],[8854,8856],[8858,8868],[8870,8894],[8896,8942],[8944,8967],[8972,8977],[8979,8985],[8988,9e3],[9003,9199],[9204,9254],[9280,9290],9471,[9548,9551],[9589,9599],[9616,9617],[9622,9631],9634,[9642,9649],[9652,9653],[9656,9659],[9662,9663],[9666,9669],[9673,9674],[9676,9677],[9682,9697],[9702,9710],[9712,9727],9732,[9735,9736],[9738,9741],[9744,9747],9753,[9760,9784],[9788,9791],9793,[9795,9823],9826,9830,9835,9838,[9840,9854],[9856,9885],[9888,9916],9934,9954,[9956,9959],[9989,9991],[9998,10070],[10072,10074],10081,[10085,10087],[10132,10180],[10183,10213],[10224,10626],[10649,10711],[10716,10747],[10750,11092],[11098,11123],[11126,11157],[11159,11502],[11506,11507],11517,[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],11798,[11802,11803],[11806,11807],11823,11826,[11829,11833],11839,11851,11853,[11856,11858],[19904,19967],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],42611,[42622,42653],[42656,42735],42738,[42752,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43048,43051],[43056,43063],43065,[43072,43123],[43138,43187],[43250,43259],[43261,43262],[43274,43301],[43312,43334],43359,[43396,43442],[43457,43462],[43466,43469],43471,[43486,43487],[43520,43560],[43584,43586],[43588,43595],43612,[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43883],[43888,44002],[64256,64262],[64275,64279],64297,[64336,64450],[64467,64829],[64832,64911],[64914,64967],64975,[65008,65019],[65021,65023],[65136,65140],[65142,65276],[65512,65518],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65799,65843],[65847,65934],[65936,65948],65952,[66e3,66044],[66176,66204],[66208,66256],[66273,66299],[66304,66339],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66927,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67672,67742],[67751,67759],[67808,67826],[67828,67829],[67835,67867],[67872,67897],67903,[67968,68023],[68028,68047],[68050,68096],[68112,68115],[68117,68119],[68121,68149],[68160,68168],68184,[68192,68255],[68288,68324],[68331,68335],[68352,68405],[68416,68437],[68440,68466],[68472,68497],[68505,68508],[68521,68527],[68608,68680],[68736,68786],[68800,68850],[68858,68899],[69216,69246],[69248,69289],[69296,69297],[69376,69415],[69424,69445],[69457,69465],[69488,69505],[69510,69513],[69552,69579],[69600,69622],[69635,69687],[69705,69709],[69714,69733],[69745,69746],69749,[69763,69807],[69819,69821],69837,[69840,69864],[69891,69926],69956,69959,[69968,70002],70004,70006,[70019,70066],[70081,70084],70087,70093,70106,70108,[70113,70132],[70144,70161],[70163,70187],70202,70205,[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],70735,70749,[70751,70753],[70784,70831],[70852,70855],[71040,71086],[71110,71112],[71128,71131],[71168,71215],[71235,71236],[71296,71338],[71352,71353],[71680,71723],71739,[71840,71903],[71914,71922],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72256,72262,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72794,72812],[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],[73463,73464],73474,[73476,73488],[73490,73523],73648,[73664,73692],[73697,73713],[73728,74649],[74752,74862],[74880,75075],[77712,77810],[77824,78423],[78430,78465],[78467,78469],[78474,78712],[78716,78895],[78913,78918],[82944,83405],[83408,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92986,92995],92997,[93019,93025],[93027,93047],[93053,93071],[93760,93846],[93849,93850],[93952,94026],94032,[94099,94111],[101120,101589],[110576,110579],[110581,110587],[110589,110590],[113664,113770],[113776,113788],[113792,113800],[113808,113817],113820,[118608,118723],[118784,119029],[119040,119078],[119081,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119274],[119296,119361],119365,[119488,119507],[119520,119539],[119552,119638],[119648,119672],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120779],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121478],121483,[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],[123214,123215],[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125127,125135],[125184,125251],125259,[126065,126123],[126125,126127],[126129,126132],[126209,126269],[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[126704,126705],[127278,127279],[127338,127340],[127900,127901],[127925,127926],127932,128160,128162,128164,128175,[128177,128178],[128256,128262],[128279,128292],[128306,128329],[128468,128475],[128500,128505],[128592,128629],[128636,128639],[128768,128883],[128896,128980],[129024,129035],[129040,129095],[129104,129113],[129120,129159],[129168,129197],[129280,129291],[129536,129619],[129792,129938],[129940,129994]],T8e=[[167,168],170,[178,179],[182,186],[188,190],215,247,711,[713,715],717,720,[728,731],733,[8213,8214],[8224,8225],8251,8308,8319,[8321,8324],8453,8467,[8481,8482],8491,[8532,8533],8539,8542,[8544,8555],[8560,8569],8585,[8592,8601],8658,8660,8704,[8706,8707],[8711,8712],8715,8719,8721,8725,8730,[8733,8736],8739,8741,[8743,8748],8750,[8756,8759],[8764,8765],8776,8780,8786,[8800,8801],[8804,8807],[8810,8811],[8814,8815],[8834,8835],[8838,8839],8853,8857,8869,8895,8978,[9312,9470],[9472,9547],[9552,9588],[9600,9615],[9618,9621],[9632,9633],[9635,9641],[9650,9651],[9654,9655],[9660,9661],[9664,9665],[9670,9672],9675,[9678,9681],[9698,9701],9711,[9733,9734],9737,[9742,9743],[9750,9751],9792,9794,[9824,9825],[9827,9829],9831,[9833,9834],[9836,9837],9839,[9886,9887],[9929,9932],9938,[9941,9943],[9946,9947],[9949,9950],9955,[9960,9961],[9963,9968],9974,[9979,9980],10071,[10102,10131],[11093,11097],[12872,12879],65533,[127232,127244],[127248,127277],[127280,127337],[127344,127404]],w8e=[9,124,173,1418,1470,[2404,2405],[3674,3675],3851,3892,3967,3973,[4030,4031],4050,[4170,4171],4961,5120,5760,[5867,5869],[5941,5942],[6100,6101],6104,6106,[6148,6149],[7002,7003],[7005,7008],[7037,7038],[7227,7231],[7294,7295],[8192,8198],[8200,8202],8208,[8210,8211],8231,8278,[8280,8283],[8285,8287],[11514,11516],11519,11632,[11790,11797],11799,11801,[11818,11821],[11824,11825],[11827,11828],[11836,11838],[11840,11841],[11843,11850],11852,[11854,11855],11869,12288,[42238,42239],42509,42511,[42739,42743],[43214,43215],[43310,43311],[43463,43465],[43613,43615],[43760,43761],44011,[65792,65794],66463,66512,67671,67871,[68176,68183],[68336,68341],[68409,68415],69293,[69703,69704],[69822,69825],[69952,69955],[70085,70086],70088,[70109,70111],[70200,70201],[70203,70204],70313,[70731,70734],[70746,70747],[71106,71107],[71113,71127],[71233,71234],[71484,71486],[72004,72006],[72257,72260],[72346,72348],[72353,72354],[72769,72773],[73539,73540],73727,[74864,74868],[92782,92783],92917,[92983,92985],92996,[93847,93848],113823,[121479,121482]],L8e=[180,712,716,735,3191,3204,[3841,3844],[3846,3847],[3849,3850],[4048,4049],4051,6150,8189,[43124,43125],43260,70005,70107,71105,[71264,71276],72162,72255,72261,[72350,72352],[72448,72457],72816],O8e=[8212,[11834,11835]],P8e=[47],M8e=[13],N8e=[41,93],x8e=[125,3899,3901,5788,8262,8318,8334,8969,8971,9002,10089,10091,10093,10095,10097,10099,10101,10182,10215,10217,10219,10221,10223,10628,10630,10632,10634,10636,10638,10640,10642,10644,10646,10648,10713,10715,10749,11811,11813,11815,11817,11862,11864,11866,11868,[12289,12290],12297,12299,12301,12303,12305,12309,12311,12313,12315,[12318,12319],64830,[65041,65042],65048,65078,65080,65082,65084,65086,65088,65090,65092,65096,65104,65106,65114,65116,65118,65289,65292,65294,65341,65373,[65376,65377],[65379,65380],[78427,78429],78466,78471,78473,[78714,78715],78904,78909,78911,83407],F8e=[[0,8],[14,31],[127,132],[134,159],[768,846],[848,859],[867,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],1564,[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2307],[2362,2364],[2366,2383],[2385,2391],[2402,2403],[2433,2435],2492,[2494,2500],[2503,2504],[2507,2509],2519,[2530,2531],2558,[2561,2563],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2691],2748,[2750,2757],[2759,2761],[2763,2765],[2786,2787],[2810,2815],[2817,2819],2876,[2878,2884],[2887,2888],[2891,2893],[2901,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3021],3031,[3072,3076],3132,[3134,3140],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3203],3260,[3262,3268],[3270,3272],[3274,3277],[3285,3286],[3298,3299],3315,[3328,3331],[3387,3388],[3390,3396],[3398,3400],[3402,3405],3415,[3426,3427],[3457,3459],3530,[3535,3540],3542,[3544,3551],[3570,3571],[3864,3865],3893,3895,3897,[3902,3903],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4957,4959],[5906,5909],[5938,5940],[5970,5971],[6002,6003],[6155,6157],6159,[6277,6278],6313,[6432,6443],[6448,6459],[6679,6683],6783,[6832,6862],[6912,6916],[6964,6980],[7019,7027],[7040,7042],[7073,7085],[7142,7155],[7204,7223],[7376,7378],[7380,7400],7405,7412,[7415,7417],[7616,7628],[7630,7675],[7677,7679],8204,[8206,8207],[8234,8238],[8294,8303],[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],12341,[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43043,43047],43052,[43136,43137],[43188,43205],[43232,43249],43263,[43302,43309],[43335,43347],[43392,43395],[43443,43456],[43561,43574],43587,[43596,43597],[43755,43759],[43765,43766],[44003,44010],[44012,44013],64286,[65024,65039],[65056,65071],[65529,65531],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],[69632,69634],[69688,69702],69744,[69747,69748],[69759,69762],[69808,69818],69826,[69888,69890],[69927,69940],[69957,69958],70003,[70016,70018],[70067,70080],[70089,70092],[70094,70095],[70188,70199],70206,70209,[70367,70378],[70400,70403],[70459,70460],[70462,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70502,70508],[70512,70516],[70709,70726],70750,[70832,70851],[71087,71093],[71096,71104],[71132,71133],[71216,71232],[71339,71351],[71724,71738],[71984,71989],[71991,71992],[71995,71998],72e3,[72002,72003],[72145,72151],[72154,72160],72164,[72193,72202],[72243,72249],[72251,72254],72263,[72273,72283],[72330,72345],[72751,72758],[72760,72767],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73098,73102],[73104,73105],[73107,73111],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73538],78912,[78919,78933],[92912,92916],[92976,92982],94031,[94033,94087],[94095,94098],[94192,94193],[113821,113822],[113824,113827],[118528,118573],[118576,118598],[119141,119145],[119149,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],917505,[917536,917631],[917760,917999]],$8e=[[3585,3642],[3648,3662],[3713,3714],3716,[3718,3722],[3724,3747],3749,[3751,3773],[3776,3780],3782,[3784,3790],[3804,3807],[4096,4159],[4176,4239],[4250,4255],[6016,6099],6103,[6108,6109],[6480,6509],[6512,6516],[6528,6571],[6576,6601],6618,[6622,6623],[6688,6750],[6752,6780],[6816,6829],[43488,43503],[43514,43518],[43616,43714],[43739,43743],[71424,71450],[71453,71467],[71482,71483],[71487,71494]],k8e=[12353,12355,12357,12359,12361,12387,12419,12421,12423,12430,[12437,12438],12449,12451,12453,12455,12457,12483,12515,12517,12519,12526,[12533,12534],12540,[12784,12799],[65383,65392],110898,[110928,110930],110933,[110948,110951]],B8e=[65532],U8e=[9757,9977,[9994,9997],127877,[127938,127940],127943,[127946,127948],[128066,128067],[128070,128080],[128102,128120],128124,[128129,128131],[128133,128135],128143,128145,128170,[128372,128373],128378,128400,[128405,128406],[128581,128583],[128587,128591],128675,[128692,128694],128704,128716,129292,129295,[129304,129311],129318,[129328,129337],[129340,129342],129399,[129461,129462],[129464,129465],129467,[129485,129487],[129489,129501],[129731,129733],[129776,129784]],V8e=[[127995,127999]],H8e=[33,63,1478,1563,[1565,1567],1748,2041,[3853,3857],3860,[6146,6147],[6152,6153],[6468,6469],[10082,10083],11513,11518,11822,[11859,11860],42510,[43126,43127],[65045,65046],[65110,65111],65281,65311,[71108,71109],72817],j8e=[160,847,[860,866],3848,3852,3858,[4057,4058],6158,7629,7676,8199,8209,8239,[78896,78902],[78905,78907],94180],z8e=[44032,44060,44088,44116,44144,44172,44200,44228,44256,44284,44312,44340,44368,44396,44424,44452,44480,44508,44536,44564,44592,44620,44648,44676,44704,44732,44760,44788,44816,44844,44872,44900,44928,44956,44984,45012,45040,45068,45096,45124,45152,45180,45208,45236,45264,45292,45320,45348,45376,45404,45432,45460,45488,45516,45544,45572,45600,45628,45656,45684,45712,45740,45768,45796,45824,45852,45880,45908,45936,45964,45992,46020,46048,46076,46104,46132,46160,46188,46216,46244,46272,46300,46328,46356,46384,46412,46440,46468,46496,46524,46552,46580,46608,46636,46664,46692,46720,46748,46776,46804,46832,46860,46888,46916,46944,46972,47e3,47028,47056,47084,47112,47140,47168,47196,47224,47252,47280,47308,47336,47364,47392,47420,47448,47476,47504,47532,47560,47588,47616,47644,47672,47700,47728,47756,47784,47812,47840,47868,47896,47924,47952,47980,48008,48036,48064,48092,48120,48148,48176,48204,48232,48260,48288,48316,48344,48372,48400,48428,48456,48484,48512,48540,48568,48596,48624,48652,48680,48708,48736,48764,48792,48820,48848,48876,48904,48932,48960,48988,49016,49044,49072,49100,49128,49156,49184,49212,49240,49268,49296,49324,49352,49380,49408,49436,49464,49492,49520,49548,49576,49604,49632,49660,49688,49716,49744,49772,49800,49828,49856,49884,49912,49940,49968,49996,50024,50052,50080,50108,50136,50164,50192,50220,50248,50276,50304,50332,50360,50388,50416,50444,50472,50500,50528,50556,50584,50612,50640,50668,50696,50724,50752,50780,50808,50836,50864,50892,50920,50948,50976,51004,51032,51060,51088,51116,51144,51172,51200,51228,51256,51284,51312,51340,51368,51396,51424,51452,51480,51508,51536,51564,51592,51620,51648,51676,51704,51732,51760,51788,51816,51844,51872,51900,51928,51956,51984,52012,52040,52068,52096,52124,52152,52180,52208,52236,52264,52292,52320,52348,52376,52404,52432,52460,52488,52516,52544,52572,52600,52628,52656,52684,52712,52740,52768,52796,52824,52852,52880,52908,52936,52964,52992,53020,53048,53076,53104,53132,53160,53188,53216,53244,53272,53300,53328,53356,53384,53412,53440,53468,53496,53524,53552,53580,53608,53636,53664,53692,53720,53748,53776,53804,53832,53860,53888,53916,53944,53972,54e3,54028,54056,54084,54112,54140,54168,54196,54224,54252,54280,54308,54336,54364,54392,54420,54448,54476,54504,54532,54560,54588,54616,54644,54672,54700,54728,54756,54784,54812,54840,54868,54896,54924,54952,54980,55008,55036,55064,55092,55120,55148,55176],W8e=[[44033,44059],[44061,44087],[44089,44115],[44117,44143],[44145,44171],[44173,44199],[44201,44227],[44229,44255],[44257,44283],[44285,44311],[44313,44339],[44341,44367],[44369,44395],[44397,44423],[44425,44451],[44453,44479],[44481,44507],[44509,44535],[44537,44563],[44565,44591],[44593,44619],[44621,44647],[44649,44675],[44677,44703],[44705,44731],[44733,44759],[44761,44787],[44789,44815],[44817,44843],[44845,44871],[44873,44899],[44901,44927],[44929,44955],[44957,44983],[44985,45011],[45013,45039],[45041,45067],[45069,45095],[45097,45123],[45125,45151],[45153,45179],[45181,45207],[45209,45235],[45237,45263],[45265,45291],[45293,45319],[45321,45347],[45349,45375],[45377,45403],[45405,45431],[45433,45459],[45461,45487],[45489,45515],[45517,45543],[45545,45571],[45573,45599],[45601,45627],[45629,45655],[45657,45683],[45685,45711],[45713,45739],[45741,45767],[45769,45795],[45797,45823],[45825,45851],[45853,45879],[45881,45907],[45909,45935],[45937,45963],[45965,45991],[45993,46019],[46021,46047],[46049,46075],[46077,46103],[46105,46131],[46133,46159],[46161,46187],[46189,46215],[46217,46243],[46245,46271],[46273,46299],[46301,46327],[46329,46355],[46357,46383],[46385,46411],[46413,46439],[46441,46467],[46469,46495],[46497,46523],[46525,46551],[46553,46579],[46581,46607],[46609,46635],[46637,46663],[46665,46691],[46693,46719],[46721,46747],[46749,46775],[46777,46803],[46805,46831],[46833,46859],[46861,46887],[46889,46915],[46917,46943],[46945,46971],[46973,46999],[47001,47027],[47029,47055],[47057,47083],[47085,47111],[47113,47139],[47141,47167],[47169,47195],[47197,47223],[47225,47251],[47253,47279],[47281,47307],[47309,47335],[47337,47363],[47365,47391],[47393,47419],[47421,47447],[47449,47475],[47477,47503],[47505,47531],[47533,47559],[47561,47587],[47589,47615],[47617,47643],[47645,47671],[47673,47699],[47701,47727],[47729,47755],[47757,47783],[47785,47811],[47813,47839],[47841,47867],[47869,47895],[47897,47923],[47925,47951],[47953,47979],[47981,48007],[48009,48035],[48037,48063],[48065,48091],[48093,48119],[48121,48147],[48149,48175],[48177,48203],[48205,48231],[48233,48259],[48261,48287],[48289,48315],[48317,48343],[48345,48371],[48373,48399],[48401,48427],[48429,48455],[48457,48483],[48485,48511],[48513,48539],[48541,48567],[48569,48595],[48597,48623],[48625,48651],[48653,48679],[48681,48707],[48709,48735],[48737,48763],[48765,48791],[48793,48819],[48821,48847],[48849,48875],[48877,48903],[48905,48931],[48933,48959],[48961,48987],[48989,49015],[49017,49043],[49045,49071],[49073,49099],[49101,49127],[49129,49155],[49157,49183],[49185,49211],[49213,49239],[49241,49267],[49269,49295],[49297,49323],[49325,49351],[49353,49379],[49381,49407],[49409,49435],[49437,49463],[49465,49491],[49493,49519],[49521,49547],[49549,49575],[49577,49603],[49605,49631],[49633,49659],[49661,49687],[49689,49715],[49717,49743],[49745,49771],[49773,49799],[49801,49827],[49829,49855],[49857,49883],[49885,49911],[49913,49939],[49941,49967],[49969,49995],[49997,50023],[50025,50051],[50053,50079],[50081,50107],[50109,50135],[50137,50163],[50165,50191],[50193,50219],[50221,50247],[50249,50275],[50277,50303],[50305,50331],[50333,50359],[50361,50387],[50389,50415],[50417,50443],[50445,50471],[50473,50499],[50501,50527],[50529,50555],[50557,50583],[50585,50611],[50613,50639],[50641,50667],[50669,50695],[50697,50723],[50725,50751],[50753,50779],[50781,50807],[50809,50835],[50837,50863],[50865,50891],[50893,50919],[50921,50947],[50949,50975],[50977,51003],[51005,51031],[51033,51059],[51061,51087],[51089,51115],[51117,51143],[51145,51171],[51173,51199],[51201,51227],[51229,51255],[51257,51283],[51285,51311],[51313,51339],[51341,51367],[51369,51395],[51397,51423],[51425,51451],[51453,51479],[51481,51507],[51509,51535],[51537,51563],[51565,51591],[51593,51619],[51621,51647],[51649,51675],[51677,51703],[51705,51731],[51733,51759],[51761,51787],[51789,51815],[51817,51843],[51845,51871],[51873,51899],[51901,51927],[51929,51955],[51957,51983],[51985,52011],[52013,52039],[52041,52067],[52069,52095],[52097,52123],[52125,52151],[52153,52179],[52181,52207],[52209,52235],[52237,52263],[52265,52291],[52293,52319],[52321,52347],[52349,52375],[52377,52403],[52405,52431],[52433,52459],[52461,52487],[52489,52515],[52517,52543],[52545,52571],[52573,52599],[52601,52627],[52629,52655],[52657,52683],[52685,52711],[52713,52739],[52741,52767],[52769,52795],[52797,52823],[52825,52851],[52853,52879],[52881,52907],[52909,52935],[52937,52963],[52965,52991],[52993,53019],[53021,53047],[53049,53075],[53077,53103],[53105,53131],[53133,53159],[53161,53187],[53189,53215],[53217,53243],[53245,53271],[53273,53299],[53301,53327],[53329,53355],[53357,53383],[53385,53411],[53413,53439],[53441,53467],[53469,53495],[53497,53523],[53525,53551],[53553,53579],[53581,53607],[53609,53635],[53637,53663],[53665,53691],[53693,53719],[53721,53747],[53749,53775],[53777,53803],[53805,53831],[53833,53859],[53861,53887],[53889,53915],[53917,53943],[53945,53971],[53973,53999],[54001,54027],[54029,54055],[54057,54083],[54085,54111],[54113,54139],[54141,54167],[54169,54195],[54197,54223],[54225,54251],[54253,54279],[54281,54307],[54309,54335],[54337,54363],[54365,54391],[54393,54419],[54421,54447],[54449,54475],[54477,54503],[54505,54531],[54533,54559],[54561,54587],[54589,54615],[54617,54643],[54645,54671],[54673,54699],[54701,54727],[54729,54755],[54757,54783],[54785,54811],[54813,54839],[54841,54867],[54869,54895],[54897,54923],[54925,54951],[54953,54979],[54981,55007],[55009,55035],[55037,55063],[55065,55091],[55093,55119],[55121,55147],[55149,55175],[55177,55203]],Y8e=[[1488,1514],[1519,1522],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],X8e=[45],q8e=[[8986,8987],[9200,9203],[9728,9731],[9748,9749],9752,[9754,9756],[9758,9759],[9785,9787],9832,9855,[9917,9928],9933,[9935,9937],[9939,9940],[9944,9945],9948,[9951,9953],9962,[9969,9973],[9975,9976],9978,[9981,9988],[9992,9993],10084,[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12291,12292],[12294,12295],[12306,12307],[12320,12329],[12336,12340],[12342,12346],[12349,12351],12354,12356,12358,12360,[12362,12386],[12388,12418],12420,12422,[12424,12429],[12431,12436],12447,12450,12452,12454,12456,[12458,12482],[12484,12514],12516,12518,[12520,12525],[12527,12532],[12535,12538],12543,[12549,12591],[12593,12686],[12688,12771],[12800,12830],[12832,12871],[12880,19903],[19968,40980],[40982,42124],[42128,42182],[63744,64255],[65072,65076],[65093,65094],[65097,65103],65105,65112,[65119,65126],65128,65131,[65282,65283],[65286,65287],[65290,65291],65293,[65295,65305],[65308,65310],[65312,65338],65340,[65342,65370],65372,65374,65382,[65393,65437],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65506,65508],[73541,73551],[94208,100343],[100352,101119],[101632,101640],[110592,110882],[110960,111355],[126976,127231],[127245,127247],[127341,127343],[127405,127461],[127488,127876],[127878,127899],[127902,127924],[127927,127931],[127933,127937],[127941,127942],[127944,127945],[127949,127994],[128e3,128065],[128068,128069],[128081,128101],[128121,128123],[128125,128128],128132,[128136,128142],128144,[128146,128159],128161,128163,[128165,128169],[128171,128174],128176,[128179,128255],[128263,128278],[128293,128305],[128330,128371],[128374,128377],[128379,128399],[128401,128404],[128407,128467],[128476,128499],[128506,128580],[128584,128586],[128640,128674],[128676,128691],[128695,128703],[128705,128715],[128717,128767],[128884,128895],[128981,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129279],[129293,129294],[129296,129303],[129312,129317],[129319,129327],[129338,129339],[129343,129398],[129400,129460],129463,129466,[129468,129484],129488,[129502,129535],[129620,129730],[129734,129775],[129785,129791],[130048,131069],[131072,196605],[196608,262141]],G8e=[44,46,[58,59],894,1417,[1548,1549],2040,8260,65040,[65043,65044]],K8e=[[8228,8230],8943,65049,68342],Z8e=[[4352,4447],[43360,43388]],Q8e=[[4520,4607],[55243,55291]],J8e=[[4448,4519],[55216,55238]],epe=[10],tpe=[[11,12],[8232,8233]],npe=[133],rpe=[6102,[8252,8253],[8263,8265],12293,12316,[12347,12348],[12443,12446],12448,12539,[12541,12542],40981,[65108,65109],[65306,65307],65381,[65438,65439],[94176,94179],[128633,128635]],ipe=[[48,57],[1632,1641],[1643,1644],[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[66720,66729],[68912,68921],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72016,72025],[72784,72793],[73040,73049],[73120,73129],[73552,73561],[92768,92777],[92864,92873],[93008,93017],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125264,125273],[130032,130041]],ope=[40,91,123,161,191,3898,3900,5787,8218,8222,8261,8317,8333,8968,8970,9001,10088,10090,10092,10094,10096,10098,10100,10181,10214,10216,10218,10220,10222,10627,10629,10631,10633,10635,10637,10639,10641,10643,10645,10647,10712,10714,10748,11800,11810,11812,11814,11816,11842,11861,11863,11865,11867,12296,12298,12300,12302,12304,12308,12310,12312,12314,12317,64831,65047,65077,65079,65081,65083,65085,65087,65089,65091,65095,65113,65115,65117,65288,65339,65371,65375,65378,[78424,78426],78470,78472,78713,78903,78908,78910,83406,[125278,125279]],ape=[37,162,176,[1545,1547],1642,[2546,2547],2553,3449,[8240,8247],8279,8359,8374,8379,8382,8384,8451,8457,43064,65020,65130,65285,65504,[73693,73696],126124,126128],spe=[36,43,92,[163,165],177,1423,[2046,2047],2555,2801,3065,3647,6107,[8352,8358],[8360,8373],[8375,8378],[8380,8381],8383,[8385,8399],8470,[8722,8723],65129,65284,65505,[65509,65510],123647],upe=[34,39,171,187,[8216,8217],[8219,8221],8223,[8249,8250],[10075,10080],[11776,11789],[11804,11805],[11808,11809],[128630,128632]],lpe=[[127462,127487]],cpe=[32],dpe=[[55296,57343]],mpe=[[888,889],[896,899],907,909,930,1328,[1367,1368],[1419,1420],1424,[1480,1487],[1515,1518],[1525,1535],1806,[1867,1868],[1970,1983],[2043,2044],[2094,2095],2111,[2140,2141],2143,[2155,2159],2191,[2194,2199],2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2679,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2802,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],[2936,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3067,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3190],3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3408,3411],[3428,3429],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3573,3584],[3643,3646],[3676,3712],3715,3717,3723,3748,3750,[3774,3775],3781,3783,3791,[3802,3803],[3808,3839],3912,[3949,3952],3992,4029,4045,[4059,4095],4294,[4296,4300],[4302,4303],4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4989,4991],[5018,5023],[5110,5111],[5118,5119],[5789,5791],[5881,5887],[5910,5918],[5943,5951],[5972,5983],5997,6001,[6004,6015],[6110,6111],[6122,6127],[6138,6143],[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6463],[6465,6467],[6510,6511],[6517,6527],[6572,6575],[6602,6607],[6619,6621],[6684,6685],6751,[6781,6782],[6794,6799],[6810,6815],[6830,6831],[6863,6911],[6989,6991],7039,[7156,7163],[7224,7226],[7242,7244],[7305,7311],[7355,7356],[7368,7375],[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8133,[8148,8149],8156,[8176,8177],8181,8191,8293,[8306,8307],8335,[8349,8351],[8433,8447],[8588,8591],[9255,9279],[9291,9311],[11124,11125],11158,[11508,11512],11558,[11560,11564],[11566,11567],[11624,11630],[11633,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11870,11903],11930,[12020,12031],[12246,12271],[12284,12287],12352,[12439,12440],[12544,12548],12592,12687,[12772,12783],12831,[42125,42127],[42183,42191],[42540,42559],[42744,42751],[42955,42959],42962,42964,[42970,42993],[43053,43055],[43066,43071],[43128,43135],[43206,43213],[43226,43231],[43348,43358],[43389,43391],43470,[43482,43485],43519,[43575,43583],[43598,43599],[43610,43611],[43715,43738],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43884,43887],[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,55295],[57344,63743],[64263,64274],[64280,64284],64311,64317,64319,64322,64325,[64451,64466],[64912,64913],[64968,64974],[64976,65007],[65050,65055],65107,65127,[65132,65135],65141,[65277,65278],65280,[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65503],65511,[65519,65528],[65534,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65791],[65795,65798],[65844,65846],65935,[65949,65951],[65953,65999],[66046,66175],[66205,66207],[66257,66271],[66300,66303],[66340,66348],[66379,66383],[66427,66431],66462,[66500,66503],[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66926],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],67670,[67743,67750],[67760,67807],67827,[67830,67834],[67868,67870],[67898,67902],[67904,67967],[68024,68027],[68048,68049],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68169,68175],[68185,68191],[68256,68287],[68327,68330],[68343,68351],[68406,68408],[68438,68439],[68467,68471],[68498,68504],[68509,68520],[68528,68607],[68681,68735],[68787,68799],[68851,68857],[68904,68911],[68922,69215],69247,69290,[69294,69295],[69298,69372],[69416,69423],[69466,69487],[69514,69551],[69580,69599],[69623,69631],[69710,69713],[69750,69758],[69827,69836],[69838,69839],[69865,69871],[69882,69887],69941,[69960,69967],[70007,70015],70112,[70133,70143],70162,[70210,70271],70279,70281,70286,70302,[70314,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],70748,[70754,70783],[70856,70863],[70874,71039],[71094,71095],[71134,71167],[71237,71247],[71258,71263],[71277,71295],[71354,71359],[71370,71423],[71451,71452],[71468,71471],[71495,71679],[71740,71839],[71923,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72007,72015],[72026,72095],[72104,72105],[72152,72153],[72165,72191],[72264,72271],[72355,72367],[72441,72447],[72458,72703],72713,72759,[72774,72783],[72813,72815],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73465,73471],73489,[73531,73533],[73562,73647],[73649,73663],[73714,73726],[74650,74751],74863,[74869,74879],[75076,77711],[77811,77823],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92781],92863,[92874,92879],[92910,92911],[92918,92927],[92998,93007],93018,93026,[93048,93052],[93072,93759],[93851,93951],[94027,94030],[94088,94094],[94112,94175],[94181,94191],[94194,94207],[100344,100351],[101590,101631],[101641,110575],110580,110588,110591,[110883,110897],[110899,110927],[110931,110932],[110934,110947],[110952,110959],[111356,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113819],[113828,118527],[118574,118575],[118599,118607],[118724,118783],[119030,119039],[119079,119080],[119275,119295],[119366,119487],[119508,119519],[119540,119551],[119639,119647],[119673,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],[120780,120781],[121484,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123216,123535],[123567,123583],[123642,123646],[123648,124111],[124154,124895],124903,124908,124911,124927,[125125,125126],[125143,125183],[125260,125263],[125274,125277],[125280,126064],[126133,126208],[126270,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,126703],[126706,126975],[131070,131071],[196606,196607],[262142,917504],[917506,917535],[917632,917759],[918e3,1114111]],fpe=[8288,65279],hpe=[8205],ppe=[8203],gpe=Object.freeze(Object.defineProperty({__proto__:null,Alphabetic:A8e,Ambiguous:T8e,Break_After:w8e,Break_Before:L8e,Break_Both:O8e,Break_Symbols:P8e,Carriage_Return:M8e,Close_Parenthesis:N8e,Close_Punctuation:x8e,Combining_Mark:F8e,Complex_Context:$8e,Conditional_Japanese_Starter:k8e,Contingent_Break:B8e,E_Base:U8e,E_Modifier:V8e,Exclamation:H8e,Glue:j8e,H2:z8e,H3:W8e,Hebrew_Letter:Y8e,Hyphen:X8e,Ideographic:q8e,Infix_Numeric:G8e,Inseparable:K8e,JL:Z8e,JT:Q8e,JV:J8e,Line_Feed:epe,Mandatory_Break:tpe,Next_Line:npe,Nonstarter:rpe,Numeric:ipe,Open_Punctuation:ope,Postfix_Numeric:ape,Prefix_Numeric:spe,Quotation:upe,Regional_Indicator:lpe,Space:cpe,Surrogate:dpe,Unknown:mpe,Word_Joiner:fpe,ZWJ:hpe,ZWSpace:ppe},Symbol.toStringTag,{value:"Module"})),vpe=[[65,90],[97,122],170,181,186,[192,214],[216,246],[248,727],[734,767],[880,884],[886,887],[890,893],895,902,[904,906],908,[910,929],[931,1013],[1015,1153],[1162,1327],[1329,1366],[1369,1372],1374,[1376,1416],1418,1523,[1568,1610],[1646,1647],[1649,1747],1749,[1765,1766],[1774,1775],[1786,1788],1791,1808,[1810,1839],[1869,1957],1969,[1994,2026],[2036,2037],2042,[2048,2069],2074,2084,2088,[2112,2136],[2144,2154],[2160,2183],[2185,2190],[2208,2249],[2308,2361],2365,2384,[2392,2401],[2417,2432],[2437,2444],[2447,2448],[2451,2472],[2474,2480],2482,[2486,2489],2493,2510,[2524,2525],[2527,2529],[2544,2545],2556,[2565,2570],[2575,2576],[2579,2600],[2602,2608],[2610,2611],[2613,2614],[2616,2617],[2649,2652],2654,[2674,2676],[2693,2701],[2703,2705],[2707,2728],[2730,2736],[2738,2739],[2741,2745],2749,2768,[2784,2785],2809,[2821,2828],[2831,2832],[2835,2856],[2858,2864],[2866,2867],[2869,2873],2877,[2908,2909],[2911,2913],2929,2947,[2949,2954],[2958,2960],[2962,2965],[2969,2970],2972,[2974,2975],[2979,2980],[2984,2986],[2990,3001],3024,[3077,3084],[3086,3088],[3090,3112],[3114,3129],3133,[3160,3162],3165,[3168,3169],3200,[3205,3212],[3214,3216],[3218,3240],[3242,3251],[3253,3257],3261,[3293,3294],[3296,3297],[3313,3314],[3332,3340],[3342,3344],[3346,3386],3389,3406,[3412,3414],[3423,3425],[3450,3455],[3461,3478],[3482,3505],[3507,3515],3517,[3520,3526],3840,[3904,3911],[3913,3948],[3976,3980],[4256,4293],4295,4301,[4304,4346],[4348,4680],[4682,4685],[4688,4694],4696,[4698,4701],[4704,4744],[4746,4749],[4752,4784],[4786,4789],[4792,4798],4800,[4802,4805],[4808,4822],[4824,4880],[4882,4885],[4888,4954],[4992,5007],[5024,5109],[5112,5117],[5121,5740],[5743,5759],[5761,5786],[5792,5866],[5870,5880],[5888,5905],[5919,5937],[5952,5969],[5984,5996],[5998,6e3],[6176,6264],[6272,6276],[6279,6312],6314,[6320,6389],[6400,6430],[6656,6678],[6917,6963],[6981,6988],[7043,7072],[7086,7087],[7098,7141],[7168,7203],[7245,7247],[7258,7293],[7296,7304],[7312,7354],[7357,7359],[7401,7404],[7406,7411],[7413,7414],7418,[7424,7615],[7680,7957],[7960,7965],[7968,8005],[8008,8013],[8016,8023],8025,8027,8029,[8031,8061],[8064,8116],[8118,8124],8126,[8130,8132],[8134,8140],[8144,8147],[8150,8155],[8160,8172],[8178,8180],[8182,8188],8305,8319,[8336,8348],8450,8455,[8458,8467],8469,[8473,8477],8484,8486,8488,[8490,8493],[8495,8505],[8508,8511],[8517,8521],8526,[8544,8584],[9398,9449],[11264,11492],[11499,11502],[11506,11507],[11520,11557],11559,11565,[11568,11623],11631,[11648,11670],[11680,11686],[11688,11694],[11696,11702],[11704,11710],[11712,11718],[11720,11726],[11728,11734],[11736,11742],11823,12293,[12347,12348],[12549,12591],[12593,12686],[12704,12735],[40960,42124],[42192,42237],[42240,42508],[42512,42527],[42538,42539],[42560,42606],[42623,42653],[42656,42735],[42760,42954],[42960,42961],42963,[42965,42969],[42994,43009],[43011,43013],[43015,43018],[43020,43042],[43072,43123],[43138,43187],[43250,43255],43259,[43261,43262],[43274,43301],[43312,43334],[43360,43388],[43396,43442],43471,[43520,43560],[43584,43586],[43588,43595],[43744,43754],[43762,43764],[43777,43782],[43785,43790],[43793,43798],[43808,43814],[43816,43822],[43824,43881],[43888,44002],[44032,55203],[55216,55238],[55243,55291],[64256,64262],[64275,64279],[64336,64433],[64467,64829],[64848,64911],[64914,64967],[65008,65019],[65136,65140],[65142,65276],[65313,65338],[65345,65370],[65440,65470],[65474,65479],[65482,65487],[65490,65495],[65498,65500],[65536,65547],[65549,65574],[65576,65594],[65596,65597],[65599,65613],[65616,65629],[65664,65786],[65856,65908],[66176,66204],[66208,66256],[66304,66335],[66349,66378],[66384,66421],[66432,66461],[66464,66499],[66504,66511],[66513,66517],[66560,66717],[66736,66771],[66776,66811],[66816,66855],[66864,66915],[66928,66938],[66940,66954],[66956,66962],[66964,66965],[66967,66977],[66979,66993],[66995,67001],[67003,67004],[67072,67382],[67392,67413],[67424,67431],[67456,67461],[67463,67504],[67506,67514],[67584,67589],67592,[67594,67637],[67639,67640],67644,[67647,67669],[67680,67702],[67712,67742],[67808,67826],[67828,67829],[67840,67861],[67872,67897],[67968,68023],[68030,68031],68096,[68112,68115],[68117,68119],[68121,68149],[68192,68220],[68224,68252],[68288,68295],[68297,68324],[68352,68405],[68416,68437],[68448,68466],[68480,68497],[68608,68680],[68736,68786],[68800,68850],[68864,68899],[69248,69289],[69296,69297],[69376,69404],69415,[69424,69445],[69488,69505],[69552,69572],[69600,69622],[69635,69687],[69745,69746],69749,[69763,69807],[69840,69864],[69891,69926],69956,69959,[69968,70002],70006,[70019,70066],[70081,70084],70106,70108,[70144,70161],[70163,70187],[70207,70208],[70272,70278],70280,[70282,70285],[70287,70301],[70303,70312],[70320,70366],[70405,70412],[70415,70416],[70419,70440],[70442,70448],[70450,70451],[70453,70457],70461,70480,[70493,70497],[70656,70708],[70727,70730],[70751,70753],[70784,70831],[70852,70853],70855,[71040,71086],[71128,71131],[71168,71215],71236,[71296,71338],71352,[71680,71723],[71840,71903],[71935,71942],71945,[71948,71955],[71957,71958],[71960,71983],71999,72001,[72096,72103],[72106,72144],72161,72163,72192,[72203,72242],72250,72272,[72284,72329],72349,[72368,72440],[72704,72712],[72714,72750],72768,[72818,72847],[72960,72966],[72968,72969],[72971,73008],73030,[73056,73061],[73063,73064],[73066,73097],73112,[73440,73458],73474,[73476,73488],[73490,73523],73648,[73728,74649],[74752,74862],[74880,75075],[77712,77808],[77824,78895],[78913,78918],[82944,83526],[92160,92728],[92736,92766],[92784,92862],[92880,92909],[92928,92975],[92992,92995],[93027,93047],[93053,93071],[93760,93823],[93952,94026],94032,[94099,94111],[94176,94177],94179,[113664,113770],[113776,113788],[113792,113800],[113808,113817],[119808,119892],[119894,119964],[119966,119967],119970,[119973,119974],[119977,119980],[119982,119993],119995,[119997,120003],[120005,120069],[120071,120074],[120077,120084],[120086,120092],[120094,120121],[120123,120126],[120128,120132],120134,[120138,120144],[120146,120485],[120488,120512],[120514,120538],[120540,120570],[120572,120596],[120598,120628],[120630,120654],[120656,120686],[120688,120712],[120714,120744],[120746,120770],[120772,120779],[122624,122654],[122661,122666],[122928,122989],[123136,123180],[123191,123197],123214,[123536,123565],[123584,123627],[124112,124139],[124896,124902],[124904,124907],[124909,124910],[124912,124926],[124928,125124],[125184,125251],125259,[126464,126467],[126469,126495],[126497,126498],126500,126503,[126505,126514],[126516,126519],126521,126523,126530,126535,126537,126539,[126541,126543],[126545,126546],126548,126551,126553,126555,126557,126559,[126561,126562],126564,[126567,126570],[126572,126578],[126580,126583],[126585,126588],126590,[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[127280,127305],[127312,127337],[127344,127369]],bpe=[13],_pe=[34],Cpe=[[768,879],[1155,1161],[1425,1469],1471,[1473,1474],[1476,1477],1479,[1552,1562],[1611,1631],1648,[1750,1756],[1759,1764],[1767,1768],[1770,1773],1809,[1840,1866],[1958,1968],[2027,2035],2045,[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2307],[2362,2364],[2366,2383],[2385,2391],[2402,2403],[2433,2435],2492,[2494,2500],[2503,2504],[2507,2509],2519,[2530,2531],2558,[2561,2563],2620,[2622,2626],[2631,2632],[2635,2637],2641,[2672,2673],2677,[2689,2691],2748,[2750,2757],[2759,2761],[2763,2765],[2786,2787],[2810,2815],[2817,2819],2876,[2878,2884],[2887,2888],[2891,2893],[2901,2903],[2914,2915],2946,[3006,3010],[3014,3016],[3018,3021],3031,[3072,3076],3132,[3134,3140],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3203],3260,[3262,3268],[3270,3272],[3274,3277],[3285,3286],[3298,3299],3315,[3328,3331],[3387,3388],[3390,3396],[3398,3400],[3402,3405],3415,[3426,3427],[3457,3459],3530,[3535,3540],3542,[3544,3551],[3570,3571],3633,[3636,3642],[3655,3662],3761,[3764,3772],[3784,3790],[3864,3865],3893,3895,3897,[3902,3903],[3953,3972],[3974,3975],[3981,3991],[3993,4028],4038,[4139,4158],[4182,4185],[4190,4192],[4194,4196],[4199,4205],[4209,4212],[4226,4237],4239,[4250,4253],[4957,4959],[5906,5909],[5938,5940],[5970,5971],[6002,6003],[6068,6099],6109,[6155,6157],6159,[6277,6278],6313,[6432,6443],[6448,6459],[6679,6683],[6741,6750],[6752,6780],6783,[6832,6862],[6912,6916],[6964,6980],[7019,7027],[7040,7042],[7073,7085],[7142,7155],[7204,7223],[7376,7378],[7380,7400],7405,7412,[7415,7417],[7616,7679],8204,[8400,8432],[11503,11505],11647,[11744,11775],[12330,12335],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],43010,43014,43019,[43043,43047],43052,[43136,43137],[43188,43205],[43232,43249],43263,[43302,43309],[43335,43347],[43392,43395],[43443,43456],43493,[43561,43574],43587,[43596,43597],[43643,43645],43696,[43698,43700],[43703,43704],[43710,43711],43713,[43755,43759],[43765,43766],[44003,44010],[44012,44013],64286,[65024,65039],[65056,65071],[65438,65439],66045,66272,[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],68159,[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],[69632,69634],[69688,69702],69744,[69747,69748],[69759,69762],[69808,69818],69826,[69888,69890],[69927,69940],[69957,69958],70003,[70016,70018],[70067,70080],[70089,70092],[70094,70095],[70188,70199],70206,70209,[70367,70378],[70400,70403],[70459,70460],[70462,70468],[70471,70472],[70475,70477],70487,[70498,70499],[70502,70508],[70512,70516],[70709,70726],70750,[70832,70851],[71087,71093],[71096,71104],[71132,71133],[71216,71232],[71339,71351],[71453,71467],[71724,71738],[71984,71989],[71991,71992],[71995,71998],72e3,[72002,72003],[72145,72151],[72154,72160],72164,[72193,72202],[72243,72249],[72251,72254],72263,[72273,72283],[72330,72345],[72751,72758],[72760,72767],[72850,72871],[72873,72886],[73009,73014],73018,[73020,73021],[73023,73029],73031,[73098,73102],[73104,73105],[73107,73111],[73459,73462],[73472,73473],73475,[73524,73530],[73534,73538],78912,[78919,78933],[92912,92916],[92976,92982],94031,[94033,94087],[94095,94098],94180,[94192,94193],[113821,113822],[118528,118573],[118576,118598],[119141,119145],[119149,119154],[119163,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],121461,121476,[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],123023,[123184,123190],123566,[123628,123631],[124140,124143],[125136,125142],[125252,125258],[127995,127999],[917536,917631],[917760,917999]],Spe=[95,8239,[8255,8256],8276,[65075,65076],[65101,65103],65343],Epe=[173,[1536,1541],1564,1757,1807,[2192,2193],2274,6158,[8206,8207],[8234,8238],[8288,8292],[8294,8303],65279,[65529,65531],69821,69837,[78896,78911],[113824,113827],[119155,119162],917505],ype=[[1488,1514],[1519,1522],64285,[64287,64296],[64298,64310],[64312,64316],64318,[64320,64321],[64323,64324],[64326,64335]],Dpe=[[12337,12341],[12443,12444],[12448,12538],[12540,12543],[12784,12799],[13008,13054],[13056,13143],[65382,65437],[110576,110579],[110581,110587],[110589,110590],110592,[110880,110882],110933,[110948,110951]],Rpe=[10],Ipe=[58,183,903,1375,1524,8231,65043,65109,65306],Ape=[44,59,894,1417,[1548,1549],1644,2040,8260,65040,65044,65104,65108,65292,65307],Tpe=[46,[8216,8217],8228,65106,65287,65294],wpe=[[11,12],133,[8232,8233]],Lpe=[[48,57],[1632,1641],1643,[1776,1785],[1984,1993],[2406,2415],[2534,2543],[2662,2671],[2790,2799],[2918,2927],[3046,3055],[3174,3183],[3302,3311],[3430,3439],[3558,3567],[3664,3673],[3792,3801],[3872,3881],[4160,4169],[4240,4249],[6112,6121],[6160,6169],[6470,6479],[6608,6617],[6784,6793],[6800,6809],[6992,7001],[7088,7097],[7232,7241],[7248,7257],[42528,42537],[43216,43225],[43264,43273],[43472,43481],[43504,43513],[43600,43609],[44016,44025],[65296,65305],[66720,66729],[68912,68921],[69734,69743],[69872,69881],[69942,69951],[70096,70105],[70384,70393],[70736,70745],[70864,70873],[71248,71257],[71360,71369],[71472,71481],[71904,71913],[72016,72025],[72784,72793],[73040,73049],[73120,73129],[73552,73561],[92768,92777],[92864,92873],[93008,93017],[120782,120831],[123200,123209],[123632,123641],[124144,124153],[125264,125273],[130032,130041]],Ope=[[0,9],[14,31],33,[35,38],[40,43],45,47,[60,64],[91,94],96,[123,132],[134,159],[161,169],[171,172],[174,180],182,[184,185],[187,191],215,247,[728,733],885,[888,889],[896,901],907,909,930,1014,1154,1328,[1367,1368],1373,[1419,1424],1470,1472,1475,1478,[1480,1487],[1515,1518],[1525,1535],[1542,1547],[1550,1551],1563,[1565,1567],1642,1645,1748,1769,[1789,1790],[1792,1806],[1867,1868],[1970,1983],[2038,2039],2041,[2043,2044],[2046,2047],[2094,2111],[2140,2143],[2155,2159],2184,2191,[2194,2199],[2404,2405],2416,2436,[2445,2446],[2449,2450],2473,2481,[2483,2485],[2490,2491],[2501,2502],[2505,2506],[2511,2518],[2520,2523],2526,[2532,2533],[2546,2555],2557,[2559,2560],2564,[2571,2574],[2577,2578],2601,2609,2612,2615,[2618,2619],2621,[2627,2630],[2633,2634],[2638,2640],[2642,2648],2653,[2655,2661],[2678,2688],2692,2702,2706,2729,2737,2740,[2746,2747],2758,2762,[2766,2767],[2769,2783],[2788,2789],[2800,2808],2816,2820,[2829,2830],[2833,2834],2857,2865,2868,[2874,2875],[2885,2886],[2889,2890],[2894,2900],[2904,2907],2910,[2916,2917],2928,[2930,2945],2948,[2955,2957],2961,[2966,2968],2971,2973,[2976,2978],[2981,2983],[2987,2989],[3002,3005],[3011,3013],3017,[3022,3023],[3025,3030],[3032,3045],[3056,3071],3085,3089,3113,[3130,3131],3141,3145,[3150,3156],3159,[3163,3164],[3166,3167],[3172,3173],[3184,3199],3204,3213,3217,3241,3252,[3258,3259],3269,3273,[3278,3284],[3287,3292],3295,[3300,3301],3312,[3316,3327],3341,3345,3397,3401,[3407,3411],[3416,3422],[3428,3429],[3440,3449],3456,3460,[3479,3481],3506,3516,[3518,3519],[3527,3529],[3531,3534],3541,3543,[3552,3557],[3568,3569],[3572,3632],[3634,3635],[3643,3654],3663,[3674,3760],[3762,3763],[3773,3783],3791,[3802,3839],[3841,3863],[3866,3871],[3882,3892],3894,3896,[3898,3901],3912,[3949,3952],3973,3992,[4029,4037],[4039,4095],4130,4136,4159,[4170,4175],[4186,4189],4193,[4197,4198],[4206,4208],[4213,4225],4238,[4254,4255],4294,[4296,4300],[4302,4303],4347,4681,[4686,4687],4695,4697,[4702,4703],4745,[4750,4751],4785,[4790,4791],4799,4801,[4806,4807],4823,4881,[4886,4887],[4955,4956],[4960,4991],[5008,5023],[5110,5111],[5118,5120],[5741,5742],[5787,5791],[5867,5869],[5881,5887],[5910,5918],[5941,5951],[5972,5983],5997,6001,[6004,6015],[6100,6102],[6104,6107],[6110,6111],[6122,6154],[6170,6175],[6265,6271],[6315,6319],[6390,6399],6431,[6444,6447],[6460,6469],[6510,6511],[6517,6527],[6570,6575],[6602,6607],[6619,6655],[6684,6740],6751,[6781,6782],[6794,6799],[6810,6831],[6863,6911],[6989,6991],[7002,7018],[7028,7039],[7156,7167],[7224,7231],[7242,7244],[7294,7295],[7305,7311],[7355,7356],[7360,7375],7379,[7419,7423],[7958,7959],[7966,7967],[8006,8007],[8014,8015],8024,8026,8028,8030,[8062,8063],8117,8125,[8127,8129],8133,[8141,8143],[8148,8149],[8156,8159],[8173,8177],8181,[8189,8191],8199,[8208,8215],[8218,8227],[8229,8230],[8240,8254],[8257,8259],[8261,8275],[8277,8286],8293,8304,[8306,8318],[8320,8335],[8349,8399],[8433,8449],[8451,8454],[8456,8457],8468,[8470,8472],[8478,8483],8485,8487,8489,8494,[8506,8507],[8512,8516],[8522,8525],[8527,8543],[8585,9397],[9450,9756],[9758,9791],9793,[9795,9876],[9879,9976],[9978,9991],9993,[9998,10083],[10085,11263],[11493,11498],[11508,11519],11558,[11560,11564],[11566,11567],[11624,11630],[11632,11646],[11671,11679],11687,11695,11703,11711,11719,11727,11735,11743,[11776,11822],[11824,12287],[12289,12292],[12294,12329],12336,[12342,12346],[12349,12440],[12445,12447],12539,[12544,12548],12592,[12687,12703],[12736,12783],[12800,13007],13055,[13144,40959],[42125,42191],[42238,42239],[42509,42511],[42540,42559],42611,42622,[42738,42759],[42955,42959],42962,42964,[42970,42993],[43048,43051],[43053,43071],[43124,43135],[43206,43215],[43226,43231],[43256,43258],43260,[43310,43311],[43348,43359],[43389,43391],[43457,43470],[43482,43492],[43494,43503],[43514,43519],[43575,43583],[43598,43599],[43610,43642],[43646,43695],43697,[43701,43702],[43705,43709],43712,[43714,43743],[43760,43761],[43767,43776],[43783,43784],[43791,43792],[43799,43807],43815,43823,[43882,43887],44011,[44014,44015],[44026,44031],[55204,55215],[55239,55242],[55292,64047],[64107,64255],[64263,64274],[64280,64284],64297,64311,64317,64319,64322,64325,[64434,64466],[64830,64847],[64912,64913],[64968,65007],[65020,65023],[65041,65042],[65045,65055],[65072,65074],[65077,65100],65105,65107,[65110,65135],65141,[65277,65278],[65280,65286],[65288,65291],65293,65295,[65308,65312],[65339,65342],65344,[65371,65381],[65471,65473],[65480,65481],[65488,65489],[65496,65497],[65501,65528],[65532,65535],65548,65575,65595,65598,[65614,65615],[65630,65663],[65787,65855],[65909,66044],[66046,66175],[66205,66207],[66257,66271],[66273,66303],[66336,66348],[66379,66383],[66427,66431],[66462,66463],[66500,66503],66512,[66518,66559],[66718,66719],[66730,66735],[66772,66775],[66812,66815],[66856,66863],[66916,66927],66939,66955,66963,66966,66978,66994,67002,[67005,67071],[67383,67391],[67414,67423],[67432,67455],67462,67505,[67515,67583],[67590,67591],67593,67638,[67641,67643],[67645,67646],[67670,67679],[67703,67711],[67743,67807],67827,[67830,67839],[67862,67871],[67898,67967],[68024,68029],[68032,68095],68100,[68103,68107],68116,68120,[68150,68151],[68155,68158],[68160,68191],[68221,68223],[68253,68287],68296,[68327,68351],[68406,68415],[68438,68447],[68467,68479],[68498,68607],[68681,68735],[68787,68799],[68851,68863],[68904,68911],[68922,69247],69290,[69293,69295],[69298,69372],[69405,69414],[69416,69423],[69457,69487],[69510,69551],[69573,69599],[69623,69631],[69703,69733],[69750,69758],[69819,69820],[69822,69825],[69827,69836],[69838,69839],[69865,69871],[69882,69887],69941,[69952,69955],[69960,69967],[70004,70005],[70007,70015],[70085,70088],70093,70107,[70109,70143],70162,[70200,70205],[70210,70271],70279,70281,70286,70302,[70313,70319],[70379,70383],[70394,70399],70404,[70413,70414],[70417,70418],70441,70449,70452,70458,[70469,70470],[70473,70474],[70478,70479],[70481,70486],[70488,70492],[70500,70501],[70509,70511],[70517,70655],[70731,70735],[70746,70749],[70754,70783],70854,[70856,70863],[70874,71039],[71094,71095],[71105,71127],[71134,71167],[71233,71235],[71237,71247],[71258,71295],[71353,71359],[71370,71452],[71468,71471],[71482,71679],[71739,71839],[71914,71934],[71943,71944],[71946,71947],71956,71959,71990,[71993,71994],[72004,72015],[72026,72095],[72104,72105],[72152,72153],72162,[72165,72191],[72255,72262],[72264,72271],[72346,72348],[72350,72367],[72441,72703],72713,72759,[72769,72783],[72794,72817],[72848,72849],72872,[72887,72959],72967,72970,[73015,73017],73019,73022,[73032,73039],[73050,73055],73062,73065,73103,73106,[73113,73119],[73130,73439],[73463,73471],73489,[73531,73533],[73539,73551],[73562,73647],[73649,73727],[74650,74751],[74863,74879],[75076,77711],[77809,77823],[78934,82943],[83527,92159],[92729,92735],92767,[92778,92783],92863,[92874,92879],[92910,92911],[92917,92927],[92983,92991],[92996,93007],[93018,93026],[93048,93052],[93072,93759],[93824,93951],[94027,94030],[94088,94094],[94112,94175],94178,[94181,94191],[94194,110575],110580,110588,110591,[110593,110879],[110883,110932],[110934,110947],[110952,113663],[113771,113775],[113789,113791],[113801,113807],[113818,113820],113823,[113828,118527],[118574,118575],[118599,119140],[119146,119148],[119171,119172],[119180,119209],[119214,119361],[119365,119807],119893,119965,[119968,119969],[119971,119972],[119975,119976],119981,119994,119996,120004,120070,[120075,120076],120085,120093,120122,120127,120133,[120135,120137],120145,[120486,120487],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771,[120780,120781],[120832,121343],[121399,121402],[121453,121460],[121462,121475],[121477,121498],121504,[121520,122623],[122655,122660],[122667,122879],122887,[122905,122906],122914,122917,[122923,122927],[122990,123022],[123024,123135],[123181,123183],[123198,123199],[123210,123213],[123215,123535],[123567,123583],[123642,124111],[124154,124895],124903,124908,124911,124927,[125125,125135],[125143,125183],[125260,125263],[125274,126463],126468,126496,126499,[126501,126502],126504,126515,126520,126522,[126524,126529],[126531,126534],126536,126538,126540,126544,126547,[126549,126550],126552,126554,126556,126558,126560,126563,[126565,126566],126571,126579,126584,126589,126591,126602,[126620,126624],126628,126634,[126652,127279],[127306,127311],[127338,127343],[127370,127461],[127488,127751],[127753,127805],[127807,127858],[127860,127876],[127878,127890],[127892,127907],[127909,127911],[127913,127937],[127941,127942],[127944,127945],[127949,127978],127980,[127982,127994],[128e3,128065],[128068,128069],[128081,128101],[128106,128109],128111,[128121,128123],[128125,128128],128132,[128136,128138],[128140,128169],[128171,128186],[128189,128294],[128296,128299],[128301,128371],[128374,128377],[128379,128399],[128401,128404],[128407,128487],[128489,128580],[128584,128586],[128592,128639],[128641,128657],[128659,128674],[128676,128691],[128695,128703],[128705,128715],[128717,129303],[129312,129317],[129319,129327],[129338,129339],[129343,129488],[129502,130031],[130042,917504],[917506,917535],[917632,917759],[918e3,1114111]],Ppe=[[127462,127487]],Mpe=[39],Npe=[32,5760,[8192,8198],[8200,8202],8287,12288],xpe=[8205],Fpe=Object.freeze(Object.defineProperty({__proto__:null,ALetter:vpe,CR:bpe,Double_Quote:_pe,Extend:Cpe,ExtendNumLet:Spe,Format:Epe,Hebrew_Letter:ype,Katakana:Dpe,LF:Rpe,MidLetter:Ipe,MidNum:Ape,MidNumLet:Tpe,Newline:wpe,Numeric:Lpe,Other:Ope,Regional_Indicator:Ppe,Single_Quote:Mpe,WSegSpace:Npe,ZWJ:xpe},Symbol.toStringTag,{value:"Module"})),$pe=Object.freeze(Object.defineProperty({__proto__:null,Bidi_Class:j2e,Bidi_Mirroring_Glyph:E8e,Bidi_Paired_Bracket_Type:I8e,Binary_Property:Nce,Block:S8e,Case_Folding:Q3e,General_Category:_2e,Line_Break:gpe,Script:W6e,Script_Extensions:X3e,Word_Break:Fpe},Symbol.toStringTag,{value:"Module"}));function Rx(t){const e=Object.keys(t);if(e.length===0)throw new Error("Expected at least one category, but received 0.");if(e.some(n=>{const r=t[n];return r===void 0||r.length===0}))throw new Error("Expected at least one sub category, but received 0.");return e.map(n=>{const r=t[n].map(i=>kpe(n,i));return new Dm().union(...r)}).reduce((n,r)=>n.intersect(r))}function kpe(t,e){const n=$pe[t][e];return new Dm().union(...n)}const hE=Rx({Script:["Han","Katakana","Hiragana","Hangul","Bopomofo"],General_Category:["Other_Letter","Letter_Number","Other_Symbol","Modifier_Letter"]}),Bpe=Rx({Block:["CJK_Compatibility","CJK_Symbols_And_Punctuation","Vertical_Forms","CJK_Compatibility_Forms","Small_Form_Variants","Halfwidth_And_Fullwidth_Forms","Ideographic_Description_Characters","Kanbun","CJK_Strokes","Enclosed_CJK_Letters_And_Months"]}).subtract(hE),Upe=fE(hE,Bpe);function Vpe(){return fE(Upe)}function Hpe(){return fE(hE)}const jI=t=>({sbr:.5,sbo:t,spr:.5,spo:t});let ku=class{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,n,r){this._globalFontMeasureCache.has(e)||this._globalFontMeasureCache.set(e,new Map);const i=this._globalFontMeasureCache.get(e);i&&i.set(n,r)}static clearFontMeasureCache(e){var n;const r=e.split("/");if(r.length===1){const i=r[0];this._globalFontMeasureCache.delete(i)}else if(r.length===2){const i=r[0],o=r[1];(n=this._globalFontMeasureCache.get(i))==null||n.delete(o)}else return!1;return!0}static getFontMeasureCache(e,n){var r;return(r=this._globalFontMeasureCache.get(e))==null?void 0:r.get(n)}static autoCleanFontMeasureCache(e=1e6){let n=0,r=!1;for(const i of this._globalFontMeasureCache){const[,o]=i;if(n+=o.size,n>e){r=!0;break}}if(r){let i=0;for(const o of this._globalFontMeasureCache){const[a,s]=o;if(i+=s.size,i>e/2){const u=i-e/2;this._clearMeasureCache(u,s);break}this._globalFontMeasureCache.delete(a)}return!0}return!1}static getBaselineOffsetInfo(e,n){if(this._fontDataMap.size===0)return jI(n);const r=e.split(",");for(let i of r){i=i.replace(/'/g,"");const o=this._fontDataMap.get(i);if(!o)continue;const{subscriptSizeRatio:a,subscriptOffset:s,superscriptSizeRatio:u,superscriptOffset:l}=o;return{sbr:a,sbo:s*n,spr:u,spo:l*n}}return jI(n)}static getTextSizeByDom(e,n){if(n in this._getTextHeightCache)return this._getTextHeightCache[n];let r=document.getElementById("universheetTextSizeTest");const i="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;";r||(r=document.createElement("span"),r.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(r)),r.style.cssText+=`${i};${n}`,r.innerText=e;const o=r.getBoundingClientRect(),a={width:o.width,height:o.height};return this._getTextHeightCache[n]=a,a}static getTextSize(e,n){const{fontString:r,fontSize:i,fontFamily:o}=n;let a=this._getBoundingBoxByFont(o,i);if(!a){const s=this.getMeasureText(e,r);a=this._calculateBoundingBoxByMeasureText(s,i)}return a}static getMeasureText(e,n){if(!this._context){const m=document.createElement("canvas");this._context=m.getContext("2d")}const r=this._context,i=this.getFontMeasureCache(n,e);if(i!=null)return i;r.font=n;const o=r.measureText(e),{width:a,fontBoundingBoxAscent:s,fontBoundingBoxDescent:u,actualBoundingBoxAscent:l,actualBoundingBoxDescent:c}=o,d={width:a,fontBoundingBoxAscent:s,fontBoundingBoxDescent:u,actualBoundingBoxAscent:l,actualBoundingBoxDescent:c};if(s==null||u==null||Number.isNaN(s)||Number.isNaN(u)){const m=this.getTextSizeByDom(ale,n).height;r.textBaseline==="top"?(d.fontBoundingBoxAscent=d.actualBoundingBoxAscent=m,d.fontBoundingBoxDescent=d.actualBoundingBoxDescent=0):r.textBaseline==="middle"?(d.fontBoundingBoxDescent=d.actualBoundingBoxDescent=m/2,d.fontBoundingBoxAscent=d.actualBoundingBoxAscent=m/2):(d.fontBoundingBoxDescent=d.actualBoundingBoxDescent=0,d.fontBoundingBoxAscent=d.actualBoundingBoxAscent=m)}return this.setFontMeasureCache(n,e,d),d}static _clearMeasureCache(e,n){let r=0;for(const i of n){const[o]=i;if(r>e)break;n.delete(o),r++}return!0}static _getBoundingBoxByFont(e,n=28,r=""){const i=this._fontDataMap.get(e);if(!i)return;const{notDefWidth:o,ascender:a,descender:s,typoAscender:u,typoDescender:l,strikeoutPosition:c,subscriptSizeRatio:d,subscriptOffset:m,superscriptSizeRatio:f,superscriptOffset:h,hdmxData:p,glyphHorizonMap:v}=i,g=p==null?void 0:p.indexOf(Math.floor(n)),b=v.get(r.charCodeAt(0));let C=o;if(b){const{width:S,pixelsPerEm:E=[]}=b;g?C=E[g]:C=S}return{width:C*n,ba:a*n,bd:s*n,aba:u*n,abd:l*n,sp:c*n,sbr:d,sbo:m*n,spr:f,spo:h*n}}static _calculateBoundingBoxByMeasureText(e,n){const{width:r,fontBoundingBoxAscent:i,fontBoundingBoxDescent:o,actualBoundingBoxAscent:a,actualBoundingBoxDescent:s}=e;return{width:r,ba:i,bd:o,aba:a,abd:s,sp:(i+o)/2,sbr:.5,sbo:n,spr:.5,spo:n}}};w(ku,"_getTextHeightCache",{}),w(ku,"_context"),w(ku,"_fontDataMap",new Map),w(ku,"_globalFontMeasureCache",new Map);const Ix=180,jpe=Math.PI/Ix,zpe=Ix/Math.PI,zI="rgb(",Wpe="rgba(",la=(t,e)=>t?e!=null?`${Wpe+t.join(",")},${e})`:`${zI+t.join(",")})`:`${zI}0,0,0)`,Ype=100,Bu=(t,e)=>{if(Ie.isNumber(t))return t;if(e&&t&&Ie.isString(t)&&t.substr(t.length-1,1)==="%"){const n=Number.parseFloat(t)/Ype;return e*n}return 0},Xpe=16,Rm=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(t):e.requestAnimationFrame?e.requestAnimationFrame(t):e.msRequestAnimationFrame?e.msRequestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(t):e.oRequestAnimationFrame?e.oRequestAnimationFrame(t):setTimeout(t,Xpe)),Ax=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(t):e.requestAnimationFrame?e.cancelAnimationFrame(t):e.msRequestAnimationFrame?e.msCancelAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(t):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(t):e.oRequestAnimationFrame?e.oCancelAnimationFrame(t):clearTimeout(t)),Tx=()=>{const t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){console.error(e)}return t},qpe=t=>t*zpe,q1=t=>t*jpe,WI=()=>{let t="pointer";return typeof window<"u"&&!window.PointerEvent&&typeof navigator<"u"&&(t="mouse"),Ie.isTablet()&&!Ie.isIPhone()&&!(document&&"ontouchend"in document)&&(t="mouse"),t},Gpe=()=>Ie.getBrowserType()==="safari",Kpe=4,Zpe=(t="obj",e=Kpe)=>{const n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split("");let r="";for(let o=0;o<e;o++)r+=n[Math.round(Math.random()*(n.length-1))];const i=new Date().getTime();return`${t}_${r}_${i}`};function wx(t){return Object.prototype.toString.apply(t)}function Lx(t){return wx(t)==="[object Function]"}function YI(t){return wx(t)==="[object String]"}function Kb(t,e){return e=10**e,Math.round(t*e)/e}function rn(t,e){return Math.round(t*e)/e}function h9(t,e){const n="Arial";if(!t){const c=`11pt  ${n}`;return{fontCache:c,fontString:c,fontSize:11,fontFamily:n}}let r=l6.ITALIC;(t.it===0||t.it===void 0)&&(r=l6.NORMAL);let i=l6.BOLD;(t.bl===0||t.bl===void 0)&&(i=l6.NORMAL);let o=11;t.fs&&(o=Math.ceil(t.fs));let a=n;if(t.ff){let c=t.ff;c=c.replace(/"/g,"").replace(/'/g,""),c.indexOf(" ")>-1&&(c=`"${c}"`),c==null&&(c=n),a=c}const{va:s}=t;if(s===yr.SUBSCRIPT||s===yr.SUPERSCRIPT){const c=ku.getBaselineOffsetInfo(a,o),{sbr:d,spr:m}=c;o*=s===yr.SUBSCRIPT?d:m}const u=`${r} ${i} ${o}pt ${a}`,l=`${u}, ${mE} `;return{fontCache:u,fontString:l,fontSize:o,fontFamily:a}}const Qpe=Hpe().toRegExp();function Zb(t){return Qpe.test(t)}const Jpe=Vpe().toRegExp();function pE(t){return Jpe.test(t)}const ege=/^(?:[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?))/g,tge=/^(?:[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26D3\uFE0F?(?:\u200D\uD83D\uDCA5)?|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF43\uDF45-\uDF4A\uDF4C-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDF44(?:\u200D\uD83D\uDFEB)?|\uDF4B(?:\u200D\uD83D\uDFE9)?|\uDFC3(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4\uDEB5](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE41\uDE43\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC08(?:\u200D\u2B1B)?|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC26(?:\u200D(?:\u2B1B|\uD83D\uDD25))?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?|\uDE42(?:\u200D[\u2194\u2195]\uFE0F?)?|\uDEB6(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDCE(?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D(?:[\u2640\u2642]\uFE0F?(?:\u200D\u27A1\uFE0F?)?|\u27A1\uFE0F?))?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1|\uDDD1\u200D\uD83E\uDDD2(?:\u200D\uD83E\uDDD2)?|\uDDD2(?:\u200D\uD83E\uDDD2)?))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF\uDDBC\uDDBD](?:\u200D\u27A1\uFE0F?)?|[\uDDB0-\uDDB3]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?))/;function Ox(t){return tge.test(t)}function Px(t){return/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.test(t)}function Mx(t){return/[\u0180-\u024F]/gi.test(t)}function nge(t){return/\s+/g.test(t)}const XI=1e3;let T3;function rge(){if(T3)return T3;let t=56;for(;t<XI*2;t++)if(matchMedia(`(max-resolution: ${t}dpi)`).matches===!0)return t;return T3=t,setTimeout(()=>{T3=null},XI),t}const ige=72;function oge(t){return t*(ige/rge())}function Nx(t){const{scaleX:e=1,scaleY:n=1}=t;return Math.max(e,n)}function t0(t,e,n,r){const i=t-1,o=e-1,a=n[i]||0,s=n[t]||n[n.length-1],u=r[o]||0,l=r[e]||r[r.length-1];return{startY:a,endY:s,startX:u,endX:l}}function v6(t,e,n,r,i){let{startY:o,endY:a,startX:s,endX:u}=t0(t,e,n,r);const{isMerged:l,isMergedMainCell:c,startRow:d,startColumn:m,endRow:f,endColumn:h}=Xc(t,e,i);let p={startRow:d,startColumn:m,endRow:f,endColumn:h,startY:0,endY:0,startX:0,endX:0};const v=n.length-1,g=r.length-1;if(l&&d!==-1&&m!==-1){const b=n[d-1]||0,C=n[f]||n[v],S=r[m-1]||0,E=r[h]||r[g];p={...p,startY:b,endY:C,startX:S,endX:E}}else if(!l&&f!==-1&&h!==-1){const b=n[f]||n[v],C=r[h]||r[g];p={...p,startY:o,endY:b,startX:s,endX:C}}return{isMerged:l,isMergedMainCell:c,actualRow:t,actualColumn:e,startY:o,endY:a,startX:s,endX:u,mergeInfo:p}}function Xc(t,e,n){let r=!1,i=!1,o=t,a=e,s=t,u=e;if(n==null)return{actualRow:t,actualColumn:e,isMergedMainCell:i,isMerged:r,endRow:o,endColumn:a,startRow:s,startColumn:u};for(let l=0;l<n.length;l++){const{startRow:c,endRow:d,startColumn:m,endColumn:f}=n[l];if(t===c&&e===m){o=d,a=f,s=c,u=m,i=!0;break}if(t>=c&&t<=d&&e>=m&&e<=f){o=d,a=f,s=c,u=m,r=!0;break}}return{actualRow:t,actualColumn:e,isMergedMainCell:i,isMerged:r,endRow:o,endColumn:a,startRow:s,startColumn:u}}function age(t,e,n,r){let i=!1;for(let o=e;o<=n;o++){const{isMerged:a,isMergedMainCell:s}=Xc(t,o,r);if(!a&&!s){i=!0;break}}return i}function qI(t,e,n){const{startY:r,endY:i,startX:o,endX:a}=t;return t.startY=r+n,t.endY=i+n,t.startX=o+e,t.endX=a+e,{...t}}function xx(t,e){return!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)}function sge(t){const e=document.createElement("style");document.head.appendChild(e);const n=e.sheet;for(const r of t)n==null||n.insertRule(r,n.cssRules.length)}function uge(t){for(let e=0,n=document.head.childNodes.length;e<n;e++){const r=document.head.childNodes[e];if(r.nodeName==="STYLE"&&r.textContent&&r.textContent.indexOf(t)>-1)return!0}return!1}function v2(t){return Number(t.replace(/px/gi,""))}function lge(t){const e=getComputedStyle(t),{borderTopWidth:n,borderLeftWidth:r,borderRightWidth:i,borderBottomWidth:o,width:a,height:s}=e;return{top:v2(n),left:v2(r),right:v2(i),bottom:v2(o),width:v2(a),height:v2(s)}}let zt=class Kn{constructor(e=0,n=0){this.x=e,this.y=n}static Zero(){return new Kn(0,0)}static One(){return new Kn(1,1)}static FromArray(e,n=0){return new Kn(e[n],e[n+1])}static FromArrayToRef(e,n,r){r.x=e[n],r.y=e[n+1]}static CatmullRom(e,n,r,i,o){const a=o*o,s=o*a,u=.5*(2*n.x+(-e.x+r.x)*o+(2*e.x-5*n.x+4*r.x-i.x)*a+(-e.x+3*n.x-3*r.x+i.x)*s),l=.5*(2*n.y+(-e.y+r.y)*o+(2*e.y-5*n.y+4*r.y-i.y)*a+(-e.y+3*n.y-3*r.y+i.y)*s);return new Kn(u,l)}static Clamp(e,n,r){let i=e.x;i=i>r.x?r.x:i,i=i<n.x?n.x:i;let o=e.y;return o=o>r.y?r.y:o,o=o<n.y?n.y:o,new Kn(i,o)}static Hermite(e,n,r,i,o){const a=o*o,s=o*a,u=2*s-3*a+1,l=-2*s+3*a,c=s-2*a+o,d=s-a,m=e.x*u+r.x*l+n.x*c+i.x*d,f=e.y*u+r.y*l+n.y*c+i.y*d;return new Kn(m,f)}static Hermite1stDerivative(e,n,r,i,o){const a=Kn.Zero();return this.Hermite1stDerivativeToRef(e,n,r,i,o,a),a}static Hermite1stDerivativeToRef(e,n,r,i,o,a){const s=o*o;a.x=(s-o)*6*e.x+(3*s-4*o+1)*n.x+(-s+o)*6*r.x+(3*s-2*o)*i.x,a.y=(s-o)*6*e.y+(3*s-4*o+1)*n.y+(-s+o)*6*r.y+(3*s-2*o)*i.y}static Lerp(e,n,r){const i=e.x+(n.x-e.x)*r,o=e.y+(n.y-e.y)*r;return new Kn(i,o)}static Dot(e,n){return e.x*n.x+e.y*n.y}static Normalize(e){const n=Kn.Zero();return this.NormalizeToRef(e,n),n}static NormalizeToRef(e,n){const r=e.length();r!==0&&(n.x=e.x/r,n.y=e.y/r)}static Minimize(e,n){const r=e.x<n.x?e.x:n.x,i=e.y<n.y?e.y:n.y;return new Kn(r,i)}static Maximize(e,n){const r=e.x>n.x?e.x:n.x,i=e.y>n.y?e.y:n.y;return new Kn(r,i)}static PointInTriangle(e,n,r,i){const o=.5*(-r.y*i.x+n.y*(-r.x+i.x)+n.x*(r.y-i.y)+r.x*i.y),a=o<0?-1:1,s=(n.y*i.x-n.x*i.y+(i.y-n.y)*e.x+(n.x-i.x)*e.y)*a,u=(n.x*r.y-n.y*r.x+(n.y-r.y)*e.x+(r.x-n.x)*e.y)*a;return s>0&&u>0&&s+u<2*o*a}static Distance(e,n){return Math.sqrt(Kn.DistanceSquared(e,n))}static DistanceSquared(e,n){const r=e.x-n.x,i=e.y-n.y;return r*r+i*i}static Center(e,n){return Kn.CenterToRef(e,n,Kn.Zero())}static CenterToRef(e,n,r){return r.copyFromFloats((e.x+n.x)/2,(e.y+n.y)/2)}static DistanceOfPointFromSegment(e,n,r){const i=Kn.DistanceSquared(n,r);if(i===0)return Kn.Distance(e,n);const o=r.subtract(n),a=Math.max(0,Math.min(1,Kn.Dot(e.subtract(n),o)/i)),s=n.add(o.multiplyByFloats(a,a));return Kn.Distance(e,s)}static create(e,n){return new Kn(e,n)}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=this.x|0;return e=e*397^(this.y|0),e}toArray(e,n=0){return e[n]=this.x,e[n+1]=this.y,this}fromArray(e,n=0){return Kn.FromArrayToRef(e,n,this),this}asArray(){const e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,n){return this.x=e,this.y=n,this}set(e,n){return this.copyFromFloats(e,n)}add(e){return new Kn(this.x+e.x,this.y+e.y)}addToRef(e,n){return n.x=this.x+e.x,n.y=this.y+e.y,this}addByPoint(e,n){return new Kn(this.x+e,this.y+n)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new Kn(this.x-e.x,this.y-e.y)}subtractByPoint(e,n){return new Kn(this.x-e,this.y-n)}subtractToRef(e,n){return n.x=this.x-e.x,n.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new Kn(this.x*e.x,this.y*e.y)}multiplyToRef(e,n){return n.x=this.x*e.x,n.y=this.y*e.y,this}multiplyByFloats(e,n){return new Kn(this.x*e,this.y*n)}divide(e){return new Kn(this.x/e.x,this.y/e.y)}divideToRef(e,n){return n.x=this.x/e.x,n.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new Kn(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){const n=new Kn(0,0);return this.scaleToRef(e,n),n}scaleToRef(e,n){return n.x=this.x*e,n.y=this.y*e,this}scaleAndAddToRef(e,n){return n.x+=this.x*e,n.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new Kn(Math.floor(this.x),Math.floor(this.y))}fract(){return new Kn(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const n=Math.cos(e),r=Math.sin(e),i=n*this.x-r*this.y,o=r*this.x+n*this.y;return this.x=i,this.y=o,this}rotateToRef(e,n){const r=Math.cos(e),i=Math.sin(e);return n.x=r*this.x-i*this.y,n.y=i*this.x+r*this.y,this}rotateByPoint(e,n=Kn.create(0,0)){const r=Math.cos(e),i=Math.sin(e),o=n.x+(this.x-n.x)*r-(this.y-n.y)*i,a=n.y+(this.x-n.x)*i+(this.y-n.y)*r;return this.x=o,this.y=a,this}transformCoordinateOnRotate(e){const n=Math.sqrt(this.x**2+this.y**2),r=Math.atan2(this.y,this.x),i=-e+r;return this.x=n*Math.cos(i),this.y=n*Math.sin(i),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return Kn.NormalizeToRef(this,this),this}clone(){return new Kn(this.x,this.y)}};const ig=[1,0,0,1,0,0];let l1=class Zl{constructor(e=ig){w(this,"dirty",!1),w(this,"_m"),this._m=e&&e.slice()||ig}static create(e=ig){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new Zl(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,n=!1){const r=this._m,i=r[0]*e.x+r[2]*e.y,o=r[1]*e.x+r[3]*e.y;return n?new zt(i,o):new zt(i+r[4],o+r[5])}translate(e,n){return this._m[4]+=this._m[0]*e+this._m[2]*n,this._m[5]+=this._m[1]*e+this._m[3]*n,this}scale(e,n){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=n,this._m[3]*=n,this}rotate(e){const n=q1(e),r=Math.cos(n),i=Math.sin(n),o=this._m[0]*r+this._m[2]*i,a=this._m[1]*r+this._m[3]*i,s=this._m[0]*-i+this._m[2]*r,u=this._m[1]*-i+this._m[3]*r;return this._m[0]=o,this._m[1]=a,this._m[2]=s,this._m[3]=u,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,n){const r=this._m[0]+this._m[2]*n,i=this._m[1]+this._m[3]*n,o=this._m[2]+this._m[0]*e,a=this._m[3]+this._m[1]*e;return this._m[0]=r,this._m[1]=i,this._m[2]=o,this._m[3]=a,this}multiply(e){const n=this._m[0]*e._m[0]+this._m[2]*e._m[1],r=this._m[1]*e._m[0]+this._m[3]*e._m[1],i=this._m[0]*e._m[2]+this._m[2]*e._m[3],o=this._m[1]*e._m[2]+this._m[3]*e._m[3],a=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],s=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=n,this._m[1]=r,this._m[2]=i,this._m[3]=o,this._m[4]=a,this._m[5]=s,this}invert(){const e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),n=this._m[3]*e,r=-this._m[1]*e,i=-this._m[2]*e,o=this._m[0]*e,a=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),s=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=n,this._m[1]=r,this._m[2]=i,this._m[3]=o,this._m[4]=a,this._m[5]=s,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map(n=>Kb(n,e))}setAbsolutePosition(e){const n=this._m[0],r=this._m[1],i=this._m[2],o=this._m[3],a=this._m[4],s=this._m[5],u=(n*(e.y-s)-r*(e.x-a))/(n*o-r*i),l=(e.x-a-i*u)/n;return this.translate(l,u)}decompose(){const e=this._m[0],n=this._m[1],r=this._m[2],i=this._m[3],o=this._m[4],a=this._m[5],s=e*i-n*r,u={x:o,y:a,angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!==0||n!==0){const l=Math.sqrt(e*e+n*n);u.angle=n>0?Math.acos(e/l):-Math.acos(e/l),u.scaleX=l,u.scaleY=s/l,u.skewX=(e*r+n*i)/s,u.skewY=0}else if(r!==0||i!==0){const l=Math.sqrt(r*r+i*i);u.angle=Math.PI/2-(i>0?Math.acos(-r/l):-Math.acos(r/l)),u.scaleX=s/l,u.scaleY=l,u.skewX=0,u.skewY=(e*r+n*i)/s}return u.angle=qpe(u.angle),u}makeBoundingBoxFromPoints(e){if(this)for(let u=0;u<e.length;u++)e[u]=this.applyPoint(e[u]);const n=[e[0].x,e[1].x,e[2].x,e[3].x],r=Math.min(...n),i=Math.max(...n)-r,o=[e[0].y,e[1].y,e[2].y,e[3].y],a=Math.min(...o),s=Math.max(...o)-a;return{left:r,top:a,width:i,height:s,points:e}}composeMatrix(e){const n=new Zl([1,0,0,1,e.left||0,e.top||0]);return e.angle&&n.rotate(e.angle),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&n.multiply(this._calcDimensionsMatrix(e)),this._m=n.getMatrix(),this}clone(){return new Zl([...this._m])}_calcDimensionsMatrix(e){var n,r;const i=(n=e.scaleX)!=null?n:1,o=(r=e.scaleY)!=null?r:1,a=new Zl([e.flipX?-i:i,0,0,e.flipY?-o:o,0,0]);return e.skewX&&a.multiply(new Zl([1,0,Math.tan(q1(e.skewX)),1,0,0])),e.skewY&&a.multiply(new Zl([1,Math.tan(q1(e.skewY)),0,1,0,0])),a}};const Qb=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class M0{constructor(e){w(this,"groupKey"),w(this,"isInGroup",!1),w(this,"onTransformChangeObservable",new Vn),w(this,"onPointerDownObserver",new Vn),w(this,"onPointerMoveObserver",new Vn),w(this,"onPointerUpObserver",new Vn),w(this,"onDblclickObserver",new Vn),w(this,"onTripleClickObserver",new Vn),w(this,"onMouseWheelObserver",new Vn),w(this,"onPointerOutObserver",new Vn),w(this,"onPointerLeaveObserver",new Vn),w(this,"onPointerOverObserver",new Vn),w(this,"onPointerEnterObserver",new Vn),w(this,"onIsAddedToParentObserver",new Vn),w(this,"onDisposeObserver",new Vn),w(this,"_oKey"),w(this,"_dirty",!0),w(this,"_top",0),w(this,"_topOrigin",0),w(this,"_left",0),w(this,"_leftOrigin",0),w(this,"_width",0),w(this,"_widthOrigin",0),w(this,"_height",0),w(this,"_heightOrigin",0),w(this,"_angle",0),w(this,"_scaleX",1),w(this,"_scaleY",1),w(this,"_skewX",0),w(this,"_skewY",0),w(this,"_flipX",!1),w(this,"_flipY",!1),w(this,"_strokeWidth",0),w(this,"_parent"),w(this,"_zIndex",0),w(this,"_evented",!0),w(this,"_visible",!0),w(this,"_debounceParentDirty",!0),w(this,"_transform",new l1),w(this,"_cursor",Jt.DEFAULT),w(this,"_isTransformer",!1),w(this,"_forceRender",!1),w(this,"_layer"),e?this._oKey=e:this._oKey=Zpe()}get transform(){return this._transform}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return qt.BASE_OBJECT}get top(){return this._top}get left(){return this._left}get width(){return this._width}get height(){return this._height}get strokeWidth(){return this._strokeWidth}get angle(){return this._angle}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){var e;const n=((e=this.getParent())==null?void 0:e.ancestorScaleX)||1;return this.scaleX*n}get ancestorScaleY(){var e;const n=((e=this.getParent())==null?void 0:e.ancestorScaleY)||1;return this.scaleY*n}get skewX(){return this._skewX}get skewY(){return this._skewY}get flipX(){return this._flipX}get flipY(){return this._flipY}get parent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}get evented(){return this._evented}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}get isTransformer(){return this._isTransformer}get cursor(){return this._cursor}get layer(){return this._layer}set transform(e){this._transform=e}set zIndex(e){this._zIndex=e}set parent(e){this._parent=e}set evented(e){this._evented=e}set debounceParentDirty(e){this._debounceParentDirty=e}set isTransformer(e){this._isTransformer=e}set cursor(e){this.setCursor(e)}set layer(e){this._layer=e}set top(e){var n;this._topOrigin=e,this._top=Bu(e,(n=this._parent)==null?void 0:n.height)}set left(e){var n;this._leftOrigin=e,this._left=Bu(e,(n=this._parent)==null?void 0:n.width)}set width(e){var n;this._widthOrigin=e,this._width=Bu(e,(n=this._parent)==null?void 0:n.width)}set height(e){var n;this._heightOrigin=e,this._height=Bu(e,(n=this._parent)==null?void 0:n.height)}set strokeWidth(e){this._strokeWidth=e}set angle(e){this._angle=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}set skewX(e){this._skewX=e}set flipY(e){this._flipY=e}set flipX(e){this._flipX=e}set skewY(e){this._skewY=e}makeDirty(e=!0){if(this._dirty=e,e){if(this._layer==null){this._dirty=!1;return}typeof this._layer.debounceParentTimeout=="function"&&this._layer.debounceParentTimeout(),this._layer.debounceParentTimeout=KL(()=>{var n;(n=this._layer)==null||n.makeDirty(e)})}return this}makeDirtyNoDebounce(e=!0){var n;return this._dirty=e,e&&((n=this._layer)==null||n.makeDirty(e)),this}isDirty(){return this._dirty}translate(e,n){const r=this.top;n!==void 0&&(this.top=n);const i=this.left;return e!==void 0&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.translate,value:{top:this._top,left:this._left},preValue:{top:r,left:i}}),this}resize(e,n){const r=this.width;e!==void 0&&(this.width=e);const i=this.height;return n!==void 0&&(this.height=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.resize,value:{width:this._width,height:this._height},preValue:{width:r,height:i}}),this}scale(e,n){const r=this.scaleX;e!==void 0&&(this.scaleX=e);const i=this.scaleY;return n!==void 0&&(this.scaleY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:r,scaleY:i}}),this}skew(e,n){const r=e;e!==void 0&&(this.skewX=e);const i=n;return n!==void 0&&(this.skewY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:r,skewY:i}}),this}flip(e,n){const r=e;e!==void 0&&(this.flipX=e);const i=n;return n!==void 0&&(this.flipY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:r,flipY:i}}),this}transformByState(e){const n=Object.keys(e),r={};if(n.length!==0)return n.forEach(i=>{e[i]!==void 0&&(r[i]=this[i],this[i]=e[i])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.all,value:e,preValue:r}),this}isRender(e){return this._forceRender?!1:e&&!this.isInGroup}getParent(){return this._parent}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(e,n){}isHit(e){const n=this._getInverseCoord(e);return n.x>=-this.strokeWidth/2&&n.x<=this.width+this.strokeWidth/2&&n.y>=-this.strokeWidth/2&&n.y<=this.height+this.strokeWidth/2}on(e,n){return this[`on${e}Observer`].add(n.bind(this))}off(e,n){this[`on${e}Observer`].remove(n)}clear(e){this[`on${e}Observer`].clear()}triggerPointerMove(e){var n,r;return(n=this.onPointerMoveObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerMove(e),!1)}triggerPointerDown(e){var n,r;return(n=this.onPointerDownObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerDown(e),!1)}triggerPointerUp(e){var n,r;return(n=this.onPointerUpObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerUp(e),!1)}triggerDblclick(e){var n,r;return(n=this.onDblclickObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerDblclick(e),!1)}triggerTripleClick(e){var n,r;return(n=this.onTripleClickObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerTripleClick(e),!1)}triggerMouseWheel(e){var n,r;return(n=this.onMouseWheelObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerMouseWheel(e),!1)}triggerPointerOut(e){var n,r;return(n=this.onPointerOutObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerOut(e),!1)}triggerPointerLeave(e){var n,r;return(n=this.onPointerLeaveObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerLeave(e),!1)}triggerPointerOver(e){var n;return this.onPointerOverObserver.notifyObservers(e)?!0:((n=this._parent)==null||n.triggerPointerOver(e),!1)}triggerPointerEnter(e){var n,r;return(n=this.onPointerEnterObserver.notifyObservers(e))!=null&&n.stopPropagation?!0:((r=this._parent)==null||r.triggerPointerEnter(e),!1)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onTripleClickObserver.clear(),this.onIsAddedToParentObserver.clear(),(e=this.parent)==null||e.removeObject(this),this.onDisposeObserver.notifyObservers(this),this._makeDirtyMix()}toJson(){const e={};return Qb.forEach(n=>{this[n]&&(e[n]=this[n])}),e}getScene(){let e=this.parent;if(e!=null){if(e.classType===qt.SCENE)return e;for(;e;){if(e.classType===qt.SCENE)return e;e=e.getParent()}}}resetCursor(){var e;(e=this.getScene())==null||e.resetCursor()}setCursor(e){var n;this._cursor=e,(n=this.getScene())==null||n.setCursor(e)}getEngine(){let e=this.getParent();for(;e!=null;){if(e===qt.ENGINE)return e;e=e.getParent()}return null}getObjects(){return[]}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}_setTransForm(){const e=l1.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this._makeDirtyMix()}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}}var Im=(t=>(t[t.SECTION=0]="SECTION",t[t.PAGE=1]="PAGE",t[t.COLUMN=2]="COLUMN",t))(Im||{}),Z5=(t=>(t[t.PARAGRAPH=0]="PARAGRAPH",t[t.BLOCK=1]="BLOCK",t))(Z5||{}),Ko=(t=>(t[t.LETTER=0]="LETTER",t[t.WORD=1]="WORD",t[t.LIST=2]="LIST",t[t.PLACEHOLDER=3]="PLACEHOLDER",t[t.TAB=4]="TAB",t[t.IMAGE=5]="IMAGE",t[t.AT=6]="AT",t[t.MATH=7]="MATH",t[t.MULTI_LINE=8]="MULTI_LINE",t[t.CUSTOM=9]="CUSTOM",t))(Ko||{}),Ds=(t=>(t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.AUTO=2]="AUTO",t))(Ds||{});function cge(t){var e;const n=t==null?void 0:t.parent;return n==null?!1:((e=n.spanGroup[0])==null?void 0:e.spanType)===Ko.LIST}function dge(t,e){const n=Fx(t,e);if(n==null)return!1;const{paragraphStyle:r}=n;return r==null?!1:LW(r)}function mge(t){const e=t==null?void 0:t.parent,n=e==null?void 0:e.parent,r=e==null?void 0:e.spanGroup,i=n==null?void 0:n.divides;if(r&&t&&i&&e){const o=r.indexOf(t),a=i.indexOf(e);if(a===0&&o===0||a===0&&o===1&&r[0].spanType===Ko.LIST)return!0}return!1}function Fx(t,e){var n;const r=(n=t==null?void 0:t.parent)==null?void 0:n.parent;if(r==null||e==null)return;const i=e.paragraphs;if(i!=null){for(const o of i)if(o.startIndex===r.paragraphIndex)return o}}function fge(){let t=1;const e=Tx().getContext("2d");return t=(()=>{const n=window.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r})(),t<1?1:t}function $x(t,e,n){let r=0,i=0,o=0,a=0;const{startX:s,startY:u,endX:l,endY:c}=n;e===rr.TOP?(r=s,i=u,o=l,a=u):e===rr.BOTTOM?(r=s,i=c,o=l,a=c):e===rr.LEFT?(r=s,i=u,o=s,a=c):e===rr.RIGHT&&(r=l,i=u,o=l,a=c),t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),t.stroke()}function hge(t,e,n){let r=0,i=0,o=0,a=0;const{startX:s,startY:u,endX:l,endY:c}=n;e===rr.TL_BR?(r=s,i=u,o=l,a=c):e===rr.TL_BC?(r=s,i=u,o=(s+l)/2,a=c):e===rr.TL_MR?(r=s,i=u,o=l,a=(u+c)/2):e===rr.BL_TR?(r=s,i=c,o=l,a=u):e===rr.ML_TR?(r=s,i=(u+c)/2,o=l,a=u):e===rr.BC_TR&&(r=(s+l)/2,i=c,o=l,a=u),t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),t.stroke()}function pge(t,e,n){let r=0,i=0,o=0,a=0;const{startX:s,startY:u,endX:l,endY:c}=n;e===rr.TOP?(r=s,i=u,o=l,a=u):e===rr.BOTTOM?(r=s,i=c,o=l,a=c):e===rr.LEFT?(r=s,i=u,o=s,a=c):e===rr.RIGHT&&(r=l,i=u,o=l,a=c),t.beginPath(),t.clearRectForTexture(r,i,o-r,a-i)}function kx(t,e){e===Lt.HAIR?t.setLineDash([1,2]):e===Lt.DASH_DOT_DOT||e===Lt.MEDIUM_DASH_DOT_DOT?t.setLineDash([2,2,5,2,2]):e===Lt.DASH_DOT||e===Lt.MEDIUM_DASH_DOT||e===Lt.SLANT_DASH_DOT?t.setLineDash([2,5,2]):e===Lt.DOTTED?t.setLineDash([2]):e===Lt.DASHED||e===Lt.MEDIUM_DASHED?t.setLineDash([3]):t.setLineDash([0])}function Bx(t){let e=1;return t===Lt.MEDIUM||t===Lt.MEDIUM_DASH_DOT||t===Lt.MEDIUM_DASHED||t===Lt.MEDIUM_DASH_DOT_DOT?e=2:t===Lt.THICK&&(e=3),e}function p9(t,e,n,r,i=zt.create(0,0)){const o=t.add(e).rotateByPoint(r),a=o.subtract(e),s=r-n;return a.rotateByPoint(s,o).add(i).transformCoordinateOnRotate(s)}function gge(t){return t>0?f9.DOWN:f9.UP}function Ux(t,e,n){var r;const i=[];let o=0,a=0,s=0,u=0,l=0;const c=gge(n),d=t.length;n=Math.abs(n);const m=Math.tan(n),f=Math.sin(n),h=Math.cos(n);if(c===f9.UP){let p=0;for(let v=0;v<d;v++){const g=t[v],{lineHeight:b=0}=g;p+=v===0?0:b;const C=e*f+b*h;i.push(p/m),C>a&&(a=C),v===0&&(s+=b*f,l+=b*h)}s+=p/f+e*h,l-=a}else{let p=0,v=-1;const g=[];for(let S=d-1;S>=0;S--){const E=t[S],{lineHeight:y=0}=E,D=y/m,R=(e+D)*f;g.unshift(y/m),R>a&&(a=R,p=D,v=S),S===0?s+=y*f:S===d-1?s+=e*h+y/f:s+=y/f}let b=((r=t[v])==null?void 0:r.lineHeight)||0,C=0;for(let S=v+1;S<=d-1;S++){const E=t[S],{lineHeight:y=0}=E;b+=y,C+=g[S]||0,i[S]=-C}C=0;for(let S=v-1;S>=0;S--){const E=t[S],{lineHeight:y=0}=E;C+=g[S+1]||0,i[S]=C,o+=y}i[v]=0,d===1&&(s+=e*h),u=b/f-p*h}return{rotateTranslateXList:i,rotatedHeight:a,rotatedWidth:s,fixOffsetX:u,fixOffsetY:l,rotateTranslateY:o}}var dr=(t=>(t[t.PointerMove=0]="PointerMove",t[t.PointerDown=1]="PointerDown",t[t.PointerUp=2]="PointerUp",t[t.Dblclick=3]="Dblclick",t[t.Keyboard=4]="Keyboard",t))(dr||{});let og=class{};w(og,"DOM_DELTA_PIXEL",0),w(og,"DOM_DELTA_LINE",1),w(og,"DOM_DELTA_PAGE",2);var Ta=(t=>(t[t.Generic=0]="Generic",t[t.Keyboard=1]="Keyboard",t[t.Mouse=2]="Mouse",t[t.Touch=3]="Touch",t))(Ta||{}),kt=(t=>(t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical",t[t.LeftClick=2]="LeftClick",t[t.MiddleClick=3]="MiddleClick",t[t.RightClick=4]="RightClick",t[t.BrowserBack=5]="BrowserBack",t[t.BrowserForward=6]="BrowserForward",t[t.MouseWheelX=7]="MouseWheelX",t[t.MouseWheelY=8]="MouseWheelY",t[t.MouseWheelZ=9]="MouseWheelZ",t[t.DeltaHorizontal=10]="DeltaHorizontal",t[t.DeltaVertical=11]="DeltaVertical",t[t.FakeMove=12]="FakeMove",t))(kt||{});const vge=[new zt(0,0),new zt(1,1)];let bge=class{constructor(e=vge){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const n=[];for(let r=1;r<this._lines.length;r++){const i=this._lines[r-1],o=this._lines[r];for(let a=1;a<e.length;a++){const s=this._lines[r-1],u=this._lines[r],l=this._intersection({from:i,to:o},{from:s,to:u});l&&n.push(l)}}return n}_intersection(e,n){const r=e.from,i=e.to,o=n.from,a=n.to,s=(r.x-o.x)*(i.y-o.y)-(r.y-o.y)*(i.x-o.x),u=(r.x-a.x)*(i.y-a.y)-(r.y-a.y)*(i.x-a.x);if(s*u>=0)return!1;const l=(o.x-r.x)*(a.y-r.y)-(o.y-r.y)*(a.x-r.x),c=l+s-u;if(l*c>=0)return!1;const d=l/(u-s),m=d*(i.x-r.x),f=d*(i.y-r.y);return new zt(r.x+m,r.y+f)}},_ge=class{constructor(e=30){w(this,"_enabled",!0),w(this,"_rollingFrameTime"),w(this,"_lastFrameTimeMs"),this._rollingFrameTime=new Cge(e)}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){const e=this._rollingFrameTime.history(0);return e===0?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}get isEnabled(){return this._enabled}sampleFrame(e=this.Now()){if(this._enabled){if(this._lastFrameTimeMs!=null){const n=e-this._lastFrameTimeMs;this._rollingFrameTime.add(n)}this._lastFrameTimeMs=e}}Now(){return performance&&performance.now?performance.now():Date.now()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}},Cge=class{constructor(e){w(this,"average",0),w(this,"variance",0),w(this,"_samples",[]),w(this,"_sampleCount",0),w(this,"_pos",0),w(this,"_m2",0),this._samples=new Array(e),this.reset()}add(e){let n;if(this.isSaturated()){const r=this._samples[this._pos];n=r-this.average,this.average-=n/(this._sampleCount-1),this._m2-=n*(r-this.average)}else this._sampleCount++;n=e-this.average,this.average+=n/this._sampleCount,this._m2+=n*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;const n=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(n-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){const n=this._samples.length;return(e%n+n)%n}};const Am={strokeWidth:1,stroke:"rgba(0,0,0, 0)",strokeActive:"rgba(0,0,0, 1)",fill:"rgba(0, 0, 0, 0.2)"};var g0=(t=>(t.NONE="none",t.BACKWARD="backward",t.FORWARD="forward",t))(g0||{});function b6(t){const e=t.getScene(),n=t.getViewportByCoord(e),r=0,i=0;if(!n)return{scrollX:r,scrollY:i};const o=n.getActualScroll(n.scrollX,n.scrollY);return{scrollX:o.x,scrollY:o.y}}const n0=90;function Vx(t){const{a:e=0,v:n=we.FALSE}=t;let r=0,i=e;return n===we.TRUE&&(r=n0,i=n0),{centerAngle:r,vertexAngle:i}}let Hx=class{constructor(e){w(this,"canvas"),w(this,"_context"),this._context=e,this.canvas=e.canvas}get globalAlpha(){return this._context.globalAlpha}set globalAlpha(e){this._context.globalAlpha=e}get globalCompositeOperation(){return this._context.globalCompositeOperation}set globalCompositeOperation(e){this._context.globalCompositeOperation=e}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}get filter(){return this._context.filter}set filter(e){this._context.filter=e}get imageSmoothingEnabled(){return this._context.imageSmoothingEnabled}set imageSmoothingEnabled(e){this._context.imageSmoothingEnabled=e}get imageSmoothingQuality(){return this._context.imageSmoothingQuality}set imageSmoothingQuality(e){this._context.imageSmoothingQuality=e}get lineCap(){return this._context.lineCap}set lineCap(e){this._context.lineCap=e}get lineDashOffset(){return this._context.lineDashOffset}set lineDashOffset(e){this._context.lineDashOffset=e}get lineJoin(){return this._context.lineJoin}set lineJoin(e){this._context.lineJoin=e}get lineWidth(){return this._context.lineWidth}set lineWidth(e){const{scaleX:n,scaleY:r}=this._getScale();this._context.lineWidth=e/Math.max(n,r)}setLineWidthNative(e){this._context.lineWidth=e}get miterLimit(){return this._context.miterLimit}set miterLimit(e){this._context.miterLimit=e}get shadowBlur(){return this._context.shadowBlur}set shadowBlur(e){this._context.shadowBlur=e}get shadowColor(){return this._context.shadowColor}set shadowColor(e){this._context.shadowColor=e}get shadowOffsetX(){return this._context.shadowOffsetX}set shadowOffsetX(e){this._context.shadowOffsetX=e}get shadowOffsetY(){return this._context.shadowOffsetY}set shadowOffsetY(e){this._context.shadowOffsetY=e}get direction(){return this._context.direction}set direction(e){this._context.direction=e}get font(){return this._context.font}set font(e){this._context.font=e}get fontKerning(){return this._context.fontKerning}set fontKerning(e){this._context.fontKerning=e}get textAlign(){return this._context.textAlign}set textAlign(e){this._context.textAlign=e}get textBaseline(){return this._context.textBaseline}set textBaseline(e){this._context.textBaseline=e}_getScale(){const e=this.getTransform();return{scaleX:e.a,scaleY:e.d}}getContextAttributes(){return this._context.getContextAttributes()}isPointInStroke(...e){return this._context.isPointInStroke(...e)}createConicGradient(e,n,r){return this._context.createConicGradient(e,n,r)}roundRect(e,n,r,i,o){const{scaleX:a,scaleY:s}=this._getScale();e=rn(e,a),n=rn(n,s),r=rn(r,a),i=rn(i,s),this._context.roundRect(e,n,r,i,o)}getTransform(){return this._context.getTransform()}resetTransform(){this._context.resetTransform()}drawFocusIfNeeded(...e){return this._context.drawFocusIfNeeded(...e)}reset(){this._context.reset()}arc(e,n,r,i,o,a){const{scaleX:s,scaleY:u}=this._getScale();e=rn(e,s),n=rn(n,u),this._context.arc(e,n,r,i,o,a)}arcTo(e,n,r,i,o){const{scaleX:a,scaleY:s}=this._getScale();e=rn(e,a),n=rn(n,s),r=rn(r,a),i=rn(i,s),this._context.arcTo(e,n,r,i,o)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,r,i,o,a){const{scaleX:s,scaleY:u}=this._getScale();o=rn(o,s),a=rn(a,u),e=rn(e,s),n=rn(n,u),r=rn(r,s),i=rn(i,u),this._context.bezierCurveTo(e,n,r,i,o,a)}clearRect(e,n,r,i){const{scaleX:o,scaleY:a}=this._getScale();e=rn(e,o),n=rn(n,a),r=rn(r,o),i=rn(i,a),this._context.clearRect(e,n,r,i)}clip(...e){this._context.clip(...e)}closePath(){this._context.closePath()}createImageData(...e){if(e.length===0)throw new Error("arguments is zero");return e.length===1?this._context.createImageData(e[0]):e.length===2?this._context.createImageData(e[0],e[1]):this._context.createImageData(e[0],e[1],e[1])}createLinearGradient(e,n,r,i){return this._context.createLinearGradient(e,n,r,i)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,r,i,o,a){return this._context.createRadialGradient(e,n,r,i,o,a)}drawImage(...e){const n=e,r=this._context;n.length===3?r.drawImage(e[0],e[1],e[2]):n.length===5?r.drawImage(e[0],e[1],e[2],e[3],e[4]):n.length===9&&r.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}ellipse(e,n,r,i,o,a,s,u){this._context.ellipse(e,n,r,i,o,a,s,u)}isPointInPath(...e){return this._context.isPointInPath(...e)}fill(...e){this._context.fill(...e)}fillRect(e,n,r,i){const{scaleX:o,scaleY:a}=this._getScale();e=rn(e,o),n=rn(n,a),r=rn(r,o),i=rn(i,a),this._context.fillRect(e,n,r,i)}strokeRect(e,n,r,i){const{scaleX:o,scaleY:a}=this._getScale();e=rn(e,o),n=rn(n,a),r=rn(r,o),i=rn(i,a),this._context.strokeRect(e,n,r,i)}fillText(e,n,r,i){i?this._context.fillText(e,n,r,i):this._context.fillText(e,n,r)}fillTextPrecision(e,n,r,i){const{scaleX:o,scaleY:a}=this._getScale();n=rn(n,o),r=rn(r,a),i?(i=rn(i,o),this._context.fillText(e,n,r,i)):this._context.fillText(e,n,r)}measureText(e){return this._context.measureText(e)}getImageData(e,n,r,i){return this._context.getImageData(e,n,r,i)}lineTo(e,n){const{scaleX:r,scaleY:i}=this._getScale();e=rn(e,r),n=rn(n,i),this._context.lineTo(e,n)}moveTo(e,n){const{scaleX:r,scaleY:i}=this._getScale();e=rn(e,r),n=rn(n,i),this._context.moveTo(e,n)}rect(e,n,r,i){const{scaleX:o,scaleY:a}=this._getScale();e=rn(e,o),n=rn(n,a),r=rn(r,o),i=rn(i,a),this._context.rect(e,n,r,i)}putImageData(e,n,r){this._context.putImageData(e,n,r)}quadraticCurveTo(e,n,r,i){this._context.quadraticCurveTo(e,n,r,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(...e){this._context.setTransform(...e)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,r,i){const{scaleX:o,scaleY:a}=this._getScale();n=rn(n,o),r=rn(r,a),i&&(i=rn(i,o)),this._context.strokeText(e,n,r,i)}transform(e,n,r,i,o,a){this._context.transform(e,n,r,i,o,a)}translate(e,n){this._context.translate(e,n)}translateWithPrecision(e,n){const{scaleX:r,scaleY:i}=this._getScale();e=rn(e,r),n=rn(n,i),this._context.translate(e,n)}translateWithPrecisionRatio(e,n){const{scaleX:r,scaleY:i}=this._getScale();this._context.translate(e/r,n/i)}clearRectForTexture(e,n,r,i){this.clearRect(e,n,r,i)}setGlobalCompositeOperation(e){this._context.globalCompositeOperation=e}},Sge=class extends Hx{},Ege=class extends Hx{__getScale(){const e=this.getTransform();return{scaleX:e.a,scaleY:e.d}}clearRect(e,n,r,i){const{scaleX:o,scaleY:a}=this.__getScale();e=rn(e,o),n=rn(n,a),r=rn(r,o),i=rn(i,a),this._context.save(),this._context.fillStyle=la([255,255,255]),this._context.fillRect(e,n,r,i),this._context.restore()}clearRectForTexture(e,n,r,i){}setGlobalCompositeOperation(e){}};class gE{constructor(e){w(this,"isCache",!1),w(this,"_pixelRatio",1),w(this,"_canvasEle"),w(this,"_context"),w(this,"_width",0),w(this,"_height",0);var n,r;e=e||{},this._canvasEle=Tx(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",e.mode===1?this._context=new Ege((n=this._canvasEle)==null?void 0:n.getContext("2d")):this._context=new Sge((r=this._canvasEle)==null?void 0:r.getContext("2d")),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,n,r){this._pixelRatio=r||fge(),e&&(this._canvasEle.width=e*this._pixelRatio,this._width=this._canvasEle.width/this._pixelRatio,this._canvasEle.style.width=`${this._width}px`),n&&(this._canvasEle.height=n*this._pixelRatio,this._height=this._canvasEle.height/this._pixelRatio,this._canvasEle.style.height=`${this._height}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){this._width===0||this._height===0||(e<1&&(e=1),this.setSize(this._width,this._height,e))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,n){try{return this._canvasEle.toDataURL(e,n)}catch{try{return this._canvasEle.toDataURL()}catch(r){const{message:i}=r;return console.error(`Unable to get data URL. ${i} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}let jx=class extends M0{constructor(){super(...arguments),w(this,"_extensions",new Map)}get extensions(){return this._extensions}register(...e){for(const n of e)n.parent=this,this._extensions.set(n.uKey,n)}unRegister(...e){for(const n of e)this._extensions.delete(n)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(gs),e}getExtensionByKey(e){return this._extensions.get(e)}draw(e,n){}};function yge(){return[]}function Dge(t,e,n){return Rge(t,e,n)}function Rge(t,e,n){return n===Js.DECIMAL?GI(t,e):n===Js.ZERO_DECIMAL?Ige(t,e):n===Js.UPPER_ALPHA?Age(t,e):n===Js.ALPHA?Tge(t,e):n===Js.UPPER_ROMAN?wge(t,e):n===Js.ROMAN?Lge(t,e):GI(t,e)}function GI(t,e){return(t+e).toString()}function Ige(t,e){const n=t+e;return n<10?`0${n}`:n.toString()}function Age(t,e){return wL(t+e-1,!0)}function Tge(t,e){return wL(t+e-1,!1)}function wge(t,e){return zx(t+e,!0)}function Lge(t,e){return zx(t+e,!1)}function zx(t,e=!1){const n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let r={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(r=n);let i="";for(const o in r)for(;t>=r[o];)i+=o,t-=r[o];return i}function Oge(t,e,n,r){var i,o;if(!t||!e)return;const{listId:a,listType:s,nestingLevel:u=0,textStyle:l}=t,c=e[s];return!c||!c.nestingLevel?KI(a,(i=n==null?void 0:n[u])==null?void 0:i.startIndexItem):c.nestingLevel[u]?Pge(a,u,c.nestingLevel,n,l):KI(a,(o=n==null?void 0:n[u])==null?void 0:o.startIndexItem)}function KI(t,e=1){return{listId:t,symbol:"●",ts:{ff:"Arial",fs:9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function Pge(t,e,n,r,i,o){var a,s;const u=n[e],{bulletAlignment:l,glyphFormat:c,textStyle:d,startNumber:m,glyphType:f,glyphSymbol:h,indentFirstLine:p,hanging:v,indentStart:g}=u,b={...i,...d},C=h9(b);let S;h?S=h:S=Mge(c,e,n,r);const E=ku.getTextSize(S,C),y=(s=(a=r==null?void 0:r[e])==null?void 0:a.startIndexItem)!=null?s:1;return{listId:t,symbol:S,ts:b,fontStyle:C,startIndexItem:y+1,bBox:E,nestingLevel:u,bulletAlign:l,bulletType:h?!1:!!f,indentFirstLine:p,hanging:v,indentStart:g}}function Mge(t,e,n,r){var i;const o=t.split("%"),a=[o[0]];for(let s=1;s<o.length;s++){const u=o[s],{level:l,suffix:c}=xge(u);let d=((i=r==null?void 0:r[l])==null?void 0:i.startIndexItem)||1;l!==e&&(r==null?void 0:r[l])!==null&&(d-=1);const m=Nge(d,n[l]);a.push(m,c)}return a.join("")}function Nge(t=1,e){const{startNumber:n,glyphType:r,glyphSymbol:i}=e;return i||(r?Dge(t,n,r):"●")}function xge(t){if(t==="")return{level:0,suffix:""};const e=t.split("");let n="",r="",i=!1;const o=/[0-9]/g;return e.forEach(a=>{!i&&o.test(`${n}${a}`)?n+=a:(i=!0,r+=a)}),{level:Number.parseInt(n)-1,suffix:r}}function Fge(t,e,n,r,i){return[]}function N0(t){return t[t.length-1]}function vE(t){var e;return(e=t.sections)==null?void 0:e[t.sections.length-1]}function $ge(t){var e;const n=(e=g9(t))==null?void 0:e.column.lines;return n==null?void 0:n[n.length-1]}function kge(t){return t.lines[t.lines.length-1]}function g9(t){const e=vE(t);for(let n=0;n<e.columns.length;n++){const r=e.columns[n];if(!r.isFull)return{column:r,isLast:n===e.columns.length-1,index:n}}}function Bge(t){const e=$ge(t);if(e)for(let n=0;n<e.divides.length;n++){const r=e.divides[n];if(!r.isFull)return{divide:r,isLast:n===e.divides.length-1,index:n}}}function Uge(t){const e=vE(t),n=e.columns.length;for(let r=0;r<n;r++)if(!e.columns[r].isFull)return!1;return!0}function Uu(t,e){if(t instanceof Object){const{v:n,u:r}=t;return r===BL.POINT?n:n*e}return t}function bE(t=0,e,n=Uo.LINES,r=we.TRUE){let i=1;return Wx(n,r)&&(i=t),i*=e,i}function Wx(t=Uo.LINES,e=we.FALSE){return e===we.TRUE&&(t===Uo.LINES_AND_CHARS||t===Uo.SNAP_TO_CHARS)}function Yx(t,e){const{paragraphStyle:n={}}=e,{linePitch:r=15.6,gridType:i=Uo.LINES,paragraphLineGapDefault:o=0}=t,{lineSpacing:a=1,spacingRule:s=Th.AUTO,snapToGrid:u=we.TRUE}=n;return{paragraphLineGapDefault:o,linePitch:r,gridType:i,lineSpacing:a,spacingRule:s,snapToGrid:u}}function Vge(t,e){const{paragraphStyle:n={}}=e,{charSpace:r=0,gridType:i=Uo.LINES,defaultTabStop:o=36,documentTextStyle:a={}}=t,{fs:s=sle}=a,{snapToGrid:u=we.TRUE}=n;return{charSpace:r,documentFontSize:s,defaultTabStop:o,gridType:i,snapToGrid:u}}function Jb(t,e=-1){let n=e;for(const r of t){const{sections:i}=r,o=n;let a=o,s=Number.NEGATIVE_INFINITY,u=0;for(const l of i){const{columns:c}=l,d=a;let m=d,f=Number.NEGATIVE_INFINITY,h=0;for(const p of c){const{lines:v}=p,g=m;let b=g,C=0,S=Number.NEGATIVE_INFINITY,E=null;for(const y of v){const{divides:D,lineHeight:R}=y,I=b;let T=I,P=0,N=0;C+=R;const B=D.length;for(let W=0;W<B;W++){const G=D[W],{spanGroup:Q}=G,te=T;let X=te;for(const x of Q){const O=x.spanType===Ko.LIST?0:x.count;X+=O;const M=x.bBox,{ba:V}=M;N=Math.max(N,V),W===B-1&&(P+=x.width)}W===B-1&&(P+=G.left),Q.length!==0&&(G.st=te+1,G.ed=X>=G.st?X:G.st,T=G.ed)}y.st=I+1,y.ed=T>=y.st?T:y.st,y.width=P,y.asc=N,S=Math.max(S,P),y.top=((E==null?void 0:E.top)||0)+((E==null?void 0:E.lineHeight)||0),E=y,b=y.ed}p.st=g+1,p.ed=b>=p.st?b:p.st,p.height=C,p.width=S,h+=S,f=Math.max(f,p.height),m=p.ed}l.st=d+1,l.ed=m>=l.st?m:l.st,l.height=f,u+=f,s=Math.max(s,h),a=l.ed}r.st=o+1,r.ed=a>=r.st?a:r.st,r.height=u,r.width=s,n=r.ed}}function Hge(t,e){for(const n of t){const{sections:r}=n;for(const i of r){const{columns:o}=i;for(const a of o){const{lines:s}=a;for(const u of s)e&&Lx(e)&&e(u)}}}}function jge(t,e){for(const n of t){const{sections:r}=n;for(const i of r){const{columns:o}=i;for(const a of o)e&&Lx(e)&&e(a)}}}function zge(t,e,n,r,i=!1){const{relativeFrom:o,align:a,posOffset:s,percent:u}=t;if(a!=null)if(a===Iu.INSIDE||a===Iu.OUTSIDE)o===Hr.MARGIN||Hr.PAGE;else{if(o===Hr.COLUMN){const{width:l,left:c}=e;let d=0;return a===Iu.LEFT?d=c:a===Iu.RIGHT?d=c+l-r:a===Iu.CENTER&&(d=c+l/2-r/2),d}if(o!==Hr.LEFT_MARGIN&&o!==Hr.MARGIN&&o!==Hr.RIGHT_MARGIN&&o!==Hr.INSIDE_MARGIN&&o!==Hr.OUTSIDE_MARGIN&&o===Hr.PAGE){const{pageWidth:l}=n;let c=0;return a===Iu.RIGHT?c=l-r:a===Iu.CENTER&&(c=l/2-r/2),c}}else if(s){const{pageWidth:l,marginLeft:c,marginRight:d}=n,m=l-d;let f=0;return o===Hr.COLUMN?f=(i?0:(e==null?void 0:e.left)||0)+s:o===Hr.LEFT_MARGIN||(o===Hr.MARGIN?f=s+c:o===Hr.RIGHT_MARGIN||o===Hr.INSIDE_MARGIN||o===Hr.OUTSIDE_MARGIN||o===Hr.PAGE&&(f=s)),f+r>m&&(f=m-r),f}else if(u){const{pageWidth:l,marginLeft:c,marginRight:d}=n;if(o!==Hr.LEFT_MARGIN&&o!==Hr.MARGIN&&o!==Hr.RIGHT_MARGIN&&o!==Hr.INSIDE_MARGIN&&o!==Hr.OUTSIDE_MARGIN&&o===Hr.PAGE)return u*l}}function Wge(t,e,n,r,i,o,a=!1){const{relativeFrom:s,align:u,posOffset:l,percent:c}=t;if(u!=null){if(s===qr.LINE){let d=0;return u===N2.BOTTOM?d=n+r-i:u===N2.TOP?d=n:u===N2.CENTER&&(d=n+r/2-i/2),d}if(s!==qr.TOP_MARGIN&&s!==qr.MARGIN&&s!==qr.BOTTOM_MARGIN&&s!==qr.INSIDE_MARGIN&&s!==qr.OUTSIDE_MARGIN&&s===qr.PAGE){const{pageHeight:d}=e;let m=0;return u===N2.BOTTOM?m=d-i:u===N2.CENTER&&(m=d/2-i/2),m}}else if(l){let d=0;return s===qr.LINE?d=n||0+l:s===qr.TOP_MARGIN||s===qr.MARGIN||s===qr.BOTTOM_MARGIN||s===qr.INSIDE_MARGIN||s===qr.OUTSIDE_MARGIN||(s===qr.PAGE?d=l:s===qr.PARAGRAPH&&(d=(a?0:o??n)+l)),d}else if(c){const{pageHeight:d,marginBottom:m,marginTop:f}=e;if(s!==qr.TOP_MARGIN&&s!==qr.MARGIN&&s!==qr.BOTTOM_MARGIN&&s!==qr.INSIDE_MARGIN&&s!==qr.OUTSIDE_MARGIN&&s===qr.PAGE)return c*d}}function Yge(t){const e=t.spanGroup;let n=0;for(const r of e)n+=r.width;return n}const e_=new Ye;function Xge(){e_.reset()}function mf(t,e,n,r,i){const{startIndex:o}=n,a=e.getTextRun(t+o)||{ts:{},st:0,ed:0},{ts:s={},st:u,ed:l}=a,c=e_.getValue(u,l);if(c)return c;const{gridType:d=Uo.LINES,charSpace:m=0,documentTextStyle:f={},pageSize:h={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginRight:p=0,marginLeft:v=0,localeService:g}=r,{snapToGrid:b=we.TRUE}=i,C=h9(s),S={...f,...s},E=h.width||Number.POSITIVE_INFINITY-v-p,y={fontStyle:C,textStyle:S,charSpace:m,gridType:d,snapToGrid:b,pageWidth:E};return e_.setValue(u,l,y),y}function qge(t,e,n){return _E(Ko.WORD,t,e,n)}function Q5(t,e,n){return _E(Ko.LETTER,t,e,n)}function Gge(t,e){return _E(Ko.TAB,mn.TAB,t,e)}function _E(t,e,n,r){const{fontStyle:i,textStyle:o,charSpace:a=1,gridType:s=Uo.LINES,snapToGrid:u=we.FALSE}=n,l=[mn.SECTION_BREAK,mn.TABLE_START,mn.TABLE_END,mn.TABLE_ROW_START,mn.TABLE_ROW_END,mn.TABLE_CELL_START,mn.TABLE_CELL_END,mn.CUSTOM_RANGE_START,mn.CUSTOM_RANGE_END,mn.COLUMN_BREAK,mn.PAGE_BREAK,mn.DOCS_END,mn.CUSTOM_BLOCK];let c=mn.LETTER;if(l.indexOf(e)>-1)return{content:"",ts:o,fontStyle:i,width:0,bBox:{width:0,ba:0,bd:0,aba:0,abd:0,sp:0,sbr:0,sbo:0,spr:0,spo:0},paddingLeft:0,left:0,spanType:Ko.PLACEHOLDER,streamType:e,count:1};e===mn.PARAGRAPH&&(c=mn.PARAGRAPH);const d=ku.getTextSize(e,i),{width:m=0}=d;let f=r??m,h=0;return Wx(s,u)&&(f=m+(pE(e)?a:a/2),s===Uo.SNAP_TO_CHARS&&(h=(f-m)/2)),{content:e,ts:o,fontStyle:i,width:f,bBox:d,paddingLeft:h,left:0,spanType:t,streamType:c,count:e.length}}function Kge(t,e,n){const{bBox:r,symbol:i,ts:o,fontStyle:a,bulletAlign:s=e1.START,bulletType:u=!1}=e,l=r.width,c=Math.ceil(l/n);let d=(c<2?2:c)*n,m=0;u&&(s===e1.CENTER?(m=-l/2,d-=m):s===e1.END&&(m=-l,d-=m));const f=Qge(t,e);return{content:i,ts:o,fontStyle:a,width:d,paddingLeft:0,bBox:f,left:m,spanType:Ko.LIST,streamType:mn.LETTER,count:0}}function Zge(t,e=0){const n=t.length;let r;for(let i=0;i<n;i++){const o=t[i];o.left=r?r.left+r.width:e,r=o}}function ag(t,e,n=0){Zge(e,n);for(const r of e)r.parent=t;t.spanGroup.push(...e)}function Qge(t,e){const{ba:n,bd:r}=t.bBox,{ba:i,bd:o}=e.bBox;return n+r>i+o?t.bBox:e.bBox}function Jge(t,e){if(t==null)return!1;const{content:n}=t,{content:r}=e;if(n==null||r==null)return!1;const i=/[a-z\d]/i;return i.test(n)&&Zb(r)||Zb(n)&&i.test(r)}function eve(t,e,n,r,i,o){const a=[];let s=0;for(let u=0;u<e.length;u++){const l=e[u];if(nge(l)||Ox(e.substring(u)))break;const c=mf(t+u,n,r,i,o),d=Q5(l,c);a.push(d),s++}return{step:s,spanGroup:a}}function tve(t,e,n,r,i,o){const a=mf(t,n,r,i,o),s=[];let u=0;for(let l=0;l<e.length;l++){const c=e[l];if(Px(c))s.unshift(c),u++;else break}return{step:u,spanGroup:[Q5(s.join(""),a)]}}function nve(t,e,n,r,i,o){const a=mf(t,n,r,i,o),s=e.match(ege);return{step:s[0].length,spanGroup:[Q5(s[0],a)]}}function rve(t,e,n,r,i,o){const a=mf(t,n,r,i,o),s=[];let u=0;for(let l=0;l<e.length;l++){const c=e[l];if(Mx(c))s.push(c),u++;else break}return{step:u,spanGroup:[qge(s.join(""),a)]}}function ive(t,e,n,r,i=0,o=!1,a,s,u){const{lineHeight:l=15.6,lineTop:c=0,contentHeight:d=0,paddingLeft:m=0,paddingRight:f=0,paddingTop:h=0,paddingBottom:p=0,marginTop:v=0,spaceBelowApply:g=0}=n,b=dve(e,t);b.lineIndex=i,b.paragraphStart=o,b.contentHeight=d,b.top=c,b.lineHeight=l,b.paddingTop=h,b.paddingBottom=p,b.marginTop=v,b.spaceBelowApply=g,b.divides=ave(l,c,r,m,f,a,s,u);for(const C of b.divides)C.parent=b;return b}function ove(t=15.6,e=0,n,r,i){let o=e;return r==null||r.forEach(a=>{const s=sg(a,t,e);s&&(o=Math.max(o,s))}),i==null||i.forEach(a=>{const s=sg(a,t,e);s&&(o=Math.max(o,s))}),n==null||n.forEach(a=>{const s=sg(a,t,e);s&&(o=Math.max(o,s))}),o}function sg(t,e,n){const{aTop:r,height:i,aLeft:o,width:a,angle:s=0,drawingOrigin:u}=t,{layoutType:l,distT:c=0,distB:d=0}=u;if(l!==i1.WRAP_TOP_AND_BOTTOM)return;if(s===0){const h=r-c,p=i+d;return h+p<n||h>e+n?void 0:h+i}let{top:m=0,height:f=0}=Xx(s,o,a,r,i);if(m-=c,f+=d,!(m+f<n||m>e+n))return m+f}function ave(t,e,n,r,i,o,a,s){const u=[];return u.push({left:0,width:r},{left:n-i,width:i}),a==null||a.forEach((l,c)=>{const d=ug(l,t,e,n);d&&u.push(d)}),s==null||s.forEach((l,c)=>{const d=ug(l,t,e,n);d&&u.push(d)}),o==null||o.forEach((l,c)=>{const d=ug(l,t,e,n);d&&u.push(d)}),cve(n,u)}function sve(t,e){t.isFull=e}function ug(t,e,n,r){const{aTop:i,height:o,aLeft:a,width:s,angle:u=0,drawingOrigin:l}=t,{layoutType:c}=l;if(c===i1.WRAP_NONE||c===i1.WRAP_TOP_AND_BOTTOM)return;if(c===i1.WRAP_POLYGON){const{start:m=[0,0],lineTo:f}=l;if(!f)return;const h=[];h.push(new zt(m[0],m[1]));for(let p=0;p<f.length;p++){const v=f[p];h.push(new zt(v[0],v[1]))}if(u!==0){const p=new l1().rotate(u);for(let v=0;v<h.length;v++){const g=h[v];h[v]=p.applyPoint(g)}}return ZI(h,n,e,r)}if(u===0)return QI(i,o,a,s,n,e,r,l);const d=Xx(u,a,s,i,o);if(c===i1.WRAP_SQUARE){const{left:m,width:f,top:h,height:p}=d;return QI(h,p,m,f,n,e,r,l)}return ZI(d.points,n,e,r)}function Xx(t,e,n,r,i){const o=new l1().rotate(t),a=new zt(e,r),s=new zt(e,r+i),u=new zt(e+n,r),l=new zt(e+n,r+i);return o.makeBoundingBoxFromPoints([a,s,u,l])}function ZI(t,e,n,r){const i=new bge(t),o=i.intersection([new zt(0,e),new zt(r,e)]),a=i.intersection([new zt(0,e+n),new zt(r,e+n)]);if(!o&&!a)return;const s=uve([...t,...o||[],...a||[]]);return{left:s.min,width:s.max}}function uve(t,e=0){const n=[];for(let r=0;r<t.length;r++){const i=t[r];e===0?n.push(i.x):n.push(i.y)}return{max:Math.max(...n),min:Math.min(...n)}}function QI(t,e,n,r,i,o,a,s){const{layoutType:u,wrapText:l=A6.BOTH_SIDES,distL:c=0,distR:d=0,distT:m=0,distB:f=0}=s,h=t-(u===i1.WRAP_SQUARE?m:0),p=e+(u===i1.WRAP_SQUARE?f:0);if(h+p<i||h>o+i)return;let v=n-c,g=r+d;const b=lve(l,v,g,a);return b===1?g=a-v:b===2&&(v=0,g=n+r+d),{left:v,width:g}}function lve(t,e,n,r){let i=0;return t===A6.LEFT?i=1:t===A6.RIGHT?i=2:t===A6.LARGEST&&(e>r-e-n?i=1:i=2),i}function cve(t,e){e.sort((o,a)=>o.left>a.left?1:-1);const n=[];let r=0;const i=e.length;for(let o=0;o<i;o++){const a=e[o],{left:s,width:u}=a;if(s>r){let l=s-r;l=l<t?l:t-r;const c=JI(r,l);n.push(c)}if(r=Math.max(s+u,r),o===i-1&&s+u<t){const l=JI(s+u,t-s-u);n.push(l)}}return n}function JI(t,e){return{spanGroup:[],width:e,left:t,paddingLeft:0,isFull:!1,st:0,ed:0}}function dve(t,e){return{paragraphIndex:e,type:t,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}function mve(t,e,n,r){if(r)if(r.has(t)){const i=r.get(t);i==null||i.elements.push(e)}else r.set(t,{elements:[e],paragraphIndex:t,top:n})}function qx(t,e,n,r,i,o){const a=[],s=new Map;for(const u of e.children){let l=[],c=n;a.length>0&&(c=a[a.length-1]),u.nodeType===si.PARAGRAPH?l=cbe(t,u,c,r,i):(u.nodeType,si.TABLE),l.length===0&&(l=yge()),fve(a,l)}return{pages:a,renderedBlockIdMap:s}}function fve(t,e){const n=t.length-1,r=t[n],i=e[0];r===i&&e.splice(0,1),t.push(...e)}function Gx(t=[],e=em.NONE,n=0,r=0,i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY){const a=[];let s=0,u=0;if(t.length===0)a.push(lg(r,i,0,em.NONE));else for(let c=0;c<t.length;c++){const{width:d,paddingEnd:m}=t[c];u=m,s=d,a.push(lg(r,s,u,e)),r+=s+u,c===t.length-1&&(s=i!==Number.POSITIVE_INFINITY?i-s:d,u=0,a.push(lg(r,s,u,e)))}const l={columns:a,colCount:(t==null?void 0:t.length)||1,height:o,top:n,st:0,ed:0};return a.forEach(c=>{c.parent=l}),l}function Kx(t,e){t.isFull=e}function lg(t,e,n,r){return{lines:[],left:t,width:e,height:0,spaceWidth:n,separator:r,st:0,ed:0,drawingLRIds:[],isFull:!1}}function Tm(t,e,n=1,r=Im.SECTION){var i,o,a,s;const u=hve(),{pageNumberStart:l=1,pageSize:c={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},pageOrient:d=i5.PORTRAIT,headerIds:m={},footerIds:f={},useFirstPageHeaderFooter:h,useEvenPageHeaderFooter:p,footerTreeMap:v,headerTreeMap:g,columnProperties:b=[],columnSeparatorType:C,marginTop:S=0,marginBottom:E=0,marginHeader:y=0,marginFooter:D=0,marginLeft:R=0,marginRight:I=0,renderConfig:T={}}=t,{skeHeaders:P,skeFooters:N}=e,{width:B=Number.POSITIVE_INFINITY,height:W=Number.POSITIVE_INFINITY}=c;u.pageNumber=n,u.pageNumberStart=l,u.renderConfig=T,u.marginLeft=R,u.marginRight=I,u.breakType=r,u.pageWidth=B,u.width=0,u.pageHeight=W,u.height=0,u.pageOrient=d;const{defaultHeaderId:G,evenPageHeaderId:Q,firstPageHeaderId:te}=m,{defaultFooterId:X,evenPageFooterId:x,firstPageFooterId:O}=f;let M=G??"",V=X??"";n===l&&h?(M=te??"",V=O??""):n%2===0&&p&&(M=Q??"",V=x??"");let q,ie;M&&((i=P.get(M))!=null&&i.has(B)?q=(o=P.get(M))==null?void 0:o.get(B):g&&g.has(M)&&(q=eA(g.get(M),t,e),P.set(M,new Map([[B,q]]))),u.headerId=M),V&&((a=N.get(V))!=null&&a.has(B)?ie=(s=N.get(V))==null?void 0:s.get(B):v&&v.has(V)&&(ie=eA(v.get(V),t,e),N.set(M,new Map([[B,ie]]))),u.footerId=V),u.marginTop=tA(S,y,q),u.marginBottom=tA(E,D,ie);const ce=u.sections,pe=ce[ce.length-1],{marginTop:oe,marginBottom:he,marginLeft:fe,marginRight:ve}=u,Ue=B-fe-ve,ke=W-oe-he;let Te=0;pe&&(Te=pe.top+pe.height);const Re=Gx(b,C,Te,0,Ue,ke-Te);return Re.parent=u,ce.push(Re),u}function hve(){return{sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:i5.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:Im.SECTION,st:0,ed:0,skeDrawings:new Map}}function eA(t,e,n,r=!0){const{lists:i,footerTreeMap:o,headerTreeMap:a,localeService:s,pageSize:u,marginLeft:l=0,marginRight:c=0,drawings:d,marginTop:m=0,marginBottom:f=0,marginHeader:h=0,marginFooter:p=0}=e,v=(u==null?void 0:u.width)||Number.POSITIVE_INFINITY,g={lists:i,footerTreeMap:o,headerTreeMap:a,pageSize:{width:v-l-c,height:Number.POSITIVE_INFINITY},localeService:s,drawings:d},b=Tm(g,n),C=qx(t,t.children[0],b,g,n).pages[0];Jb([C]);const S=C.sections[0].columns[0],E=S.height||0,{skeDrawings:y,st:D,ed:R}=C,I={lines:S.lines,skeDrawings:y,height:E,st:D,ed:R,marginLeft:l,marginRight:c};return r?{...I,marginTop:pve(m,h,E)}:{...I,marginBottom:gve(f,p,E)}}function tA(t,e,n){return!n||n.lines.length===0?t:Math.max(t,e,(n==null?void 0:n.height)||0)}function pve(t,e,n){const r=Math.max(t,e);return n>r?0:r-n}function gve(t,e,n){const r=Math.max(t,e);return n>r?0:r-n}function vve(t,e,n,r,i=!1){if(i)if(r.bulletSkeleton){const{bulletSkeleton:o,paragraphStyle:a={}}=r,{gridType:s=Uo.LINES,charSpace:u=0,defaultTabStop:l=1}=n,{snapToGrid:c=we.TRUE}=a,d=bE(u,l,s,c);Dve(a,o,d);const m=Kge(t[0],o,d);cc([m,...t],e,n,r,i)}else cc(t,e,n,r,i);else v9(t,e,n,r,i);return[...e]}function v9(t,e,n,r,i=!1,o=!0,a){var s;const u=N0(e),l=Bge(u);if(l){const c=nA(t),{divide:d}=l,m=(s=d==null?void 0:d.spanGroup)==null?void 0:s[d.spanGroup.length-1],f=(m==null?void 0:m.width)||0,h=(m==null?void 0:m.left)||0,p=Jge(m,t[0]);let v=0,g=f+h;if(p&&o){const b=Zb(m.content);v=ku.getTextSize(" ",b?t[0].fontStyle:m.fontStyle).width,g+=v,m.width+=v}if(g+c>d.width)if(sve(d,!0),l.isLast&&t.length===1&&(t[0].content===mn.SPACE||t[0].content===mn.PARAGRAPH))ag(d,t,g);else if((d==null?void 0:d.spanGroup.length)===0){const b=[];for(;t.length&&(b.push(t.shift()),!(nA(b)>d.width)););ag(d,b,g),t.length&&cc(t,e,n,r,i,a)}else cc(t,e,n,r,i,a);else{const b=d.parent,C=Eve(t);if(b&&C&&!Rve(b)){const{paragraphLineGapDefault:S,linePitch:E,lineSpacing:y,spacingRule:D,snapToGrid:R,gridType:I}=Yx(n,r),{boundingBoxAscent:T,boundingBoxDescent:P}=C,N=T+P,{contentHeight:B}=Jx(N,S,E,I,y,D,R);if(b.contentHeight<B){const W=yve(b),G=W.length;let Q=[],te=1;G>2&&W[0].spanType===Ko.LIST?(Q=[W[0],W[1]],te=2):Q=[W[0]];const X=b.parent,{paragraphStart:x}=X==null?void 0:X.lines.pop();cc(Q,e,n,r,x,T+P);for(let O=te;O<W.length;O++)v9([W[O]],e,n,r,i,!1);v9(t,e,n,r,i,!1);return}}ag(d,t,g)}}else cc(t,e,n,r,i,a)}function cc(t,e,n,r,i=!1,o){var a,s,u,l,c;let d=N0(e),m=g9(d);if((!m||!m.column)&&(Qx(t,e,n,r),d=N0(e),m=g9(d)),!m)return;const f=m.column,h=kge(f),p=Math.max(...t.map(Zt=>Zt.bBox.ba)),v=Math.max(...t.map(Zt=>Zt.bBox.bd)),g=o||p+v,{paragraphStyle:b={},paragraphAffectSkeDrawings:C,skeHeaders:S,skeFooters:E,drawingAnchor:y,paragraphIndex:D}=r,{spaceAbove:R=0,spaceBelow:I=0,indentFirstLine:T=0,hanging:P=0,indentStart:N=0,indentEnd:B=0}=b,{paragraphLineGapDefault:W,linePitch:G,lineSpacing:Q,spacingRule:te,snapToGrid:X,gridType:x}=Yx(n,r),{paddingTop:O,paddingBottom:M,contentHeight:V,lineSpacingApply:q}=Jx(g,W,G,x,Q,te,X),{marginTop:ie,spaceBelowApply:ce}=_ve(q,R,I,i,h),pe=ie+O+V+M;let oe=f.parent;oe||(oe=vE(d));const he=(h==null?void 0:h.lineHeight)||0,fe=(h==null?void 0:h.top)||0,ve=he+fe,{pageWidth:Ue,headerId:ke,footerId:Te}=d,Re=(s=(a=S==null?void 0:S.get(ke))==null?void 0:a.get(Ue))==null?void 0:s.skeDrawings,rt=(l=(u=E==null?void 0:E.get(Te))==null?void 0:u.get(Ue))==null?void 0:l.skeDrawings;Cve(ve,pe,f,(c=y==null?void 0:y.get(D))==null?void 0:c.top,C);const _t=ove(pe,ve,d.skeDrawings,Re,rt);if(pe+_t>oe.height&&f.lines.length>0&&d.sections.length>0){Kx(f,!0),Zx(t,e,n,r,i,o);return}const mt=h?h.lineIndex+1:0,{charSpace:nt,defaultTabStop:_e}=Vge(n,r),He=bE(nt,_e,x,X),{paddingLeft:et,paddingRight:Dt,changeBulletWidth:Mt}=bve(t[0],T,P,N,B,He);Mt.state&&(t[0].width=Mt.hangingNumber);const Bt=ive(D,Z5.PARAGRAPH,{lineHeight:pe,contentHeight:V,lineTop:_t,paddingLeft:et,paddingRight:Dt,paddingTop:O,paddingBottom:M,marginTop:ie,spaceBelowApply:ce},f.width,mt,i,d.skeDrawings,Re,rt);f.lines.push(Bt),Bt.parent=f,mve(D,Bt,ve,y),v9(t,e,n,r,i,!0,o)}function Zx(t,e,n,r,i=!1,o){const a=N0(e);Uge(a)===!0?Qx(t,e,n,r,i,o):cc(t,e,n,r,i,o)}function Qx(t,e,n,r,i=!1,o){const a=N0(e),{skeHeaders:s,skeFooters:u}=r;e.push(Tm(n,{skeHeaders:s,skeFooters:u},a==null?void 0:a.pageNumber)),Zx(t,e,n,r,i,o)}function bve(t,e=0,n=0,r=0,i=0,o){const{spanType:a=Ko.LETTER,bBox:s}=t,u=Uu(e,o),l=Uu(n,o),c=Uu(r,o),d=Uu(i,o);let m=c;const f=d,h={state:!1,hangingNumber:0};if(a===Ko.LIST){const{width:p}=s;u>0?m+=u:l>0&&l>p&&(h.state=!0,h.hangingNumber=l)}else m+=l;return{paddingLeft:m,paddingRight:f,changeBulletWidth:h}}function _ve(t=0,e=0,n=0,r,i){let o=0,a=0;if(!r)return{marginTop:o,spaceBelowApply:a};if(o=Uu(e,t),a=Uu(n,t),i){const{spaceBelowApply:s}=i;s>o&&(o=0,i.lineHeight+=s,i.marginBottom=s)}return{marginTop:o,spaceBelowApply:a}}function Jx(t,e,n,r,i,o,a){let s=e,u=e;if(r===Uo.DEFAULT||a===we.FALSE)return o===Th.AUTO?{paddingTop:s,paddingBottom:u,contentHeight:i*t,lineSpacingApply:t}:{paddingTop:s,paddingBottom:u,contentHeight:Math.max(i,t),lineSpacingApply:i};let l=0;return o===Th.AUTO?l=i*n:l=i,t+e*2<l&&(s=u=(l-t)/2),{paddingTop:s,paddingBottom:u,contentHeight:t,lineSpacingApply:l}}function Cve(t,e,n,r,i){var o;if(!i)return;const a=(o=n.parent)==null?void 0:o.parent;if(!a)return;const s=new Map,u=Sve(n);i.forEach(l=>{if(!l)return;const{initialState:c,drawingOrigin:d}=l;if(c||!d)return;const{objectTransform:m}=d,{positionH:f,positionV:h,size:p,angle:v}=m,{width:g=0,height:b=0}=p;l.aLeft=zge(f,n,a,g,u)||0,l.aTop=Wge(h,a,t,e,b,r,u)||0,l.width=g,l.height=b,l.angle=v,l.initialState=!0,s.set(l.objectId,l)}),a.skeDrawings=new Map([...a.skeDrawings,...s])}function Sve(t){const e=t.parent;if(!e)return!1;const n=e==null?void 0:e.columns;if(!n)return!1;const r=n.length;for(let i=r-1;i>=0;i--){const o=n[i].lines,a=o.length;if(!(a<=0)){for(let s=a-1;s>=0;s--)if(o[s].paragraphStart)return!1}}return!0}function nA(t){const e=t.length;let n=0;for(let r=0;r<e;r++){const i=t[r];n+=i.width}return n}function Eve(t){const e=t.length;let n=Number.NEGATIVE_INFINITY,r;for(let i=0;i<e;i++){const o=t[i],{ba:a,bd:s}=o.bBox;n<a+s&&(r={boundingBoxAscent:a,boundingBoxDescent:s}),n=a+s}return r}function yve(t){const e=t.divides,n=e.length,r=[];for(let i=0;i<n;i++){const o=e[i];r.push(...o.spanGroup)}return r}function Dve(t,e,n){const{hanging:r,indentStart:i}=t,{hanging:o,indentStart:a}=e;r===void 0&&(t.hanging=o),i===void 0&&(t.indentStart=Uu(a||0,n)-Uu(o||0,n))}function Rve(t){return!t.divides[0].spanGroup[0]}class w3{constructor(e,n=!1){this.position=e,this.required=n}}const Ive=5,rA=12,Ave=13,Tve=16,wve=17,Lve=22,iA=28,oA=31,Ove=33,N4=34,Pve=35,cg=36,t_=37,eF=38,Mve=39,Nve=40,_6=41,xve=42,L=0,F=1,sr=2,tF=3,ee=4,Fve=[[ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,tF,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee],[L,ee,ee,F,F,ee,ee,ee,ee,F,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,F,ee,ee,ee,ee,F,F,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[ee,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,F,F,F,F,F,F,ee,sr,ee,F,F,F,F,F,F,F,F,F,F],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,F,F,F,F,F,F,ee,sr,ee,F,F,F,F,F,F,F,F,F,F],[L,ee,ee,F,F,F,ee,ee,ee,L,L,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,L,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,L,F,L,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,L,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[F,ee,ee,F,F,F,ee,ee,ee,L,L,F,F,F,F,F,F,F,L,L,ee,sr,ee,F,F,F,F,F,L,F,F,F,L],[F,ee,ee,F,F,F,ee,ee,ee,L,L,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,L,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,L,F,ee,ee,ee,L,L,F,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,L,F,ee,ee,ee,L,L,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,F,F,F,F,F,F,ee,sr,ee,F,F,F,F,F,F,F,F,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,L,L,L,L,L,F,F,F,L,ee,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,ee,L,L,L,L,L,L,L,L,L,L,L,L],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,F,F,F,F,F,F,ee,sr,ee,F,F,F,F,F,F,F,F,F,F],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,F,F,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,F,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,F,F,F,F,L,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,F,F,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,F,L,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,L,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,F,L,L,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,F,F,L],[L,ee,ee,F,F,F,ee,ee,ee,L,F,L,L,L,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[F,ee,ee,F,F,F,ee,ee,ee,F,F,F,F,F,L,F,F,F,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L],[L,ee,ee,F,F,L,ee,ee,ee,L,L,L,L,L,L,L,L,L,L,L,ee,sr,ee,L,L,L,L,L,L,L,L,F,L]];let $ve=class{constructor(){w(this,"_rules",new Map)}add(e,n){this._rules.set(e,n)}shouldBreak(e,n){for(const r of this._rules.values())if(r(e,n))return!0;return!1}};const kve=new Uint8Array([0,8,14,0,0,0,0,0,176,232,0,0,1,181,15,74,240,237,157,11,140,93,69,25,199,231,178,187,183,123,31,187,237,46,108,193,194,22,104,41,200,242,48,128,104,16,129,152,162,64,42,10,193,42,24,121,104,2,65,177,4,9,69,41,193,104,73,35,193,84,20,104,144,152,74,140,109,80,1,149,87,12,175,68,64,162,60,42,9,136,196,70,194,35,40,132,84,222,34,40,18,255,195,153,113,103,103,231,253,58,183,244,158,228,151,57,103,158,223,124,243,205,227,204,57,231,222,141,3,132,220,0,110,5,119,129,191,129,127,128,127,130,255,130,129,65,66,58,131,254,238,56,88,0,22,129,41,240,1,240,97,135,116,71,128,163,12,225,199,130,229,224,100,112,58,88,1,86,130,11,193,197,66,188,75,192,247,193,85,224,26,176,17,220,0,174,7,183,128,59,193,239,192,67,224,81,240,56,75,251,36,115,159,3,47,129,55,192,155,128,12,17,50,12,230,129,113,176,0,44,2,83,96,95,112,16,56,20,44,101,225,203,192,9,44,156,94,127,30,124,9,124,5,124,21,156,7,46,4,23,179,240,239,130,43,192,143,216,245,79,193,117,67,85,249,55,195,189,3,220,203,242,167,242,61,0,247,17,176,25,252,21,60,11,30,27,168,174,183,128,87,216,245,91,112,27,205,42,77,11,238,24,152,0,147,205,42,124,11,139,191,164,89,185,123,179,184,156,3,154,211,28,194,56,2,124,140,33,198,53,113,12,226,30,47,197,63,11,229,157,228,145,135,11,95,20,242,251,50,206,87,128,149,224,34,176,166,57,93,223,181,56,95,7,214,75,229,111,196,245,213,194,245,181,184,254,21,248,141,144,150,114,23,75,119,159,224,191,137,234,20,60,209,172,236,158,242,44,206,159,3,47,130,55,192,59,160,57,7,233,160,251,209,57,85,30,19,112,39,193,30,115,166,203,221,23,231,7,206,209,215,243,35,8,59,220,16,238,194,39,144,254,83,224,179,224,20,112,6,56,27,156,15,190,9,86,131,75,193,229,96,29,88,15,54,176,50,175,99,238,205,112,239,0,247,130,7,193,163,96,51,11,123,6,238,243,224,37,141,156,175,9,254,111,225,188,49,60,147,237,132,243,54,24,5,243,193,66,176,4,236,7,14,6,135,129,143,131,99,193,114,112,50,56,29,172,0,43,135,171,252,47,128,251,109,240,29,118,253,61,184,235,134,253,117,182,158,165,217,0,247,58,143,244,55,7,148,117,187,148,230,30,225,250,90,102,99,15,192,239,17,176,121,184,234,207,207,12,251,241,2,120,21,252,155,234,187,5,61,131,241,86,117,190,160,101,78,187,72,8,159,178,196,237,211,167,79,58,248,56,80,183,28,125,250,244,233,211,167,79,159,62,125,182,46,246,239,209,251,182,131,91,51,247,67,180,251,32,173,106,47,143,158,31,129,243,95,10,97,71,181,236,233,63,141,56,159,99,241,78,129,251,49,184,147,224,12,156,159,205,242,62,31,238,69,96,13,88,11,126,0,174,6,63,105,85,251,56,63,135,123,99,107,230,254,16,229,54,248,253,204,80,246,221,8,191,31,60,0,30,4,15,129,77,224,143,224,225,126,88,63,172,31,214,15,235,135,37,15,251,51,120,2,60,213,170,246,76,235,228,249,86,189,212,93,255,62,125,122,153,216,117,236,203,232,99,111,130,183,91,225,207,233,72,91,237,63,12,255,121,96,39,176,43,216,75,138,183,15,174,15,2,135,130,165,96,25,56,174,93,201,117,34,220,211,218,245,143,63,59,204,173,184,18,252,9,116,231,233,57,26,92,2,238,84,132,189,45,93,127,112,140,144,243,192,45,96,203,88,229,183,219,56,33,95,0,87,130,95,131,151,193,211,173,74,119,167,130,107,192,147,84,135,29,66,14,0,4,247,31,159,233,84,215,34,23,131,43,26,211,220,203,226,114,182,224,122,223,46,33,159,4,95,3,95,7,55,129,87,193,129,35,240,3,55,130,87,70,102,230,179,173,49,54,58,83,111,125,250,244,233,179,45,113,252,168,121,238,63,19,243,209,57,154,249,159,114,110,123,246,154,133,135,173,66,216,106,41,237,26,92,175,101,126,203,53,239,94,209,247,178,214,37,126,47,203,196,101,154,250,173,51,212,155,178,30,225,251,209,119,229,20,241,126,193,252,110,178,228,97,227,118,133,126,85,240,248,247,176,248,191,23,202,125,152,157,63,46,248,109,166,235,48,240,119,232,249,5,184,175,180,171,119,195,222,130,219,192,250,97,78,167,186,158,11,119,71,176,51,187,190,0,105,23,119,166,247,21,247,193,249,65,157,105,25,14,197,249,249,112,151,194,93,6,142,5,203,193,201,29,181,204,13,216,224,233,157,105,185,22,130,21,138,184,60,254,42,176,82,40,143,198,191,8,215,107,88,30,107,225,174,99,225,116,15,116,61,206,55,26,242,187,161,163,214,59,221,119,165,123,171,183,34,252,174,206,204,52,247,225,122,19,245,3,127,1,79,179,60,158,135,251,50,59,127,29,238,219,154,114,229,250,12,98,93,214,1,243,192,68,119,118,89,147,221,234,124,73,119,186,110,54,246,67,220,131,187,213,187,127,135,9,121,30,137,243,163,193,113,221,114,253,203,133,19,123,76,158,58,56,141,233,224,76,131,46,206,210,132,157,11,255,85,93,55,219,200,73,104,221,87,39,108,127,250,110,226,165,221,233,115,58,151,92,198,174,175,130,251,227,66,182,182,81,83,206,245,221,234,221,201,27,133,246,186,173,155,255,153,86,104,61,238,102,114,222,223,3,246,85,39,155,28,219,232,49,196,219,12,158,242,108,211,103,183,2,253,202,182,177,165,59,253,174,249,182,202,235,158,227,201,127,104,252,17,232,83,177,54,236,140,148,25,155,82,49,15,242,238,144,64,102,170,199,93,70,42,119,49,220,41,112,192,72,253,246,46,218,61,253,70,64,23,78,229,62,132,233,225,112,184,75,71,102,167,95,6,191,19,60,116,117,34,139,123,90,132,30,232,122,239,204,204,122,212,201,127,206,200,204,240,111,20,104,207,111,49,157,173,73,212,143,14,115,144,217,54,174,175,69,30,151,143,84,223,145,252,144,185,235,71,170,176,13,35,254,243,248,245,72,115,11,184,19,252,86,72,255,7,156,63,12,30,7,79,10,254,207,225,252,69,240,58,248,23,120,135,133,13,226,222,191,51,58,29,111,28,231,243,217,245,66,184,123,142,206,94,55,236,47,236,23,156,202,210,125,136,249,125,148,185,71,194,125,77,40,255,152,209,106,159,129,158,159,196,220,83,225,158,33,229,191,255,232,204,122,158,141,235,115,13,251,19,180,63,174,26,245,215,223,123,137,213,84,183,131,225,115,87,47,141,177,161,108,24,104,252,159,9,66,172,140,129,37,96,17,99,15,135,52,174,236,13,112,187,65,32,22,193,208,75,90,228,221,199,103,239,158,83,63,122,108,39,132,161,9,201,60,230,210,45,185,142,35,195,140,174,64,83,186,206,13,97,117,216,174,96,153,114,249,180,45,27,236,122,130,244,143,169,109,28,85,159,220,83,227,159,131,65,214,14,180,207,183,4,168,125,238,206,224,231,124,140,24,35,211,54,205,211,241,184,227,82,90,145,1,233,154,144,188,253,109,247,204,249,247,122,249,189,6,183,15,209,6,248,181,171,206,100,155,18,211,140,91,210,150,160,84,191,221,26,24,12,76,163,35,68,134,208,118,148,215,42,182,182,173,219,238,114,66,117,65,199,124,62,103,113,255,22,209,207,97,189,206,152,208,110,19,138,243,38,115,109,243,247,72,15,193,219,197,103,253,161,91,175,139,237,223,22,144,215,241,62,58,111,10,46,167,110,219,206,61,118,187,222,31,181,53,186,207,61,182,52,137,189,238,29,75,28,89,127,170,184,60,142,171,62,82,183,235,123,193,166,228,241,247,189,132,143,30,186,196,111,140,115,25,239,114,218,95,78,157,200,105,232,216,204,251,180,120,143,41,222,215,149,144,85,39,191,236,175,139,87,210,214,115,149,43,218,155,207,253,191,169,125,83,244,159,208,121,44,119,25,49,245,207,105,19,41,245,107,203,203,87,190,49,70,201,113,77,238,47,117,180,143,216,127,82,180,143,152,167,169,175,202,126,54,29,133,206,59,124,189,173,202,155,251,183,20,229,169,198,209,186,219,39,5,166,118,177,201,16,179,14,80,245,75,87,123,81,233,160,116,123,196,234,59,181,28,33,253,161,69,236,237,95,106,62,42,213,255,67,108,90,182,185,58,250,189,78,206,84,122,55,233,192,54,78,228,186,15,224,227,176,235,250,110,107,232,255,174,109,146,187,255,155,218,208,117,191,95,148,185,244,51,130,146,99,145,105,76,138,209,127,76,93,234,208,117,10,189,187,150,151,219,254,93,242,214,173,19,101,82,142,199,190,54,233,219,223,197,118,112,29,211,57,123,245,8,178,92,173,200,252,186,30,122,228,247,133,189,170,27,174,31,95,187,80,233,100,92,66,244,27,20,206,199,216,117,83,193,32,75,39,63,147,176,141,7,169,239,187,229,231,82,220,165,71,67,112,99,198,215,84,107,179,49,7,255,210,115,162,235,24,197,251,71,236,216,46,218,150,110,109,193,159,95,199,140,139,58,121,99,251,160,107,249,186,244,239,171,153,5,53,179,115,205,228,90,75,153,198,13,121,157,100,234,71,185,169,179,236,210,229,211,163,65,102,142,31,190,178,218,198,189,80,92,215,129,161,178,251,148,175,91,251,228,148,193,167,222,169,203,159,138,40,63,245,154,142,235,126,72,184,230,182,39,174,127,83,237,3,164,106,63,190,14,228,242,143,75,254,178,141,241,247,209,114,200,95,199,189,179,205,174,74,174,205,100,253,136,215,188,61,98,215,45,177,247,114,190,246,107,186,167,203,133,73,191,60,78,93,247,125,220,182,92,245,23,75,234,241,47,246,222,73,164,228,145,67,54,81,159,163,142,240,113,86,60,23,253,92,112,145,223,71,22,213,218,182,14,66,108,136,167,141,221,143,208,29,161,118,227,187,254,201,57,159,200,118,230,243,222,132,78,230,212,251,63,185,112,93,247,219,218,75,182,185,24,91,21,219,220,212,23,84,182,145,178,239,132,126,91,144,2,185,236,58,108,131,175,117,117,125,132,51,40,93,239,192,100,222,85,144,95,142,183,61,153,249,173,206,0,153,254,174,116,64,113,45,198,165,204,21,160,249,241,111,96,117,186,108,91,16,101,160,229,12,49,116,186,25,102,178,53,132,184,166,248,166,254,215,86,232,180,43,93,207,87,164,245,89,103,200,253,216,229,27,52,94,63,241,123,42,249,27,43,151,244,161,247,99,226,248,210,50,208,182,132,251,166,109,43,206,99,202,104,121,180,147,235,156,21,179,159,192,237,93,110,195,54,113,107,23,49,157,207,187,195,174,118,147,227,251,72,83,217,170,239,12,85,223,169,154,208,149,231,155,206,85,47,114,251,230,40,207,71,166,208,186,168,228,146,253,84,225,220,149,191,75,182,181,173,74,23,114,29,76,186,51,217,144,139,61,132,180,181,173,220,20,253,193,164,27,211,117,10,251,73,149,191,171,206,98,117,23,43,151,47,115,19,200,64,15,241,57,113,168,172,252,222,216,167,204,28,58,149,239,213,99,242,138,153,87,117,248,206,31,57,233,6,166,145,237,34,135,92,62,125,40,69,89,161,50,184,234,210,39,31,213,181,171,191,156,71,108,253,92,245,238,154,38,71,255,54,213,219,166,55,158,15,15,31,85,148,51,73,210,140,39,33,117,212,233,48,133,46,99,218,93,101,115,92,127,170,56,41,100,46,165,127,91,189,75,227,186,191,45,219,178,201,166,119,215,196,87,245,7,57,76,236,119,58,61,169,228,80,229,163,146,103,210,80,174,10,149,174,38,37,74,217,136,120,61,160,129,134,241,231,146,178,252,244,104,4,184,57,230,225,80,123,231,50,149,236,35,174,122,170,163,76,95,183,78,189,149,44,187,148,173,164,178,107,25,211,62,170,252,14,130,188,135,219,36,110,207,87,108,184,190,183,164,123,54,163,27,163,108,152,246,253,197,125,106,34,213,83,28,3,197,107,122,152,250,132,156,63,127,199,70,181,47,174,210,211,246,12,221,94,58,81,148,161,171,147,174,44,62,166,187,212,197,247,249,119,46,248,239,75,54,4,191,33,225,220,86,23,34,165,181,197,27,18,206,197,116,161,207,238,117,113,85,254,252,89,140,232,71,219,96,49,59,183,185,185,41,85,142,173,124,151,122,219,194,22,147,217,207,128,135,36,120,155,244,154,254,83,213,95,101,127,139,137,218,14,99,100,142,193,150,191,109,125,152,163,29,66,117,227,251,188,43,102,206,77,53,127,235,214,19,190,239,75,164,150,65,156,227,68,92,245,43,203,228,251,30,71,14,125,234,100,240,177,15,215,103,161,161,240,239,131,248,90,194,231,253,26,159,103,194,49,239,51,185,148,239,139,143,126,92,236,199,86,94,142,239,26,114,63,187,167,101,212,241,205,148,169,189,235,60,66,244,77,15,221,252,97,122,167,116,74,227,239,75,157,223,223,77,101,212,171,171,45,139,58,158,32,246,123,46,57,239,16,157,135,126,199,228,58,110,248,212,223,119,140,146,243,142,29,175,119,4,59,21,164,116,121,190,123,32,41,191,237,148,243,174,227,251,78,89,134,247,215,76,206,181,82,87,211,166,244,183,141,39,136,223,239,32,231,254,141,229,210,240,61,151,210,229,202,235,227,216,117,225,48,153,222,43,226,191,37,45,239,179,209,247,96,114,173,79,85,243,9,47,215,213,149,211,153,230,170,134,224,82,249,249,94,129,248,188,200,86,142,13,254,222,170,234,158,185,14,91,229,101,207,103,46,175,167,44,171,74,135,13,201,245,217,99,144,247,25,154,158,121,196,66,2,101,207,85,62,215,109,67,58,231,122,74,181,167,84,130,148,123,108,190,136,253,137,218,110,75,10,231,239,166,218,250,155,235,26,70,28,175,118,35,213,190,92,29,253,217,182,222,239,133,177,134,207,73,41,101,240,93,115,202,109,87,151,30,100,157,184,220,207,213,37,31,183,165,58,202,157,146,202,143,89,79,228,182,55,151,103,152,174,182,224,210,246,186,114,76,107,178,18,246,228,170,19,91,63,176,201,95,234,247,40,196,113,126,76,145,62,102,12,138,197,197,190,75,247,145,28,121,166,236,167,42,221,213,113,152,246,73,117,123,161,185,214,162,174,242,202,178,211,195,69,215,252,55,251,82,218,149,139,29,119,200,236,113,199,117,191,144,143,49,165,214,43,57,199,179,208,57,211,71,46,213,248,94,215,24,192,203,20,191,151,118,25,15,228,124,228,247,143,84,118,198,207,125,126,95,96,92,202,63,100,125,229,219,150,186,247,181,38,164,60,235,154,203,92,234,108,122,14,94,114,124,201,209,127,85,101,212,113,136,178,168,108,222,7,158,223,148,116,174,170,187,202,159,191,31,40,30,49,242,184,180,163,107,251,152,214,56,170,177,208,119,28,229,54,45,143,51,186,50,93,230,178,88,251,228,191,159,202,223,195,145,127,131,215,118,15,20,114,63,32,150,47,199,245,105,191,216,250,203,191,93,236,66,233,241,49,102,190,183,233,52,86,127,177,196,254,14,156,239,243,123,209,54,67,127,115,174,174,246,143,89,243,233,214,107,177,71,204,28,66,132,115,121,61,227,242,110,28,37,100,15,57,70,255,169,219,132,183,203,184,144,87,9,187,19,235,31,99,63,41,177,149,45,251,169,214,219,99,158,186,244,109,191,82,54,33,207,161,226,252,227,211,63,114,216,187,13,83,249,117,204,177,114,253,67,222,195,245,157,111,82,233,143,191,187,154,186,109,98,237,211,5,23,125,218,250,123,170,246,136,237,15,49,99,187,73,254,84,135,234,158,206,197,182,197,249,120,130,148,63,196,242,67,246,71,93,143,148,227,71,105,218,100,246,111,232,229,28,163,117,196,62,47,228,121,132,142,189,37,244,47,30,13,1,57,158,236,199,227,19,77,252,220,50,235,228,244,205,103,208,0,47,71,229,199,93,211,26,41,247,92,18,99,31,169,218,45,116,62,10,221,47,54,245,53,221,252,234,211,231,98,229,240,89,227,170,224,97,169,215,103,37,198,146,216,54,85,205,213,177,253,40,197,189,141,136,252,13,170,238,127,150,108,235,143,94,155,143,93,203,143,217,123,168,123,61,34,203,31,35,71,236,119,179,169,72,209,94,185,222,93,44,49,230,152,198,96,219,115,159,82,253,205,54,246,228,30,223,82,143,129,190,117,46,217,246,190,243,98,110,114,181,173,74,175,185,230,65,159,54,20,227,170,158,141,197,140,185,41,116,22,59,255,196,150,149,218,206,83,146,66,63,177,117,9,181,83,223,126,159,123,158,74,161,203,16,185,100,157,197,236,23,250,252,6,123,142,242,83,180,75,234,249,223,102,159,114,250,208,250,243,163,14,27,18,105,91,174,125,9,249,13,65,113,125,153,250,119,9,83,231,215,205,32,111,142,117,250,46,133,80,149,61,169,241,79,129,170,13,74,150,161,243,23,127,75,84,165,7,85,120,105,22,42,144,229,83,201,107,35,133,108,62,229,249,200,163,146,79,142,235,90,151,73,67,158,62,182,165,114,117,101,233,210,134,246,1,211,216,29,219,134,174,115,68,206,188,115,213,205,102,183,46,237,23,154,191,107,153,41,40,173,199,144,114,76,125,189,212,239,58,139,191,117,106,250,31,175,212,54,225,59,238,250,150,153,218,174,82,235,61,119,249,169,229,79,37,95,174,254,26,91,63,221,122,199,197,126,125,214,18,62,246,238,179,70,40,185,46,203,85,134,106,45,19,83,158,105,125,20,179,38,172,99,13,28,187,126,141,189,55,143,221,31,41,165,39,215,122,255,15]),Bve=new Uint8Array(new Uint32Array([305419896]).buffer)[0]===18,aA=(t,e,n)=>{const r=t[e];t[e]=t[n],t[n]=r},Uve=t=>{const e=t.length;for(let n=0;n<e;n+=4)aA(t,n,n+3),aA(t,n+1,n+2)},Vve=t=>{Bve&&Uve(t)},CE=0,nF=-3;class wm{constructor(){w(this,"table",new Uint16Array(16)),w(this,"trans",new Uint16Array(288))}}let Hve=class{constructor(e,n){w(this,"source"),w(this,"dest"),w(this,"sourceIndex"),w(this,"tag"),w(this,"bitcount"),w(this,"destLen"),w(this,"ltree"),w(this,"dtree"),this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=n,this.destLen=0,this.ltree=new wm,this.dtree=new wm}};const rF=new wm,iF=new wm,SE=new Uint8Array(30),EE=new Uint16Array(30),oF=new Uint8Array(30),aF=new Uint16Array(30),jve=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sA=new wm,js=new Uint8Array(320);function sF(t,e,n,r){let i,o;for(i=0;i<n;++i)t[i]=0;for(i=0;i<30-n;++i)t[i+n]=i/n|0;for(o=r,i=0;i<30;++i)e[i]=o,o+=1<<t[i]}function zve(t,e){let n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}const uA=new Uint16Array(16);function dg(t,e,n,r){let i,o;for(i=0;i<16;++i)t.table[i]=0;for(i=0;i<r;++i)t.table[e[n+i]]++;for(t.table[0]=0,o=0,i=0;i<16;++i)uA[i]=o,o+=t.table[i];for(i=0;i<r;++i)e[n+i]&&(t.trans[uA[e[n+i]]++]=i)}function Wve(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);const e=t.tag&1;return t.tag>>>=1,e}function Qs(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;const r=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,r+n}function n_(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;let n=0,r=0,i=0,o=t.tag;do r=2*r+(o&1),o>>>=1,++i,n+=e.table[i],r-=e.table[i];while(r>=0);return t.tag=o,t.bitcount-=i,e.trans[n+r]}function Yve(t,e,n){let r,i,o;const a=Qs(t,5,257),s=Qs(t,5,1),u=Qs(t,4,4);for(r=0;r<19;++r)js[r]=0;for(r=0;r<u;++r){const l=Qs(t,3,0);js[jve[r]]=l}for(dg(sA,js,0,19),i=0;i<a+s;){const l=n_(t,sA);switch(l){case 16:{const c=js[i-1];for(o=Qs(t,2,3);o;--o)js[i++]=c;break}case 17:for(o=Qs(t,3,3);o;--o)js[i++]=0;break;case 18:for(o=Qs(t,7,11);o;--o)js[i++]=0;break;default:js[i++]=l;break}}dg(e,js,0,a),dg(n,js,a,s)}function lA(t,e,n){for(;;){let r=n_(t,e);if(r===256)return CE;if(r<256)t.dest[t.destLen++]=r;else{let i;r-=257;const o=Qs(t,SE[r],EE[r]),a=n_(t,n),s=t.destLen-Qs(t,oF[a],aF[a]);for(i=s;i<s+o;++i)t.dest[t.destLen++]=t.dest[i]}}}function Xve(t){let e,n,r;for(;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if(e=t.source[t.sourceIndex+1],e=256*e+t.source[t.sourceIndex],n=t.source[t.sourceIndex+3],n=256*n+t.source[t.sourceIndex+2],e!==(~n&65535))return nF;for(t.sourceIndex+=4,r=e;r;--r)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,CE}function cA(t,e){const n=new Hve(t,e);let r,i,o;do{switch(r=Wve(n),i=Qs(n,2,0),i){case 0:o=Xve(n);break;case 1:o=lA(n,rF,iF);break;case 2:Yve(n,n.ltree,n.dtree),o=lA(n,n.ltree,n.dtree);break;default:o=nF}if(o!==CE)throw new Error("Data error")}while(!r);return n.destLen<n.dest.length?typeof n.dest.slice=="function"?n.dest.slice(0,n.destLen):n.dest.subarray(0,n.destLen):n.dest}zve(rF,iF);sF(SE,EE,4,3);sF(oF,aF,2,1);SE[28]=0;EE[28]=258;const yE=11,pc=5,qve=yE-pc,Gve=65536>>yE,Kve=1<<qve,Zve=Kve-1,x4=2,Qve=1<<pc,mg=Qve-1,uF=65536>>pc,Jve=1024>>pc,ebe=uF+Jve,tbe=ebe,nbe=32,rbe=tbe+nbe,ibe=1<<x4;let obe=class{constructor(e){w(this,"highStart"),w(this,"errorValue"),w(this,"data");const n=typeof e.readUInt32BE=="function"&&typeof e.slice=="function";if(n||e instanceof Uint8Array){let r;if(n)this.highStart=e.readUInt32LE(0),this.errorValue=e.readUInt32LE(4),r=e.readUInt32LE(8),e=e.slice(12);else{const i=new DataView(e.buffer);this.highStart=i.getUint32(0,!0),this.errorValue=i.getUint32(4,!0),r=i.getUint32(8,!0),e=e.subarray(12)}e=cA(e,new Uint8Array(r)),e=cA(e,new Uint8Array(r)),Vve(e),this.data=new Uint32Array(e.buffer)}else({data:this.data,highStart:this.highStart,errorValue:this.errorValue}=e)}get(e){let n;return e<0||e>1114111?this.errorValue:e<55296||e>56319&&e<=65535?(n=(this.data[e>>pc]<<x4)+(e&mg),this.data[n]):e<=65535?(n=(this.data[uF+(e-55296>>pc)]<<x4)+(e&mg),this.data[n]):e<this.highStart?(n=this.data[rbe-Gve+(e>>yE)],n=this.data[n+(e>>pc&Zve)],n=(n<<x4)+(e&mg),this.data[n]):this.data[this.data.length-ibe]}};const abe=new obe(kve);function fg(t){switch(t){case Ove:return rA;case Mve:case Nve:case xve:return rA;case Pve:return Ive;default:return t}}function hg(t){switch(t){case t_:case eF:return N4;case _6:return Lve;default:return t}}let sbe=class{constructor(e){w(this,"_pos",0),w(this,"_lastPos",0),w(this,"_curClass",null),w(this,"_codePoint",null),w(this,"_nextClass",null),w(this,"_LB8a",!1),w(this,"_LB21a",!1),w(this,"_LB30a",0),w(this,"_rule",new $ve),this.string=e}use(e){return e(this),this}addRule(e,n){return this._rule.add(e,n),this}nextBreak(){if(this._curClass==null){const e=this._nextCharClass();this._curClass=hg(e),this._nextClass=e,this._LB8a=e===oA,this._LB30a=0}for(;this._pos<this.string.length;){this._lastPos=this._pos;const e=this._nextClass;if(this._nextClass=this._nextCharClass(),this._curClass===N4||this._curClass===cg&&this._nextClass!==t_)return this._curClass=hg(fg(this._nextClass)),new w3(this._lastPos,!0);if(this._rule.shouldBreak(this._codePoint,this._nextClass))return this._curClass=hg(fg(this._nextClass)),new w3(this._lastPos);let n=this._getSimpleBreak();if(n===null&&(n=this._getPairTableBreak(e)),this._LB8a=this._nextClass===oA,n)return new w3(this._lastPos)}return this._lastPos<this.string.length?(this._lastPos=this.string.length,new w3(this.string.length)):null}_getNextCodePoint(){const e=this.string.charCodeAt(this._pos++),n=this.string.charCodeAt(this._pos);return e>=55296&&e<=56319&&n>=56320&&n<=57343?(this._pos++,(e-55296)*1024+(n-56320)+65536):e}_nextCharClass(){const e=this._getNextCodePoint(),n=abe.get(e);return this._codePoint=e,fg(n)}_getSimpleBreak(){switch(this._nextClass){case _6:return!1;case N4:case t_:case eF:return this._curClass=N4,!1;case cg:return this._curClass=cg,!1}return null}_getPairTableBreak(e){let n=!1;switch(Fve[this._curClass][this._nextClass]){case L:n=!0;break;case F:n=e===_6;break;case sr:if(n=e===_6,!n)return n=!1,n;break;case tF:if(e!==_6)return n;break}return this._LB8a&&(n=!1),this._LB21a&&(this._curClass===Tve||this._curClass===wve)?(n=!1,this._LB21a=!1):this._LB21a=this._curClass===Ave,this._curClass===iA?(this._LB30a++,this._LB30a===2&&this._nextClass===iA&&(n=!0,this._LB30a=0)):this._LB30a=0,this._curClass=this._nextClass,n}};const ube=9;function lbe(t){t.addRule("break_before_tab",e=>e===ube)}function cbe(t,e,n,r,i){const{gridType:o=Uo.LINES,charSpace:a=0,defaultTabStop:s=10.5,pageSize:u={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginRight:l=0,marginLeft:c=0,lists:d,drawings:m={},localeService:f}=r,{endIndex:h,startIndex:p,content:v="",blocks:g=[]}=e,b=t.getParagraph(h)||{startIndex:0},{paragraphStyle:C={},bullet:S}=b,{skeHeaders:E,skeFooters:y,skeListLevel:D,drawingAnchor:R}=i,I=new Map,T={paragraphIndex:h,paragraphStyle:C,paragraphAffectSkeDrawings:I,skeHeaders:E,skeFooters:y,drawingAnchor:R},P=dbe(S,D),N=Oge(S,d,P);mbe(S,N,D),T.bulletSkeleton=N;const{horizontalAlign:B=Zn.UNSPECIFIED,snapToGrid:W=we.TRUE}=C;let G=[n];const Q=new Map;for(let O=0,M=g.length;O<M;O++){const V=g[O],q=t.getCustomBlock(V);if(q==null)continue;Q.set(V,q);const ie=q.blockId,ce=m[ie];ce.layoutType!==i1.INLINE&&I.set(ie,fbe(ce))}Xge();const te=new sbe(v);let X=0,x;for(lbe(te);x=te.nextBreak();){let O=v.slice(X,x.position),M=X,V=[],q=X===0;const ie=()=>{V.length!==0&&(G=vve(V,G,r,T,q),V=[],q=!1)};for(;O.length>0;){const ce=O[0],pe=M+p;if(/\s/.test(ce)||pE(ce)){const oe=mf(M,t,e,r,C);let he;if(ce===mn.TAB){const fe=bE(a,s,o,W);he=Gge(oe,fe)}else he=Q5(ce,oe);V.push(he),M++,O=O.substring(1)}else if(Ox(O)){const{step:oe,spanGroup:he}=nve(M,O,t,e,r,C);V.push(...he),M+=oe,O=O.substring(oe)}else if(Px(ce)){const{step:oe,spanGroup:he}=tve(M,O,t,e,r,C);V.push(...he),M+=oe,O=O.substring(oe)}else if(Mx(ce)){const{step:oe,spanGroup:he}=rve(M,O,t,e,r,C);V.push(...he),M+=oe,O=O.substring(oe)}else{const{step:oe,spanGroup:he}=eve(M,O,t,e,r,C);V.push(...he),M+=oe,O=O.substring(oe)}if(ce===mn.CUSTOM_BLOCK){let oe=Q.get(pe);if(oe==null&&(oe=t.getCustomBlock(pe)),oe!=null){const he=oe.blockId;m[he].layoutType===i1.INLINE&&(G=Fge())}}else if(ce===mn.PAGE_BREAK)ie(),G.push(Tm(r,i,dA(G[G.length-1]),Im.PAGE)),I.clear();else if(ce===mn.COLUMN_BREAK){ie();const oe=G[G.length-1],he=g9(oe);he&&!he.isLast?Kx(he.column,!0):G.push(Tm(r,i,dA(oe),Im.COLUMN))}}ie(),X=x.position}return Hge(G,O=>{hbe(O,B)}),G}function dbe(t,e){if(!t||!e)return;const{listId:n,nestingLevel:r}=t,i=e==null?void 0:e.get(n);let o=r;o<0&&(o=0);const a=[];for(let s=o;s>=0;s--){const u=i==null?void 0:i[s];a[s]=u||null}return a}function mbe(t,e,n){if(!t||!e)return;const{listId:r,nestingLevel:i}=t,o=[...(n==null?void 0:n.get(r))||[]];o[i]=e,o.splice(i+1),n==null||n.set(r,o)}function fbe(t){return{objectId:t.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:t}}function dA(t){return t.pageNumber+1}function hbe(t,e){if(e===Zn.UNSPECIFIED||e===Zn.LEFT)return;const{divides:n}=t,r=n.length;for(let i=0;i<r;i++){const o=n[i],{width:a}=o,s=Yge(o);a!==Number.POSITIVE_INFINITY&&(e===Zn.CENTER?o.paddingLeft=(a-s)/2:e===Zn.RIGHT?o.paddingLeft=a-s:Zn.JUSTIFIED)}}let Lm=class{constructor(){w(this,"_translateX",0),w(this,"_translateY",0),w(this,"_translateSaveList",[])}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(e=0,n=0){this._translateX=e,this._translateY=n}translate(e=0,n=0){this._translateX+=e,this._translateY+=n}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}translatePagePadding(e){const{marginTop:n=0,marginBottom:r=0,marginLeft:i=0,marginRight:o=0}=e;this.translate(i,n)}restorePagePadding(e){const{marginTop:n=0,marginBottom:r=0,marginLeft:i=0,marginRight:o=0}=e;this.translate(-i,-n)}translatePage(e,n=Ds.VERTICAL,r=0,i=0,o=0,a=0){const{pageWidth:s,pageHeight:u}=e;let l=0,c=0;return n===Ds.VERTICAL?l+=u+i:n===Ds.HORIZONTAL&&(c+=s+r),this.translate(c,l),{x:c,y:l}}translateSection(e){const{top:n=0}=e;return this.translate(0,n),{x:0,y:n}}translateColumn(e){const{left:n}=e;return this.translate(n,0),{x:n,y:0}}translateLine(e,n=!1){const{top:r,marginBottom:i=0,marginTop:o=0,paddingTop:a=0,paddingBottom:s=0}=e,u=r+(n===!0?o:0)+a;return this.translate(0,u),{x:0,y:u}}translateDivide(e){const{left:n,paddingLeft:r}=e,i=n+r;return this.translate(i,0),{x:i,y:0}}translateSpan(e){const{left:n}=e;return this.translate(n,0),{x:n,y:0}}};var F4=(t=>(t[t.page=0]="page",t[t.section=1]="section",t[t.column=2]="column",t[t.line=3]="line",t[t.divide=4]="divide",t[t.span=5]="span",t))(F4||{});const F2={page:0,section:1,column:2,line:3,divide:4,span:5};function lF(t,e){return t.page>e.page?!1:t.page<e.page?!0:t.section>e.section?!1:t.section<e.section?!0:t.column>e.column?!1:t.column<e.column?!0:t.line>e.line?!1:t.line<e.line?!0:t.divide>e.divide?!1:t.divide<e.divide?!0:t.span>e.span?!1:(t.span<e.span,!0)}function r_(t,e){return lF(t,e)?{start:t,end:e}:{start:e,end:t}}function mA(t){const e=t.length;if(e===0)return;const n=t[0],r=t[e-1],i=t.length===1&&n.collapsed;return{startOffset:n.startOffset,endOffset:r.endOffset,collapsed:i}}function pbe(t,e,n,r){let i=r,o=r;for(let a=0;a<t.length;a++){const s=t[a].count;a<e&&(i+=s),a<n&&(o+=s)}return{startOffset:i,endOffset:o}}let i_=class{constructor(e,n){w(this,"_liquid",new Lm),w(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,span:0}),w(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,span:0}),this._documentOffsetConfig=e,this._docSkeleton=n}getRangePointData(e,n){const r=[],i=[],o=[];if(e==null||n==null)return{borderBoxPointGroup:r,contentBoxPointGroup:i,cursorList:o};const{start:a,end:s}=r_(e,n);return this._selectionIterator(a,s,(u,l,c,d,m,f)=>{const{lineHeight:h,marginTop:p,contentHeight:v}=f,{spanGroup:g,st:b}=m,{x:C,y:S}=this._liquid;let E,y;const D=g[u],R=g[l],I=(D==null?void 0:D.left)||0,T=(D==null?void 0:D.width)||0,P=(R==null?void 0:R.left)||0,N=(R==null?void 0:R.width)||0,B=(D==null?void 0:D.spanType)===Ko.LIST,{startOffset:W,endOffset:G}=pbe(g,u,l,b),Q=a.span===u&&c?a.isBack:!0,te=s.span===l&&d?s.isBack:!1,X=a===s;if(u===0&&l===g.length-1)E={startX:C+I+(B?T:0),startY:S,endX:C+P+N,endY:S+h},y={startX:C+I+(B?T:0),startY:S+p,endX:C+P+N,endY:S+p+v};else{const x=Q&&!B;E={startX:C+I+(x?0:T),startY:S,endX:C+P+(te?0:N),endY:S+h},y={startX:C+I+(x?0:T),startY:S+p,endX:C+P+(te?0:N),endY:S+p+v}}r.push(this._pushToPoints(E)),i.push(this._pushToPoints(y)),o.push({startOffset:Q?W:W+D.count,endOffset:te?G:G+R.count,collapsed:X})}),{borderBoxPointGroup:r,contentBoxPointGroup:i,cursorList:o}}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_setNodePositionState(e=0,n,r,i){i===n?this._currentStartState[e]=1:this._currentStartState[e]=0,i===r?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,n=!0){let r=e,i;for(;r>=0;){const o=F4[r];let a;if(n?a=this._currentStartState[o]:a=this._currentEndState[o],a===void 0)return;if(i===void 0&&(i=a),a!==i)return 0;r--}return i}_getSelectionRuler(e,n,r,i,o){let a=0,s=i;const u=F4[e],l=F4[e+1];if(l===null||u===null)return{start_next:a,end_next:s};const c=n[u],d=r[u];this._setNodePositionState(u,c,d,o);const m=this._checkPreviousNodePositionState(e),f=this._checkPreviousNodePositionState(e,!1);return m===1&&(a=n[l]),f===2&&(s=r[l]),{start_next:a,end_next:s}}_pushToPoints(e){const{startX:n,startY:r,endX:i,endY:o}=e,a=[];return a.push({x:n,y:r}),a.push({x:i,y:r}),a.push({x:i,y:o}),a.push({x:n,y:o}),a.push({x:n,y:r}),a}_selectionIterator(e,n,r){const i=this._docSkeleton;if(!i)return[];this._liquid.reset();const o=i.getSkeletonData();if(o==null)return[];const a=o.pages,{page:s}=e,{page:u}=n;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:l,pageMarginLeft:c,pageMarginTop:d}=this._documentOffsetConfig;for(let m=0;m<=s-1;m++){const f=a[m];this._liquid.translatePage(f,l,c,d)}for(let m=s;m<=u;m++){const f=a[m],h=f.sections,{start_next:p,end_next:v}=this._getSelectionRuler(F2.page,e,n,h.length-1,m);this._liquid.translateSave(),this._liquid.translatePagePadding(f);for(let g=p;g<=v;g++){const b=h[g],C=b.columns,{start_next:S,end_next:E}=this._getSelectionRuler(F2.section,e,n,C.length-1,g);this._liquid.translateSection(b);for(let y=S;y<=E;y++){const D=C[y],R=D.lines,{start_next:I,end_next:T}=this._getSelectionRuler(F2.column,e,n,R.length-1,y);this._liquid.translateColumn(D);for(let P=I;P<=T;P++){const N=R[P],{divides:B}=N,{start_next:W,end_next:G}=this._getSelectionRuler(F2.line,e,n,B.length-1,P);this._liquid.translateSave(),this._liquid.translateLine(N);for(let Q=W;Q<=G;Q++){const te=B[Q];this._liquid.translateSave(),this._liquid.translateDivide(te);const X=te.spanGroup,{start_next:x,end_next:O}=this._getSelectionRuler(F2.divide,e,n,X.length-1,Q);let M=!1,V=!1;m===s&&g===p&&y===S&&P===I&&Q===W&&(M=!0),m===u&&g===v&&y===E&&P===T&&Q===G&&(V=!0),r&&r(x,O,M,V,te,N,D,b,f),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(f,l,c,d)}}};const gbe=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class ff extends M0{constructor(e,n){super(e),w(this,"_hoverCursor"),w(this,"_moveCursor",null),w(this,"_fillRule","nonzero"),w(this,"_globalCompositeOperation","source-over"),w(this,"_paintFirst","fill"),w(this,"_stroke"),w(this,"_strokeScaleEnabled",!1),w(this,"_fill"),w(this,"_fillAfterStrokeEnabled",!1),w(this,"_hitStrokeWidth",0),w(this,"_strokeLineJoin","round"),w(this,"_strokeLineCap","round"),w(this,"_shadowColor"),w(this,"_shadowBlur",0),w(this,"_shadowOffset"),w(this,"_shadowOffsetX",0),w(this,"_shadowOffsetY",0),w(this,"_shadowOpacity",0),w(this,"_shadowEnabled",!1),w(this,"_shadowForStrokeEnabled",!1),w(this,"_strokeDashArray"),w(this,"_strokeDashOffset",0),w(this,"_strokeMiterLimit",0),w(this,"_type",yx.RECT),this._initialProps(n)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}static drawWith(e,n){}static _renderPaintInOrder(e,n){n.paintFirst==="stroke"?(this._renderStroke(e,n),this._renderFill(e,n)):(this._renderFill(e,n),this._renderStroke(e,n))}static _renderFill(e,n){n.fill&&(e.save(),this._setFillStyles(e,n),n.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,n){const{stroke:r,strokeWidth:i,shadowEnabled:o,shadowForStrokeEnabled:a,strokeScaleEnabled:s,parent:u}=n;let{scaleX:l,scaleY:c}=n;if(!(!r||i===0)){if(o&&!a&&this._removeShadow(e),e.save(),s&&u){const d=this._getObjectScaling();e.scale(1/d.scaleX,1/d.scaleY)}else s&&(l=l??1,c=c??1,e.scale(1/l,1/c));this._setLineDash(e),this._setStrokeStyles(e,n),e.stroke(),e.restore()}}static _getObjectScaling(){return{scaleX:1,scaleY:1}}static _removeShadow(e){}static _setFillStyles(e,n){e.fillStyle=n.fill}static _setStrokeStyles(e,n){const{strokeWidth:r,strokeLineCap:i,strokeDashOffset:o,strokeLineJoin:a,strokeMiterLimit:s,stroke:u}=n;e.setLineWidthNative(r),e.lineCap=i,e.lineDashOffset=o,e.lineJoin=a,e.miterLimit=s,e.strokeStyle=u}static _setLineDash(e){}render(e,n){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{top:i,left:o,bottom:a,right:s}=n.viewBound;if(this.width+this.strokeWidth<o||s<0||this.height+this.strokeWidth<i||a<0)return this}const r=this.transform.getMatrix();return e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._draw(e),e.restore(),this.makeDirty(!1),this}setProps(e){if(!e)return;const n=Object.keys(e);if(n.length!==0)return n.forEach(r=>{if(e[r]===void 0)return!0;Qb.indexOf(r)===-1&&(this[`_${r}`]=e[r])}),this.makeDirty(!0),this}toJson(){const e={};return gbe.forEach(n=>{this[n]&&(e[n]=this[n])}),{...super.toJson(),...e}}_draw(e){}_initialProps(e){if(!e)return;const n=Object.keys(e);if(n.length===0)return;const r={};let i=!1;n.forEach(o=>{if(e[o]===void 0)return!0;Qb.indexOf(o)>-1?(r[o]=e[o],i=!0):this[`_${o}`]=e[o]}),i&&this.transformByState(r),this.makeDirty(!0)}}const vbe=["radius"];let cn=class cF extends ff{constructor(e,n){super(e,n),w(this,"_radius",0),n!=null&&n.radius&&(this._radius=n.radius)}get radius(){return this._radius}static drawWith(e,n){let{radius:r,width:i,height:o}=n;if(r=r??0,i=i??30,o=o??30,e.beginPath(),n.strokeDashArray&&e.setLineDash(n.strokeDashArray),!r)e.rect(0,0,i,o);else{let a=0,s=0,u=0,l=0;a=s=u=l=Math.min(r,i/2,o/2),e.moveTo(a,0),e.lineTo(i-s,0),e.arc(i-s,s,s,Math.PI*3/2,0,!1),e.lineTo(i,o-l),e.arc(i-l,o-l,l,0,Math.PI/2,!1),e.lineTo(u,o),e.arc(u,o-u,u,Math.PI/2,Math.PI,!1),e.lineTo(0,a),e.arc(a,a,a,Math.PI,Math.PI*3/2,!1)}e.closePath(),this._renderPaintInOrder(e,n)}toJson(){const e={};return vbe.forEach(n=>{this[n]&&(e[n]=this[n])}),{...super.toJson(),...e}}_draw(e){cF.drawWith(e,this)}};const bbe=["pointsGroup"];let r0=class dF extends ff{constructor(e,n){super(e,n),w(this,"_pointsGroup"),this._pointsGroup=(n==null?void 0:n.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add(r=>{const{type:i,value:o,preValue:a}=r;(i===eo.resize||i===eo.all)&&this.resizePolygon(a)})}get pointsGroup(){return this._pointsGroup}static drawWith(e,n){let{pointsGroup:r}=n;r=r??[[]],n.strokeDashArray&&e.setLineDash(n.strokeDashArray),e.beginPath();for(const i of r){e.moveTo(i[0].x,i[0].y);for(let o=1;o<i.length;o++){const a=i[o];e.lineTo(a.x,a.y)}}e.closePath(),this._renderPaintInOrder(e,n)}updatePointGroup(e){this._pointsGroup=e,this._setFixBoundingBox()}resizePolygon(e){const{left:n,top:r,width:i,height:o}=this._getSelfRect(),{width:a,height:s}=e;let u,l;a?u=this.width-a:u=0,s?l=this.height-s:l=0;const c=u/i,d=l/o;this.scaleX+=c,this.scaleY+=d,this.left=this.left-n*c,this.top=this.top-r*d,this._setTransForm()}toJson(){const e={};return bbe.forEach(n=>{this[n]&&(e[n]=this[n])}),{...super.toJson(),...e}}getState(){const{left:e,top:n,width:r,height:i}=this.getRect();return{left:e,top:n,width:r,height:i,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:n,width:r,height:i}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:n*this.scaleY+this.top,width:r*this.scaleX,height:i*this.scaleY}}_draw(e){dF.drawWith(e,this)}_setFixBoundingBox(){const{width:e,height:n,left:r,top:i}=this._getSelfRect();this.left=this.left+r,this.top=this.top+i,this.width=e,this.height=n;const o=this.pointsGroup;for(const a of o)for(const s of a)s.x-=r,s.y-=i;this._setTransForm()}_getSelfRect(){const e=this.pointsGroup;let n=e[0][0].x,r=e[0][0].x,i=e[0][0].y,o=e[0][0].y;for(const a of e)for(const s of a)n=Math.min(n,s.x),r=Math.max(r,s.x),i=Math.min(i,s.y),o=Math.max(o,s.y);return{left:n,top:i,width:r-n,height:o-i}}};const _be="__TestSelectionRange__",Cbe="__TestSelectionAnchor__",fA=6;function Sbe(t,e,n,r){const{startOffset:i,endOffset:o,style:a=Am}=e,s=n.findNodePositionByCharIndex(i),u=i!==o?n.findNodePositionByCharIndex(o):null,l=new o_(t,r,n,s,u,a);return l.refresh(),l}let o_=class{constructor(e,n,r,i,o,a=Am){w(this,"_current",!1),w(this,"_rangeShape"),w(this,"_anchorShape"),w(this,"_cursorList",[]),this._scene=e,this._document=n,this._docSkeleton=r,this.anchorNodePosition=i,this.focusNodePosition=o,this.style=a}get startOffset(){var e;const{startOffset:n}=(e=mA(this._cursorList))!=null?e:{},r=this._docSkeleton.getViewModel().getBody();if(n==null||r==null)return n;const i=r.dataStream.length-2;return Math.min(i,n)}get endOffset(){var e;const{endOffset:n}=(e=mA(this._cursorList))!=null?e:{},r=this._docSkeleton.getViewModel().getBody();if(n==null||r==null)return n;const i=r.dataStream.length-2;return Math.min(n,i)}get collapsed(){const{startOffset:e,endOffset:n}=this;return e!=null&&e===n}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:e}=r_(this.anchorNodePosition,this.focusNodePosition);return e}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:e}=r_(this.anchorNodePosition,this.focusNodePosition);return e}get direction(){const{collapsed:e,anchorNodePosition:n,focusNodePosition:r}=this;return e||n==null||r==null?g0.NONE:lF(n,r)?g0.FORWARD:g0.BACKWARD}getAnchor(){return this._anchorShape}activeStatic(){var e,n;(n=this._anchorShape)==null||n.setProps({stroke:((e=this.style)==null?void 0:e.strokeActive)||la(B2.black,1)})}deactivateStatic(){var e,n;(n=this._anchorShape)==null||n.setProps({stroke:((e=this.style)==null?void 0:e.stroke)||la(B2.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var e,n;(e=this._rangeShape)==null||e.dispose(),this._rangeShape=null,(n=this._anchorShape)==null||n.dispose(),this._anchorShape=null}isIntersection(e){const{startOffset:n,endOffset:r}=this,{startOffset:i,endOffset:o}=e;return n==null||r==null||i==null||o==null?!1:n<=o&&r>=i}refresh(){var e,n;const{_document:r,_docSkeleton:i}=this,o=this.anchorNodePosition,a=this.focusNodePosition;if((e=this._anchorShape)==null||e.hide(),(n=this._rangeShape)==null||n.hide(),this._isEmpty())return;const s=r.getOffsetConfig(),{docsLeft:u,docsTop:l}=s,c=new i_(s,i);if(this._isCollapsed()){const{contentBoxPointGroup:f,cursorList:h}=c.getRangePointData(o,o);this._setCursorList(h),f.length>0&&this._createOrUpdateAnchor(f,u,l);return}const{borderBoxPointGroup:d,cursorList:m}=c.getRangePointData(o,a);this._setCursorList(m),d.length>0&&this._createOrUpdateRange(d,u,l)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const e=this.anchorNodePosition,n=this.focusNodePosition;if(e!=null&&n==null)return!0;if(e==null||n==null)return!1;const r=Object.keys(F2);for(const i of r){const o=e[i],a=n[i];if(o!==a)return!1}return e.isBack===n.isBack}_createOrUpdateRange(e,n,r){var i;if(this._rangeShape){this._rangeShape.translate(n,r),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}const o=.2,a=new r0(_be+Ie.generateRandomId(fA),{pointsGroup:e,fill:((i=this.style)==null?void 0:i.fill)||la(B2.black,o),left:n,top:r,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,2)}_getAnchorBounding(e){const n=e[0],r=n[0],i=n[2],{x:o,y:a}=r,{x:s,y:u}=i;return{left:o,top:a,width:s-o,height:u-a}}_createOrUpdateAnchor(e,n,r){var i,o;const a=this._getAnchorBounding(e),{left:s,top:u,height:l}=a;if(this._anchorShape){this._anchorShape.transformByState({left:s+n,top:u+r,height:l}),this._anchorShape.show();return}const c=new cn(Cbe+Ie.generateRandomId(fA),{left:s+n,top:u+r,height:l,strokeWidth:((i=this.style)==null?void 0:i.strokeWidth)||1,stroke:((o=this.style)==null?void 0:o.stroke)||la(B2.black,0),evented:!1});this._anchorShape=c,this._scene.addObject(c,2)}_setCursorList(e){e.length!==0&&(this._cursorList=e)}};var Ebe=Object.defineProperty,ybe=Object.getOwnPropertyDescriptor,Dbe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ybe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Ebe(e,n,i),i},Rbe=(t,e)=>(n,r)=>e(n,r,t);let b9=class extends We{constructor(e){super(),w(this,"_fontLocale"),w(this,"_dirty",!0),this._localService=e,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}makeDirty(e){this._dirty=e}_localeInitial(){}};b9=Dbe([Rbe(0,K(Gt))],b9);const Ibe={columnProperties:[],columnSeparatorType:em.NONE,sectionType:Ah.SECTION_TYPE_UNSPECIFIED,startIndex:0};class Om extends b9{constructor(e,n){super(n),w(this,"_skeletonData"),w(this,"_renderedBlockIdMap",new Map),w(this,"_findLiquid",new Lm),this._docViewModel=e}static create(e,n){return new Om(e,n)}getViewModel(){return this._docViewModel}calculate(e){this.dirty&&(this._skeletonData=this._createSkeleton(e))}getSkeletonData(){return this._skeletonData}getActualSize(){const e=this.getSkeletonData();let n=Number.NEGATIVE_INFINITY,r=0;return e==null||e.pages.forEach(i=>{const{width:o,height:a}=i;n=Math.max(n,o),r+=a}),{actualWidth:n,actualHeight:r}}_getPageActualWidth(e){let n=Number.NEGATIVE_INFINITY;for(const r of e.sections)for(const i of r.columns)for(const o of i.lines){let a=0;for(const s of o.divides)for(const u of s.spanGroup)a+=u.width;n=Math.max(n,a)}return n}getPageSize(){return this.getViewModel().getDataModel().documentStyle.pageSize}findPositionBySpan(e){const n=e.parent,r=n==null?void 0:n.parent,i=r==null?void 0:r.parent,o=i==null?void 0:i.parent,a=o==null?void 0:o.parent,s=this.getSkeletonData();if(!n||!i||!o||!a||!s)return;const u=n.spanGroup.indexOf(e),l=r.divides.indexOf(n),c=i.lines.indexOf(r),d=o.columns.indexOf(i),m=a.sections.indexOf(o),f=s.pages.indexOf(a);return{span:u,divide:l,line:c,column:d,section:m,page:f}}findNodePositionByCharIndex(e,n=!0){const r=this._findNodeIterator(e);if(r==null)return;const i=this.getSkeletonData();if(!i)return;const o=i.pages,{span:a,divide:s,line:u,column:l,section:c,page:d}=r;return{span:s.spanGroup.indexOf(a),divide:u.divides.indexOf(s),line:l.lines.indexOf(u),column:c.columns.indexOf(l),section:d.sections.indexOf(c),page:o.indexOf(d),isBack:n}}findNodeByCharIndex(e){const n=this._findNodeIterator(e);return n==null?void 0:n.span}findSpanByPosition(e){if(e==null)return;const n=this.getSkeletonData();if(n==null)return;const{divide:r,line:i,column:o,section:a,page:s,isBack:u}=e;let{span:l}=e;u===!0&&(l-=1),l=l<0?0:l;const c=n.pages[s].sections[a].columns[o].lines[i].divides[r].spanGroup;return c[l].spanType===Ko.LIST?c[l+1]:c[l]}findNodeByCoord(e,n,r,i){const{x:o,y:a}=e;this._findLiquid.reset();const s=this.getSkeletonData();if(s==null)return;const u=s.pages;let l=[],c=[],d=Number.POSITIVE_INFINITY;for(let m=0,f=u.length;m<f;m++){const h=u[m];this._findLiquid.translatePagePadding(h);const p=h.sections;for(const v of p){const{columns:g,height:b}=v;this._findLiquid.translateSection(v);for(const C of g){const{lines:S,width:E}=C;this._findLiquid.translateColumn(C);const y=S.length;for(let D=0;D<y;D++){const R=S[D],{divides:I,type:T,lineHeight:P=0}=R;if(T!==Z5.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(R);const{y:N}=this._findLiquid,B=N,W=N+P,G=Math.abs(a-W),Q=I.length;for(let te=0;te<Q;te++){const X=I[te],{spanGroup:x,width:O}=X;this._findLiquid.translateSave(),this._findLiquid.translateDivide(X);const{x:M}=this._findLiquid;for(const V of x){if(!V.content||V.content.length===0)continue;const{width:q,left:ie}=V,ce=M+ie,pe=M+ie+q,oe=Math.abs(o-pe);if(a>=B&&a<=W){if(o>=ce&&o<=pe)return{node:V,ratioX:o/(ce+pe),ratioY:a/(B+W)};d!==Number.NEGATIVE_INFINITY&&(l=[],c=[]),l.push({node:V,ratioX:o/(ce+pe),ratioY:a/(B+W)}),c.push(oe),d=Number.NEGATIVE_INFINITY;continue}G<d&&(d=G,l=[],c=[]),G===d&&(l.push({node:V,ratioX:o/(ce+pe),ratioY:a/(B+W)}),c.push(oe))}this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(h),this._translatePage(h,n,r,i)}return this._getNearestNode(l,c)}_getNearestNode(e,n){const r=Math.min(...n),i=n.indexOf(r);return e[i]}_getPageBoundingBox(e,n){const{pageWidth:r,pageHeight:i}=e,{x:o,y:a}=this._findLiquid;let s=-1,u=-1;return n===Ds.VERTICAL?(s=r,u=a+i):n===Ds.HORIZONTAL&&(s=o+r,u=i),{startX:o,startY:a,endX:s,endY:u}}_translatePage(e,n,r,i){this._findLiquid.translatePage(e,n,r,i)}_createSkeleton(e){var n;const r={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},i=this.getViewModel(),{headerTreeMap:o,footerTreeMap:a}=i,{documentStyle:s,drawings:u,lists:l={}}=i.getDataModel(),c={...YW,...l},{pageNumberStart:d=1,pageSize:m=r,pageOrient:f=i5.PORTRAIT,defaultHeaderId:h,defaultFooterId:p,evenPageHeaderId:v,evenPageFooterId:g,firstPageHeaderId:b,firstPageFooterId:C,useFirstPageHeaderFooter:S,useEvenPageHeaderFooter:E,marginTop:y=0,marginBottom:D=0,marginRight:R=0,marginLeft:I=0,marginHeader:T=0,marginFooter:P=0,charSpace:N=0,linePitch:B=15.6,gridType:W=Uo.LINES,paragraphLineGapDefault:G=0,defaultTabStop:Q=10.5,textStyle:te={fs:14},renderConfig:X={horizontalAlign:Zn.UNSPECIFIED,verticalAlign:li.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:Ar.UNSPECIFIED}}=s,x=this._getNullSke(),O={headerTreeMap:o,footerTreeMap:a,lists:c,drawings:u,charSpace:N,linePitch:B,gridType:W,localeService:this._localService,paragraphLineGapDefault:G,defaultTabStop:Q,documentTextStyle:te},{skeHeaders:M,skeFooters:V,skeListLevel:q,drawingAnchor:ie}=x,ce={skeHeaders:M,skeFooters:V,skeListLevel:q,drawingAnchor:ie},pe=[];x.pages=pe;const oe=this.getViewModel();oe.resetCache();for(let he=0,fe=oe.children.length;he<fe;he++){const ve=oe.children[he],Ue=oe.getSectionBreak(ve.endIndex)||Ibe,{pageNumberStart:ke=d,pageSize:Te=m,pageOrient:Re=f,marginTop:rt=y,marginBottom:_t=D,marginRight:mt=R,marginLeft:nt=I,marginHeader:_e=T,marginFooter:He=P,defaultHeaderId:et=h,defaultFooterId:Dt=p,evenPageHeaderId:Mt=v,evenPageFooterId:Bt=g,firstPageHeaderId:Zt=b,firstPageFooterId:It=C,useFirstPageHeaderFooter:pn=S,useEvenPageHeaderFooter:yn=E,columnProperties:$t=[],columnSeparatorType:Ht=em.NONE,contentDirection:Nt,sectionType:Ot,textDirection:En,renderConfig:Y=X}=Ue,z=oe.children[he+1],ne=(n=oe.getSectionBreak(z==null?void 0:z.endIndex))==null?void 0:n.sectionType,Ce={defaultHeaderId:et,evenPageHeaderId:Mt,firstPageHeaderId:Zt},Ve={defaultFooterId:Dt,evenPageFooterId:Bt,firstPageFooterId:It};Te.width===null&&(Te.width=Number.POSITIVE_INFINITY),Te.height===null&&(Te.height=Number.POSITIVE_INFINITY);const Ke={pageNumberStart:ke,pageSize:Te,pageOrient:Re,marginTop:rt,marginBottom:_t,marginRight:mt,marginLeft:nt,marginHeader:_e,marginFooter:He,headerIds:Ce,footerIds:Ve,useFirstPageHeaderFooter:pn,useEvenPageHeaderFooter:yn,columnProperties:$t,columnSeparatorType:Ht,contentDirection:Nt,sectionType:Ot,sectionTypeNext:ne,textDirection:En,renderConfig:Y,...O};let Pe=N0(pe),Be=!1;Ot===Ah.CONTINUOUS?(Jb(pe),this._addNewSectionByContinuous(Pe,$t,Ht),Be=!0):Pe=Tm(Ke,ce,Pe==null?void 0:Pe.pageNumber);const me=qx(oe,ve,Pe,Ke,ce,this._renderedBlockIdMap);ne===Ah.CONTINUOUS&&$t.length>0;const{pages:De}=me;Be&&De.splice(0,1),pe.push(...De)}return Jb(pe),this._setPageParent(pe,x),x}_setPageParent(e,n){for(const r of e)r.parent=n}_addNewSectionByContinuous(e,n,r){const i=e.sections,o=i[i.length-1],{pageWidth:a,pageHeight:s,marginTop:u,marginBottom:l,marginLeft:c,marginRight:d}=e,m=a-c-d,f=s-u-l,h=((o==null?void 0:o.top)||0)+((o==null?void 0:o.height)||0),p=Gx(n,r,h,0,m,f-h);p.parent=e,i.push(p)}_getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,drawingAnchor:new Map}}_findNodeIterator(e){const n=this.getSkeletonData();if(!n)return;const r=n.pages;for(const i of r){const{sections:o,st:a,ed:s}=i;if(!(e<a||e>s))for(const u of o){const{columns:l,st:c,ed:d}=u;if(!(e<c||e>d))for(const m of l){const{lines:f,st:h,ed:p}=m;if(!(e<h||e>p))for(const v of f){const{divides:g,st:b,ed:C}=v,S=g.length;if(!(e<b||e>C))for(let E=0;E<S;E++){const y=g[E],{spanGroup:D,st:R,ed:I}=y;if(e<R||e>I)continue;let T=e-R;for(const P of D)if(T-=P.count,T<0)return{page:i,section:u,column:m,line:v,divide:y,span:P}}}}}}}}let mF=class{constructor(){w(this,"uKey",""),w(this,"type"),w(this,"Z_INDEX",0),w(this,"parent"),w(this,"translateX",0),w(this,"translateY",0),w(this,"extensionOffset",{})}get zIndex(){return this.Z_INDEX}draw(e,n,r,i){}clearCache(){}_getScale(e){return Nx(e)}};const J5=J9.create(),fF=J9.create(),hF=J9.create(),hf=J9.create();var a_=(t=>(t[t.SPAN=0]="SPAN",t[t.LINE=1]="LINE",t))(a_||{});let e8=class extends mF{constructor(){super(...arguments),w(this,"type",0),w(this,"translateX",0),w(this,"translateY",0)}};const Abe="DefaultDocsBackgroundExtension",Tbe=10;let wbe=class extends e8{constructor(){super(...arguments),w(this,"uKey",Abe),w(this,"Z_INDEX",Tbe),w(this,"_preBackgroundColor","")}draw(e,n,r){var i;const o=(i=r.parent)==null?void 0:i.parent;if(!o)return;const{contentHeight:a=0}=o,{ts:s,width:u}=r;if(!s)return;const{bg:l}=s;if(!l)return;const c=mo(l),{spanStartPoint:d=zt.create(0,0)}=this.extensionOffset;c&&(e.fillStyle=c,e.fillRect(d.x-.5,d.y,u+1,a+1))}clearCache(){this._preBackgroundColor=""}};hf.add(new wbe);const Lbe="DefaultDocsBorderExtension";let Obe=class extends e8{constructor(){super(...arguments),w(this,"uKey",Lbe),w(this,"Z_INDEX",50),w(this,"_preBorderStyle"),w(this,"_preBorderColor","")}draw(t,e,n){var r;const i=(r=n.parent)==null?void 0:r.parent;if(!i)return;const{asc:o=0,lineHeight:a=0}=i,{ts:s,left:u,width:l}=n;if(!s)return;const{bd:c}=s;if(!c)return;this._getScale(e);const d=this._createBorderCache(c);t.save(),t.translateWithPrecisionRatio(gi,gi);const{spanStartPoint:m=zt.create(0,0)}=this.extensionOffset;for(const f of d.keys()){const h=d.get(f);if(!h)continue;const{s:p,cl:v}=h,g=mo(v)||P0;p!==this._preBorderStyle&&(kx(t,p),t.lineWidth=Bx(p),this._preBorderStyle=p),g!==this._preBorderColor&&(t.strokeStyle=g||P0,this._preBorderColor=g),$x(t,f,{startX:m.x,startY:m.y,endX:m.x+l,endY:m.y+a})}t.restore()}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(t){const{t:e,b:n,l:r,r:i}=t,o=new Map;return e&&o.set(rr.TOP,e),n&&o.set(rr.BOTTOM,n),r&&o.set(rr.LEFT,r),i&&o.set(rr.RIGHT,i),o}};hf.add(new Obe);const Pbe="DefaultDocsFontAndBaseLineExtension",Mbe=20;class Nbe extends e8{constructor(){super(...arguments),w(this,"uKey",Pbe),w(this,"Z_INDEX",Mbe),w(this,"_preFontString",""),w(this,"_preFontColor","")}draw(e,n,r){var i;if(!((i=r.parent)!=null&&i.parent))return;const{ts:o,content:a,fontStyle:s,bBox:u}=r,{spanPointWithFont:l=zt.create(0,0)}=this.extensionOffset;if(a==null)return;if(!o){this._fillText(e,r,l);return}this._preFontString!==(s==null?void 0:s.fontString)&&(e.font=this._preFontString=(s==null?void 0:s.fontString)||"");const{cl:c,va:d}=o,m=mo(c)||P0;if(m&&this._preFontColor!==m&&(e.fillStyle=m),d===yr.SUBSCRIPT||d===yr.SUPERSCRIPT){let f=0;d===yr.SUPERSCRIPT&&(f=-u.sbo),l.y+=f}this._fillText(e,r,l)}_fillText(e,n,r){const{renderConfig:i,spanStartPoint:o,centerPoint:a}=this.extensionOffset,{content:s,width:u,bBox:l}=n,{aba:c,abd:d}=l;if(s==null||o==null||a==null)return;const{vertexAngle:m,centerAngle:f}=i??{},h=90;m===h&&f===h&&!pE(s)?(e.save(),e.translate(o.x+a.x,o.y+a.y),e.rotate(Math.PI/2),e.translate(-u/2,(c+d)/2-d),e.fillText(s,0,0),e.restore()):e.fillText(s,r.x,r.y)}clearCache(){this._preFontString="",this._preFontColor=""}}hf.add(new Nbe);const xbe="DefaultDocsLineExtension",Fbe=40;class $be extends e8{constructor(){super(...arguments),w(this,"uKey",xbe),w(this,"Z_INDEX",Fbe),w(this,"_preBackgroundColor","")}draw(e,n,r){var i;const o=(i=r.parent)==null?void 0:i.parent;if(!o)return;const{contentHeight:a=0,asc:s}=o,{ts:u,bBox:l}=r;if(!u)return;const{sp:c,ba:d}=l,m=Nx(n),f=.5,{ul:h,st:p,ol:v}=u;if(h){const g=a+UI-3;this._drawLine(e,r,h,g,m)}if(p){const g=s-(d-c)-f;this._drawLine(e,r,p,g,m)}if(v){const g=-UI-f;this._drawLine(e,r,v,g,m)}}clearCache(){this._preBackgroundColor=""}_drawLine(e,n,r,i,o){var a;const{s,cl:u,t:l,c=we.TRUE}=r;if(s===we.TRUE){const{originTranslate:d=zt.create(0,0),alignOffset:m=zt.create(0,0),renderConfig:f={}}=this.extensionOffset,{left:h,width:p}=n,{centerAngle:v=0,vertexAngle:g=0}=f,b=q1(v),C=q1(g);e.save(),e.translateWithPrecisionRatio(gi,gi),e.beginPath();const S=(c===we.TRUE?mo((a=n.ts)==null?void 0:a.cl):mo(u))||P0;e.strokeStyle=S,this._setLineType(e,l||Aa.SINGLE);const E=p9(d.addByPoint(h,i),zt.create(0,0),b,C,m),y=p9(d.addByPoint(h+p,i),zt.create(0,0),b,C,m);e.moveTo(E.x,E.y),e.lineTo(y.x,y.y),e.stroke(),e.restore()}}_setLineType(e,n){n===Aa.DASH_DOT_DOT_HEAVY||n===Aa.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):n===Aa.DASH_DOT_HEAVY||n===Aa.DOT_DASH?e.setLineDash([2,5,2]):n===Aa.DOTTED||n===Aa.DOTTED_HEAVY?e.setLineDash([2]):n===Aa.DASH||n===Aa.DASHED_HEAVY?e.setLineDash([3]):n===Aa.DASH_LONG||n===Aa.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}}hf.add(new $be);class kbe extends jx{constructor(e,n){super(e),w(this,"pageMarginLeft",0),w(this,"pageMarginTop",0),w(this,"pageLayoutType",Ds.VERTICAL),this._skeleton=n}getSkeleton(){return this._skeleton}setSkeleton(e){this._skeleton=e}render(e,n){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const r=this.transform.getMatrix();e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._draw(e,n),e.restore()}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:n=1}=this.parent;return this.parent.classType===qt.SCENE&&(e=this.parent.ancestorScaleX||1,n=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:n}}scrollBySelection(){}syncSelection(){}remainActiveSelection(){}findNodeByCoord(e,n){}findCoordByNode(e){}_getBounding(e){}_draw(e,n){}}class t8 extends kbe{constructor(e,n,r){super(e,n),w(this,"onPageRenderObservable",new Vn),w(this,"docsLeft",0),w(this,"docsTop",0),w(this,"_drawLiquid"),w(this,"_findLiquid"),w(this,"_skeletonObserver"),this.setConfig(r),this._drawLiquid=new Lm,this._findLiquid=new Lm,this._initialDefaultExtension(),this.makeDirty(!0)}static create(e,n,r){return new t8(e,n,r)}setConfig(e){this.pageMarginLeft=(e==null?void 0:e.pageMarginLeft)||17,this.pageMarginTop=(e==null?void 0:e.pageMarginTop)||14,this.pageLayoutType=(e==null?void 0:e.pageLayoutType)||Ds.VERTICAL}getOffsetConfig(){const{transform:e,pageLayoutType:n,pageMarginLeft:r,pageMarginTop:i,left:o,top:a}=this;return{documentTransform:e,pageLayoutType:n,pageMarginLeft:r,pageMarginTop:i,docsLeft:o,docsTop:a}}getEngine(){return this.getScene().getEngine()}draw(e,n){var r;if(!this.getSkeleton())return;this._drawLiquid.reset();const i=(r=this.getSkeleton())==null?void 0:r.getSkeletonData();if(i==null)return;this._drawLiquid.reset();const{pages:o}=i,a=this.getParentScale(),s=this.getExtensionsByOrder();for(const c of s)c.clearCache();let u=0,l=0;for(let c=0,d=o.length;c<d;c++){const m=o[c],{sections:f,marginTop:h=0,marginBottom:p=0,marginLeft:v=0,marginRight:g=0,width:b,height:C,renderConfig:S={}}=m,{verticalAlign:E=li.TOP,horizontalAlign:y=Zn.LEFT,centerAngle:D=0,vertexAngle:R=0,wrapStrategy:I=Ar.UNSPECIFIED}=S,T=this._horizontalHandler(b,v,g,y),P=this._verticalHandler(C,h,p,E),N=zt.create(T,P),B=q1(D),W=q1(R),G=W-B;this.onPageRenderObservable.notifyObservers({page:m,pageLeft:l,pageTop:u,ctx:e}),this._startRotation(e,G);for(const X of f){const{columns:x}=X;this._drawLiquid.translateSection(X);for(const O of x){const{lines:M,width:V}=O;this._drawLiquid.translateColumn(O);const q=M.length;let ie=N,ce=null;if(W!==0){const{rotateTranslateXList:pe,rotatedHeight:oe,rotatedWidth:he,fixOffsetX:fe,fixOffsetY:ve,rotateTranslateY:Ue}=Ux(M,V,W);let ke=he;oe>this.height&&I!==Ar.WRAP&&(I===Ar.OVERFLOW||W>0)&&(ke=this.height/Math.tan(Math.abs(W)));const Te=this._horizontalHandler(ke,v,g,y);let Re=this._verticalHandler(oe,h,p,E)-ve;oe>this.height&&(W<0?Re=this.height-(oe+ve):Re=-ve),ie=zt.create(Te+fe,Re),this._drawLiquid.translate(0,-Ue),ce=pe}else I===Ar.WRAP&&(ie.x=v);for(let pe=0;pe<q;pe++){const oe=M[pe],{divides:he,asc:fe=0,type:ve,lineHeight:Ue=0}=oe,ke=fe,Te=ke*Math.sin(B),Re=ke*Math.cos(B);if(ve===Z5.BLOCK)for(const rt of s)rt.type===a_.LINE&&(rt.extensionOffset={alignOffset:ie,renderConfig:S},rt.draw(e,a,oe));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(oe,!0),ce&&this._drawLiquid.translate(ce[pe]);const rt=he.length;for(let _t=0;_t<rt;_t++){const mt=he[_t],{spanGroup:nt}=mt;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(mt);for(const _e of nt){if(!_e.content||_e.content.length===0)continue;const{width:He,left:et,paddingLeft:Dt}=_e,{x:Mt,y:Bt}=this._drawLiquid,Zt=zt.create(Mt,Bt),It=zt.create(He/2,Ue/2),pn=p9(Zt.addByPoint(et+Dt,0),It,B,W,ie),yn=p9(Zt.addByPoint(et+Te+Dt,Re),It,B,W,ie),$t={originTranslate:Zt,spanStartPoint:pn,spanPointWithFont:yn,centerPoint:It,alignOffset:ie,renderConfig:S};for(const Ht of s)Ht.type===a_.SPAN&&(Ht.extensionOffset=$t,Ht.draw(e,a,_e))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(e,G);const{x:Q,y:te}=this._drawLiquid.translatePage(m,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);l+=Q,u+=te}}changeSkeleton(e){return this.setSkeleton(e),this}_draw(e,n){this.draw(e,n)}_horizontalHandler(e,n,r,i){let o=0;return i===Zn.CENTER?o=(this.width-e)/2:i===Zn.RIGHT?o=this.width-e-r:o=n,o}_verticalHandler(e,n,r,i){let o=0;return i===li.MIDDLE?o=(this.height-e)/2:i===li.TOP?o=n:o=this.height-e-r,o}_startRotation(e,n){e.rotate(n||0)}_resetRotation(e,n){e.rotate(-n||0)}_initialDefaultExtension(){hf.getData().forEach(e=>{this.register(e)})}}function Bbe(t){const e=t.getBoundingClientRect(),n=document.body,r=document.documentElement,i=window.pageYOffset||r.scrollTop||n.scrollTop,o=window.pageXOffset||r.scrollLeft||n.scrollLeft,a=r.clientTop||n.clientTop,s=r.clientLeft||n.clientLeft,u=e.top+i-a,l=e.left+o-s;return{top:u,left:l}}var $o=(t=>(t[t.NONE=0]="NONE",t[t.X=1]="X",t[t.Y=2]="Y",t[t.ALL=3]="ALL",t))($o||{});class c1{constructor(e,n=3,r,i=.4,o=.1){w(this,"_requestNewFrameNumber",-1),w(this,"_viewport"),w(this,"_offsetX",0),w(this,"_offsetY",0),w(this,"_moveX",0),w(this,"_moveY",0),w(this,"_scrollX",0),w(this,"_scrollY",0),w(this,"_scrollFunction"),this._scene=e,this._scrollTimerType=n,this._padding=r,this._smoothRatioX=i,this._smoothRatioY=o,this._padding||(this._padding={t:0,b:15,l:0,r:60})}static create(e,n=3,r){return new c1(e,n,r)}set scrollTimerType(e){this._scrollTimerType=e}get scrollTimerType(){return this._scrollTimerType}setActiveViewport(e){this._viewport=e}getActiveViewport(){return this._viewport}startScroll(e,n,r){this._offsetX=e,this._offsetY=n,this._moveX=e,this._moveY=n,r!=null?this._viewport=r:this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const n=(e==null?void 0:e.top)||0,r=n+((e==null?void 0:e.height)||0),i=(e==null?void 0:e.left)||0,o=i+((e==null?void 0:e.width)||0),{t:a=0,b:s=0,r:u=0,l=0}=this._padding;let c=0,d=0,m=!1;if(this._scrollTimerType&1&&(this._moveX<i+l&&(c=(this._moveX-i-l)*this._smoothRatioX,m=!0),this._moveX>o-u&&(c=(this._moveX-o+u)*this._smoothRatioX,m=!0)),this._scrollTimerType&2&&(this._moveY<n+a&&(d=(this._moveY-n-a)*this._smoothRatioY,m=!0),this._moveY>r-s&&(d=(this._moveY-r+s)*this._smoothRatioY,m=!0)),!m)return;const f=e==null?void 0:e.scrollBy({x:c,y:d}),h=e==null?void 0:e.getActualScroll(c,d);if(this._scrollX=(h==null?void 0:h.x)||0,this._scrollY=(h==null?void 0:h.y)||0,f){const p=this._findAncestorScene(e==null?void 0:e.scene),v=this.getViewportByCoord(p);v&&this._scroll(v)}}scrolling(e,n,r){this._moveX=e,this._moveY=n,this._scrollFunction=r}stopScroll(){Ax(this._requestNewFrameNumber)}dispose(){this.stopScroll(),delete this._scrollFunction}getViewportByCoord(e){return e==null?void 0:e.getActiveViewportByRelativeCoord(zt.FromArray([this._offsetX,this._offsetY]))}getScene(){return this._scene}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=Rm(this._runRenderLoop.bind(this))}_findAncestorScene(e){let n=e==null?void 0:e.getParent();for(;n;){if(n.classType===qt.SCENE)return n;n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}}}var Ube=Object.defineProperty,Vbe=Object.getOwnPropertyDescriptor,Hbe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Vbe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Ube(e,n,i),i},jbe=(t,e)=>(n,r)=>e(n,r,t);function pF(t){const e=t==null?void 0:t.getCanvasElement();if(!e)return{left:0,top:0};const{top:n,left:r}=Bbe(e);return{left:r,top:n}}function hA(t){var e;const n=(e=t.parent)==null?void 0:e.parent,r=n==null?void 0:n.parent;if(n==null||r==null)return;const{paragraphIndex:i}=n,o=r.lines.filter(l=>l.paragraphIndex===i);let a=-1,s="",u=!1;for(const l of o)for(const c of l.divides)for(const d of c.spanGroup)u||(a+=d.count),d===t&&(u=!0),s+=d.count>0?d.content:"";return{st:o[0].st,ed:i,content:s,nodeIndex:a}}let s_=class extends Ro{constructor(e){super(),w(this,"_onInputBefore$",new dn(null)),w(this,"onInputBefore$",this._onInputBefore$.asObservable()),w(this,"_onKeydown$",new dn(null)),w(this,"onKeydown$",this._onKeydown$.asObservable()),w(this,"_onInput$",new dn(null)),w(this,"onInput$",this._onInput$.asObservable()),w(this,"_onCompositionstart$",new dn(null)),w(this,"onCompositionstart$",this._onCompositionstart$.asObservable()),w(this,"_onCompositionupdate$",new dn(null)),w(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable()),w(this,"_onCompositionend$",new dn(null)),w(this,"onCompositionend$",this._onCompositionend$.asObservable()),w(this,"_onSelectionStart$",new dn(null)),w(this,"onSelectionStart$",this._onSelectionStart$.asObservable()),w(this,"_onPaste$",new an),w(this,"onPaste$",this._onPaste$.asObservable()),w(this,"_textSelectionInner$",new dn(null)),w(this,"textSelectionInner$",this._textSelectionInner$.asObservable()),w(this,"_container"),w(this,"_inputParent"),w(this,"_input"),w(this,"_cursor"),w(this,"_moveObserver"),w(this,"_upObserver"),w(this,"_viewportScrollX",0),w(this,"_viewportScrollY",0),w(this,"_rangeList",[]),w(this,"_currentSegmentId",""),w(this,"_selectionStyle",Am),w(this,"_isSelectionEnabled",!0),w(this,"_viewPortObserverMap",new Map),w(this,"_isIMEInputApply",!1),w(this,"_activeViewport"),w(this,"_docSkeleton"),w(this,"_scene"),w(this,"_document"),this._logService=e,this._initDOM()}__getEditorContainer(){return this._container}getViewPort(){return this._activeViewport}setSegment(e){this._currentSegmentId=e}setStyle(e=Am){this._selectionStyle=e}resetStyle(){this.setStyle()}enableSelection(){this._isSelectionEnabled=!0}disableSelection(){this._isSelectionEnabled=!1}addTextRanges(e){const{_scene:n,_docSkeleton:r}=this;for(const i of e){const o=Sbe(n,i,r,this._document);this._add(o)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),segmentId:this._currentSegmentId,style:this._selectionStyle}),this._updateDomCursorPositionAndSize(),this._scrollToSelection()}sync(){this._updateDomCursorPositionAndSize()}activate(e,n){this._container.style.left=`${e}px`,this._container.style.top=`${n}px`,this._container.style.zIndex="1000",this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",this.focus()}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none"}changeRuntime(e,n,r){e!==this._docSkeleton&&this.removeAllTextRanges(),this._docSkeleton=e,this._scene=n,this._activeViewport=n.getViewports()[0],this._document=r,this._attachScrollEvent(this._activeViewport)}handleDblClick(e){if(!this._scene||!this._isSelectionEnabled)return;const{offsetX:n,offsetY:r}=e,i=this._findNodeByCoord(n,r);if(i==null||i.node==null)return;const o=hA(i.node);if(o==null)return;const{content:a,st:s,nodeIndex:u}=o;if(u===-1||Intl.Segmenter==null)return;const l=new Intl.Segmenter(void 0,{granularity:"word"}).segment(a);let c=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY;for(const{segment:m,index:f,isWordLike:h}of l)if(f<=u&&u<f+m.length&&h){c=f+s,d=f+s+m.length;break}if(Number.isFinite(c)&&Number.isFinite(d)){this.removeAllTextRanges();const m=[{startOffset:c,endOffset:d}];this.addTextRanges(m)}}handleTripleClick(e){if(!this._scene||!this._isSelectionEnabled)return;const{offsetX:n,offsetY:r}=e,i=this._findNodeByCoord(n,r);if(i==null||i.node==null)return;const o=hA(i.node);if(o==null)return;this.removeAllTextRanges();const{st:a,ed:s}=o,u=[{startOffset:a,endOffset:s,collapsed:a===s}];this.addTextRanges(u)}eventTrigger(e){var n;if(!this._scene||!this._isSelectionEnabled)return;const r=this._scene,{offsetX:i,offsetY:o}=e,a=this._findNodeByCoord(i,o),s=this._getNodePosition(a);if(s==null){this._removeAllTextRanges();return}if((a==null?void 0:a.node.streamType)===mn.PARAGRAPH&&(s.isBack=!0),e.shiftKey&&this._getActiveRangeInstance())this._updateActiveRangeFocusPosition(s);else if(e.ctrlKey||this._isEmpty()){const f=new o_(r,this._document,this._docSkeleton,s);this._addTextRange(f)}else this._updateTextRangeAnchorPosition(s);this._activeSelectionRefresh(),r.disableEvent();const u=c1.create(r);u.startScroll(i,o);const{scrollX:l,scrollY:c}=b6(u);this._viewportScrollX=l,this._viewportScrollY=c,this._onSelectionStart$.next((n=this._getActiveRangeInstance())==null?void 0:n.startNodePosition);let d=i,m=o;this._moveObserver=r.onPointerMoveObserver.add(f=>{const{offsetX:h,offsetY:p}=f;r.setCursor(Jt.TEXT),!(Math.sqrt((h-d)**2+(p-m)**2)<3)&&(this._moving(h,p,u),u.scrolling(h,p,()=>{this._moving(h,p,u)}),d=h,m=p)}),this._upObserver=r.onPointerUpObserver.add(()=>{r.onPointerMoveObserver.remove(this._moveObserver),r.onPointerUpObserver.remove(this._upObserver),r.enableEvent(),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),segmentId:this._currentSegmentId,style:this._selectionStyle}),u.dispose(),this._updateDomCursorPositionAndSize()})}removeAllTextRanges(){this._removeAllTextRanges(),this.deactivate()}_getAllTextRanges(){return this._rangeList}_getActiveRange(){const e=this._rangeList.find(u=>u.isActive());if(e==null)return null;const{startOffset:n,endOffset:r,collapsed:i,startNodePosition:o,endNodePosition:a,direction:s}=e;return n==null||r==null?null:{startOffset:n,endOffset:r,collapsed:i,startNodePosition:o,endNodePosition:a,direction:s,segmentId:this._currentSegmentId,style:this._selectionStyle}}_add(e){e!=null&&(this._addTextRange(e),e.refresh())}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._container.remove()}_initDOM(){const e=document.createElement("div");e.style.position="fixed",e.style.left="0px",e.style.top="0px";const n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div");n.appendChild(r),e.appendChild(n),e.appendChild(i),this._container=e,this._inputParent=n,this._input=r,this._cursor=i,this._initInput(),this._initDOMCursor(),this._initInputEvents(),document.body.appendChild(e)}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.classList.add("univer-editor"),this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_initDOMCursor(){this._cursor.style.cssText=`
            visibility: visible;
            position: absolute;
            background: #000;
            left: 0;
            top: 0;
            width: 1px;
            height: 20px;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
            display: none
        `,uge("keyframes univer_cursor_blinkStyle")||sge([`
                @-webkit-keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }

                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }

                    100% {
                        opacity: 1;
                    }
                }
            `,`
                @keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }

                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }

                    100% {
                        opacity: 1;
                    }
                }
            `])}_getNodePosition(e){var n;if(e==null)return;const{node:r,ratioX:i}=e,o=(n=this._docSkeleton)==null?void 0:n.findPositionBySpan(r);if(o==null)return;const a=i<.5;return{...o,isBack:a}}_interactTextRange(e){const n=[];let r=!1;this._rangeList.forEach(i=>{if(i===e)return!0;e.isIntersection(i)?(r=!0,i.dispose()):n.push(i)}),r&&(n.push(e),this._rangeList=n)}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_updateTextRangeAnchorPosition(e){if(!this._scene)return;let n=this._rangeList.pop();n||(n=new o_(this._scene,this._document,this._docSkeleton,e)),this._removeAllTextRanges(),n.activate(),n.anchorNodePosition=e,n.focusNodePosition=null,this._rangeList=[n]}_updateActiveRangeFocusPosition(e){if(!this._scene){this._logService.error("[TextSelectionRenderManager] _updateActiveRangeFocusPosition: scene is null");return}const n=this._getActiveRangeInstance();if(n==null||n.anchorNodePosition==null){this._logService.error("[TextSelectionRenderManager] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllTextRanges(),n.activate(),n.focusNodePosition=e,this.deactivate(),this._rangeList=[n]}_isEmpty(){return this._rangeList.length===0}_getCanvasOffset(){var e;const n=(e=this._scene)==null?void 0:e.getEngine();return pF(n)}_scrollToSelection(){const e=this._getActiveRangeInstance(),n=e==null?void 0:e.getAnchor();if(!n||n&&!n.visible||this._activeViewport==null)return;const{left:r,top:i,height:o,width:a}=n,{left:s,top:u,right:l,bottom:c}=this._activeViewport.getBounding().viewBound,d=a,m=o;let f=0,h=0;i<u?f=i-u:i>c-m&&(f=i-c+m),r<s?h=r-s:r>l-d&&(h=r-l+d);const p=this._activeViewport.getBarScroll(h,f);this._activeViewport.scrollBy(p)}_updateDomCursorPositionAndSize(){var e;const n=this._getActiveRangeInstance(),r=n==null?void 0:n.getAnchor();if(!r||r&&!r.visible||this._activeViewport==null){this.focus();return}const{height:i,left:o,top:a}=r,s=this._activeViewport.getAbsoluteVector(zt.FromArray([o,a])),{scaleY:u}=((e=this._scene)==null?void 0:e.getAncestorScale())||{scaleX:1,scaleY:1},{x:l,y:c}=s;this._cursor.style.height=`${i*u}px`;let{left:d,top:m}=this._getCanvasOffset();d+=l,m+=c,this.activate(d,m)}_moving(e,n,r){if(this._docSkeleton==null)return;const i=this._findNodeByCoord(e,n),o=this._getNodePosition(i);if(!o)return;const a=this._getActiveRangeInstance();a&&(a.focusNodePosition=o,a.refresh(),this.deactivate(),this._interactTextRange(a))}_attachScrollEvent(e){if(e==null||this._docSkeleton==null)return;const n=`${this._docSkeleton.getViewModel().getDataModel().getUnitId()}_${e.viewPortKey}`;if(this._viewPortObserverMap.has(n))return;const r=e.onScrollBeforeObserver.add(o=>{if(!o.viewport)return;const a=this._getActiveRangeInstance();a==null||a.activeStatic(),this._cursor.style.display="none"}),i=e.onScrollStopObserver.add(o=>{const a=o.viewport;if(!a)return;const s=a.getBounding(),u=this._getActiveRangeInstance(),l=u==null?void 0:u.getAnchor();if(!(!l||l&&!l.visible)){if(s){const{left:c,top:d,right:m,bottom:f}=s.viewBound;if(l.left<c||l.left>m||l.top<d||l.top>f){u==null||u.deactivateStatic();return}}this._updateDomCursorPositionAndSize(),u==null||u.deactivateStatic(),this._cursor.style.display="revert"}});this._viewPortObserverMap.set(n,{scrollBefore:r,scrollStop:i})}_initInputEvents(){this._input.addEventListener("keydown",e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onKeydown$.next(n)})}),this._input.addEventListener("input",e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onInput$.next(n)})}),this._input.addEventListener("compositionstart",e=>{this._isIMEInputApply=!0,this._eventHandle(e,n=>{this._onCompositionstart$.next(n)})}),this._input.addEventListener("compositionend",e=>{this._isIMEInputApply=!1,this._eventHandle(e,n=>{this._onCompositionend$.next(n)})}),this._input.addEventListener("compositionupdate",e=>{this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onCompositionupdate$.next(n)})}),this._input.addEventListener("paste",e=>{this._eventHandle(e,n=>{this._onPaste$.next(n)})})}_eventHandle(e,n){const r=this._input.textContent||"";this._input.innerHTML="";const i=this._getActiveRange(),o=this._getAllTextRanges();n({event:e,content:r,activeRange:i,rangeList:o})}_getTransformCoordForDocumentOffset(e,n){const{documentTransform:r}=this._document.getOffsetConfig();if(this._activeViewport==null||r==null)return;const i=this._activeViewport.getRelativeVector(zt.FromArray([e,n]));if(i)return r.clone().invert().applyPoint(i)}_findNodeByCoord(e,n){var r;const i=this._getTransformCoordForDocumentOffset(e,n);if(i==null)return;const{pageLayoutType:o=Ds.VERTICAL,pageMarginLeft:a,pageMarginTop:s}=this._document.getOffsetConfig();return(r=this._docSkeleton)==null?void 0:r.findNodeByCoord(i,o,a,s)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete()}_activeSelectionRefresh(){if(this._docSkeleton==null)return;const e=this._getActiveRangeInstance();e==null||e.refresh()}};s_=Hbe([jbe(0,oo)],s_);const To=ln("univer.doc.text-selection-render-manager");let gF=class extends jx{constructor(e,n){super(e),this._skeleton=n}getSkeleton(){return this._skeleton}updateSkeleton(e){this._skeleton=e}render(e,n){if(!this.visible)return this.makeDirty(!1),this;e.save(),this._draw(e,n),e.restore()}getParentScale(){let{scaleX:e=1,scaleY:n=1}=this.parent;return this.parent.classType===qt.SCENE_VIEWER&&(e=this.parent.ancestorScaleX||1,n=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:n}}getDocuments(){}getNoMergeCellPositionByIndex(e,n){}getScrollXYByRelativeCoords(e){return{x:0,y:0}}getSelectionBounding(e,n,r,i){}_draw(e,n){}},vF=class extends gF{_draw(e,n){this.draw(e,n)}},zbe=class extends vF{constructor(e,n){super(e,n),w(this,"_columnHeaderLayoutExtension"),this._initialDefaultExtension(),this.makeDirty(!0)}get columnHeaderLayoutExtension(){return this._columnHeaderLayoutExtension}draw(e,n){const r=this.getSkeleton();if(!r)return;const i=this.getParentScale();r.calculateSegment(n);const o=r.rowColumnSegment;if(o.startColumn===-1&&o.endColumn===-1)return;const{rowHeaderWidth:a}=r;e.translateWithPrecision(a,0);const s=this.getExtensionsByOrder();for(const u of s)u.draw(e,i,r)}isHit(e){const n=this._getInverseCoord(e),r=this.getSkeleton();if(!r)return!1;const{rowHeaderWidth:i,columnHeaderHeight:o}=r;return n.x>i&&n.y>=0&&n.y<=o}_initialDefaultExtension(){hF.getData().forEach(e=>{this.register(e)}),this._columnHeaderLayoutExtension=this.getExtensionByKey("DefaultColumnHeaderLayoutExtension")}};class pf extends mF{constructor(){super(...arguments),w(this,"type",0)}getCellIndex(e,n,r,i,o){return v6(e,n,r,i,o)}isRenderDiffRangesByCell(e,n){if(n==null||n.length===0)return!0;for(const r of n){const{startRow:i,startColumn:o,endRow:a,endColumn:s}=r;if(ht.intersects(r,{startRow:i,endRow:a,startColumn:o,endColumn:s}))return!0}return!1}isRenderDiffRangesByColumn(e,n,r){if(r==null||r.length===0)return!0;for(const i of r){const{startColumn:o,endColumn:a}=i;if(ht.intersects({startRow:0,endRow:0,startColumn:e,endColumn:n},{startRow:0,endRow:0,startColumn:o,endColumn:a}))return!0}return!1}isRenderDiffRangesByRow(e,n,r){if(r==null||r.length===0)return!0;for(const i of r){const{startRow:o,endRow:a}=i;if(ht.intersects({startRow:e,endRow:n,startColumn:0,endColumn:0},{startRow:o,endRow:a,startColumn:0,endColumn:0}))return!0}return!1}}const Wbe="DefaultBackgroundExtension",Ybe=40,Xbe=20;class qbe extends pf{constructor(){super(...arguments),w(this,"uKey",Wbe),w(this,"Z_INDEX",Ybe),w(this,"PRINTING_Z_INDEX",Xbe)}get zIndex(){var e;return(e=this.parent)!=null&&e.isPrinting?this.PRINTING_Z_INDEX:this.Z_INDEX}draw(e,n,r,i){const{stylesCache:o}=r,{background:a,backgroundPositions:s}=o;if(!r)return;const{rowHeightAccumulation:u,columnTotalWidth:l,columnWidthAccumulation:c,rowTotalHeight:d}=r;!u||!c||l===void 0||d===void 0||(e.save(),e.setGlobalCompositeOperation("destination-over"),a&&Object.keys(a).forEach(m=>{const f=a[m];e.fillStyle=m||la([255,255,255]),e.beginPath(),f.forValue((h,p)=>{const v=s==null?void 0:s.getValue(h,p);if(v==null)return!0;let{startY:g,endY:b,startX:C,endX:S}=v;const{isMerged:E,isMergedMainCell:y,mergeInfo:D}=v;if(E||!this.isRenderDiffRangesByCell({startRow:D.startRow,endRow:D.endRow,startColumn:D.startColumn,endColumn:D.endColumn},i))return!0;y&&(g=D.startY,b=D.endY,C=D.startX,S=D.endX),e.moveTo(C,g),e.lineTo(C,b),e.lineTo(S,b),e.lineTo(S,g)}),e.closePath(),e.fill()}),e.restore())}}J5.add(qbe);const Gbe="DefaultBorderExtension",Kbe=50;class Zbe extends pf{constructor(){super(...arguments),w(this,"uKey",Gbe),w(this,"Z_INDEX",Kbe)}draw(e,n,r,i){const{dataMergeCache:o,stylesCache:a,overflowCache:s}=r,{border:u}=a;if(!r)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:d,rowTotalHeight:m}=r;if(!l||!d||c===void 0||m===void 0)return;e.save();let f,h;e.translateWithPrecisionRatio(gi,gi),u==null||u.forValue((p,v,g)=>{if(!g)return!0;const b=this.getCellIndex(p,v,l,d,o);let{startY:C,endY:S,startX:E,endX:y}=b;const{isMerged:D,isMergedMainCell:R,mergeInfo:I}=b;if(D||(R&&(C=I.startY,S=I.endY,E=I.startX,y=I.endX),!this.isRenderDiffRangesByRow(I.startRow,I.endRow,i)))return!0;for(const T in g){const{type:P,style:N,color:B}=g[T];N!==f&&(kx(e,N),e.lineWidth=Bx(N),f=N),B!==h&&(e.strokeStyle=B||P0,h=B),hge(e,P,{startX:E,startY:C,endX:y,endY:S}),!this._getOverflowExclusion(s,P,p,v)&&$x(e,P,{startX:E,startY:C,endX:y,endY:S})}}),e.closePath(),e.restore()}_getOverflowExclusion(e,n,r,i){let o=!1;return n===rr.TOP||n===rr.BOTTOM||e==null||e.forRow((a,s)=>{if(a!==r)return!0;s.forEach(u=>{const l=e.getValue(a,u),{startColumn:c,endColumn:d}=l;if(n===rr.LEFT&&i>c&&i<=d||n===rr.RIGHT&&i>=c&&i<d)return o=!0,!1})}),o}}J5.add(Zbe);const Qbe="DefaultColumnHeaderLayoutExtension";class Jbe extends pf{constructor(){super(...arguments),w(this,"uKey",Qbe),w(this,"Z_INDEX",10)}draw(e,n,r){const{rowColumnSegment:i,columnHeaderHeight:o=0}=r,{startColumn:a,endColumn:s}=i;if(!r)return;const{rowHeightAccumulation:u,columnTotalWidth:l,columnWidthAccumulation:c,rowTotalHeight:d}=r;if(!u||!c||l===void 0||d===void 0)return;const m=this._getScale(n);e.fillStyle=la([248,249,250]),e.fillRect(0,0,l,o),e.textAlign="center",e.textBaseline="middle",e.fillStyle=la([0,0,0]),e.beginPath(),e.lineWidth=1,e.translateWithPrecisionRatio(gi,gi),e.strokeStyle=la([217,217,217]),e.font=`13px ${mE}`;let f=0;const h=c.length;for(let v=a-1;v<=s;v++){if(v<0||v>h-1)continue;const g=c[v];if(f===g)continue;e.moveTo(g,0),e.lineTo(g,o);const b=f+(g-f)/2;e.fillText(UW(v),b,o/2+Dx),f=g}const p=o-.5/m;e.moveTo(0,p),e.lineTo(l,p),e.stroke()}}hF.add(new Jbe);let Vd=class $4{constructor(e,n){w(this,"children",[]),w(this,"parent"),w(this,"startIndex",-1),w(this,"endIndex",-1),w(this,"blocks",[]),this.nodeType=e,this.content=n}static create(e,n){return new $4(e,n)}dispose(){this.children.forEach(e=>{e.dispose()}),this.parent=null,this.blocks=[]}getProps(){const{children:e,parent:n,startIndex:r,endIndex:i,nodeType:o,content:a}=this;return{children:e,parent:n,startIndex:r,endIndex:i,nodeType:o,content:a}}addBlocks(e){this.blocks=this.blocks.concat(e)}setIndexRange(e,n){this.startIndex=e,this.endIndex=n}insertText(e,n){this.content=_L(this.content||"",n-this.startIndex,e)}exclude(e){const{startIndex:n,endIndex:r}=this;return e<n||e>r}plus(e){this.startIndex+=e,this.endIndex+=e,this._addIndexForBlock(e)}selfPlus(e,n){this.endIndex+=e,n==null&&(n=this.startIndex),this._addIndexForBlock(e,n)}split(e){const{children:n,parent:r,startIndex:i,nodeType:o,content:a=""}=this.getProps();if(this.exclude(e))return;const s=0,u=e-i,l=u,c=a.slice(s,u),d=$4.create(o,c);d.parent=r,d.setIndexRange(s,u-1);const m=a.slice(l),f=$4.create(o,m);f.parent=r,f.setIndexRange(l,l+m.length-1);const h=[],p=[];for(const v of n){const{startIndex:g}=v;if(v.exclude(e))e<g?h.push(v):p.push(v);else{const b=v.split(e);if(b==null){h.push(v);continue}const{firstNode:C,lastNode:S}=b;h.push(C),h.push(S)}}return d.children=h,f.children=p,d._resetBlocks(),f._resetBlocks(),{firstNode:d,lastNode:f}}getPositionInParent(){var e;const n=(e=this.parent)==null?void 0:e.children.indexOf(this);return n??-1}remove(){this.children=[],this.parent!=null&&(this.parent.children.splice(this.getPositionInParent(),1),this.parent=null)}minus(e,n){const r=FC(this.startIndex,this.endIndex,e,n);if(r.length===0)return;const i=this.startIndex;this.startIndex=r[0],this.endIndex=r[1],this.content!=null&&(this.content=CL(this.content||"",e-i,n-i+1))}merge(e){const{startIndex:n,endIndex:r,children:i}=e;this.endIndex+=r-n+1,this.children.push(...i),this.content+=e.content||"",e.remove()}_addIndexForBlock(e,n=Number.NEGATIVE_INFINITY){for(let r=0,i=this.blocks.length;r<i;r++){const o=this.blocks[r];o>=n&&(this.blocks[r]=o+e)}}_resetBlocks(){if(this.nodeType===si.PARAGRAPH&&this.content!=null&&this.content.length!==0){this.blocks=[];for(let e=0,n=this.content.length;e<n;e++)this.content[e]===mn.CUSTOM_BLOCK&&this.blocks.push(this.startIndex+e)}}},u_=class k4{constructor(e){w(this,"children",[]),w(this,"_sectionBreakCurrentIndex",0),w(this,"_paragraphCurrentIndex",0),w(this,"_textRunCurrentIndex",0),w(this,"_customBlockCurrentIndex",0),w(this,"_tableBlockCurrentIndex",0),w(this,"_customRangeCurrentIndex",0),w(this,"headerTreeMap",new Map),w(this,"footerTreeMap",new Map),this._documentDataModel=e,e.getBody()!=null&&(this.children=this._transformToTree(e.getBody().dataStream),this._buildHeaderFooterViewModel())}dispose(){this.children.forEach(e=>{e.dispose()})}selfPlus(e,n){}getPositionInParent(){return 0}getLastIndex(){return this.children[this.children.length-1].endIndex}getBody(){return this._documentDataModel.getBody()}getDataModel(){return this._documentDataModel}getSelfOrHeaderFooterViewModel(e){return e==null?this:this.headerTreeMap.has(e)?this.headerTreeMap.get(e):this.footerTreeMap.has(e)?this.footerTreeMap.get(e):this}reset(e){this._documentDataModel=e,this.children=this._transformToTree(e.getBody().dataStream),this._buildHeaderFooterViewModel()}insert(e,n=0){var r;const i=e.dataStream;let o=i.length;const a=this._getParagraphByIndex(this.children,n);if(a!=null)if(i[o-1]===mn.SECTION_BREAK){const s=new nm({body:e}),u=new k4(s);o-=1;const l=u.children;for(const f of l)this._forEachDown(f,h=>{h.plus(n)});const c=a.split(n);if(c==null)return;const{firstNode:d,lastNode:m}=c;(r=a.parent)==null||r.children.splice(a.getPositionInParent(),1,d,...l,m),this._forEachTop(a.parent,f=>{f.selfPlus(o,f.getPositionInParent());const h=f.children;let p=!1;for(const v of h)v===m&&(p=!0),p&&this._forEachDown(v,g=>{g.plus(o)})})}else o===1&&i[o-1]===mn.PARAGRAPH?this._insertParagraph(a,n):(a.insertText(i,n),a.selfPlus(o,n),this._forEachTop(a.parent,s=>{s.selfPlus(o,s.getPositionInParent());const u=s.children;let l=!1;for(const c of u)c.startIndex>n&&(l=!0),l&&this._forEachDown(c,d=>{d.plus(o)})}))}delete(e,n){const r=this.children;this._deleteTree(r,e,n)}getText(){const e=[];function n(r){r.content&&e.push(r.content),r.children.forEach(n)}return this.children.forEach(r=>n(r)),e.join("")}resetCache(){this._sectionBreakCurrentIndex=0,this._paragraphCurrentIndex=0,this._textRunCurrentIndex=0,this._customBlockCurrentIndex=0,this._tableBlockCurrentIndex=0,this._customRangeCurrentIndex=0}getSectionBreak(e){if(e==null)return;const n=this.getBody().sectionBreaks;if(n!=null)for(let r=this._sectionBreakCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._sectionBreakCurrentIndex=r,i}}getParagraph(e){const n=this.getBody().paragraphs;if(n!=null)for(let r=this._paragraphCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._paragraphCurrentIndex=r,i}}getTextRunRange(e=0,n){const r=this.getBody().textRuns;if(r==null)return[{st:e,ed:n}];const i=[];for(let s=this._textRunCurrentIndex,u=r.length;s<u;s++){const l=r[s];if(l.st>n){this._textRunCurrentIndex=s;break}else if(l.ed<e){this._textRunCurrentIndex=s;continue}else i.push({st:l.st<e?e:l.st,ed:l.ed>n?n:l.ed,sId:l.sId,ts:l.ts}),this._textRunCurrentIndex=s}const o=i[0]||{st:n+1};o.st>e&&i.push({st:e,ed:o.st-1});const a=i[i.length-1]||{ed:e-1};return a.ed<n&&i.push({st:a.ed+1,ed:n}),i}getTextRun(e){const n=this.getBody().textRuns;if(n==null)return;const r=n[this._textRunCurrentIndex];if(r!=null){if(e>=r.st&&e<r.ed)return r;if(e<r.st)return}for(let i=this._textRunCurrentIndex,o=n.length;i<o;i++){const a=n[i];if(e>=a.st&&e<a.ed)return this._textRunCurrentIndex=i,a}}getCustomBlock(e){const n=this.getBody().customBlocks;if(n!=null)for(let r=this._customBlockCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._customBlockCurrentIndex=r,i}}getTable(e){const n=this.getBody().tables;if(n!=null)for(let r=this._tableBlockCurrentIndex;r<n.length;r++){const i=n[r];if(i.startIndex===e)return this._tableBlockCurrentIndex=r,i}}getCustomRange(e){const n=this.getBody().customRanges;if(n!=null)for(let r=0,i=n.length;r<i;r++){const o=n[r];if(e>=o.startIndex&&e<=o.endIndex)return o}}_transformToTree(e){const n=e.length;let r="";const i=[];let o=[],a=[];for(let s=0;s<n;s++){const u=e[s];if(u===mn.PARAGRAPH){r+=mn.PARAGRAPH;const l=Vd.create(si.PARAGRAPH,r);l.setIndexRange(s-r.length+1,s),l.addBlocks(a),o.push(l),r="",a=[]}else if(u===mn.SECTION_BREAK){const l=Vd.create(si.SECTION_BREAK);this._batchParent(l,o);const c=o[o.length-1];c&&c.content&&(c.content+=mn.SECTION_BREAK),i.push(l),o=[]}else u===mn.TABLE_START?o.push(Vd.create(si.TABLE)):u===mn.TABLE_ROW_START?o.push(Vd.create(si.TABLE_ROW)):u===mn.TABLE_CELL_START?o.push(Vd.create(si.TABLE_CELL)):u===mn.TABLE_END?this._processPreviousNodesUntil(o,si.TABLE):u===mn.TABLE_ROW_END?this._processPreviousNodesUntil(o,si.TABLE_ROW):u===mn.TABLE_CELL_END?this._processPreviousNodesUntil(o,si.TABLE_CELL):(u===mn.CUSTOM_BLOCK&&a.push(s),r+=u)}return i}_processPreviousNodesUntil(e,n){const r=[];let i=e.pop();for(;i&&i.nodeType!==n;)r.push(i),i=e.pop();const o=e[e.length-1];if(this._batchParent(o,r,si.TABLE),n===si.TABLE_CELL){const a=r[0],s=r[r.length];a.content=mn.TABLE_CELL_START+a.content||"",a.startIndex-=1,s.content+=mn.TABLE_CELL_END,s.endIndex+=1}else if(n===si.TABLE_ROW){const a=r[0].children[0];let s=r[r.length];s=s.children[s.children.length-1],a.content=mn.TABLE_ROW_START+a.content||"",a.startIndex-=1,s.content+=mn.TABLE_ROW_END,s.endIndex+=1}else if(n===si.TABLE){const a=r[0].children[0].children[0];let s=r[r.length];s=s.children[s.children.length-1],s=s.children[s.children.length-1],a.content=mn.TABLE_START+a.content||"",a.startIndex-=1,s.content+=mn.TABLE_END,s.endIndex+=1}}_batchParent(e,n,r=si.SECTION_BREAK){for(const o of n)o.parent=e,e.children.push(o);const i=r===si.SECTION_BREAK?0:1;e.setIndexRange(n[0].startIndex-i,n[n.length-1].endIndex+1)}_buildHeaderFooterViewModel(){const{headerModelMap:e,footerModelMap:n}=this._documentDataModel;for(const[r,i]of e)this.headerTreeMap.set(r,new k4(i));for(const[r,i]of n)this.footerTreeMap.set(r,new k4(i))}_getParagraphByIndex(e,n){for(const r of e){const{children:i}=r;if(!r.exclude(n))return r.nodeType===si.PARAGRAPH?r:this._getParagraphByIndex(i,n)}return null}_forEachTop(e,n){let r=e;for(;r;)n(r),r=r.parent;n(this)}_forEachDown(e,n){n(e);const r=e.children;for(e of r)this._forEachDown(e,n)}_deleteTree(e,n,r){const i=n,o=n+r-1;let a=null,s=e.length,u=0;for(;u<s;){const l=e[u],{startIndex:c,endIndex:d,children:m}=l;if(this._deleteTree(m,n,r),i===o&&o===d){if(l.nodeType===si.PARAGRAPH){const f=this._getNextNode(l);if(f==null){u++;continue}l.minus(i,o),l.merge(f),s--}}else if(i<=c&&o>=d){l.remove(),s--;continue}else if(c<=i&&d>=o)l.minus(i,o);else if(o>c&&o<d){if(l.minus(c,o),a!=null){a.merge(l),a=null,s--;continue}}else i>c&&i<d?(l.minus(i,d),a=l):c>o&&l.plus(-r);u++}}_getNextNode(e){var n;const r=e.getPositionInParent(),i=(n=e.parent)==null?void 0:n.children;return i==null?void 0:i[r+1]}_insertParagraph(e,n=0){var r;const i=e.startIndex,o=e.endIndex,a=e.split(n);if(a==null)return;const{firstNode:s,lastNode:u}=a;s.content+=mn.PARAGRAPH,s.selfPlus(1),s.plus(i),this._forEachDown(u,l=>{l.plus(i+1)}),(r=e.parent)==null||r.children.splice(e.getPositionInParent(),1,s,u),this._forEachTop(e.parent,l=>{l.selfPlus(1,l.getPositionInParent());const c=l.children;let d=!1;for(const m of c)m!==u&&(m.startIndex>=o+1&&(d=!0),d&&this._forEachDown(m,f=>{f.plus(1)}))})}};function B4(t,e=0){const n=t==null?void 0:t.getSkeletonData(),r=q1(e);if(!n)return;const{pages:i}=n,o=i[i.length-1],{width:a,height:s}=o;if(r===0)return{width:a,height:s};if(Math.abs(r)===Math.PI/2)return{width:s,height:a};let u=0,l=0;const c=[];jge([o],m=>{const{lines:f,width:h,spaceWidth:p}=m,{rotatedHeight:v,rotatedWidth:g}=Ux(f,h,r);l+=v,c.push({rotatedWidth:g,spaceWidth:p})});const d=c.length;for(let m=0;m<d;m++){const{rotatedWidth:f}=c[m];m===0&&(u+=f)}return{width:u,height:l}}const pA={t:0,b:0,l:2,r:2};let e_e=class bF extends b9{constructor(e,n,r,i,o){super(o),w(this,"_rowHeightAccumulation",[]),w(this,"_rowTotalHeight",0),w(this,"_columnWidthAccumulation",[]),w(this,"_columnTotalWidth",0),w(this,"_rowHeaderWidth",0),w(this,"_columnHeaderHeight",0),w(this,"_rowColumnSegment",{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),w(this,"_dataMergeCache",[]),w(this,"_overflowCache",new Ye),w(this,"_stylesCache",{background:{},backgroundPositions:new Ye,font:{},border:new Ye}),w(this,"_renderedCellCache",new Ye),w(this,"_showGridlines",we.TRUE),w(this,"_marginTop",0),w(this,"_marginLeft",0),this._worksheet=e,this._config=n,this._cellData=r,this._styles=i,this.updateLayout()}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowHeaderWidth(){return this._rowHeaderWidth}get columnHeaderHeight(){return this._columnHeaderHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}get showGridlines(){return this._showGridlines}get mergeData(){return this._config.mergeData}get rowHeaderWidthAndMarginLeft(){return this.rowHeaderWidth+this._marginLeft}get columnHeaderHeightAndMarginTop(){return this.columnHeaderHeight+this._marginTop}static create(e,n,r,i,o){return new bF(e,n,r,i,o)}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}setOverflowCache(e){this._overflowCache=e}setMarginLeft(e){this._marginLeft=e}setMarginTop(e){this._marginTop=e}calculateSegment(e){if(this._config&&(this.updateLayout(),!(!this._rowHeightAccumulation||!this._columnWidthAccumulation)))return e!=null&&(this._rowColumnSegment=this.getRowColumnSegment(e)),!0}calculateWithoutClearingCache(e){if(!this.calculateSegment(e))return;const{mergeData:n}=this._config;return this._dataMergeCache=n&&this._getMergeCells(n,this._rowColumnSegment),this._calculateStylesCache(),this}calculate(e){return this._resetCache(),this.calculateWithoutClearingCache(e),this}calculateAutoHeightInRange(e){var n;if(!Ie.isArray(e))return[];const r=[],{mergeData:i,rowData:o}=this._config,a=o;for(const s of e){const{startRow:u,endRow:l,startColumn:c,endColumn:d}=s;for(let m=u;m<=l;m++)if(!(r.some(({row:f})=>f===m)||((n=a[m])==null?void 0:n.ia)===we.FALSE)&&age(m,c,d,i)){const f=this._calculateRowAutoHeight(m);r.push({row:m,autoHeight:f})}}return r}_calculateRowAutoHeight(e){var n,r;const{columnCount:i,columnData:o,mergeData:a,defaultRowHeight:s}=this._config,u=o;let l=s;const c=this._worksheet;if(!c)return l;for(let d=0;d<i;d++){const{isMerged:m,isMergedMainCell:f}=Xc(e,d,a);if(m||f)continue;const h=c.getCell(e,d),p=h&&this._getCellDocumentModel(h);if(p==null)continue;const{documentModel:v,textRotation:g,wrapStrategy:b}=p;if(v==null)continue;const C=new u_(v);let{a:S}=g;const{v:E=we.FALSE}=g;E===we.TRUE&&(S=n0);const y=(n=u[d])==null?void 0:n.w;typeof y=="number"&&b===Ar.WRAP&&v.updateDocumentDataPageSize(y);const D=Om.create(C,this._localService);D.calculate();let{height:R=0}=(r=B4(D,S))!=null?r:{};if(D){const I=D.getSkeletonData(),{marginTop:T,marginBottom:P,marginLeft:N,marginRight:B}=I.pages[I.pages.length-1],W=Math.abs(q1(S));R+=T*Math.cos(W)+B*Math.sin(W)+P*Math.cos(W)+N*Math.sin(W)}l=Math.max(l,R)}return Math.min(l,lle)}updateLayout(){if(!this.dirty)return;const{rowData:e,columnData:n,defaultRowHeight:r,defaultColumnWidth:i,rowCount:o,columnCount:a,rowHeader:s,columnHeader:u,showGridlines:l}=this._config,{rowTotalHeight:c,rowHeightAccumulation:d}=this._generateRowMatrixCache(o,e,r),{columnTotalWidth:m,columnWidthAccumulation:f}=this._generateColumnMatrixCache(a,n,i);return this._rowHeaderWidth=s.hidden!==we.TRUE?s.width:0,this._columnHeaderHeight=u.hidden!==we.TRUE?u.height:0,this._rowTotalHeight=c,this._rowHeightAccumulation=d,this._columnTotalWidth=m,this._columnWidthAccumulation=f,this._showGridlines=l,this.makeDirty(!1),this}getRowColumnSegment(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e==null?void 0:e.viewBound)}getRowColumnSegmentByViewBound(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e)}getMergeBounding(e,n,r,i){const o=this._config.mergeData;if(!o)return{startRow:e,startColumn:n,endRow:r,endColumn:i};let a=!0;const s=new Ye;for(;a;){a=!1;for(let u=0;u<o.length;u++){const{startRow:l,startColumn:c,endRow:d,endColumn:m}=o[u];s.getValue(l,c)||xx({left:n,top:e,right:i,bottom:r},{left:c,top:l,right:m,bottom:d})&&(e=Math.min(e,l),n=Math.min(n,c),r=Math.max(r,d),i=Math.max(i,m),s.setValue(l,c,!0),a=!0)}}return{startRow:e,startColumn:n,endRow:r,endColumn:i}}appendToOverflowCache(e,n,r,i){this._overflowCache.setValue(e,n,{startRow:e,endRow:e,startColumn:r,endColumn:i})}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}getOverflowPosition(e,n,r,i,o){const{width:a}=e;let s=i,u=i;return n===Zn.CENTER?(s=this._getOverflowBound(r,i,0,a/2,n),u=this._getOverflowBound(r,i,o-1,a/2,n)):n===Zn.RIGHT?s=this._getOverflowBound(r,i,0,a):u=this._getOverflowBound(r,i,o-1,a),{startColumn:s,endColumn:u}}getNoMergeCellPositionByIndex(e,n){const{rowHeightAccumulation:r,columnWidthAccumulation:i,rowHeaderWidthAndMarginLeft:o,columnHeaderHeightAndMarginTop:a}=this;let{startY:s,endY:u,startX:l,endX:c}=t0(e,n,r,i);return s+=a,u+=a,l+=o,c+=o,{startY:s,endY:u,startX:l,endX:c}}getNoMergeCellPositionByIndexWithNoHeader(e,n){const{rowHeightAccumulation:r,columnWidthAccumulation:i}=this,{startY:o,endY:a,startX:s,endX:u}=t0(e,n,r,i);return{startY:o,endY:a,startX:s,endX:u}}calculateCellIndexByPosition(e,n,r,i,o){const{row:a,column:s}=this.getCellPositionByOffset(e,n,r,i,o);return this.getCellByIndex(a,s)}getCellPositionByOffset(e,n,r,i,o){const a=this.getRowPositionByOffsetY(n,i,o),s=this.getColumnPositionByOffsetX(e,r,o);return{row:a,column:s}}getColumnPositionByOffsetX(e,n,r){e=this.getTransformOffsetX(e,n,r);const{columnWidthAccumulation:i}=this;let o=hu(i,e);return o===Number.POSITIVE_INFINITY?o=i.length-1:o===-1&&(o=0),o}getRowPositionByOffsetY(e,n,r){const{rowHeightAccumulation:i}=this;e=this.getTransformOffsetY(e,n,r);let o=hu(i,e);return o===Number.POSITIVE_INFINITY?o=i.length-1:o===-1&&(o=0),o}getTransformOffsetX(e,n,r){const{x:i}=r;return e=e/n+i-this.rowHeaderWidthAndMarginLeft,e}getTransformOffsetY(e,n,r){const{y:i}=r;return e=e/n+i-this.columnHeaderHeightAndMarginTop,e}getOffsetByPositionX(e){const{columnWidthAccumulation:n,rowHeaderWidthAndMarginLeft:r}=this,i=n.length-1,o=n[e];return o!=null?o+r:e<0?r:n[i]+r}getOffsetByPositionY(e){const{rowHeightAccumulation:n,columnHeaderHeightAndMarginTop:r}=this,i=n.length-1,o=n[e];return o!=null?o+r:e<0?r:n[i]+r}getCellByIndex(e,n){const{rowHeightAccumulation:r,columnWidthAccumulation:i,rowHeaderWidthAndMarginLeft:o,columnHeaderHeightAndMarginTop:a}=this,s=v6(e,n,r,i,this._config.mergeData),{isMerged:u,isMergedMainCell:l}=s;let{startY:c,endY:d,startX:m,endX:f,mergeInfo:h}=s;return c+=a,d+=a,m+=o,f+=o,h=qI(h,o,a),{actualRow:e,actualColumn:n,startY:c,endY:d,startX:m,endX:f,isMerged:u,isMergedMainCell:l,mergeInfo:h}}getCellByIndexWithNoHeader(e,n){const{rowHeightAccumulation:r,columnWidthAccumulation:i}=this,o=v6(e,n,r,i,this._config.mergeData),{isMerged:a,isMergedMainCell:s}=o,{startY:u,endY:l,startX:c,endX:d,mergeInfo:m}=o,f=qI(m,0,0);return{actualRow:e,actualColumn:n,startY:u,endY:l,startX:c,endX:d,isMerged:a,isMergedMainCell:s,mergeInfo:f}}convertTransformToOffsetX(e,n,r){const{x:i}=r;return e=(e-i)*n,e}convertTransformToOffsetY(e,n,r){const{y:i}=r;return e=(e-i)*n,e}getSelectionBounding(e,n,r,i){return this.getMergeBounding(e,n,r,i)}getBlankCellDocumentModel(e){const n=this._getCellDocumentModel(e,void 0,void 0,!0);if(n!=null)return n.documentModel==null&&(n.documentModel=this._getDocumentDataByStyle("",{},{})),n;const r="";let i="document";const o={a:0,v:we.FALSE},a=Zn.UNSPECIFIED,s=li.UNSPECIFIED,u=Ar.UNSPECIFIED,l=pA;return i=h9({},this._localService).fontCache,{documentModel:this._getDocumentDataByStyle(r,{},{}),fontString:i,textRotation:o,wrapStrategy:u,verticalAlign:s,horizontalAlign:a,paddingData:l}}getCellDocumentModelWithFormula(e){return this._getCellDocumentModel(e,!0,!0,!0)}_getCellDocumentModel(e,n=!1,r=!1,i=!1){var o;const a=this._styles.getStyleByCell(e);if(!e)return;let s,u="document";const l=this._getOtherStyle(a),c=i?{a:0,v:we.FALSE}:l.textRotation||{a:0,v:we.FALSE},d=l.horizontalAlign||Zn.UNSPECIFIED,m=l.verticalAlign||li.UNSPECIFIED,f=l.wrapStrategy||Ar.UNSPECIFIED,h=l.paddingData||pA;if(e.f&&r)s=this._getDocumentDataByStyle(e.f.toString(),{},{});else if(e.p){const{centerAngle:p,vertexAngle:v}=Vx(c);s=this._updateConfigAndGetDocumentModel(n?Ie.deepClone(e.p):e.p,d,{horizontalAlign:d,verticalAlign:m,centerAngle:p,vertexAngle:v,wrapStrategy:f})}else if(e.v!=null){const p=this._getFontFormat(a);u=h9(p,this._localService).fontCache,s=this._getDocumentDataByStyle(e.v.toString(),p,{...l,textRotation:c})}return{documentModel:s,fontString:u,textRotation:c,wrapStrategy:f,verticalAlign:m,horizontalAlign:d,paddingData:h,fill:(o=a==null?void 0:a.bg)==null?void 0:o.rgb}}getDecomposedOffset(e,n){let r=hu(this._columnWidthAccumulation,e),i=0;r===-1||r===0?(r=0,i=e):i=e-this._columnWidthAccumulation[r-1];let o=hu(this._rowHeightAccumulation,n),a=0;return o===-1||o===0?(o=0,a=n):a=n-this._rowHeightAccumulation[o-1],{row:o,column:r,columnOffset:i,rowOffset:a}}_calculateOverflowCell(e,n,r){const{documentSkeleton:i,angle:o=0,horizontalAlign:a,wrapStrategy:s}=r,u=this.getCellData().getValue(e,n),{t:l=$n.STRING}=u||{};if((s===Ar.OVERFLOW||s===Ar.UNSPECIFIED)&&l!==$n.NUMBER&&l!==$n.BOOLEAN&&a!==Zn.JUSTIFIED){if(this.intersectMergeRange(e,n))return!0;let c=B4(i,o);if(!c)return!0;if(o!==0){const{startY:h,endY:p,startX:v,endX:g}=v6(e,n,this.rowHeightAccumulation,this.columnWidthAccumulation,this.mergeData),b=g-v,C=p-h;c.height>C&&(c={width:C/Math.tan(Math.abs(o))+b,height:C})}const d=this.getOverflowPosition(c,a,e,n,this.getColumnCount()),{startColumn:m,endColumn:f}=d;if(m===f)return!0;this.appendToOverflowCache(e,n,m,f)}else if(s===Ar.WRAP&&o!==0){if(this.intersectMergeRange(e,n))return!0;const{startY:c,endY:d}=v6(e,n,this.rowHeightAccumulation,this.columnWidthAccumulation,this.mergeData),m=d-c;i.getViewModel().getDataModel().updateDocumentDataPageSize(m),i.calculate();const f=B4(i,o);if(!f)return!0;const{startColumn:h,endColumn:p}=this.getOverflowPosition(f,a,e,n,this.getColumnCount());if(h===p)return!0;this.appendToOverflowCache(e,n,h,p)}}_getBounding(e,n,r){const i=e.length,o=n.length;if(!r)return{startRow:0,endRow:i-1,startColumn:0,endColumn:o-1};let a=-1,s=-1,u=-1,l=-1;const c=hu(e,Math.round(r.top)-this.columnHeaderHeightAndMarginTop),d=hu(e,Math.round(r.bottom)-this.columnHeaderHeightAndMarginTop);c===-1&&d===0?(a=-1,s=-1):(c===-1?a=0:a=c,d===Number.POSITIVE_INFINITY||d>=i?s=i-1:s=d);const m=hu(n,Math.round(r.left)-this.rowHeaderWidthAndMarginLeft),f=hu(n,Math.round(r.right)-this.rowHeaderWidthAndMarginLeft);return m===-1&&f===0?(u=-1,l=-1):(m===-1?u=0:u=m,f===Number.POSITIVE_INFINITY||f>=o?l=o-1:l=f),{startRow:a,endRow:s,startColumn:u,endColumn:l}}_generateRowMatrixCache(e,n,r){let i=0;const o=[],a=n;for(let s=0;s<e;s++){let u=r;if(a[s]!=null){const l=a[s];if(!l)continue;const{h:c=r,ah:d,ia:m}=l;(m==null||m===we.TRUE)&&typeof d=="number"?u=d:u=c,l.hd===we.TRUE&&(u=0)}i+=u,o.push(i)}return{rowTotalHeight:i,rowHeightAccumulation:o}}_generateColumnMatrixCache(e,n,r){let i=0;const o=[],a=n;for(let s=0;s<e;s++){let u=r;if(a[s]!=null){const l=a[s];if(!l)continue;l.w!=null&&(u=l.w),l.hd===we.TRUE&&(u=0)}i+=u,o.push(i)}return{columnTotalWidth:i,columnWidthAccumulation:o}}_getOverflowBound(e,n,r,i,o=Zn.LEFT){var a,s;let u=0;if(n>r){const l=this._columnWidthAccumulation.length-1;for(let c=n;c>=r;c--){const d=c,m=(a=this._worksheet)==null?void 0:a.getCell(e,d);if(!sD(m)&&d!==n||this.intersectMergeRange(e,d))return d===n?d:d+1>l?l:d+1;const{startX:f,endX:h}=t0(e,d,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===Zn.CENTER&&d===n?u+=(h-f)/2:u+=h-f,i<u)return d}return n}for(let l=n;l<=r;l++){const c=l,d=(s=this._worksheet)==null?void 0:s.getCell(e,c);if(!sD(d)&&c!==n||this.intersectMergeRange(e,c))return c===n?c:c-1<0?0:c-1;const{startX:m,endX:f}=t0(e,c,this.rowHeightAccumulation,this.columnWidthAccumulation);if(o===Zn.CENTER&&c===n?u+=(f-m)/2:u+=f-m,i<u)return c}return r}intersectMergeRange(e,n){const r=this.dataMergeCache;for(const i of r){const{startRow:o,endRow:a,startColumn:s,endColumn:u}=i;if(e>=o&&e<=a&&n>=s&&n<=u)return!0}return!1}_calculateStylesCache(){const e=this._dataMergeCache,n=this._rowColumnSegment,r=this.columnWidthAccumulation,{startRow:i,endRow:o,startColumn:a,endColumn:s}=n;if(!(s===-1||o===-1)){for(const u of e)this._setCellCache(u.startRow,u.startColumn,!1);for(let u=i;u<=o;u++){for(let l=a;l<=s;l++)this._setCellCache(u,l,!1);for(let l=0;l<a;l++)this._setCellCache(u,l,!0);if(s!==0)for(let l=s+1;l<r.length;l++)this._setCellCache(u,l,!0)}}}_resetCache(){this._stylesCache={background:{},backgroundPositions:new Ye,font:{},border:new Ye},this._renderedCellCache=new Ye,this._overflowCache.reset()}_makeDocumentSkeletonDirty(e,n){if(this._stylesCache.font==null)return;const r=Object.keys(this._stylesCache.font);for(const i of r){const o=this._stylesCache.font[i];if(o!=null&&o.getValue(e,n)){o.getValue(e,n).documentSkeleton.makeDirty(!0);return}}}_setCellCache(e,n,r){var i;const o=this._renderedCellCache.getValue(e,n);if(e===-1||n===-1)return!0;if(o===!1)return this._makeDocumentSkeletonDirty(e,n),!0;if(!this._worksheet||this._worksheet.getColVisible(n)===!1||this._worksheet.getRowVisible(e)===!1)return!0;const a=this._worksheet.getCell(e,n);if(!a)return!0;const s=this._stylesCache,u=this._styles.getStyleByCell(a);if(!r&&u&&u.bg&&u.bg.rgb){const S=u.bg.rgb;s.background[S]||(s.background[S]=new Ye),s.background[S].setValue(e,n,S);const E=this.getCellByIndexWithNoHeader(e,n);(i=s.backgroundPositions)==null||i.setValue(e,n,E)}if(!r&&u&&u.bd&&(this._setBorderProps(e,n,rr.TOP,u,s),this._setBorderProps(e,n,rr.BOTTOM,u,s),this._setBorderProps(e,n,rr.LEFT,u,s),this._setBorderProps(e,n,rr.RIGHT,u,s),this._setBorderProps(e,n,rr.TL_BR,u,s),this._setBorderProps(e,n,rr.TL_BC,u,s),this._setBorderProps(e,n,rr.TL_MR,u,s),this._setBorderProps(e,n,rr.BL_TR,u,s),this._setBorderProps(e,n,rr.ML_TR,u,s),this._setBorderProps(e,n,rr.BC_TR,u,s)),o===!0)return this._makeDocumentSkeletonDirty(e,n),!0;if(T6(a))return;const l=a&&this._getCellDocumentModel(a);if(l==null)return;const{documentModel:c,fontString:d,textRotation:m,wrapStrategy:f,verticalAlign:h,horizontalAlign:p}=l;if(c==null)return;const v=new u_(c);s.font[d]||(s.font[d]=new Ye);const g=s.font[d];let{a:b}=m;const{v:C=we.FALSE}=m;if(C===we.TRUE&&(b=n0),v){const S=Om.create(v,this._localService);S.calculate();const E={documentSkeleton:S,angle:b,verticalAlign:h,horizontalAlign:p,wrapStrategy:f};g.setValue(e,n,E),this._calculateOverflowCell(e,n,E)}r?this._renderedCellCache.setValue(e,n,!0):this._renderedCellCache.setValue(e,n,!1)}_updateConfigAndGetDocumentModel(e,n,r){var i;if(!r||!((i=e.body)!=null&&i.dataStream))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.renderConfig=r;const o=e.body.paragraphs||[];for(const a of o)a.paragraphStyle||(a.paragraphStyle={}),a.paragraphStyle.horizontalAlign=n;return new nm(e)}_getDocumentDataByStyle(e,n,r){const i=e.length,{textRotation:o={a:0,v:we.FALSE},paddingData:a={t:2,r:2,b:0,l:2},horizontalAlign:s=Zn.UNSPECIFIED,verticalAlign:u=li.UNSPECIFIED,wrapStrategy:l=Ar.UNSPECIFIED}=r,{a:c=0,v:d=we.FALSE}=o,{t:m,r:f,b:h,l:p}=a||{};let v=0,g=c;d===we.TRUE&&(v=n0,g=n0);const b={id:"d",body:{dataStream:`${e}${Sc}`,textRuns:[{ts:n,st:0,ed:i}],paragraphs:[{startIndex:i,paragraphStyle:{horizontalAlign:s}}]},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginTop:m,marginBottom:h,marginRight:f,marginLeft:p,renderConfig:{horizontalAlign:s,verticalAlign:u,centerAngle:v,vertexAngle:g,wrapStrategy:l}}};return new nm(b)}_setBorderProps(e,n,r,i,o){var a;const s=(a=i.bd)==null?void 0:a[r];if(!s||!o.border)return!0;const u=mo(s.cl)||P0,l=o.border;l.getValue(e,n)||l.setValue(e,n,{[r]:{}}),l.getValue(e,n)[r]={type:r,style:s.s,color:u}}_getFontFormat(e){if(!e)return{};const{ff:n,fs:r,it:i,bl:o,ul:a,st:s,ol:u,cl:l}=e,c={};return n&&(c.ff=n),r&&(c.fs=r),i&&(c.it=i),o&&(c.bl=o),a&&(c.ul=a),s&&(c.st=s),u&&(c.ol=u),l&&(c.cl=l),c}_getOtherStyle(e){if(!e)return{};const{tr:n,td:r,ht:i,vt:o,tb:a,pd:s}=e;return{textRotation:n,textDirection:r,horizontalAlign:i,verticalAlign:o,wrapStrategy:a,paddingData:s}}_getMergeCells(e,n){const r=this.columnWidthAccumulation.length-1;n?n={startRow:n.startRow,endRow:n.endRow,endColumn:r,startColumn:0}:n={startRow:0,startColumn:0,endRow:this.rowHeightAccumulation.length-1,endColumn:r};const{startRow:i,startColumn:o,endRow:a,endColumn:s}=n,u=[];for(let l=0;l<e.length;l++){const{startRow:c,endRow:d,startColumn:m,endColumn:f}=e[l];for(let h=i;h<=a;h++){let p=!1;for(let v=o;v<=s;v++)if(h>=c&&h<=d&&v>=m&&v<=f){u.push({startRow:c,endRow:d,startColumn:m,endColumn:f}),p=!0;break}if(p)break}}return u}};const t_e="DefaultFontExtension",n_e=30;class r_e extends pf{constructor(){super(...arguments),w(this,"uKey",t_e),w(this,"Z_INDEX",n_e),w(this,"changeFontColor",new Ye)}get spreadsheet(){return this.parent}getDocuments(){const e=this.parent;return e==null?void 0:e.getDocuments()}setChangeFontColor(e,n,r){this.changeFontColor.setValue(e,n,r)}draw(e,n,r,i){const{stylesCache:o,dataMergeCache:a,overflowCache:s}=r,{font:u}=o;if(!r)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:d,rowTotalHeight:m}=r;if(!l||!d||c===void 0||m===void 0)return;e.save();const f=this._getScale(n);u&&Object.keys(u).forEach(h=>{u[h].forValue((p,v,g)=>{const b=this.getCellIndex(p,v,l,d,a);let{startY:C,endY:S,startX:E,endX:y}=b;const{isMerged:D,isMergedMainCell:R,mergeInfo:I}=b;if(D||(R&&(C=I.startY,S=I.endY,E=I.startX,y=I.endX),!this.isRenderDiffRangesByRow(I.startRow,I.endRow,i)))return!0;const T=y-E,P=S-C,N=s.getValue(p,v),{horizontalAlign:B}=g;if(e.save(),e.beginPath(),N){const{startColumn:W,startRow:G,endColumn:Q,endRow:te}=N;W===Q&&W===v?(e.rect(E+1/f,C+1/f,T-2/f,P-2/f),e.clip(),e.clearRectForTexture(E+1/f,C+1/f,T-2/f,P-2/f)):B===Zn.CENTER?this._clipRectangle(e,G,te,W,Q,f,l,d):B===Zn.RIGHT?this._clipRectangle(e,G,p,W,v,f,l,d):this._clipRectangle(e,p,te,v,Q,f,l,d)}else e.rect(E+1/f,C+1/f,T-2/f,P-2/f),e.clip(),e.clearRectForTexture(E+1/f,C+1/f,T-2/f,P-2/f);e.translate(E,C),this._renderDocuments(e,g,E,C,y,S,p,v),e.restore()})}),e.restore()}_renderDocuments(e,n,r,i,o,a,s,u){const l=this.getDocuments();if(l==null)throw new Error("documents is null");const{documentSkeleton:c,angle:d,wrapStrategy:m}=n,f=o-r,h=a-i;if(m===Ar.WRAP&&d===0?(c.getViewModel().getDataModel().updateDocumentDataPageSize(f),c.calculate()):c.getViewModel().getDataModel().updateDocumentDataPageSize(Number.POSITIVE_INFINITY),m!==Ar.WRAP){const p=B4(c),v=c.getViewModel().getDataModel().getSnapshot().documentStyle;if(p&&v){const{width:g}=p,{marginRight:b=0,marginLeft:C=0}=v;c.getViewModel().getDataModel().updateDocumentDataPageSize(g+C+b),c.calculate()}}c.makeDirty(!1),l.resize(f,h),l.changeSkeleton(c).render(e)}_clipRectangle(e,n,r,i,o,a,s,u){const l=s[n-1]||0,c=s[r]||s[s.length-1],d=u[i-1]||0,m=u[o]||u[u.length-1];e.rect(d,l,m-d,c-l),e.clip(),e.clearRectForTexture(d,l,m-d,c-l)}}J5.add(r_e);const i_e="DefaultRowHeaderLayoutExtension";class o_e extends pf{constructor(){super(...arguments),w(this,"uKey",i_e),w(this,"Z_INDEX",10)}draw(e,n,r){const{rowColumnSegment:i,rowHeaderWidth:o=0,columnHeaderHeight:a=0}=r,{startRow:s,endRow:u,startColumn:l,endColumn:c}=i;if(!r)return;const{rowHeightAccumulation:d,columnTotalWidth:m,columnWidthAccumulation:f,rowTotalHeight:h}=r;if(!d||!f||m===void 0||h===void 0)return;const p=this._getScale(n);e.fillStyle=la([248,249,250]),e.fillRect(0,0,o,h),e.textAlign="center",e.textBaseline="middle",e.fillStyle=la([0,0,0]),e.beginPath(),e.lineWidth=1,e.translateWithPrecisionRatio(gi,gi),e.strokeStyle=la([217,217,217]),e.font=`13px ${mE}`;let v=0;const g=d.length;for(let C=s-1;C<=u;C++){if(C<0||C>g-1)continue;const S=d[C];if(v===S)continue;e.moveTo(0,S),e.lineTo(o,S);const E=v+(S-v)/2;e.fillText(`${C+1}`,o/2,E+Dx),v=S}const b=o-.5/p;e.moveTo(b,0),e.lineTo(b,h),e.stroke()}}fF.add(new o_e);let a_e=class extends vF{constructor(e,n){super(e,n),w(this,"_rowHeaderLayoutExtension"),this._initialDefaultExtension(),this.makeDirty(!0)}get rowHeaderLayoutExtension(){return this._rowHeaderLayoutExtension}draw(e,n){const r=this.getSkeleton();if(!r)return;const i=this.getParentScale();r.calculateSegment(n);const o=r.rowColumnSegment;if(o.startRow===-1&&o.endRow===-1)return;const{columnHeaderHeight:a}=r;e.translateWithPrecision(0,a);const s=this.getExtensionsByOrder();for(const u of s)u.draw(e,i,r)}isHit(e){const n=this._getInverseCoord(e),r=this.getSkeleton();if(!r)return!1;const{rowHeaderWidth:i,columnHeaderHeight:o}=r;return n.x>=0&&n.x<=i&&n.y>o}_initialDefaultExtension(){fF.getData().forEach(e=>{this.register(e)}),this._rowHeaderLayoutExtension=this.getExtensionByKey("DefaultRowHeaderLayoutExtension")}};const s_e="__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__";let u_e=class extends gF{constructor(e,n,r=!0){super(e,n),w(this,"_backgroundExtension"),w(this,"_borderExtension"),w(this,"_fontExtension"),w(this,"_cacheCanvas"),w(this,"_refreshIncrementalState",!1),w(this,"_forceDirty",!1),w(this,"_overflowCacheRuntime",{}),w(this,"_overflowCacheRuntimeRange",new Ye),w(this,"_overflowCacheRuntimeTimeout",-1),w(this,"_forceDisableGridlines",!1),w(this,"_documents",new t8(s_e,void 0,{pageMarginLeft:0,pageMarginTop:0})),w(this,"isPrinting",!1),this._allowCache=r,this._allowCache&&(this._cacheCanvas=new gE,this.onIsAddedToParentObserver.add(i=>{var o;(o=i==null?void 0:i.getEngine())==null||o.onTransformChangeObservable.add(()=>{this._resizeCacheCanvas()}),this._resizeCacheCanvas(),this._addMakeDirtyToScroll()})),this._initialDefaultExtension(),this.makeDirty(!0)}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}get allowCache(){return this._allowCache}get forceDisableGridlines(){return this._forceDisableGridlines}draw(e,n){const r=this.getSkeleton();if(!r)return;const i=this.getParentScale(),o=this._refreshIncrementalState?n==null?void 0:n.diffBounds.map(s=>r.getRowColumnSegmentByViewBound(s)):void 0,a=this.getExtensionsByOrder();for(const s of a)s.draw(e,i,r,o)}isHit(e){const n=this._getInverseCoord(e),r=this.getSkeleton();if(!r)return!1;const{rowHeaderWidth:i,columnHeaderHeight:o}=r;return n.x>i&&n.y>o}getNoMergeCellPositionByIndex(e,n){const r=this.getSkeleton();if(!r)return;const{rowHeightAccumulation:i,columnWidthAccumulation:o,rowHeaderWidth:a,columnHeaderHeight:s}=r;let{startY:u,endY:l,startX:c,endX:d}=t0(e,n,i,o);return u+=s,l+=s,c+=a,d+=a,{startY:u,endY:l,startX:c,endX:d}}getScrollXYByRelativeCoords(e){const n=this.getParent();let r=0,i=0;const o=n.getActiveViewportByRelativeCoord(e);if(o){const a=o.actualScrollX||0,s=o.actualScrollY||0;r+=a,i+=s}return{x:r,y:i}}makeForceDirty(e=!0){this.makeDirty(e),this._forceDirty=e}setForceDisableGridlines(e){this._forceDisableGridlines=e}getSelectionBounding(e,n,r,i){var o;return(o=this.getSkeleton())==null?void 0:o.getMergeBounding(e,n,r,i)}render(e,n){if(!this.visible)return this.makeDirty(!1),this;const r=this.getSkeleton();if(!r)return;r.calculateWithoutClearingCache(n);const i=r.rowColumnSegment;if(i.startRow===-1&&i.endRow===-1||i.startColumn===-1&&i.endColumn===-1)return;e.save();const{a:o=1,d:a=1}=e.getTransform(),{rowHeaderWidth:s,columnHeaderHeight:u}=r;if(e.translateWithPrecision(s,u),this._drawAuxiliary(e,n),n&&this._allowCache===!0){const{viewBound:l,diffBounds:c,diffX:d,diffY:m,viewPortPosition:f,viewPortKey:h}=n;if(h==="viewMain"){const p=this._cacheCanvas.getContext();p.save();const{left:v,top:g,right:b,bottom:C}=f,S=b-v+s,E=C-g+u;if(c.length===0||d===0&&m===0||this._forceDirty)(this.isDirty()||this._forceDirty)&&(this._cacheCanvas.clear(),p.setTransform(e.getTransform()),this._draw(p,n),this._forceDirty=!1),this._applyCache(e,v,g,S,E,v,g,S,E);else{if(this.isDirty()){p.save(),p.globalCompositeOperation="copy",p.setTransform(1,0,0,1,0,0),p.drawImage(this._cacheCanvas.getCanvasEle(),d*o,m*a),p.restore(),this._refreshIncrementalState=!0,p.setTransform(e.getTransform());for(const y of c){const{left:D,right:R,bottom:I,top:T}=y;p.save(),p.beginPath(),p.rect(D-s-gi,T-u-gi,R-D+s+gi*2,I-T+u+gi*2),p.clip(),this._draw(p,{viewBound:n.viewBound,diffBounds:[y],diffX:n.diffX,diffY:n.diffY,viewPortPosition:n.viewPortPosition,viewPortKey:n.viewPortKey}),p.restore()}this._refreshIncrementalState=!1}this._applyCache(e,v,g,S,E,v,g,S,E)}p.restore()}else this._draw(e,n)}else this._draw(e,n);return e.restore(),this.makeDirty(!1),this}_resizeCacheCanvas(){const e=this._getAncestorSize();if(!e||this._cacheCanvas==null)return;const{width:n,height:r}=e;this._cacheCanvas.setSize(n,r),this.makeDirty(!0)}_applyCache(e,n=0,r=0,i=0,o=0,a=0,s=0,u=0,l=0){if(!e)return;const c=this._cacheCanvas.getPixelRatio(),d=this._cacheCanvas.getContext();d.save(),e.save(),e.setTransform(1,0,0,1,0,0),d.setTransform(1,0,0,1,0,0),e.drawImage(this._cacheCanvas.getCanvasEle(),n*c,r*c,i*c,o*c,a*c,s*c,u*c,l*c),e.restore(),d.restore()}_draw(e,n){this.draw(e,n)}_getAncestorSize(){const e=this._getAncestorParent();if(e){if(e.classType===qt.ENGINE){const n=e.getCanvas();return{width:n.getWidth(),height:n.getHeight()}}if(e.classType===qt.SCENE_VIEWER)return{width:e.width,height:e.height}}}_getAncestorParent(){let e=this.parent;for(;e;){if(e.classType===qt.ENGINE||e.classType===qt.SCENE_VIEWER)return e;e=(e==null?void 0:e.getParent)&&(e==null?void 0:e.getParent())}}_initialDefaultExtension(){J5.getData().sort(gs).forEach(e=>{this.register(new e)}),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,e=>{e.onScrollBeforeObserver.add(()=>{this.makeDirty(!0)})})}_hasScrollViewportOperator(e,n){let r=e.getParent();for(;r;){if(r.classType===qt.SCENE){const i=r.getViewports(),o=this._getHasScrollViewports(i);for(const a of o)a&&n(a)}r=(r==null?void 0:r.getParent)&&(r==null?void 0:r.getParent())}}_getHasScrollViewports(e){const n=[];for(const r of e)r.getScrollBar()&&n.push(r);return n}_drawAuxiliary(e,n){const r=this.getSkeleton();if(r==null)return;const{rowColumnSegment:i,dataMergeCache:o,overflowCache:a,stylesCache:s,showGridlines:u}=r,{border:l,backgroundPositions:c}=s,{startRow:d,endRow:m,startColumn:f,endColumn:h}=i;if(!r||u===we.FALSE||this._forceDisableGridlines)return;const{rowHeightAccumulation:p,columnTotalWidth:v,columnWidthAccumulation:g,rowTotalHeight:b}=r;if(!p||!g||v===void 0||b===void 0)return;e.save(),e.beginPath(),e.lineWidth=1,e.strokeStyle=la([212,212,212]);const C=g.length,S=p.length,E=this._allowCache?d:0,y=this._allowCache?m:S-1,D=this._allowCache?h:C-1,R=this._allowCache?f:0,I=g[R-1]||0,T=p[E-1]||0,P=g[D],N=p[y];e.translateWithPrecisionRatio(gi,gi),e.moveTo(I,T),e.lineTo(P,T);for(let B=0;B<=y;B++){if(B<0||B>S-1)continue;const W=p[B];e.moveTo(I,W),e.lineTo(P,W)}e.moveTo(I,T),e.lineTo(I,N);for(let B=0;B<=h;B++){if(B<0||B>C-1)continue;const W=g[B];e.moveTo(W,T),e.lineTo(W,N)}e.stroke(),e.closePath(),l==null||l.forValue((B,W,G)=>{if(!G)return!0;const Q=r.getCellByIndexWithNoHeader(B,W);let{startY:te,endY:X,startX:x,endX:O}=Q;const{isMerged:M,isMergedMainCell:V,mergeInfo:q}=Q;if(M||(V&&(te=q.startY,X=q.endY,x=q.startX,O=q.endX),!(q.startRow>=E&&q.endRow<=y)))return!0;for(const ie in G){const{type:ce}=G[ie];pge(e,ce,{startX:x,startY:te,endX:O,endY:X})}}),e.closePath(),this._clearRectangle(e,p,g,o),this._clearRectangle(e,p,g,a.toNativeArray()),this._clearBackground(e,c),e.restore()}_clearRectangle(e,n,r,i){if(i!=null)for(const o of i){const{startRow:a,endRow:s,startColumn:u,endColumn:l}=o,c=n[a-1]||0,d=n[s]||n[n.length-1],m=r[u-1]||0,f=r[l]||r[r.length-1];e.clearRect(m,c,f-m,d-c),e.beginPath(),e.moveTo(m,c),e.lineTo(f,c),e.lineTo(f,d),e.lineTo(m,d),e.lineTo(m,c),e.stroke(),e.closePath()}}_clearBackground(e,n){n==null||n.forValue((r,i,o)=>{let{startY:a,endY:s,startX:u,endX:l}=o;const{isMerged:c,isMergedMainCell:d,mergeInfo:m}=o;if(c)return!0;d&&(a=m.startY,s=m.endY,u=m.startX,l=m.endX),e.clearRectForTexture(u,a,l-u+.5,s-a+.5)})}},l_e=class extends M0{constructor(e,n){super(e),w(this,"_subScenes",new Map),w(this,"_activeSubScene"),w(this,"_allowSelectedClipElement",!1),this._initialProps(n)}get classType(){return qt.SCENE_VIEWER}render(e,n){var r;if(!this.visible)return this.makeDirty(!1),this;if(n){const{left:o,top:a,right:s,bottom:u}=n.viewBound;if(this.width+this.strokeWidth<o||s<0||this.height+this.strokeWidth<a||u<0)return this}const i=this.transform.getMatrix();return e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),(r=this._activeSubScene)==null||r.makeDirtyNoParent(!0).render(e),e.restore(),this.makeDirty(!1),this}getSubScenes(){return this._subScenes}getActiveSubScene(){return this._activeSubScene}getSubScene(e){for(const[n,r]of this._subScenes)if(n===e)return r}addSubScene(e){this._activeSubScene=e,this._subScenes.set(e.sceneKey,e),this.makeDirty()}removeSubScene(e){const n=this._subScenes.get(e);this._subScenes.delete(e),this._activeSubScene===n&&(this._activeSubScene=this._subScenes.values().next().value),this.makeDirty()}activeSubScene(e){if(e==null)return;const n=this._subScenes.get(e);this._activeSubScene!==n&&(this._activeSubScene=n,this.makeDirty())}enableSelectedClipElement(){this._allowSelectedClipElement=!0}disableSelectedClipElement(){this._allowSelectedClipElement=!1}allowSelectedClipElement(){return this._allowSelectedClipElement}pick(e){var n;if(this._activeSubScene===void 0)return;const r=this.transform.clone().invert().applyPoint(e);return(n=this._activeSubScene)==null?void 0:n.pick(r)}dispose(){super.dispose(),this._subScenes.forEach(e=>{e.dispose()})}_initialProps(e){if(!e)return;const n=Object.keys(e);if(n.length===0)return;const r={};let i=!1;n.forEach(o=>{if(e[o]===void 0)return!0;r[o]=e[o],i=!0}),i&&this.transformByState(r),this.makeDirty(!0)}};class c_e extends We{constructor(){super(...arguments),w(this,"onInputChangedObservable",new Vn),w(this,"onTransformChangeObservable",new Vn),w(this,"_scenes",{}),w(this,"_activeScene",null)}get classType(){return qt.ENGINE}get activeScene(){return this._activeScene}get width(){return 0}get height(){return 0}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const n=e.sceneKey;return this.hasScene(n)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[n]=e,e}setActiveScene(e){const n=this.getScene(e);return n&&(this._activeScene=n),n}setRemainCapture(){}hasActiveScene(){return this._activeScene!=null}dispose(){super.dispose();const e=this.getScenes();Object.keys(e).forEach(n=>{e[n].dispose()})}remainScene(e){const n=this.getScenes();if(n[e]){const r=n[e];return delete n[e],r}}}let l_=class extends c_e{constructor(e=1,n=1,r,i){super(),w(this,"renderEvenInBackground",!0),w(this,"onBeginFrameObservable",new Vn),w(this,"onEndFrameObservable",new Vn),w(this,"_container"),w(this,"_canvas"),w(this,"_canvasEle"),w(this,"_renderingQueueLaunched",!1),w(this,"_activeRenderLoops",new Array),w(this,"_renderFunction",()=>{}),w(this,"_requestNewFrameHandler",-1),w(this,"_frameId",-1),w(this,"_usingSafari",Gpe()),w(this,"_fps",60),w(this,"_deltaTime",0),w(this,"_performanceMonitor",new _ge),w(this,"_pointerMoveEvent"),w(this,"_pointerDownEvent"),w(this,"_pointerUpEvent"),w(this,"_pointerBlurEvent"),w(this,"_pointerWheelEvent"),w(this,"_pointerEnterEvent"),w(this,"_pointerLeaveEvent"),w(this,"_remainCapture",-1),w(this,"pointer",{}),w(this,"_mouseId",-1),w(this,"_isUsingFirefox",navigator.userAgent.indexOf("Firefox")!==-1),this._canvas=new gE({mode:i,width:e,height:n,pixelRatio:r}),this._canvasEle=this._canvas.getCanvasEle(),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get requestNewFrameHandler(){return this._requestNewFrameHandler}get frameId(){return this._frameId}setCanvasCursor(e){const n=this.getCanvas().getCanvasEle();n.style.cursor=e}clearCanvas(){this.getCanvas().clear()}getCanvas(){return this._canvas}getCanvasElement(){return this._canvas.getCanvasEle()}setRemainCapture(){this._canvasEle.setPointerCapture(this._remainCapture)}getPixelRatio(){return this._canvas.getPixelRatio()}setContainer(e,n=!0){if(this._container=e,this._container.appendChild(this._canvasEle),n){this.resize();let r;const i=new ResizeObserver(()=>{r||(r=window.requestIdleCallback(()=>{this.resize(),r=void 0}))});i.observe(this._container),this.disposeWithMe(je(()=>{i.unobserve(this._container)}))}}resize(){if(!this._container)return;const{width:e,height:n}=lge(this._container);this.resizeBySize(e,n)}resizeBySize(e,n){const r=this.width,i=this.height;this._canvas.setSize(e,n),this.onTransformChangeObservable.notifyObservers({type:eo.resize,value:{width:e,height:n},preValue:{width:r,height:i}})}dispose(){super.dispose();const e=WI();this._canvasEle.removeEventListener(`${e}leave`,this._pointerLeaveEvent),this._canvasEle.removeEventListener(`${e}enter`,this._pointerEnterEvent),this._canvasEle.removeEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}runRenderLoop(e){this._activeRenderLoops.indexOf(e)===-1&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=Rm(this._renderFunction)))}stopRenderLoop(e){if(!e){this._activeRenderLoops.length=0,this._cancelFrame();return}const n=this._activeRenderLoops.indexOf(e);n>=0&&(this._activeRenderLoops.splice(n,1),this._activeRenderLoops.length===0&&this._cancelFrame())}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){const n=this._activeRenderLoops[e];n()}}_cancelFrame(){if(this._renderingQueueLaunched&&this._requestNewFrameHandler){if(this._renderingQueueLaunched=!1,typeof window>"u"){if(typeof cancelAnimationFrame=="function")return cancelAnimationFrame(this._requestNewFrameHandler)}else{const{cancelAnimationFrame:e}=this._getHostWindow()||window;if(typeof e=="function")return e(this._requestNewFrameHandler)}return clearTimeout(this._requestNewFrameHandler)}}_getHostWindow(){var e,n;return typeof window>"u"?null:(n=(e=this._canvasEle)==null?void 0:e.ownerDocument)!=null&&n.defaultView?this._canvasEle.ownerDocument.defaultView:window}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=Rm(this._renderFunction):this._renderingQueueLaunched=!1}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_handleKeyboardAction(){const e=r=>{const i=r;i.deviceType=Ta.Keyboard,i.inputIndex=r.keyCode,i.previousState=0,i.currentState=1,this.onInputChangedObservable.notifyObservers(i)},n=r=>{const i=r;i.deviceType=Ta.Keyboard,i.inputIndex=r.keyCode,i.previousState=1,i.currentState=0,this.onInputChangedObservable.notifyObservers(i)};this._canvasEle.addEventListener("keydown",e),this._canvasEle.addEventListener("keyup",n)}_handlePointerAction(){const e=WI();this._pointerMoveEvent=n=>{const r=this._getPointerType(n),i=this.pointer[kt.Horizontal],o=this.pointer[kt.Vertical],a=this.pointer[kt.DeltaHorizontal],s=this.pointer[kt.DeltaVertical];this.pointer[kt.Horizontal]=n.clientX,this.pointer[kt.Vertical]=n.clientY,this.pointer[kt.DeltaHorizontal]=n.movementX,this.pointer[kt.DeltaVertical]=n.movementY;const u=n;u.deviceType=r,i!==n.clientX&&(u.inputIndex=kt.Horizontal,u.previousState=i,u.currentState=this.pointer[kt.Horizontal],this.onInputChangedObservable.notifyObservers(u)),o!==n.clientY&&(u.inputIndex=kt.Vertical,u.previousState=o,u.currentState=this.pointer[kt.Vertical],this.onInputChangedObservable.notifyObservers(u)),this.pointer[kt.DeltaHorizontal]!==0&&(u.inputIndex=kt.DeltaHorizontal,u.previousState=a,u.currentState=this.pointer[kt.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(u)),this.pointer[kt.DeltaVertical]!==0&&(u.inputIndex=kt.DeltaVertical,u.previousState=s,u.currentState=this.pointer[kt.DeltaVertical],this.onInputChangedObservable.notifyObservers(u)),!this._usingSafari&&n.button!==-1&&(u.inputIndex=n.button+2,u.previousState=this.pointer[n.button+2],this.pointer[n.button+2]=this.pointer[n.button+2]?0:1,u.currentState=this.pointer[n.button+2],this.onInputChangedObservable.notifyObservers(u))},this._pointerDownEvent=n=>{const r=n,i=this._getPointerType(r),o=this.pointer[kt.Horizontal],a=this.pointer[kt.Vertical],s=this.pointer[r.button+2];i===Ta.Mouse?(this._mouseId===-1&&(r.pointerId===void 0?this._mouseId=this._isUsingFirefox?0:1:this._mouseId=r.pointerId),document.pointerLockElement||(this._remainCapture=this._mouseId,this._canvasEle.setPointerCapture(this._mouseId))):r.pointerId&&!document.pointerLockElement&&(this._remainCapture=r.pointerId,this._canvasEle.setPointerCapture(r.pointerId)),this.pointer[kt.Horizontal]=r.clientX,this.pointer[kt.Vertical]=r.clientY,this.pointer[r.button+2]=1;const u=r;u.deviceType=i,o!==r.clientX&&(u.inputIndex=kt.Horizontal,u.previousState=o,u.currentState=this.pointer[kt.Horizontal],this.onInputChangedObservable.notifyObservers(u)),a!==r.clientY&&(u.inputIndex=kt.Vertical,u.previousState=a,u.currentState=this.pointer[kt.Vertical],this.onInputChangedObservable.notifyObservers(u)),u.inputIndex=r.button+2,u.previousState=s,u.currentState=this.pointer[r.button+2],this.onInputChangedObservable.notifyObservers(u)},this._pointerUpEvent=n=>{const r=n,i=this._getPointerType(r),o=this.pointer[kt.Horizontal],a=this.pointer[kt.Vertical],s=this.pointer[r.button+2];this.pointer[kt.Horizontal]=r.clientX,this.pointer[kt.Vertical]=r.clientY,this.pointer[r.button+2]=0;const u=r;u.deviceType=i,o!==r.clientX&&(u.inputIndex=kt.Horizontal,u.previousState=o,u.currentState=this.pointer[kt.Horizontal],this.onInputChangedObservable.notifyObservers(u)),a!==r.clientY&&(u.inputIndex=kt.Vertical,u.previousState=a,u.currentState=this.pointer[kt.Vertical],this.onInputChangedObservable.notifyObservers(u)),u.inputIndex=r.button+2,u.previousState=s,u.currentState=this.pointer[r.button+2],i===Ta.Mouse&&this._mouseId>=0&&this._canvasEle.hasPointerCapture(this._mouseId)?(this._remainCapture=this._mouseId,this._canvasEle.releasePointerCapture(this._mouseId)):u.pointerId&&this._canvasEle.hasPointerCapture(u.pointerId)&&(this._remainCapture=u.pointerId,this._canvasEle.releasePointerCapture(u.pointerId)),this.onInputChangedObservable.notifyObservers(u),i!==Ta.Mouse&&(this.pointer={})},this._pointerEnterEvent=n=>{const r=this._getPointerType(n),i=n;i.deviceType=r,i.currentState=2,this.onInputChangedObservable.notifyObservers(i)},this._pointerLeaveEvent=n=>{const r=this._getPointerType(n),i=n;i.deviceType=r,i.currentState=3,this.onInputChangedObservable.notifyObservers(i)},this._pointerBlurEvent=n=>{this._mouseId>=0&&this._canvasEle.hasPointerCapture(this._mouseId)&&(this._canvasEle.releasePointerCapture(this._mouseId),this._remainCapture=this._mouseId,this._mouseId=-1),this.pointer={}},this._pointerWheelEvent=n=>{const r=Ta.Mouse,i=this.pointer[kt.MouseWheelX],o=this.pointer[kt.MouseWheelY],a=this.pointer[kt.MouseWheelZ];this.pointer[kt.MouseWheelX]=n.deltaX||0,this.pointer[kt.MouseWheelY]=n.deltaY||n.wheelDelta||0,this.pointer[kt.MouseWheelZ]=n.deltaZ||0;const s=n;s.deviceType=r,this.pointer[kt.MouseWheelX]!==0&&(s.inputIndex=kt.MouseWheelX,s.previousState=i,s.currentState=this.pointer[kt.MouseWheelX],this.onInputChangedObservable.notifyObservers(s)),this.pointer[kt.MouseWheelY]!==0&&(s.inputIndex=kt.MouseWheelY,s.previousState=o,s.currentState=this.pointer[kt.MouseWheelY],this.onInputChangedObservable.notifyObservers(s)),this.pointer[kt.MouseWheelZ]!==0&&(s.inputIndex=kt.MouseWheelZ,s.previousState=a,s.currentState=this.pointer[kt.MouseWheelZ],this.onInputChangedObservable.notifyObservers(s))},this._canvasEle.addEventListener(`${e}enter`,this._pointerEnterEvent),this._canvasEle.addEventListener(`${e}leave`,this._pointerLeaveEvent),this._canvasEle.addEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,this._getPassive()?{passive:!1}:!1)}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const n=()=>{};try{const r={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",n,r),this._canvasEle.removeEventListener("test",n,r)}catch{}return e}_getPointerType(e){let n=Ta.Mouse;return(e.pointerType==="touch"||e.pointerType==="pen"||e.touches)&&(n=Ta.Touch),n}};class U4 extends M0{constructor(e,...n){super(e),w(this,"_objects",[]),this.addObjects(...n)}get classType(){return qt.GROUP}set cursor(e){this.setCursor(e)}addObjects(...e){for(const n of e)this.addObject(n)}addObject(e){let n=e;if(YI(e)){const r=this.getScene();if(n=r==null?void 0:r.getObject(e),!n)return;n.parent=this,n.isInGroup=!0,n.groupKey=this.oKey,this._objects.push(n)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const n=this.getObjects(),r=n.length;if(YI(e))for(let i=0;i<r;i++){const o=n[i];if(o.oKey===e){n.splice(i,1),this.parent.removeObject(o);return}}else for(let i=0;i<r;i++){const o=n[i];if(o===e){n.splice(i,1),this.parent.removeObject(o);return}}}getObjectsByOrder(){const e=[];this._objects.sort(gs);for(const n of this._objects)!n.isInGroup&&n.visible&&e.push(n);return e}getObjects(){return this._objects}render(e,n){e.save();const r=this.transform.getMatrix();e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._objects.sort(gs);for(const i of this._objects)i.render(e,this._transformBounds(n));e.restore()}resize(e,n){return this}scale(e,n){return this}skew(e,n){return this}flip(e,n){return this}isHit(e){return!0}pick(e){}dispose(){this.getObjects().forEach(e=>{e.dispose()}),super.dispose()}_transformBounds(e){return e}}class Pm{constructor(e,n=[],r=1,i=!1){w(this,"_objects",[]),w(this,"_cacheCanvas"),w(this,"_dirty",!0),this._scene=e,this._zIndex=r,this._allowCache=i,this.addObjects(n),this._allowCache&&this._initialCacheCanvas()}get scene(){return this._scene}get zIndex(){return this._zIndex}enableCache(){this._allowCache=!0,this._initialCacheCanvas()}disableCache(){var e;this._allowCache=!1,(e=this._cacheCanvas)==null||e.dispose(),this._cacheCanvas=null}isAllowCache(){return this._allowCache}getObjectsByOrder(){const e=[];this._objects.sort(gs);for(const n of this._objects)!n.isInGroup&&n.visible&&e.push(n);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(gs);for(const n of this._objects)n.classType!==qt.GROUP&&n.visible&&e.push(n);return e}getObjects(){return this._objects}addObject(e){if(e.classType===qt.GROUP){const n=e.getObjects();for(const r of n)this.scene.getObject(r.oKey)||(this._objects.push(r),this.scene.setObjectBehavior(r),r.layer=this)}return this._objects.push(e),this.scene.setObjectBehavior(e),this.scene.applyTransformer(e),e.layer=this,this}removeObject(e){const n=this.getObjects(),r=n.length;if(e instanceof M0){for(let i=0;i<r;i++)if(n[i]===e){n.splice(i,1);return}}else for(let i=0;i<r;i++)if(n[i].oKey===e){n.splice(i,1);return}}addObjects(e){return e.forEach(n=>{this.addObject(n)}),this}removeObjects(e){const n=this.getObjects(),r=n.length;for(let i=r-1;i>=0;i--){let o=n[i];const a=e.length;if(a===0)break;for(let s=0;s<a;s++){const u=e[s];if(o=u instanceof M0?o:o.oKey,o===u){n.splice(i,1);break}}}}makeDirty(e=!0){return this._dirty=e,this}isDirty(){return this._dirty}render(e,n=!1){var r;const i=e||((r=this._scene.getEngine())==null?void 0:r.getCanvas().getContext());if(this._allowCache&&this._cacheCanvas){if(this.isDirty()){const o=this._cacheCanvas.getContext();this._cacheCanvas.clear(),o.save(),o.setTransform(i.getTransform()),this._draw(o,n),o.restore()}this._applyCache(i)}else i.save(),this._draw(i,n),i.restore();return this.makeDirty(!1),this}_initialCacheCanvas(){this._cacheCanvas=new gE,this._scene.getEngine().onTransformChangeObservable.add(()=>{this._resizeCacheCanvas()})}_draw(e,n){var r;(r=this._scene.getViewports())==null||r.forEach(i=>i.render(e,this.getObjectsByOrder(),n))}_applyCache(e){if(!e||this._cacheCanvas==null)return;const n=this._cacheCanvas.getWidth(),r=this._cacheCanvas.getHeight();e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r)}_resizeCacheCanvas(){var e;const n=this._scene.getEngine();(e=this._cacheCanvas)==null||e.setSize(n.width,n.height),this.makeDirty(!0)}clear(){this._objects=[]}dispose(){var e;this.getObjects().forEach(n=>{n.dispose()}),this.clear(),(e=this._cacheCanvas)==null||e.dispose()}}const d_e=["__SpreadsheetTransformerResizeLT__","__SpreadsheetTransformerResizeCT__","__SpreadsheetTransformerResizeRT__","__SpreadsheetTransformerResizeLM__","__SpreadsheetTransformerResizeRM__","__SpreadsheetTransformerResizeLB__","__SpreadsheetTransformerResizeCB__","__SpreadsheetTransformerResizeRB__"];class m_e{constructor(e,n){w(this,"hoverEnabled",!1),w(this,"hoverEnterFunc"),w(this,"hoverLeaveFunc"),w(this,"resizeEnabled",!0),w(this,"rotateEnabled",!0),w(this,"rotationSnaps",[]),w(this,"rotationSnapTolerance",5),w(this,"rotateAnchorOffset",50),w(this,"rotateSize",10),w(this,"rotateCornerRadius",10),w(this,"borderEnabled",!0),w(this,"borderStroke","rgb(97, 97, 97)"),w(this,"borderStrokeWidth",1),w(this,"borderDash",[]),w(this,"borderSpacing",10),w(this,"anchorFill","rgb(255,255,255)"),w(this,"anchorStroke","rgb(185,185,185)"),w(this,"anchorStrokeWidth",1),w(this,"anchorSize",10),w(this,"anchorCornerRadius",10),w(this,"keepRatio",!0),w(this,"centeredScaling",!1),w(this,"enabledAnchors",[1,1,1,1,1,1,1,1]),w(this,"flipEnabled",!1),w(this,"ignoreStroke",!1),w(this,"boundBoxFunc"),w(this,"useSingleNodeRotation",!1),w(this,"shouldOverdrawWholeArea",!1),w(this,"onChangeStartObservable",new Vn),w(this,"onChangingObservable",new Vn),w(this,"onChangeEndObservable",new Vn),w(this,"onClearControlObservable",new Vn),w(this,"onCreateControlObservable",new Vn),w(this,"_startOffsetX",-1),w(this,"_startOffsetY",-1),w(this,"_viewportScrollX",-1),w(this,"_viewportScrollY",-1),w(this,"_moveObserver"),w(this,"_upObserver"),w(this,"_cancelFocusObserver"),w(this,"_transformerControlMap",new Map),w(this,"_selectedObjectMap",new Map),this._scene=e,this._initialProps(n)}getScene(){return this._scene}hideControl(){this._hideControl()}attachTo(e){if(e.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&e.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&e.onPointerLeaveObserver.add(this.hoverLeaveFunc)),e.onPointerDownObserver.add((n,r)=>{const{offsetX:i,offsetY:o}=n;this._startOffsetX=i,this._startOffsetY=o;const a=this._getTopScene();if(!a)return;this._addCancelObserver(a),a.disableEvent();const s=c1.create(a);s.startScroll(i,o);const{scrollX:u,scrollY:l}=b6(s);this._viewportScrollX=u,this._viewportScrollY=l,this._updateActiveObjectList(e,n),this._moveObserver=a.onPointerMoveObserver.add(c=>{const{offsetX:d,offsetY:m}=c;this._moving(d,m,s),this._hideControl(),s.scrolling(d,m,()=>{this._moving(d,m,s)})}),this._upObserver=a.onPointerUpObserver.add(c=>{a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),a.enableEvent(),this._updateControl(),s.dispose(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),r.stopPropagation()}),e}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach(e=>{e.dispose()}),this._selectedObjectMap.forEach(e=>{e.dispose()}),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}_initialProps(e){if(!e)return;const n=Object.keys(e);n.length!==0&&n.forEach(r=>{if(e[r]===void 0)return!0;this[r]=e[r]})}_updateControlChildren(){this._updateControlIterator((e,n)=>{const{left:r,top:i,width:o,height:a,scaleX:s,scaleY:u}=n.getState();e.getObjects().forEach(l=>{const c=l.oKey,d=this._checkTransformerType(c);if(!d)return!0;if(d==="__SpreadsheetTransformerOutline__")l.transformByState(this._getOutlinePosition(o,a,s,u));else{const{left:m,top:f}=this._getRotateAnchorPosition(d,a,o);l.transformByState({left:m,top:f})}}),e.transformByState({left:r,top:i})})}_anchorMoving(e,n,r,i){const{scrollX:o,scrollY:a}=b6(i),s=n-this._viewportScrollX+o,u=r-this._viewportScrollY+a,l=s-this._startOffsetX,c=u-this._startOffsetY;this._selectedObjectMap.forEach(d=>{const{left:m,top:f,width:h,height:p}=d,v={};switch(e){case"__SpreadsheetTransformerResizeLT__":v.left=m+l,v.top=f+c,v.width=h-l,v.height=p-c;break;case"__SpreadsheetTransformerResizeCT__":v.top=f+c,v.height=p-c;break;case"__SpreadsheetTransformerResizeRT__":v.top=f+c,v.width=h+l,v.height=p-c;break;case"__SpreadsheetTransformerResizeLM__":v.left=m+l,v.width=h-l;break;case"__SpreadsheetTransformerResizeRM__":v.width=l+h;break;case"__SpreadsheetTransformerResizeLB__":v.left=m+l,v.width=h-l,v.height=p+c;break;case"__SpreadsheetTransformerResizeCB__":v.height=c+p;break;case"__SpreadsheetTransformerResizeRB__":v.width=l+h,v.height=c+p;break}d.transformByState(v)}),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:c,type:1}),this._startOffsetX=s,this._startOffsetY=u}_attachEventToAnchor(e,n="__SpreadsheetTransformerResizeLT__"){e.onPointerDownObserver.add((r,i)=>{const{offsetX:o,offsetY:a}=r;this._startOffsetX=o,this._startOffsetY=a;const s=this._getTopScene();if(s==null)return;s.disableEvent();const u=c1.create(s);u.startScroll(o,a);const{scrollX:l,scrollY:c}=b6(u);this._viewportScrollX=l,this._viewportScrollY=c;const d=this._getRotateAnchorCursor(n);this._moveObserver=s.onPointerMoveObserver.add(m=>{const{offsetX:f,offsetY:h}=m;this._anchorMoving(n,f,h,u),u.scrolling(f,h,()=>{this._anchorMoving(n,f,h,u)}),s.setCursor(d)}),this._upObserver=s.onPointerUpObserver.add(m=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent(),s.resetCursor(),u.dispose(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),i.stopPropagation()})}_attachEventToRotate(e){e.onPointerDownObserver.add((n,r)=>{const{offsetX:i,offsetY:o}=n;this._startOffsetX=i,this._startOffsetY=o;const a=this._getTopScene();a!=null&&(a.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=a.onPointerMoveObserver.add(s=>{}),this._upObserver=a.onPointerUpObserver.add(s=>{a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),a.enableEvent()}),r.stopPropagation())})}_getOutlinePosition(e,n,r,i){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:e+this.borderSpacing*2,height:n+this.borderSpacing*2}}_getRotateAnchorCursor(e){let n=Jt.NORTH_WEST_RESIZE;switch(e){case"__SpreadsheetTransformerRotate__":n=Jt.MOVE;break;case"__SpreadsheetTransformerRotateLine__":n=Jt.MOVE;break;case"__SpreadsheetTransformerResizeLT__":break;case"__SpreadsheetTransformerResizeCT__":n=Jt.NORTH_RESIZE;break;case"__SpreadsheetTransformerResizeRT__":n=Jt.NORTH_EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLM__":n=Jt.WEST_RESIZE;break;case"__SpreadsheetTransformerResizeRM__":n=Jt.EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLB__":n=Jt.SOUTH_WEST_RESIZE;break;case"__SpreadsheetTransformerResizeCB__":n=Jt.SOUTH_RESIZE;break;case"__SpreadsheetTransformerResizeRB__":n=Jt.SOUTH_EAST_RESIZE;break}return n}_getRotateAnchorPosition(e,n,r){let i=-this.anchorSize/2,o=-this.anchorSize/2;switch(e){case"__SpreadsheetTransformerRotate__":i=r/2-this.rotateSize/2,o=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth*2-this.rotateSize;break;case"__SpreadsheetTransformerRotateLine__":i=r/2,o=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLT__":i+=-this.borderSpacing-this.borderStrokeWidth,o+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCT__":i+=r/2,o+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRT__":i+=r+this.borderSpacing-this.borderStrokeWidth,o+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLM__":i+=-this.borderSpacing-this.borderStrokeWidth,o+=n/2;break;case"__SpreadsheetTransformerResizeRM__":i+=r+this.borderSpacing-this.borderStrokeWidth,o+=n/2;break;case"__SpreadsheetTransformerResizeLB__":i+=-this.borderSpacing-this.borderStrokeWidth,o+=n+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCB__":i+=r/2,o+=n+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRB__":i+=r+this.borderSpacing-this.borderStrokeWidth,o+=n+this.borderSpacing-this.borderStrokeWidth;break}return{left:i,top:o}}_createResizeAnchor(e,n,r){const{height:i,width:o,scaleX:a,scaleY:s}=n.getState(),{left:u,top:l}=this._getRotateAnchorPosition(e,i,o),c=this._getRotateAnchorCursor(e),d=new cn(`${e}_${r}`,{zIndex:r-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:u,top:l});return this._attachHover(d,c,Jt.DEFAULT),d}_checkTransformerType(e){if(e.indexOf("__SpreadsheetTransformerOutline__")>-1)return"__SpreadsheetTransformerOutline__";if(e.indexOf("__SpreadsheetTransformerRotate__")>-1)return"__SpreadsheetTransformerRotate__";if(e.indexOf("__SpreadsheetTransformerRotateLine__")>-1)return"__SpreadsheetTransformerRotateLine__";if(e.indexOf("__SpreadsheetTransformerResizeLT__")>-1)return"__SpreadsheetTransformerResizeLT__";if(e.indexOf("__SpreadsheetTransformerResizeCT__")>-1)return"__SpreadsheetTransformerResizeCT__";if(e.indexOf("__SpreadsheetTransformerResizeRT__")>-1)return"__SpreadsheetTransformerResizeRT__";if(e.indexOf("__SpreadsheetTransformerResizeLM__")>-1)return"__SpreadsheetTransformerResizeLM__";if(e.indexOf("__SpreadsheetTransformerResizeRM__")>-1)return"__SpreadsheetTransformerResizeRM__";if(e.indexOf("__SpreadsheetTransformerResizeLB__")>-1)return"__SpreadsheetTransformerResizeLB__";if(e.indexOf("__SpreadsheetTransformerResizeCB__")>-1)return"__SpreadsheetTransformerResizeCB__";if(e.indexOf("__SpreadsheetTransformerResizeRB__")>-1)return"__SpreadsheetTransformerResizeRB__"}_updateControlIterator(e){this._transformerControlMap.forEach((n,r)=>{const i=this._selectedObjectMap.get(r);if(!i)return!0;e(n,i)})}_updateControl(){this._updateControlIterator((e,n)=>{const{left:r,top:i}=n.getState();e.transformByState({left:r,top:i}),e.show(),e.makeDirty(!0)})}_hideControl(){this._transformerControlMap.forEach(e=>{e.hide(),e.makeDirty(!0)})}_attachHover(e,n,r){e.onPointerEnterObserver.add(()=>{e.cursor=n}),e.onPointerLeaveObserver.add(()=>{e.cursor=r})}_clearControl(){this._transformerControlMap.forEach(e=>{e.dispose()}),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(e){const{left:n,top:r,height:i,width:o,angle:a,scaleX:s,scaleY:u,skewX:l,skewY:c,flipX:d,flipY:m}=e.getState(),f=e.oKey,h=this._selectedObjectMap.size,p=[];if(this.borderEnabled){const g=new cn(`__SpreadsheetTransformerOutline___${h}`,{zIndex:h-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke,...this._getOutlinePosition(o,i,s,u)});p.push(g)}if(this.resizeEnabled){const{left:g,top:b}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotateLine__",i,o),C=new cn(`__SpreadsheetTransformerRotateLine___${h}`,{zIndex:h-1,evented:!1,left:g,top:b,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:S,top:E}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotate__",i,o),y=this._getRotateAnchorCursor("__SpreadsheetTransformerRotate__"),D=new cn(`__SpreadsheetTransformerRotate___${h}`,{zIndex:h-1,left:S,top:E,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:this.borderStrokeWidth*2,stroke:this.borderStroke});this._attachEventToRotate(D),this._attachHover(D,y,Jt.DEFAULT),p.push(C,D)}if(this.resizeEnabled)for(let g=0,b=this.enabledAnchors.length;g<b;g++){if(this.enabledAnchors[g]!==1)continue;const C=d_e[g],S=this._createResizeAnchor(C,e,h);this._attachEventToAnchor(S,C),p.push(S)}const v=new U4(`__SpreadsheetTransformer___${h}`,...p);return v.zIndex=h,v.evented=!1,v.transformByState({left:n,top:r}),this.getScene().addObject(v,2),this._transformerControlMap.set(f,v),this.onCreateControlObservable.notifyObservers(v),v}_getTopScene(){var e;return(e=this.getScene().getEngine())==null?void 0:e.activeScene}_moving(e,n,r){const{scrollX:i,scrollY:o}=b6(r),a=e-this._viewportScrollX+i,s=n-this._viewportScrollY+o,u=a-this._startOffsetX,l=s-this._startOffsetY;this._selectedObjectMap.forEach(c=>{c.translate(u+c.left,l+c.top)}),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:u,moveY:l,type:1}),this._startOffsetX=a,this._startOffsetY=s}_updateActiveObjectList(e,n){this._selectedObjectMap.has(e.oKey)||(n.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(e.oKey,e),this._createControl(e))}_addCancelObserver(e){e.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=e.onPointerDownObserver.add(n=>{this._selectedObjectMap.clear(),this._clearControl(),e.onPointerDownObserver.remove(this._cancelFocusObserver)})}}const $2=class C6{constructor(e){w(this,"_alreadyAttached",!1),w(this,"_onInputObserver"),w(this,"_onPointerMove"),w(this,"_onPointerDown"),w(this,"_onPointerUp"),w(this,"_onPointerEnter"),w(this,"_onPointerLeave"),w(this,"_onMouseWheel"),w(this,"_onKeyDown"),w(this,"_onKeyUp"),w(this,"_scene"),w(this,"_currentMouseEnterPicked"),w(this,"_startingPosition",new zt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)),w(this,"_delayedTimeout",-1),w(this,"_delayedTripeTimeout",-1),w(this,"_doubleClickOccurred",0),w(this,"_tripleClickState",!1),w(this,"_currentObject"),this._scene=e}mouseLeaveEnterHandler(e){var n;const r=this._currentObject;if(r==null)(n=this._currentMouseEnterPicked)==null||n.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(r!==this._currentMouseEnterPicked){const i=this._currentMouseEnterPicked;this._currentMouseEnterPicked=r,i==null||i.triggerPointerLeave(e),r==null||r.triggerPointerEnter(e)}}attachControl(e=!0,n=!0,r=!0,i=!0,o=!0,a=!0){const s=this._scene.getEngine();s&&(this._onPointerEnter=u=>{var l;u.pointerId===void 0&&(u.pointerId=0),this._currentObject=this._getCurrentObject(u.offsetX,u.offsetY),(l=this._currentObject)==null||l.triggerPointerMove(u),this.mouseLeaveEnterHandler(u)},this._onPointerLeave=u=>{u.pointerId===void 0&&(u.pointerId=0),this._currentObject=null,this.mouseLeaveEnterHandler(u)},this._onPointerMove=u=>{var l;u.pointerId===void 0&&(u.pointerId=0),this._currentObject=this._getCurrentObject(u.offsetX,u.offsetY);const c=(l=this._currentObject)==null?void 0:l.triggerPointerMove(u);this.mouseLeaveEnterHandler(u),this._checkDirectSceneEventTrigger(!c,this._currentObject)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(u)},this._onPointerDown=u=>{u.pointerId===void 0&&(u.pointerId=0);const l=this._getCurrentObject(u.offsetX,u.offsetY),c=l==null?void 0:l.triggerPointerDown(u);this._checkDirectSceneEventTrigger(!c,l)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(u)},this._onPointerUp=u=>{u.pointerId===void 0&&(u.pointerId=0);const l=this._getCurrentObject(u.offsetX,u.offsetY),c=l==null?void 0:l.triggerPointerUp(u);this._checkDirectSceneEventTrigger(!c,l)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(u),this._prePointerDoubleOrTripleClick(u)},this._onMouseWheel=u=>{const l=this._getCurrentObject(u.offsetX,u.offsetY),c=l==null?void 0:l.triggerMouseWheel(u);this._scene.getViewports().forEach(d=>{d.onMouseWheelObserver.hasObservers()&&d.onMouseWheelObserver.notifyObservers(u)}),this._checkDirectSceneEventTrigger(!c,l)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(u)},this._onKeyDown=u=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(u)},this._onKeyUp=u=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(u)},this._onInputObserver=s.onInputChangedObservable.add(u=>{const l=u;u.deviceType===Ta.Keyboard&&(u.currentState===1&&this._onKeyDown(l),u.currentState===0&&this._onKeyUp(l)),(u.deviceType===Ta.Mouse||u.deviceType===Ta.Touch)&&(e&&u.inputIndex>=kt.LeftClick&&u.inputIndex<=kt.RightClick&&u.currentState===1&&this._onPointerDown(l),n&&u.inputIndex>=kt.LeftClick&&u.inputIndex<=kt.RightClick&&u.currentState===0&&this._onPointerUp(l),r&&(u.inputIndex===kt.Horizontal||u.inputIndex===kt.Vertical||u.inputIndex===kt.DeltaHorizontal||u.inputIndex===kt.DeltaVertical)?this._onPointerMove(l):i&&(u.inputIndex===kt.MouseWheelX||u.inputIndex===kt.MouseWheelY||u.inputIndex===kt.MouseWheelZ)?this._onMouseWheel(l):o&&u.currentState===2?this._onPointerEnter(l):a&&u.currentState===3&&this._onPointerLeave(l))}),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const e=this._scene.getEngine();e&&(e.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_getCurrentObject(e,n){var r;return(r=this._scene)==null?void 0:r.pick(zt.FromArray([e,n]))}_checkDirectSceneEventTrigger(e,n){let r=!1;n==null&&(r=!0);let i=!0;if(n&&n.classType===qt.BASE_OBJECT){const o=n.getScene();o&&(i=o.getParent().classType!==qt.SCENE_VIEWER)}return!this._scene.evented&&e&&i||r}_isPointerSwiping(e,n){return Math.abs(this._startingPosition.x-e)>C6.DragMovementThreshold||Math.abs(this._startingPosition.y-n)>C6.DragMovementThreshold}_prePointerDoubleOrTripleClick(e){var n,r,i,o;const{clientX:a,clientY:s}=e;this._isPointerSwiping(a,s)&&this._resetDoubleClickParam(),this._delayedTimeout=setTimeout(()=>{this._resetDoubleClickParam()},C6.DoubleClickDelay),this._doubleClickOccurred+=1,this._tripleClickState&&((r=(n=this._scene)==null?void 0:n.pick(zt.FromArray([e.offsetX,e.offsetY])))==null||r.triggerTripleClick(e),this._scene.onTripleClickObserver.hasObservers()&&this._scene.onTripleClickObserver.notifyObservers(e)),this._doubleClickOccurred===2&&((o=(i=this._scene)==null?void 0:i.pick(zt.FromArray([e.offsetX,e.offsetY])))==null||o.triggerDblclick(e),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(e),this._resetDoubleClickParam(),this._tripleClickState=!0,clearTimeout(this._delayedTripeTimeout),this._delayedTripeTimeout=setTimeout(()=>{this._tripleClickState=!1},C6.TripleClickDelay)),this._startingPosition.x=a,this._startingPosition.y=s}_resetDoubleClickParam(){this._doubleClickOccurred=0,clearTimeout(this._delayedTimeout)}};w($2,"DragMovementThreshold",2),w($2,"LongPressDelay",500),w($2,"DoubleClickDelay",500),w($2,"TripleClickDelay",300),w($2,"ExclusiveDoubleClickMode",!1);let f_e=$2;class h_e{constructor(e){w(this,"onTransformChangeObservable",new Vn),w(this,"onPointerDownObserver",new Vn),w(this,"onPointerMoveObserver",new Vn),w(this,"onPointerUpObserver",new Vn),w(this,"onPointerEnterObserver",new Vn),w(this,"onPointerLeaveObserver",new Vn),w(this,"onDblclickObserver",new Vn),w(this,"onTripleClickObserver",new Vn),w(this,"onMouseWheelObserver",new Vn),w(this,"onKeyDownObservable",new Vn),w(this,"onKeyUpObservable",new Vn),w(this,"debounceParentTimeout",-1),w(this,"_sceneKey",""),w(this,"_width",100),w(this,"_height",100),w(this,"_scaleX",1),w(this,"_scaleY",1),w(this,"_transform",new l1),w(this,"_evented",!0),this._sceneKey=e}get classType(){return qt.SCENE}get transform(){return this._transform}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get sceneKey(){return this._sceneKey}get evented(){return this._evented}set transform(e){this._transform=e}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}on(e,n){return this[`on${e}Observer`].add(n.bind(this))}off(e,n){this[`on${e}Observer`].remove(n)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){}triggerMouseWheel(e){}triggerPointerMove(e){}triggerDblclick(e){}triggerTripleClick(e){}triggerPointerDown(e){}triggerPointerOut(e){}triggerPointerLeave(e){}triggerPointerOver(e){}triggerPointerEnter(e){}renderObjects(e,n){}render(e){}getParent(){}dispose(){}getObject(e){}addObject(e,n=1){}addObjects(e,n=1){}getEngine(){}setObjectBehavior(e){}applyTransformer(e){}makeDirtyNoParent(e=!0){return this}makeDirty(e=!0){return this}pick(e){}getViewports(){return[]}addViewport(...e){}removeViewport(e){}getAncestorScale(){return{scaleX:1,scaleY:1}}getPrecisionScale(){return{scaleX:1,scaleY:1}}}class p_e extends h_e{constructor(e,n,r){var i;if(super(e),w(this,"_layers",[]),w(this,"_viewports",[]),w(this,"_cursor",Jt.DEFAULT),w(this,"_defaultCursor",Jt.DEFAULT),w(this,"_addObject$",new dn(this)),w(this,"addObject$",this._addObject$.asObservable()),w(this,"_transformer"),w(this,"_transformerOpenState",!1),w(this,"_inputManager"),this._parent=n,r&&this.transformByState(r),this._parent.classType===qt.ENGINE){const o=this._parent;o.addScene(this),o.hasActiveScene()||o.setActiveScene(e),this._inputManager=new f_e(this)}else this._parent.classType===qt.SCENE_VIEWER&&this._parent.addSubScene(this);(i=this._parent)==null||i.onTransformChangeObservable.add(o=>{this._setTransForm()})}get ancestorScaleX(){const e=this.getParent();let n=1;return e.classType===qt.SCENE_VIEWER&&(n=e.ancestorScaleX),this.scaleX*n}get ancestorScaleY(){const e=this.getParent();let n=1;return e.classType===qt.SCENE_VIEWER&&(n=e.ancestorScaleY),this.scaleY*n}set cursor(e){this.setCursor(e)}attachControl(e=!0,n=!0,r=!0,i=!0){var o;if(this._parent.classType===qt.ENGINE)return(o=this._inputManager)==null||o.attachControl(e,n,r,i),this}detachControl(){var e;return(e=this._inputManager)==null||e.detachControl(),this}makeDirty(e=!0){var n;return this._layers.forEach(r=>{r.makeDirty(e)}),this._parent.classType===qt.SCENE_VIEWER&&((n=this._parent)==null||n.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach(n=>{n.makeDirty(e)}),this}enableLayerCache(...e){e.forEach(n=>{this.getLayer(n).enableCache()})}disableLayerCache(...e){e.forEach(n=>{this.getLayer(n).disableCache()})}isDirty(){for(let e=0;e<this._layers.length;e++)if(this._layers[e].isDirty()===!0)return!0;return!1}getCursor(){return this._cursor}resetCursor(){this.setCursor(this._defaultCursor)}setCursor(e){this._cursor=e;const n=this.getEngine();n&&n.setCanvasCursor(e)}setDefaultCursor(e){this._defaultCursor=e,this.resetCursor()}resize(e,n){const r=this.width;e!==void 0&&(this.width=e);const i=this.height;return n!==void 0&&(this.height=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.resize,value:{width:this.width,height:this.height},preValue:{width:r,height:i}}),this}scale(e,n){const r=this.scaleX;e!==void 0&&(this.scaleX=e);const i=this.scaleY;return n!==void 0&&(this.scaleY=n),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:r,scaleY:i}}),this}scaleBy(e,n){const r=this.scaleX;e!==void 0&&(this.scaleX+=e);const i=this.scaleY;return n!==void 0&&(this.scaleY+=n),this.scaleX=Kb(this.scaleX,1),this.scaleY=Kb(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:r,scaleY:i}}),this}transformByState(e){const n=Object.keys(e),r={};n.length!==0&&(n.forEach(i=>{e[i]!==void 0&&(r[i]=this[i],this[i]=e[i])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:eo.all,value:e,preValue:r}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===qt.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e.classType===qt.ENGINE)return e;e=e==null?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(const n of this._layers)if(n.zIndex===e)return n;return this._createDefaultLayer(e)}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let n=0;n<this._layers.length;n++){const r=this._layers[n];r.zIndex>=e&&(e=r.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,n=1){var r;return(r=this.getLayer(n))==null||r.addObject(e),this._addObject$.next(this),this}setObjectBehavior(e){e.parent||(e.parent=this),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,n=1){var r;return(r=this.getLayer(n))==null||r.addObjects(e),this._addObject$.next(this),this}removeObject(e){if(e==null)return;const n=this.getLayers();for(const r of n)r.removeObject(e);return this}removeObjects(e){if(e==null)return;const n=this.getLayers();for(const r of n)r.removeObjects(e);return this}getAllObjects(){const e=[];this._layers.sort(gs);for(const n of this._layers)e.push(...n.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const n=[],r=e?cD:gs;this._layers.sort(r);for(const i of this._layers)n.push(...i.getObjectsByOrder().sort(r));return n}getAllObjectsByOrderForPick(e=!1){const n=[],r=e?cD:gs;this._layers.sort(r);for(const i of this._layers)n.push(...i.getObjectsByOrderForPick().sort(r));return n}getObject(e){for(const n of this._layers){const r=n.getObjectsByOrder();for(const i of r)if(i.oKey===e)return i}}fuzzyMathObjects(e){const n=[];for(const r of this._layers){const i=r.getObjectsByOrder();for(const o of i)o.oKey.indexOf(e)>-1&&i.push(o)}return n}addViewport(...e){return this._viewports.push(...e),this}removeViewport(e){for(let n=0,r=this._viewports.length;n<r;n++){const i=this._viewports[n];if(i.viewPortKey===e)return this._viewports.splice(n,1),i}}getViewports(){return this._viewports}getViewport(e){for(const n of this._viewports)if(n.viewPortKey===e)return n}changeObjectOrder(){}render(e){var n;if(!this.isDirty())return;!e&&((n=this.getEngine())==null||n.clearCanvas());const r=this._layers.sort(gs);for(let i=0,o=r.length;i<o;i++)r[i].render(e,i===o-1)}async requestRender(e){return new Promise((n,r)=>{this.render(e),Rm(n)})}openTransformer(e){this._transformer||(this._transformer=new m_e(this,e)),this._transformerOpenState=!0}closeTransformer(e=!1){e&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(e){var n;this._transformerOpenState&&((n=this._transformer)==null||n.attachTo(e))}getTransformer(){return this._transformer}getActiveViewportByRelativeCoord(e){return this._viewports.find(n=>n.isHit(e))}getActiveViewportByCoord(e){return e=this.getRelativeCoord(e),this.getActiveViewportByRelativeCoord(e)}getScrollXYByRelativeCoords(e,n){return n||(n=this.getActiveViewportByRelativeCoord(e)),n?this.getScrollXY(n):{x:0,y:0}}getScrollXY(e){let n=0,r=0;if(e){const i=e.actualScrollX||0,o=e.actualScrollY||0;n+=i,r+=o}return{x:n,y:r}}getRelativeCoord(e){let n=this.getParent();const r=[];for(;n;)(n.classType===qt.SCENE||n.classType===qt.SCENE_VIEWER)&&r.push(n),n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent());r.reverse();for(const i of r)if(i.classType===qt.SCENE){const o=i.getActiveViewportByCoord(e);if(o){const a=o.actualScrollX||0,s=o.actualScrollY||0;e=e.addByPoint(a,s)}}else i.classType===qt.SCENE_VIEWER&&(e=i.transform.clone().invert().applyPoint(e));return e}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}getAncestorScale(){let{scaleX:e=1,scaleY:n=1}=this;return this.classType===qt.SCENE_VIEWER&&(e=this.ancestorScaleX||1,n=this.ancestorScaleY||1),{scaleX:e,scaleY:n}}getPrecisionScale(){var e;const n=((e=this.getEngine())==null?void 0:e.getPixelRatio())||1,{scaleX:r,scaleY:i}=this.getAncestorScale();return{scaleX:r*n,scaleY:i*n}}dispose(){var e;this.getLayers().forEach(n=>{n.dispose()}),this.getViewports().forEach(n=>{n.dispose()}),this.clearLayer(),this.clearViewports(),this.detachControl(),(e=this._transformer)==null||e.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onPointerEnterObserver.clear(),this.onPointerLeaveObserver.clear(),this.onDblclickObserver.clear(),this.onTripleClickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(e){let n=this.getActiveViewportByCoord(e);if(n||(n=this._viewports[0]),!this.evented||!n)return;const r=n.pickScrollBar(e);if(r)return r;const i=n.getRelativeVector(e);let o=null;const a=this.getAllObjectsByOrderForPick().reverse(),s=a.length;for(let u=0;u<s;u++){const l=a[u];if(!l.visible||!l.evented||l.classType===qt.GROUP)continue;let c=i;if(l.isInGroup&&l.parent.classType===qt.GROUP){const{cumLeft:d,cumTop:m}=this._getGroupCumLeftRight(l);c=c.clone().add(zt.FromArray([-d,-m]))}if(l.isHit(c)){if(l.classType===qt.SCENE_VIEWER){const d=l.pick(c);d?o=d:o=l.getActiveSubScene()}else o=l;break}else if(l.classType===qt.SCENE_VIEWER&&l.allowSelectedClipElement()){const d=l.pick(c);if(d){o=d;break}}}return!o&&this._parent.classType===qt.ENGINE?this:o}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var n,r;return!((n=this.onPointerUpObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerUp(e),!1):!0}triggerMouseWheel(e){var n,r;return!((n=this.onMouseWheelObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerMouseWheel(e),!1):!0}triggerPointerMove(e){var n,r;return!((n=this.onPointerMoveObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerMove(e),!1):!0}triggerDblclick(e){var n,r;return!((n=this.onDblclickObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerDblclick(e),!1):!0}triggerTripleClick(e){var n,r;return!((n=this.onTripleClickObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerTripleClick(e),!1):!0}triggerPointerDown(e){var n,r;return!((n=this.onPointerDownObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerDown(e),!1):!0}triggerPointerOut(e){var n;return this._parent.classType===qt.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerOut(e),!1):!0}triggerPointerLeave(e){var n,r;return!((n=this.onPointerLeaveObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerLeave(e),!1):!0}triggerPointerOver(e){var n;return this._parent.classType===qt.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerOver(e),!1):!0}triggerPointerEnter(e){var n,r;return!((n=this.onPointerEnterObserver.notifyObservers(e))!=null&&n.stopPropagation)&&this._parent.classType===qt.SCENE_VIEWER?((r=this._parent)==null||r.triggerPointerEnter(e),!1):!0}_createDefaultLayer(e=1){const n=new Pm(this,[],e);return this.addLayer(n),n}_setTransForm(){const e=l1.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach(n=>{n.resetSizeAndScrollBar()}),this.makeDirty(!0)}_getGroupCumLeftRight(e){let n=e.parent,r=0,i=0;for(;n.classType===qt.GROUP;){const{left:o,top:a}=n;r+=o,i+=a,n=n.parent}return{cumLeft:r,cumTop:i}}}const g_e={width:1500,height:1e3},v_e="_UNIVER_SCENE_";class b_e{constructor(){w(this,"_defaultEngine",new l_),w(this,"_currentUnitId",""),w(this,"_renderMap",new Map),w(this,"_currentRender$",new dn(this._currentUnitId)),w(this,"currentRender$",this._currentRender$.asObservable())}get defaultEngine(){return this._defaultEngine}dispose(){this._renderMap.forEach(e=>{this._disposeItem(e)}),this._renderMap.clear(),this._currentRender$.complete()}createRenderWithParent(e,n){const r=this.getRenderById(n);if(r==null)throw new Error("parent render is null");const{scene:i,engine:o}=r,a=this._createRender(e,o,!1),s=a.scene,u=new l_e(e);return u.addSubScene(s),i.addObject(u),a}createRender(e){const n=new l_;return this._createRender(e,n)}_createRender(e,n,r=!0){const i=this.getRenderById(e);let o=!0;i!=null&&i.engine===n&&(o=!1),this._disposeItem(i,o);const{width:a,height:s}=g_e,u=new p_e(v_e+e,n,{width:a,height:s}),l={unitId:e,engine:n,scene:u,mainComponent:null,components:new Map,isMainScene:r};return this.addItem(e,l),l}addItem(e,n){this._renderMap.set(e,n)}removeItem(e){const n=this._renderMap.get(e);n!=null&&this._disposeItem(n),this._renderMap.delete(e)}setCurrent(e){this._currentUnitId=e,this._currentRender$.next(e)}getCurrent(){return this.getRenderById(this._currentUnitId)}getRenderById(e){return this._renderMap.get(e)}getRenderAll(){return this._renderMap}_disposeItem(e,n=!0){if(e==null)return;const{engine:r,scene:i,components:o,mainComponent:a}=e;o==null||o.forEach(s=>{s.dispose()}),a==null||a.dispose(),i.dispose(),n&&r.dispose()}}const Jn=ln("univer.render-manager-service");var __e=Object.defineProperty,C_e=Object.getOwnPropertyDescriptor,S_e=(t,e,n,r)=>{for(var i=r>1?void 0:r?C_e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&__e(e,n,i),i},E_e=(t,e)=>(n,r)=>e(n,r,t);const y_e=ln("univer.render-engine"),D_e="render-engine";var pg;let c_=(pg=class extends b1{constructor(t,e){super(D_e),this._injector=e,this._injector.add([y_e,{useFactory:()=>new l_}]),this._injector.add([Jn,{useClass:b_e}])}},w(pg,"type",Ir.Univer),pg);c_=S_e([E_e(1,K(wn))],c_);class R_e{constructor(){w(this,"enableHorizontal",!0),w(this,"enableVertical",!0),w(this,"horizontalThumbWidth",0),w(this,"horizontalMinusMiniThumb",0),w(this,"horizontalBarWidth",0),w(this,"verticalThumbHeight",0),w(this,"verticalBarHeight",0),w(this,"verticalMinusMiniThumb",0),w(this,"horizonBarRect"),w(this,"horizonThumbRect"),w(this,"verticalBarRect"),w(this,"verticalThumbRect"),w(this,"placeholderBarRect")}get limitX(){var e;return(e=this.horizonThumbRect)!=null&&e.visible?this.horizontalBarWidth-this.horizontalThumbWidth:0}get limitY(){var e;return(e=this.verticalThumbRect)!=null&&e.visible?this.verticalBarHeight-this.verticalThumbHeight:0}get ratioScrollX(){return this.enableHorizontal===!1||this.horizontalThumbWidth===void 0||this.horizontalBarWidth===void 0?1:(this.horizontalThumbWidth-this.horizontalMinusMiniThumb)*this.miniThumbRatioX/this.horizontalBarWidth}get ratioScrollY(){return this.enableVertical===!1||this.verticalThumbHeight===void 0||this.verticalBarHeight===void 0?1:(this.verticalThumbHeight-this.verticalMinusMiniThumb)*this.miniThumbRatioY/this.verticalBarHeight}get miniThumbRatioX(){const e=this.horizontalBarWidth-this.horizontalThumbWidth;if(e===0)return 0;const n=this.horizontalBarWidth-(this.horizontalThumbWidth-this.horizontalMinusMiniThumb);return n===0?0:e/n}get miniThumbRatioY(){const e=this.verticalBarHeight-this.verticalThumbHeight;if(e===0)return 0;const n=this.verticalBarHeight-(this.verticalThumbHeight-this.verticalMinusMiniThumb);return n===0?0:e/n}pick(e){var n,r,i,o;return(n=this.horizonThumbRect)!=null&&n.isHit(e)?this.horizonThumbRect:(r=this.verticalThumbRect)!=null&&r.isHit(e)?this.verticalThumbRect:(i=this.horizonBarRect)!=null&&i.isHit(e)?this.horizonBarRect:(o=this.verticalBarRect)!=null&&o.isHit(e)?this.verticalBarRect:null}dispose(){var e,n,r,i,o;(e=this.horizonBarRect)==null||e.dispose(),(n=this.horizonThumbRect)==null||n.dispose(),(r=this.verticalBarRect)==null||r.dispose(),(i=this.verticalThumbRect)==null||i.dispose(),(o=this.placeholderBarRect)==null||o.dispose()}hasHorizonThumb(){var e;return((e=this.horizonThumbRect)==null?void 0:e.visible)||!1}hasVerticalThumb(){var e;return((e=this.verticalThumbRect)==null?void 0:e.visible)||!1}resize(e=0,n=0,r=0,i=0){}makeDirty(e){}render(e,n=0,r=0){}}const b2=17;let n8=class _F extends R_e{constructor(e,n){super(),w(this,"_view"),w(this,"_mainScene"),w(this,"_lastX",-1),w(this,"_lastY",-1),w(this,"_isHorizonMove",!1),w(this,"_isVerticalMove",!1),w(this,"_horizonPointerMoveObserver"),w(this,"_horizonPointerUpObserver"),w(this,"_verticalPointerMoveObserver"),w(this,"_verticalPointerUpObserver"),w(this,"barSize",14),w(this,"barBorder",1),w(this,"thumbMargin",2),w(this,"thumbLengthRatio",1),w(this,"thumbBackgroundColor","#cccccc"),w(this,"thumbHoverBackgroundColor","#b2b2b2"),w(this,"thumbActiveBackgroundColor","#999999"),w(this,"barBackgroundColor","rgba(255,255,255,0.5)"),w(this,"barBorderColor","rgba(255,255,255,0.7)"),e||console.warn("Missing viewport"),this.setProps(n),this._view=e,this._initialScrollRect(),this._view.setScrollBar(this)}static attachTo(e,n){return new _F(e,n)}dispose(){var e,n,r,i;super.dispose(),(e=this._mainScene)==null||e.onPointerMoveObserver.remove(this._horizonPointerMoveObserver),(n=this._mainScene)==null||n.onPointerMoveObserver.remove(this._verticalPointerMoveObserver),(r=this._mainScene)==null||r.onPointerUpObserver.remove(this._horizonPointerUpObserver),(i=this._mainScene)==null||i.onPointerUpObserver.remove(this._verticalPointerUpObserver),this._mainScene=null,this._view.removeScrollBar()}render(e,n=0,r=0){const{scrollX:i,scrollY:o}=this._view;e.save();const a=new l1([1,0,0,1,n,r]).getMatrix();e.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.enableHorizontal&&(this.horizonBarRect.render(e),this.horizonThumbRect.translate(i).render(e)),this.enableVertical&&(this.verticalBarRect.render(e),this.verticalThumbRect.translate(void 0,o).render(e)),this.enableHorizontal&&this.enableVertical&&this.placeholderBarRect.render(e),e.restore()}resize(e=0,n=0,r=0,i=0){var o;e===0&&e===0||(this._resizeHorizontal(e,n,r),this._resizeVertical(e,n,i),this.enableHorizontal&&this.enableVertical&&((o=this.placeholderBarRect)==null||o.transformByState({left:e-this.barSize,top:n-this.barSize,width:this.barSize-this.barBorder,height:this.barSize-this.barBorder})))}makeDirty(e){var n,r,i,o,a;(n=this.horizonBarRect)==null||n.makeDirty(e),(r=this.horizonThumbRect)==null||r.makeDirty(e),(i=this.verticalBarRect)==null||i.makeDirty(e),(o=this.verticalThumbRect)==null||o.makeDirty(e),(a=this.placeholderBarRect)==null||a.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){(this._mainScene||this._view.scene).makeDirty(e)}pick(e){var n,r,i,o;return(n=this.horizonThumbRect)!=null&&n.isHit(e)?this.horizonThumbRect:(r=this.verticalThumbRect)!=null&&r.isHit(e)?this.verticalThumbRect:(i=this.horizonBarRect)!=null&&i.isHit(e)?this.horizonBarRect:(o=this.verticalBarRect)!=null&&o.isHit(e)?this.verticalBarRect:null}setProps(e){if(!e)return;const n=Object.keys(e);n.length!==0&&n.forEach(r=>{e[r]!==void 0&&(this[`${r}`]=e[r])})}_resizeHorizontal(e,n,r){var i,o,a,s,u;this.enableHorizontal&&(this.horizontalMinusMiniThumb=0,this.horizontalBarWidth=e-(this.enableVertical?this.barSize:0)-this.barBorder,this.horizontalThumbWidth=this.horizontalBarWidth*(this.horizontalBarWidth-this.barBorder)/r*this.thumbLengthRatio,this.horizontalThumbWidth<b2&&(this.horizontalMinusMiniThumb=b2-this.horizontalThumbWidth,this.horizontalThumbWidth=b2),(i=this.horizonBarRect)==null||i.transformByState({left:0,top:n-this.barSize,width:this.horizontalBarWidth,height:this.barSize-this.barBorder}),this.horizontalThumbWidth>=e-this.barSize?(o=this.horizonThumbRect)==null||o.setProps({visible:!1}):((a=this.horizonThumbRect)!=null&&a.visible||(s=this.horizonThumbRect)==null||s.setProps({visible:!0}),(u=this.horizonThumbRect)==null||u.transformByState({left:this._view.scrollX,top:n-this.barSize+this.thumbMargin,width:this.horizontalThumbWidth,height:this.barSize-this.thumbMargin*2})))}_resizeVertical(e,n,r){var i,o,a,s,u;this.enableVertical&&(this.verticalMinusMiniThumb=0,this.verticalBarHeight=n-(this.enableHorizontal?this.barSize:0)-this.barBorder,this.verticalThumbHeight=this.verticalBarHeight*this.verticalBarHeight/r*this.thumbLengthRatio,this.verticalThumbHeight<b2&&(this.verticalMinusMiniThumb=b2-this.verticalThumbHeight,this.verticalThumbHeight=b2),(i=this.verticalBarRect)==null||i.transformByState({left:e-this.barSize,top:0,width:this.barSize-this.barBorder,height:this.verticalBarHeight}),this.verticalThumbHeight>=n-this.barSize?(o=this.verticalThumbRect)==null||o.setProps({visible:!1}):((a=this.verticalThumbRect)!=null&&a.visible||(s=this.verticalThumbRect)==null||s.setProps({visible:!0}),(u=this.verticalThumbRect)==null||u.transformByState({left:e-this.barSize+this.thumbMargin,top:this._view.scrollY,width:this.barSize-this.thumbMargin*2,height:this.verticalThumbHeight})))}_initialScrollRect(){this.enableHorizontal&&(this.horizonBarRect=new cn("__horizonBarRect__",{fill:this.barBackgroundColor,strokeWidth:this.barBorder,stroke:this.barBorderColor}),this.horizonThumbRect=new cn("__horizonThumbRect__",{radius:6,fill:this.thumbBackgroundColor})),this.enableVertical&&(this.verticalBarRect=new cn("__verticalBarRect__",{fill:this.barBackgroundColor,strokeWidth:this.barBorder,stroke:this.barBorderColor}),this.verticalThumbRect=new cn("__verticalThumbRect__",{radius:6,fill:this.thumbBackgroundColor})),this.enableHorizontal&&this.enableVertical&&(this.placeholderBarRect=new cn("__placeholderBarRect__",{fill:this.barBackgroundColor,strokeWidth:this.barBorder,stroke:this.barBorderColor})),this._initialVerticalEvent(),this._initialHorizontalEvent()}_initialVerticalEvent(){var e,n,r,i;if(!this.enableVertical)return;const o=this._mainScene||this._view.scene;(e=this.verticalThumbRect)==null||e.on(Zs.PointerEnter,this._hoverFunc(this.thumbHoverBackgroundColor,this.verticalThumbRect)),(n=this.verticalThumbRect)==null||n.on(Zs.PointerLeave,this._hoverFunc(this.thumbBackgroundColor,this.verticalThumbRect)),(r=this.verticalBarRect)==null||r.on(Zs.PointerDown,(a,s)=>{const u=a;this._view.scrollTo({y:u.offsetY-this._view.top-this.verticalThumbHeight/2}),s.stopPropagation()}),(i=this.verticalThumbRect)==null||i.on(Zs.PointerDown,(a,s)=>{const u=a,l=this.verticalThumbRect;this._isVerticalMove=!0,this._lastX=u.offsetX,this._lastY=u.offsetY,l==null||l.setProps({fill:this.thumbActiveBackgroundColor}),o.disableEvent(),this.makeViewDirty(!0),s.stopPropagation()}),this._verticalPointerMoveObserver=o.onPointerMoveObserver.add((a,s)=>{const u=a;this._isVerticalMove&&(this._view.scrollByBar({y:u.offsetY-this._lastY}),this._lastY=u.offsetY)}),this._verticalPointerUpObserver=o.onPointerUpObserver.add((a,s)=>{const u=this.verticalThumbRect;this._isVerticalMove=!1,o.enableEvent(),u==null||u.setProps({fill:this.thumbBackgroundColor}),this.makeViewDirty(!0)})}_hoverFunc(e,n){return(r,i)=>{this._isHorizonMove||this._isVerticalMove||(n.setProps({fill:e}),this.makeViewDirty(!0))}}_initialHorizontalEvent(){var e,n,r,i;if(!this.enableHorizontal)return;const o=this._mainScene||this._view.scene;(e=this.horizonThumbRect)==null||e.on(Zs.PointerEnter,this._hoverFunc(this.thumbHoverBackgroundColor,this.horizonThumbRect)),(n=this.horizonThumbRect)==null||n.on(Zs.PointerLeave,this._hoverFunc(this.thumbBackgroundColor,this.horizonThumbRect)),(r=this.horizonBarRect)==null||r.on(Zs.PointerDown,(a,s)=>{const u=a;this._view.scrollTo({x:u.offsetX-this._view.left-this.horizontalThumbWidth/2}),s.stopPropagation()}),(i=this.horizonThumbRect)==null||i.on(Zs.PointerDown,(a,s)=>{var u;const l=a;this._isHorizonMove=!0,this._lastX=l.offsetX,this._lastY=l.offsetY,(u=this.horizonThumbRect)==null||u.setProps({fill:this.thumbActiveBackgroundColor}),this.makeViewDirty(!0),o.disableEvent(),s.stopPropagation()}),this._horizonPointerMoveObserver=o.onPointerMoveObserver.add((a,s)=>{const u=a;this._isHorizonMove&&(this._view.scrollByBar({x:u.offsetX-this._lastX}),this._lastX=u.offsetX)}),this._horizonPointerUpObserver=o.onPointerUpObserver.add((a,s)=>{const u=this.horizonThumbRect;this._isHorizonMove=!1,o.enableEvent(),u==null||u.setProps({fill:this.thumbBackgroundColor}),this.makeViewDirty(!0)})}};const I_e=3;let Gs=class{constructor(e,n,r){w(this,"scrollX",0),w(this,"scrollY",0),w(this,"actualScrollX",0),w(this,"actualScrollY",0),w(this,"onMouseWheelObserver",new Vn),w(this,"onScrollAfterObserver",new Vn),w(this,"onScrollBeforeObserver",new Vn),w(this,"onScrollStopObserver",new Vn),w(this,"onScrollByBarObserver",new Vn),w(this,"_viewPortKey",""),w(this,"_dirty",!0),w(this,"_topOrigin",0),w(this,"_leftOrigin",0),w(this,"_bottomOrigin",0),w(this,"_rightOrigin",0),w(this,"_widthOrigin"),w(this,"_heightOrigin"),w(this,"_top",0),w(this,"_left",0),w(this,"_bottom",0),w(this,"_right",0),w(this,"_width"),w(this,"_height"),w(this,"_scene"),w(this,"_scrollBar"),w(this,"_isWheelPreventDefaultX",!1),w(this,"_isWheelPreventDefaultY",!1),w(this,"_scrollStopNum",0),w(this,"_preScrollX",0),w(this,"_preScrollY",0),w(this,"_renderClipState",!0),w(this,"_active",!0),w(this,"_paddingStartX",0),w(this,"_paddingEndX",0),w(this,"_paddingStartY",0),w(this,"_paddingEndY",0),w(this,"_isRelativeX",!1),w(this,"_isRelativeY",!1),w(this,"_preViewportBound"),this._viewPortKey=e,this._scene=n,(r==null?void 0:r.active)!=null&&(this._active=r.active),this._scene.addViewport(this),this._setWithAndHeight(r),this._isWheelPreventDefaultX=(r==null?void 0:r.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(r==null?void 0:r.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar()}get scene(){return this._scene}get width(){return this._width}get height(){return this._height}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}get isWheelPreventDefaultX(){return this._isWheelPreventDefaultX}get isWheelPreventDefaultY(){return this._isWheelPreventDefaultY}set width(e){this._width=e}set height(e){this._height=e}get isActive(){return this._active===!1||(this.height||0)<=0||(this.width||0)<=0?!1:this._active}set top(e){var n,r;this._topOrigin=e,this._top=Bu(e,(r=(n=this._scene)==null?void 0:n.getParent())==null?void 0:r.height)}set left(e){var n;this._leftOrigin=e,this._left=Bu(e,(n=this.scene.getParent())==null?void 0:n.width)}set bottom(e){var n;this._bottomOrigin=e,this._bottom=Bu(e,(n=this.scene.getParent())==null?void 0:n.height)}set right(e){var n;this._rightOrigin=e,this._right=Bu(e,(n=this.scene.getParent())==null?void 0:n.width)}enable(){this._active=!0}disable(){this._active=!1}resetSizeAndScrollBar(){this._resizeCacheCanvasAndScrollBar()}setScrollBar(e){this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}removeScrollBar(){this._scrollBar=null}resize(e){Object.keys(e).length!==0&&(this._setWithAndHeight(e),this._resizeCacheCanvasAndScrollBar())}setPadding(e){const{startX:n=0,startY:r=0,endX:i=0,endY:o=0}=e;this._paddingStartX=n,this._paddingEndX=i,this._paddingStartY=r,this._paddingEndY=o,this._resizeCacheCanvasAndScrollBar()}resetPadding(){this.setPadding({startX:0,endX:0,startY:0,endY:0})}makeDirty(e=!0,n=!1){if(this._dirty=e,n){const r=this.scene.getParent();r.classType===qt.SCENE_VIEWER&&r.makeDirty(!0)}}isDirty(){return this._dirty}scrollTo(e,n=!0){return this._scroll(0,e,n)}scrollBy(e,n=!0){return this._scroll(1,e,n)}scrollByBar(e,n=!0){var r,i;this._scroll(1,e,n);const{x:o,y:a}=e;this.onScrollByBarObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:o,y:a,actualScrollX:this.actualScrollX,actualScrollY:this.actualScrollY,limitX:(r=this._scrollBar)==null?void 0:r.limitX,limitY:(i=this._scrollBar)==null?void 0:i.limitY,isTrigger:n})}scrollByOffset(e=0,n=0,r=!0){if(!this._scrollBar||this.isActive===!1)return;const i=e+this._paddingStartX,o=n+this._paddingStartY,a=this.getBarScroll(i,o);return this.scrollBy(a,r)}getBarScroll(e,n){let r=e-this._paddingStartX,i=n-this._paddingStartY;if(this._scrollBar){r*=this._scrollBar.ratioScrollX,i*=this._scrollBar.ratioScrollY;const{scaleX:o,scaleY:a}=this.scene;r*=o,i*=a}else this.scrollX!==void 0&&(r=this.scrollX),this.scrollY!==void 0&&(i=this.scrollY);return{x:r,y:i}}getActualScroll(e,n){let r=e,i=n;if(this._scrollBar){const{scaleX:s,scaleY:u}=this.scene;this._scrollBar.ratioScrollX!==0?(r/=this._scrollBar.ratioScrollX,r/=s):this.actualScrollX!==void 0&&(r=this.actualScrollX),this._scrollBar.ratioScrollY!==0?(i/=this._scrollBar.ratioScrollY,i/=u):this.actualScrollY!==void 0&&(i=this.actualScrollY)}else this.actualScrollX!==void 0&&(r=this.actualScrollX),this.actualScrollY!==void 0&&(i=this.actualScrollY);const{scaleX:o,scaleY:a}=this._scene.getPrecisionScale();return{x:rn(r+this._paddingStartX,o),y:rn(i+this._paddingStartY,a)}}getTransformedScroll(){const e=this.scrollX,n=this.scrollY;return this.getActualScroll(e,n)}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:n,scrollY:r,actualScrollX:i,actualScrollY:o}=e;return n!==void 0&&(this.scrollX=n),r!==void 0&&(this.scrollY=r),i!==void 0&&(this.actualScrollX=i),o!==void 0&&(this.actualScrollY=o),this}getScrollBarTransForm(){const e=l1.create();return e.multiply(l1.create([1,0,0,1,this._left,this._top])),e}render(e,n=[],r=!1){var i;if(this.isActive===!1||this.width==null||this.height==null||this.width<=1||this.height<=1)return;const o=e||((i=this._scene.getEngine())==null?void 0:i.getCanvas().getContext()),a=this._scene.transform.clone();a.multiply(l1.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));const s=o,u=a.getMatrix(),l=this.getScrollBarTransForm().getMatrix();if(s.save(),this._renderClipState){s.beginPath();const{scaleX:d,scaleY:m}=this._getBoundScale(u[0],u[3]);s.rect(this.left,this.top,(this.width||0)*d,(this.height||0)*m),s.clip()}s.transform(u[0],u[1],u[2],u[3],u[4],u[5]);const c=this._calViewportRelativeBounding();n.forEach(d=>{d.render(s,c)}),s.restore(),this._scrollBar&&r&&(s.save(),s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawScrollbar(s),s.restore()),this.makeDirty(!1),this._scrollRendered(),this._preViewportBound=c}getBounding(){return this._calViewportRelativeBounding()}getRelativeVector(e){const n=this.scene.transform.clone().invert(),r=this.getTransformedScroll();return n.applyPoint(e).add(zt.FromArray([r.x,r.y]))}getAbsoluteVector(e){const n=this.scene.transform.clone(),r=this.getTransformedScroll();return n.applyPoint(e.subtract(zt.FromArray([r.x,r.y])))}onMouseWheel(e,n){if(!this._scrollBar||this.isActive===!1)return;let r;if(e.inputIndex===kt.MouseWheelX){const i=Math.abs(e.deltaX),o=this._scene.width,a=(this.width||1)/o*i;e.deltaX>0?r=this.scrollBy({x:a}):r=this.scrollBy({x:-a}),this._scene.getParent().classType===qt.SCENE_VIEWER?r!=null&&r.isLimitedX||n.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():r!=null&&r.isLimitedX||e.preventDefault()}if(e.inputIndex===kt.MouseWheelY){const i=Math.abs(e.deltaY),o=this._scene.height;let a=(this.height||1)/o*i;e.shiftKey?(a*=I_e,e.deltaY>0?r=this.scrollBy({x:a}):r=this.scrollBy({x:-a}),this._scene.getParent().classType===qt.SCENE_VIEWER?r!=null&&r.isLimitedX||n.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():r!=null&&r.isLimitedX||e.preventDefault()):(e.deltaY>0?r=this.scrollBy({y:a}):r=this.scrollBy({y:-a}),this._scene.getParent().classType===qt.SCENE_VIEWER?r!=null&&r.isLimitedY||n.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():r!=null&&r.isLimitedY||e.preventDefault())}e.inputIndex,kt.MouseWheelZ,this._scene.makeDirty(!0)}isHit(e){if(this.isActive===!1)return;const{width:n,height:r}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+(n||0)&&e.y>=this.top&&e.y<=this.top+(r||0)}pickScrollBar(e){if(!this._scrollBar)return;const n=this.getScrollBarTransForm().invert().applyPoint(e);return this._scrollBar.pick(n)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var e;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),(e=this._scrollBar)==null||e.dispose(),this._scene.removeViewport(this._viewPortKey)}limitedScroll(){var e,n;if(!this._scrollBar)return;const r=(e=this._scrollBar)==null?void 0:e.limitX,i=(n=this._scrollBar)==null?void 0:n.limitY;let o=!0,a=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>r?this.scrollX=r:o=!1,this.scrollY<0?this.scrollY=0:this.scrollY>i?this.scrollY=i:a=!1,{isLimitedX:o,isLimitedY:a}}_resizeCacheCanvasAndScrollBar(){const e=this.actualScrollX,n=this.actualScrollY,{width:r,height:i}=this._getViewPortSize(),o=(this._scene.width-this._paddingEndX)*this._scene.scaleX,a=(this._scene.height-this._paddingEndY)*this._scene.scaleY;if(this._scrollBar){this._scrollBar.resize(r,i,o,a);const{x:s,y:u}=this.getBarScroll(e,n);this.scrollTo({x:s,y:u})}this.makeDirty(!0)}_getViewPortSize(){const e=this._scene.getParent(),{width:n,height:r}=e,{scaleX:i=1,scaleY:o=1}=this._scene;let a,s,u=this.left*i,l=this.top*o;return this._leftOrigin!=null&&(u=this._leftOrigin*i),this._topOrigin!=null&&(l=this._topOrigin*o),this._widthOrigin!=null?a=this._widthOrigin*i:(a=n-(u+this._right),this.width=a),this._heightOrigin!=null?s=this._heightOrigin*o:(s=r-(l+this._bottom),this.height=s),this._left=u,this._top=l,{width:a,height:s}}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_triggerScrollStop(e,n,r,i=!0){clearTimeout(this._scrollStopNum),this._scrollStopNum=setTimeout(()=>{var o,a;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:r,actualScrollX:e.x,actualScrollY:e.y,limitX:(o=this._scrollBar)==null?void 0:o.limitX,limitY:(a=this._scrollBar)==null?void 0:a.limitY,isTrigger:i})},2)}_scroll(e,n,r=!0){var i,o,a,s;const{x:u,y:l}=n;if(this._scrollBar==null)return;u!==void 0&&(this._scrollBar.hasHorizonThumb()?e===1?this.scrollX+=u:this.scrollX=u:this.scrollX=0),l!==void 0&&(this._scrollBar.hasVerticalThumb()?e===1?this.scrollY+=l:this.scrollY=l:this.scrollY=0);const c=this.limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:u,y:l,limitX:(i=this._scrollBar)==null?void 0:i.limitX,limitY:(o=this._scrollBar)==null?void 0:o.limitY,isTrigger:r}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const d=this.getTransformedScroll();return this.actualScrollX=d.x,this.actualScrollY=d.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:u,y:l,actualScrollX:d.x,actualScrollY:d.y,limitX:(a=this._scrollBar)==null?void 0:a.limitX,limitY:(s=this._scrollBar)==null?void 0:s.limitY,isTrigger:r}),this._triggerScrollStop(d,u,l,r),c}_calViewportRelativeBounding(){var e;if(this.isActive===!1)return{viewBound:{left:-1,top:-1,right:-1,bottom:-1},diffBounds:[],diffX:-1,diffY:-1,viewPortPosition:{top:0,left:0,bottom:0,right:0},viewPortKey:this.viewPortKey};const n=this._scene.transform.clone().getMatrix(),r=this._isRelativeX&&n[0]<1?n[0]:1,i=this._isRelativeY&&n[3]<1?n[3]:1,o=this._isRelativeX?1:n[0]<1?n[0]:1,a=this._isRelativeY?1:n[3]<1?n[3]:1;let s=this._width,u=this._height;const l=this._getViewPortSize();n[0]>1&&(s=l.width),n[3]>1&&(u=l.height);const c=this.left*r,d=((s||0)+this.left)*o,m=this.top*i,f=((u||0)+this.top)*a,h=this.getRelativeVector(zt.FromArray([c,m])),p=this.getRelativeVector(zt.FromArray([d,f])),v={top:h.y,left:h.x,right:p.x,bottom:p.y},g=(e=this._preViewportBound)==null?void 0:e.viewBound;return{viewBound:v,diffBounds:this._diffViewBound(v,g),diffX:((g==null?void 0:g.left)||0)-v.left,diffY:((g==null?void 0:g.top)||0)-v.top,viewPortPosition:{top:m,left:c,bottom:f,right:d},viewPortKey:this.viewPortKey}}_diffViewBound(e,n){if(n==null)return[e];const r={startRow:e.top,endRow:e.bottom,startColumn:e.left,endColumn:e.right},i={startRow:n.top,endRow:n.bottom,startColumn:n.left,endColumn:n.right};return ht.subtract(r,i).map(o=>{const{startRow:a,endRow:s,startColumn:u,endColumn:l}=o;return{left:u,top:a,right:l,bottom:s}})}_drawScrollbar(e){if(!this._scrollBar)return;const n=this._scene.getParent();n.classType===qt.SCENE_VIEWER?this._scrollBar.render(e):n.classType===qt.ENGINE&&this._scrollBar.render(e)}_setWithAndHeight(e){this.top=(e==null?void 0:e.top)||0,this.left=(e==null?void 0:e.left)||0,this.bottom=(e==null?void 0:e.bottom)||0,this.right=(e==null?void 0:e.right)||0,Ie.isDefine(e==null?void 0:e.width)?(this.width=e==null?void 0:e.width,this._widthOrigin=this.width,this._isRelativeX=!1):(this.width=null,this._widthOrigin=null,this._isRelativeX=!0),Ie.isDefine(e==null?void 0:e.height)?(this.height=e==null?void 0:e.height,this._heightOrigin=this.height,this._isRelativeY=!1):(this.height=null,this._heightOrigin=null,this._isRelativeY=!0)}_getBoundScale(e,n){return e=this._isRelativeX&&e<1?1:e,n=this._isRelativeY&&n<1?1:n,{scaleX:e,scaleY:n}}};var A_e=Object.defineProperty,T_e=(t,e,n)=>e in t?A_e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Tn=(t,e,n)=>(T_e(t,typeof e!="symbol"?e+"":e,n),n);function r8(t,e){const n=t.getCurrentUniverDocInstance().getUnitId(),r=e.getRenderById(n);if(r==null)return;const{mainComponent:i,scene:o,engine:a}=r;return{document:i,scene:o,engine:a}}function w_e(t,e){const n=e.getRenderById(t);if(n==null)return;const{mainComponent:r,scene:i,engine:o}=n;return{document:r,scene:i,engine:o}}var d_=(t=>(t.MAIN="__Document_Render_Main__",t))(d_||{}),x0=(t=>(t.VIEW_MAIN="viewMain",t.VIEW_TOP="viewTop",t.VIEW_LEFT="viewLeft",t.VIEW_LEFT_TOP="viewLeftTop",t))(x0||{});const m_=0,L_e=2,O_e=10,wo={id:"doc.operation.set-selections",type:ue.OPERATION,handler:(t,e)=>!0};var P_e=Object.defineProperty,M_e=Object.getOwnPropertyDescriptor,N_e=(t,e,n,r)=>{for(var i=r>1?void 0:r?M_e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&P_e(e,n,i),i},gA=(t,e)=>(n,r)=>e(n,r,t);function _9(t){const{startOffset:e,endOffset:n,collapsed:r}=t;return{startOffset:e,endOffset:n,collapsed:r}}let kr=class extends Ro{constructor(t,e){super(),Tn(this,"_currentSelection",null),Tn(this,"_textSelectionInfo",new Map),Tn(this,"_textSelection$",new dn(null)),Tn(this,"textSelection$",this._textSelection$.asObservable()),this._textSelectionRenderManager=t,this._commandService=e,this._syncSelectionFromRenderService()}getCurrentSelection(){return this._currentSelection}getCurrentSelectionInfo(){return this._getTextRanges(this._currentSelection)}dispose(){this._textSelection$.complete()}refreshSelection(){this._currentSelection!=null&&this._refresh(this._currentSelection)}setCurrentSelection(t){this._currentSelection=t,this._refresh(t)}setCurrentSelectionNotRefresh(t){this._currentSelection=t}getSelections(){var t;return(t=this._getTextRanges(this._currentSelection))==null?void 0:t.textRanges}getActiveRange(){const t=this._getTextRanges(this._currentSelection);if(t==null)return;const{textRanges:e,segmentId:n,style:r}=t,i=e.find(d=>d.isActive());if(i==null)return null;const{startOffset:o,endOffset:a,collapsed:s,startNodePosition:u,endNodePosition:l,direction:c}=i;return o==null||a==null?null:{startOffset:o,endOffset:a,collapsed:s,startNodePosition:u,endNodePosition:l,direction:c,segmentId:n,style:r}}add(t){this._currentSelection!=null&&this._addByParam({...this._currentSelection,textRanges:t,segmentId:"",style:Am})}replaceTextRanges(t){this._currentSelection!=null&&(this._textSelectionRenderManager.removeAllTextRanges(),this._textSelectionRenderManager.addTextRanges(t))}_syncSelectionFromRenderService(){this._textSelectionRenderManager.textSelectionInner$.pipe(Fi(this.dispose$)).subscribe(t=>{t!=null&&this._replaceTextRangesWithNoRefresh(t)})}_replaceTextRangesWithNoRefresh(t){if(this._currentSelection==null)return;const e={...this._currentSelection,...t};this._replaceByParam(e),this._textSelection$.next(e);const{unitId:n,subUnitId:r,segmentId:i,style:o,textRanges:a}=e;this._commandService.executeCommand(wo.id,{unitId:n,subUnitId:r,segmentId:i,style:o,ranges:a.map(_9)})}_getTextRanges(t){var e;if(t==null)return;const{unitId:n,subUnitId:r=""}=t;return(e=this._textSelectionInfo.get(n))==null?void 0:e.get(r)}_refresh(t){const e=this._getTextRanges(t);this._textSelectionRenderManager.removeAllTextRanges(),e&&Array.isArray(e.textRanges)&&e.textRanges.length&&this._textSelectionRenderManager.addTextRanges(e.textRanges.map(_9))}_replaceByParam(t){const{unitId:e,subUnitId:n,style:r,segmentId:i,textRanges:o}=t;this._textSelectionInfo.has(e)||this._textSelectionInfo.set(e,new Map),this._textSelectionInfo.get(e).set(n,{textRanges:o,style:r,segmentId:i})}_addByParam(t){const{unitId:e,subUnitId:n,textRanges:r,style:i,segmentId:o}=t;this._textSelectionInfo.has(e)||this._textSelectionInfo.set(e,new Map);const a=this._textSelectionInfo.get(e);a.has(n)?a.get(n).textRanges.push(...r):a.set(n,{textRanges:r,style:i,segmentId:o})}};kr=N_e([gA(0,To),gA(1,se)],kr);function DE(t,e="",n=0){const{startOffset:r,endOffset:i}=t,o=[],a=r-n,s=i-n;return a>0&&o.push({t:jt.RETAIN,len:a,segmentId:e}),o.push({t:jt.DELETE,len:s-a,line:0,segmentId:e}),o}var x_e=Object.defineProperty,F_e=Object.getOwnPropertyDescriptor,$_e=(t,e,n,r)=>{for(var i=r>1?void 0:r?F_e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&x_e(e,n,i),i},k_e=(t,e)=>(n,r)=>e(n,r,t);let tu=class extends Ro{constructor(e){super(),Tn(this,"_currentViewModelUnitId",""),Tn(this,"_docViewModelMap",new Map),Tn(this,"_currentDocViewModel$",new dn(null)),Tn(this,"currentDocViewModel$",this._currentDocViewModel$.asObservable()),this._currentUniverService=e,this._initialize()}_initialize(){this._currentUniverService.currentDoc$.pipe(Fi(this.dispose$)).subscribe(e=>{if(e==null)return;const n=e.getUnitId();this._setCurrent(n)})}dispose(){this._currentDocViewModel$.complete(),this._docViewModelMap.clear()}getCurrent(){return this._docViewModelMap.get(this._currentViewModelUnitId)}getViewModel(e){var n;return(n=this._docViewModelMap.get(e))==null?void 0:n.docViewModel}_setCurrent(e){var n;const r=this._currentUniverService.getUniverDocInstance(e);if(r==null)throw new Error(`Document data model with id ${e} not found when build view model.`);if(r.getBody()!=null){if(!this._docViewModelMap.has(e)){const i=this._buildDocViewModel(r);this._docViewModelMap.set(e,{unitId:e,docViewModel:i})}if(e===Qr){const i=(n=this._docViewModelMap.get(e))==null?void 0:n.docViewModel;if(i==null)return;i.reset(r)}this._currentViewModelUnitId=e,this._currentDocViewModel$.next(this.getCurrent())}}_buildDocViewModel(e){return new u_(e)}};tu=$_e([k_e(0,ae)],tu);var B_e=Object.defineProperty,U_e=Object.getOwnPropertyDescriptor,V_e=(t,e,n,r)=>{for(var i=r>1?void 0:r?U_e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&B_e(e,n,i),i},gg=(t,e)=>(n,r)=>e(n,r,t);const H_e=300;let C9=class extends Ro{constructor(e,n,r){super(),Tn(this,"_docStateChange$",new dn(null)),Tn(this,"docStateChange$",this._docStateChange$.asObservable()),Tn(this,"_stateCache",new Map),Tn(this,"_timer",null),this._undoRedoService=e,this._commandService=n,this._univerInstanceService=r,this._initialize()}setChangeState(e){const{trigger:n,noHistory:r}=e;n!=null&&(this._cacheChangeState(e),r||this._docStateChange$.next(e))}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===Tv||e.id===Av){const n=this._univerInstanceService.getCurrentUniverDocInstance();if(n==null)return;const r=n.getUnitId();this._pushHistory(r)}}))}_cacheChangeState(e){const{trigger:n,unitId:r,noHistory:i}=e;if(!(n===Av||n===Tv||i)){if(this._stateCache.has(r)){const o=this._stateCache.get(r);o==null||o.push(e)}else this._stateCache.set(r,[e]);n===o8.id||n===a8.id?(this._timer&&clearTimeout(this._timer),this._timer=setTimeout(()=>{this._pushHistory(r)},H_e)):this._pushHistory(r)}}_pushHistory(e){const n=this._undoRedoService,r=this._stateCache.get(e);if(!Array.isArray(r)||r.length===0)return;const i=r.length,o=r[0].commandId,a=r[0],s=r[i-1],u={unitId:e,actions:r.reduce((c,d)=>Go.compose(c,d.redoState.actions),[]),textRanges:s.redoState.textRanges},l={unitId:e,actions:r.reverse().reduce((c,d)=>Go.compose(c,d.undoState.actions),[]),textRanges:a.undoState.textRanges};n.pushUndoRedo({unitID:e,undoMutations:[{id:o,params:l}],redoMutations:[{id:o,params:u}]}),r.length=0}};C9=V_e([gg(0,K(en)),gg(1,se),gg(2,ae)],C9);let i8=class{constructor(){Tn(this,"_previousActiveRange",null),Tn(this,"_undoMutationParamsCache",[]),Tn(this,"_redoMutationParamsCache",[])}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:n=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=n}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,n){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null||this._redoMutationParamsCache.length===0)return null;const{unitId:e}=this._undoMutationParamsCache[0],n={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((r,i)=>Go.compose(r,i.actions),[]),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((r,i)=>Go.compose(r,i.actions),[]),textRanges:[]},undoMutationParams:n,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}};const vA="doc.mutation.rich-text-editing",Lo={id:vA,type:ue.MUTATION,handler:(t,e)=>{var n;const{unitId:r,actions:i,textRanges:o,prevTextRanges:a,trigger:s,noHistory:u,isCompositionEnd:l,noNeedSetTextRange:c}=e,d=t.get(ae).getUniverDocInstance(r),m=t.get(tu).getViewModel(r),f=t.get(kr),h=((n=f.getSelections())!=null?n:[]).map(_9),p=t.get(C9),v=t.get(i8);if(d==null||m==null)throw new Error(`DocumentDataModel or documentViewModel not found for unitId: ${r}`);if(i.length===0)throw new Error("Mutation's length should great than 0 when call RichTextEditingMutation");const g=d.apply(i),{segmentId:b}=i[0],C=d.getSelfOrHeaderFooterModel(b);m.getSelfOrHeaderFooterViewModel(b).reset(C),!c&&o&&queueMicrotask(()=>{f.replaceTextRanges(o)});const S={commandId:vA,unitId:r,trigger:s,noHistory:u,redoState:{actions:i,textRanges:o},undoState:{actions:g,textRanges:a??h}};if(l){const E=v.fetchComposedUndoRedoMutationParams();if(E==null)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams:y,redoMutationParams:D,previousActiveRange:R}=E;S.redoState.actions=D.actions,S.undoState.actions=y.actions,S.undoState.textRanges=[R]}return p.setChangeState(S),{unitId:r,actions:g,textRanges:h}}},o8={id:"doc.command.insert-text",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(se),{range:r,segmentId:i,body:o,unitId:a,textRanges:s}=e,{startOffset:u,collapsed:l}=r,c={id:Lo.id,params:{unitId:a,actions:[],textRanges:s}},d=new Go;return l?u>0&&d.push({t:jt.RETAIN,len:u,segmentId:i}):d.push(...DE(r,i)),d.push({t:jt.INSERT,body:o,len:o.dataStream.length,line:0,segmentId:i}),c.params.actions=d.serialize(),!!n.syncExecuteCommand(c.id,c.params)}};var Ju=(t=>(t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t))(Ju||{});const a8={id:"doc.command.delete-text",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(se),{range:r,segmentId:i,unitId:o,direction:a,textRanges:s,len:u=1}=e,{startOffset:l}=r,c={id:Lo.id,params:{unitId:o,actions:[],textRanges:s}},d=new Go;return l>0&&d.push({t:jt.RETAIN,len:a===0?l-u:l,segmentId:i}),d.push({t:jt.DELETE,len:u,line:0,segmentId:i}),c.params.actions=d.serialize(),!!n.syncExecuteCommand(c.id,c.params)}},CF={id:"doc.command.update-text",type:ue.COMMAND,handler:async(t,e)=>{const{range:n,segmentId:r,updateBody:i,coverType:o,unitId:a,textRanges:s}=e,u=t.get(se),l={id:Lo.id,params:{unitId:a,actions:[],textRanges:s}},c=new Go,{startOffset:d,endOffset:m}=n;return c.push({t:jt.RETAIN,len:d,segmentId:r}),c.push({t:jt.RETAIN,body:i,len:m-d,segmentId:r,coverType:o}),l.params.actions=c.serialize(),!!u.syncExecuteCommand(l.id,l.params)}};function j_e(t,e){const n=[];for(let r=0,i=t.length;r<i;r++)t[r]===mn.PARAGRAPH&&n.push({startIndex:r});if(e)for(const r of n)e.bullet&&(r.bullet=Ie.deepClone(e.bullet)),e.paragraphStyle&&(r.paragraphStyle=Ie.deepClone(e.paragraphStyle));return n}const RE={id:"doc.command.break-line",type:ue.COMMAND,handler:async t=>{var e,n;const r=t.get(kr),i=t.get(ae),o=t.get(se),a=r.getActiveRange();if(a==null)return!1;const s=i.getCurrentUniverDocInstance(),u=s.getUnitId(),{startOffset:l,segmentId:c,style:d}=a,m=[{startOffset:l+1,endOffset:l+1,style:d}],f=((n=(e=s.getBody())==null?void 0:e.paragraphs)!=null?n:[]).find(h=>h.startIndex>=l);return await o.executeCommand(o8.id,{unitId:u,body:{dataStream:mn.PARAGRAPH,paragraphs:j_e(mn.PARAGRAPH,f)},range:a,textRanges:m,segmentId:c})}};var z_e=Object.defineProperty,W_e=Object.getOwnPropertyDescriptor,Y_e=(t,e,n,r)=>{for(var i=r>1?void 0:r?W_e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&z_e(e,n,i),i},bA=(t,e)=>(n,r)=>e(n,r,t);let Zo=class extends Ro{constructor(e,n){super(),Tn(this,"_currentSkeletonUnitId",""),Tn(this,"_docSkeletonMap",new Map),Tn(this,"_currentSkeleton$",new dn(null)),Tn(this,"currentSkeleton$",this._currentSkeleton$.asObservable()),Tn(this,"_currentSkeletonBefore$",new dn(null)),Tn(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable()),this._localeService=e,this._docViewModelManagerService=n,this._initialize()}_initialize(){this._docViewModelManagerService.currentDocViewModel$.pipe(Fi(this.dispose$)).subscribe(e=>{e!=null&&this._setCurrent(e)})}dispose(){this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete(),this._docSkeletonMap.clear()}getCurrent(){return this.getSkeletonByUnitId(this._currentSkeletonUnitId)}makeDirtyCurrent(e=!0){this.makeDirty(this._currentSkeletonUnitId,e)}makeDirty(e,n=!0){const r=this.getSkeletonByUnitId(e);r!=null&&(r.dirty=n)}getSkeletonByUnitId(e){return this._docSkeletonMap.get(e)}_setCurrent(e){const{unitId:n}=e;if(this._docSkeletonMap.has(n)){const r=this.getSkeletonByUnitId(n);r.skeleton.calculate(),r.dirty=!0}else{const r=this._buildSkeleton(e.docViewModel);r.calculate(),this._docSkeletonMap.set(n,{unitId:n,skeleton:r,dirty:!1})}return this._currentSkeletonUnitId=n,this._currentSkeletonBefore$.next(this.getCurrent()),this._currentSkeleton$.next(this.getCurrent()),this.getCurrent()}_buildSkeleton(e){return Om.create(e,this._localeService)}};Zo=Y_e([bA(0,K(Gt)),bA(1,K(tu))],Zo);const SF={id:"doc.command.inner-paste",type:ue.COMMAND,handler:async(t,e)=>{const{segmentId:n,body:r,textRanges:i}=e,o=t.get(se),a=t.get(kr),s=t.get(ae),u=a.getSelections();if(!Array.isArray(u)||u.length===0)return!1;const l=s.getCurrentUniverDocInstance().getUnitId(),c={id:Lo.id,params:{unitId:l,actions:[],textRanges:i}},d=new Xm;d.reset();const m=new Go;for(const f of u){const{startOffset:h,endOffset:p,collapsed:v}=f,g=h-d.cursor;v?m.push({t:jt.RETAIN,len:g,segmentId:n}):m.push(...DE(f,n,d.cursor)),m.push({t:jt.INSERT,body:r,len:r.dataStream.length,line:0,segmentId:n}),d.reset(),d.moveCursor(p)}return c.params.actions=m.serialize(),!!o.syncExecuteCommand(c.id,c.params)}},s8={id:"doc.command.inner-cut",type:ue.COMMAND,handler:async(t,e)=>{const{segmentId:n,textRanges:r}=e,i=t.get(se),o=t.get(kr),a=t.get(ae),s=o.getSelections();if(!Array.isArray(s)||s.length===0)return!1;const u=a.getCurrentUniverDocInstance().getUnitId(),l=a.getUniverDocInstance(u),c=h4(l.snapshot,n);if(c==null)return!1;const d={id:Lo.id,params:{unitId:u,actions:[],textRanges:r}},m=new Xm;m.reset();const f=new Go;for(const h of s){const{startOffset:p,endOffset:v,collapsed:g}=h,b=p-m.cursor;g?f.push({t:jt.RETAIN,len:b,segmentId:n}):f.push(...X_e(h,c,n,m.cursor)),m.reset(),m.moveCursor(v)}return d.params.actions=f.serialize(),!!i.syncExecuteCommand(d.id,d.params)}};function X_e(t,e,n="",r=0){const{startOffset:i,endOffset:o}=t,a=[],{paragraphs:s=[]}=e,u=i-r,l=o-r,c=s==null?void 0:s.find(d=>d.startIndex-r>=u&&d.startIndex-r<=l);if(u>0&&a.push({t:jt.RETAIN,len:u,segmentId:n}),c&&c.startIndex-r>u){const d=c.startIndex-r;a.push({t:jt.DELETE,len:d-u,line:0,segmentId:n}),a.push({t:jt.RETAIN,len:1,segmentId:n}),l>d+1&&a.push({t:jt.DELETE,len:l-d-1,line:0,segmentId:n})}else a.push({t:jt.DELETE,len:l-u,line:0,segmentId:n});return a}const IE={id:"doc.command.delete-left",type:ue.COMMAND,handler:async t=>{var e;const n=t.get(kr),r=t.get(Zo),i=t.get(ae),o=t.get(se),a=n.getActiveRange(),s=n.getSelections(),u=(e=r.getCurrent())==null?void 0:e.skeleton;let l=!0;if(a==null||u==null||s==null)return!1;const c=i.getCurrentUniverDocInstance(),{startOffset:d,collapsed:m,segmentId:f,style:h}=a,p=u.findNodeByCharIndex(d),v=cge(p),g=dge(p,c.getBody());let b=d;const C=u.findNodeByCharIndex(d-1);if(mge(p)&&C!==p&&(v===!0||g===!0)){const S=Fx(p,c.getBody());if(S==null)return!1;const E=S==null?void 0:S.startIndex,y={startIndex:0},D=S.paragraphStyle;if(v===!0){const I=S.paragraphStyle;I&&(y.paragraphStyle=I)}else if(g===!0){const I=S.bullet;I&&(y.bullet=I),D!=null&&(y.paragraphStyle={...D},delete y.paragraphStyle.hanging,delete y.paragraphStyle.indentStart)}const R=[{startOffset:b,endOffset:b,style:h}];l=await o.executeCommand(CF.id,{unitId:c.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...y}]},range:{startOffset:E,endOffset:E+1},textRanges:R,coverType:Ii.REPLACE,segmentId:f})}else if(m===!0){if(C==null)return!0;if(C.content==="\r")l=await o.executeCommand(AE.id,{direction:Ju.LEFT,range:a});else{b-=C.count;const S=[{startOffset:b,endOffset:b,style:h}];l=await o.executeCommand(a8.id,{unitId:c.getUnitId(),range:a,segmentId:f,direction:Ju.LEFT,len:C.count,textRanges:S})}}else{const S=yF(a,s);l=await o.executeCommand(s8.id,{segmentId:f,textRanges:S})}return l}},EF={id:"doc.command.delete-right",type:ue.COMMAND,handler:async t=>{var e;const n=t.get(kr),r=t.get(Zo),i=t.get(ae),o=t.get(se),a=n.getActiveRange(),s=n.getSelections(),u=(e=r.getCurrent())==null?void 0:e.skeleton;let l;if(a==null||u==null||s==null)return!1;const c=i.getCurrentUniverDocInstance(),{startOffset:d,collapsed:m,segmentId:f,style:h}=a;if(d===c.getBody().dataStream.length-2&&m)return!0;if(m===!0){const p=u.findNodeByCharIndex(d);if(p.content==="\r")l=await o.executeCommand(AE.id,{direction:Ju.RIGHT,range:a});else{const v=[{startOffset:d,endOffset:d,style:h}];l=await o.executeCommand(a8.id,{unitId:c.getUnitId(),range:a,segmentId:f,direction:Ju.RIGHT,textRanges:v,len:p.count})}}else{const p=yF(a,s);l=await o.executeCommand(s8.id,{segmentId:f,textRanges:p})}return l}},AE={id:"doc.command.merge-two-paragraph",type:ue.COMMAND,handler:async(t,e)=>{var n,r,i;const o=t.get(kr),a=t.get(ae),s=t.get(se);t.get(en);const{direction:u,range:l}=e,c=o.getActiveRange(),d=o.getSelections();if(c==null||d==null)return!1;const m=a.getCurrentUniverDocInstance(),{startOffset:f,collapsed:h,segmentId:p,style:v}=c;if(!h)return!1;const g=u===Ju.LEFT?f:f+1,b=(i=(r=(n=m.getBody())==null?void 0:n.paragraphs)==null?void 0:r.find(I=>I.startIndex>=g))==null?void 0:i.startIndex,C=q_e(m.getBody(),g,b),S=u===Ju.LEFT?f-1:f,E=m.getUnitId(),y=[{startOffset:S,endOffset:S,style:v}],D={id:Lo.id,params:{unitId:E,actions:[],textRanges:y,prevTextRanges:[l]}},R=new Go;return R.push({t:jt.RETAIN,len:u===Ju.LEFT?f-1:f,segmentId:p}),C.dataStream.length&&R.push({t:jt.INSERT,body:C,len:C.dataStream.length,line:0,segmentId:p}),R.push({t:jt.RETAIN,len:1,segmentId:p}),R.push({t:jt.DELETE,len:b+1-g,line:0,segmentId:p}),D.params.actions=R.serialize(),!!s.syncExecuteCommand(D.id,D.params)}};function q_e(t,e,n){const{textRuns:r}=t,i=t.dataStream.substring(e,n);if(r==null)return{dataStream:i};const o=[];for(const a of r){const{st:s,ed:u}=a;u<=e||s>=n||(s<e?o.push({...a,st:0,ed:u-e}):u>n?o.push({...a,st:s-e,ed:n-e}):o.push({...a,st:s-e,ed:u-e}))}return{dataStream:i,textRuns:o}}function yF(t,e){let n=t.endOffset;for(const r of e){const{startOffset:i,endOffset:o}=r;i==null||o==null||o<=t.endOffset&&(n-=o-i)}return[{startOffset:n,endOffset:n,style:t.style}]}const DF={id:"doc.command.ime-input",type:ue.COMMAND,handler:async(t,e)=>{const{unitId:n,newText:r,oldTextLen:i,isCompositionEnd:o,isCompositionStart:a}=e,s=t.get(se),u=t.get(i8),l=u.getActiveRange();if(l==null)return!1;const{startOffset:c,style:d,segmentId:m}=l,f=r.length,h=[{startOffset:c+f,endOffset:c+f,collapsed:!0,style:d}],p={id:Lo.id,params:{unitId:n,actions:[],textRanges:h}},v=new Go;!l.collapsed&&a?v.push(...DE(l,m)):v.push({t:jt.RETAIN,len:c,segmentId:m}),i>0&&v.push({t:jt.DELETE,len:i,line:0,segmentId:m}),v.push({t:jt.INSERT,body:{dataStream:r},len:r.length,line:0,segmentId:m}),p.params.actions=v.serialize(),p.params.noHistory=!o,p.params.isCompositionEnd=o;const g=s.syncExecuteCommand(p.id,p.params);return u.pushUndoRedoMutationParams(g,p.params),!!g}},od={id:"doc.command.set-inline-format-bold",type:ue.COMMAND,handler:async()=>!0},ad={id:"doc.command.set-inline-format-italic",type:ue.COMMAND,handler:async()=>!0},sd={id:"doc.command.set-inline-format-underline",type:ue.COMMAND,handler:async()=>!0},ud={id:"doc.command.set-inline-format-strikethrough",type:ue.COMMAND,handler:async()=>!0},ol={id:"doc.command.set-inline-format-subscript",type:ue.COMMAND,handler:async()=>!0},ld={id:"doc.command.set-inline-format-superscript",type:ue.COMMAND,handler:async()=>!0},Tc={id:"doc.command.set-inline-format-fontsize",type:ue.COMMAND,handler:async()=>!0},wc={id:"doc.command.set-inline-format-font-family",type:ue.COMMAND,handler:async()=>!0},Lc={id:"doc.command.set-inline-format-text-color",type:ue.COMMAND,handler:async()=>!0},RF={[od.id]:"bl",[ad.id]:"it",[sd.id]:"ul",[ud.id]:"st",[Tc.id]:"fs",[wc.id]:"ff",[Lc.id]:"cl",[ol.id]:"va",[ld.id]:"va"},_a={id:"doc.command.set-inline-format",type:ue.COMMAND,handler:async(t,e)=>{const{segmentId:n,value:r,preCommandId:i}=e,o=t.get(se),a=t.get(kr),s=t.get(ae),u=a.getSelections();if(!Array.isArray(u)||u.length===0)return!1;let l=s.getCurrentUniverDocInstance(),c=l.getUnitId();c===qn&&(l=s.getUniverDocInstance(Qr),c=l.getUnitId());let d;switch(i){case od.id:case ad.id:case sd.id:case ud.id:case ol.id:case ld.id:{d=K_e(l.getBody().textRuns,i,u);break}case Tc.id:case wc.id:{d=r;break}case Lc.id:{d={rgb:r};break}default:throw new Error(`Unknown command: ${i} in handleInlineFormat`)}const m={id:Lo.id,params:{unitId:c,actions:[],textRanges:u}},f=new Go,h=new Xm;h.reset();for(const p of u){const{startOffset:v,endOffset:g}=p,b={dataStream:"",textRuns:[{st:0,ed:g-v,ts:{[RF[i]]:d}}]},C=v-h.cursor;C!==0&&f.push({t:jt.RETAIN,len:C,segmentId:n}),f.push({t:jt.RETAIN,body:b,len:g-v,segmentId:n}),h.reset(),h.moveCursor(g)}return m.params.actions=f.serialize(),!!o.syncExecuteCommand(m.id,m.params)}};function G_e(t){return t!==null&&typeof t=="object"}function K_e(t,e,n){let r=0,i=0;const o=RF[e];for(;r!==t.length&&i!==n.length;){const{startOffset:a,endOffset:s}=n[i],{st:u,ed:l,ts:c}=t[r];if(s<=u)i++;else if(l<=a)r++;else{if(/bl|it/.test(o))return(c==null?void 0:c[o])===we.TRUE?we.FALSE:we.TRUE;if(/ul|st/.test(o))return G_e(c==null?void 0:c[o])&&(c==null?void 0:c[o]).s===we.TRUE?{s:we.FALSE}:{s:we.TRUE};if(/va/.test(o))return e===ol.id?(c==null?void 0:c[o])===yr.SUBSCRIPT?yr.NORMAL:yr.SUBSCRIPT:(c==null?void 0:c[o])===yr.SUPERSCRIPT?yr.NORMAL:yr.SUPERSCRIPT;r++}}return/bl|it/.test(o)?we.TRUE:/ul|st/.test(o)?{s:we.TRUE}:e===ol.id?yr.SUBSCRIPT:yr.SUPERSCRIPT}const TE={id:"doc.command.list-operation",type:ue.COMMAND,handler:(t,e)=>{var n,r,i;const o=t.get(kr),a=t.get(ae),s=t.get(se),{listType:u}=e,l=a.getCurrentUniverDocInstance(),c=o.getActiveRange(),d=(n=o.getSelections())!=null?n:[],m=(r=l.getBody())==null?void 0:r.paragraphs,f=d.map(_9);if(c==null||m==null)return!1;const h=Z_e(c,m),{segmentId:p}=c,v=l.getUnitId(),g=h.every(y=>{var D;return((D=y.bullet)==null?void 0:D.listType)===u});let b=Ie.generateRandomId(6);if(h.length===1){const y=m.indexOf(h[0]),D=m[y-1],R=m[y+1];D&&D.bullet&&D.bullet.listType===u?b=D.bullet.listId:R&&R.bullet&&R.bullet.listType===u&&(b=R.bullet.listId)}const C={id:Lo.id,params:{unitId:v,actions:[],textRanges:f}},S=new Xm;S.reset();const E=new Go;for(const y of h){const{startIndex:D}=y;E.push({t:jt.RETAIN,len:D-S.cursor,segmentId:p});const R={...y.paragraphStyle,hanging:void 0,indentStart:void 0};E.push({t:jt.RETAIN,len:1,body:{dataStream:"",paragraphs:[g?{paragraphStyle:R,startIndex:0}:{...y,startIndex:0,bullet:{...(i=y.bullet)!=null?i:{nestingLevel:0,textStyle:{fs:20}},listType:u,listId:b}}]},segmentId:p,coverType:Ii.REPLACE}),S.moveCursorTo(D+1)}return C.params.actions=E.serialize(),!!s.syncExecuteCommand(C.id,C.params)}},IF={id:"doc.command.bullet-list",type:ue.COMMAND,handler:t=>t.get(se).syncExecuteCommand(TE.id,{listType:tm.BULLET_LIST})},AF={id:"doc.command.order-list",type:ue.COMMAND,handler:t=>t.get(se).syncExecuteCommand(TE.id,{listType:tm.ORDER_LIST})};function Z_e(t,e){const{startOffset:n,endOffset:r}=t,i=[];let o=-1;for(const a of e){const{startIndex:s}=a;(n>o&&n<=s||r>o&&r<=s||s>=n&&s<=r)&&i.push(a),o=s}return i}const TF={id:"doc.command-replace-content",type:ue.COMMAND,handler:async(t,e)=>{var n;const{unitId:r,body:i,textRanges:o,segmentId:a=""}=e,s=t.get(ae),u=t.get(se),l=t.get(kr),c=(n=s.getUniverDocInstance(r))==null?void 0:n.getSnapshot().body,d=l.getSelections();if(c==null||!Array.isArray(d)||d.length===0)return!1;const m=LF(r,a,c,i);return m.params.textRanges=o,!!u.syncExecuteCommand(m.id,m.params)}},wF={id:"doc.command-cover-content",type:ue.COMMAND,handler:async(t,e)=>{var n;const{unitId:r,body:i,segmentId:o=""}=e,a=t.get(ae),s=t.get(se),u=t.get(en),l=(n=a.getUniverDocInstance(r))==null?void 0:n.getSnapshot().body;if(l==null)return!1;const c=LF(r,o,l,i);return c.params.noNeedSetTextRange=!0,c.params.noHistory=!0,s.syncExecuteCommand(c.id,c.params),u.clearUndoRedo(r),!0}};function LF(t,e,n,r){const i={id:Lo.id,params:{unitId:t,actions:[],textRanges:[]}},o=new Go,a=(n==null?void 0:n.dataStream.length)-2;return a>0&&o.push({t:jt.DELETE,len:a,line:0,segmentId:e}),r.dataStream.length>0&&o.push({t:jt.INSERT,body:r,len:r.dataStream.length,line:0,segmentId:e}),i.params.actions=o.serialize(),i}const nu={id:"doc.operation.move-cursor",type:ue.OPERATION,handler:(t,e)=>!!e},al={id:"doc.operation.move-selection",type:ue.OPERATION,handler:(t,e)=>!!e},Q_e=(t,e)=>{const n=t.get(ae).getUniverDocInstance(e.unitId),r=(n==null?void 0:n.zoomRatio)||1;return{...Ie.deepClone(e),zoomRatio:r}},gc={id:"doc.operation.set-zoom-ratio",type:ue.OPERATION,handler:(t,e)=>{const n=t.get(ae).getUniverDocInstance(e.unitId);if(!n)return!1;const r=n.getSnapshot();return r.settings==null?r.settings={zoomRatio:e.zoomRatio}:r.settings.zoomRatio=e.zoomRatio,!0}},OF={type:ue.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(t,e)=>{var n,r;const i=t.get(se),o=t.get(en),a=t.get(ae);let s=a.getCurrentUniverDocInstance().getUnitId(),u=1;if(e&&(s=(n=e.documentId)!=null?n:s,u=(r=e.zoomRatio)!=null?r:u),!a.getUniverDocInstance(s))return!1;const l={zoomRatio:u,unitId:s},c=Q_e(t,l);return i.syncExecuteCommand(gc.id,l)?(o.pushUndoRedo({unitID:s,undoMutations:[{id:gc.id,params:c}],redoMutations:[{id:gc.id,params:l}]}),!0):!1}},PF={id:"doc.operation.select-all",type:ue.COMMAND,handler:async t=>{const e=t.get(ae),n=t.get(kr),r=e.getCurrentUniverDocInstance().getSnapshot().body;if(r==null)return!1;const i=[{startOffset:0,endOffset:r.dataStream.length-2}];return n.replaceTextRanges(i),!0}};var J_e=Object.defineProperty,eCe=Object.getOwnPropertyDescriptor,tCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?eCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&J_e(e,n,i),i},vg=(t,e)=>(n,r)=>e(n,r,t);let V4=class extends Ro{constructor(e,n,r){super(),this._docSkeletonManagerService=e,this._renderManagerService=n,this._commandService=r,this._initialRenderRefresh(),this._commandExecutedListener()}_initialRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(Fi(this.dispose$)).subscribe(e=>{if(e==null)return;const{skeleton:n,unitId:r}=e,i=this._renderManagerService.getRenderById(r);if(i==null)return;const{mainComponent:o}=i;o.changeSkeleton(n),this._recalculateSizeBySkeleton(i,n)})}_recalculateSizeBySkeleton(e,n){var r;const{mainComponent:i,scene:o}=e,a=i,s=(r=n.getSkeletonData())==null?void 0:r.pages;if(s==null)return;let u=0,l=0;for(let c=0,d=s.length;c<d;c++){const m=s[c],{pageWidth:f,pageHeight:h}=m;a.pageLayoutType===Ds.VERTICAL?(l+=h,l+=a.pageMarginTop,c===d-1&&(l+=a.pageMarginTop),u=Math.max(u,f)):a.pageLayoutType===Ds.HORIZONTAL&&(u+=f,c!==d-1&&(u+=a.pageMarginLeft),l=Math.max(l,h))}a.resize(u,l),[Qr,qn].includes(e.unitId)||o.resize(u,l)}_commandExecutedListener(){const e=[Lo.id],n=[Qr,qn];this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var i;if(e.includes(r.id)){const o=r.params,{unitId:a}=o,s=this._docSkeletonManagerService.getSkeletonByUnitId(a);if(s==null)return;const{skeleton:u}=s,l=this._renderManagerService.getRenderById(a);if(l==null)return;if(u.calculate(),n.includes(a)){(i=l.mainComponent)==null||i.makeDirty();return}this._recalculateSizeBySkeleton(l,u)}}))}};V4=tCe([yt(ot.Rendered,V4),vg(0,K(Zo)),vg(1,Jn),vg(2,se)],V4);var nCe=Object.defineProperty,rCe=Object.getOwnPropertyDescriptor,iCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?rCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&nCe(e,n,i),i},Hd=(t,e)=>(n,r)=>e(n,r,t);let H4=class extends We{constructor(e,n,r,i,o){super(),Tn(this,"_liquid",new Lm),Tn(this,"_pageMarginCache",new Map),this._docSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._commandService=i,this._floatingObjectManagerService=o,this._initialize(),this._commandExecutedListener()}_initialize(){this._initialRenderRefresh(),this._updateOnPluginChange()}_updateOnPluginChange(){this._floatingObjectManagerService.pluginUpdate$.subscribe(e=>{const n=this._docSkeletonManagerService.getCurrent();if(n==null)return;const{unitId:r,skeleton:i}=n,o=this._renderManagerService.getRenderById(r);if(o==null)return;const{mainComponent:a,components:s,scene:u}=o,l=a,{left:c,top:d}=l;e.forEach(m=>{const{unitId:f,subUnitId:h,floatingObjectId:p,floatingObject:v}=m,{left:g=0,top:b=0,width:C=0,height:S=0,angle:E,flipX:y,flipY:D,skewX:R,skewY:I}=v,T=this._pageMarginCache.get(p),P=(T==null?void 0:T.marginLeft)||0,N=(T==null?void 0:T.marginTop)||0;i==null||i.getViewModel().getDataModel().updateDrawing(p,{left:g-c-P,top:b-d-N,height:S,width:C})}),i==null||i.calculate(),a==null||a.makeDirty()})}_initialRenderRefresh(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{skeleton:n,unitId:r}=e,i=this._renderManagerService.getRenderById(r);if(i==null)return;const{mainComponent:o}=i;o.changeSkeleton(n),this._refreshFloatingObject(r,n,i)})}_commandExecutedListener(){const e=[Lo.id,gc.id],n=[Qr,qn];this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var i;if(e.includes(r.id)){const o=r.params,{unitId:a}=o,s=this._docSkeletonManagerService.getCurrent();if(s==null)return;const{unitId:u,skeleton:l}=s;if(a!==u)return;const c=this._renderManagerService.getRenderById(u);if(c==null)return;if(n.includes(u)){(i=c.mainComponent)==null||i.makeDirty();return}this._refreshFloatingObject(u,l,c)}}))}_refreshFloatingObject(e,n,r){const i=n==null?void 0:n.getSkeletonData(),{mainComponent:o,scene:a}=r,s=o;if(!i)return;const{left:u,top:l,pageLayoutType:c,pageMarginLeft:d,pageMarginTop:m}=s,{pages:f}=i,h=[];a.getAncestorScale(),this._liquid.reset(),this._pageMarginCache.clear();for(let p=0,v=f.length;p<v;p++){const g=f[p],{skeDrawings:b,marginLeft:C,marginTop:S}=g;this._liquid.translatePagePadding(g),b.forEach(E=>{const{aLeft:y,aTop:D,height:R,width:I,objectId:T}=E;h.push({unitId:e,subUnitId:rW,floatingObjectId:T,floatingObject:{left:y+u+this._liquid.x,top:D+l+this._liquid.y,width:I,height:R}}),this._pageMarginCache.set(T,{marginLeft:this._liquid.x,marginTop:this._liquid.y})}),this._liquid.translatePage(g,c,d,m)}this._floatingObjectManagerService.BatchAddOrUpdate(h)}};H4=iCe([yt(ot.Steady,H4),Hd(0,K(Zo)),Hd(1,ae),Hd(2,Jn),Hd(3,se),Hd(4,fL)],H4);var oCe=Object.defineProperty,aCe=Object.getOwnPropertyDescriptor,sCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?aCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&oCe(e,n,i),i},jd=(t,e)=>(n,r)=>e(n,r,t);let j4=class extends We{constructor(e,n,r,i,o){super(),Tn(this,"_previousIMEContent",""),Tn(this,"_isCompositionStart",!0),Tn(this,"_onStartSubscription"),Tn(this,"_onUpdateSubscription"),Tn(this,"_onEndSubscription"),this._docSkeletonManagerService=e,this._currentUniverService=n,this._textSelectionRenderManager=r,this._imeInputManagerService=i,this._commandService=o,this._initialize()}dispose(){var e,n,r;(e=this._onStartSubscription)==null||e.unsubscribe(),(n=this._onUpdateSubscription)==null||n.unsubscribe(),(r=this._onEndSubscription)==null||r.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._textSelectionRenderManager.onCompositionstart$.subscribe(e=>{if(e==null)return;const{activeRange:n}=e;n!=null&&(this._imeInputManagerService.clearUndoRedoMutationParamsCache(),this._imeInputManagerService.setActiveRange(Ie.deepClone(n)),this._isCompositionStart=!0)})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._textSelectionRenderManager.onCompositionupdate$.subscribe(async e=>{this._updateContent(e,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._textSelectionRenderManager.onCompositionend$.subscribe(e=>{this._updateContent(e,!1)})}async _updateContent(e,n){var r;const i=(r=this._docSkeletonManagerService.getCurrent())==null?void 0:r.skeleton;if(e==null||i==null)return;const o=this._currentUniverService.getCurrentUniverDocInstance(),{event:a,activeRange:s}=e;if(i==null||s==null)return;const u=a.data;u===this._previousIMEContent&&n||(await this._commandService.executeCommand(DF.id,{unitId:o.getUnitId(),newText:u,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!n}),n?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=u):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._imeInputManagerService.clearUndoRedoMutationParamsCache(),this._imeInputManagerService.setActiveRange(null)}};j4=sCe([yt(ot.Rendered,j4),jd(0,K(Zo)),jd(1,ae),jd(2,To),jd(3,K(i8)),jd(4,se)],j4);var uCe=Object.defineProperty,lCe=Object.getOwnPropertyDescriptor,cCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?lCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&uCe(e,n,i),i},_A=(t,e)=>(n,r)=>e(n,r,t);let z4=class extends We{constructor(e,n){super(),this._textSelectionManagerService=e,this._commandService=n,this._commandExecutedListener()}_commandExecutedListener(){const e=[od.id,ad.id,sd.id,ud.id,ol.id,ld.id,Tc.id,wc.id,Lc.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{e.includes(n.id)&&this._handleInlineFormat(n)}))}_handleInlineFormat(e){var n,r;const{segmentId:i}=(n=this._textSelectionManagerService.getActiveRange())!=null?n:{};i!=null&&this._commandService.executeCommand(_a.id,{segmentId:i,preCommandId:e.id,...(r=e.params)!=null?r:{}})}};z4=cCe([yt(ot.Rendered,z4),_A(0,K(kr)),_A(1,se)],z4);var dCe=Object.defineProperty,mCe=Object.getOwnPropertyDescriptor,fCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?mCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&dCe(e,n,i),i},zd=(t,e)=>(n,r)=>e(n,r,t);let W4=class extends We{constructor(e,n,r,i,o){super(),Tn(this,"_onInputSubscription"),this._docSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._textSelectionManagerService=i,this._commandService=o,this._initialize(),this._commandExecutedListener()}dispose(){var e;(e=this._onInputSubscription)==null||e.unsubscribe()}_initialize(){}_commandExecutedListener(){const e=[nu.id,al.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(!e.includes(n.id))return;const r=n.params;switch(n.id){case nu.id:return this._handleMoveCursor(r.direction);case al.id:return this._handleShiftMoveSelection(r.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(e){var n,r,i;const o=this._textSelectionManagerService.getActiveRange(),a=this._textSelectionManagerService.getSelections(),s=this._currentUniverService.getCurrentUniverDocInstance(),u=(n=this._docSkeletonManagerService.getCurrent())==null?void 0:n.skeleton,l=this._getDocObject();if(o==null||u==null||l==null)return;const{startOffset:c,endOffset:d,style:m,collapsed:f,direction:h}=o;if(a.length>1){let b=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY;for(const S of a)b=Math.min(b,S.startOffset),C=Math.max(C,S.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:e===ye.LEFT||e===ye.UP?C:b,endOffset:e===ye.LEFT||e===ye.UP?b:C,style:m}]);return}const p=f||h===g0.FORWARD?c:d;let v=f||h===g0.FORWARD?d:c;const g=(r=s.getBody().dataStream.length)!=null?r:Number.POSITIVE_INFINITY;if(e===ye.LEFT||e===ye.RIGHT){const b=u.findNodeByCharIndex(v-1),C=u.findNodeByCharIndex(v);v=e===ye.RIGHT?v+C.count:v-((i=b==null?void 0:b.count)!=null?i:0),v=Math.min(g-2,Math.max(0,v)),this._textSelectionManagerService.replaceTextRanges([{startOffset:p,endOffset:v,style:m}])}else{const b=u.findNodeByCharIndex(v),C=l.document.getOffsetConfig(),S=this._getTopOrBottomPosition(u,b,e===ye.DOWN);if(S==null){const y=e===ye.UP?0:g-2;if(y===v)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:p,endOffset:y,style:m}]);return}const E=new i_(C,u).getRangePointData(S,S).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:p,endOffset:E.endOffset,style:m}])}}_handleMoveCursor(e){var n,r,i;const o=this._textSelectionManagerService.getActiveRange(),a=this._textSelectionManagerService.getSelections(),s=this._currentUniverService.getCurrentUniverDocInstance(),u=(n=this._docSkeletonManagerService.getCurrent())==null?void 0:n.skeleton,l=this._getDocObject();if(o==null||u==null||l==null||a==null)return;const{startOffset:c,endOffset:d,style:m,collapsed:f}=o,h=(r=s.getBody().dataStream.length)!=null?r:Number.POSITIVE_INFINITY;if(e===ye.LEFT||e===ye.RIGHT){let p;if(!o.collapsed||a.length>1){let v=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(const b of a)v=Math.min(v,b.startOffset),g=Math.max(g,b.endOffset);p=e===ye.LEFT?v:g}else{const v=u.findNodeByCharIndex(c-1),g=u.findNodeByCharIndex(c);e===ye.LEFT?p=Math.max(0,c-((i=v==null?void 0:v.count)!=null?i:0)):p=Math.min(h-2,d+g.count)}this._textSelectionManagerService.replaceTextRanges([{startOffset:p,endOffset:p,style:m}])}else{const p=u.findNodeByCharIndex(c),v=u.findNodeByCharIndex(d),g=l.document.getOffsetConfig(),b=this._getTopOrBottomPosition(u,e===ye.UP?p:v,e===ye.DOWN);if(b==null){let S;f?S=e===ye.UP?0:h-2:S=e===ye.UP?c:d,this._textSelectionManagerService.replaceTextRanges([{startOffset:S,endOffset:S,style:m}]);return}const C=new i_(g,u).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...C,style:m}])}}_getTopOrBottomPosition(e,n,r){if(n==null)return;const i=this._getSpanLeftOffsetInLine(n),o=this._getNextOrPrevLine(n,r);if(o==null)return;const a=this._matchPositionByLeftOffset(e,o,i);if(a!=null)return{...a,isBack:!0}}_getSpanLeftOffsetInLine(e){const n=e.parent;if(n==null)return Number.NEGATIVE_INFINITY;const r=n.left,{left:i}=e;return r+i}_matchPositionByLeftOffset(e,n,r){const i={distance:Number.POSITIVE_INFINITY};for(const o of n.divides){const a=o.left;for(const s of o.spanGroup){const{left:u}=s,l=a+u,c=Math.abs(r-l);c<i.distance&&(i.span=s,i.distance=c)}}if(i.span!=null)return e.findPositionBySpan(i.span)}_getNextOrPrevLine(e,n){var r,i,o,a,s,u,l,c,d,m,f,h;const p=e.parent;if(p==null)return;const v=p.parent;if(v==null)return;const g=v.parent;if(g==null)return;const b=g.lines.indexOf(v);if(b===-1)return;let C;if(n===!0?C=g.lines[b+1]:C=g.lines[b-1],C!=null)return C;const S=g.parent;if(S==null)return;const E=S.columns.indexOf(g);if(E===-1)return;if(n===!0)C=(r=S.columns[E+1])==null?void 0:r.lines[0];else{const T=(o=(i=S.columns)==null?void 0:i[E-1])==null?void 0:o.lines;C=T==null?void 0:T[T.length-1]}if(C!=null)return C;const y=S.parent;if(y==null)return;const D=y.sections.indexOf(S);if(D===-1)return;if(n===!0)C=(s=(a=y.sections[D-1])==null?void 0:a.columns[0])==null?void 0:s.lines[0];else{const T=(l=(u=y.sections)==null?void 0:u[D-1])==null?void 0:l.columns,P=T==null?void 0:T[T.length-1],N=P==null?void 0:P.lines;C=N==null?void 0:N[N.length-1]}if(C!=null)return C;const R=y.parent;if(R==null)return;const I=R.pages.indexOf(y);if(I!==-1){if(n===!0)C=(m=(d=(c=R.pages[I+1])==null?void 0:c.sections[0])==null?void 0:d.columns[0])==null?void 0:m.lines[0];else{const T=(f=R.pages[I-1])==null?void 0:f.sections;if(T==null)return;const P=(h=T[T.length-1])==null?void 0:h.columns,N=P[P.length-1],B=N==null?void 0:N.lines;C=B[B.length-1]}if(C!=null)return C}}_getDocObject(){return r8(this._currentUniverService,this._renderManagerService)}};W4=fCe([yt(ot.Rendered,W4),zd(0,K(Zo)),zd(1,ae),zd(2,Jn),zd(3,K(kr)),zd(4,se)],W4);var hCe=Object.defineProperty,pCe=Object.getOwnPropertyDescriptor,gCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?pCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&hCe(e,n,i),i},Wd=(t,e)=>(n,r)=>e(n,r,t);let Y4=class extends We{constructor(e,n,r,i,o){super(),Tn(this,"_onInputSubscription"),this._docSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._textSelectionRenderManager=i,this._commandService=o,this._initialize(),this._commandExecutedListener()}dispose(){var e;(e=this._onInputSubscription)==null||e.unsubscribe()}_initialize(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._textSelectionRenderManager.onInput$.subscribe(async e=>{var n;if(e==null)return;const r=this._currentUniverService.getCurrentUniverDocInstance().getUnitId(),{event:i,content:o="",activeRange:a}=e,s=i,u=(n=this._docSkeletonManagerService.getCurrent())==null?void 0:n.skeleton;if(s.data==null||u==null||!u||!a)return;const{startOffset:l,segmentId:c,style:d}=a,m=o.length,f=[{startOffset:l+m,endOffset:l+m,style:d}];await this._commandService.executeCommand(o8.id,{unitId:r,body:{dataStream:o},range:a,textRanges:f,segmentId:c})})}_commandExecutedListener(){}_getDocObject(){return r8(this._currentUniverService,this._renderManagerService)}};Y4=gCe([yt(ot.Rendered,Y4),Wd(0,K(Zo)),Wd(1,ae),Wd(2,Jn),Wd(3,To),Wd(4,se)],Y4);var vCe=Object.defineProperty,bCe=Object.getOwnPropertyDescriptor,_Ce=(t,e,n,r)=>{for(var i=r>1?void 0:r?bCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&vCe(e,n,i),i},CA=(t,e)=>(n,r)=>e(n,r,t);const CCe="rgba(198, 198, 198, 1)",SCe="rgba(255, 255, 255, 1)";let X4=class extends We{constructor(e,n){super(),this._renderManagerService=e,this._currentUniverService=n,this._initialize(),this._commandExecutedListener()}_initialize(){this._initialRenderRefresh()}_initialRenderRefresh(){this._renderManagerService.currentRender$.subscribe(e=>{var n;if(e==null||this._currentUniverService.getUniverDocInstance(e)==null)return;const r=this._renderManagerService.getRenderById(e);if(r==null)return;const{mainComponent:i}=r,o=i,a=(n=o.getSkeleton())==null?void 0:n.getPageSize();o.onPageRenderObservable.add(s=>{var u,l,c,d;if([Qr,qn].includes(e))return;const{page:m,pageLeft:f,pageTop:h,ctx:p}=s,{width:v,pageWidth:g,height:b,pageHeight:C}=m;p.save(),p.translate(f-.5,h-.5),cn.drawWith(p,{width:(l=(u=a==null?void 0:a.width)!=null?u:g)!=null?l:v,height:(d=(c=a==null?void 0:a.height)!=null?c:C)!=null?d:b,strokeWidth:1,stroke:CCe,fill:SCe,zIndex:3}),p.restore()})})}_commandExecutedListener(){}};X4=_Ce([yt(ot.Rendered,X4),CA(0,Jn),CA(1,K(ae))],X4);var ECe=Object.defineProperty,yCe=Object.getOwnPropertyDescriptor,DCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?yCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&ECe(e,n,i),i},_2=(t,e)=>(n,r)=>e(n,r,t);let q4=class extends We{constructor(e,n,r,i,o,a){super(),Tn(this,"_moveInObserver"),Tn(this,"_moveOutObserver"),Tn(this,"_downObserver"),Tn(this,"_dblClickObserver"),Tn(this,"_tripleClickObserver"),Tn(this,"_loadedMap",new Set),this._docSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._textSelectionRenderManager=o,this._textSelectionManagerService=a,this._renderManagerService.currentRender$.subscribe(s=>{s!=null&&this._currentUniverService.getUniverDocInstance(s)!=null&&(this._loadedMap.has(s)||(this._initialMain(s),this._loadedMap.add(s)))}),this._initialize()}_initialize(){this._skeletonListener(),this._commandExecutedListener()}dispose(){this._renderManagerService.getRenderAll().forEach(e=>{const{mainComponent:n}=e;n!=null&&(n.onPointerEnterObserver.remove(this._moveInObserver),n.onPointerLeaveObserver.remove(this._moveOutObserver),n.onPointerDownObserver.remove(this._downObserver),n.onDblclickObserver.remove(this._dblClickObserver),n.onTripleClickObserver.remove(this._tripleClickObserver))})}_initialMain(e){const n=this._getDocObjectById(e);if(n==null)return;const{document:r,scene:i}=n;this._moveInObserver=r.onPointerEnterObserver.add(()=>{r.cursor=Jt.TEXT}),this._moveOutObserver=r.onPointerLeaveObserver.add(()=>{r.cursor=Jt.DEFAULT,i.resetCursor()}),this._downObserver=r==null?void 0:r.onPointerDownObserver.add((o,a)=>{this._currentUniverService.getCurrentUniverDocInstance().getUnitId()!==e&&this._currentUniverService.setCurrentUniverDocInstance(e),this._textSelectionRenderManager.eventTrigger(o),o.button!==2&&a.stopPropagation()}),this._dblClickObserver=r==null?void 0:r.onDblclickObserver.add(o=>{this._textSelectionRenderManager.handleDblClick(o)}),this._tripleClickObserver=r==null?void 0:r.onTripleClickObserver.add(o=>{this._textSelectionRenderManager.handleTripleClick(o)})}_commandExecutedListener(){const e=[gc.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{var r;if(e.includes(n.id)){const i=n.params,{unitId:o}=i,a=(r=this._textSelectionManagerService.getCurrentSelection())==null?void 0:r.unitId;if(o!==a)return;this._textSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n,skeleton:r}=e,i=this._renderManagerService.getRenderById(n);if(i==null)return;const{scene:o,mainComponent:a}=i;this._textSelectionRenderManager.changeRuntime(r,o,a),this._textSelectionManagerService.setCurrentSelectionNotRefresh({unitId:n,subUnitId:""})})}_getDocObjectById(e){return w_e(e,this._renderManagerService)}};q4=DCe([yt(ot.Rendered,q4),_2(0,K(Zo)),_2(1,ae),_2(2,se),_2(3,Jn),_2(4,To),_2(5,K(kr))],q4);var RCe=Object.defineProperty,ICe=Object.getOwnPropertyDescriptor,ACe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ICe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&RCe(e,n,i),i},Yd=(t,e)=>(n,r)=>e(n,r,t);let G4=class extends We{constructor(e,n,r,i,o){super(),Tn(this,"_initializedRender",new Set),this._docSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._textSelectionManagerService=o,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._initialRenderRefresh()}_initialRenderRefresh(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n}=e,r=this._renderManagerService.getRenderById(n);if(r==null||this._initializedRender.has(n)||[Qr,qn].includes(n))return;this._initializedRender.add(n);const{scene:i}=r;this.disposeWithMe(je(i.onMouseWheelObserver.add(o=>{if(!o.ctrlKey)return;const a=Math.abs(o.deltaX);let s=a<40?.2:a<80?.4:.2;s*=o.deltaY>0?-1:1,i.scaleX<1&&(s/=2);const u=this._currentUniverService.getCurrentUniverDocInstance(),l=u.zoomRatio;let c=+Number.parseFloat(`${l+s}`).toFixed(1);c=c>=4?4:c<=.1?.1:c,this._commandService.executeCommand(OF.id,{zoomRatio:c,unitId:u.getUnitId()}),o.preventDefault()})))})}_skeletonListener(){this.disposeWithMe(je(this._docSkeletonManagerService.currentSkeletonBefore$.subscribe(e=>{if(e==null)return;const n=this._currentUniverService.getCurrentUniverDocInstance().zoomRatio||1;this._updateViewZoom(n,!1)})))}_commandExecutedListener(){const e=[gc.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._currentUniverService.getCurrentUniverDocInstance(),i=n.params,{unitId:o}=i;if(o!==r.getUnitId())return;const a=r.zoomRatio||1;this._updateViewZoom(a)}}))}_updateViewZoom(e,n=!0){var r;const i=this._getDocObject();i!=null&&(i.scene.scale(e,e),this._calculatePagePosition(i,e),n&&this._textSelectionManagerService.refreshSelection(),(r=i.scene.getTransformer())==null||r.hideControl())}_calculatePagePosition(e,n){const{document:r,scene:i}=e,o=i==null?void 0:i.getParent(),{width:a,height:s,pageMarginLeft:u,pageMarginTop:l}=r;if(o==null||a===Number.POSITIVE_INFINITY||s===Number.POSITIVE_INFINITY)return;const{width:c,height:d}=o;let m=0,f=0,h=0,p=0,v=Number.POSITIVE_INFINITY;c>(a+u*2)*n?(m=c/2-a*n/2,m/=n,h=(c-u*2)/n,v=0):(m=u,h=a+u*2,v=(h-c/n)/2),d>s?(f=d/2-s/2,p=(d-l*2)/n):(f=l,p=s+l*2),i.resize(h,p+200),r.translate(m,f);const g=i.getViewport(x0.VIEW_MAIN);if(v!==Number.POSITIVE_INFINITY&&g!=null){const b=g.getBarScroll(v,0).x;g.scrollTo({x:b})}return this}_getDocObject(){return r8(this._currentUniverService,this._renderManagerService)}};G4=ACe([yt(ot.Rendered,G4),Yd(0,K(Zo)),Yd(1,ae),Yd(2,se),Yd(3,Jn),Yd(4,K(kr))],G4);var TCe=Object.defineProperty,wCe=Object.getOwnPropertyDescriptor,LCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?wCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&TCe(e,n,i),i},L3=(t,e)=>(n,r)=>e(n,r,t);let K4=class extends Ro{constructor(e,n,r,i){super(),Tn(this,"_scene"),Tn(this,"_currentDocumentModel"),Tn(this,"_loadedMap",new Set),Tn(this,"_fps$",new dn("")),Tn(this,"fps$",this._fps$.asObservable()),this._renderManagerService=e,this._configService=n,this._currentUniverService=r,this._docViewModelManagerService=i,this._initialize()}_initialize(){this._currentUniverService.currentDoc$.pipe(Fi(this.dispose$)).subscribe(e=>{if(e==null)return;this._currentDocumentModel=e;const n=e.getUnitId();this._loadedMap.has(n)||(this._addNewRender(),this._loadedMap.add(n))})}dispose(){this._fps$.complete()}_addNewRender(){const e=this._currentDocumentModel,n=e.getUnitId(),r=e.getContainer(),i=e.getParentRenderUnitId();if(r!=null&&i!=null)throw new Error("container or parentRenderUnitId can only exist one");r==null&&i!=null?this._renderManagerService.createRenderWithParent(n,i):this._renderManagerService.createRender(n);const o=this._renderManagerService.getRenderById(n);if(o==null)return;const{scene:a,engine:s}=o;a.openTransformer(),this._scene=a;const u=new Gs(x0.VIEW_MAIN,a,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});a.attachControl(),a.on(Zs.wheel,(l,c)=>{const d=l;if(d.ctrlKey){const m=Math.abs(d.deltaX);let f=m<40?.2:m<80?.4:.2;f*=d.deltaY>0?-1:1,a.scaleX<1&&(f/=2),a.scaleX+f>4?a.scale(4,4):a.scaleX+f<.1?a.scale(.1,.1):d.preventDefault()}else u.onMouseWheel(d,c)}),this._configService.getConfig("hasScroll")!==!1&&n!==qn&&new n8(u),a.addLayer(new Pm(a,[],m_),new Pm(a,[],L_e)),this._addComponent(o),this._currentDocumentModel.getShouldRenderLoopImmediately()&&s.runRenderLoop(()=>{a.render(),this._fps$.next(Math.round(s.getFps()).toString())}),this._renderManagerService.setCurrent(n)}_addComponent(e){const n=this._scene,r=this._currentDocumentModel,i=new t8(d_.MAIN,void 0,{pageMarginLeft:r.documentStyle.marginLeft||0,pageMarginTop:r.documentStyle.marginTop||0});i.zIndex=O_e,e.mainComponent=i,e.components.set(d_.MAIN,i),n.addObjects([i],m_)}};K4=LCe([yt(ot.Ready,K4),L3(0,Jn),L3(1,K0),L3(2,ae),L3(3,K(tu))],K4);var OCe=Object.defineProperty,PCe=Object.getOwnPropertyDescriptor,MCe=(t,e,n,r)=>{for(var i=r>1?void 0:r?PCe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&OCe(e,n,i),i},O3=(t,e)=>(n,r)=>e(n,r,t);const NCe={hasScroll:!0},xCe="docs";var bg;let f_=(bg=class extends b1{constructor(t={},e,n,r,i){super(xCe),Tn(this,"_config"),this._injector=e,this._localeService=n,this._configService=r,this._currentUniverService=i,this._config=Object.assign(NCe,t),this._initializeDependencies(e),this._initializeCommands()}initialize(){}_initializeCommands(){[nu,al,IE,EF,od,ad,sd,ud,ol,ld,Tc,wc,Lc,_a,RE,o8,a8,CF,DF,AE,Lo,TF,wF,OF,gc,wo,PF,AF,IF,TE].forEach(t=>{this._injector.get(se).registerCommand(t)})}onReady(){this.initialize()}_initializeDependencies(t){[[K4],[Zo],[tu],[C9],[i8],[To,{useClass:s_}],[kr],[V4],[X4],[q4],[Y4],[j4],[z4],[W4],[G4],[H4]].forEach(e=>t.add(e))}},Tn(bg,"type",Ir.Doc),bg);f_=MCe([O3(1,K(wn)),O3(2,K(Gt)),O3(3,K0),O3(4,ae)],f_);var FCe="__RediContextCreated__";if(!window.RediContextCreated)window.RediContextCreated=FCe;else throw new so(`"RediContext" is already created. You may import "RediContext" from different paths. Use "import { RediContext } from '@wendellhu/redi/react-bindings'; instead."`);var u8=_.createContext({injector:null});u8.displayName="RediContext";var $Ce=u8.Provider;u8.Consumer;var kCe=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),BCe=function(t){kCe(e,t);function e(){return t.call(this,"Using dependency injection outside of a RediContext.")||this}return e}(so);function gf(){var t=_.useContext(u8);if(!t.injector)throw new BCe;return t.injector}function Ct(t,e,n){var r=gf();return r.get(t,e,n)}var h_=function(){return h_=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},h_.apply(this,arguments)};function H6(t,e){return function(r){return _.createElement($Ce,{value:{injector:e}},_.createElement(t,h_({},r)))}}var UCe=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();(function(t){UCe(e,t);function e(n){return t.call(this,'You should make "RediContext" as '.concat(n.constructor.name,"'s default context type. ")+"If you want to use multiple context, please check this on React doc site. https://reactjs.org/docs/context.html#classcontexttype")||this}return e})(so);var VCe=Object.defineProperty,HCe=(t,e,n)=>e in t?VCe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Mn=(t,e,n)=>(HCe(t,typeof e!="symbol"?e+"":e,n),n),xa=function(){return xa=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},xa.apply(this,arguments)},jCe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},bt=_.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,a=jCe(t,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),u=_.useRef("_".concat(YCe()));return MF(n,"".concat(r),{defIds:n.defIds,idSuffix:u.current},xa({ref:e,className:s},a),o)});function MF(t,e,n,r,i){return _.createElement(t.tag,xa(xa({key:e},zCe(t,n,i)),r),(WCe(t,n).children||[]).map(function(o,a){return MF(o,"".concat(e,"-").concat(t.tag,"-").concat(a),n,void 0,i)}))}function zCe(t,e,n){var r=xa({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var a=o[0],s=o[1];typeof s=="string"&&(r[a]=s.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function WCe(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?xa(xa({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?xa(xa({},i),{attrs:xa(xa({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function YCe(){return Math.random().toString(36).substring(2,8)}bt.displayName="UniverIcon";var XCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1312",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1312)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M8.60231 5.77597L9.38125 6.55432C9.61658 6.78947 9.99797 6.78932 10.2331 6.554C10.4683 6.31867 10.4681 5.93728 10.2328 5.70214L8.44939 3.92009C8.33908 3.79657 8.1786 3.7188 7.99995 3.7188C7.84562 3.71861 7.6906 3.77736 7.57281 3.89506L5.76712 5.69933C5.5318 5.93447 5.53165 6.31587 5.76679 6.55119C6.00193 6.78652 6.38332 6.78667 6.61865 6.55153L7.3976 5.77319L7.3976 10.2246L6.61865 9.44621C6.38333 9.21107 6.00194 9.21121 5.76679 9.44654C5.53165 9.68186 5.53179 10.0633 5.76712 10.2984L7.55051 12.0804C7.66082 12.204 7.82131 12.2817 7.99995 12.2817L8.00089 12.2817C8.15512 12.2819 8.30939 12.2231 8.4271 12.1055L10.2328 10.3012C10.4681 10.0661 10.4683 9.68467 10.2331 9.44934C9.99798 9.21402 9.61659 9.21387 9.38126 9.44901L8.60231 10.2274L8.60231 5.77597Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7039 3.24701C14.0539 3.24701 14.3377 2.96327 14.3377 2.61325 14.3377 2.26324 14.0539 1.97949 13.7039 1.97949L2.29627 1.97949C1.94625 1.97949 1.66251 2.26324 1.66251 2.61325 1.66251 2.96327 1.94625 3.24701 2.29627 3.24701L13.7039 3.24701zM13.7039 14.0209C14.0539 14.0209 14.3377 13.7372 14.3377 13.3872 14.3377 13.0371 14.0539 12.7534 13.7039 12.7534L2.29627 12.7534C1.94625 12.7534 1.66251 13.0371 1.66251 13.3872 1.66251 13.7372 1.94625 14.0209 2.29627 14.0209L13.7039 14.0209z"}}]}]},NF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"adjust-height",ref:e,icon:XCe}))});NF.displayName="AdjustHeight";var qCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1166",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1166)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.77574 7.3974L6.5541 6.61846C6.78924 6.38313 6.78909 6.00174 6.55377 5.7666C6.31844 5.53145 5.93705 5.5316 5.70191 5.76692L3.91987 7.55032C3.79634 7.66063 3.71857 7.82111 3.71857 7.99976C3.71838 8.15409 3.77713 8.30912 3.89483 8.42691L5.6991 10.2326C5.93425 10.4679 6.31564 10.4681 6.55096 10.2329C6.78629 9.99778 6.78644 9.61639 6.5513 9.38106L5.77296 8.60211L10.2243 8.60211L9.44598 9.38106C9.21084 9.61638 9.21099 9.99777 9.44631 10.2329C9.68164 10.4681 10.063 10.4679 10.2982 10.2326L12.0802 8.4492C12.2037 8.33889 12.2815 8.1784 12.2815 7.99976L12.2815 7.99882C12.2816 7.84459 12.2229 7.69032 12.1052 7.57261L10.301 5.76693C10.0658 5.5316 9.68444 5.53145 9.44911 5.76659C9.21379 6.00173 9.21364 6.38312 9.44878 6.61845L10.2271 7.3974L5.77574 7.3974Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.24683 2.29598C3.24683 1.94596 2.96308 1.66222 2.61307 1.66222 2.26305 1.66222 1.97931 1.94596 1.97931 2.29598L1.97931 13.7036C1.97931 14.0537 2.26305 14.3374 2.61307 14.3374 2.96308 14.3374 3.24683 14.0537 3.24683 13.7036L3.24683 2.29598zM14.0207 2.29598C14.0207 1.94596 13.737 1.66222 13.387 1.66222 13.037 1.66222 12.7532 1.94596 12.7532 2.29598L12.7532 13.7036C12.7532 14.0537 13.037 14.3374 13.387 14.3374 13.737 14.3374 14.0207 14.0537 14.0207 13.7036L14.0207 2.29598z"}}]}]},xF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"adjust-width",ref:e,icon:qCe}))});xF.displayName="AdjustWidth";var GCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_827",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_827)"},children:[{tag:"path",attrs:{d:"M8.72815 2.01432C8.72815 1.64033 8.42498 1.33716 8.05099 1.33716 7.67701 1.33716 7.37383 1.64033 7.37383 2.01432V8.00664L6.68301 7.31583C6.41857 7.05138 5.98981 7.05138 5.72536 7.31583 5.46092 7.58027 5.46092 8.00903 5.72536 8.27348L7.57164 10.1197C7.57328 10.1214 7.57494 10.123 7.57661 10.1247 7.63997 10.1869 7.71254 10.2342 7.78988 10.2664 7.87023 10.3 7.95845 10.3186 8.05099 10.3186 8.23574 10.3186 8.4032 10.2446 8.52538 10.1247 8.52705 10.123 8.52872 10.1214 8.53038 10.1197L10.3766 8.27348C10.6411 8.00903 10.6411 7.58027 10.3766 7.31583 10.1122 7.05138 9.68342 7.05138 9.41897 7.31583L8.72815 8.00664V2.01432zM2.0106 13.3122C1.63661 13.3122 1.33344 13.6153 1.33344 13.9893 1.33344 14.3633 1.63661 14.6665 2.0106 14.6665H14.0914C14.4654 14.6665 14.7686 14.3633 14.7686 13.9893 14.7686 13.6153 14.4654 13.3122 14.0914 13.3122H2.0106z"}}]}]},FF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"align-bottom-single",ref:e,icon:GCe}))});FF.displayName="AlignBottomSingle";var KCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_830",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_830)"},children:[{tag:"path",attrs:{d:"M1.30457 14.0064C1.30457 13.6398 1.60172 13.3426 1.96828 13.3426H14.0315C14.398 13.3426 14.6952 13.6398 14.6952 14.0064 14.6952 14.3729 14.398 14.6701 14.0315 14.6701H1.96828C1.60172 14.6701 1.30457 14.3729 1.30457 14.0064zM7.99992 10.3675C7.60968 10.3675 7.29333 10.0646 7.29333 9.69086V3.64013L6.5725 4.33045C6.29656 4.59471 5.84917 4.59471 5.57323 4.33045 5.2973 4.06619 5.2973 3.63775 5.57323 3.37349L7.4997 1.52859 7.50492 1.52363C7.6324 1.40376 7.80714 1.32983 7.99992 1.32983 8.09649 1.32983 8.18853 1.34839 8.27237 1.38197 8.35307 1.41422 8.42879 1.46144 8.49491 1.52363L8.5001 1.52856 10.4266 3.37349C10.7025 3.63775 10.7025 4.0662 10.4266 4.33045 10.1507 4.59471 9.70328 4.59471 9.42734 4.33045L8.7065 3.64013V9.69086C8.7065 10.0646 8.39015 10.3675 7.99992 10.3675z"}}]}]},$F=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"align-top-single",ref:e,icon:KCe}))});$F.displayName="AlignTopSingle";var ZCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_771",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_771)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.39575 13.3122C1.39575 14.0255 1.97405 14.6038 2.68742 14.6038H13.3124C14.0258 14.6038 14.6041 14.0255 14.6041 13.3122V2.68717C14.6041 1.97381 14.0258 1.39551 13.3124 1.39551H2.68742C1.97405 1.39551 1.39575 1.97381 1.39575 2.68717V13.3122ZM2.72909 8.66634V13.2705H7.33325V8.66634H2.72909ZM2.72909 7.33301H7.33325V2.72884H2.72909V7.33301ZM8.66659 8.66634V13.2705H13.2708V8.66634H8.66659ZM13.2708 7.33301H8.66659V2.72884H13.2708V7.33301Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},kF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"all-border-single",ref:e,icon:ZCe}))});kF.displayName="AllBorderSingle";var QCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_127_22",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_127_22)"},children:[{tag:"path",attrs:{d:"M8.14925 5.80766C8.14925 5.43947 7.85077 5.14099 7.48258 5.14099C7.11439 5.14099 6.81592 5.43947 6.81592 5.80766V6.81897L5.81106 6.82027C5.44287 6.82075 5.14478 7.11962 5.14526 7.48781C5.14574 7.856 5.44461 8.15409 5.8128 8.15361L6.81592 8.1523V9.15766C6.81592 9.52585 7.11439 9.82432 7.48258 9.82432C7.85077 9.82432 8.14925 9.52585 8.14925 9.15766V8.15056L9.15844 8.14925C9.52663 8.14877 9.82472 7.84991 9.82424 7.48172C9.82376 7.11353 9.5249 6.81544 9.15671 6.81592L8.14925 6.81723V5.80766Z"}},{tag:"path",attrs:{d:"M7.48257 2.07007C4.49334 2.07007 2.07007 4.49334 2.07007 7.48257C2.07007 10.4718 4.49334 12.8951 7.48257 12.8951C8.73691 12.8951 9.89161 12.4684 10.8094 11.7522L12.7919 13.7347C13.0522 13.995 13.4743 13.995 13.7347 13.7347C13.995 13.4743 13.995 13.0522 13.7347 12.7919L11.7522 10.8094C12.4684 9.89161 12.8951 8.73691 12.8951 7.48257C12.8951 4.49334 10.4718 2.07007 7.48257 2.07007ZM3.4034 7.48257C3.4034 5.22972 5.22972 3.4034 7.48257 3.4034C9.73542 3.4034 11.5617 5.22972 11.5617 7.48257C11.5617 9.73542 9.73542 11.5617 7.48257 11.5617C5.22972 11.5617 3.4034 9.73542 3.4034 7.48257Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},BF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"amplify-single",ref:e,icon:QCe}))});BF.displayName="AmplifySingle";var JCe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1317",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1317)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.29713 1.98047C1.94717 1.98047 1.66348 2.26416 1.66348 2.61412 1.66348 2.96408 1.94717 3.24777 2.29713 3.24777H13.7028C14.0528 3.24777 14.3365 2.96408 14.3365 2.61412 14.3365 2.26416 14.0528 1.98047 13.7028 1.98047H2.29713zM2.29713 12.7525C1.94717 12.7525 1.66348 13.0362 1.66348 13.3862 1.66348 13.7361 1.94717 14.0198 2.29713 14.0198H13.7028C14.0528 14.0198 14.3365 13.7361 14.3365 13.3862 14.3365 13.0362 14.0528 12.7525 13.7028 12.7525H2.29713z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.42163 4.25588L4.25471 11.2231C4.10989 11.5417 4.25077 11.9174 4.56935 12.0622C4.88794 12.207 5.2636 12.0661 5.40841 11.7475L6.24766 9.90119H9.75197L10.5912 11.7475C10.736 12.0661 11.1117 12.207 11.4303 12.0622C11.7489 11.9174 11.8897 11.5417 11.7449 11.2231L8.578 4.25589C8.5675 4.23244 8.55557 4.20961 8.54227 4.18755C8.49012 4.10102 8.41688 4.0262 8.32579 3.97171C8.301 3.95688 8.27527 3.94377 8.24878 3.93246C8.16764 3.89775 8.08309 3.8813 7.99981 3.88135C7.88457 3.88142 7.77177 3.91309 7.67384 3.97171C7.58714 4.02361 7.5121 4.09664 7.45735 4.18755C7.44406 4.20961 7.43213 4.23244 7.42163 4.25588ZM9.17592 8.63388L7.99981 6.04644L6.8237 8.63388H9.17592Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},UF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"auto-height",ref:e,icon:JCe}))});UF.displayName="AutoHeight";var eSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_790",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_790)"},children:[{tag:"path",attrs:{d:"M4.60953 5.31756C4.60953 4.95355 4.90462 4.65846 5.26863 4.65846L8.43895 4.65846C10.0886 4.65846 11.4259 5.99579 11.4259 7.64547 11.4259 9.29516 10.0886 10.6325 8.43895 10.6325H7.27235L8.26725 11.6274C8.52465 11.8848 8.52465 12.3021 8.26725 12.5595 8.00986 12.8169 7.59254 12.8169 7.33515 12.5595L5.16372 10.3881C4.90633 10.1307 4.90633 9.71334 5.16372 9.45595L7.33515 7.28449C7.59254 7.02709 8.00986 7.02709 8.26725 7.28449 8.52464 7.54188 8.52464 7.95921 8.26725 8.2166L7.16958 9.31429H8.43895C9.3606 9.31429 10.1077 8.56714 10.1077 7.64547 10.1077 6.72381 9.3606 5.97666 8.43895 5.97666H5.26863C4.90462 5.97666 4.60953 5.68157 4.60953 5.31756zM1.98618 1.34155C2.35019 1.34155 2.64528 1.63664 2.64528 2.00065L2.64528 13.9992C2.64528 14.3632 2.35019 14.6583 1.98618 14.6583 1.62217 14.6583 1.32709 14.3632 1.32709 13.9992L1.32709 2.00065C1.32709 1.63664 1.62217 1.34155 1.98618 1.34155zM14.0138 1.34155C14.3778 1.34155 14.6729 1.63664 14.6729 2.00065L14.6729 13.9992C14.6729 14.3632 14.3778 14.6583 14.0138 14.6583 13.6498 14.6583 13.3547 14.3632 13.3547 13.9992L13.3547 2.00065C13.3547 1.63664 13.6498 1.34155 14.0138 1.34155z"}}]}]},VF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"autowrap-single",ref:e,icon:eSe}))});VF.displayName="AutowrapSingle";var tSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.5685 13.1941C11.5793 13.1941 10.7637 12.7609 10.7637 11.683 10.7637 11.196 10.967 10.8005 11.3521 10.5163 11.3666 10.5056 11.3754 10.4887 11.3754 10.4707 11.3754 10.4553 11.3689 10.4406 11.3579 10.4299 11.1403 10.2186 10.9827 9.90502 10.9827 9.41094 10.9827 8.9958 11.1721 8.58065 11.4435 8.30566 11.453 8.29605 11.4585 8.28317 11.4585 8.26966 11.4585 8.25613 11.4531 8.24328 11.4435 8.23366 11.1473 7.93411 10.877 7.38103 10.877 6.69506 10.877 5.22616 11.7454 4.50757 12.6742 4.50757 12.8147 4.50757 12.9503 4.52436 13.0772 4.55604 13.2652 4.60302 13.4545 4.65551 13.6484 4.65551H14.2505C14.6269 4.65551 14.9321 4.96068 14.9321 5.33713V5.75075C14.9321 5.89876 14.8121 6.01874 14.6641 6.01874 14.4743 6.01874 14.3363 6.21476 14.3634 6.40258 14.3791 6.51121 14.3884 6.62863 14.3884 6.7479 14.3884 8.15339 13.6257 8.76631 12.6742 8.76631 12.6532 8.76631 12.6314 8.76563 12.6091 8.76423 12.3402 8.74736 12.0324 8.81385 12.0324 9.08334 12.0324 9.3581 12.206 9.48491 12.6667 9.48491H13.3463C14.4035 9.48491 15 9.93932 15 11.0278 15 12.2959 14.0637 13.1941 12.5685 13.1941zM12.6742 7.63558C12.9914 7.63558 13.2179 7.31855 13.2179 6.69506 13.2179 6.08214 12.9914 5.76511 12.6742 5.76511 12.3646 5.76511 12.1305 6.08214 12.1305 6.69506 12.1305 7.31855 12.3646 7.63558 12.6742 7.63558zM12.7799 12.0211C13.3312 12.0211 13.7163 11.7358 13.7163 11.3554 13.7163 10.9961 13.4898 10.9221 13.0895 10.9221H12.6818C12.6712 10.9221 12.6608 10.9221 12.6506 10.922 12.3003 10.9203 11.8662 11.0368 11.8662 11.3871 11.8662 11.8098 12.2287 12.0211 12.7799 12.0211zM8.20658 10.6685C7.75206 10.6685 7.35706 10.3563 7.2521 9.91403L6.19144 5.44538C6.09577 5.04228 6.40148 4.65552 6.81578 4.65552 7.12782 4.65552 7.39463 4.88 7.448 5.18744L7.83629 7.42423 8.07997 8.92644C8.09028 8.99003 8.14519 9.03675 8.20962 9.03675 8.2731 9.03675 8.32749 8.99135 8.33884 8.92889L8.61225 7.42423 8.99765 5.16665C9.04805 4.87142 9.30394 4.65552 9.60344 4.65552 9.99872 4.65552 10.2912 5.0233 10.2022 5.40843L9.16239 9.90835C9.05957 10.3533 8.66328 10.6685 8.20658 10.6685zM3.0027 7.06217C2.9779 7.24241 3.11796 7.40306 3.2999 7.40306H3.75645C3.93944 7.40306 4.0798 7.24064 4.05328 7.05957L4.00606 6.7373 3.68142 4.66273C3.67133 4.59826 3.61579 4.55074 3.55053 4.55074 3.48639 4.55074 3.43147 4.59668 3.42014 4.65982L3.0474 6.7373 3.0027 7.06217zM5.25518 10.6684C4.92519 10.6684 4.64258 10.4321 4.58422 10.1073L4.44152 9.31315C4.39454 9.05167 4.16701 8.86139 3.90134 8.86139H3.15805C2.89238 8.86139 2.66486 9.05167 2.61787 9.31315L2.47196 10.1252C2.41546 10.4396 2.14187 10.6684 1.82241 10.6684 1.4003 10.6684 1.0867 10.2776 1.17813 9.86556L2.56935 3.59496C2.6716 3.13411 3.08029 2.80615 3.55235 2.80615 4.02442 2.80615 4.43311 3.13411 4.53535 3.59496L5.9207 9.83909C6.01514 10.2648 5.6912 10.6684 5.25518 10.6684z"}}]},HF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"avg-single",ref:e,icon:tSe}))});HF.displayName="AvgSingle";var nSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_28",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.35 0.72H16.35V16.72H0.35z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_28)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.5853 14.7987L2.27159 3.485L3.12012 2.63647L14.4338 13.9502L13.5853 14.7987Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M1.69629 12.8102L1.69629 14.1743C1.69629 14.8371 2.23355 15.3743 2.89629 15.3743L4.26042 15.3743L4.26042 14.0443L3.02629 14.0443L3.02629 12.8102L1.69629 12.8102ZM4.26042 2.06128L2.89629 2.06128C2.23355 2.06128 1.69629 2.59854 1.69629 3.26128L1.69629 4.62541L3.02629 4.62541L3.02629 3.39128L4.26042 3.39128L4.26042 2.06128ZM1.69629 10.0819L3.02629 10.0819L3.02629 7.35367L1.69629 7.35367L1.69629 10.0819ZM6.98868 2.06128L6.98868 3.39128L9.71693 3.39128L9.71693 2.06128L6.98868 2.06128ZM12.4452 2.06128L12.4452 3.39128L13.6793 3.39128L13.6793 4.62541L15.0093 4.62541L15.0093 3.26128C15.0093 2.59854 14.4721 2.06128 13.8093 2.06128L12.4452 2.06128ZM15.0093 7.35367L13.6793 7.35367L13.6793 10.0819L15.0093 10.0819L15.0093 7.35367ZM15.0093 12.8102L13.6793 12.8102L13.6793 14.0443L12.4452 14.0443L12.4452 15.3743L13.8093 15.3743C14.4721 15.3743 15.0093 14.8371 15.0093 14.1743L15.0093 12.8102ZM9.71693 15.3743L9.71693 14.0443L6.98868 14.0443L6.98868 15.3743L9.71693 15.3743Z"}}]}]},jF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"back-slash-single",ref:e,icon:nSe}))});jF.displayName="BackSlashSingle";var rSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.78796 2.10786C3.78796 1.66603 4.14614 1.30786 4.58796 1.30786H7.71771C9.60018 1.30786 11.1262 2.8339 11.1262 4.71637C11.1262 5.7364 10.6782 6.65178 9.96812 7.27643C11.2927 7.88759 12.212 9.22743 12.212 10.782C12.212 12.9131 10.4844 14.6406 8.35338 14.6406H4.58796C4.14614 14.6406 3.78796 14.2825 3.78796 13.8406V2.10786ZM4.98796 2.50786H7.71771C8.93744 2.50786 9.92622 3.49664 9.92622 4.71637C9.92622 5.90824 8.98209 6.87959 7.80091 6.92334H4.98796V2.50786ZM4.98796 8.12488V13.4406H8.35338C9.82171 13.4406 11.012 12.2503 11.012 10.782C11.012 9.31365 9.82171 8.12334 8.35338 8.12334H7.82111C7.78677 8.12436 7.7523 8.12488 7.71771 8.12488H4.98796Z",fillRule:"evenodd",clipRule:"evenodd"}}]},zF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"bold-single",ref:e,icon:rSe}))});zF.displayName="BoldSingle";var iSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_653",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_653)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.87956 9.13668C2.44169 8.79817 2.16158 8.27966 2.16158 7.69845C2.16158 6.67855 3.03873 5.85175 4.1027 5.85175C5.18295 5.85175 6.07351 5.01232 6.07353 3.97682L6.07354 3.17992C6.07355 2.16003 6.93607 1.33325 8.00003 1.33325C9.064 1.33325 9.92651 2.16005 9.92651 3.17995V3.97681C9.92651 5.01231 10.8171 5.85175 11.8973 5.85175C12.9613 5.85175 13.8384 6.67855 13.8384 7.69845C13.8384 8.27966 13.5583 8.79817 13.1205 9.13668L14.5873 13.8447C14.715 14.2545 14.3948 14.6666 13.9485 14.6666H2.0515C1.60527 14.6666 1.28502 14.2545 1.41271 13.8447L2.87956 9.13668ZM8.59318 3.17995V3.97681C8.59318 5.73073 10.0938 7.12986 11.8973 7.12986C12.2381 7.12986 12.5051 7.39696 12.5051 7.69845C12.5051 8.00337 12.2547 8.25223 11.9403 8.2664H4.05975C3.74531 8.25223 3.49491 8.00337 3.49491 7.69845C3.49491 7.39697 3.76196 7.12986 4.1027 7.12986C5.90617 7.12986 7.40684 5.73075 7.40686 3.97684L7.40687 3.17994C7.40687 2.86592 7.67244 2.61136 8.00003 2.61136C8.32762 2.61136 8.59318 2.86592 8.59318 3.17995ZM4.14383 9.54515L2.94637 13.3885H13.0536L11.8562 9.54515H4.14383Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},WF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"brush-single",ref:e,icon:iSe}))});WF.displayName="BrushSingle";var oSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_768",style:{maskType:"alpha"},width:16,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16.55H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_768)"},children:[{tag:"path",attrs:{d:"M0.0117188 2.75741C0.0117188 1.99595 0.608672 1.37866 1.34505 1.37866H12.0117C12.7481 1.37866 13.3451 1.99595 13.3451 2.75741V5.5149C13.3451 5.89563 13.0466 6.20427 12.6784 6.20427C12.3102 6.20427 12.0117 5.89563 12.0117 5.5149V2.75741H7.34507V8.27239C7.34507 8.65312 7.0466 8.96177 6.67841 8.96177H1.34505V13.7874H12.0117V12.4086C12.0117 12.0279 12.3102 11.7193 12.6784 11.7193C13.0466 11.7193 13.3451 12.0279 13.3451 12.4086V13.7874C13.3451 14.5489 12.7481 15.1661 12.0117 15.1661H1.34505C0.608679 15.1661 0.0117188 14.5489 0.0117188 13.7874V2.75741ZM4.16489 2.75741H5.43328L1.34505 6.51931V5.21797L4.16489 2.75741ZM2.09743 2.75741L1.34505 3.41393V2.75741H2.09743ZM2.19476 7.58302H3.48512L6.01174 5.18605V4.07072L2.19476 7.58302ZM5.45741 7.58302H6.01174V7.05713L5.45741 7.58302Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M8.45104 11.3044C8.31061 11.1592 8.24592 10.9653 8.25699 10.7752L8.37441 8.22503C8.39192 7.84473 8.70425 7.55111 9.07202 7.56922C9.4398 7.58732 9.72374 7.9103 9.70623 8.29059L9.67041 9.06858L11.1609 7.52734C12.2252 6.42675 13.9845 6.39107 15.0898 7.4482C16.2584 8.56589 16.2919 10.5084 15.1678 11.6708L14.768 12.0842C14.5077 12.3534 14.0856 12.3534 13.8252 12.0842C13.5649 11.8149 13.5649 11.3785 13.8252 11.1092L14.225 10.6958C14.8153 10.0855 14.7961 9.04541 14.1844 8.46037C13.6049 7.90613 12.6617 7.92527 12.1037 8.50227L10.5319 10.1276L11.5152 10.1276C11.8834 10.1276 12.1819 10.4363 12.1819 10.817C12.1819 11.1977 11.8834 11.5064 11.5152 11.5064L8.92249 11.5063C8.91089 11.5063 8.89933 11.506 8.88781 11.5054C8.72892 11.4969 8.5724 11.4299 8.45104 11.3044Z"}}]}]},YF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"cancel-freeze-single",ref:e,icon:oSe}))});YF.displayName="CancelFreezeSingle";var aSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_718",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_718)"},children:[{tag:"path",attrs:{d:"M2.66657 2.66632H5.3332V3.99964H6.66652V2.66632C6.66652 1.92995 6.06957 1.33301 5.3332 1.33301H2.66657C1.9302 1.33301 1.33325 1.92995 1.33325 2.66632V13.3329C1.33325 14.0692 1.9302 14.6662 2.66657 14.6662H5.3332C6.06957 14.6662 6.66652 14.0692 6.66652 13.3329V11.9995H5.3332V13.3329H2.66657V2.66632zM10.6665 2.66632H13.3331V13.3329H10.6665V11.9995H9.33315V13.3329C9.33315 14.0692 9.9301 14.6662 10.6665 14.6662H13.3331C14.0695 14.6662 14.6664 14.0692 14.6664 13.3329V2.66632C14.6664 1.92995 14.0695 1.33301 13.3331 1.33301H10.6665C9.9301 1.33301 9.33315 1.92995 9.33315 2.66632V3.99964H10.6665V2.66632z"}},{tag:"path",attrs:{d:"M6.72052 10.3774C6.46018 10.6377 6.03807 10.6377 5.77773 10.3774L3.87136 8.47099C3.61101 8.21064 3.61101 7.78854 3.87136 7.52819L5.77773 5.62183C6.03807 5.36148 6.46018 5.36148 6.72052 5.62183 6.98087 5.88217 6.98087 6.30428 6.72052 6.56462L5.28555 7.99959 6.72052 9.43456C6.98087 9.69491 6.98087 10.117 6.72052 10.3774zM10.2219 10.3774C9.9616 10.6377 9.53949 10.6377 9.27915 10.3774 9.0188 10.117 9.0188 9.69491 9.27915 9.43456L10.7141 7.99959 9.27915 6.56462C9.0188 6.30428 9.0188 5.88217 9.27915 5.62183 9.53949 5.36148 9.9616 5.36148 10.2219 5.62183L12.1283 7.52819C12.3887 7.78854 12.3887 8.21064 12.1283 8.47099L10.2219 10.3774z"}}]}]},XF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"cancel-merge-single",ref:e,icon:aSe}))});XF.displayName="CancelMergeSingle";var sSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.44 3.57291C14.698 3.83093 14.698 4.24927 14.44 4.50729L6.44342 12.5037C6.28721 12.6599 6.03395 12.6599 5.87774 12.5037L1.55992 8.18578C1.3019 7.92776 1.3019 7.50942 1.55993 7.2514C1.81795 6.99338 2.23629 6.99338 2.49431 7.25141L6.01916 10.7763C6.09727 10.8544 6.2239 10.8544 6.30201 10.7763L13.5056 3.57291C13.7636 3.31489 14.1819 3.31489 14.44 3.57291Z",fillRule:"evenodd",clipRule:"evenodd"}}]},qF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"check-mark-single",ref:e,icon:sSe}))});qF.displayName="CheckMarkSingle";const uSe=qF;var lSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1161",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1161)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.36831 3.22148C5.36831 1.94497 6.40313 0.910156 7.67964 0.910156C8.95615 0.910156 9.99097 1.94497 9.99097 3.22149V6.74754H8.72649V3.22149C8.72649 2.64333 8.2578 2.17464 7.67964 2.17464C7.10148 2.17464 6.63279 2.64333 6.63279 3.22148V6.74754H5.36831V3.22148Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.00091 5.47314C3.33644 5.47314 1.9499 6.74914 1.81192 8.40788L1.54428 11.6254C1.38911 13.4909 2.86133 15.0906 4.73327 15.0906H13.6667C14.175 15.0906 14.5544 14.6228 14.4495 14.1255L13.0262 7.37781C12.792 6.26766 11.8125 5.47314 10.6779 5.47314H5.00091ZM10.6779 6.75314H5.00091C4.00223 6.75314 3.1703 7.51874 3.08751 8.51399L2.81988 11.7315C2.72677 12.8508 3.61011 13.8106 4.73327 13.8106H5.7695C5.26362 13.0554 5.05585 12.0527 5.31224 11.047C5.40861 10.6689 5.76242 10.4493 6.10249 10.5564C6.44256 10.6636 6.64012 11.0569 6.54374 11.4349C6.27517 12.4885 6.92898 13.6738 7.87916 13.8106H9.01412C8.50824 13.0554 8.30047 12.0527 8.55686 11.047C8.65324 10.6689 9.00704 10.4493 9.34711 10.5564C9.68719 10.6636 9.88474 11.0569 9.78837 11.4349C9.51979 12.4885 10.1736 13.6738 11.1238 13.8106H13.0749L11.7738 7.64199C11.6645 7.12392 11.2073 6.75314 10.6779 6.75314Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},GF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"clear-format",ref:e,icon:lSe}))});GF.displayName="ClearFormat";var cSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.57061 3.65132C4.31677 3.39748 3.90521 3.39748 3.65137 3.65132C3.39753 3.90516 3.39753 4.31672 3.65137 4.57056L7.08079 7.99998L3.65123 11.4295C3.39739 11.6834 3.39739 12.0949 3.65123 12.3488C3.90507 12.6026 4.31662 12.6026 4.57047 12.3488L8.00003 8.91921L11.4295 12.3487C11.6834 12.6026 12.0949 12.6026 12.3488 12.3487C12.6026 12.0949 12.6026 11.6833 12.3488 11.4295L8.91927 7.99998L12.3486 4.57061C12.6025 4.31677 12.6025 3.90521 12.3486 3.65137C12.0948 3.39753 11.6832 3.39753 11.4294 3.65137L8.00003 7.08074L4.57061 3.65132Z"}}]},KF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"close-single",ref:e,icon:cSe}))});KF.displayName="CloseSingle";const ZF=KF;var dSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.9365 12.0791C12.7577 12.0791 12.2795 11.128 12.2795 9.70135V7.70443C12.2795 7.52914 12.1374 7.38705 11.9622 7.38705 11.7869 7.38705 11.6448 7.24495 11.6448 7.06966V6.37153C11.6448 6.15597 11.8078 5.97531 12.0222 5.9532 12.2202 5.93278 12.3767 5.77635 12.3973 5.57837L12.467 4.9083C12.501 4.58138 12.7766 4.33301 13.1053 4.33301 13.4596 4.33301 13.7469 4.6203 13.7469 4.97469V5.36582C13.7469 5.67086 13.9942 5.91815 14.2993 5.91815 14.6043 5.91815 14.8516 6.16544 14.8516 6.47048V6.83471C14.8516 7.13976 14.6043 7.38705 14.2993 7.38705 13.9942 7.38705 13.7469 7.63433 13.7469 7.93938V9.68022C13.7469 10.346 13.9943 10.6102 14.3405 10.6102 14.5714 10.6102 14.805 10.7144 14.8438 10.942L14.9064 11.3086C14.9608 11.6276 14.7862 11.9559 14.4697 12.0234 14.3144 12.0566 14.1379 12.0791 13.9365 12.0791zM7.3926 11.9312C6.98967 11.9312 6.66302 11.6045 6.66302 11.2016V6.55511C6.66302 6.20336 6.94818 5.91821 7.29993 5.91821H7.47998C7.69651 5.91821 7.87953 6.07868 7.90783 6.29336L7.95451 6.64741C7.95611 6.65948 7.9664 6.66851 7.97858 6.66851 7.98597 6.66851 7.99295 6.66514 7.99757 6.65937 8.38373 6.17725 8.85985 5.77026 9.49064 5.77026 10.5129 5.77026 10.9498 6.71078 10.9498 8.21138V11.1975C10.9498 11.6027 10.6213 11.9312 10.2161 11.9312 9.81088 11.9312 9.48239 11.6027 9.48239 11.1975V8.44387C9.48239 7.61959 9.30927 7.37654 8.93831 7.37654 8.28179 7.37654 8.12217 8.27469 8.12217 8.9312V11.2016C8.12217 11.6045 7.79553 11.9312 7.3926 11.9312zM3.87708 12.0791C2.319 12.0791 1 10.7053 1 8.04226 1 5.4215 2.36847 3.9209 3.92654 3.9209 4.54107 3.9209 5.0631 4.20176 5.46268 4.5812 5.67605 4.78382 5.68353 5.1109 5.52435 5.35836 5.27076 5.7526 4.7207 5.7317 4.27454 5.5879 4.1736 5.55537 4.06644 5.53774 3.95127 5.53774 3.15987 5.53774 2.50861 6.44656 2.50861 7.97886 2.50861 9.54286 3.06919 10.4517 3.93478 10.4517 4.09227 10.4517 4.24025 10.4184 4.37816 10.3599 4.80914 10.1768 5.38129 10.1545 5.63778 10.5462 5.78475 10.7707 5.78814 11.0664 5.61016 11.2672 5.13216 11.8064 4.54486 12.0791 3.87708 12.0791z"}}]},QF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"cnt-single",ref:e,icon:dSe}))});QF.displayName="CntSingle";var mSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.79641 3.52041C6.06132 3.77611 6.06879 4.19816 5.81308 4.46307L2.27638 8.12716 5.7961 11.5201C6.06118 11.7756 6.06892 12.1977 5.81338 12.4628 5.55785 12.7278 5.13581 12.7356 4.87073 12.48L.870733 8.62411C.743383 8.50135.670042 8.33301.666856 8.15615.66367 7.9793.730901 7.80842.853746 7.68115L4.85375 3.53709C5.10945 3.27217 5.53149 3.26471 5.79641 3.52041zM10.2037 3.52041C10.4686 3.26471 10.8906 3.27217 11.1463 3.53709L15.1463 7.68115C15.2692 7.80842 15.3364 7.9793 15.3332 8.15615 15.33 8.33301 15.2567 8.50135 15.1293 8.62411L11.1293 12.48C10.8643 12.7356 10.4422 12.7278 10.1867 12.4628 9.93117 12.1977 9.93891 11.7756 10.204 11.5201L13.7237 8.12716 10.187 4.46307C9.93129 4.19816 9.93876 3.77611 10.2037 3.52041zM9.40012 2.07252C9.43897 1.70638 9.17366 1.37808 8.80752 1.33923 8.44139 1.30038 8.11308 1.56569 8.07423 1.93183L6.59996 13.9276C6.56111 14.2937 6.82642 14.622 7.19256 14.6609 7.55869 14.6997 7.887 14.4344 7.92585 14.0683L9.40012 2.07252z"}}]},JF=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"code-single",ref:e,icon:mSe}))});JF.displayName="CodeSingle";var fSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_273_6444",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.54 0.84H16.54V16.84H0.54z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_273_6444)"},children:[{tag:"path",attrs:{d:"M6.67742 7.37473V5.64139H9.74408V7.37473H6.67742Z"}},{tag:"path",attrs:{d:"M2.41101 2.84136C2.41101 2.03134 3.06766 1.37469 3.87768 1.37469H13.211C14.021 1.37469 14.6777 2.03135 14.6777 2.84136V14.8414C14.6777 15.6514 14.021 16.308 13.211 16.308H3.87768C3.06767 16.308 2.41101 15.6514 2.41101 14.8414V2.84136ZM5.87742 10.0414C5.43559 10.0414 5.07742 10.3996 5.07742 10.8414C5.07742 11.2832 5.43559 11.6414 5.87742 11.6414H10.5441C10.9859 11.6414 11.3441 11.2832 11.3441 10.8414C11.3441 10.3996 10.9859 10.0414 10.5441 10.0414H5.87742ZM5.07742 12.8414C5.07742 12.3996 5.43559 12.0414 5.87742 12.0414H8.21075C8.65258 12.0414 9.01075 12.3996 9.01075 12.8414C9.01075 13.2832 8.65258 13.6414 8.21075 13.6414H5.87742C5.43559 13.6414 5.07742 13.2832 5.07742 12.8414ZM5.87742 4.04139C5.43559 4.04139 5.07742 4.39957 5.07742 4.84139V8.17473C5.07742 8.61655 5.43559 8.97473 5.87742 8.97473H10.5441C10.9859 8.97473 11.3441 8.61655 11.3441 8.17473V4.84139C11.3441 4.39957 10.9859 4.04139 10.5441 4.04139H5.87742Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},e$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"content-single-16",ref:e,icon:fSe}))});e$.displayName="ContentSingle16";var hSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1141",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1141)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M5.4004 2.60213C5.25792 2.60213 5.14241 2.71763 5.14241 2.86011V4.32679C5.14241 4.67752 4.85809 4.96184 4.50736 4.96184C4.15663 4.96184 3.87231 4.67752 3.87231 4.32679V2.86011C3.87231 2.01618 4.55646 1.33203 5.4004 1.33203H13.14C13.984 1.33203 14.6681 2.01618 14.6681 2.86011V10.5998C14.6681 11.4437 13.984 12.1278 13.14 12.1278H11.6568C11.3061 12.1278 11.0218 11.8435 11.0218 11.4928C11.0218 11.1421 11.3061 10.8577 11.6568 10.8577H13.14C13.2825 10.8577 13.398 10.7422 13.398 10.5998V2.86011C13.398 2.71763 13.2825 2.60213 13.14 2.60213H5.4004Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33203 5.40015C1.33203 4.55622 2.01618 3.87207 2.86011 3.87207H10.5998C11.4437 3.87207 12.1278 4.55622 12.1278 5.40015V13.1398C12.1278 13.9837 11.4437 14.6679 10.5998 14.6679H2.86011C2.01618 14.6679 1.33203 13.9837 1.33203 13.1398V5.40015ZM2.86011 5.14217C2.71763 5.14217 2.60213 5.25767 2.60213 5.40015V13.1398C2.60213 13.2823 2.71763 13.3978 2.86011 13.3978H10.5998C10.7422 13.3978 10.8577 13.2823 10.8577 13.1398V5.40015C10.8577 5.25767 10.7422 5.14217 10.5998 5.14217H2.86011Z"}}]}]},t$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"copy",ref:e,icon:hSe}))});t$.displayName="Copy";var pSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1093",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1093)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.69148 5.44796C7.69148 5.07977 7.393 4.7813 7.02481 4.7813H3.25445C2.88626 4.7813 2.58779 5.07977 2.58779 5.44796V10.5516C2.58779 10.9198 2.88626 11.2183 3.25445 11.2183H7.02481C7.393 11.2183 7.69148 10.9198 7.69148 10.5516V5.44796ZM2.58779 3.50537C1.88311 3.50537 1.31186 4.07662 1.31186 4.7813V11.2183C1.31186 11.923 1.88311 12.4942 2.58779 12.4942H7.69148C8.39613 12.4942 8.96739 11.923 8.96739 11.2183V4.7813C8.96739 4.07662 8.39613 3.50537 7.69148 3.50537H2.58779Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.8919 10.4557C11.9671 10.4869 12.0496 10.5041 12.1361 10.5041C12.2226 10.5041 12.3051 10.4869 12.3803 10.4557C12.4555 10.4246 12.526 10.3784 12.5872 10.3172L14.5011 8.40335C14.7502 8.15421 14.7502 7.75028 14.5011 7.50114C14.2519 7.252 13.848 7.252 13.5989 7.50114L12.774 8.32595V6.13406C12.774 5.78172 12.4884 5.49609 12.1361 5.49609C11.7837 5.49609 11.4981 5.78172 11.4981 6.13406V8.32595L10.6733 7.50114C10.4241 7.252 10.0202 7.252 9.77106 7.50114C9.52192 7.75028 9.52192 8.15421 9.77106 8.40335L11.6847 10.3169M6.97288 9.84189C6.69858 10.1235 6.25386 10.1235 5.97956 9.84189L5.17866 9.01974L4.37769 9.84195C4.1034 10.1235 3.65867 10.1235 3.38437 9.84195C3.11008 9.56038 3.11008 9.10385 3.38437 8.82228L4.18534 8.00007L3.38439 7.17787C3.11009 6.8963 3.11009 6.43977 3.38439 6.1582C3.65869 5.87663 4.10341 5.87663 4.37771 6.1582L5.17866 6.9804L5.97954 6.15826C6.25384 5.87669 6.69857 5.87669 6.97287 6.15826C7.24716 6.43984 7.24716 6.89636 6.97286 7.17793L6.17198 8.00007L6.97288 8.82222C7.24718 9.10379 7.24718 9.56031 6.97288 9.84189Z"}}]}]},n$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"delete-cell-move-down",ref:e,icon:pSe}))});n$.displayName="DeleteCellMoveDown";var gSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_252_31",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16 16H32V32H16z",transform:"rotate(180 16 16)"}}]},{tag:"g",attrs:{mask:"url(#mask0_252_31)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.29012 10.552C8.29012 10.9202 8.5886 11.2187 8.95679 11.2187L12.7271 11.2187C13.0953 11.2187 13.3938 10.9202 13.3938 10.552L13.3938 5.44836C13.3938 5.08016 13.0953 4.7817 12.7271 4.7817L8.95678 4.7817C8.5886 4.7817 8.29012 5.08016 8.29012 5.44836L8.29012 10.552ZM13.3938 12.4946C14.0985 12.4946 14.6697 11.9234 14.6697 11.2187L14.6697 4.7817C14.6697 4.07703 14.0985 3.50576 13.3938 3.50576L8.29012 3.50576C7.58547 3.50576 7.0142 4.07703 7.0142 4.7817L7.0142 11.2187C7.0142 11.9234 7.58547 12.4946 8.29012 12.4946L13.3938 12.4946Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.37899 7.7562C1.34779 7.83142 1.33053 7.9139 1.33053 8.0004C1.33053 8.0869 1.34779 8.16938 1.37899 8.2446C1.41013 8.31985 1.45626 8.39034 1.51739 8.45151L3.43133 10.3654C3.68046 10.6145 4.08439 10.6145 4.33353 10.3654C4.58266 10.1163 4.58266 9.71232 4.33353 9.46318L3.50873 8.63836L5.70059 8.63836C6.05293 8.63836 6.33855 8.35273 6.33855 8.0004C6.33855 7.64806 6.05293 7.36244 5.70059 7.36244L3.50873 7.36244L4.33353 6.53762C4.58266 6.28848 4.58266 5.88455 4.33353 5.63541C4.08439 5.38627 3.68046 5.38627 3.43133 5.63541L1.51773 7.54899M9.00896 6.15858C9.28326 5.87701 9.72798 5.87701 10.0023 6.15858L10.8032 6.98073L11.6042 6.15852C11.8784 5.87695 12.3232 5.87695 12.5975 6.15852C12.8718 6.44009 12.8718 6.89661 12.5975 7.17819L11.7965 8.00041L12.5975 8.8226C12.8718 9.10417 12.8718 9.56069 12.5975 9.84227C12.3232 10.1238 11.8784 10.1238 11.6041 9.84227L10.8032 9.02007L10.0023 9.84221C9.728 10.1238 9.28327 10.1238 9.00897 9.84221C8.73468 9.56063 8.73468 9.10411 9.00898 8.82254L9.80987 8.00041L9.00896 7.17825C8.73466 6.89668 8.73466 6.44016 9.00896 6.15858Z"}}]}]},r$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"delete-cell-shift-left",ref:e,icon:gSe}))});r$.displayName="DeleteCellShiftLeft";var vSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1088",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1088)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.70985 5.44796C7.70985 5.07977 7.41137 4.7813 7.04318 4.7813H3.27282C2.90463 4.7813 2.60616 5.07977 2.60616 5.44796V10.5516C2.60616 10.9198 2.90463 11.2183 3.27282 11.2183H7.04318C7.41137 11.2183 7.70985 10.9198 7.70985 10.5516V5.44796ZM2.60616 3.50537C1.90148 3.50537 1.33023 4.07662 1.33023 4.7813V11.2183C1.33023 11.923 1.90148 12.4942 2.60616 12.4942H7.70985C8.4145 12.4942 8.98576 11.923 8.98576 11.2183V4.7813C8.98576 4.07662 8.4145 3.50537 7.70985 3.50537H2.60616Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.621 8.2438C14.6522 8.16858 14.6695 8.0861 14.6695 7.9996C14.6695 7.9131 14.6522 7.83062 14.621 7.7554C14.5899 7.68015 14.5438 7.60966 14.4826 7.54849L12.5687 5.63461C12.3196 5.38547 11.9156 5.38547 11.6665 5.63461C11.4174 5.88375 11.4174 6.28768 11.6665 6.53682L12.4913 7.36164H10.2994C9.94711 7.36164 9.66148 7.64727 9.66148 7.9996C9.66148 8.35194 9.94711 8.63756 10.2994 8.63756H12.4913L11.6665 9.46238C11.4174 9.71152 11.4174 10.1155 11.6665 10.3646C11.9156 10.6137 12.3196 10.6137 12.5687 10.3646L14.4823 8.45101M6.99107 9.84142C6.71677 10.123 6.27205 10.123 5.99775 9.84142L5.19685 9.01927L4.39588 9.84148C4.12159 10.1231 3.67686 10.1231 3.40256 9.84148C3.12826 9.55991 3.12826 9.10339 3.40256 8.82181L4.20353 7.99959L3.40258 7.1774C3.12828 6.89583 3.12828 6.43931 3.40258 6.15773C3.67688 5.87616 4.1216 5.87616 4.3959 6.15773L5.19685 6.97993L5.99773 6.15779C6.27203 5.87622 6.71676 5.87622 6.99106 6.15779C7.26535 6.43937 7.26535 6.89589 6.99105 7.17746L6.19017 7.99959L6.99107 8.82175C7.26537 9.10332 7.26537 9.55984 6.99107 9.84142Z"}}]}]},i$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"delete-cell-shift-right",ref:e,icon:vSe}))});i$.displayName="DeleteCellShiftRight";var bSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_252_36",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z",transform:"matrix(1 0 0 -1 0 16)"}}]},{tag:"g",attrs:{mask:"url(#mask0_252_36)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.69172 10.552C7.69172 10.9202 7.39324 11.2187 7.02506 11.2187H3.2547C2.8865 11.2187 2.58803 10.9202 2.58803 10.552V5.44836C2.58803 5.08016 2.8865 4.7817 3.2547 4.7817H7.02506C7.39324 4.7817 7.69172 5.08016 7.69172 5.44836V10.552ZM2.58803 12.4946C1.88335 12.4946 1.3121 11.9234 1.3121 11.2187V4.7817C1.3121 4.07703 1.88335 3.50576 2.58803 3.50576H7.69172C8.39637 3.50576 8.96764 4.07703 8.96764 4.7817V11.2187C8.96764 11.9234 8.39637 12.4946 7.69172 12.4946H2.58803Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.892 5.54431C11.9672 5.51312 12.0497 5.49591 12.1362 5.49591C12.2227 5.49591 12.3052 5.51312 12.3804 5.54431C12.4557 5.57545 12.5261 5.62159 12.5873 5.68276L14.5012 7.59665C14.7503 7.84579 14.7503 8.24972 14.5012 8.49886C14.2521 8.748 13.8481 8.748 13.599 8.49886L12.7741 7.67405V9.86594C12.7741 10.2183 12.4885 10.5039 12.1362 10.5039C11.7839 10.5039 11.4983 10.2183 11.4983 9.86594V7.67405L10.6734 8.49886C10.4243 8.748 10.0203 8.748 9.77121 8.49886C9.52207 8.24972 9.52207 7.84579 9.77121 7.59665L11.6848 5.68305M6.97304 6.15811C6.69874 5.87653 6.25401 5.87654 5.97972 6.15811L5.17881 6.98026L4.37784 6.15805C4.10355 5.87647 3.65882 5.87647 3.38453 6.15805C3.11023 6.43962 3.11023 6.89615 3.38453 7.17772L4.18549 7.99993L3.38454 8.82213C3.11024 9.1037 3.11024 9.56023 3.38454 9.8418C3.65884 10.1234 4.10356 10.1234 4.37786 9.8418L5.17881 9.0196L5.9797 9.84174C6.254 10.1233 6.69872 10.1233 6.97302 9.84174C7.24732 9.56016 7.24732 9.10364 6.97302 8.82207L6.17213 7.99993L6.97304 7.17778C7.24734 6.89621 7.24734 6.43969 6.97304 6.15811Z"}}]}]},o$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"delete-cell-shift-up",ref:e,icon:bSe}))});o$.displayName="DeleteCellShiftUp";var _Se={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1098",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1098)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.9503 1.33317C12.6866 1.33317 13.2836 1.9301 13.2836 2.6665V13.3332C13.2836 14.0695 12.6866 14.6665 11.9503 14.6665H9.28359C8.54721 14.6665 7.95026 14.0696 7.95026 13.3332L7.95026 2.6665C7.95026 1.9301 8.54721 1.33317 9.28359 1.33317H11.9503ZM11.9503 2.6665V13.3332H9.28359V2.6665H11.9503Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M3.8542 6.29716C3.59385 6.03681 3.17174 6.03681 2.91139 6.29716C2.65104 6.55751 2.65104 6.97962 2.91139 7.23997L3.67157 8.00014L2.9114 8.76031C2.65105 9.02066 2.65105 9.44277 2.9114 9.70312C3.17175 9.96347 3.59387 9.96347 3.85421 9.70312L4.61437 8.94296L5.37459 9.70318C5.63494 9.96352 6.05705 9.96353 6.31741 9.70318C6.57775 9.44283 6.57775 9.02072 6.31741 8.76036L5.55718 8.00014L6.31742 7.23991C6.57777 6.97956 6.57777 6.55745 6.31742 6.2971C6.05707 6.03675 5.63496 6.03675 5.37461 6.2971L4.61437 7.05734L3.8542 6.29716Z"}}]}]},a$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"delete-column",ref:e,icon:_Se}))});a$.displayName="DeleteColumn";var CSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1103",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1103)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.6666 11.9502C14.6666 12.6866 14.0697 13.2835 13.3333 13.2835H2.66665C1.93027 13.2835 1.33331 12.6866 1.33331 11.9502V9.28353C1.33331 8.54715 1.93027 7.9502 2.66665 7.9502L13.3333 7.9502C14.0697 7.9502 14.6666 8.54715 14.6666 9.28353V11.9502ZM13.3333 11.9502H2.66665V9.28353H13.3333V11.9502Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M9.60134 3.85438C9.86169 3.59403 9.86169 3.17192 9.60134 2.91157C9.34099 2.65122 8.91888 2.65122 8.65853 2.91157L7.89835 3.67175L7.13819 2.91159C6.87784 2.65124 6.45573 2.65124 6.19538 2.91159C5.93503 3.17194 5.93503 3.59405 6.19538 3.8544L6.95554 4.61456L6.19532 5.37478C5.93497 5.63513 5.93497 6.05724 6.19532 6.31759C6.45567 6.57794 6.87778 6.57794 7.13813 6.31759L7.89835 5.55737L8.65859 6.3176C8.91893 6.57796 9.34105 6.57796 9.60139 6.3176C9.86175 6.05726 9.86175 5.63514 9.60139 5.3748L8.84116 4.61456L9.60134 3.85438Z"}}]}]},s$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"delete-row",ref:e,icon:CSe}))});s$.displayName="DeleteRow";var SSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1287",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1287)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301zM1.33325 9.33301H2.66659V6.66634H1.33325V9.33301zM6.66659 1.33301V2.66634H7.33325V5.33301H8.66659V2.66634H9.33325V1.33301H6.66659zM11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999zM14.6666 6.66634H13.3333V7.33301H10.6666V8.66634H13.3333V9.33301H14.6666V6.66634zM7.33325 13.333V10.6663H8.66659V13.333H7.33325zM5.33325 7.33301H2.66659V8.66634H5.33325V7.33301z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33325 13.3333V12H2.66659L2.66659 13.3333H13.3333V12H14.6666V13.3333C14.6666 14.0697 14.0696 14.6667 13.3333 14.6667H2.66659C1.93021 14.6667 1.33325 14.0697 1.33325 13.3333Z"}}]}]},u$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"down-border",ref:e,icon:SSe}))});u$.displayName="DownBorder";var ESe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0 0H16V16H0z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.09973 1.50049C4.51022 1.50049 1.59973 4.41098 1.59973 8.00049C1.59973 11.59 4.51022 14.5005 8.09973 14.5005C11.6892 14.5005 14.5997 11.59 14.5997 8.00049C14.5997 4.41098 11.6892 1.50049 8.09973 1.50049ZM10.4995 10.4701L9.5419 10.4657L8.09971 8.74643L6.65897 10.4643L5.69993 10.4686C5.63609 10.4686 5.58386 10.4179 5.58386 10.3526C5.58386 10.325 5.59402 10.2989 5.61143 10.2771L7.49904 8.02824L5.61143 5.7808C5.59402 5.75904 5.58386 5.73292 5.58386 5.70536C5.58386 5.64152 5.63609 5.58929 5.69993 5.58929L6.65897 5.59364L8.09971 7.31295L9.54045 5.59509L10.498 5.59074C10.5619 5.59074 10.6141 5.64152 10.6141 5.70681C10.6141 5.73438 10.604 5.76049 10.5865 5.78225L8.70183 8.02969L10.588 10.2786C10.6054 10.3003 10.6156 10.3265 10.6156 10.354C10.6156 10.4179 10.5633 10.4701 10.4995 10.4701Z",fillRule:"evenodd",clipRule:"evenodd"}}]},l$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"error-single",ref:e,icon:ESe}))});l$.displayName="ErrorSingle";const ySe=l$;var DSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1198",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1198)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.68731 9.98425C5.73282 9.87144 5.77827 9.75442 5.82366 9.63323L6.3312 8.27586H9.65859L10.3523 10.1159C10.405 10.284 10.4868 10.4276 10.6023 10.5378C10.74 10.669 10.9119 10.7236 11.1014 10.714C11.3544 10.7131 11.5919 10.6379 11.6996 10.4032L11.7013 10.3992C11.7901 10.1937 11.7749 9.9634 11.6929 9.7289L8.85351 1.86337C8.79546 1.68828 8.6901 1.54881 8.54213 1.45002C8.38836 1.33863 8.1989 1.29112 7.98798 1.29112C7.78272 1.29112 7.59752 1.34014 7.4446 1.45198C7.30481 1.55223 7.20617 1.69184 7.14935 1.86343L4.324 9.70145L4.32281 9.70495C4.27002 9.86052 4.23828 10.0056 4.23828 10.1346C4.23828 10.2646 4.27116 10.3937 4.36281 10.4909C4.50256 10.6468 4.6921 10.714 4.90604 10.714C5.0369 10.714 5.15805 10.6745 5.26156 10.5916C5.3633 10.5247 5.44621 10.4332 5.51101 10.3217C5.57988 10.2177 5.63858 10.1051 5.68731 9.98425ZM6.72105 7.00152L8.00144 3.32827L9.28183 7.00152H6.72105Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"rect",attrs:{width:11.58,height:2.56,x:2.21,y:12.2,fill:"colorChannel1",rx:1.28}}]}]},c$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"font-color",ref:e,icon:DSe}))});c$.displayName="FontColor";var RSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_680",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_680)"},children:[{tag:"path",attrs:{d:"M14.3159 4.65399C14.6867 4.65399 14.872 4.42863 14.872 3.97791C14.872 3.75982 14.8248 3.59262 14.7303 3.47631C14.6358 3.35272 14.5013 3.29093 14.3268 3.29093H12.8765V1.78611C12.8765 1.41536 12.6512 1.22998 12.2004 1.22998C11.9751 1.22998 11.8042 1.28087 11.6879 1.38264C11.5716 1.47715 11.5135 1.608 11.5135 1.77521V3.29093H10.1831C9.95048 3.29093 9.77964 3.34909 9.6706 3.4654C9.56882 3.58172 9.51793 3.75255 9.51793 3.97791C9.51793 4.196 9.56882 4.36321 9.6706 4.47952C9.77237 4.59584 9.93957 4.65399 10.1722 4.65399H11.5135V6.137C11.5135 6.36963 11.5716 6.54047 11.6879 6.64951C11.8042 6.75129 11.9751 6.80218 12.2004 6.80218C12.4185 6.80218 12.5857 6.75129 12.702 6.64951C12.8184 6.54774 12.8765 6.38054 12.8765 6.14791V4.65399H14.3159Z"}},{tag:"path",attrs:{d:"M3.46657 13.1976L4.233 11.0479H9.18675L10.2149 13.908C10.2772 14.1198 10.3707 14.2881 10.4953 14.4127C10.6324 14.5498 10.8068 14.6121 11.0187 14.5996C11.3427 14.5996 11.5484 14.4999 11.6356 14.3005C11.7228 14.0887 11.7166 13.8332 11.6169 13.5341L7.67259 2.07502C7.61027 1.87562 7.49811 1.71984 7.3361 1.60768C7.17409 1.48306 6.96224 1.42075 6.70053 1.42075C6.45128 1.42075 6.24566 1.48306 6.08365 1.60768C5.9341 1.71984 5.82817 1.87562 5.76586 2.07502L1.84024 13.4967C1.70316 13.9204 1.70316 14.207 1.84024 14.3566C1.97733 14.5186 2.17049 14.5996 2.41974 14.5996C2.55682 14.5996 2.67521 14.556 2.77491 14.4688C2.88707 14.394 2.98054 14.2881 3.05531 14.151C3.14255 14.0139 3.21732 13.8643 3.27963 13.7023C3.34194 13.5403 3.40426 13.3721 3.46657 13.1976ZM6.71922 3.32748L8.85027 9.73932H4.58817L6.71922 3.32748Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},d$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"font-size-increase-single",ref:e,icon:RSe}))});d$.displayName="FontSizeIncreaseSingle";var ISe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_683",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_683)"},children:[{tag:"path",attrs:{d:"M3.38645 13.2745L4.16166 11.1001H9.17214L10.2121 13.993C10.2751 14.2073 10.3696 14.3774 10.4957 14.5035C10.6343 14.6421 10.8108 14.7052 11.0251 14.6926C11.3528 14.6926 11.5608 14.5917 11.649 14.39C11.7373 14.1758 11.731 13.9174 11.6301 13.6148L7.64064 2.02456C7.57761 1.82288 7.46417 1.66531 7.3003 1.55187C7.13644 1.42582 6.92215 1.36279 6.65745 1.36279C6.40535 1.36279 6.19737 1.42582 6.0335 1.55187C5.88224 1.66531 5.7751 1.82288 5.71207 2.02456L1.7415 13.577C1.60285 14.0056 1.60285 14.2955 1.7415 14.4468C1.88016 14.6106 2.07554 14.6926 2.32764 14.6926C2.46629 14.6926 2.58604 14.6484 2.68688 14.5602C2.80032 14.4846 2.89486 14.3774 2.97049 14.2388C3.05872 14.1001 3.13435 13.9489 3.19738 13.785C3.2604 13.6211 3.32343 13.451 3.38645 13.2745ZM6.67636 3.29136L8.83181 9.77662H4.5209L6.67636 3.29136Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M13.8056 3.96584C14.1806 3.96584 14.3681 3.7379 14.3681 3.28202C14.3681 3.06143 14.3203 2.89232 14.2248 2.77467C14.1292 2.64967 13.9931 2.58717 13.8167 2.58717H10.177C9.94168 2.58717 9.76889 2.646 9.6586 2.76364C9.55566 2.88129 9.50418 3.05408 9.50418 3.28202C9.50418 3.50996 9.55566 3.68276 9.6586 3.8004C9.76154 3.9107 9.93065 3.96584 10.1659 3.96584H13.8056Z"}}]}]},m$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"font-size-reduce-single-single",ref:e,icon:ISe}))});m$.displayName="FontSizeReduceSingleSingle";var ASe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_765",style:{maskType:"alpha"},width:16,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#CDCDCD",d:"M0 0H16V16.55H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_765)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3332 1.37891C14.0696 1.37891 14.6666 1.9962 14.6666 2.75765V13.7876C14.6666 14.5491 14.0696 15.1664 13.3332 15.1664H2.66655C1.93018 15.1664 1.33322 14.5491 1.33322 13.7876V2.75765C1.33322 1.99619 1.93017 1.37891 2.66655 1.37891H13.3332ZM5.66655 2.75765H5.62777L2.66655 5.48001V6.69813L5.66655 3.83458V2.75765ZM6.99989 4.1331V2.75765H13.3332V13.7876H6.99989V10.3604C7.00025 10.3472 7.00025 10.3341 6.99989 10.3209V7.24154C6.9999 7.23945 6.9999 7.23737 6.99989 7.23528V4.13936C6.9999 4.13727 6.9999 4.13519 6.99989 4.1331ZM5.66655 5.71092L2.66655 8.57447V9.80031L5.66655 6.93676V5.71092ZM5.66655 8.8131L2.66655 11.6767V12.9975L5.66655 10.0454V8.8131ZM5.66655 11.9487L3.79779 13.7876H5.66655V11.9487ZM3.62105 2.75765L2.66655 3.63515V2.75765H3.62105Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},f$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"freeze-column-single",ref:e,icon:ASe}))});f$.displayName="FreezeColumnSingle";var TSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.0438 1.37891H13.3332C14.0696 1.37891 14.6666 1.99621 14.6666 2.75766V13.7876C14.6666 14.5491 14.0696 15.1664 13.3332 15.1664H2.66656C1.93018 15.1664 1.33322 14.5491 1.33322 13.7876V2.75766C1.33322 1.9962 1.93018 1.37891 2.66656 1.37891H12.0376C12.0396 1.3789 12.0417 1.3789 12.0438 1.37891ZM8.89802 5.88004L12.2944 2.75766H13.3332V3.1422L10.3892 5.88004H8.89802ZM6.89129 5.88004L10.2877 2.75766H8.96106L5.56469 5.88004H6.89129ZM6.95433 2.75766L3.55795 5.88004H2.66656V5.48L5.62776 2.75766H6.95433ZM12.3831 5.88004H13.3332V4.99649L12.3831 5.88004ZM2.66656 3.63515L3.62104 2.75766H2.66656V3.63515ZM2.66656 7.25878H13.3332V13.7876H2.66656V7.25878Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.0438 1.37891H13.3333C14.0696 1.37891 14.6666 1.99621 14.6666 2.75766V13.7876C14.6666 14.5491 14.0696 15.1664 13.3333 15.1664H2.66659C1.93021 15.1664 1.33325 14.5491 1.33325 13.7876V2.75766C1.33325 1.9962 1.93021 1.37891 2.66659 1.37891H12.0376C12.0396 1.3789 12.0417 1.3789 12.0438 1.37891ZM8.89805 5.88004L12.2944 2.75766H13.3333V3.1422L10.3892 5.88004H8.89805ZM6.89131 5.88004L10.2877 2.75766H8.96109L5.56471 5.88004H6.89131ZM6.95435 2.75766L3.55798 5.88004H2.66659V5.48L5.62779 2.75766H6.95435ZM12.3831 5.88004H13.3333V4.99649L12.3831 5.88004ZM2.66659 3.63515L3.62107 2.75766H2.66659V3.63515ZM2.66659 7.25878H13.3333V13.7876H2.66659V7.25878Z",fillRule:"evenodd",clipRule:"evenodd"}}]},h$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"freeze-row-single",ref:e,icon:TSe}))});h$.displayName="FreezeRowSingle";var wSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_721",style:{maskType:"alpha"},width:16,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16.55H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_721)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3335 1.37866C14.0699 1.37866 14.6668 1.99595 14.6668 2.75741V13.7874C14.6668 14.5489 14.0699 15.1661 13.3335 15.1661H2.66683C1.93046 15.1661 1.3335 14.5489 1.3335 13.7874V2.75741C1.3335 1.99595 1.93045 1.37866 2.66683 1.37866H13.3335ZM13.3335 6.54896V4.70313L11.3997 6.54896H13.3335ZM9.43397 6.54896L13.2146 2.94023C13.2517 2.90486 13.2916 2.87466 13.3335 2.84959V2.75741H11.9291L7.99087 6.54896H9.43397ZM7.00016 7.92771H13.3335V13.7874H7.00016V10.3685C7.0009 10.3498 7.0009 10.331 7.00016 10.3123V7.92771ZM5.66683 13.7874V11.9383L3.76985 13.7874H5.66683ZM5.66683 8.78641V10.0435L2.66683 12.9678V11.6747L5.66683 8.78641ZM9.97243 2.75741L2.66683 9.79085V8.57945L8.92354 2.75741H9.97243ZM5.62805 2.75741H6.93026L2.66683 6.72465V5.47976L5.62805 2.75741ZM3.62132 2.75741L2.66683 3.63491V2.75741H3.62132Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},p$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"freeze-to-selected-single",ref:e,icon:wSe}))});p$.displayName="FreezeToSelectedSingle";var LSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.71141 2.48718C2.81434 2.23868 3.05682 2.07666 3.32579 2.07666H11.7978C11.9742 2.07666 12.1433 2.14672 12.268 2.27143L13.1445 3.14785C13.4042 3.40755 13.4042 3.8286 13.1445 4.0883C12.8848 4.348 12.4637 4.348 12.204 4.0883L11.5224 3.40666H4.93124L9.05451 7.52993C9.31421 7.78963 9.31421 8.21069 9.05451 8.47039L4.93124 12.5937H11.5224L12.204 11.912C12.4637 11.6523 12.8848 11.6523 13.1445 11.912C13.4042 12.1717 13.4042 12.5928 13.1445 12.8525L12.268 13.7289C12.1433 13.8536 11.9742 13.9237 11.7978 13.9237H3.32579C3.05682 13.9237 2.81434 13.7616 2.71141 13.5131C2.60848 13.2647 2.66537 12.9786 2.85556 12.7884L7.64383 8.00016L2.85556 3.21189C2.66537 3.0217 2.60848 2.73567 2.71141 2.48718Z",fillRule:"evenodd",clipRule:"evenodd"}}]},g$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"function-single",ref:e,icon:LSe}))});g$.displayName="FunctionSingle";var OSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1151",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1151)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.01519 4.9156C7.65059 4.9156 7.29055 4.96431 6.93757 5.05194C6.6062 5.1342 6.2709 4.93226 6.18864 4.60089C6.10638 4.26953 6.30831 3.93422 6.63968 3.85196C7.0796 3.74275 7.53991 3.6792 8.01519 3.6792C9.93752 3.6792 11.6225 4.71575 12.781 5.67605C13.3691 6.16346 13.8434 6.64946 14.171 7.01358C14.3351 7.19604 14.4633 7.34895 14.5515 7.45755C14.5956 7.51187 14.6298 7.5552 14.6535 7.58568C14.6653 7.60092 14.6745 7.61296 14.6811 7.62157L14.6889 7.63188L14.6913 7.63506L14.6921 7.63614C14.6921 7.63614 14.6927 7.63689 14.1972 8.0066C14.6927 8.37631 14.6925 8.37646 14.6925 8.37646L14.6921 8.37705L14.6913 8.37814L14.6889 8.38131L14.6811 8.39163C14.6745 8.40023 14.6653 8.41227 14.6535 8.42752C14.6298 8.458 14.5956 8.50132 14.5515 8.55565C14.4633 8.66425 14.3351 8.81715 14.171 8.99961C13.8434 9.36373 13.3691 9.84973 12.781 10.3371C12.5182 10.555 12.1284 10.5186 11.9106 10.2557C11.6927 9.99285 11.7291 9.60313 11.992 9.38524C12.5227 8.94536 12.9537 8.50406 13.2518 8.1727C13.3051 8.11347 13.354 8.05788 13.3984 8.0066C13.354 7.95531 13.3051 7.89972 13.2518 7.84049C12.9537 7.50913 12.5227 7.06783 11.992 6.62795C10.9131 5.73365 9.50709 4.9156 8.01519 4.9156ZM14.1972 8.0066L14.6925 8.37646C14.8562 8.15715 14.8563 7.8562 14.6927 7.63689L14.1972 8.0066ZM4.11981 5.75748C4.3377 6.02035 4.30123 6.41007 4.03837 6.62795C3.50769 7.06783 3.07669 7.50913 2.7786 7.84049C2.72531 7.89972 2.67639 7.95531 2.63203 8.0066C2.67639 8.05788 2.72531 8.11347 2.7786 8.17271C3.07669 8.50406 3.50769 8.94536 4.03837 9.38524C5.11729 10.2795 6.5233 11.0976 8.01519 11.0976C8.38283 11.0976 8.74582 11.0481 9.10157 10.9591C9.43279 10.8762 9.76846 11.0776 9.85131 11.4088C9.93417 11.74 9.73283 12.0757 9.40162 12.1585C8.95841 12.2694 8.49443 12.334 8.01519 12.334C6.09287 12.334 4.40788 11.2974 3.24935 10.3371C2.66132 9.84973 2.18698 9.36373 1.85941 8.99961C1.69527 8.81715 1.56704 8.66425 1.47887 8.55565C1.43476 8.50132 1.4006 8.458 1.37692 8.42752C1.36508 8.41227 1.35585 8.40023 1.3493 8.39162L1.34149 8.38131L1.3391 8.37813L1.33829 8.37705C1.33829 8.37705 1.33773 8.37631 1.8332 8.0066C1.33773 7.63689 1.33785 7.63673 1.33785 7.63673L1.3391 7.63506L1.34149 7.63188L1.3493 7.62157C1.35585 7.61296 1.36508 7.60092 1.37692 7.58568C1.4006 7.5552 1.43476 7.51187 1.47887 7.45755C1.56704 7.34895 1.69527 7.19604 1.85941 7.01358C2.18698 6.64946 2.66132 6.16346 3.24935 5.67605C3.51221 5.45816 3.90193 5.49462 4.11981 5.75748ZM1.8332 8.0066L1.33785 7.63673C1.1742 7.85604 1.17464 8.15774 1.33829 8.37705L1.8332 8.0066Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M3.8775 2.99454C3.63608 2.75312 3.24466 2.75312 3.00323 2.99454C2.76181 3.23596 2.76181 3.62739 3.00323 3.86881L6.11167 6.97725C5.94588 7.28339 5.85153 7.63423 5.85153 8.00647C5.85153 9.20144 6.82025 10.1702 8.01523 10.1702C8.38756 10.1702 8.73834 10.0758 9.04444 9.91001L12.1095 12.9751C12.3509 13.2165 12.7424 13.2165 12.9838 12.9751C13.2252 12.7337 13.2252 12.3422 12.9838 12.1008L3.8775 2.99454ZM8.0668 8.93237L7.08932 7.9549C7.0884 7.97197 7.08793 7.98916 7.08793 8.00647C7.08793 8.5186 7.5031 8.93377 8.01523 8.93377C8.03254 8.93377 8.04973 8.9333 8.0668 8.93237Z"}}]}]},v$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"hide",ref:e,icon:OSe}))});v$.displayName="Hide";var PSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_208_115",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16 0H32V16H16z",transform:"rotate(90 16 0)"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_208_115)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{d:"M13.3334 1.33325C14.0698 1.33325 14.6667 1.9302 14.6667 2.66657L14.6667 5.3332C14.6667 6.06957 14.0698 6.66652 13.3334 6.66652L2.6669 6.66652C1.93053 6.66652 1.33358 6.06957 1.33358 5.3332L1.33358 2.66657C1.33358 1.9302 1.93053 1.33325 2.6669 1.33325L13.3334 1.33325zM13.3334 2.66657L13.3334 5.3332 10.6739 5.3332 10.6739 2.66657 13.3334 2.66657zM9.34056 2.66657L6.65977 2.66657 6.65977 5.3332 9.34056 5.3332 9.34056 2.66657zM2.6669 2.66657L5.32645 2.66657 5.32645 5.3332 2.6669 5.3332 2.6669 2.66657zM13.3334 9.33315C14.0698 9.33315 14.6667 9.9301 14.6667 10.6665L14.6667 13.3331C14.6667 14.0695 14.0698 14.6664 13.3334 14.6664L2.6669 14.6664C1.93053 14.6664 1.33358 14.0695 1.33358 13.3331L1.33358 10.6665C1.33358 9.9301 1.93053 9.33315 2.6669 9.33315L13.3334 9.33315zM13.3334 10.6665L13.3334 13.3331 10.6739 13.3331 10.6739 10.6665 13.3334 10.6665zM9.34056 10.6665L6.65977 10.6665 6.65977 13.3331 9.34056 13.3331 9.34056 10.6665zM2.6669 10.6665L5.32645 10.6665 5.32645 13.3331 2.6669 13.3331 2.6669 10.6665z"}}]}]},b$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"horizontal-merge-single",ref:e,icon:PSe}))});b$.displayName="HorizontalMergeSingle";var MSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_824",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z",transform:"matrix(-1 0 0 1 16 0)"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_824)"},children:[{tag:"path",attrs:{d:"M14 2.3501C14.359 2.3501 14.65 2.64111 14.65 3.0001 14.65 3.35908 14.359 3.6501 14 3.6501L2.00002 3.6501C1.64104 3.6501 1.35002 3.35908 1.35002 3.0001 1.35002 2.64111 1.64104 2.3501 2.00002 2.3501L14 2.3501zM12.7 5.68347C13.059 5.68347 13.35 5.97449 13.35 6.33347 13.35 6.69246 13.059 6.98347 12.7 6.98347L3.36669 6.98347C3.0077 6.98347 2.71669 6.69246 2.71669 6.33347 2.71669 5.97449 3.0077 5.68347 3.36669 5.68347L12.7 5.68347zM14.65 9.66672C14.65 9.30774 14.359 9.01672 14 9.01672L2.00002 9.01672C1.64104 9.01672 1.35002 9.30774 1.35002 9.66672 1.35002 10.0257 1.64104 10.3167 2.00002 10.3167L14 10.3167C14.359 10.3167 14.65 10.0257 14.65 9.66672zM12.7 12.3501C13.059 12.3501 13.35 12.6411 13.35 13.0001 13.35 13.3591 13.059 13.6501 12.7 13.6501L3.36668 13.6501C3.0077 13.6501 2.71669 13.3591 2.71669 13.0001 2.71669 12.6411 3.0077 12.3501 3.36668 12.3501L12.7 12.3501z"}}]}]},_$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"horizontally-single",ref:e,icon:MSe}))});_$.displayName="HorizontallySingle";var NSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1307",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1307)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 11.9997V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H3.99992V13.333H2.66659L2.66659 11.9997H1.33325ZM3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301ZM1.33325 9.33301H2.66659V6.66634H1.33325V9.33301ZM6.66659 1.33301V2.66634H9.33325V1.33301H6.66659ZM11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999ZM14.6666 6.66634H13.3333V9.33301H14.6666V6.66634ZM14.6666 11.9997H13.3333V13.333H11.9999V14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V11.9997ZM9.33325 14.6663V13.333H6.66659V14.6663H9.33325Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.66693 7.33415V2.66748H7.3336V7.33415H2.66693V8.66748H7.3336V13.3341H8.66693V8.66748H13.3336V7.33415H8.66693Z"}}]}]},C$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"inner-border",ref:e,icon:NSe}))});C$.displayName="InnerBorder";var xSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1113",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1113)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.66105 5.44796C7.66105 5.07977 7.36257 4.7813 6.99439 4.7813H3.22403C2.85583 4.7813 2.55736 5.07977 2.55736 5.44796V10.5516C2.55736 10.9198 2.85583 11.2183 3.22403 11.2183H6.99439C7.36257 11.2183 7.66105 10.9198 7.66105 10.5516V5.44796ZM2.55736 3.50537C1.85268 3.50537 1.28143 4.07662 1.28143 4.7813V11.2183C1.28143 11.923 1.85268 12.4942 2.55736 12.4942H7.66105C8.3657 12.4942 8.93697 11.923 8.93697 11.2183V4.7813C8.93697 4.07662 8.3657 3.50537 7.66105 3.50537H2.55736Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.9225 10.465C11.9977 10.4962 12.0802 10.5134 12.1667 10.5134C12.2532 10.5134 12.3357 10.4962 12.4109 10.465C12.4862 10.4338 12.5567 10.3877 12.6178 10.3265L14.5317 8.41263C14.7808 8.16349 14.7808 7.75956 14.5317 7.51042C14.2826 7.26128 13.8786 7.26128 13.6295 7.51042L12.8047 8.33523V6.14333C12.8047 5.791 12.5191 5.50537 12.1667 5.50537C11.8144 5.50537 11.5288 5.791 11.5288 6.14333V8.33523L10.7039 7.51042C10.4548 7.26128 10.0509 7.26128 9.80172 7.51042C9.55258 7.75956 9.55258 8.16349 9.80172 8.41263L11.7153 10.3262"}}]}]},S$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"insert-cell-down",ref:e,icon:xSe}))});S$.displayName="InsertCellDown";var FSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1108",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1108)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.56614 5.44796C7.56614 5.07977 7.26766 4.7813 6.89948 4.7813H3.12912C2.76092 4.7813 2.46245 5.07977 2.46245 5.44796V10.5516C2.46245 10.9198 2.76092 11.2183 3.12912 11.2183H6.89948C7.26766 11.2183 7.56614 10.9198 7.56614 10.5516V5.44796ZM2.46245 3.50537C1.75777 3.50537 1.18652 4.07662 1.18652 4.7813V11.2183C1.18652 11.923 1.75777 12.4942 2.46245 12.4942H7.56614C8.27079 12.4942 8.84206 11.923 8.84206 11.2183V4.7813C8.84206 4.07662 8.27079 3.50537 7.56614 3.50537H2.46245Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M14.7651 8.2438C14.7963 8.16858 14.8135 8.0861 14.8135 7.9996C14.8135 7.9131 14.7963 7.83062 14.7651 7.7554C14.7339 7.68015 14.6878 7.60966 14.6266 7.54849L12.7127 5.63461C12.4636 5.38547 12.0597 5.38547 11.8105 5.63461C11.5614 5.88375 11.5614 6.28768 11.8105 6.53682L12.6353 7.36164H10.4434C10.0911 7.36164 9.80548 7.64727 9.80548 7.9996C9.80548 8.35194 10.0911 8.63756 10.4434 8.63756H12.6353L11.8105 9.46238C11.5614 9.71152 11.5614 10.1155 11.8105 10.3646C12.0597 10.6137 12.4636 10.6137 12.7127 10.3646L14.6263 8.45101"}}]}]},E$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"insert-cell-shift-right",ref:e,icon:FSe}))});E$.displayName="InsertCellShiftRight";var $Se={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1128",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1128)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 13.4087C14.0697 13.4087 14.6666 12.8117 14.6666 12.0754L14.6666 9.40869C14.6666 8.67231 14.0697 8.07536 13.3333 8.07536L2.66663 8.07536C1.93023 8.07536 1.33329 8.67231 1.33329 9.40869L1.33329 12.0754C1.33329 12.8117 1.93023 13.4087 2.66663 13.4087L13.3333 13.4087ZM2.66663 12.0754L13.3333 12.0754L13.3333 9.40869L2.66663 9.40869L2.66663 12.0754Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.74168 2.59137C8.10987 2.59137 8.40835 2.88984 8.40835 3.25804L8.40835 4.33309L9.48348 4.33309C9.85167 4.33309 10.1501 4.63156 10.1501 4.99976C10.1501 5.36794 9.85167 5.66642 9.48348 5.66642L8.40835 5.66642L8.40835 6.74154C8.40835 7.10973 8.10987 7.4082 7.74168 7.4082C7.37349 7.4082 7.07501 7.10973 7.07501 6.74154L7.07501 5.66642L5.99998 5.66642C5.63179 5.66642 5.33331 5.36794 5.33331 4.99976C5.33331 4.63156 5.63179 4.33309 5.99998 4.33309L7.07501 4.33309L7.07501 3.25804C7.07501 2.88984 7.37349 2.59137 7.74168 2.59137Z"}}]}]},y$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"insert-row-above",ref:e,icon:$Se}))});y$.displayName="InsertRowAbove";var kSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1133",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16 16H32V32H16z",transform:"rotate(180 16 16)"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1133)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.66671 2.59131C1.93033 2.59131 1.33337 3.18826 1.33337 3.92464L1.33337 6.59131C1.33337 7.32769 1.93033 7.92464 2.66671 7.92464L13.3334 7.92464C14.0698 7.92464 14.6667 7.32769 14.6667 6.59131L14.6667 3.92464C14.6667 3.18826 14.0698 2.59131 13.3334 2.59131L2.66671 2.59131ZM13.3334 3.92464L2.66671 3.92464L2.66671 6.59131L13.3334 6.59131L13.3334 3.92464Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M8.25838 13.4086C7.8902 13.4086 7.59172 13.1102 7.59172 12.742L7.59172 11.6669L6.51658 11.6669C6.14839 11.6669 5.84992 11.3684 5.84991 11.0002C5.84991 10.6321 6.14839 10.3336 6.51658 10.3336L7.59172 10.3336L7.59171 9.25846C7.59171 8.89027 7.89019 8.5918 8.25838 8.5918C8.62657 8.5918 8.92505 8.89027 8.92505 9.25846L8.92505 10.3336L10.0001 10.3336C10.3683 10.3336 10.6667 10.6321 10.6667 11.0002C10.6667 11.3684 10.3683 11.6669 10.0001 11.6669L8.92505 11.6669L8.92505 12.742C8.92505 13.1102 8.62658 13.4086 8.25838 13.4086Z"}}]}]},D$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"insert-row-below",ref:e,icon:kSe}))});D$.displayName="InsertRowBelow";var BSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_233_16",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_233_16)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.53337 14C2.35658 14 2.18704 13.9297 2.06203 13.8047C1.93703 13.6797 1.86681 13.5101 1.86681 13.3333C1.86681 13.1565 1.93703 12.987 2.06203 12.862C2.18704 12.7369 2.35658 12.6667 2.53337 12.6667L13.4667 12.6667C13.6435 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1333 13.1565 14.1333 13.3333C14.1333 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6435 14 13.4667 14L2.53337 14ZM2.53337 3.33333C2.35658 3.33331 2.18703 3.26306 2.06203 3.13804C1.93703 3.01301 1.86681 2.84346 1.86681 2.66667C1.86681 2.48987 1.93703 2.32032 2.06203 2.1953C2.18703 2.07028 2.35658 2.00003 2.53337 2L13.4667 2C13.6435 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1333 2.48987 14.1333 2.66667C14.1333 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6435 3.33331 13.4667 3.33333L2.53337 3.33333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M11.0573 7.33327L10.1953 6.47127C10.0703 6.34627 10.0001 6.17672 10.0001 5.99994C10.0001 5.82315 10.0703 5.65361 10.1953 5.52861C10.3203 5.4036 10.4899 5.33337 10.6667 5.33337C10.8434 5.33337 11.013 5.4036 11.138 5.52861L13.138 7.5286C13.2 7.59046 13.2491 7.66393 13.2827 7.74481C13.3162 7.82569 13.3335 7.91238 13.3335 7.99994C13.3335 8.08749 13.3162 8.17419 13.2827 8.25507C13.2491 8.33594 13.2 8.40941 13.138 8.47127L11.138 10.4713C11.0761 10.5332 11.0026 10.5823 10.9217 10.6158C10.8409 10.6493 10.7542 10.6665 10.6667 10.6665C10.5791 10.6665 10.4925 10.6493 10.4116 10.6158C10.3307 10.5823 10.2572 10.5332 10.1953 10.4713C10.1334 10.4094 10.0843 10.3359 10.0508 10.255C10.0173 10.1742 10.0001 10.0875 10.0001 9.99994C10.0001 9.9124 10.0173 9.82573 10.0508 9.74486C10.0843 9.66398 10.1334 9.5905 10.1953 9.52861L11.0573 8.6666L3.33333 8.66661C3.15652 8.66661 2.98695 8.59637 2.86193 8.47134C2.7369 8.34632 2.66666 8.17675 2.66666 7.99994C2.66666 7.82313 2.7369 7.65356 2.86193 7.52853C2.98695 7.40351 3.15652 7.33327 3.33333 7.33327L11.0573 7.33327Z"}}]}]},R$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"insert",ref:e,icon:BSe}))});R$.displayName="Insert";var USe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_665",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_665)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.83907 1.88446C6.83907 1.53487 7.12248 1.25146 7.47207 1.25146H10.1923C10.5419 1.25146 10.8253 1.53487 10.8253 1.88446C10.8253 2.23405 10.5419 2.51745 10.1923 2.51745H9.45384L7.87906 13.4827H8.52812C8.87772 13.4827 9.16112 13.7661 9.16112 14.1157C9.16112 14.4653 8.87772 14.7487 8.52812 14.7487H5.80786C5.45827 14.7487 5.17487 14.4653 5.17487 14.1157C5.17487 13.7661 5.45827 13.4827 5.80786 13.4827H6.5952L8.16999 2.51745H7.47207C7.12248 2.51745 6.83907 2.23405 6.83907 1.88446Z"}}]}]},I$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"italic-single",ref:e,icon:USe}))});I$.displayName="ItalicSingle";var VSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_883",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_883)"},children:[{tag:"path",attrs:{d:"M3.86841 6.47418C3.77908 6.51118 3.68333 6.53023 3.58663 6.53023V6.52876C3.39153 6.52876 3.20443 6.45126 3.06647 6.3133 2.92852 6.17535 2.85102 5.98824 2.85102 5.79315 2.85102 5.59805 2.92852 5.41094 3.06647 5.27299 3.20443 5.13504 3.39153 5.05754 3.58663 5.05754 3.68333 5.05754 3.77908 5.07658 3.86841 5.11359 3.95775 5.15059 4.03893 5.20483 4.1073 5.27321 4.17568 5.34158 4.22992 5.42276 4.26692 5.51209 4.30393 5.60143 4.32297 5.69718 4.32297 5.79388 4.32297 5.89058 4.30393 5.98633 4.26692 6.07567 4.22992 6.16501 4.17568 6.24618 4.1073 6.31456 4.03893 6.38293 3.95775 6.43717 3.86841 6.47418zM4.10678 8.52013C4.24474 8.38218 4.32224 8.19508 4.32224 7.99998 4.32224 7.80488 4.24474 7.61778 4.10678 7.47982 3.96883 7.34187 3.78172 7.26437 3.58663 7.26437 3.39153 7.26437 3.20443 7.34187 3.06647 7.47982 2.92852 7.61778 2.85102 7.80488 2.85102 7.99998 2.85102 8.19508 2.92852 8.38218 3.06647 8.52013 3.20443 8.65809 3.39153 8.73559 3.58663 8.73559 3.78172 8.73559 3.96883 8.65809 4.10678 8.52013zM4.10678 10.727C3.96883 10.8649 3.78172 10.9424 3.58663 10.9424 3.39153 10.9424 3.20443 10.8649 3.06647 10.727 2.92852 10.589 2.85102 10.4019 2.85102 10.2068 2.85102 10.0117 2.92852 9.82461 3.06647 9.68666 3.20443 9.5487 3.39153 9.4712 3.58663 9.4712 3.78172 9.4712 3.96883 9.5487 4.10678 9.68666 4.24474 9.82461 4.32224 10.0117 4.32224 10.2068 4.32224 10.4019 4.24474 10.589 4.10678 10.727zM6.47336 6.07471C6.51024 5.98542 6.52917 5.88975 6.52907 5.79315 6.52888 5.59805 6.45119 5.41102 6.3131 5.27321 6.175 5.13539 5.98782 5.05808 5.79272 5.05827 5.59763 5.05847 5.4106 5.13615 5.27279 5.27425 5.13497 5.41234 5.05765 5.59952 5.05785 5.79462 5.05795 5.89122 5.07707 5.98686 5.11413 6.07607 5.15118 6.16528 5.20545 6.24632 5.27383 6.31456 5.3422 6.3828 5.42335 6.4369 5.51263 6.47378 5.60192 6.51066 5.69759 6.52959 5.7942 6.52949 5.8908 6.5294 5.98643 6.51027 6.07565 6.47322 6.16486 6.43616 6.2459 6.38189 6.31414 6.31352 6.38238 6.24514 6.43648 6.16399 6.47336 6.07471zM6.07497 8.67959C5.98572 8.71656 5.89006 8.73559 5.79346 8.73559 5.59836 8.73559 5.41126 8.65809 5.27331 8.52013 5.13535 8.38218 5.05785 8.19508 5.05785 7.99998 5.05785 7.80488 5.13535 7.61778 5.27331 7.47982 5.41126 7.34187 5.59836 7.26437 5.79346 7.26437 5.89006 7.26437 5.98572 7.2834 6.07497 7.32036 6.16422 7.35733 6.24531 7.41152 6.31362 7.47982 6.38192 7.54813 6.43611 7.62922 6.47308 7.71847 6.51005 7.80772 6.52907 7.90338 6.52907 7.99998 6.52907 8.09658 6.51005 8.19224 6.47308 8.28149 6.43611 8.37073 6.38192 8.45183 6.31362 8.52013 6.24531 8.58844 6.16422 8.64263 6.07497 8.67959zM8.68019 6.07471C8.71707 5.98542 8.736 5.88975 8.73591 5.79315 8.73571 5.59805 8.65802 5.41102 8.51993 5.27321 8.38184 5.13539 8.19465 5.05808 7.99956 5.05827 7.80446 5.05847 7.61743 5.13615 7.47962 5.27425 7.3418 5.41234 7.26449 5.59952 7.26468 5.79462 7.26478 5.89122 7.2839 5.98686 7.32096 6.07607 7.35802 6.16528 7.41228 6.24632 7.48066 6.31456 7.54904 6.3828 7.63018 6.4369 7.71947 6.47378 7.80875 6.51066 7.90443 6.52959 8.00103 6.52949 8.09763 6.5294 8.19327 6.51027 8.28248 6.47322 8.37169 6.43616 8.45273 6.38189 8.52097 6.31352 8.58921 6.24514 8.64331 6.16399 8.68019 6.07471zM8.2818 8.67959C8.19255 8.71656 8.0969 8.73559 8.00029 8.73559 7.8052 8.73559 7.61809 8.65809 7.48014 8.52013 7.34219 8.38218 7.26468 8.19508 7.26468 7.99998 7.26468 7.80488 7.34219 7.61778 7.48014 7.47982 7.61809 7.34187 7.8052 7.26437 8.00029 7.26437 8.0969 7.26437 8.19255 7.2834 8.2818 7.32036 8.37105 7.35733 8.45214 7.41152 8.52045 7.47982 8.58876 7.54813 8.64294 7.62922 8.67991 7.71847 8.71688 7.80772 8.73591 7.90338 8.73591 7.99998 8.73591 8.09658 8.71688 8.19224 8.67991 8.28149 8.64294 8.37073 8.58876 8.45183 8.52045 8.52013 8.45214 8.58844 8.37105 8.64263 8.2818 8.67959zM10.887 6.07471C10.9239 5.98542 10.9428 5.88975 10.9427 5.79315 10.9425 5.59805 10.8649 5.41102 10.7268 5.27321 10.5887 5.13539 10.4015 5.05808 10.2064 5.05827 10.0113 5.05847 9.82427 5.13615 9.68645 5.27425 9.54864 5.41234 9.47132 5.59952 9.47152 5.79462 9.47161 5.89122 9.49074 5.98686 9.52779 6.07607 9.56485 6.16528 9.61912 6.24632 9.68749 6.31456 9.75587 6.3828 9.83702 6.4369 9.9263 6.47378 10.0156 6.51066 10.1113 6.52959 10.2079 6.52949 10.3045 6.5294 10.4001 6.51027 10.4893 6.47322 10.5785 6.43616 10.6596 6.38189 10.7278 6.31352 10.796 6.24514 10.8501 6.16399 10.887 6.07471zM10.4886 8.67959C10.3994 8.71656 10.3037 8.73559 10.2071 8.73559 10.012 8.73559 9.82493 8.65809 9.68697 8.52013 9.54902 8.38218 9.47152 8.19508 9.47152 7.99998 9.47152 7.80488 9.54902 7.61778 9.68697 7.47982 9.82493 7.34187 10.012 7.26437 10.2071 7.26437 10.3037 7.26437 10.3994 7.2834 10.4886 7.32036 10.5779 7.35733 10.659 7.41152 10.7273 7.47982 10.7956 7.54813 10.8498 7.62922 10.8867 7.71847 10.9237 7.80772 10.9427 7.90338 10.9427 7.99998 10.9427 8.09658 10.9237 8.19224 10.8867 8.28149 10.8498 8.37073 10.7956 8.45183 10.7273 8.52013 10.659 8.58844 10.5779 8.64263 10.4886 8.67959zM13.0939 6.07471C13.1307 5.98542 13.1497 5.88975 13.1496 5.79315 13.1494 5.59805 13.0717 5.41102 12.9336 5.27321 12.7955 5.13539 12.6083 5.05808 12.4132 5.05827 12.2181 5.05847 12.0311 5.13615 11.8933 5.27425 11.7555 5.41234 11.6782 5.59952 11.6784 5.79462 11.6784 5.89122 11.6976 5.98686 11.7346 6.07607 11.7717 6.16528 11.826 6.24632 11.8943 6.31456 11.9627 6.3828 12.0438 6.4369 12.1331 6.47378 12.2224 6.51066 12.3181 6.52959 12.4147 6.52949 12.5113 6.5294 12.6069 6.51027 12.6961 6.47322 12.7854 6.43616 12.8664 6.38189 12.9346 6.31352 13.0029 6.24514 13.057 6.16399 13.0939 6.07471zM12.6955 8.67959C12.6062 8.71656 12.5106 8.73559 12.414 8.73559 12.2189 8.73559 12.0318 8.65809 11.8938 8.52013 11.7559 8.38218 11.6784 8.19508 11.6784 7.99998 11.6784 7.80488 11.7559 7.61778 11.8938 7.47982 12.0318 7.34187 12.2189 7.26437 12.414 7.26437 12.5106 7.26437 12.6062 7.2834 12.6955 7.32036 12.7847 7.35733 12.8658 7.41152 12.9341 7.47982 13.0024 7.54813 13.0566 7.62922 13.0936 7.71847 13.1305 7.80772 13.1496 7.90338 13.1496 7.99998 13.1496 8.09658 13.1305 8.19224 13.0936 8.28149 13.0566 8.37073 13.0024 8.45183 12.9341 8.52013 12.8658 8.58844 12.7847 8.64263 12.6955 8.67959zM12.9341 10.727C13.0721 10.589 13.1496 10.4019 13.1496 10.2068 13.1496 10.0117 13.0721 9.82461 12.9341 9.68666 12.7962 9.5487 12.6091 9.4712 12.414 9.4712 12.2189 9.4712 12.0318 9.5487 11.8938 9.68666 11.7559 9.82461 11.6784 10.0117 11.6784 10.2068 11.6784 10.4019 11.7559 10.589 11.8938 10.727 12.0318 10.8649 12.2189 10.9424 12.414 10.9424 12.6091 10.9424 12.7962 10.8649 12.9341 10.727zM5.27331 9.68666C5.41126 9.5487 5.59836 9.4712 5.79346 9.4712H10.2071C10.4022 9.4712 10.5893 9.5487 10.7273 9.68666 10.8652 9.82461 10.9427 10.0117 10.9427 10.2068 10.9427 10.4019 10.8652 10.589 10.7273 10.727 10.5893 10.8649 10.4022 10.9424 10.2071 10.9424H5.79346C5.59836 10.9424 5.41126 10.8649 5.27331 10.727 5.13535 10.589 5.05785 10.4019 5.05785 10.2068 5.05785 10.0117 5.13535 9.82461 5.27331 9.68666z"}},{tag:"path",attrs:{d:"M0.353607 4.4953C0.353607 3.43951 1.20949 2.58362 2.26529 2.58362H13.7354C14.7911 2.58362 15.647 3.43951 15.647 4.4953V11.5048C15.647 12.5606 14.7911 13.4165 13.7354 13.4165H2.26529C1.20949 13.4165 0.353607 12.5606 0.353607 11.5048V4.4953ZM2.26529 3.85807H13.7354C14.0873 3.85807 14.3726 4.14337 14.3726 4.4953V11.5048C14.3726 11.8567 14.0873 12.142 13.7354 12.142H2.26529C1.91335 12.142 1.62806 11.8567 1.62806 11.5048V4.4953C1.62806 4.14337 1.91335 3.85807 2.26529 3.85807Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},A$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"keyboard-single",ref:e,icon:VSe}))});A$.displayName="KeyboardSingle";var HSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1292",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1292)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M14.6664 3.99967L14.6664 2.66634C14.6664 1.92996 14.0694 1.33301 13.333 1.33301L11.9997 1.33301 11.9997 2.66634 13.333 2.66634 13.333 3.99967 14.6664 3.99967zM6.66638 1.33301L6.66638 2.66634 9.33305 2.66634 9.33305 1.33301 6.66638 1.33301zM14.6664 6.66634L13.333 6.66634 13.333 7.33301 10.6664 7.33301 10.6664 8.66634 13.333 8.66634 13.333 9.33301 14.6664 9.33301 14.6664 6.66634zM14.6664 11.9997L13.333 11.9997 13.333 13.333 11.9997 13.333 11.9997 14.6663 13.333 14.6663C14.0694 14.6663 14.6664 14.0694 14.6664 13.333L14.6664 11.9997zM9.33305 14.6663L9.33305 13.333 8.66638 13.333 8.66638 10.6663 7.33305 10.6663 7.33305 13.333 6.66638 13.333 6.66638 14.6663 9.33305 14.6663zM2.66638 7.33301L5.33305 7.33301 5.33305 8.66634 2.66638 8.66634 2.66638 7.33301zM8.66638 5.33301L8.66638 2.66634 7.33305 2.66634 7.33305 5.33301 8.66638 5.33301z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.66667 1.33301L4 1.33301L4 2.66634L2.66667 2.66634L2.66667 13.333L4 13.333L4 14.6663L2.66667 14.6663C1.93029 14.6663 1.33333 14.0694 1.33333 13.333L1.33333 2.66634C1.33333 1.92996 1.93029 1.33301 2.66667 1.33301Z"}}]}]},T$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"left-border",ref:e,icon:HSe}))});T$.displayName="LeftBorder";var jSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_29",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.46 0.72H16.46V16.72H0.46z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_29)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.75537 3.11333L14.8806 8.21036L14.3808 9.30132L4.52076 4.78394L9.03813 14.644L7.94718 15.1438L2.85015 4.01855L2.5419 3.87733L2.66368 3.61154L2.52319 3.30491L2.8788 3.14199L3.04172 2.78638L3.34836 2.92686L3.61415 2.80509L3.75537 3.11333Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M1.80017 12.8102L1.80017 14.1743C1.80017 14.8371 2.33743 15.3743 3.00017 15.3743L4.3643 15.3743L4.3643 14.0443L3.13017 14.0443L3.13017 12.8102L1.80017 12.8102ZM4.3643 2.06128L3.00017 2.06128C2.33743 2.06128 1.80017 2.59854 1.80017 3.26128L1.80017 4.62541L3.13017 4.62541L3.13017 3.39128L4.3643 3.39128L4.3643 2.06128ZM1.80017 10.0819L3.13017 10.0819L3.13017 7.35367L1.80017 7.35367L1.80017 10.0819ZM7.09256 2.06128L7.09256 3.39128L9.82081 3.39128L9.82081 2.06128L7.09256 2.06128ZM12.5491 2.06128L12.5491 3.39128L13.7832 3.39128L13.7832 4.62541L15.1132 4.62541L15.1132 3.26128C15.1132 2.59854 14.5759 2.06128 13.9132 2.06128L12.5491 2.06128ZM15.1132 7.35367L13.7832 7.35367L13.7832 10.0819L15.1132 10.0819L15.1132 7.35367ZM15.1132 12.8102L13.7832 12.8102L13.7832 14.0443L12.5491 14.0443L12.5491 15.3743L13.9132 15.3743C14.5759 15.3743 15.1132 14.8371 15.1132 14.1743L15.1132 12.8102ZM9.82082 15.3743L9.82082 14.0443L7.09256 14.0443L7.09256 15.3743L9.82082 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},w$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"left-double-diagonal-single",ref:e,icon:jSe}))});w$.displayName="LeftDoubleDiagonalSingle";var zSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1118",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1118)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.4322 2.66683C13.4322 1.93045 12.8352 1.3335 12.0989 1.3335H9.43219C8.69581 1.3335 8.09886 1.93045 8.09886 2.66683V13.3335C8.09886 14.0699 8.69581 14.6668 9.43219 14.6668H12.0989C12.8352 14.6668 13.4322 14.0699 13.4322 13.3335V2.66683ZM12.0989 13.3335V2.66683H9.43219V13.3335H12.0989Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M2.56769 7.99978C2.56769 7.63159 2.86616 7.33311 3.23435 7.33311H4.30941V6.25798C4.30941 5.88979 4.60788 5.59131 4.97607 5.59131C5.34426 5.59131 5.64274 5.88979 5.64274 6.25798V7.33311H6.71785C7.08604 7.33311 7.38452 7.63159 7.38452 7.99978C7.38452 8.36797 7.08604 8.66644 6.71785 8.66644H5.64274V9.74148C5.64274 10.1097 5.34426 10.4081 4.97607 10.4081C4.60788 10.4081 4.30941 10.1097 4.30941 9.74148V8.66644H3.23435C2.86616 8.66644 2.56769 8.36797 2.56769 7.99978Z"}}]}]},L$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"left-insert-column",ref:e,icon:zSe}))});L$.displayName="LeftInsertColumn";var WSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_818",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_818)"},children:[{tag:"path",attrs:{d:"M1.99998 2.3501C1.64099 2.3501 1.34998 2.64111 1.34998 3.0001 1.34998 3.35908 1.64099 3.6501 1.99998 3.6501H14C14.359 3.6501 14.65 3.35908 14.65 3.0001 14.65 2.64111 14.359 2.3501 14 2.3501H1.99998zM1.99998 5.68347C1.64099 5.68347 1.34998 5.97449 1.34998 6.33347 1.34998 6.69246 1.64099 6.98347 1.99998 6.98347H11.3333C11.6923 6.98347 11.9833 6.69246 11.9833 6.33347 11.9833 5.97449 11.6923 5.68347 11.3333 5.68347H1.99998zM1.34998 9.66672C1.34998 9.30774 1.64099 9.01672 1.99998 9.01672H14C14.359 9.01672 14.65 9.30774 14.65 9.66672 14.65 10.0257 14.359 10.3167 14 10.3167H1.99998C1.64099 10.3167 1.34998 10.0257 1.34998 9.66672zM1.99998 12.3501C1.64099 12.3501 1.34998 12.6411 1.34998 13.0001 1.34998 13.3591 1.64099 13.6501 1.99998 13.6501H11.3333C11.6923 13.6501 11.9833 13.3591 11.9833 13.0001 11.9833 12.6411 11.6923 12.3501 11.3333 12.3501H1.99998z"}}]}]},O$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"left-justifying-single",ref:e,icon:WSe}))});O$.displayName="LeftJustifyingSingle";var YSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_802",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_802)"},children:[{tag:"path",attrs:{d:"M2.56751 1.8681C2.30914 1.77869 2.0135 1.85136 1.81075 2.05412C1.60799 2.25687 1.53532 2.55251 1.62473 2.81088L4.36865 10.7403C4.49493 11.1052 4.89961 11.2812 5.27252 11.1335C5.64543 10.9857 5.84537 10.5701 5.71909 10.2051L4.95118 7.986L7.74263 5.19455L9.96175 5.96246C10.3267 6.08874 10.7423 5.8888 10.8901 5.51589C11.0379 5.14298 10.8618 4.7383 10.4969 4.61202L2.56751 1.8681ZM6.28892 4.69149L4.44812 6.53229L3.47404 3.71741L6.28892 4.69149Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M4.68352 13.4124C4.39713 13.6988 4.38399 14.15 4.65417 14.4202C4.92434 14.6903 5.37552 14.6772 5.66191 14.3908L12.8953 7.15741L12.8654 8.18547C12.8539 8.57901 13.1636 8.88875 13.5572 8.87729C13.9507 8.86583 14.2791 8.5375 14.2905 8.14396L14.3706 5.39558C14.379 5.10737 14.2129 4.85259 13.9499 4.75006C13.6868 4.64752 13.3785 4.71741 13.1688 4.92714L4.68352 13.4124Z"}}]}]},P$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"left-rotation-forty-five-degrees-single",ref:e,icon:YSe}))});P$.displayName="LeftRotationFortyFiveDegreesSingle";var XSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1 7.65022C1 7.39606 1.14813 7.16522 1.37917 7.05932L5.37917 5.22599 5.37918 5.22599 6.71251 4.61489 6.71251 4.61489 9.37917 3.39266C9.70551 3.24308 10.0913 3.38638 10.2409 3.71272 10.3905 4.03906 10.2472 4.42487 9.92083 4.57444L7.63333 5.62288 7.63333 9.67755 9.92083 10.726C10.2472 10.8756 10.3905 11.2614 10.2409 11.5877 10.0913 11.9141 9.70551 12.0573 9.37917 11.9078L6.71251 10.6855 6.71251 10.6855 5.37918 10.0744 5.37917 10.0744 1.37917 8.24111C1.14813 8.13521 1 7.90437 1 7.65022zM6.33333 9.08172L6.33333 6.21871 5.92083 6.40777 5.92082 6.40778 3.21004 7.65022 5.92082 8.89266 5.92083 8.89266 6.33333 9.08172zM12.3165 14.3C11.9575 14.3 11.6665 14.009 11.6665 13.65L11.6665 1.65005C11.6665 1.38715 11.8249 1.15014 12.0678 1.04953 12.3106.948919 12.5902 1.00453 12.7761 1.19043L14.7761 3.19043C15.03 3.44427 15.03 3.85583 14.7761 4.10967 14.5223 4.36351 14.1107 4.36351 13.8569 4.10967L12.9665 3.21929 12.9665 13.65C12.9665 14.009 12.6755 14.3 12.3165 14.3z",fillRule:"evenodd",clipRule:"evenodd"}}]},M$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"left-rotation-ninety-degrees-single",ref:e,icon:XSe}))});M$.displayName="LeftRotationNinetyDegreesSingle";var qSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_43",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.33 0.72H16.33V16.72H0.33z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_43)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.33875 3.57255L2.23657 3.79614L2.72883 4.0211L7.58275 14.6428L8.67419 14.144L5.10931 6.34311L13.5649 14.7987L14.4134 13.9502L5.96172 5.49847L13.7573 9.0609L14.2561 7.96947L3.63438 3.11555L3.40942 2.62329L3.18782 2.72456L3.09973 2.63647L2.93861 2.7976L2.73534 2.70471L2.60444 2.99116L2.31799 3.12206L2.41088 3.32533L2.2512 3.485L2.33875 3.57255Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M1.6759 12.8102L1.6759 14.1743C1.6759 14.8371 2.21316 15.3743 2.8759 15.3743L4.24003 15.3743L4.24003 14.0443L3.0059 14.0443L3.0059 12.8102L1.6759 12.8102ZM4.24003 2.06128L2.8759 2.06128C2.21316 2.06128 1.6759 2.59854 1.6759 3.26128L1.6759 4.62541L3.0059 4.62541L3.0059 3.39128L4.24003 3.39128L4.24003 2.06128ZM1.6759 10.0819L3.0059 10.0819L3.0059 7.35367L1.6759 7.35367L1.6759 10.0819ZM6.96829 2.06128L6.96829 3.39128L9.69655 3.39128L9.69655 2.06128L6.96829 2.06128ZM12.4248 2.06128L12.4248 3.39128L13.6589 3.39128L13.6589 4.62541L14.9889 4.62541L14.9889 3.26128C14.9889 2.59854 14.4517 2.06128 13.7889 2.06128L12.4248 2.06128ZM14.9889 7.35367L13.6589 7.35367L13.6589 10.0819L14.9889 10.0819L14.9889 7.35367ZM14.9889 12.8102L13.6589 12.8102L13.6589 14.0443L12.4248 14.0443L12.4248 15.3743L13.7889 15.3743C14.4517 15.3743 14.9889 14.8371 14.9889 14.1743L14.9889 12.8102ZM9.69655 15.3743L9.69655 14.0443L6.96829 14.0443L6.96829 15.3743L9.69655 15.3743Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},N$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"left-tridiagonal-single",ref:e,icon:qSe}))});N$.displayName="LeftTridiagonalSingle";var GSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.8633 11.8572C11.4471 11.8572 11.1617 11.4381 11.314 11.0509L11.9863 9.34214C12.1412 8.94851 12.1396 8.51053 11.9818 8.11806L11.4089 6.69339C11.2455 6.28701 11.5447 5.84424 11.9827 5.84424 12.244 5.84424 12.4771 6.00846 12.5651 6.25451L12.7509 6.77419C12.8553 7.10705 12.9666 7.45015 13.078 7.78333 13.0811 7.79284 13.09 7.79924 13.1001 7.79924 13.1109 7.79924 13.1204 7.79175 13.1228 7.78116 13.2 7.44866 13.297 7.10633 13.3803 6.77419L13.5115 6.28141C13.5801 6.02363 13.8135 5.84424 14.0803 5.84424 14.4911 5.84424 14.7756 6.25454 14.6315 6.63929L14.0014 8.32119C13.8524 8.71892 13.8614 9.1586 14.0265 9.54991L14.6386 11.0006C14.8101 11.4072 14.5116 11.8572 14.0702 11.8572 13.8163 11.8572 13.5882 11.7015 13.4957 11.465L13.2813 10.9167C13.163 10.5736 13.0447 10.2202 12.9197 9.89686 12.916 9.88732 12.9068 9.88106 12.8966 9.88106 12.8856 9.88106 12.876 9.88821 12.8729 9.89867 12.7756 10.2211 12.6784 10.5638 12.5811 10.9167L12.4297 11.4331C12.3559 11.6845 12.1253 11.8572 11.8633 11.8572zM8.12225 12.0051C7.3796 12.0051 6.92694 11.1809 6.92694 10.177 6.92694 9.24653 7.28484 8.629 8.09563 8.26591 8.67092 8.00828 9.18404 7.19689 8.55369 7.19689 8.45538 7.19689 8.35572 7.21504 8.25304 7.25009 7.84274 7.39015 7.34547 7.29003 7.20055 6.88142 7.11632 6.64391 7.18093 6.37494 7.38339 6.22488 7.8222 5.89963 8.29004 5.69629 8.79417 5.69629 9.83388 5.69629 10.4209 6.56283 10.4209 8.44387V11.3055C10.4209 11.6102 10.1739 11.8572 9.86923 11.8572H9.70003C9.5248 11.8572 9.37583 11.7292 9.34939 11.556L9.30611 11.2725C9.30456 11.2624 9.29582 11.2548 9.28554 11.2548 9.27898 11.2548 9.27279 11.258 9.26884 11.2632 8.93798 11.7025 8.56504 12.0051 8.12225 12.0051zM8.55369 10.5468C8.76134 10.5468 8.91254 10.4273 9.061 10.2228 9.1309 10.1265 9.16196 10.0082 9.16196 9.8892 9.16196 9.48618 8.76554 9.15197 8.44124 9.39126 8.20998 9.56189 8.12225 9.78088 8.12225 10.029 8.12225 10.3777 8.292 10.5468 8.55369 10.5468zM1.56583 11.8572C1.25333 11.8572 1 11.6038 1 11.2913V4.76013C1 4.33749 1.34262 3.99487 1.76526 3.99487 2.11748 3.99487 2.42421 4.23529 2.50836 4.5773L3.19965 7.38707C3.30448 7.83605 3.38859 8.32628 3.48609 8.80682 3.48815 8.81698 3.49708 8.82427 3.50745 8.82427 3.5177 8.82427 3.52656 8.81713 3.52874 8.80712 3.63309 8.32648 3.71713 7.83614 3.81499 7.38707L4.48124 4.58411C4.56334 4.23869 4.87191 3.99487 5.22694 3.99487 5.65026 3.99487 5.99342 4.33804 5.99342 4.76135V11.2807C5.99342 11.5991 5.73534 11.8572 5.41699 11.8572 5.09863 11.8572 4.84055 11.5991 4.84055 11.2807V9.16243C4.84055 8.38585 4.9382 7.22366 5.0019 6.45208 5.00262 6.44331 4.99568 6.43599 4.98688 6.43599 4.97988 6.43599 4.97381 6.44081 4.97222 6.44762L4.53642 8.31702 3.91204 10.8545C3.86336 11.0523 3.68591 11.1914 3.48215 11.1914 3.27878 11.1914 3.10156 11.0528 3.05251 10.8555L2.42164 8.31702 1.99991 6.44769C1.99837 6.44085 1.99229 6.43599 1.98527 6.43599 1.9765 6.43599 1.96958 6.44329 1.9703 6.45203 2.034 7.22361 2.13165 8.38583 2.13165 9.16243V11.2913C2.13165 11.6038 1.87832 11.8572 1.56583 11.8572z"}}]},x$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"max-single",ref:e,icon:GSe}))});x$.displayName="MaxSingle";var KSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_115_2341",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_115_2341)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.79376 2.88516C5.79376 2.77895 5.71024 2.69285 5.60722 2.69285H3.26403C3.16101 2.69285 3.0775 2.77895 3.0775 2.88516L3.07751 7.12712C3.07751 7.23332 3.16103 7.31942 3.26405 7.31942H4.86645C4.93259 7.31942 4.99378 7.28331 5.02729 7.22452C5.06079 7.16573 5.06158 7.09304 5.02938 7.03348C4.89248 6.78029 4.92868 6.45457 5.13708 6.23972C5.38899 5.98001 5.79743 5.98 6.04936 6.2397L7.28561 7.51414C7.40659 7.63886 7.47456 7.80801 7.47456 7.98439C7.47456 8.16077 7.4066 8.32993 7.28562 8.45465L6.04936 9.72914C5.79745 9.98885 5.389 9.98885 5.13709 9.72914C4.92869 9.5143 4.89248 9.1886 5.02936 8.93541C5.06156 8.87585 5.06076 8.80317 5.02725 8.74438C4.99375 8.68559 4.93256 8.64948 4.86642 8.64948H3.26405C3.16103 8.64948 3.07751 8.73558 3.07751 8.84179L3.07751 13.1151C3.07751 13.2213 3.16103 13.3074 3.26405 13.3074H5.60723C5.71025 13.3074 5.79377 13.2213 5.79377 13.1151L5.79377 11.0592C5.79377 10.6919 6.08258 10.3942 6.43885 10.3942C6.79512 10.3942 7.08393 10.6919 7.08393 11.0592L7.08393 13.5438C7.08393 14.1478 6.60895 14.6375 6.02304 14.6375H2.84824C2.26233 14.6375 1.78735 14.1478 1.78735 13.5438L1.78734 2.45649C1.78734 1.85246 2.26231 1.36279 2.84822 1.36279H6.02303C6.60894 1.36279 7.08391 1.85246 7.08391 2.45649L7.08393 4.72612C7.08393 5.0934 6.79512 5.39115 6.43885 5.39115C6.08258 5.39115 5.79377 5.0934 5.79377 4.72612L5.79376 2.88516ZM10.2062 13.1151C10.2062 13.2213 10.2897 13.3074 10.3928 13.3074H12.736C12.7854 13.3074 12.8329 13.2872 12.8679 13.2511C12.9028 13.215 12.9225 13.1661 12.9225 13.1151L12.9225 8.84178C12.9225 8.73558 12.839 8.64948 12.736 8.64948H11.1336C11.0674 8.64948 11.0062 8.68559 10.9727 8.74438C10.9392 8.80317 10.9384 8.87586 10.9706 8.93542C11.1075 9.18861 11.0713 9.51433 10.8629 9.72918C10.611 9.98889 10.2026 9.9889 9.95065 9.7292L8.71439 8.45476C8.59341 8.33004 8.52544 8.16089 8.52544 7.98451C8.52544 7.80813 8.5934 7.63897 8.71438 7.51425L9.95064 6.23976C10.2026 5.98005 10.611 5.98005 10.8629 6.23976C11.0713 6.4546 11.1075 6.7803 10.9706 7.03349C10.9384 7.09305 10.9392 7.16573 10.9728 7.22452C11.0063 7.28331 11.0674 7.31942 11.1336 7.31942H12.736C12.839 7.31942 12.9225 7.23332 12.9225 7.12711L12.9225 2.88518C12.9225 2.83417 12.9028 2.78526 12.8678 2.74919C12.8329 2.71313 12.7854 2.69287 12.7359 2.69287L10.3928 2.69287C10.2897 2.69287 10.2062 2.77897 10.2062 2.88518L10.2062 4.90972C10.2062 5.277 9.91742 5.57474 9.56115 5.57474C9.20488 5.57474 8.91607 5.277 8.91607 4.90972L8.91606 2.45651C8.91606 1.85248 9.39103 1.36281 9.97694 1.36281L13.1517 1.36281C13.7377 1.36281 14.2126 1.85248 14.2126 2.45651L14.2127 13.5438C14.2127 14.1478 13.7377 14.6375 13.1518 14.6375H9.97696C9.39105 14.6375 8.91607 14.1478 8.91607 13.5438L8.91607 11.2428C8.91607 10.8755 9.20488 10.5778 9.56115 10.5778C9.91742 10.5778 10.2062 10.8755 10.2062 11.2428L10.2062 13.1151Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},F$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"merge-all-single",ref:e,icon:KSe}))});F$.displayName="MergeAllSingle";var ZSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.4552 12.291C11.0537 12.291 10.7282 11.9655 10.7282 11.564V6.91262C10.7282 6.56217 11.0123 6.27807 11.3627 6.27807H11.541C11.7575 6.27807 11.9405 6.43857 11.9687 6.65322L12.0152 7.00736C12.0168 7.01938 12.027 7.02837 12.0391 7.02837 12.0465 7.02837 12.0535 7.02501 12.0581 7.01925 12.4429 6.53712 12.9173 6.13013 13.5459 6.13013 14.5646 6.13013 15 7.07064 15 8.57124V11.5599C15 11.9637 14.6727 12.291 14.2689 12.291 13.8651 12.291 13.5377 11.9637 13.5377 11.5599V8.80373C13.5377 7.97946 13.3652 7.7364 12.9955 7.7364 12.3404 7.7364 12.1822 8.63362 12.1822 9.28872V11.564C12.1822 11.9655 11.8567 12.291 11.4552 12.291zM8.81616 12.291C8.41463 12.291 8.08913 11.9655 8.08913 11.564V7.00507C8.08913 6.60354 8.41463 6.27804 8.81616 6.27804 9.21769 6.27804 9.54319 6.60354 9.54319 7.00507V11.564C9.54319 11.9655 9.21769 12.291 8.81616 12.291zM8.82027 5.30198C8.32736 5.30198 7.98233 5.04163 7.98233 4.48155 7.98233 3.9109 8.32736 3.70899 8.82027 3.70899 9.30496 3.70899 9.64999 3.9109 9.64999 4.48155 9.64999 5.04163 9.30496 5.30198 8.82027 5.30198zM1.6572 12.291C1.29424 12.291 1 11.9968 1 11.6338V5.33251C1 4.83336 1.40465 4.42871 1.9038 4.42871 2.30732 4.42871 2.66194 4.69619 2.77282 5.08418L3.55488 7.82091C3.67641 8.26904 3.77396 8.75828 3.88695 9.23796 3.88973 9.24977 3.90027 9.25811 3.91241 9.25811 3.92439 9.25811 3.93484 9.24998 3.93777 9.23836 4.05868 8.75856 4.15614 8.26917 4.26959 7.82091L5.02278 5.09275C5.13109 4.70044 5.488 4.42871 5.89499 4.42871 6.39472 4.42871 6.79983 4.83382 6.79983 5.33355V11.6215C6.79983 11.9913 6.50008 12.291 6.13031 12.291 5.76054 12.291 5.46078 11.9913 5.46078 11.6215V9.59627C5.46078 8.82068 5.57391 7.66049 5.6479 6.8889 5.64889 6.87856 5.64073 6.86983 5.63034 6.86983 5.62239 6.86983 5.61542 6.87516 5.61334 6.88284L5.10753 8.75086 4.39679 11.2377C4.33123 11.4671 4.12153 11.6252 3.88293 11.6252 3.64486 11.6252 3.43549 11.4678 3.36946 11.239L2.65123 8.75086 2.16176 6.88293C2.15973 6.87521 2.15276 6.86983 2.14478 6.86983 2.13442 6.86983 2.1263 6.87852 2.12729 6.88883 2.20127 7.66042 2.31441 8.82066 2.31441 9.59627V11.6338C2.31441 11.9968 2.02017 12.291 1.6572 12.291z"}}]},$$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"min-single",ref:e,icon:ZSe}))});$$.displayName="MinSingle";var QSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.629584 3.99986C1.13729 3.4922 1.9604 3.49224 2.46806 3.99995L7.57569 9.10806C7.81 9.3424 8.18992 9.3424 8.42424 9.10808L13.5323 3.99998C14.04 3.4923 14.8631 3.4923 15.3708 3.99998C15.8785 4.50766 15.8785 5.33078 15.3708 5.83846L9.41415 11.7951C8.63307 12.5762 7.36669 12.5762 6.58565 11.7951L0.629497 5.83834C0.121839 5.33063 0.121879 4.50752 0.629584 3.99986Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},k$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"more-down-single",ref:e,icon:QSe}))});k$.displayName="MoreDownSingle";const SA=k$;var JSe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8 3.30078C8.55228 3.30078 9 2.85307 9 2.30078 9 1.7485 8.55228 1.30078 8 1.30078 7.44772 1.30078 7 1.7485 7 2.30078 7 2.85307 7.44772 3.30078 8 3.30078zM8 9.00012C8.55228 9.00012 9 8.55241 9 8.00012 9 7.44784 8.55228 7.00012 8 7.00012 7.44772 7.00012 7 7.44784 7 8.00012 7 8.55241 7.44772 9.00012 8 9.00012zM9 13.6995C9 14.2517 8.55228 14.6995 8 14.6995 7.44772 14.6995 7 14.2517 7 13.6995 7 13.1472 7.44772 12.6995 8 12.6995 8.55228 12.6995 9 13.1472 9 13.6995z"}}]},B$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"more-function-single",ref:e,icon:JSe}))});B$.displayName="MoreFunctionSingle";const eEe=B$;var tEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.45493 2.80093C5.74783 2.49409 6.2227 2.49409 6.5156 2.80093L11.0156 7.51523C11.3085 7.82207 11.3085 8.31956 11.0156 8.6264L6.44488 13.27C6.15199 13.5768 5.67711 13.5768 5.38422 13.27C5.09133 12.9631 5.09133 12.4656 5.38422 12.1588L9.28804 8.20898C9.36409 8.13203 9.36517 8.00855 9.29047 7.93029L5.45493 3.9121C5.16204 3.60526 5.16204 3.10777 5.45493 2.80093Z",fillRule:"evenodd",clipRule:"evenodd"}}]},U$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"more-single",ref:e,icon:tEe}))});U$.displayName="MoreSingle";const EA=U$;var nEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_727",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_727)"},children:[{tag:"path",attrs:{d:"M1.33325 11.9997V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H3.99992V13.333H2.66659L2.66659 11.9997H1.33325zM3.99992 1.33301H2.66659C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V3.99967H2.66659V2.66634L3.99992 2.66634V1.33301zM1.33325 9.33301H2.66659V6.66634H1.33325V9.33301zM6.66659 1.33301V2.66634H7.33325V5.33301H8.66659V2.66634H9.33325V1.33301H6.66659zM11.9999 1.33301V2.66634H13.3333V3.99967H14.6666V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H11.9999zM14.6666 6.66634H13.3333V7.33301H10.6666V8.66634H13.3333V9.33301H14.6666V6.66634zM14.6666 11.9997H13.3333V13.333H11.9999V14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V11.9997zM9.33325 14.6663V13.333H8.66659V10.6663H7.33325V13.333H6.66659V14.6663H9.33325zM5.33325 7.33301H2.66659V8.66634H5.33325V7.33301z"}}]}]},V$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"no-border-single",ref:e,icon:nEe}))});V$.displayName="NoBorderSingle";var rEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.665 2.66496H3.33496C2.96493 2.66496 2.66496 2.96493 2.66496 3.33496V12.665C2.66496 13.035 2.96493 13.335 3.33496 13.335H12.665C13.035 13.335 13.335 13.035 13.335 12.665V3.33496C13.335 2.96493 13.035 2.66496 12.665 2.66496ZM3.33496 1.33496C2.23039 1.33496 1.33496 2.23039 1.33496 3.33496V12.665C1.33496 13.7695 2.23039 14.665 3.33496 14.665H12.665C13.7695 14.665 14.665 13.7695 14.665 12.665V3.33496C14.665 2.23039 13.7695 1.33496 12.665 1.33496H3.33496Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.2559 14.1963L1.64941 2.58984L2.58987 1.64939L14.1963 13.2558L13.2559 14.1963Z",fillRule:"evenodd",clipRule:"evenodd"}}]},H$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"no-color",ref:e,icon:rEe}))});H$.displayName="NoColor";var iEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_837",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_837)"},children:[{tag:"path",attrs:{d:"M8.6162 1.81215C8.5058 1.58491 8.26513 1.43921 8.00015 1.43921C7.73517 1.43921 7.4945 1.58491 7.3841 1.81215L3.99571 8.78653C3.83977 9.10751 3.98917 9.48697 4.3294 9.63409C4.66964 9.78121 5.07187 9.64026 5.22781 9.31929L6.1761 7.36743H9.8242L10.7725 9.31929C10.9284 9.64026 11.3307 9.78121 11.6709 9.63409C12.0111 9.48697 12.1605 9.10751 12.0046 8.78653L8.6162 1.81215ZM9.203 6.0888H6.7973L8.00015 3.61294L9.203 6.0888Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M2.35535 11.5384C1.98108 11.5384 1.67767 11.8246 1.67767 12.1777C1.67767 12.5308 1.98108 12.817 2.35535 12.817H12.0086L11.3172 13.4692C11.0526 13.7189 11.0526 14.1237 11.3172 14.3734C11.5819 14.623 12.0109 14.623 12.2756 14.3734L14.1238 12.6298C14.3176 12.4469 14.3756 12.1719 14.2707 11.933C14.1658 11.6942 13.9187 11.5384 13.6446 11.5384H2.35535Z"}}]}]},j$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"no-rotation-single",ref:e,icon:iEe}))});j$.displayName="NoRotationSingle";var oEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.51995 2.97553V4.05556C2.51995 4.20314 2.40031 4.32277 2.25273 4.32277 1.99376 4.32277 1.78552 4.53558 1.78552 4.79266 1.78552 5.05273 1.99617 5.268 2.25813 5.268H3.79178C4.0528 5.268 4.26439 5.0564 4.26439 4.79538V4.73058C4.26439 4.50535 4.08181 4.32277 3.85658 4.32277 3.74181 4.32277 3.64878 4.22973 3.64878 4.11496V2.2753C3.64878 1.9268 3.36626 1.64429 3.01776 1.64429 2.90079 1.64429 2.78946 1.6779 2.69146 1.73053 2.60678 1.77601 2.52066 1.81604 2.43309 1.85066 2.36308 1.87641 2.28441 1.90095 2.1969 1.9242 2.01199 1.97332 1.87193 2.13768 1.87193 2.33645 1.87193 2.56569 2.05776 2.75152 2.28699 2.75152H2.39102C2.44754 2.75152 2.47095 2.77114 2.48663 2.79752 2.5076 2.83279 2.51995 2.89182 2.51995 2.97553zM2.44236 8.57463C2.25925 8.75469 2.05589 8.94849 1.83342 9.15489 1.73778 9.24362 1.68286 9.36822 1.68286 9.49914 1.68286 9.75751 1.89231 9.96695 2.15067 9.96695H3.87813C4.14809 9.96695 4.36694 9.7481 4.36694 9.47814 4.36694 9.20818 4.14809 8.98933 3.87813 8.98933H3.69452C3.61457 8.98933 3.51752 8.99502 3.40408 9.00599 3.3951 9.00686 3.38702 9.00742 3.37978 9.00772 3.38531 9.00042 3.39121 8.99339 3.39703 8.98702 3.48454 8.89119 3.57143 8.79192 3.65769 8.68923 3.81284 8.50084 3.94171 8.30707 4.0425 8.10935 4.14934 7.90689 4.20493 7.70398 4.20493 7.50168 4.20493 7.25963 4.15099 7.04339 4.03964 6.85648 3.92927 6.67122 3.77684 6.52864 3.58408 6.43014 3.39133 6.32802 3.17162 6.27844 2.9277 6.27844 2.66431 6.27844 2.43247 6.32541 2.23568 6.42364 2.13314 6.47293 2.0319 6.5373 1.93191 6.61601 1.72495 6.77891 1.74295 7.07397 1.91374 7.24476L1.92445 7.25547C2.10562 7.43664 2.36002 7.39218 2.53538 7.26592L2.53746 7.26438C2.59991 7.21692 2.69069 7.20207 2.79809 7.20207 2.90267 7.20207 2.97626 7.23265 3.02979 7.28618L3.03324 7.28946C3.0837 7.33534 3.11931 7.41625 3.11931 7.55568 3.11931 7.683 3.06737 7.83056 2.94838 8.00055 2.82714 8.17375 2.65901 8.36508 2.44236 8.57463zM2.15675 14.5286C2.37685 14.6213 2.6318 14.666 2.91918 14.666 3.16754 14.666 3.39917 14.6265 3.61311 14.5463L3.61457 14.5457C3.82983 14.4611 4.00647 14.3385 4.14099 14.1763L4.14174 14.1753C4.28016 14.0043 4.34762 13.7978 4.34762 13.5616 4.34762 13.3256 4.28018 13.124 4.13854 12.9657 4.04579 12.862 3.93491 12.7796 3.80706 12.7178 3.92064 12.6476 4.01399 12.565 4.08476 12.4689 4.18868 12.3277 4.23962 12.1631 4.23962 11.9794 4.23962 11.6419 4.11412 11.3728 3.8591 11.1863 3.61341 11.0004 3.28947 10.9127 2.89758 10.9127 2.67593 10.9127 2.46633 10.9548 2.26979 11.0395 2.18775 11.074 2.10703 11.1147 2.02762 11.1617 1.79307 11.3003 1.78093 11.6074 1.93867 11.7981 2.10549 11.9998 2.38732 12.0017 2.59195 11.8957 2.67058 11.8565 2.75752 11.8363 2.85438 11.8363 2.96071 11.8363 3.02179 11.86 3.05567 11.8898 3.08709 11.9174 3.11079 11.9642 3.11079 12.0496 3.11079 12.1326 3.0772 12.1981 2.99843 12.2527 2.95714 12.2795 2.88579 12.3042 2.77465 12.32 2.55847 12.3508 2.36556 12.5239 2.36556 12.7624 2.36556 12.9995 2.55719 13.178 2.77994 13.1988 2.86307 13.2066 2.92903 13.2178 2.97927 13.2315 3.09334 13.2617 3.14926 13.3004 3.17229 13.3331 3.20183 13.3749 3.21879 13.4278 3.21879 13.4968 3.21879 13.5709 3.19116 13.6188 3.13234 13.6541 3.06327 13.6955 2.96259 13.7208 2.82198 13.7208 2.71626 13.7208 2.60883 13.6961 2.49885 13.6446 2.27649 13.531 1.96371 13.5423 1.79775 13.7721L1.79042 13.7823C1.66619 13.9543 1.65996 14.2176 1.85686 14.3602 1.9473 14.4257 2.04778 14.4819 2.15675 14.5286zM6.31718 2.78943C5.94899 2.78943 5.65051 3.08791 5.65051 3.4561 5.65051 3.82429 5.94899 4.12276 6.31718 4.12276H13.6505C14.0187 4.12276 14.3172 3.82429 14.3172 3.4561 14.3172 3.08791 14.0187 2.78943 13.6505 2.78943H6.31718zM5.65051 8.12272C5.65051 7.75453 5.94899 7.45605 6.31718 7.45605H13.6505C14.0187 7.45605 14.3172 7.75453 14.3172 8.12272 14.3172 8.49091 14.0187 8.78939 13.6505 8.78939H6.31718C5.94899 8.78939 5.65051 8.49091 5.65051 8.12272zM6.31718 12.1227C5.94899 12.1227 5.65051 12.4212 5.65051 12.7893 5.65051 13.1575 5.94899 13.456 6.31718 13.456H13.6505C14.0187 13.456 14.3172 13.1575 14.3172 12.7893 14.3172 12.4212 14.0187 12.1227 13.6505 12.1227H6.31718z"}}]},z$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"order-single",ref:e,icon:oEe}))});z$.displayName="OrderSingle";var aEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1302",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1302)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 2.66634H2.66659V13.333H13.3333V2.66634ZM2.66659 1.33301C1.93021 1.33301 1.33325 1.92996 1.33325 2.66634V13.333C1.33325 14.0694 1.93021 14.6663 2.66659 14.6663H13.3333C14.0696 14.6663 14.6666 14.0694 14.6666 13.333V2.66634C14.6666 1.92996 14.0696 1.33301 13.3333 1.33301H2.66659Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M7.33311 2.66748V5.33415H8.66644V2.66748H7.33311zM7.33311 10.6675V13.3341H8.66644V10.6675H7.33311zM13.3331 7.33415H10.6664V8.66748H13.3331V7.33415zM5.33311 7.33415H2.66644V8.66748H5.33311V7.33415z"}}]}]},W$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"outer-border",ref:e,icon:aEe}))});W$.displayName="OuterBorder";var sEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_793",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_793)"},children:[{tag:"path",attrs:{d:"M4.92151 7.3238C4.52279 7.3238 4.19956 7.61767 4.19956 7.98018 4.19956 8.34268 4.52279 8.63655 4.92151 8.63655H11.9974L11.551 9.04728C11.2708 9.30514 11.2735 9.72073 11.5571 9.97552 11.8407 10.2303 12.2979 10.2278 12.5781 9.96996L14.231 8.4491C14.5105 8.19193 14.5086 7.77767 14.2268 7.5226L12.5739 6.0266C12.2913 5.77085 11.8342 5.77178 11.5529 6.02869 11.2716 6.28559 11.2726 6.70119 11.5552 6.95694L11.9605 7.3238H4.92151zM8.81315 1.93216C8.81315 1.5991 8.51617 1.3291 8.14983 1.3291 7.7835 1.3291 7.48652 1.5991 7.48652 1.93216V5.81898C7.48652 6.15204 7.7835 6.42204 8.14983 6.42204 8.51617 6.42204 8.81315 6.15204 8.81315 5.81898V1.93216zM8.81315 10.1812C8.81315 9.84812 8.51617 9.57812 8.14983 9.57812 7.7835 9.57812 7.48652 9.84812 7.48652 10.1812V14.068C7.48652 14.4011 7.7835 14.6711 8.14983 14.6711 8.51617 14.6711 8.81315 14.4011 8.81315 14.068V10.1812zM2.22392 3.22626C2.59026 3.22626 2.88723 3.49626 2.88723 3.82932V12.1707C2.88723 12.5038 2.59026 12.7738 2.22392 12.7738 1.85758 12.7738 1.56061 12.5038 1.56061 12.1707V3.82932C1.56061 3.49626 1.85758 3.22626 2.22392 3.22626z"}}]}]},Y$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"overflow-single",ref:e,icon:sEe}))});Y$.displayName="OverflowSingle";var uEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1204",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1204)"},children:[{tag:"rect",attrs:{width:12.62,height:2.79,x:1.69,y:12.25,fill:"colorChannel1",rx:1.4}},{tag:"path",attrs:{fill:"currentColor",d:"M7.74646 2.1642C7.34284 1.65121 6.85947 1.28205 6.38447 1.09593C5.86863 0.893787 5.15166 0.852126 4.70047 1.42917C4.29842 1.94344 4.33082 2.70249 4.57691 3.50395C4.68808 3.8661 4.86846 4.22254 5.12522 4.56617C5.13695 4.58185 5.14927 4.5968 5.16211 4.61102C5.17152 4.6214 5.18122 4.63139 5.19115 4.64096C5.20459 4.65393 5.21855 4.66618 5.23296 4.6777L3.5064 6.40422C3.26756 6.64306 3.26756 7.03033 3.5064 7.26919L7.23756 11.0004C7.47648 11.2392 7.86375 11.2392 8.1026 11.0004L12.8329 6.27001C13.0717 6.03117 13.0717 5.6439 12.8329 5.40505L9.10172 1.67387C8.86288 1.43503 8.47561 1.43503 8.23676 1.67387L7.74646 2.1642ZM7.46162 4.50638C7.47252 4.57574 7.48163 4.64652 7.4888 4.71868C7.52232 5.05481 7.82194 5.30013 8.15807 5.26661C8.4942 5.23311 8.73954 4.93345 8.70601 4.59732C8.65786 4.11463 8.54251 3.6666 8.37892 3.26169L8.66928 2.97135L11.5354 5.83753L10.6106 6.76237H4.87824L7.40802 4.2326C7.42885 4.32128 7.44684 4.41255 7.46162 4.50638ZM6.87284 3.03784C6.57441 2.62008 6.22261 2.34634 5.93815 2.23487C5.80233 2.18165 5.71528 2.17827 5.67638 2.18335C5.6725 2.18387 5.66929 2.18443 5.6666 2.18497L5.6619 2.18607C5.64166 2.21954 5.53594 2.45979 5.74626 3.1449C5.81241 3.36036 5.92262 3.58602 6.09307 3.81761L6.87284 3.03784Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.1932 11.5463C12.6454 11.5463 13.012 11.1797 13.012 10.7275C13.012 10.4475 12.6981 9.92821 12.459 9.5733C12.3299 9.38173 12.0564 9.38174 11.9274 9.57331C11.6883 9.92822 11.3744 10.4475 11.3744 10.7275C11.3744 11.1797 11.741 11.5463 12.1932 11.5463Z"}}]}]},X$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"paint-bucket",ref:e,icon:uEe}))});X$.displayName="PaintBucket";var lEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1138",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1138)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M7.74692 9.12463C7.74692 9.46018 8.01893 9.73219 8.35448 9.73219H11.4933C11.8288 9.73219 12.1009 9.46018 12.1009 9.12463 12.1009 8.78909 11.8288 8.51707 11.4933 8.51707H8.35448C8.01893 8.51707 7.74692 8.78909 7.74692 9.12463zM10.8636 10.8523C10.8636 11.1879 10.5915 11.4599 10.256 11.4599H8.35448C8.01893 11.4599 7.74692 11.1879 7.74692 10.8523 7.74692 10.5168 8.01893 10.2447 8.35448 10.2447H10.256C10.5915 10.2447 10.8636 10.5168 10.8636 10.8523z"}},{tag:"path",attrs:{fill:"currentColor",d:"M5.4791 1.98268C5.47913 1.71529 5.87912 1.49854 6.37252 1.49854C6.86593 1.49854 7.26592 1.71529 7.26595 1.98268H7.62187C8.22277 1.98268 8.72459 2.39534 8.84412 2.9452H9.39563C10.0856 2.9452 10.6449 3.48923 10.6449 4.16032V6.00569H12.1261C13.161 6.00569 14 6.82174 14 7.82838V11.334C14 11.8174 13.8025 12.281 13.4511 12.6228L12.0693 13.9647C11.7179 14.3065 11.2412 14.4985 10.7442 14.4985H7.91116C7.05024 14.4985 6.32492 14.0431 6.10535 13.2737H3.34925C2.6593 13.2737 2.09998 12.7297 2.09998 12.0586V4.16032C2.09998 3.48923 2.6593 2.9452 3.34925 2.9452H3.90107C4.0206 2.39534 4.52241 1.98268 5.12332 1.98268H5.4791ZM3.97249 4.16032H3.24925L3.24925 12.0586H6.03725V7.82838C6.03725 6.82174 6.87623 6.00569 7.91116 6.00569H9.49563V4.16032H8.7727C8.58289 4.59611 8.13909 4.90183 7.62187 4.90183H5.12332C4.6061 4.90183 4.1623 4.59611 3.97249 4.16032ZM5.12332 2.89403H7.62187C7.79436 2.89403 7.93419 3.03003 7.93419 3.19781V3.68671C7.93419 3.85448 7.79436 3.99049 7.62187 3.99049H5.12332C4.95083 3.99049 4.811 3.85448 4.811 3.68671V3.19781C4.811 3.03003 4.95083 2.89403 5.12332 2.89403ZM7.91116 7.11157C7.56618 7.11157 7.28652 7.38359 7.28652 7.71913V12.7851C7.28652 13.1206 7.56618 13.3927 7.91116 13.3927H10.7442C10.8401 13.3927 10.9337 13.3712 11.0182 13.3311C11.1373 13.2746 11.1859 13.1423 11.1859 13.0134V12.0066C11.1859 11.8724 11.2978 11.7636 11.4358 11.7636H12.4709C12.6034 11.7636 12.7394 11.7163 12.7975 11.6004C12.8388 11.5182 12.8608 11.4272 12.8608 11.334V7.71913C12.8608 7.38359 12.5811 7.11157 12.2362 7.11157H7.91116Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},q$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"paste-special",ref:e,icon:lEe}))});q$.displayName="PasteSpecial";var cEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.44719 4.0002H2.00004C1.63185 4.0002 1.33337 3.70173 1.33337 3.33354C1.33337 2.96535 1.63185 2.66687 2.00004 2.66687H3.44716C3.72171 1.89005 4.46255 1.3335 5.33337 1.3335C6.2042 1.3335 6.94504 1.89005 7.21958 2.66687H11.6666C13.3628 2.66687 14.6669 3.93225 14.6667 5.66694C14.6666 7.4014 13.3629 8.66687 11.6666 8.66687H6.66683L6.6594 8.66683H4.33351C3.36298 8.66683 2.66662 9.34592 2.66671 10.3334C2.6668 11.3212 3.36309 12.0002 4.33351 12.0002H8.78051C9.05508 11.2234 9.79589 10.6669 10.6667 10.6669C11.5375 10.6669 12.2783 11.2234 12.5529 12.0001H14C14.3682 12.0001 14.6667 12.2986 14.6667 12.6668C14.6667 13.035 14.3682 13.3335 14 13.3335H12.5529C12.2784 14.1103 11.5375 14.6669 10.6667 14.6669C9.79586 14.6669 9.05502 14.1103 8.78048 13.3335H4.33351C2.63723 13.3335 1.33353 12.068 1.33337 10.3336C1.33322 8.59887 2.63735 7.3335 4.33351 7.3335H6.66671L6.67414 7.33354H11.6666C12.637 7.33354 13.3333 6.65454 13.3334 5.66681C13.3335 4.67929 12.6371 4.0002 11.6666 4.0002H7.21956C6.94499 4.77698 6.20417 5.3335 5.33337 5.3335C4.46258 5.3335 3.72176 4.77698 3.44719 4.0002ZM4.66671 3.3335C4.66671 2.96531 4.96518 2.66683 5.33337 2.66683C5.70156 2.66683 6.00004 2.96531 6.00004 3.3335C6.00004 3.70169 5.70156 4.00016 5.33337 4.00016C4.96518 4.00016 4.66671 3.70169 4.66671 3.3335ZM10 12.6701C10.0018 13.0368 10.2996 13.3335 10.6667 13.3335C11.0349 13.3335 11.3334 13.0351 11.3334 12.6669C11.3334 12.2987 11.0349 12.0002 10.6667 12.0002C10.2996 12.0002 10.0018 12.2969 10 12.6636L10 12.6668L10 12.6701Z",fillRule:"evenodd",clipRule:"evenodd"}}]},G$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"piping-single",ref:e,icon:cEe}))});G$.displayName="PipingSingle";var dEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_659",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_659)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1876 6.47237C14.4479 6.22371 14.4479 5.82055 14.1876 5.57189L9.94491 1.51975C9.68456 1.27109 9.26245 1.27109 9.0021 1.51975C8.74175 1.76841 8.74175 2.17156 9.0021 2.42022L12.1067 5.3854H6.47602C3.79261 5.3854 1.61727 7.46307 1.61727 10.026C1.61727 12.5889 3.7926 14.6666 6.47602 14.6666H9.79268C10.1443 14.6666 10.4294 14.3815 10.4294 14.0299C10.4294 13.6782 10.1443 13.3931 9.79268 13.3931H6.47602C4.52899 13.3931 2.9506 11.8856 2.9506 10.026C2.9506 8.16638 4.52899 6.65887 6.47602 6.65887H12.1067L9.0021 9.62404C8.74175 9.8727 8.74175 10.2759 9.0021 10.5245C9.26245 10.7732 9.68456 10.7732 9.94491 10.5245L14.1876 6.47237Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},K$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"redo-single",ref:e,icon:dEe}))});K$.displayName="RedoSingle";var mEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_233_11",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_233_11)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.53331 14C2.35652 14 2.18697 13.9297 2.06197 13.8047C1.93697 13.6797 1.86675 13.5101 1.86675 13.3333C1.86675 13.1565 1.93697 12.987 2.06197 12.862C2.18697 12.7369 2.35652 12.6667 2.53331 12.6667L13.4666 12.6667C13.6434 12.6667 13.813 12.7369 13.938 12.862C14.063 12.987 14.1332 13.1565 14.1332 13.3333C14.1332 13.5101 14.063 13.6797 13.938 13.8047C13.813 13.9297 13.6434 14 13.4666 14L2.53331 14ZM2.53331 3.33333C2.35652 3.33331 2.18697 3.26306 2.06197 3.13804C1.93697 3.01301 1.86675 2.84346 1.86675 2.66667C1.86675 2.48987 1.93697 2.32032 2.06197 2.1953C2.18697 2.07028 2.35652 2.00003 2.53331 2L13.4666 2C13.6434 2.00003 13.813 2.07028 13.938 2.1953C14.063 2.32032 14.1332 2.48987 14.1332 2.66667C14.1332 2.84346 14.063 3.01301 13.938 3.13803C13.813 3.26306 13.6434 3.33331 13.4666 3.33333L2.53331 3.33333Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M10.8142 10.8141C10.5588 11.0695 10.1447 11.0695 9.88929 10.8141L7.97868 8.90354L6.14021 10.742C5.89652 10.9857 5.50142 10.9857 5.25774 10.742C5.01405 10.4983 5.01405 10.1032 5.25774 9.85955L7.09621 8.02107L5.18561 6.11047C4.93021 5.85507 4.93021 5.44098 5.18561 5.18557C5.44101 4.93017 5.8551 4.93017 6.11051 5.18557L8.02111 7.09618L9.85959 5.2577C10.1033 5.01401 10.4984 5.01401 10.7421 5.2577C10.9857 5.50139 10.9857 5.89648 10.7421 6.14017L8.90358 7.97865L10.8142 9.88925C11.0696 10.1447 11.0696 10.5587 10.8142 10.8141Z"}}]}]},Z$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"reduce",ref:e,icon:mEe}))});Z$.displayName="Reduce";var fEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1297",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1297)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.33325 3.99992L1.33325 2.66659C1.33325 1.93021 1.93021 1.33325 2.66659 1.33325L3.99992 1.33325 3.99992 2.66659 2.66659 2.66659 2.66659 3.99992 1.33325 3.99992zM9.33325 1.33325L9.33325 2.66658 6.66659 2.66659 6.66659 1.33325 9.33325 1.33325zM1.33325 6.66659L2.66659 6.66659 2.66659 7.33325 5.33325 7.33325 5.33325 8.66659 2.66659 8.66659 2.66659 9.33325 1.33325 9.33325 1.33325 6.66659zM1.33325 11.9999L2.66659 11.9999 2.66659 13.3333 3.99992 13.3333 3.99992 14.6666 2.66659 14.6666C1.93021 14.6666 1.33325 14.0696 1.33325 13.3333L1.33325 11.9999zM6.66659 14.6666L6.66659 13.3333 7.33325 13.3333 7.33325 10.6666 8.66659 10.6666 8.66659 13.3333 9.33325 13.3333 9.33325 14.6666 6.66659 14.6666zM13.3333 7.33325L10.6666 7.33325 10.6666 8.66659 13.3333 8.66658 13.3333 7.33325zM7.33325 5.33325L7.33325 2.66659 8.66659 2.66659 8.66659 5.33325 7.33325 5.33325z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.3333 1.33325L12 1.33325L12 2.66659L13.3333 2.66659L13.3333 13.3333L12 13.3333L12 14.6666L13.3333 14.6666C14.0697 14.6666 14.6667 14.0696 14.6667 13.3333L14.6667 2.66659C14.6667 1.93021 14.0697 1.33325 13.3333 1.33325Z"}}]}]},Q$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"right-border",ref:e,icon:fEe}))});Q$.displayName="RightBorder";var hEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_42",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.54 0.48H16.54V16.48H0.54z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_42)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.2368 2.87507L2.11162 7.97208L2.61144 9.06304L12.4714 4.54568L7.95409 14.4057L9.04505 14.9055L14.1421 3.78029L14.4503 3.63905L14.3286 3.37322L14.469 3.0666L14.1134 2.90369L13.9505 2.5481L13.6439 2.68857L13.3781 2.56678L13.2368 2.87507Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M4.44524 1.82495L3.08111 1.82495C2.41837 1.82495 1.88111 2.36221 1.88111 3.02495L1.88111 4.38908L3.21111 4.38908L3.21111 3.15495L4.44524 3.15495L4.44524 1.82495ZM15.1941 4.38908L15.1941 3.02495C15.1941 2.36221 14.6569 1.82495 13.9941 1.82495L12.63 1.82495L12.63 3.15495L13.8641 3.15495L13.8641 4.38908L15.1941 4.38908ZM7.17349 1.82495L7.17349 3.15495L9.90175 3.15495L9.90175 1.82495L7.17349 1.82495ZM15.1941 7.11734L13.8641 7.11734L13.8641 9.84559L15.1941 9.84559L15.1941 7.11734ZM15.1941 12.5739L13.8641 12.5739L13.8641 13.808L12.63 13.808L12.63 15.138L13.9941 15.138C14.6569 15.138 15.1941 14.6007 15.1941 13.938L15.1941 12.5739ZM9.90175 15.138L9.90175 13.808L7.17349 13.808L7.17349 15.138L9.90175 15.138ZM4.44524 15.138L4.44524 13.808L3.21111 13.808L3.21111 12.5739L1.88111 12.5739L1.88111 13.938C1.88111 14.6007 2.41837 15.138 3.08111 15.138L4.44524 15.138ZM1.88111 9.8456L3.21111 9.8456L3.21111 7.11734L1.88111 7.11734L1.88111 9.8456Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},J$=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"right-double-diagonal-single",ref:e,icon:hEe}))});J$.displayName="RightDoubleDiagonalSingle";var pEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1123",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M16 16H32V32H16z",transform:"rotate(180 16 16)"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1123)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.56781 13.3332C2.56781 14.0695 3.16476 14.6665 3.90114 14.6665L6.56781 14.6665C7.30419 14.6665 7.90114 14.0695 7.90114 13.3332L7.90114 2.6665C7.90114 1.9301 7.30419 1.33317 6.56781 1.33317L3.90114 1.33317C3.16476 1.33317 2.56781 1.9301 2.56781 2.6665L2.56781 13.3332ZM3.90114 2.6665L3.90114 13.3332L6.56781 13.3332L6.56781 2.6665L3.90114 2.6665Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M13.4323 8.00022C13.4323 8.36841 13.1338 8.66689 12.7656 8.66689L11.6906 8.66689L11.6906 9.74202C11.6906 10.1102 11.3921 10.4087 11.0239 10.4087C10.6557 10.4087 10.3573 10.1102 10.3573 9.74202L10.3573 8.66689L9.28215 8.66689C8.91396 8.66689 8.61548 8.36841 8.61548 8.00022C8.61548 7.63203 8.91396 7.33356 9.28214 7.33356L10.3573 7.33356L10.3573 6.25852C10.3573 5.89033 10.6557 5.59186 11.0239 5.59186C11.3921 5.59186 11.6906 5.89033 11.6906 6.25852L11.6906 7.33356L12.7656 7.33356C13.1338 7.33356 13.4323 7.63203 13.4323 8.00022Z"}}]}]},ek=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"right-insert-column",ref:e,icon:pEe}))});ek.displayName="RightInsertColumn";var gEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_821",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z",transform:"matrix(-1 0 0 1 16 0)"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_821)"},children:[{tag:"path",attrs:{d:"M14 2.3501C14.359 2.3501 14.65 2.64111 14.65 3.0001 14.65 3.35908 14.359 3.6501 14 3.6501L2.00002 3.6501C1.64104 3.6501 1.35002 3.35908 1.35002 3.0001 1.35002 2.64111 1.64104 2.3501 2.00002 2.3501L14 2.3501zM14 5.68347C14.359 5.68347 14.65 5.97449 14.65 6.33347 14.65 6.69246 14.359 6.98347 14 6.98347L4.66669 6.98347C4.30771 6.98347 4.01669 6.69246 4.01669 6.33347 4.01669 5.97449 4.30771 5.68347 4.66669 5.68347L14 5.68347zM14.65 9.66672C14.65 9.30774 14.359 9.01672 14 9.01672L2.00002 9.01672C1.64104 9.01672 1.35002 9.30774 1.35002 9.66672 1.35002 10.0257 1.64104 10.3167 2.00002 10.3167L14 10.3167C14.359 10.3167 14.65 10.0257 14.65 9.66672zM14 12.3501C14.359 12.3501 14.65 12.6411 14.65 13.0001 14.65 13.3591 14.359 13.6501 14 13.6501L4.66669 13.6501C4.3077 13.6501 4.01669 13.3591 4.01669 13.0001 4.01669 12.6411 4.30771 12.3501 4.66669 12.3501L14 12.3501z"}}]}]},tk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"right-justifying-single",ref:e,icon:gEe}))});tk.displayName="RightJustifyingSingle";var vEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_805",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_805)"},children:[{tag:"path",attrs:{d:"M14.3754 2.90308C14.4648 2.64472 14.3922 2.34908 14.1894 2.14632C13.9867 1.94356 13.691 1.87089 13.4327 1.9603L5.50328 4.70423C5.13835 4.83051 4.96231 5.23518 5.11008 5.60809C5.25785 5.98101 5.67348 6.18094 6.03841 6.05466L8.25753 5.28675L11.049 8.0782L10.2811 10.2973C10.1548 10.6623 10.3547 11.0779 10.7276 11.2257C11.1005 11.3734 11.5052 11.1974 11.6315 10.8325L14.3754 2.90308ZM11.552 6.62449L9.71124 4.78369L12.5261 3.80961L11.552 6.62449Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M2.83111 5.01909C2.54473 4.73271 2.09354 4.71957 1.82337 4.98974C1.5532 5.25991 1.56634 5.71109 1.85272 5.99748L9.08612 13.2309L8.05806 13.2009C7.66452 13.1895 7.35478 13.4992 7.36624 13.8928C7.3777 14.2863 7.70603 14.6146 8.09957 14.6261L10.8479 14.7061C11.1362 14.7145 11.3909 14.5485 11.4935 14.2854C11.596 14.0224 11.5261 13.7141 11.3164 13.5044L2.83111 5.01909Z"}}]}]},nk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"right-rotation-forty-five-degrees-single",ref:e,icon:vEe}))});nk.displayName="RightRotationFortyFiveDegreesSingle";var bEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15 7.70009C15 7.97379 14.8405 8.22239 14.5917 8.33643L10.5917 10.1698 10.5917 10.1698 9.25833 10.7809 9.25832 10.7809 6.59166 12.0031C6.24022 12.1642 5.82474 12.0099 5.66366 11.6584 5.50258 11.307 5.6569 10.8915 6.00834 10.7304L8.26667 9.69533 8.26667 5.70484 6.00834 4.66977C5.6569 4.50869 5.50258 4.0932 5.66366 3.74176 5.82474 3.39032 6.24022 3.236 6.59166 3.39708L9.25832 4.61931 9.25833 4.61931 10.5917 5.23041 10.5917 5.23041 14.5917 7.06374C14.8405 7.17778 15 7.42638 15 7.70009zM9.66667 6.3465L9.66667 9.05368 10.0083 8.89708 10.0083 8.89707 12.62 7.70009 10.0083 6.5031 10.0083 6.5031 9.66667 6.3465zM3.6335 1C4.0201 1 4.3335 1.3134 4.3335 1.7L4.3335 13.7C4.3335 13.9831 4.16295 14.2384 3.90137 14.3467 3.6398 14.4551 3.33872 14.3952 3.13852 14.195L1.13852 12.195C.865154 11.9216.865154 11.4784 1.13852 11.205 1.41189 10.9317 1.8551 10.9317 2.12847 11.205L2.9335 12.0101 2.9335 1.7C2.9335 1.3134 3.2469 1 3.6335 1z",fillRule:"evenodd",clipRule:"evenodd"}}]},rk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"right-rotation-ninety-degrees-single",ref:e,icon:bEe}))});rk.displayName="RightRotationNinetyDegreesSingle";var _Ee={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_436_41",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0.35 0.48H16.35V16.48H0.35z"}}]},{tag:"g",attrs:{mask:"url(#mask0_436_41)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.27177 13.714L13.5855 2.40025L14.434 3.24878L3.1203 14.5625L2.27177 13.714Z"}},{tag:"path",attrs:{fill:"#E5E5E5",d:"M4.2603 1.82495L2.89617 1.82495C2.23343 1.82495 1.69617 2.36221 1.69617 3.02495L1.69617 4.38908L3.02617 4.38908L3.02617 3.15495L4.2603 3.15495L4.2603 1.82495ZM15.0092 4.38908L15.0092 3.02495C15.0092 2.36221 14.4719 1.82495 13.8092 1.82495L12.4451 1.82495L12.4451 3.15495L13.6792 3.15495L13.6792 4.38908L15.0092 4.38908ZM6.98856 1.82495L6.98856 3.15495L9.71681 3.15495L9.71681 1.82495L6.98856 1.82495ZM15.0092 7.11734L13.6792 7.11734L13.6792 9.84559L15.0092 9.84559L15.0092 7.11734ZM15.0092 12.5739L13.6792 12.5739L13.6792 13.808L12.4451 13.808L12.4451 15.138L13.8092 15.138C14.4719 15.138 15.0092 14.6007 15.0092 13.938L15.0092 12.5739ZM9.71681 15.138L9.71681 13.808L6.98856 13.808L6.98856 15.138L9.71681 15.138ZM4.2603 15.138L4.2603 13.808L3.02617 13.808L3.02617 12.5739L1.69617 12.5739L1.69617 13.938C1.69617 14.6007 2.23343 15.138 2.89617 15.138L4.2603 15.138ZM1.69617 9.8456L3.02617 9.8456L3.02617 7.11734L1.69617 7.11734L1.69617 9.8456Z"}}]}]},ik=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"slash-single",ref:e,icon:_Ee}))});ik.displayName="SlashSingle";var CEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{stroke:"currentColor",d:"M1.66669 8H14.3334M8 8C13.3333 10 11.3333 14.6667 8 14.6667 4.66663 14.6667 4 12 4 12M12 3.99992C12 3.99992 11 1.33325 7.99995 1.33325 4.99995 1.33325 3.81195 3.86642 5.20319 5.99992",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.33}},{tag:"path",attrs:{stroke:"currentColor",d:"M4 12C4 12 5.3333 14.6667 8 14.6667C10.6667 14.6667 12.188 12.1335 10.7968 10",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.33}}]},ok=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"strikethrough-single",ref:e,icon:CEe}))});ok.displayName="StrikethroughSingle";var SEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.60384 2.34274C2.39447 2.05113 1.98835 1.98445 1.69674 2.19382 1.40513 2.40319 1.33846 2.80931 1.54782 3.10092L5.06527 8.00012 1.54784 12.8993C1.33847 13.1909 1.40514 13.597 1.69675 13.8064 1.98836 14.0158 2.39448 13.9491 2.60385 13.6575L5.86545 9.11463 9.12705 13.6575C9.33642 13.9491 9.74254 14.0158 10.0341 13.8064 10.3258 13.597 10.3924 13.1909 10.1831 12.8993L6.66563 8.00012 10.1831 3.10092C10.3924 2.80931 10.3258 2.40319 10.0342 2.19382 9.74255 1.98445 9.33643 2.05113 9.12706 2.34274L5.86545 6.88561 2.60384 2.34274zM13.0221 10.4725C13.0221 10.7718 12.8545 11.1247 12.5304 11.5427 12.2085 11.9577 11.7454 12.4206 11.1825 12.9381 11.0649 13.0462 10.9967 13.1989 10.9967 13.3594 10.9967 13.6737 11.2515 13.9285 11.5657 13.9285H13.9773C14.307 13.9285 14.5742 13.6612 14.5742 13.3315 14.5742 13.0018 14.307 12.7345 13.9773 12.7345H13.5735C13.4387 12.7345 13.2624 12.7467 13.092 12.7634L13.0906 12.7634 13.089 12.7619 13.0868 12.7589C13.0855 12.7561 13.0855 12.7535 13.0855 12.7535L13.0863 12.7525C13.4178 12.3983 13.7329 12.0116 13.9656 11.6159 14.1978 11.2211 14.3528 10.8094 14.3528 10.4074 14.3528 9.91841 14.18 9.50783 13.8761 9.21983 13.5728 8.93241 13.1473 8.7749 12.6552 8.7749 12.3802 8.7749 12.1555 8.80023 11.9494 8.86784 11.7424 8.93575 11.5606 9.0442 11.3682 9.20192 11.2524 9.29691 11.1771 9.44251 11.1545 9.58802 11.1319 9.73348 11.1599 9.89717 11.2771 10.0132 11.4897 10.2236 11.8118 10.2625 12.0629 10.0905 12.1882 10.0046 12.3689 9.94905 12.5271 9.94905 12.7029 9.94905 12.8211 9.99229 12.8963 10.0673 12.9714 10.1422 13.0221 10.2675 13.0221 10.4725z"}}]},ak=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"subscript-single",ref:e,icon:SEe}))});ak.displayName="SubscriptSingle";var EEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0 0H16V16H0z",opacity:.01}},{tag:"path",attrs:{fill:"currentColor",d:"M8.00061 1.60059C4.4111 1.60059 1.50061 4.51108 1.50061 8.10059C1.50061 11.6901 4.4111 14.6006 8.00061 14.6006C11.5901 14.6006 14.5006 11.6901 14.5006 8.10059C14.5006 4.51108 11.5901 1.60059 8.00061 1.60059ZM10.8082 5.97793L7.75259 10.2145C7.56832 10.4713 7.18674 10.4713 7.00248 10.2145L5.19321 7.70739C5.13808 7.6305 5.19321 7.52313 5.28752 7.52313H5.96799C6.11598 7.52313 6.25672 7.59422 6.34377 7.7161L7.37681 9.14958L9.65761 5.98664C9.74466 5.86621 9.88395 5.79367 10.0334 5.79367H10.7139C10.8082 5.79367 10.8633 5.90103 10.8082 5.97793Z",fillRule:"evenodd",clipRule:"evenodd"}}]},sk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"success-single",ref:e,icon:EEe}))});sk.displayName="SuccessSingle";const yEe=sk;var DEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.82566 11.9312C9.52779 11.9312 9.28632 11.5404 9.28632 11.0583V6.74777C9.28632 6.28962 9.51581 5.91821 9.79891 5.91821H9.8257C10.0608 5.91821 10.2615 6.1933 10.3001 6.56863L10.3086 6.65107C10.3103 6.66723 10.3189 6.67908 10.329 6.67908L10.329 6.67908C10.3345 6.67908 10.3398 6.67553 10.3437 6.66925 10.6488 6.17698 10.9678 5.77026 11.4673 5.77026 11.9831 5.77026 12.2966 6.11899 12.4859 6.76362 12.8059 6.23524 13.152 5.77026 13.6482 5.77026 14.4579 5.77026 14.8106 6.71078 14.8106 8.21138V10.9907C14.8106 11.5101 14.5504 11.9312 14.2294 11.9312L14.2294 11.9312C13.9084 11.9312 13.6482 11.5101 13.6482 10.9907V8.44387C13.6482 7.61959 13.5176 7.37654 13.2238 7.37654L13.2238 7.37654C12.7759 7.37654 12.6296 8.32093 12.6296 9.04573V10.9854C12.6296 11.5077 12.3679 11.9312 12.0452 11.9312L12.0452 11.9312C11.7224 11.9312 11.4608 11.5077 11.4608 10.9854V8.44387C11.4608 7.61959 11.3302 7.37654 11.0363 7.37654L11.0363 7.37654C10.5884 7.37654 10.4421 8.32093 10.4421 9.04573V10.9959C10.4421 11.5125 10.1834 11.9312 9.86421 11.9312H9.82566zM6.13008 12.0791C5.32039 12.0791 4.9743 11.1386 4.9743 9.63801V6.85873C4.9743 6.3393 5.2345 5.91821 5.55546 5.91821 5.87642 5.91821 6.13661 6.3393 6.13661 6.85873V9.40552C6.13661 10.2404 6.27374 10.4729 6.56758 10.4729 6.62884 10.4729 6.6847 10.4636 6.73686 10.4436 7.11099 10.3004 7.18792 9.52547 7.18792 8.90331V6.85873C7.18792 6.3393 7.44811 5.91821 7.76907 5.91821 8.09003 5.91821 8.35023 6.3393 8.35023 6.85873V11.1016C8.35023 11.5598 8.12073 11.9312 7.83763 11.9312H7.66158C7.5126 11.9312 7.38545 11.7569 7.36096 11.519L7.32128 11.1338C7.31968 11.1183 7.31139 11.1069 7.30167 11.1069 7.29579 11.1069 7.29019 11.1112 7.2864 11.1184 6.98098 11.7036 6.6361 12.0791 6.13008 12.0791zM2.443 12.0791C1.96527 12.0791 1.46153 11.8627 1.02705 11.4343.78714 11.1978.767027 10.6738.945295 10.3224 1.13322 9.95206 1.47075 9.91354 1.73469 10.1308 1.9783 10.3314 2.2357 10.4517 2.46912 10.4517 2.90009 10.4517 3.10252 10.1875 3.10252 9.76478 3.10252 9.31038 2.83479 9.16243 2.41689 8.8771L1.79655 8.4544C1.28722 8.12681.810547 7.43991.810547 6.29861.810547 4.97766 1.54189 3.9209 2.5736 3.9209 2.99475 3.9209 3.43427 4.11704 3.80676 4.50486 4.02057 4.72747 4.0344 5.19974 3.87623 5.52185 3.70738 5.86574 3.40456 5.90897 3.15592 5.73283 2.97499 5.60465 2.7867 5.53774 2.5736 5.53774 2.21446 5.53774 1.99245 5.77023 1.99245 6.19293 1.99245 6.62621 2.29935 6.79529 2.73032 7.07004L3.33759 7.46105C3.93834 7.85205 4.29748 8.50724 4.29748 9.61684 4.29748 10.9272 3.61837 12.0791 2.443 12.0791z"}}]},uk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"sum-single",ref:e,icon:DEe}))});uk.displayName="SumSingle";var REe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M13.0221 3.60995C13.0221 3.90929 12.8545 4.26213 12.5304 4.68012 12.2085 5.09515 11.7454 5.55802 11.1825 6.07553 11.0649 6.18363 10.9967 6.3363 10.9967 6.49688 10.9967 6.81115 11.2515 7.06592 11.5657 7.06592H13.9773C14.307 7.06592 14.5742 6.79864 14.5742 6.46894 14.5742 6.13924 14.307 5.87196 13.9773 5.87196H13.5735C13.4387 5.87196 13.2624 5.88419 13.092 5.90085L13.0906 5.90087C13.0906 5.90087 13.0882 5.89908 13.0868 5.89632 13.0855 5.89356 13.0855 5.89096 13.0855 5.89096L13.0863 5.88997C13.4178 5.53574 13.7329 5.149 13.9656 4.75332 14.1978 4.35858 14.3528 3.94689 14.3528 3.54482 14.3528 3.05586 14.18 2.64528 13.8761 2.35728 13.5728 2.06986 13.1473 1.91235 12.6552 1.91235 12.3802 1.91235 12.1555 1.93768 11.9494 2.00529 11.7424 2.0732 11.5606 2.18165 11.3682 2.33937 11.2524 2.43436 11.1771 2.57996 11.1545 2.72547 11.1319 2.87094 11.1599 3.03463 11.2771 3.15062 11.4897 3.36103 11.8118 3.39998 12.0629 3.22793 12.1882 3.14209 12.3689 3.0865 12.5271 3.0865 12.7029 3.0865 12.8211 3.12974 12.8963 3.20472 12.9714 3.27967 13.0221 3.40498 13.0221 3.60995zM2.60384 2.50216C2.39447 2.21055 1.98835 2.14388 1.69674 2.35324 1.40513 2.56261 1.33846 2.96873 1.54782 3.26034L5.06527 8.15954 1.54784 13.0587C1.33847 13.3503 1.40514 13.7565 1.69675 13.9658 1.98836 14.1752 2.39448 14.1085 2.60385 13.8169L5.86545 9.27405 9.12705 13.8169C9.33642 14.1085 9.74254 14.1752 10.0341 13.9658 10.3258 13.7565 10.3924 13.3503 10.1831 13.0587L6.66563 8.15954 10.1831 3.26034C10.3924 2.96873 10.3258 2.56261 10.0342 2.35324 9.74255 2.14388 9.33643 2.21055 9.12706 2.50216L5.86545 7.04503 2.60384 2.50216z"}}]},lk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"superscript-single",ref:e,icon:REe}))});lk.displayName="SuperscriptSingle";var IEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_796",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_796)"},children:[{tag:"path",attrs:{d:"M2.054 1.42676C2.42782 1.42676 2.73086 1.72979 2.73086 2.10361V13.9644C2.73086 14.3382 2.42782 14.6412 2.054 14.6412 1.68019 14.6412 1.37715 14.3382 1.37715 13.9644L1.37715 2.10361C1.37715 1.72979 1.68019 1.42676 2.054 1.42676zM13.9458 1.42676C14.3196 1.42676 14.6226 1.72979 14.6226 2.10361V13.9644C14.6226 14.3382 14.3196 14.6412 13.9458 14.6412 13.572 14.6412 13.2689 14.3382 13.2689 13.9644V8.73508H6.58987C6.21606 8.73508 5.91302 8.43204 5.91302 8.05822 5.91302 7.68441 6.21606 7.38137 6.58987 7.38137H13.2689V2.10361C13.2689 1.72979 13.572 1.42676 13.9458 1.42676z"}}]}]},ck=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"truncation-single",ref:e,icon:IEe}))});ck.displayName="TruncationSingle";var AEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_668",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_668)"},children:[{tag:"path",attrs:{d:"M5.24805 1.93784C5.24805 1.58695 4.96359 1.30249 4.6127 1.30249 4.2618 1.30249 3.97734 1.58695 3.97734 1.93784V7.95524C3.97734 10.1769 5.77833 11.9778 7.99995 11.9778 10.2216 11.9778 12.0226 10.1769 12.0226 7.95524V1.93784C12.0226 1.58695 11.7381 1.30249 11.3872 1.30249 11.0363 1.30249 10.7519 1.58695 10.7519 1.93784V7.95524C10.7519 9.47507 9.51979 10.7071 7.99995 10.7071 6.48012 10.7071 5.24805 9.47507 5.24805 7.95524V1.93784zM2.72117 13.4268C2.37027 13.4268 2.08582 13.7113 2.08582 14.0622 2.08582 14.4131 2.37027 14.6975 2.72117 14.6975H13.2788C13.6297 14.6975 13.9142 14.4131 13.9142 14.0622 13.9142 13.7113 13.6297 13.4268 13.2788 13.4268H2.72117z"}}]}]},dk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"underline-single",ref:e,icon:AEe}))});dk.displayName="UnderlineSingle";var TEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_656",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_656)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.81245 6.47237C1.5521 6.22371 1.5521 5.82055 1.81245 5.57189L6.05509 1.51975C6.31544 1.27109 6.73755 1.27109 6.9979 1.51975C7.25825 1.76841 7.25825 2.17156 6.9979 2.42022L3.89333 5.3854H9.52398C12.2074 5.3854 14.3827 7.46307 14.3827 10.026C14.3827 12.5889 12.2074 14.6666 9.52398 14.6666H6.20732C5.85566 14.6666 5.57059 14.3815 5.57059 14.0299C5.57059 13.6782 5.85566 13.3931 6.20732 13.3931H9.52398C11.471 13.3931 13.0494 11.8856 13.0494 10.026C13.0494 8.16638 11.471 6.65887 9.52398 6.65887H3.89333L6.9979 9.62404C7.25825 9.8727 7.25825 10.2759 6.9979 10.5245C6.73755 10.7732 6.31544 10.7732 6.05509 10.5245L1.81245 6.47237Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},mk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"undo-single",ref:e,icon:TEe}))});mk.displayName="UndoSingle";var wEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.07361 4.74658C3.85403 4.74658 4.48669 4.11392 4.48669 3.3335 4.48669 2.55307 3.85403 1.92041 3.07361 1.92041 2.29318 1.92041 1.66052 2.55307 1.66052 3.3335 1.66052 4.11392 2.29318 4.74658 3.07361 4.74658zM5.67261 3.33341C5.67261 2.96522 5.97108 2.66675 6.33927 2.66675H13.6726C14.0408 2.66675 14.3393 2.96522 14.3393 3.33341 14.3393 3.7016 14.0408 4.00008 13.6726 4.00008H6.33927C5.97108 4.00008 5.67261 3.7016 5.67261 3.33341zM6.33927 12.0001C5.97108 12.0001 5.67261 12.2986 5.67261 12.6668 5.67261 13.035 5.97108 13.3335 6.33927 13.3335H13.6726C14.0408 13.3335 14.3393 13.035 14.3393 12.6668 14.3393 12.2986 14.0408 12.0001 13.6726 12.0001H6.33927zM6.3394 7.3335C5.97121 7.3335 5.67273 7.63197 5.67273 8.00016 5.67273 8.36835 5.97121 8.66683 6.3394 8.66683H13.6727C14.0409 8.66683 14.3394 8.36835 14.3394 8.00016 14.3394 7.63197 14.0409 7.3335 13.6727 7.3335H6.3394zM4.48669 8.00024C4.48669 8.78067 3.85403 9.41333 3.07361 9.41333 2.29318 9.41333 1.66052 8.78067 1.66052 8.00024 1.66052 7.21982 2.29318 6.58716 3.07361 6.58716 3.85403 6.58716 4.48669 7.21982 4.48669 8.00024zM3.07361 14.0804C3.85403 14.0804 4.48669 13.4478 4.48669 12.6674 4.48669 11.8869 3.85403 11.2543 3.07361 11.2543 2.29318 11.2543 1.66052 11.8869 1.66052 12.6674 1.66052 13.4478 2.29318 14.0804 3.07361 14.0804z"}}]},fk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"unorder-single",ref:e,icon:wEe}))});fk.displayName="UnorderSingle";var LEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_107_1282",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_107_1282)"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M4.0001 14.667H2.66677C1.93039 14.667 1.33344 14.07 1.33344 13.3337V12.0003H2.66677V13.3337L4.0001 13.3337V14.667zM1.33344 6.66699H2.66677V9.33366H1.33344V6.66699zM6.66677 14.667V13.3337H7.33344V10.667H8.66677V13.3337H9.33344V14.667H6.66677zM12.0001 14.667V13.3337H13.3334V12.0003H14.6668V13.3337C14.6668 14.07 14.0698 14.667 13.3334 14.667H12.0001zM14.6668 9.33366H13.3334V8.66699H10.6668V7.33366H13.3334V6.66699H14.6668V9.33366zM7.33344 2.66699V5.33366H8.66677V2.66699H7.33344zM5.33344 8.66699H2.66677V7.33366H5.33344V8.66699z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.33344 2.66789V4.00122H2.66677L2.66677 2.66789H13.3334V4.00122H14.6668V2.66789C14.6668 1.93151 14.0698 1.33455 13.3334 1.33455H2.66677C1.93039 1.33455 1.33344 1.93151 1.33344 2.66789Z"}}]}]},hk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"up-border",ref:e,icon:LEe}))});hk.displayName="UpBorder";var OEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_834",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_834)"},children:[{tag:"path",attrs:{d:"M1.96316 7.33978C1.59868 7.33978 1.30322 7.63524 1.30322 7.99971 1.30322 8.36418 1.59868 8.65964 1.96316 8.65964H14.0367C14.4011 8.65964 14.6966 8.36418 14.6966 7.99971 14.6966 7.63524 14.4011 7.33978 14.0367 7.33978H1.96316zM8.65852 1.96233C8.65852 1.59859 8.36365 1.30371 7.9999 1.30371 7.63616 1.30371 7.34128 1.59859 7.34128 1.96233L7.34128 4.45623 6.66938 3.78433C6.41217 3.52712 5.99516 3.52712 5.73795 3.78433 5.48074 4.04154 5.48074 4.45855 5.73795 4.71576L7.53419 6.512C7.79139 6.76921 8.20841 6.76921 8.46562 6.512L10.2619 4.71576C10.5191 4.45855 10.5191 4.04154 10.2619 3.78433 10.0046 3.52712 9.58763 3.52712 9.33043 3.78433L8.65852 4.45623 8.65852 1.96233zM7.34128 14.0372C7.34128 14.401 7.63616 14.6959 7.9999 14.6959 8.36365 14.6959 8.65852 14.401 8.65852 14.0372L8.65852 11.5433 9.33042 12.2152C9.58763 12.4725 10.0046 12.4725 10.2619 12.2152 10.5191 11.958 10.5191 11.541 10.2619 11.2838L8.46562 9.48758C8.20841 9.23038 7.79139 9.23038 7.53419 9.48758L5.73795 11.2838C5.48074 11.541 5.48074 11.958 5.73795 12.2153 5.99516 12.4725 6.41217 12.4725 6.66938 12.2153L7.34128 11.5433 7.34128 14.0372z"}}]}]},pk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"vertical-center-single",ref:e,icon:OEe}))});pk.displayName="VerticalCenterSingle";var PEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_709",style:{maskType:"alpha"},width:17,height:17,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0.88 0.24H16.88V16.24H0.88z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_709)",fillRule:"evenodd",clipRule:"evenodd"},children:[{tag:"path",attrs:{d:"M2.2157 2.90265C2.2157 2.16628 2.81264 1.56934 3.54901 1.56934H6.21565C6.95202 1.56934 7.54896 2.16628 7.54896 2.90265V13.5692C7.54896 14.3056 6.95202 14.9025 6.21565 14.9025H3.54901C2.81264 14.9025 2.2157 14.3056 2.2157 13.5692V2.90265zM3.54901 2.90265H6.21565V5.5622H3.54901V2.90265zM3.54901 6.89552V9.57631H6.21565V6.89552H3.54901zM3.54901 13.5692V10.9096H6.21565V13.5692H3.54901zM10.2156 2.90265C10.2156 2.16628 10.8125 1.56934 11.5489 1.56934H14.2155C14.9519 1.56934 15.5489 2.16628 15.5489 2.90265V13.5692C15.5489 14.3056 14.9519 14.9025 14.2155 14.9025H11.5489C10.8125 14.9025 10.2156 14.3056 10.2156 13.5692V2.90265zM11.5489 2.90265H14.2155V5.5622H11.5489V2.90265zM11.5489 6.89552V9.57631H14.2155V6.89552H11.5489zM11.5489 13.5692V10.9096H14.2155V13.5692H11.5489z"}}]}]},gk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"vertical-integration-single",ref:e,icon:PEe}))});gk.displayName="VerticalIntegrationSingle";var MEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_799",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_799)"},children:[{tag:"path",attrs:{d:"M2.64534 2.71841C2.64534 2.36074 2.93528 2.0708 3.29295 2.0708H3.29482C3.65248 2.0708 3.94243 2.36074 3.94243 2.71841V11.7146L4.60561 11.0514C4.85851 10.7985 5.26856 10.7985 5.52146 11.0514C5.77437 11.3043 5.77437 11.7144 5.52146 11.9673L3.75275 13.736C3.62866 13.8601 3.46269 13.9259 3.29388 13.9257C3.12508 13.9259 2.9591 13.8601 2.83502 13.736L1.06632 11.9673C0.813418 11.7144 0.813418 11.3043 1.06632 11.0514C1.31923 10.7985 1.72927 10.7985 1.98218 11.0514L2.64534 11.7146V2.71841Z"}},{tag:"path",attrs:{d:"M14.7342 12.9524C14.3995 13.1058 14.0038 12.9588 13.8504 12.6241L12.7 10.1142H8.24123L7.09085 12.6241C6.93744 12.9588 6.54175 13.1058 6.20704 12.9524C5.87233 12.799 5.72536 12.4033 5.87877 12.0686L9.86459 3.37222C9.9732 3.13525 10.21 2.98332 10.4706 2.98332C10.7313 2.98332 10.9681 3.13525 11.0767 3.37222L15.0625 12.0686C15.2159 12.4033 15.0689 12.799 14.7342 12.9524ZM8.85233 8.78089H12.0889L10.4706 5.25003L8.85233 8.78089Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},vk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"vertical-text-single",ref:e,icon:MEe}))});vk.displayName="VerticalTextSingle";var NEe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.40051 8.00049C1.40051 4.41098 4.311 1.50049 7.90051 1.50049C11.49 1.50049 14.4005 4.41098 14.4005 8.00049C14.4005 11.59 11.49 14.5005 7.90051 14.5005C4.311 14.5005 1.40051 11.59 1.40051 8.00049ZM7.31368 5.3379L7.56087 9.33424H8.24066L8.49816 5.3379L8.51876 4.12252H7.28278L7.31368 5.3379ZM7.07678 11.0646C7.07678 11.5693 7.44758 11.8783 7.90077 11.8783C8.35396 11.8783 8.72476 11.5693 8.72476 11.0646C8.72476 10.5805 8.35396 10.2612 7.90077 10.2612C7.44758 10.2612 7.07678 10.5805 7.07678 11.0646Z",fillRule:"evenodd",clipRule:"evenodd"}}]},bk=_.forwardRef(function(t,e){return _.createElement(bt,Object.assign({},t,{id:"warning-single",ref:e,icon:NEe}))});bk.displayName="WarningSingle";const yA=bk;let Jo=class{constructor(){Mn(this,"_components",new Map);const e={AlignBottomSingle:FF,AlignTopSingle:$F,AllBorderSingle:kF,AmplifySingle:BF,AutowrapSingle:VF,BoldSingle:zF,BrushSingle:WF,Copy:t$,ClearFormat:GF,DownBorder:u$,FontColor:c$,FunctionSingle:g$,HorizontallySingle:_$,InnerBorder:C$,ItalicSingle:I$,KeyboardSingle:A$,ContentSingle16:e$,LeftBorder:T$,LeftJustifyingSingle:O$,LeftRotationFortyFiveDegreesSingle:P$,LeftRotationNinetyDegreesSingle:M$,MergeAllSingle:F$,HorizontalMergeSingle:b$,VerticalIntegrationSingle:gk,PipingSingle:G$,CancelMergeSingle:XF,NoBorderSingle:V$,NoColor:H$,NoRotationSingle:j$,OuterBorder:W$,OverflowSingle:Y$,PaintBucket:X$,PasteSpecial:q$,RedoSingle:K$,RightBorder:Q$,RightJustifyingSingle:tk,RightRotationFortyFiveDegreesSingle:nk,RightRotationNinetyDegreesSingle:rk,StrikethroughSingle:ok,OrderSingle:z$,UnorderSingle:fk,SuperscriptSingle:lk,SubscriptSingle:ak,TruncationSingle:ck,UnderlineSingle:dk,UndoSingle:mk,UpBorder:hk,VerticalCenterSingle:pk,VerticalTextSingle:vk,Insert:R$,InsertCellDown:S$,InsertCellShiftRight:E$,InsertRowAbove:y$,InsertRowBelow:D$,LeftInsertColumn:L$,RightInsertColumn:ek,DeleteColumn:a$,DeleteRow:s$,DeleteCellShiftUp:o$,DeleteCellShiftRight:i$,DeleteCellShiftLeft:r$,DeleteCellMoveDown:n$,Reduce:Z$,Hide:v$,AutoHeight:UF,AdjustHeight:NF,AdjustWidth:xF,AvgSingle:HF,CntSingle:QF,MaxSingle:x$,MinSingle:$$,SumSingle:uk,CancelFreezeSingle:YF,FreezeColumnSingle:f$,FreezeRowSingle:h$,FreezeToSelectedSingle:p$,CodeSingle:JF,FontSizeIncreaseSingle:d$,FontSizeReduceSingleSingle:m$,BackSlashSingle:jF,LeftDoubleDiagonalSingle:w$,LeftTridiagonalSingle:N$,SlashSingle:ik,RightDoubleDiagonalSingle:J$};for(const n in e)this.register(n,e[n])}register(e,n){return this._components.has(e)&&console.warn(`Component ${e} already exists.`),this._components.set(e,n),je(()=>this._components.delete(e))}get(e){return this._components.get(e)}delete(e){this._components.delete(e)}},xEe=class{constructor(){Mn(this,"_list",new Map)}setIndex(e,n){this._list.set(e,n)}getIndex(e){return this._list.get(e)}removeIndex(e){this._list.delete(e)}getMaxIndex(){let e=-9999999;return this._list.forEach(n=>{+n>e&&(e=+n)}),e}};function cr(t,e){const n=t.get(ae);return new Wt(r=>{const i=n.focused$.subscribe(s=>{if(s==null)return r.next(!0);const u=n.getDocumentType(s);r.next(u!==e)}),o=n.getFocusedUniverInstance();if(o==null)return r.next(!0);const a=n.getDocumentType(o.getUnitId());return r.next(a!==e),()=>i.unsubscribe()})}var P3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _k(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ck={exports:{}},l8={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FEe=Se,$Ee=Symbol.for("react.element"),kEe=Symbol.for("react.fragment"),BEe=Object.prototype.hasOwnProperty,UEe=FEe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VEe={key:!0,ref:!0,__self:!0,__source:!0};function Sk(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)BEe.call(e,r)&&!VEe.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:$Ee,type:t,key:o,ref:a,props:i,_owner:UEe.current}}l8.Fragment=kEe;l8.jsx=Sk;l8.jsxs=Sk;Ck.exports=l8;var Ae=Ck.exports;function U1(t,e,n){var r;const i=_.useRef(null),o=_.useRef(null);let a,s=!1,u;if((!i.current||i.current!==t)&&((r=o.current)==null||r.unsubscribe(),o.current=t.subscribe(d=>{a?a(d):(u=d,s=!0)})),n&&!s)throw new Error("[useObservable]: expect shouldHaveSyncValue but not getting a sync value!");const l=_.useState(u||e),c=l[0];return a=l[1],c}function Ua(t){const{title:e,icon:n,label:r,value:i,value$:o}=t,a=Ct(Gt),s=Ct(Jo),u=[];let l=0,c=i;o&&(c=U1(o,void 0,!0));let d;AC(n)?d=U1(n,void 0,!0):d=n;let m=!1;if(c&&typeof c=="string"&&(m=new Xo(c).isValid),n){const f=s.get(d??"");f&&u.push(Ae.jsx(f,{extend:{colorChannel1:m?c:"rgb(var(--primary-color))"}},l++))}if(r){const f=typeof r=="string",h=f?{...t}:{...r==null?void 0:r.props,...t},p=f?r:r==null?void 0:r.name,v=s.get(p);v?u.push(Ae.jsx(v,{...h,value:c},l++)):u.push(Ae.jsx("span",{children:a.t(p)},l++))}return e&&u.push(Ae.jsx("span",{children:a.t(e)},l++)),Ae.jsx(Ae.Fragment,{children:u})}const HEe="univer-ui-plugin-sheets-font-family",jEe="univer-ui-plugin-sheets-font-family-item",Ek={uiPluginSheetsFontFamily:HEe,uiPluginSheetsFontFamilyItem:jEe},yk=t=>{var e;const{value:n}=t,r=Ct(Gt);return Ae.jsx("div",{className:Ek.uiPluginSheetsFontFamily,style:{fontFamily:n},children:r.t(`fontFamily.${((e=`${n}`)!=null?e:"").replace(/\s/g,"")}`)})},Dk=t=>{var e;const{value:n}=t,r=Ct(Gt);return Ae.jsx("span",{className:Ek.uiPluginSheetsFontFamilyItem,style:{fontFamily:n},children:r.t(`fontFamily.${((e=`${n}`)!=null?e:"").replace(/\s/g,"")}`)})},S9=[{value:"Times New Roman"},{value:"Arial"},{value:"Tahoma"},{value:"Verdana"},{value:"Microsoft YaHei"},{value:"SimSun"},{value:"SimHei"},{value:"Kaiti"},{value:"FangSong"},{value:"NSimSun"},{value:"STXinwei"},{value:"STXingkai"},{value:"STLiti"}],zEe="univer-ui-plugin-sheets-font-size",WEe="univer-ui-plugin-sheets-font-size-input",DA={uiPluginSheetsFontSize:zEe,uiPluginSheetsFontSizeInput:WEe},Rk=t=>{const{value:e,min:n,max:r,onChange:i,disabled$:o}=t,a=U1(o??new Wt(m=>m.next(!1))),[s,u]=_.useState(Number(e??0)),l=_.useMemo(()=>Number(e??s),[e]);function c(m){m!==null&&u(m)}function d(m){m.stopPropagation(),m.code==="Enter"&&i(s.toString())}return Ae.jsx("div",{className:DA.uiPluginSheetsFontSize,children:Ae.jsx(of,{className:DA.uiPluginSheetsFontSizeInput,value:l,controls:!1,min:n,max:r,onKeyDown:d,onChange:c,disabled:a})})},Ik=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}];var hn=(t=>(t.VOID="void",t.TOOLBAR_START="uiToolbar.start",t.TOOLBAR_INSERT="uiToolbar.insert",t.TOOLBAR_FORMULAS="uiToolbar.formulas",t.TOOLBAR_DATA="uiToolbar.data",t.TOOLBAR_VIEW="uiToolbar.view",t.TOOLBAR_OTHERS="uiToolbar.others",t.CONTEXT_MENU="contextMenu",t))(hn||{}),Kt=(t=>(t[t.TOOLBAR_HISTORY=0]="TOOLBAR_HISTORY",t[t.TOOLBAR_FORMAT=1]="TOOLBAR_FORMAT",t[t.TOOLBAR_LAYOUT=2]="TOOLBAR_LAYOUT",t[t.TOOLBAR_FORMULAS_INSERT=3]="TOOLBAR_FORMULAS_INSERT",t[t.TOOLBAR_FORMULAS_VIEW=4]="TOOLBAR_FORMULAS_VIEW",t[t.TOOLBAR_FILE=5]="TOOLBAR_FILE",t[t.TOOLBAR_OTHERS=6]="TOOLBAR_OTHERS",t[t.CONTEXT_MENU_FORMAT=7]="CONTEXT_MENU_FORMAT",t[t.CONTEXT_MENU_LAYOUT=8]="CONTEXT_MENU_LAYOUT",t[t.CONTEXT_MENU_DATA=9]="CONTEXT_MENU_DATA",t[t.CONTEXT_MENU_OTHERS=10]="CONTEXT_MENU_OTHERS",t))(Kt||{}),pt=(t=>(t[t.BUTTON=0]="BUTTON",t[t.SELECTOR=1]="SELECTOR",t[t.BUTTON_SELECTOR=2]="BUTTON_SELECTOR",t[t.SUBITEMS=3]="SUBITEMS",t))(pt||{});function YEe(t,e,n){return document.addEventListener(t,e,n),je(()=>document.removeEventListener(t,e,n))}class c8{constructor(){Mn(this,"_containers",[])}registerContainer(e){if(this._containers.indexOf(e)===-1)return this._containers.push(e),je(()=>r1(this._containers,e));throw new Error("[LayoutService]: container already registered!")}checkElementInCurrentApplicationScope(e){return this._containers.some(n=>n.contains(e))}}const Ak=ln("univer.platform-service");let XEe=class{get isMac(){return/Mac/.test(navigator.appVersion)}get isWindows(){return/Windows/.test(navigator.appVersion)}get isLinux(){return/Linux/.test(navigator.appVersion)}};const qEe={8:"Backspace",9:"Tab",13:"Enter",46:"Del",27:"Esc",32:"Space",37:"←",39:"→",38:"↑",40:"↓",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",189:"-",187:"="};var Ge=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.ARROW_LEFT=37]="ARROW_LEFT",t[t.ARROW_UP=38]="ARROW_UP",t[t.ARROW_RIGHT=39]="ARROW_RIGHT",t[t.ARROW_DOWN=40]="ARROW_DOWN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.Digit0=48]="Digit0",t[t.Digit1=49]="Digit1",t[t.Digit2=50]="Digit2",t[t.Digit3=51]="Digit3",t[t.Digit4=52]="Digit4",t[t.Digit5=53]="Digit5",t[t.Digit6=54]="Digit6",t[t.Digit7=55]="Digit7",t[t.Digit8=56]="Digit8",t[t.Digit9=57]="Digit9",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUM_LOCK=144]="NUM_LOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.MINUS=189]="MINUS",t[t.EQUAL=187]="EQUAL",t))(Ge||{}),Yt=(t=>(t[t.SHIFT=1024]="SHIFT",t[t.ALT=2048]="ALT",t[t.CTRL_COMMAND=4096]="CTRL_COMMAND",t[t.MAC_CTRL=8192]="MAC_CTRL",t))(Yt||{}),GEe=Object.defineProperty,KEe=Object.getOwnPropertyDescriptor,ZEe=(t,e,n,r)=>{for(var i=r>1?void 0:r?KEe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&GEe(e,n,i),i},M3=(t,e)=>(n,r)=>e(n,r,t);const lu=ln("univer.shortcut");let p_=class extends We{constructor(e,n,r,i){super(),Mn(this,"_shortCutMapping",new Map),Mn(this,"_commandIDMapping",new Map),Mn(this,"_shortcutChanged$",new an),Mn(this,"shortcutChanged$",this._shortcutChanged$.asObservable()),Mn(this,"_forceEscaped",!1),Mn(this,"_disable",!1),this._commandService=e,this._platformService=n,this._contextService=r,this._layoutService=i,this.disposeWithMe(YEe("keydown",o=>{this._resolveKeyboardEvent(o)}))}setDisable(e){this._disable=e}getAllShortcuts(){return Array.from(this._shortCutMapping.values()).map(e=>Array.from(e.values())).flat()}registerShortcut(e){const n=this._getBindingFromItem(e),r=this._shortCutMapping.get(n);r?r.add(e):this._shortCutMapping.set(n,new Set([e]));const i=e.id,o=this._commandIDMapping.get(i);return o?o.add(e):this._commandIDMapping.set(i,new Set([e])),this._emitShortcutChanged(),je(()=>{var a,s,u,l;(a=this._shortCutMapping.get(n))==null||a.delete(e),((s=this._shortCutMapping.get(n))==null?void 0:s.size)===0&&this._shortCutMapping.delete(n),(u=this._commandIDMapping.get(i))==null||u.delete(e),((l=this._commandIDMapping.get(i))==null?void 0:l.size)===0&&this._commandIDMapping.delete(i),this._emitShortcutChanged()})}getShortcutDisplayOfCommand(e){const n=this._commandIDMapping.get(e);return n?this.getShortcutDisplay(n.values().next().value):null}getShortcutDisplay(e){var n;const r=this._getBindingFromItem(e),i=r&Yt.CTRL_COMMAND,o=r&Yt.SHIFT,a=r&Yt.ALT,s=r&Yt.MAC_CTRL,u=(n=qEe[r&255])!=null?n:"<->";return this._platformService.isMac?`${i?"⌘":""}${o?"⇧":""}${a?"⌥":""}${s?"⌃":""}${u}`:`${i?"Ctrl+":""}${o?"Shift+":""}${a?"Alt+":""}${u}`}_emitShortcutChanged(){this._shortcutChanged$.next()}forceEscape(){return this._forceEscaped=!0,je(()=>this._forceEscaped=!1)}_resolveKeyboardEvent(e){this._forceEscaped||this._disable||this._layoutService&&!this._layoutService.checkElementInCurrentApplicationScope(e.target)||this._dispatch(e)&&e.preventDefault()}_dispatch(e){const n=this._deriveBindingFromEvent(e);if(n===null)return!1;const r=this._shortCutMapping.get(n);if(r===void 0)return!1;const i=Array.from(r).sort((o,a)=>{var s,u;return((s=a.priority)!=null?s:0)-((u=o.priority)!=null?u:0)}).find(o=>{var a,s;return(s=(a=o.preconditions)==null?void 0:a.call(o,this._contextService))!=null?s:!0});return i?(this._commandService.executeCommand(i.id,i.staticParameters),!0):!1}_getBindingFromItem(e){return this._platformService.isMac&&e.mac?e.mac:this._platformService.isWindows&&e.win?e.win:this._platformService.isLinux&&e.linux?e.linux:e.binding}_deriveBindingFromEvent(e){const{shiftKey:n,metaKey:r,altKey:i,keyCode:o}=e;let a=o;return n&&(a|=Yt.SHIFT),i&&(a|=Yt.ALT),(this._platformService.isMac?r:e.ctrlKey)&&(a|=Yt.CTRL_COMMAND),this._platformService.isMac&&e.ctrlKey&&(a|=Yt.MAC_CTRL),a}};p_=ZEe([M3(0,se),M3(1,Ak),M3(2,pr),M3(3,W0(c8))],p_);var QEe=Object.defineProperty,JEe=Object.getOwnPropertyDescriptor,eye=(t,e,n,r)=>{for(var i=r>1?void 0:r?JEe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&QEe(e,n,i),i},tye=(t,e)=>(n,r)=>e(n,r,t);const S1=ln("univer.menu-service");let g_=class extends We{constructor(e){super(),Mn(this,"_menuItemMap",new Map),Mn(this,"_menuByPositions",new Map),Mn(this,"_menuChanged$",new dn(void 0)),Mn(this,"menuChanged$",this._menuChanged$.asObservable()),this._shortcutService=e}dispose(){this._menuItemMap.clear(),this._menuChanged$.complete()}addMenuItem(e){if(this._menuItemMap.has(e.id))throw new Error(`Menu item with the same id ${e.id} has already been added!`);return this._menuItemMap.set(e.id,e),Array.isArray(e.positions)?e.positions.forEach(n=>this._appendMenuToPosition(e,n)):this._appendMenuToPosition(e,e.positions),this._menuChanged$.next(),je(()=>{if(this._menuItemMap.delete(e.id),Array.isArray(e.positions))e.positions.forEach(n=>{const r=this._menuByPositions.get(n);if(!r)return;const i=r.findIndex(o=>o[0]===e.id);i>-1&&r.splice(i,1)});else{const n=this._menuByPositions.get(e.positions);if(!n)return;const r=n.findIndex(i=>i[0]===e.id);r>-1&&n.splice(r,1)}this._menuChanged$.next()})}getMenuItems(e){if(this._menuByPositions.has(e)){const n=this._menuByPositions.get(e);if(n)return[...n.values()].map(r=>this._getDisplayMenuItems(r[1]))}return[]}getMenuItem(e){return this._menuItemMap.has(e)?this._menuItemMap.get(e):null}_getDisplayMenuItems(e){const n=this._shortcutService.getShortcutDisplayOfCommand(e.id);return n?{...e,shortcut:n}:e}_appendMenuToPosition(e,n){this._menuByPositions.has(n)||this._menuByPositions.set(n,[]);const r=this._menuByPositions.get(n);if(r.findIndex(i=>i[0]===e.id)>-1)throw new Error(`Menu item with the same id ${e.id} has already been added!`);r.push([e.id,e])}};g_=eye([tye(0,lu)],g_);const nye="univer-menu-item-no-hover",rye="univer-menu-item-content",iye="univer-menu-item-selectable",oye="univer-menu-item-selectable-icon",aye="univer-menu-item-more-icon",t1={menuItemNoHover:nye,menuItemContent:rye,menuItemSelectable:iye,menuItemSelectableIcon:oye,menuItemMoreIcon:aye};function Tk(t){const{menuType:e,onOptionSelect:n}=t,r=Ct(S1);if(e){if(Array.isArray(e)){const i=e.map(o=>r.getMenuItems(o)).map(o=>o.reduce((a,s)=>{var u,l;return s.group?(a[s.group]=(u=a[s.group])!=null?u:[],a[s.group].push(s)):(a[Kt.CONTEXT_MENU_OTHERS]=(l=a[Kt.CONTEXT_MENU_OTHERS])!=null?l:[],a[Kt.CONTEXT_MENU_OTHERS].push(s)),a},{}));return Ae.jsx(Ae.Fragment,{children:i.map(o=>Object.keys(o).map(a=>Ae.jsx(zne,{eventKey:a,children:o[a].map(s=>Ae.jsx(RA,{menuItem:s,onClick:u=>{n==null||n({value:"",label:s.id,...u})}},s.id))},a)))})}return r.getMenuItems(e).map(i=>Ae.jsx(RA,{menuItem:i,onClick:o=>{n==null||n({value:"",label:i.id,...o})}},i.id))}}function wk(t){var e;const{options:n,value:r,onOptionSelect:i,parentKey:o}=t;return(e=n==null?void 0:n.map((a,s)=>{var u,l,c;const d=`${o}-${(u=a.label)!=null?u:a.id}-${s}`,m=p=>{i==null||i({value:p,label:a==null?void 0:a.label})},f=()=>{typeof a.value>"u"||i==null||i({...a})},h=Ci({[t1.menuItemNoHover]:typeof a.label!="string"&&!((l=a.label)!=null&&l.hoverable)});return Ae.jsx(l9,{eventKey:d,className:h,onClick:f,children:Ae.jsxs("span",{className:Ci(t1.menuItemContent,{[t1.menuItemSelectable]:!(typeof a.label!="string"&&!((c=a.label)!=null&&c.hoverable))}),children:[typeof r<"u"&&String(r)===String(a.value)&&Ae.jsx("span",{className:t1.menuItemSelectableIcon,children:Ae.jsx(uSe,{style:{color:"rgb(var(--success-color))"}})}),Ae.jsx(Ua,{value$:a.value$,value:a.value,label:a.label,icon:a.icon,onChange:m})]})},d)}))!=null?e:Ae.jsx(Ae.Fragment,{})}const E9=t=>Ae.jsxs(ZN,{selectable:!1,children:[Ae.jsx(wk,{...t}),Ae.jsx(Tk,{...t})]});function RA({menuItem:t,onClick:e}){const n=Ct(S1),r=t.id?n.getMenuItems(t.id):[],i=U1(t.disabled$||Kf(!1),!1,!0),o=U1(t.hidden$||Kf(!1),!1,!0),a=U1(t.value$||Kf(void 0),void 0,!0),[s,u]=_.useState(a),l=f=>{const h=n5(f)&&typeof f=="string"?Number.parseInt(f):f;u(h)},c=()=>{const f=t,{title:h,label:p}=f;return Ae.jsx(l9,{eventKey:f.id,disabled:i,onClick:()=>{e({value:s,id:f.id})},children:Ae.jsx("span",{className:t1.menuItemContent,children:Ae.jsx(Ua,{value:a,title:h,label:p,icon:f.icon,onChange:l})})},f.id)},d=()=>{const f=t;let h;return AC(f.selections)?h=U1(f.selections||Kf([]),[],!0):h=f.selections||[],h.length>0?Ae.jsx(EI,{eventKey:f.id,popupOffset:[18,0],title:Ae.jsxs("span",{className:t1.menuItemContent,children:[Ae.jsx(Ua,{title:f.title,value:s,onChange:l,icon:f.icon,label:f.label}),f.shortcut&&` (${f.shortcut})`]}),expandIcon:Ae.jsx(EA,{className:t1.menuItemMoreIcon}),children:h.length>0&&Ae.jsx(wk,{parentKey:f.id,menuType:f.id,options:h,onOptionSelect:p=>{e({value:p.value,id:f.id})}})},f.id):Ae.jsx(l9,{eventKey:f.id,children:Ae.jsxs("span",{className:t1.menuItemContent,children:[Ae.jsx(Ua,{title:f.title,value:s,icon:f.icon,label:f.label,onChange:l}),f.shortcut&&` (${f.shortcut})`]})},f.id)},m=()=>{const f=t;return Ae.jsx(EI,{eventKey:f.id,popupOffset:[18,0],title:Ae.jsx("span",{className:t1.menuItemContent,children:Ae.jsx(Ua,{title:f.title,icon:f.icon,label:f.label,onChange:l})}),expandIcon:Ae.jsx(EA,{className:t1.menuItemMoreIcon}),children:r.length&&Ae.jsx(Tk,{menuType:f.id,parentKey:f.id,onOptionSelect:e})},f.id)};return o?null:Ae.jsxs(Ae.Fragment,{children:[t.type===pt.SELECTOR&&d(),t.type===pt.SUBITEMS&&m(),t.type===pt.BUTTON&&c()]})}const IA="univer.command.copy",vf={id:IA,name:IA,multi:!0,priority:0,type:ue.COMMAND,preconditions:()=>!1,handler:async()=>!0},AA="univer.command.cut",d8={id:AA,name:AA,multi:!0,priority:0,type:ue.COMMAND,preconditions:()=>!1,handler:async()=>!0},TA="univer.command.paste",bf={id:TA,name:TA,multi:!0,priority:0,type:ue.COMMAND,preconditions:()=>!1,handler:async()=>!0},wE=ln("univer.notification-service");function Lk(){return typeof navigator.clipboard<"u"&&typeof navigator.clipboard.readText<"u"}var sye=Object.defineProperty,uye=Object.getOwnPropertyDescriptor,lye=(t,e,n,r)=>{for(var i=r>1?void 0:r?uye(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&sye(e,n,i),i},_g=(t,e)=>(n,r)=>e(n,r,t);const Mm="text/plain",Nm="text/html",$s=ln("univer.clipboard-interface-service");let v_=class extends We{constructor(e,n,r){super(),this._localeService=e,this._logService=n,this._notificationService=r}get supportClipboard(){return Lk()}async write(e,n){if(!this.supportClipboard)return this._legacyCopyHtml(n);try{return await navigator.clipboard.write([new ClipboardItem({[Mm]:new Blob([e],{type:Mm}),[Nm]:new Blob([n],{type:Nm})})])}catch(r){this._logService.error("[BrowserClipboardService]",r),this._showClipboardAuthenticationNotification()}}async writeText(e){if(!this.supportClipboard)return this._legacyCopyText(e);try{return await navigator.clipboard.writeText(e)}catch(n){this._logService.error("[BrowserClipboardService]",n),this._showClipboardAuthenticationNotification()}}async read(){if(!this.supportClipboard)throw new Error("[BrowserClipboardService] read() is not supported on this platform.");try{return navigator.clipboard.read()}catch(e){return this._logService.error("[BrowserClipboardService]",e),this._showClipboardAuthenticationNotification(),[]}}async readText(){if(!this.supportClipboard)throw new Error("[BrowserClipboardService] read() is not supported on this platform.");try{return await navigator.clipboard.readText()}catch(e){return this._logService.error("[BrowserClipboardService]",e),this._showClipboardAuthenticationNotification(),""}}_legacyCopyHtml(e){const n=document.activeElement,r=dye();document.body.appendChild(r),r.innerHTML=e;try{wA(r),document.execCommand("copy")}finally{n instanceof HTMLElement&&n.focus(),document.body.removeChild(r)}}_legacyCopyText(e){const n=document.activeElement,r=cye();document.body.appendChild(r),r.value=e;try{wA(r),document.execCommand("copy")}finally{n instanceof HTMLElement&&n.focus(),document.body.removeChild(r)}}_showClipboardAuthenticationNotification(){var e;(e=this._notificationService)==null||e.show({type:"warning",title:this._localeService.t("clipboard.authentication.title"),content:this._localeService.t("clipboard.authentication.content")})}};v_=lye([_g(0,K(Gt)),_g(1,oo),_g(2,W0(wE))],v_);function cye(){const t=document.createElement("textarea");return t.style.position="absolute",t.style.height="1px",t.style.width="1px",t.style.opacity="0",t.readOnly=!0,t}function dye(){const t=document.createElement("div");return t.contentEditable="true",t.style.position="absolute",t.style.opacity="0",t.style.height="1px",t.style.width="1px",t}function wA(t){if(t instanceof HTMLTextAreaElement){const r=t.hasAttribute("readonly");return r||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),r||t.removeAttribute("readonly"),t.value}t.hasAttribute("contenteditable")&&t.focus();const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();if(!n)throw new Error;return n.removeAllRanges(),n.addRange(e),n.toString()}function mye(t){const e=t.get(en);return{id:Gm.id,group:Kt.TOOLBAR_HISTORY,type:pt.BUTTON,icon:"UndoSingle",title:"Undo",tooltip:"toolbar.undo",positions:[hn.TOOLBAR_START],disabled$:e.undoRedoStatus$.pipe(ja(n=>n.undos<=0))}}function fye(t){const e=t.get(en);return{id:a5.id,group:Kt.TOOLBAR_HISTORY,type:pt.BUTTON,icon:"RedoSingle",title:"Redo",tooltip:"toolbar.redo",positions:[hn.TOOLBAR_START],disabled$:e.undoRedoStatus$.pipe(ja(n=>n.redos<=0))}}var hye=Object.defineProperty,pye=Object.getOwnPropertyDescriptor,gye=(t,e,n,r)=>{for(var i=r>1?void 0:r?pye(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&hye(e,n,i),i},Xd=(t,e)=>(n,r)=>e(n,r,t);const vye={id:vf.id,description:"shortcut.copy",group:"1_common-edit",binding:Ge.C|Yt.CTRL_COMMAND},bye={id:d8.id,description:"shortcut.cut",group:"1_common-edit",binding:Ge.X|Yt.CTRL_COMMAND},_ye={id:bf.id,description:"shortcut.paste",group:"1_common-edit",binding:Ge.V|Yt.CTRL_COMMAND,preconditions:Lk},Cye={id:Gm.id,description:"shortcut.undo",group:"1_common-edit",binding:Ge.Z|Yt.CTRL_COMMAND},Sye={id:a5.id,description:"shortcut.redo",group:"1_common-edit",binding:Ge.Y|Yt.CTRL_COMMAND};let Z4=class extends We{constructor(e,n,r,i,o){super(),this._injector=e,this._menuService=n,this._shortcutService=r,this._commandService=i,this._interfaceService=o,this.initialize()}initialize(){this._registerCommands(),this._registerShortcuts(),this._registerMenus()}_registerMenus(){[mye,fye].forEach(e=>{this.disposeWithMe(this._menuService.addMenuItem(this._injector.invoke(e)))})}_registerCommands(){[d8,vf,bf].forEach(e=>this.disposeWithMe(this._commandService.registerMultipleCommand(e)))}_registerShortcuts(){const e=[Cye,Sye];e.push(bye,vye,_ye),e.forEach(n=>this.disposeWithMe(this._shortcutService.registerShortcut(n)))}};Z4=gye([yt(ot.Ready,Z4),Xd(0,K(wn)),Xd(1,S1),Xd(2,lu),Xd(3,se),Xd(4,$s)],Z4);const F0=ln("univer.ui-controller");var _f={},Ok={exports:{}},Pk={exports:{}};(function(t){function e(n){"@babel/helpers - typeof";return t.exports=e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Pk);var Cf=Pk.exports;(function(t){var e=Cf.default;function n(i){if(typeof WeakMap!="function")return null;var o=new WeakMap,a=new WeakMap;return(n=function(s){return s?a:o})(i)}function r(i,o){if(!o&&i&&i.__esModule)return i;if(i===null||e(i)!="object"&&typeof i!="function")return{default:i};var a=n(o);if(a&&a.has(i))return a.get(i);var s={__proto__:null},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in i)if(l!=="default"&&Object.prototype.hasOwnProperty.call(i,l)){var c=u?Object.getOwnPropertyDescriptor(i,l):null;c&&(c.get||c.set)?Object.defineProperty(s,l,c):s[l]=i[l]}return s.default=i,a&&a.set(i,s),s}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Ok);var Eye=Ok.exports,Mk={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Mk);var yye=Mk.exports,Nk={exports:{}};(function(t){var e=Cf.default;function n(){t.exports=n=function(){return i},t.exports.__esModule=!0,t.exports.default=t.exports;var r,i={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(x,O,M){x[O]=M.value},u=typeof Symbol=="function"?Symbol:{},l=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",d=u.toStringTag||"@@toStringTag";function m(x,O,M){return Object.defineProperty(x,O,{value:M,enumerable:!0,configurable:!0,writable:!0}),x[O]}try{m({},"")}catch{m=function(x,O,M){return x[O]=M}}function f(x,O,M,V){var q=O&&O.prototype instanceof S?O:S,ie=Object.create(q.prototype),ce=new te(V||[]);return s(ie,"_invoke",{value:B(x,M,ce)}),ie}function h(x,O,M){try{return{type:"normal",arg:x.call(O,M)}}catch(V){return{type:"throw",arg:V}}}i.wrap=f;var p="suspendedStart",v="suspendedYield",g="executing",b="completed",C={};function S(){}function E(){}function y(){}var D={};m(D,l,function(){return this});var R=Object.getPrototypeOf,I=R&&R(R(X([])));I&&I!==o&&a.call(I,l)&&(D=I);var T=y.prototype=S.prototype=Object.create(D);function P(x){["next","throw","return"].forEach(function(O){m(x,O,function(M){return this._invoke(O,M)})})}function N(x,O){function M(q,ie,ce,pe){var oe=h(x[q],x,ie);if(oe.type!=="throw"){var he=oe.arg,fe=he.value;return fe&&e(fe)=="object"&&a.call(fe,"__await")?O.resolve(fe.__await).then(function(ve){M("next",ve,ce,pe)},function(ve){M("throw",ve,ce,pe)}):O.resolve(fe).then(function(ve){he.value=ve,ce(he)},function(ve){return M("throw",ve,ce,pe)})}pe(oe.arg)}var V;s(this,"_invoke",{value:function(q,ie){function ce(){return new O(function(pe,oe){M(q,ie,pe,oe)})}return V=V?V.then(ce,ce):ce()}})}function B(x,O,M){var V=p;return function(q,ie){if(V===g)throw new Error("Generator is already running");if(V===b){if(q==="throw")throw ie;return{value:r,done:!0}}for(M.method=q,M.arg=ie;;){var ce=M.delegate;if(ce){var pe=W(ce,M);if(pe){if(pe===C)continue;return pe}}if(M.method==="next")M.sent=M._sent=M.arg;else if(M.method==="throw"){if(V===p)throw V=b,M.arg;M.dispatchException(M.arg)}else M.method==="return"&&M.abrupt("return",M.arg);V=g;var oe=h(x,O,M);if(oe.type==="normal"){if(V=M.done?b:v,oe.arg===C)continue;return{value:oe.arg,done:M.done}}oe.type==="throw"&&(V=b,M.method="throw",M.arg=oe.arg)}}}function W(x,O){var M=O.method,V=x.iterator[M];if(V===r)return O.delegate=null,M==="throw"&&x.iterator.return&&(O.method="return",O.arg=r,W(x,O),O.method==="throw")||M!=="return"&&(O.method="throw",O.arg=new TypeError("The iterator does not provide a '"+M+"' method")),C;var q=h(V,x.iterator,O.arg);if(q.type==="throw")return O.method="throw",O.arg=q.arg,O.delegate=null,C;var ie=q.arg;return ie?ie.done?(O[x.resultName]=ie.value,O.next=x.nextLoc,O.method!=="return"&&(O.method="next",O.arg=r),O.delegate=null,C):ie:(O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,C)}function G(x){var O={tryLoc:x[0]};1 in x&&(O.catchLoc=x[1]),2 in x&&(O.finallyLoc=x[2],O.afterLoc=x[3]),this.tryEntries.push(O)}function Q(x){var O=x.completion||{};O.type="normal",delete O.arg,x.completion=O}function te(x){this.tryEntries=[{tryLoc:"root"}],x.forEach(G,this),this.reset(!0)}function X(x){if(x||x===""){var O=x[l];if(O)return O.call(x);if(typeof x.next=="function")return x;if(!isNaN(x.length)){var M=-1,V=function q(){for(;++M<x.length;)if(a.call(x,M))return q.value=x[M],q.done=!1,q;return q.value=r,q.done=!0,q};return V.next=V}}throw new TypeError(e(x)+" is not iterable")}return E.prototype=y,s(T,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:E,configurable:!0}),E.displayName=m(y,d,"GeneratorFunction"),i.isGeneratorFunction=function(x){var O=typeof x=="function"&&x.constructor;return!!O&&(O===E||(O.displayName||O.name)==="GeneratorFunction")},i.mark=function(x){return Object.setPrototypeOf?Object.setPrototypeOf(x,y):(x.__proto__=y,m(x,d,"GeneratorFunction")),x.prototype=Object.create(T),x},i.awrap=function(x){return{__await:x}},P(N.prototype),m(N.prototype,c,function(){return this}),i.AsyncIterator=N,i.async=function(x,O,M,V,q){q===void 0&&(q=Promise);var ie=new N(f(x,O,M,V),q);return i.isGeneratorFunction(O)?ie:ie.next().then(function(ce){return ce.done?ce.value:ie.next()})},P(T),m(T,d,"Generator"),m(T,l,function(){return this}),m(T,"toString",function(){return"[object Generator]"}),i.keys=function(x){var O=Object(x),M=[];for(var V in O)M.push(V);return M.reverse(),function q(){for(;M.length;){var ie=M.pop();if(ie in O)return q.value=ie,q.done=!1,q}return q.done=!0,q}},i.values=X,te.prototype={constructor:te,reset:function(x){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(Q),!x)for(var O in this)O.charAt(0)==="t"&&a.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=r)},stop:function(){this.done=!0;var x=this.tryEntries[0].completion;if(x.type==="throw")throw x.arg;return this.rval},dispatchException:function(x){if(this.done)throw x;var O=this;function M(oe,he){return ie.type="throw",ie.arg=x,O.next=oe,he&&(O.method="next",O.arg=r),!!he}for(var V=this.tryEntries.length-1;V>=0;--V){var q=this.tryEntries[V],ie=q.completion;if(q.tryLoc==="root")return M("end");if(q.tryLoc<=this.prev){var ce=a.call(q,"catchLoc"),pe=a.call(q,"finallyLoc");if(ce&&pe){if(this.prev<q.catchLoc)return M(q.catchLoc,!0);if(this.prev<q.finallyLoc)return M(q.finallyLoc)}else if(ce){if(this.prev<q.catchLoc)return M(q.catchLoc,!0)}else{if(!pe)throw new Error("try statement without catch or finally");if(this.prev<q.finallyLoc)return M(q.finallyLoc)}}}},abrupt:function(x,O){for(var M=this.tryEntries.length-1;M>=0;--M){var V=this.tryEntries[M];if(V.tryLoc<=this.prev&&a.call(V,"finallyLoc")&&this.prev<V.finallyLoc){var q=V;break}}q&&(x==="break"||x==="continue")&&q.tryLoc<=O&&O<=q.finallyLoc&&(q=null);var ie=q?q.completion:{};return ie.type=x,ie.arg=O,q?(this.method="next",this.next=q.finallyLoc,C):this.complete(ie)},complete:function(x,O){if(x.type==="throw")throw x.arg;return x.type==="break"||x.type==="continue"?this.next=x.arg:x.type==="return"?(this.rval=this.arg=x.arg,this.method="return",this.next="end"):x.type==="normal"&&O&&(this.next=O),C},finish:function(x){for(var O=this.tryEntries.length-1;O>=0;--O){var M=this.tryEntries[O];if(M.finallyLoc===x)return this.complete(M.completion,M.afterLoc),Q(M),C}},catch:function(x){for(var O=this.tryEntries.length-1;O>=0;--O){var M=this.tryEntries[O];if(M.tryLoc===x){var V=M.completion;if(V.type==="throw"){var q=V.arg;Q(M)}return q}}throw new Error("illegal catch attempt")},delegateYield:function(x,O,M){return this.delegate={iterator:X(x),resultName:O,nextLoc:M},this.method==="next"&&(this.arg=r),C}},i}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Nk);var Dye=Nk.exports,xk={exports:{}};(function(t){function e(r,i,o,a,s,u,l){try{var c=r[u](l),d=c.value}catch(m){o(m);return}c.done?i(d):Promise.resolve(d).then(a,s)}function n(r){return function(){var i=this,o=arguments;return new Promise(function(a,s){var u=r.apply(i,o);function l(d){e(u,a,s,l,c,"next",d)}function c(d){e(u,a,s,l,c,"throw",d)}l(void 0)})}}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(xk);var Rye=xk.exports,Fk={exports:{}},$k={exports:{}},kk={exports:{}},Bk={exports:{}};(function(t){var e=Cf.default;function n(r,i){if(e(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var a=o.call(r,i||"default");if(e(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(r)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Bk);var Iye=Bk.exports;(function(t){var e=Cf.default,n=Iye;function r(i){var o=n(i,"string");return e(o)=="symbol"?o:String(o)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(kk);var Aye=kk.exports;(function(t){var e=Aye;function n(r,i,o){return i=e(i),i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o,r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})($k);var Tye=$k.exports;(function(t){var e=Tye;function n(i,o){var a=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);o&&(s=s.filter(function(u){return Object.getOwnPropertyDescriptor(i,u).enumerable})),a.push.apply(a,s)}return a}function r(i){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?n(Object(a),!0).forEach(function(s){e(i,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(s){Object.defineProperty(i,s,Object.getOwnPropertyDescriptor(a,s))})}return i}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Fk);var wye=Fk.exports,Lye=Eye.default,m8=yye.default;Object.defineProperty(_f,"__esModule",{value:!0});_f._r=Hye;_f._u=Yye;var Oye=_f.render=jye,Pye=_f.unmount=Xye,y9=m8(Dye),Uk=m8(Rye),Mye=m8(Cf),Nye=m8(wye),xye=Lye(o1),Sf=(0,Nye.default)({},xye),Fye=Sf.version,$ye=Sf.render,kye=Sf.unmountComponentAtNode,f8;try{var Bye=Number((Fye||"").split(".")[0]);Bye>=18&&(f8=Sf.createRoot)}catch{}function LA(t){var e=Sf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&(0,Mye.default)(e)==="object"&&(e.usingClientEntryPoint=t)}var D9="__rc_react_root__";function Uye(t,e){LA(!0);var n=e[D9]||f8(e);LA(!1),n.render(t),e[D9]=n}function Vye(t,e){$ye(t,e)}function Hye(t,e){}function jye(t,e){if(f8){Uye(t,e);return}Vye(t,e)}function zye(t){return b_.apply(this,arguments)}function b_(){return b_=(0,Uk.default)((0,y9.default)().mark(function t(e){return(0,y9.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Promise.resolve().then(function(){var r;(r=e[D9])===null||r===void 0||r.unmount(),delete e[D9]}));case 1:case"end":return n.stop()}},t)})),b_.apply(this,arguments)}function Wye(t){kye(t)}function Yye(t){}function Xye(t){return __.apply(this,arguments)}function __(){return __=(0,Uk.default)((0,y9.default)().mark(function t(e){return(0,y9.default)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(f8===void 0){n.next=2;break}return n.abrupt("return",zye(e));case 2:Wye(e);case 3:case"end":return n.stop()}},t)})),__.apply(this,arguments)}var qye=Object.defineProperty,Gye=Object.getOwnPropertyDescriptor,Kye=(t,e,n,r)=>{for(var i=r>1?void 0:r?Gye(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&qye(e,n,i),i},OA=(t,e)=>(n,r)=>e(n,r,t);const LE=ln("univer.focus-service"),Zye="FOCUSING_UNIVER";let C_=class extends We{constructor(e,n){super(),Mn(this,"_containerElement",null),Mn(this,"_isUniverFocused",!0),this._contextService=e,this._logService=n,this._initFocusListener(),this._initEditorStatus(),window._contextService=this}get isFocused(){return this._isUniverFocused}dispose(){super.dispose(),this._containerElement=null}setContainerElement(e){this._containerElement=e}forceFocus(){}_initFocusListener(){this.disposeWithMe(je(bv(window,"focusin").subscribe(e=>{var n;e.target&&(n=this._containerElement)!=null&&n.contains(e.target)?this._isUniverFocused=!0:this._isUniverFocused=!1,this._contextService.setContextValue(Zye,this._isUniverFocused),this._contextService.setContextValue(nl,e.target.classList.contains("univer-editor"))})))}_initEditorStatus(){var e;this._contextService.setContextValue(nl,!!((e=document.activeElement)!=null&&e.classList.contains("univer-editor")))}};C_=Kye([yt(ot.Ready,LE),OA(0,pr),OA(1,oo)],C_);const Ef=ln("univer.message-service"),Qye="univer-app-layout",Jye="univer-app-container",eDe="univer-app-container-header",tDe="univer-app-container-wrapper",nDe="univer-app-container-content",rDe="univer-app-container-canvas",iDe="univer-app-container-sidebar",Cu={appLayout:Qye,appContainer:Jye,appContainerHeader:eDe,appContainerWrapper:tDe,appContainerContent:nDe,appContainerCanvas:rDe,appContainerSidebar:iDe};function S6(t){const{components:e}=t;return e?Array.from(e.values()).map((n,r)=>Se.createElement(n(),{key:`${r}`})):null}const oDe="univer-toolbar-btn",aDe="univer-toolbar-btn-active",PA={toolbarBtn:oDe,toolbarBtnActive:aDe};function Vk(t){const{children:e,className:n,style:r,disabled:i=!1,active:o=!1,onClick:a,onDoubleClick:s,...u}=t,l=m=>{if(i){m.preventDefault();return}a&&a(m)},c=m=>{if(i){m.preventDefault();return}s&&s(m)},d=Ci(PA.toolbarBtn,{[`${PA.toolbarBtn}-active`]:o},n);return Ae.jsx("button",{className:d,style:r,disabled:i,onClick:l,onDoubleClick:c,...u,children:e})}const sDe="univer-headerbar",uDe="univer-header-menu",lDe="univer-menubar",cDe="univer-menubar-item",dDe="univer-menubar-item-active",mDe="univer-toolbar",fDe="univer-toolbar-container",hDe="univer-toolbar-more",pDe="univer-toolbar-more-container",gDe="univer-toolbar-group",vDe="univer-toolbar-item-select-button",bDe="univer-toolbar-item-select-button-disabled",_De="univer-toolbar-item-select-button-label",CDe="univer-toolbar-item-select-button-arrow",SDe="univer-toolbar-item-select",EDe="univer-toolbar-item-select-disabled",yDe="univer-toolbar-item-select-arrow",DDe="univer-toolbar-item-select-arrow-disabled",Br={headerbar:sDe,headerMenu:uDe,menubar:lDe,menubarItem:cDe,menubarItemActive:dDe,toolbar:mDe,toolbarContainer:fDe,toolbarMore:hDe,toolbarMoreContainer:pDe,toolbarGroup:gDe,toolbarItemSelectButton:vDe,toolbarItemSelectButtonDisabled:bDe,toolbarItemSelectButtonLabel:_De,toolbarItemSelectButtonArrow:CDe,toolbarItemSelect:SDe,toolbarItemSelectDisabled:EDe,toolbarItemSelectArrow:yDe,toolbarItemSelectArrowDisabled:DDe},Cg=_.forwardRef((t,e)=>{var n,r;const i=Ct(Gt),o=Ct(se),a=gf(),[s,u]=_.useState(),[l,c]=_.useState(!1),[d,m]=_.useState(!1),[f,h]=_.useState(!1),[p,v]=_.useState(!1),[g,b]=_.useState(!1),C=(x,O)=>{o.executeCommand(x,O),a.get(To).focus()};function S(x){v(x)}function E(x){b(x),x||v(!1)}_.useEffect(()=>{const x=[];return t.disabled$&&x.push(t.disabled$.subscribe(O=>{c(O)})),t.hidden$&&x.push(t.hidden$.subscribe(O=>{h(O)})),t.type===pt.BUTTON&&t.activated$&&x.push(t.activated$.subscribe(O=>{m(O)})),t.value$&&x.push(t.value$.subscribe(O=>{u(O)})),()=>{x.forEach(O=>{O.unsubscribe()})}},[]);const{tooltip:y,shortcut:D,icon:R,title:I,label:T,id:P}=t,N=i.t(y??"")+(D?` (${D})`:""),{selections:B}=t,W=B;let G=R;AC(R)?G=U1(R,void 0,!0):G=(r=(n=W==null?void 0:W.find(x=>x.value===s))==null?void 0:n.icon)!=null?r:R;function Q(x){function O(q){if(l)return;let ie=P;const ce=q;q.id&&(ie=q.id),C(ie,ce)}function M(q){l||C(P,{value:q})}function V(){l||x===pt.BUTTON_SELECTOR&&C(P,{value:s})}return x===pt.BUTTON_SELECTOR?Ae.jsxs("div",{className:`${Br.toolbarItemSelectButton} ${l?Br.toolbarItemSelectButtonDisabled:""}`,"data-disabled":l,children:[Ae.jsx("div",{className:Br.toolbarItemSelectButtonLabel,onClick:V,children:Ae.jsx(Ua,{icon:G,title:I,value:s,label:T,onChange:M})}),!l&&Ae.jsx(eu,{overlay:Ae.jsx(E9,{menuType:P,options:W,onOptionSelect:O,value:s}),onVisibleChange:E,children:Ae.jsx("div",{className:`${Br.toolbarItemSelectButtonArrow} ${l?Br.toolbarItemSelectButtonArrowDisabled:""}`,"data-disabled":l,children:Ae.jsx(SA,{})})})]}):l?Ae.jsx(Ae.Fragment,{}):Ae.jsx(eu,{overlay:Ae.jsx(E9,{menuType:P,options:W,onOptionSelect:O,value:s}),onVisibleChange:E,children:Ae.jsxs("div",{className:`${Br.toolbarItemSelect} ${l?Br.toolbarItemSelectDisabled:""}`,children:[Ae.jsx(Ua,{icon:G,title:I,value:s,label:T,onChange:M}),Ae.jsx("div",{className:`${Br.toolbarItemSelectArrow} ${l?Br.toolbarItemSelectArrowDisabled:""}`,children:Ae.jsx(SA,{})})]})})}function te(){var x;const O=Ct(Jo).get(typeof T=="string"?T:(x=T==null?void 0:T.name)!=null?x:"");return Ae.jsx(Vk,{className:Br.toolbarItemTextButton,active:d,disabled:l,onClick:()=>C(t.id),onDoubleClick:()=>t.subId&&C(t.subId),children:O?Ae.jsx(Ua,{title:I,value:s,label:T}):Ae.jsx(Ua,{icon:R})})}function X(){switch(t.type){case pt.BUTTON_SELECTOR:case pt.SELECTOR:case pt.SUBITEMS:return Q(t.type);case pt.BUTTON:default:return te()}}return f?Ae.jsx(Ae.Fragment,{}):Ae.jsx(df,{ref:e,visible:g?!1:p,title:N,placement:"bottom",onVisibleChange:S,children:X()})}),RDe=[hn.TOOLBAR_START,hn.TOOLBAR_INSERT,hn.TOOLBAR_FORMULAS,hn.TOOLBAR_DATA,hn.TOOLBAR_VIEW,hn.TOOLBAR_OTHERS];function IDe(t){const{headerMenuComponents:e}=t,n=Ct(Gt),r=Ct(S1),[i,o]=_.useState(hn.TOOLBAR_START),a=_.useRef(null),s=_.useRef(null),u=_.useRef({}),[l,c]=_.useState([]),[d,m]=_.useState([]);_.useEffect(()=>{const p=r.menuChanged$.subscribe(()=>{const v=[];for(const g of RDe){const b=r.getMenuItems(g);b.length&&v.push({name:g,menuItems:b})}c(v)});return()=>{p.unsubscribe()}},[i]),_.useEffect(()=>{function p(){var g,b,C,S;const E=(b=(g=a.current)==null?void 0:g.clientWidth)!=null?b:0,y=(S=(C=s.current)==null?void 0:C.clientWidth)!=null?S:0,D=Object.entries(u.current).map(([P,N])=>{var B;return{key:N.key,width:(B=N.el)==null?void 0:B.clientWidth}}),R=8,I=[];let T=y+120;for(let P=D.length-1;P>=0;P--){const N=D[P];T-=N.width+R,T>=E&&I.push(N.key)}m(I)}p();const v=new ResizeObserver(()=>p());return v.observe(document.body),()=>{v.unobserve(document.body)}},[l]);const f=_.useMemo(()=>{var p,v;return(v=(p=l.find(g=>g.name===i))==null?void 0:p.menuItems.reduce((g,b)=>{var C;const S=(C=b.group)!=null?C:Kt.TOOLBAR_OTHERS;return g[S]||(g[S]=[]),g[S].push(b),g},{}))!=null?v:{}},[l]),h=_.useMemo(()=>e&&e.size>0||l.length>1,[e,l]);return Ae.jsxs(Ae.Fragment,{children:[h?Ae.jsxs("header",{className:Br.headerbar,children:[Ae.jsx("div",{className:Br.menubar,children:l.length>1&&l.map((p,v)=>Ae.jsx("a",{className:Ci(Br.menubarItem,{[Br.menubarItemActive]:p.name===i}),onClick:()=>o(p.name),children:n.t(p.name)},v))}),Ae.jsx("div",{className:Br.headerMenu,children:Ae.jsx(S6,{components:e})})]}):null,Ae.jsx("div",{ref:a,className:Br.toolbar,children:Ae.jsxs("div",{className:Br.toolbarContainer,children:[Object.entries(f).map(([p,v])=>Ae.jsx("div",{className:Br.toolbarGroup,children:v.map(g=>!d.includes(g.id)&&Ae.jsx(Cg,{...g},g.id))},p)),d.length>0&&Ae.jsx(df,{title:"更多",placement:"bottom",children:Ae.jsx(eu,{className:Br.toolbarMore,overlay:Ae.jsx("div",{className:Br.toolbarMoreContainer,onClick:p=>p.stopPropagation(),children:Object.entries(f).map(([p,v])=>Ae.jsx("div",{className:Br.toolbarGroup,children:v.map(g=>d.includes(g.id)&&Ae.jsx(Cg,{...g},g.id))},p))}),children:Ae.jsx(Vk,{className:Br.toolbarItemTextButton,children:Ae.jsx(eEe,{})})})})]})}),Ae.jsx("div",{ref:s,className:Br.toolbarContainer,style:{position:"absolute",top:-9999,left:-9999,opacity:0},children:Object.entries(f).map(([p,v])=>Ae.jsx("div",{className:Br.toolbarGroup,children:v.map(g=>Ae.jsx(Cg,{ref:b=>{u.current[g.id]={el:b==null?void 0:b.nativeElement,key:g.id}},...g},g.id))},p))})]})}const cd=ln("univer.sidebar-service"),ADe="univer-sidebar",TDe="univer-sidebar-open",wDe="univer-sidebar-container",LDe="univer-sidebar-header",ODe="univer-sidebar-header-close",PDe="univer-sidebar-body",MDe="univer-sidebar-footer",Fl={sidebar:ADe,sidebarOpen:TDe,sidebarContainer:wDe,sidebarHeader:LDe,sidebarHeaderClose:ODe,sidebarBody:PDe,sidebarFooter:MDe};function NDe(){const t=Ct(cd),[e,n]=_.useState({});_.useEffect(()=>{const s=t.sidebarOptions$.subscribe(u=>{n(u)});return()=>{s.unsubscribe()}},[]);const r=e;for(const s of["children","header","footer"]){const u=s;if(e[u]){const l=e[u];l&&(r[u]=Ae.jsx(Ua,{...l}))}}const i=Ci(Fl.sidebar,{[Fl.sidebarOpen]:r.visible}),o=_.useMemo(()=>r.visible?typeof r.width=="number"?`${r.width}px`:r.width:0,[r]);function a(){var s;const u={...e,visible:!1};n(u),t.sidebarOptions$.next(u),(s=u==null?void 0:u.onClose)==null||s.call(u)}return Ae.jsx("section",{className:i,style:{width:o},children:Ae.jsxs("section",{className:Fl.sidebarContainer,children:[Ae.jsxs("header",{className:Fl.sidebarHeader,children:[r==null?void 0:r.header,Ae.jsx("a",{className:Fl.sidebarHeaderClose,onClick:a,children:Ae.jsx(ZF,{})})]}),Ae.jsx("section",{className:Fl.sidebarBody,children:r==null?void 0:r.children}),(r==null?void 0:r.footer)&&Ae.jsx("footer",{className:Fl.sidebarFooter,children:r.footer})]})})}const Hk=ln("univer.zen-zone-service"),xDe="univer-zen-zone",FDe="univer-zen-zone-open",$De="univer-zen-zone-close",Sg={zenZone:xDe,zenZoneOpen:FDe,zenZoneClose:$De};function kDe(){const t=Ct(Hk),[e,n]=_.useState(!1),[r,i]=_.useState(),o=Ct(Jo);_.useEffect(()=>{const u=[t.visible$.subscribe(l=>{n(l)}),t.componentKey$.subscribe(l=>{i(l)})];return()=>{u.forEach(l=>{l.unsubscribe()})}},[]);const a=Ci(Sg.zenZone,e?Sg.zenZoneOpen:Sg.zenZoneClose),s=_.useMemo(()=>{const u=o.get(r??"");if(u)return u},[r]);return Ae.jsx("section",{className:a,children:s&&Ae.jsx(s,{})})}function S_(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function BDe(t){if(Array.isArray(t))return S_(t)}function UDe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function jk(t,e){if(t){if(typeof t=="string")return S_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S_(t,e)}}function VDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j6(t){return BDe(t)||UDe(t)||jk(t)||VDe()}function HDe(t){if(Array.isArray(t))return t}function jDe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}function zDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ki(t,e){return HDe(t)||jDe(t,e)||jk(t,e)||zDe()}function WDe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function R9(t,e){if(t==null)return{};var n=WDe(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Ps(t){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ps(t)}function YDe(t,e){if(Ps(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ps(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zk(t){var e=YDe(t,"string");return Ps(e)=="symbol"?e:String(e)}function yi(t,e,n){return e=zk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function vr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?MA(Object(n),!0).forEach(function(r){yi(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function $0(){return $0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$0.apply(this,arguments)}var Wk={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var s=arguments[a];s&&(o=i(o,r(s)))}return o}function r(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var s in o)e.call(o,s)&&o[s]&&(a=i(a,s));return a}function i(o,a){return a?o?o+" "+a:o+a:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(Wk);var XDe=Wk.exports;const z6=_k(XDe);function qDe(t){return t instanceof HTMLElement||t instanceof SVGElement}function GDe(t){return qDe(t)?t:t instanceof Se.Component?o1.findDOMNode(t):null}var Yk={exports:{}},Sr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OE=Symbol.for("react.element"),PE=Symbol.for("react.portal"),h8=Symbol.for("react.fragment"),p8=Symbol.for("react.strict_mode"),g8=Symbol.for("react.profiler"),v8=Symbol.for("react.provider"),b8=Symbol.for("react.context"),KDe=Symbol.for("react.server_context"),_8=Symbol.for("react.forward_ref"),C8=Symbol.for("react.suspense"),S8=Symbol.for("react.suspense_list"),E8=Symbol.for("react.memo"),y8=Symbol.for("react.lazy"),ZDe=Symbol.for("react.offscreen"),Xk;Xk=Symbol.for("react.module.reference");function Qa(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case OE:switch(t=t.type,t){case h8:case g8:case p8:case C8:case S8:return t;default:switch(t=t&&t.$$typeof,t){case KDe:case b8:case _8:case y8:case E8:case v8:return t;default:return e}}case PE:return e}}}Sr.ContextConsumer=b8;Sr.ContextProvider=v8;Sr.Element=OE;Sr.ForwardRef=_8;Sr.Fragment=h8;Sr.Lazy=y8;Sr.Memo=E8;Sr.Portal=PE;Sr.Profiler=g8;Sr.StrictMode=p8;Sr.Suspense=C8;Sr.SuspenseList=S8;Sr.isAsyncMode=function(){return!1};Sr.isConcurrentMode=function(){return!1};Sr.isContextConsumer=function(t){return Qa(t)===b8};Sr.isContextProvider=function(t){return Qa(t)===v8};Sr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===OE};Sr.isForwardRef=function(t){return Qa(t)===_8};Sr.isFragment=function(t){return Qa(t)===h8};Sr.isLazy=function(t){return Qa(t)===y8};Sr.isMemo=function(t){return Qa(t)===E8};Sr.isPortal=function(t){return Qa(t)===PE};Sr.isProfiler=function(t){return Qa(t)===g8};Sr.isStrictMode=function(t){return Qa(t)===p8};Sr.isSuspense=function(t){return Qa(t)===C8};Sr.isSuspenseList=function(t){return Qa(t)===S8};Sr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===h8||t===g8||t===p8||t===C8||t===S8||t===ZDe||typeof t=="object"&&t!==null&&(t.$$typeof===y8||t.$$typeof===E8||t.$$typeof===v8||t.$$typeof===b8||t.$$typeof===_8||t.$$typeof===Xk||t.getModuleId!==void 0)};Sr.typeOf=Qa;Yk.exports=Sr;var Eg=Yk.exports;function QDe(t,e){typeof t=="function"?t(e):Ps(t)==="object"&&t&&"current"in t&&(t.current=e)}function JDe(t){var e,n,r=Eg.isMemo(t)?t.type.type:t.type;return!(typeof r=="function"&&!((e=r.prototype)!==null&&e!==void 0&&e.render)&&r.$$typeof!==Eg.ForwardRef||typeof t=="function"&&!((n=t.prototype)!==null&&n!==void 0&&n.render)&&t.$$typeof!==Eg.ForwardRef)}var eRe=_.createContext({});function qk(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zk(r.key),r)}}function Gk(t,e,n){return e&&NA(t.prototype,e),n&&NA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function E_(t,e){return E_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},E_(t,e)}function Kk(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E_(t,e)}function I9(t){return I9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I9(t)}function Zk(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zk=function(){return!!t})()}function y_(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tRe(t,e){if(e&&(Ps(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y_(t)}function Qk(t){var e=Zk();return function(){var n=I9(t),r;if(e){var i=I9(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return tRe(this,r)}}var nRe=function(t){Kk(n,t);var e=Qk(n);function n(){return qk(this,n),e.apply(this,arguments)}return Gk(n,[{key:"render",value:function(){return this.props.children}}]),n}(_.Component);function Q4(t){var e=_.useRef(!1),n=_.useState(t),r=ki(n,2),i=r[0],o=r[1];_.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function a(s,u){u&&e.current||o(s)}return[i,a]}var Ql="none",N3="appear",x3="enter",F3="leave",xA="none",ms="prepare",i0="start",o0="active",ME="end",Jk="prepared";function NE(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function FA(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function rRe(t,e){var n={animationend:FA("Animation","AnimationEnd"),transitionend:FA("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var iRe=rRe(NE(),typeof window<"u"?window:{}),eB={};if(NE()){var oRe=document.createElement("div");eB=oRe.style}var $3={};function tB(t){if($3[t])return $3[t];var e=iRe[t];if(e)for(var n=Object.keys(e),r=n.length,i=0;i<r;i+=1){var o=n[i];if(Object.prototype.hasOwnProperty.call(e,o)&&o in eB)return $3[t]=e[o],$3[t]}return""}var nB=tB("animationend"),rB=tB("transitionend"),iB=!!(nB&&rB),$A=nB||"animationend",kA=rB||"transitionend";function BA(t,e){if(!t)return null;if(Ps(t)==="object"){var n=e.replace(/-\w/g,function(r){return r[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const aRe=function(t){var e=_.useRef(),n=_.useRef(t);n.current=t;var r=_.useCallback(function(a){n.current(a)},[]);function i(a){a&&(a.removeEventListener(kA,r),a.removeEventListener($A,r))}function o(a){e.current&&e.current!==a&&i(e.current),a&&a!==e.current&&(a.addEventListener(kA,r),a.addEventListener($A,r),e.current=a)}return _.useEffect(function(){return function(){i(e.current)}},[]),[o,i]};var oB=NE()?_.useLayoutEffect:_.useEffect,aB=function(t){return+setTimeout(t,16)},sB=function(t){return clearTimeout(t)};typeof window<"u"&&"requestAnimationFrame"in window&&(aB=function(t){return window.requestAnimationFrame(t)},sB=function(t){return window.cancelAnimationFrame(t)});var UA=0,xE=new Map;function uB(t){xE.delete(t)}var D_=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;UA+=1;var n=UA;function r(i){if(i===0)uB(n),t();else{var o=aB(function(){r(i-1)});xE.set(n,o)}}return r(e),n};D_.cancel=function(t){var e=xE.get(t);return uB(t),sB(e)};const sRe=function(){var t=_.useRef(null);function e(){D_.cancel(t.current)}function n(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=D_(function(){i<=1?r({isCanceled:function(){return o!==t.current}}):n(r,i-1)});t.current=o}return _.useEffect(function(){return function(){e()}},[]),[n,e]};var uRe=[ms,i0,o0,ME],lRe=[ms,Jk],lB=!1,cRe=!0;function cB(t){return t===o0||t===ME}const dRe=function(t,e,n){var r=Q4(xA),i=ki(r,2),o=i[0],a=i[1],s=sRe(),u=ki(s,2),l=u[0],c=u[1];function d(){a(ms,!0)}var m=e?lRe:uRe;return oB(function(){if(o!==xA&&o!==ME){var f=m.indexOf(o),h=m[f+1],p=n(o);p===lB?a(h,!0):h&&l(function(v){function g(){v.isCanceled()||a(h,!0)}p===!0?g():Promise.resolve(p).then(g)})}},[t,o]),_.useEffect(function(){return function(){c()}},[]),[d,o]};function mRe(t,e,n,r){var i=r.motionEnter,o=i===void 0?!0:i,a=r.motionAppear,s=a===void 0?!0:a,u=r.motionLeave,l=u===void 0?!0:u,c=r.motionDeadline,d=r.motionLeaveImmediately,m=r.onAppearPrepare,f=r.onEnterPrepare,h=r.onLeavePrepare,p=r.onAppearStart,v=r.onEnterStart,g=r.onLeaveStart,b=r.onAppearActive,C=r.onEnterActive,S=r.onLeaveActive,E=r.onAppearEnd,y=r.onEnterEnd,D=r.onLeaveEnd,R=r.onVisibleChanged,I=Q4(),T=ki(I,2),P=T[0],N=T[1],B=Q4(Ql),W=ki(B,2),G=W[0],Q=W[1],te=Q4(null),X=ki(te,2),x=X[0],O=X[1],M=_.useRef(!1),V=_.useRef(null);function q(){return n()}var ie=_.useRef(!1);function ce(){Q(Ql,!0),O(null,!0)}function pe(_e){var He=q();if(!(_e&&!_e.deadline&&_e.target!==He)){var et=ie.current,Dt;G===N3&&et?Dt=E==null?void 0:E(He,_e):G===x3&&et?Dt=y==null?void 0:y(He,_e):G===F3&&et&&(Dt=D==null?void 0:D(He,_e)),G!==Ql&&et&&Dt!==!1&&ce()}}var oe=aRe(pe),he=ki(oe,1),fe=he[0],ve=function(_e){var He,et,Dt;switch(_e){case N3:return He={},yi(He,ms,m),yi(He,i0,p),yi(He,o0,b),He;case x3:return et={},yi(et,ms,f),yi(et,i0,v),yi(et,o0,C),et;case F3:return Dt={},yi(Dt,ms,h),yi(Dt,i0,g),yi(Dt,o0,S),Dt;default:return{}}},Ue=_.useMemo(function(){return ve(G)},[G]),ke=dRe(G,!t,function(_e){if(_e===ms){var He=Ue[ms];return He?He(q()):lB}if(rt in Ue){var et;O(((et=Ue[rt])===null||et===void 0?void 0:et.call(Ue,q(),null))||null)}return rt===o0&&(fe(q()),c>0&&(clearTimeout(V.current),V.current=setTimeout(function(){pe({deadline:!0})},c))),rt===Jk&&ce(),cRe}),Te=ki(ke,2),Re=Te[0],rt=Te[1],_t=cB(rt);ie.current=_t,oB(function(){N(e);var _e=M.current;M.current=!0;var He;!_e&&e&&s&&(He=N3),_e&&e&&o&&(He=x3),(_e&&!e&&l||!_e&&d&&!e&&l)&&(He=F3);var et=ve(He);He&&(t||et[ms])?(Q(He),Re()):Q(Ql)},[e]),_.useEffect(function(){(G===N3&&!s||G===x3&&!o||G===F3&&!l)&&Q(Ql)},[s,o,l]),_.useEffect(function(){return function(){M.current=!1,clearTimeout(V.current)}},[]);var mt=_.useRef(!1);_.useEffect(function(){P&&(mt.current=!0),P!==void 0&&G===Ql&&((mt.current||P)&&(R==null||R(P)),mt.current=!0)},[P,G]);var nt=x;return Ue[ms]&&rt===i0&&(nt=vr({transition:"none"},nt)),[G,rt,nt,P??e]}function fRe(t){var e=t;Ps(t)==="object"&&(e=t.transitionSupport);function n(i,o){return!!(i.motionName&&e&&o!==!1)}var r=_.forwardRef(function(i,o){var a=i.visible,s=a===void 0?!0:a,u=i.removeOnLeave,l=u===void 0?!0:u,c=i.forceRender,d=i.children,m=i.motionName,f=i.leavedClassName,h=i.eventProps,p=_.useContext(eRe),v=p.motion,g=n(i,v),b=_.useRef(),C=_.useRef();function S(){try{return b.current instanceof HTMLElement?b.current:GDe(C.current)}catch{return null}}var E=mRe(g,s,S,i),y=ki(E,4),D=y[0],R=y[1],I=y[2],T=y[3],P=_.useRef(T);T&&(P.current=!0);var N=_.useCallback(function(O){b.current=O,QDe(o,O)},[o]),B,W=vr(vr({},h),{},{visible:s});if(!d)B=null;else if(D===Ql)T?B=d(vr({},W),N):!l&&P.current&&f?B=d(vr(vr({},W),{},{className:f}),N):c||!l&&!f?B=d(vr(vr({},W),{},{style:{display:"none"}}),N):B=null;else{var G,Q;R===ms?Q="prepare":cB(R)?Q="active":R===i0&&(Q="start");var te=BA(m,"".concat(D,"-").concat(Q));B=d(vr(vr({},W),{},{className:z6(BA(m,D),(G={},yi(G,te,te&&Q),yi(G,m,typeof m=="string"),G)),style:I}),N)}if(_.isValidElement(B)&&JDe(B)){var X=B,x=X.ref;x||(B=_.cloneElement(B,{ref:N}))}return _.createElement(nRe,{ref:C},B)});return r.displayName="CSSMotion",r}const hRe=fRe(iB);var R_="add",I_="keep",A_="remove",yg="removed";function pRe(t){var e;return t&&Ps(t)==="object"&&"key"in t?e=t:e={key:t},vr(vr({},e),{},{key:String(e.key)})}function T_(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(pRe)}function gRe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],r=0,i=e.length,o=T_(t),a=T_(e);o.forEach(function(l){for(var c=!1,d=r;d<i;d+=1){var m=a[d];if(m.key===l.key){r<d&&(n=n.concat(a.slice(r,d).map(function(f){return vr(vr({},f),{},{status:R_})})),r=d),n.push(vr(vr({},m),{},{status:I_})),r+=1,c=!0;break}}c||n.push(vr(vr({},l),{},{status:A_}))}),r<i&&(n=n.concat(a.slice(r).map(function(l){return vr(vr({},l),{},{status:R_})})));var s={};n.forEach(function(l){var c=l.key;s[c]=(s[c]||0)+1});var u=Object.keys(s).filter(function(l){return s[l]>1});return u.forEach(function(l){n=n.filter(function(c){var d=c.key,m=c.status;return d!==l||m!==A_}),n.forEach(function(c){c.key===l&&(c.status=I_)})}),n}var vRe=["component","children","onVisibleChanged","onAllRemoved"],bRe=["status"],_Re=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function CRe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hRe,n=function(r){Kk(o,r);var i=Qk(o);function o(){var a;qk(this,o);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return a=i.call.apply(i,[this].concat(u)),yi(y_(a),"state",{keyEntities:[]}),yi(y_(a),"removeKey",function(c){var d=a.state.keyEntities,m=d.map(function(f){return f.key!==c?f:vr(vr({},f),{},{status:yg})});return a.setState({keyEntities:m}),m.filter(function(f){var h=f.status;return h!==yg}).length}),a}return Gk(o,[{key:"render",value:function(){var a=this,s=this.state.keyEntities,u=this.props,l=u.component,c=u.children,d=u.onVisibleChanged,m=u.onAllRemoved,f=R9(u,vRe),h=l||_.Fragment,p={};return _Re.forEach(function(v){p[v]=f[v],delete f[v]}),delete f.keys,_.createElement(h,f,s.map(function(v,g){var b=v.status,C=R9(v,bRe),S=b===R_||b===I_;return _.createElement(e,$0({},p,{key:C.key,visible:S,eventProps:C,onVisibleChanged:function(E){if(d==null||d(E,{key:C.key}),!E){var y=a.removeKey(C.key);y===0&&m&&m()}}}),function(E,y){return c(vr(vr({},E),{},{index:g}),y)})}))}}],[{key:"getDerivedStateFromProps",value:function(a,s){var u=a.keys,l=s.keyEntities,c=T_(u),d=gRe(l,c);return{keyEntities:d.filter(function(m){var f=l.find(function(h){var p=h.key;return m.key===p});return!(f&&f.status===yg&&m.status===A_)})}}}]),o}(_.Component);return yi(n,"defaultProps",{component:"div"}),n}const SRe=CRe(iB);var gn={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){var e=t.keyCode;if(t.altKey&&!t.ctrlKey||t.metaKey||e>=gn.F1&&e<=gn.F12)return!1;switch(e){case gn.ALT:case gn.CAPS_LOCK:case gn.CONTEXT_MENU:case gn.CTRL:case gn.DOWN:case gn.END:case gn.ESC:case gn.HOME:case gn.INSERT:case gn.LEFT:case gn.MAC_FF_META:case gn.META:case gn.NUMLOCK:case gn.NUM_CENTER:case gn.PAGE_DOWN:case gn.PAGE_UP:case gn.PAUSE:case gn.PRINT_SCREEN:case gn.RIGHT:case gn.SHIFT:case gn.UP:case gn.WIN_KEY:case gn.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=gn.ZERO&&t<=gn.NINE||t>=gn.NUM_ZERO&&t<=gn.NUM_MULTIPLY||t>=gn.A&&t<=gn.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case gn.SPACE:case gn.QUESTION_MARK:case gn.NUM_PLUS:case gn.NUM_MINUS:case gn.NUM_PERIOD:case gn.NUM_DIVISION:case gn.SEMICOLON:case gn.DASH:case gn.EQUALS:case gn.COMMA:case gn.PERIOD:case gn.SLASH:case gn.APOSTROPHE:case gn.SINGLE_QUOTE:case gn.OPEN_SQUARE_BRACKET:case gn.BACKSLASH:case gn.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},ERe=_.forwardRef(function(t,e){var n=t.prefixCls,r=t.style,i=t.className,o=t.duration,a=o===void 0?4.5:o,s=t.eventKey,u=t.content,l=t.closable,c=t.closeIcon,d=c===void 0?"x":c,m=t.props,f=t.onClick,h=t.onNoticeClose,p=t.times,v=t.hovering,g=_.useState(!1),b=ki(g,2),C=b[0],S=b[1],E=v||C,y=function(){h(s)},D=function(I){(I.key==="Enter"||I.code==="Enter"||I.keyCode===gn.ENTER)&&y()};_.useEffect(function(){if(!E&&a>0){var I=setTimeout(function(){y()},a*1e3);return function(){clearTimeout(I)}}},[a,E,p]);var R="".concat(n,"-notice");return _.createElement("div",$0({},m,{ref:e,className:z6(R,i,yi({},"".concat(R,"-closable"),l)),style:r,onMouseEnter:function(I){var T;S(!0),m==null||(T=m.onMouseEnter)===null||T===void 0||T.call(m,I)},onMouseLeave:function(I){var T;S(!1),m==null||(T=m.onMouseLeave)===null||T===void 0||T.call(m,I)},onClick:f}),_.createElement("div",{className:"".concat(R,"-content")},u),l&&_.createElement("a",{tabIndex:0,className:"".concat(R,"-close"),onKeyDown:D,onClick:function(I){I.preventDefault(),I.stopPropagation(),y()}},d))}),yRe=Se.createContext({}),VA=8,HA=3,jA=16,DRe=function(t){var e={offset:VA,threshold:HA,gap:jA};if(t&&Ps(t)==="object"){var n,r,i;e.offset=(n=t.offset)!==null&&n!==void 0?n:VA,e.threshold=(r=t.threshold)!==null&&r!==void 0?r:HA,e.gap=(i=t.gap)!==null&&i!==void 0?i:jA}return[!!t,e]},RRe=["className","style","classNames","styles"],IRe=function(t){var e,n=t.configList,r=t.placement,i=t.prefixCls,o=t.className,a=t.style,s=t.motion,u=t.onAllNoticeRemoved,l=t.onNoticeClose,c=t.stack,d=_.useContext(yRe),m=d.classNames,f=_.useRef({}),h=_.useState(null),p=ki(h,2),v=p[0],g=p[1],b=_.useState([]),C=ki(b,2),S=C[0],E=C[1],y=n.map(function(Q){return{config:Q,key:String(Q.key)}}),D=DRe(c),R=ki(D,2),I=R[0],T=R[1],P=T.offset,N=T.threshold,B=T.gap,W=I&&(S.length>0||y.length<=N),G=typeof s=="function"?s(r):s;return _.useEffect(function(){I&&S.length>1&&E(function(Q){return Q.filter(function(te){return y.some(function(X){var x=X.key;return te===x})})})},[S,y,I]),_.useEffect(function(){var Q;if(I&&f.current[(Q=y[y.length-1])===null||Q===void 0?void 0:Q.key]){var te;g(f.current[(te=y[y.length-1])===null||te===void 0?void 0:te.key])}},[y,I]),Se.createElement(SRe,$0({key:r,className:z6(i,"".concat(i,"-").concat(r),m==null?void 0:m.list,o,(e={},yi(e,"".concat(i,"-stack"),!!I),yi(e,"".concat(i,"-stack-expanded"),W),e)),style:a,keys:y,motionAppear:!0},G,{onAllRemoved:function(){u(r)}}),function(Q,te){var X=Q.config,x=Q.className,O=Q.style,M=Q.index,V=X,q=V.key,ie=V.times,ce=String(q),pe=X,oe=pe.className,he=pe.style,fe=pe.classNames,ve=pe.styles,Ue=R9(pe,RRe),ke=y.findIndex(function(Bt){return Bt.key===ce}),Te={};if(I){var Re=y.length-1-(ke>-1?ke:M-1),rt=r==="top"||r==="bottom"?"-50%":"0";if(Re>0){var _t,mt,nt;Te.height=W?(_t=f.current[ce])===null||_t===void 0?void 0:_t.offsetHeight:v==null?void 0:v.offsetHeight;for(var _e=0,He=0;He<Re;He++){var et;_e+=((et=f.current[y[y.length-1-He].key])===null||et===void 0?void 0:et.offsetHeight)+B}var Dt=(W?_e:Re*P)*(r.startsWith("top")?1:-1),Mt=!W&&v!==null&&v!==void 0&&v.offsetWidth&&(mt=f.current[ce])!==null&&mt!==void 0&&mt.offsetWidth?((v==null?void 0:v.offsetWidth)-P*2*(Re<3?Re:3))/((nt=f.current[ce])===null||nt===void 0?void 0:nt.offsetWidth):1;Te.transform="translate3d(".concat(rt,", ").concat(Dt,"px, 0) scaleX(").concat(Mt,")")}else Te.transform="translate3d(".concat(rt,", 0, 0)")}return Se.createElement("div",{ref:te,className:z6("".concat(i,"-notice-wrapper"),x,fe==null?void 0:fe.wrapper),style:vr(vr(vr({},O),Te),ve==null?void 0:ve.wrapper),onMouseEnter:function(){return E(function(Bt){return Bt.includes(ce)?Bt:[].concat(j6(Bt),[ce])})},onMouseLeave:function(){return E(function(Bt){return Bt.filter(function(Zt){return Zt!==ce})})}},Se.createElement(ERe,$0({},Ue,{ref:function(Bt){ke>-1?f.current[ce]=Bt:delete f.current[ce]},prefixCls:i,classNames:fe,styles:ve,className:z6(oe,m==null?void 0:m.notice),style:he,times:ie,key:q,eventKey:q,onNoticeClose:l,hovering:I&&S.length>0})))})},ARe=_.forwardRef(function(t,e){var n=t.prefixCls,r=n===void 0?"rc-notification":n,i=t.container,o=t.motion,a=t.maxCount,s=t.className,u=t.style,l=t.onAllRemoved,c=t.stack,d=t.renderNotifications,m=_.useState([]),f=ki(m,2),h=f[0],p=f[1],v=function(R){var I,T=h.find(function(P){return P.key===R});T==null||(I=T.onClose)===null||I===void 0||I.call(T),p(function(P){return P.filter(function(N){return N.key!==R})})};_.useImperativeHandle(e,function(){return{open:function(R){p(function(I){var T=j6(I),P=T.findIndex(function(W){return W.key===R.key}),N=vr({},R);if(P>=0){var B;N.times=(((B=I[P])===null||B===void 0?void 0:B.times)||0)+1,T[P]=N}else N.times=0,T.push(N);return a>0&&T.length>a&&(T=T.slice(-a)),T})},close:function(R){v(R)},destroy:function(){p([])}}});var g=_.useState({}),b=ki(g,2),C=b[0],S=b[1];_.useEffect(function(){var R={};h.forEach(function(I){var T=I.placement,P=T===void 0?"topRight":T;P&&(R[P]=R[P]||[],R[P].push(I))}),Object.keys(C).forEach(function(I){R[I]=R[I]||[]}),S(R)},[h]);var E=function(R){S(function(I){var T=vr({},I),P=T[R]||[];return P.length||delete T[R],T})},y=_.useRef(!1);if(_.useEffect(function(){Object.keys(C).length>0?y.current=!0:y.current&&(l==null||l(),y.current=!1)},[C]),!i)return null;var D=Object.keys(C);return Ac.createPortal(_.createElement(_.Fragment,null,D.map(function(R){var I=C[R],T=_.createElement(IRe,{key:R,configList:I,placement:R,prefixCls:r,className:s==null?void 0:s(R),style:u==null?void 0:u(R),motion:o,onNoticeClose:v,onAllNoticeRemoved:E,stack:c});return d?d(T,{prefixCls:r,key:R}):T})),i)}),TRe=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],wRe=function(){return document.body},zA=0;function LRe(){for(var t={},e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(i){i&&Object.keys(i).forEach(function(o){var a=i[o];a!==void 0&&(t[o]=a)})}),t}function ORe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.getContainer,n=e===void 0?wRe:e,r=t.motion,i=t.prefixCls,o=t.maxCount,a=t.className,s=t.style,u=t.onAllRemoved,l=t.stack,c=t.renderNotifications,d=R9(t,TRe),m=_.useState(),f=ki(m,2),h=f[0],p=f[1],v=_.useRef(),g=_.createElement(ARe,{container:h,ref:v,prefixCls:i,motion:r,maxCount:o,className:a,style:s,onAllRemoved:u,stack:l,renderNotifications:c}),b=_.useState([]),C=ki(b,2),S=C[0],E=C[1],y=_.useMemo(function(){return{open:function(D){var R=LRe(d,D);(R.key===null||R.key===void 0)&&(R.key="rc-notification-".concat(zA),zA+=1),E(function(I){return[].concat(j6(I),[{type:"open",config:R}])})},close:function(D){E(function(R){return[].concat(j6(R),[{type:"close",key:D}])})},destroy:function(){E(function(D){return[].concat(j6(D),[{type:"destroy"}])})}}},[]);return _.useEffect(function(){p(n())}),_.useEffect(function(){v.current&&S.length&&(S.forEach(function(D){switch(D.type){case"open":v.current.open(D.config);break;case"close":v.current.close(D.key);break;case"destroy":v.current.destroy();break}}),E(function(D){return D.filter(function(R){return!S.includes(R)})}))},[S]),[y,g]}const PRe="univer-notification",MRe="univer-notification-notice",NRe="univer-notification-notice-wrapper",xRe="univer-notification-notice-content",FRe="univer-notification-notice-close",$Re="univer-notification-icon",kRe="univer-notification-icon-success",BRe="univer-notification-icon-info",URe="univer-notification-icon-warning",VRe="univer-notification-icon-error",HRe="univer-notification-content-container",jRe="univer-notification-title",zRe="univer-notification-content",WRe="univer-notification-content-ellipsis",YRe="univer-notification-top",XRe="univer-notification-topLeft",qRe="univer-notification-topRight",GRe="univer-notification-bottom",KRe="univer-notification-bottomRight",ZRe="univer-notification-bottomLeft",QRe="univer-notification-fade",JRe="univer-notification-fade-appear-prepare",eIe="univer-notification-fade-appear-start",tIe="univer-notification-fade-appear-active",nIe="univer-notification-fade-appear",rIe="univer-notification-fade-enter",iIe="univer-notification-fade-leave",oIe="univer-notification-fade-enter-active",aIe="univer-notification-fade-in",sIe="univer-notification-fade-leave-active",uIe="univer-notification-fade-out",ps={notification:PRe,notificationNotice:MRe,notificationNoticeWrapper:NRe,notificationNoticeContent:xRe,notificationNoticeClose:FRe,notificationIcon:$Re,notificationIconSuccess:kRe,notificationIconInfo:BRe,notificationIconWarning:URe,notificationIconError:VRe,notificationContentContainer:HRe,notificationTitle:jRe,notificationContent:zRe,notificationContentEllipsis:WRe,notificationTop:YRe,notificationTopLeft:XRe,notificationTopRight:qRe,notificationBottom:GRe,notificationBottomRight:KRe,notificationBottomLeft:ZRe,notificationFade:QRe,notificationFadeAppearPrepare:JRe,notificationFadeAppearStart:eIe,notificationFadeAppearActive:tIe,notificationFadeAppear:nIe,notificationFadeEnter:rIe,notificationFadeLeave:iIe,notificationFadeEnterActive:oIe,notificationFadeIn:aIe,notificationFadeLeaveActive:sIe,notificationFadeOut:uIe},lIe={success:Ae.jsx(yEe,{className:ps.notificationIconSuccess}),info:Ae.jsx(yA,{className:ps.notificationIconInfo}),warning:Ae.jsx(yA,{className:ps.notificationIconWarning}),error:Ae.jsx(ySe,{className:ps.notificationIconError})},dB=new an,cIe=t=>{const{type:e,content:n,title:r,lines:i=0}=t,o=Ci(ps.notificationContent,{[ps.notificationContentEllipsis]:i!==0});return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("span",{className:ps.notificationIcon,children:lIe[e]}),Ae.jsxs("div",{className:ps.notificationContentContainer,children:[Ae.jsx("span",{className:ps.notificationTitle,children:r}),Ae.jsx("span",{className:o,style:{WebkitLineClamp:i},children:n})]})]})};function dIe(){const{mountContainer:t}=_.useContext(su),[e,n]=ORe({prefixCls:ps.notification,maxCount:3,closeIcon:Ae.jsx(ZF,{}),getContainer:()=>t,motion:{motionName:ps.notificationFade,motionAppear:!0,motionEnter:!0,motionLeave:!0}}),r=_.useRef(dB);return _.useEffect(()=>{const i=r.current.subscribe(o=>{var a,s,u;e.open({content:Ae.jsx(cIe,{content:o.content,type:o.type,title:o.title,lines:o.lines}),placement:(a=o.placement)!=null?a:"topRight",duration:(s=o.duration)!=null?s:4.5,closable:(u=o.closable)!=null?u:!0})});return()=>{i.unsubscribe()}},[]),Ae.jsx(Ae.Fragment,{children:n})}const mIe={show:t=>{dB.next(t)}},Ca=ln("univer.confirm-service");function fIe(){const t=Ct(Ca),[e,n]=_.useState([]);_.useEffect(()=>{const i=t.confirmOptions$.subscribe(o=>{n(o)});return()=>{i.unsubscribe()}},[]);const r=e.map(i=>{const{children:o,title:a,...s}=i,u=s;for(const l of["children","title"]){const c=l,d=i[c];d&&(u[c]=Ae.jsx(Ua,{...d}))}return u});return r==null?void 0:r.map((i,o)=>Ae.jsx(nJ,{...i},o))}const yf=ln("univer.context-menu-service");class hIe extends We{constructor(){super(...arguments),Mn(this,"_currentHandler",null),Mn(this,"disabled",!1)}disable(){this.disabled=!0}enable(){this.disabled=!1}triggerContextMenu(e,n){var r;e.stopPropagation(),!this.disabled&&((r=this._currentHandler)==null||r.handleContextMenu(e,n))}registerContextMenuHandler(e){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=e,je(()=>{this._currentHandler=null})}}function pIe(){const[t,e]=_.useState(!1),[n,r]=_.useState(""),[i,o]=_.useState([0,0]),a=Ct(yf),s=Ct(se),u=gf();_.useEffect(()=>{const d=a.registerContextMenuHandler({handleContextMenu:l});return document.addEventListener("pointerdown",c),document.addEventListener("wheel",c),()=>{document.removeEventListener("pointerdown",c),document.removeEventListener("wheel",c),d.dispose()}},[]);function l(d,m){r(m),o([d.clientX,d.clientY]),e(!0)}function c(){e(!1)}return Ae.jsx(uE,{visible:t,offset:i,children:Ae.jsx("section",{onPointerDown:d=>d.stopPropagation(),children:Ae.jsx(E9,{menuType:[n],onOptionSelect:d=>{const{label:m,value:f}=d;s&&s.executeCommand(m,{value:f}),u.get(To).focus(),e(!1)}})})})}const mB=ln("univer.dialog-service");function gIe(){const t=Ct(mB),[e,n]=_.useState([]);_.useEffect(()=>{const i=t.getObservableDialog().subscribe(o=>{n(o)});return()=>{i.unsubscribe()}},[]);const r=e.map(i=>{const{children:o,title:a,closeIcon:s,footer:u,...l}=i,c=l;for(const d of["children","title","closeIcon","footer"]){const m=d,f=i[m];f&&(c[m]=Ae.jsx(Ua,{...f}))}return c});return Ae.jsx(Ae.Fragment,{children:r==null?void 0:r.map(i=>Ae.jsx(EN,{...i},i.id))})}const fB=ln("univer.global-zone-service"),vIe="univer-global-zone",bIe="univer-global-zone-open",_Ie="univer-global-zone-close",WA={globalZone:vIe,globalZoneOpen:bIe,globalZoneClose:_Ie};function CIe(){const t=Ct(fB),[e,n]=_.useState(!1),r=U1(t.componentKey$),i=Ct(Jo),o=Ci(WA.globalZone,WA.globalZoneOpen),a=_.useMemo(()=>{const s=i.get(r??"");if(s)return s},[r]);return _.useEffect(()=>{const s=t.visible$.subscribe(u=>{n(u)});return()=>{s.unsubscribe()}},[t.visible$]),e?Ae.jsx("section",{className:o,children:a&&Ae.jsx(a,{})}):null}const SIe=new Set([()=>gIe,()=>fIe,()=>dIe,()=>pIe,()=>CIe]);function EIe(t){const e=Ct(Gt),n=Ct(_i),r=Ct(Ef),i=_.useRef(null),{mountContainer:o,headerComponents:a,headerMenuComponents:s,contentComponents:u,footerComponents:l,onRendered:c}=t;_.useEffect(()=>{n.getCurrentTheme()||n.setTheme(Ex)},[]),_.useEffect(()=>{i.current&&(c==null||c(i.current))},[c]);const[d,m]=_.useState(e.getLocales()),f=_.useMemo(()=>document.createElement("div"),[]);return _.useEffect(()=>{document.body.appendChild(f),r.setContainer(f);const h=[e.localeChanged$.subscribe(()=>{m(e.getLocales())}),n.currentTheme$.subscribe(p=>{BI.setTheme(o,p),f&&BI.setTheme(f,p)})];return()=>{h.forEach(p=>p.unsubscribe())}},[f]),Ae.jsxs(HK,{locale:d,mountContainer:f,children:[Ae.jsxs("div",{className:Cu.appLayout,children:[t.toolbar&&Ae.jsx("header",{className:Cu.appContainerHeader,children:Ae.jsx(IDe,{headerMenuComponents:s})}),Ae.jsxs("section",{className:Cu.appContainer,children:[Ae.jsxs("div",{className:Cu.appContainerWrapper,children:[Ae.jsxs("section",{className:Cu.appContainerContent,children:[Ae.jsx("header",{children:Ae.jsx(S6,{components:a})}),Ae.jsx("section",{className:Cu.appContainerCanvas,ref:i,"data-range-selector":!0,onContextMenu:h=>h.preventDefault(),children:Ae.jsx(S6,{components:u})})]}),Ae.jsx("aside",{className:Cu.appContainerSidebar,children:Ae.jsx(NDe,{})})]}),t.footer&&Ae.jsx("footer",{className:Cu.appFooter,children:Ae.jsx(S6,{components:l})}),Ae.jsx(kDe,{})]})]}),Ae.jsx(S6,{components:SIe})]})}var yIe=Object.defineProperty,DIe=Object.getOwnPropertyDescriptor,RIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?DIe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&yIe(e,n,i),i},qd=(t,e)=>(n,r)=>e(n,r,t);const IIe=3e3;let w_=class extends We{constructor(e,n,r,i,o){super(),Mn(this,"_headerComponents",new Set),Mn(this,"_headerMenuComponents",new Set),Mn(this,"_contentComponents",new Set),Mn(this,"_footerComponents",new Set),Mn(this,"_componentRegistered$",new an),Mn(this,"componentRegistered$",this._componentRegistered$.asObservable()),this._injector=e,this._lifecycleService=n,this._renderManagerService=r,this._focusService=i,this._layoutService=o}bootstrapWorkbench(e){this.disposeWithMe(AIe(this._injector,e,(n,r)=>{this._initializeEngine(n),this._lifecycleService.stage=ot.Rendered,this._focusService.setContainerElement(r),this._layoutService&&this.disposeWithMe(this._layoutService.registerContainer(r)),setTimeout(()=>this._lifecycleService.stage=ot.Steady,IIe)}))}_initializeEngine(e){this._renderManagerService.getCurrent().engine.setContainer(e)}registerComponent(e,n){switch(e){case"header":return this.registerHeaderComponent(n);case"content":return this.registerContentComponent(n);case"footer":return this.registerFooterComponent(n);case"header-menu":return this.registerHeaderMenuComponent(n);default:throw new Error(`[DesktopUIController] Unknown part type: ${e}.`)}}registerHeaderMenuComponent(e){return this._headerMenuComponents.add(e),this._componentRegistered$.next(),je(()=>this._headerMenuComponents.delete(e))}getHeaderMenuComponents(){return new Set([...this._headerMenuComponents])}registerHeaderComponent(e){return this._headerComponents.add(e),this._componentRegistered$.next(),je(()=>this._headerComponents.delete(e))}getHeaderComponents(){return new Set([...this._headerComponents])}registerContentComponent(e){return this._contentComponents.add(e),this._componentRegistered$.next(),je(()=>this._contentComponents.delete(e))}getContentComponents(){return new Set([...this._contentComponents])}registerFooterComponent(e){return this._footerComponents.add(e),this._componentRegistered$.next(),je(()=>this._footerComponents.delete(e))}getFooterComponents(){return new Set([...this._footerComponents])}};w_=RIe([qd(0,K(wn)),qd(1,K(vs)),qd(2,Jn),qd(3,LE),qd(4,W0(c8))],w_);function AIe(t,e,n){let r;const i=e.container;if(typeof i=="string"){const c=document.getElementById(i);c?r=c:r=YA(i)}else i instanceof HTMLElement?r=i:r=YA("univer");const o=H6(EIe,t),a=t.get(F0),s=c=>n(c,r);function u(){const c=a.getHeaderComponents(),d=a.getContentComponents(),m=a.getFooterComponents(),f=a.getHeaderMenuComponents();Oye(Ae.jsx(o,{...e,mountContainer:r,headerComponents:c,headerMenuComponents:f,contentComponents:d,onRendered:s,footerComponents:m}),r)}const l=a.componentRegistered$.subscribe(u);return u(),je(()=>{Pye(r),l.unsubscribe()})}function YA(t){const e=document.createElement("div");return e.id=t,e}const TIe={uiToolbar:{start:"开始",insert:"插入",formulas:"公式",data:"数据",view:"视图",others:"其他"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftYaHei:"微软雅黑",SimSun:"宋体",SimHei:"黑体",Kaiti:"楷体",FangSong:"仿宋",NSimSun:"新宋体",STXinwei:"华文新魏",STXingkai:"华文行楷",STLiti:"华文隶书",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},"shortcut-panel":{title:"快捷键面板"},shortcut:{undo:"撤销",redo:"重做",cut:"剪切",copy:"复制",paste:"粘贴"},"common-edit":"常用编辑","toggle-shortcut-panel":"打开收起快捷键面板",clipboard:{authentication:{title:"无法访问剪贴板",content:"请允许 Univer 访问您的剪贴板。"}}};var wIe=Object.defineProperty,LIe=Object.getOwnPropertyDescriptor,OIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?LIe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&wIe(e,n,i),i},PIe=(t,e)=>(n,r)=>e(n,r,t);const MIe=ln("univer.ui.before-close-service");let L_=class{constructor(e){Mn(this,"_beforeUnloadCallbacks",[]),Mn(this,"_onCloseCallbacks",[]),this._notificationService=e,this._init()}registerBeforeClose(e){return this._beforeUnloadCallbacks.push(e),{dispose:()=>{this._beforeUnloadCallbacks=this._beforeUnloadCallbacks.filter(n=>n!==e)}}}registerOnClose(e){return this._onCloseCallbacks.push(e),{dispose:()=>{this._onCloseCallbacks=this._onCloseCallbacks.filter(n=>n!==e)}}}_init(){window.addEventListener("beforeunload",e=>{const n=this._beforeUnloadCallbacks.map(r=>r()).filter(r=>!!r).join(`
`);if(n)return this._notificationService.show({type:"error",title:"Some changes are not saved",content:n}),typeof e>"u"&&(e=window.event),e.returnValue=n,n}),window.addEventListener("unload",()=>{this._onCloseCallbacks.forEach(e=>e())})}};L_=OIe([PIe(0,wE)],L_);let NIe=class{constructor(){Mn(this,"_confirmOptions",[]),Mn(this,"confirmOptions$",new an)}open(e){return this._confirmOptions.find(n=>n.id===e.id)?this._confirmOptions=this._confirmOptions.map(n=>({...n.id===e.id?e:n,visible:n.id===e.id?!0:n.visible})):this._confirmOptions.push({...e,visible:!0}),this.confirmOptions$.next(this._confirmOptions),je(()=>{this._confirmOptions=[],this.confirmOptions$.next([])})}confirm(e){return new Promise(n=>{const r=this.open({...e,onConfirm:()=>{r.dispose(),n(!0)},onClose:()=>{r.dispose(),n(!1)}})})}close(e){this._confirmOptions=this._confirmOptions.map(n=>({...n,visible:n.id===e?!1:n.visible})),this.confirmOptions$.next([...this._confirmOptions])}},xIe=class extends We{constructor(){super(...arguments),Mn(this,"_dialogOptions",[]),Mn(this,"_dialogOptions$",new an)}dispose(){super.dispose(),this._dialogOptions$.complete()}open(e){return this._dialogOptions.find(n=>n.id===e.id)?this._dialogOptions=this._dialogOptions.map(n=>({...n.id===e.id?e:n,visible:!0})):this._dialogOptions.push({...e,visible:!0}),this._dialogOptions$.next(this._dialogOptions),je(()=>{this._dialogOptions=[],this._dialogOptions$.next([])})}close(e){this._dialogOptions=this._dialogOptions.map(n=>({...n,visible:n.id===e?!1:n.visible})),this._dialogOptions$.next([...this._dialogOptions])}getObservableDialog(){return this._dialogOptions$}},FIe=class{constructor(){Mn(this,"portalContainer",document.body),Mn(this,"message")}setContainer(e){this.portalContainer=e,this.message=new Vre(e)}show(e){const{type:n,...r}=e;return this.message&&this.message[n](r),je(()=>{})}},$Ie=class{show(e){return mIe.show(e),je(()=>{})}};var kIe=Object.defineProperty,BIe=Object.getOwnPropertyDescriptor,UIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?BIe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&kIe(e,n,i),i},VIe=(t,e)=>(n,r)=>e(n,r,t);let O_=class{constructor(e){Mn(this,"visible$",new an),Mn(this,"componentKey$",new an),this._componentManager=e}set(e,n){return this._componentManager.register(e,n),this.componentKey$.next(e),je(()=>{this._componentManager.delete(e),this.visible$.complete(),this.componentKey$.complete()})}open(){this.visible$.next(!0)}close(){this.visible$.next(!1)}};O_=UIe([VIe(0,K(Jo))],O_);let HIe=class{constructor(){Mn(this,"_sidebarOptions",{}),Mn(this,"sidebarOptions$",new an)}open(e){return this._sidebarOptions={...e,visible:!0},this.sidebarOptions$.next(this._sidebarOptions),je(()=>{this.sidebarOptions$.complete()})}set(e){this._sidebarOptions={...e},this.sidebarOptions$.next(this._sidebarOptions)}close(){this._sidebarOptions={...this._sidebarOptions,visible:!1},this.sidebarOptions$.next(this._sidebarOptions),this._sidebarOptions.onClose&&this._sidebarOptions.onClose()}};var jIe=Object.defineProperty,zIe=Object.getOwnPropertyDescriptor,WIe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zIe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&jIe(e,n,i),i},XA=(t,e)=>(n,r)=>e(n,r,t);let J4=class extends We{constructor(e,n){super(),this._errorService=e,this._messageService=n,this.disposeWithMe(je(this._errorService.error$.subscribe(r=>{this._messageService.show({content:r.errorKey,type:q5.Error})})))}};J4=WIe([yt(ot.Starting,J4),XA(0,K(Z0)),XA(1,Ef)],J4);class hB extends We{constructor(){super(...arguments),Mn(this,"_open$",new dn(!1)),Mn(this,"open$",this._open$.pipe(OC()))}get isOpen(){return this._open$.getValue()}dispose(){this._open$.next(!1),this._open$.complete()}open(){this._open$.next(!0)}close(){this._open$.next(!1)}}const pB="ShortcutPanel",gB={id:"base-ui.operation.toggle-shortcut-panel",type:ue.OPERATION,handler:t=>{const e=t.get(hB),n=t.get(cd);return e.isOpen?(e.close(),n.close()):(e.open(),n.open({header:{title:"shortcut-panel.title"},children:{label:pB}})),!0}},YIe="univer-shortcut-panel-group-title",XIe="univer-shortcut-panel-item",qIe="univer-shortcut-panel-item-title",GIe="univer-shortcut-panel-item-shortcut",C2={shortcutPanelGroupTitle:YIe,shortcutPanelItem:XIe,shortcutPanelItemTitle:qIe,shortcutPanelItemShortcut:GIe};function KIe(){const t=Ct(lu),e=Ct(Gt),[n,r]=Se.useState([]),i=_.useCallback(()=>{var o;const a=new Map,s=t.getAllShortcuts().filter(l=>!!l.group);for(const l of s){const c=l.group,d={title:e.t((o=l.description)!=null?o:l.id),shortcut:t.getShortcutDisplay(l)};if(!/\d+_[a-zA-Z0-9]/.test(c))throw new Error(`[ShortcutPanel]: Invalid shortcut group: ${c}!`);a.has(c)||a.set(c,[]),a.get(c).push(d)}const u=Array.from(a.entries()).map(([l,c])=>{const d=l.split("_")[0],m=l.slice(d.length+1);return{sequence:+d,name:e.t(m),items:c}}).sort((l,c)=>l.sequence-c.sequence);r(u)},[t,e]);return _.useEffect(()=>{i();const o=t.shortcutChanged$.subscribe(()=>i());return()=>o.unsubscribe()},[t]),Ae.jsx("div",{className:C2.shortcutPanel,children:n.map(o=>Ae.jsxs("div",{className:C2.shortcutPanelGroup,children:[Ae.jsx("div",{className:C2.shortcutPanelGroupTitle,children:o.name}),o.items.map((a,s)=>Ae.jsxs("div",{className:C2.shortcutPanelItem,children:[Ae.jsx("span",{className:C2.shortcutPanelItemTitle,children:a.title}),Ae.jsx("span",{className:C2.shortcutPanelItemShortcut,children:a.shortcut})]},s))]},o.name))})}function ZIe(t){return{id:gB.id,title:"toggle-shortcut-panel",tooltip:"toggle-shortcut-panel",icon:"KeyboardSingle",type:pt.BUTTON,positions:[hn.TOOLBAR_START],hidden$:cr(t,or.SHEET)}}var QIe=Object.defineProperty,JIe=Object.getOwnPropertyDescriptor,eAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?JIe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&QIe(e,n,i),i},k3=(t,e)=>(n,r)=>e(n,r,t);let e7=class extends We{constructor(e,n,r,i){super(),this._injector=e,this.disposeWithMe(n.addMenuItem(this._injector.invoke(ZIe))),this.disposeWithMe(i.register(pB,KIe)),this.disposeWithMe(r.registerCommand(gB))}};e7=eAe([yt(ot.Steady,e7),k3(0,K(wn)),k3(1,S1),k3(2,se),k3(3,K(Jo))],e7);function B3(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vB={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function a(l,c){if(!i[l]){if(!r[l]){var d=typeof B3=="function"&&B3;if(!c&&d)return d(l,!0);if(s)return s(l,!0);var m=new Error("Cannot find module '"+l+"'");throw m.code="MODULE_NOT_FOUND",m}var f=i[l]={exports:{}};r[l][0].call(f.exports,function(h){var p=r[l][1][h];return a(p||h)},f,f.exports,n,r,i,o)}return i[l].exports}for(var s=typeof B3=="function"&&B3,u=0;u<o.length;u++)a(o[u]);return a}({1:[function(n,r,i){(function(o){var a=o.MutationObserver||o.WebKitMutationObserver,s;if(a){var u=0,l=new a(h),c=o.document.createTextNode("");l.observe(c,{characterData:!0}),s=function(){c.data=u=++u%2}}else if(!o.setImmediate&&typeof o.MessageChannel<"u"){var d=new o.MessageChannel;d.port1.onmessage=h,s=function(){d.port2.postMessage(0)}}else"document"in o&&"onreadystatechange"in o.document.createElement("script")?s=function(){var v=o.document.createElement("script");v.onreadystatechange=function(){h(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},o.document.documentElement.appendChild(v)}:s=function(){setTimeout(h,0)};var m,f=[];function h(){m=!0;for(var v,g,b=f.length;b;){for(g=f,f=[],v=-1;++v<b;)g[v]();b=f.length}m=!1}r.exports=p;function p(v){f.push(v)===1&&!m&&s()}}).call(this,typeof P3<"u"?P3:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,i){var o=n(1);function a(){}var s={},u=["REJECTED"],l=["FULFILLED"],c=["PENDING"];r.exports=d;function d(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,E!==a&&p(this,E)}d.prototype.catch=function(E){return this.then(null,E)},d.prototype.then=function(E,y){if(typeof E!="function"&&this.state===l||typeof y!="function"&&this.state===u)return this;var D=new this.constructor(a);if(this.state!==c){var R=this.state===l?E:y;f(D,R,this.outcome)}else this.queue.push(new m(D,E,y));return D};function m(E,y,D){this.promise=E,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}m.prototype.callFulfilled=function(E){s.resolve(this.promise,E)},m.prototype.otherCallFulfilled=function(E){f(this.promise,this.onFulfilled,E)},m.prototype.callRejected=function(E){s.reject(this.promise,E)},m.prototype.otherCallRejected=function(E){f(this.promise,this.onRejected,E)};function f(E,y,D){o(function(){var R;try{R=y(D)}catch(I){return s.reject(E,I)}R===E?s.reject(E,new TypeError("Cannot resolve promise with itself")):s.resolve(E,R)})}s.resolve=function(E,y){var D=v(h,y);if(D.status==="error")return s.reject(E,D.value);var R=D.value;if(R)p(E,R);else{E.state=l,E.outcome=y;for(var I=-1,T=E.queue.length;++I<T;)E.queue[I].callFulfilled(y)}return E},s.reject=function(E,y){E.state=u,E.outcome=y;for(var D=-1,R=E.queue.length;++D<R;)E.queue[D].callRejected(y);return E};function h(E){var y=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof y=="function")return function(){y.apply(E,arguments)}}function p(E,y){var D=!1;function R(N){D||(D=!0,s.reject(E,N))}function I(N){D||(D=!0,s.resolve(E,N))}function T(){y(I,R)}var P=v(T);P.status==="error"&&R(P.value)}function v(E,y){var D={};try{D.value=E(y),D.status="success"}catch(R){D.status="error",D.value=R}return D}d.resolve=g;function g(E){return E instanceof this?E:s.resolve(new this(a),E)}d.reject=b;function b(E){var y=new this(a);return s.reject(y,E)}d.all=C;function C(E){var y=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=E.length,R=!1;if(!D)return this.resolve([]);for(var I=new Array(D),T=0,P=-1,N=new this(a);++P<D;)B(E[P],P);return N;function B(W,G){y.resolve(W).then(Q,function(te){R||(R=!0,s.reject(N,te))});function Q(te){I[G]=te,++T===D&&!R&&(R=!0,s.resolve(N,I))}}}d.race=S;function S(E){var y=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=E.length,R=!1;if(!D)return this.resolve([]);for(var I=-1,T=new this(a);++I<D;)P(E[I]);return T;function P(N){y.resolve(N).then(function(B){R||(R=!0,s.resolve(T,B))},function(B){R||(R=!0,s.reject(T,B))})}}},{1:1}],3:[function(n,r,i){(function(o){typeof o.Promise!="function"&&(o.Promise=n(2))}).call(this,typeof P3<"u"?P3:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,i){var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $};function a($,J){if(!($ instanceof J))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var u=s();function l(){try{if(!u||!u.open)return!1;var $=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),J=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!$||J)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function c($,J){$=$||[],J=J||{};try{return new Blob($,J)}catch(re){if(re.name!=="TypeError")throw re;for(var Z=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,le=new Z,de=0;de<$.length;de+=1)le.append($[de]);return le.getBlob(J.type)}}typeof Promise>"u"&&n(3);var d=Promise;function m($,J){J&&$.then(function(Z){J(null,Z)},function(Z){J(Z)})}function f($,J,Z){typeof J=="function"&&$.then(J),typeof Z=="function"&&$.catch(Z)}function h($){return typeof $!="string"&&(console.warn($+" used as a key, but it is not a string."),$=String($)),$}function p(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var v="local-forage-detect-blob-support",g=void 0,b={},C=Object.prototype.toString,S="readonly",E="readwrite";function y($){for(var J=$.length,Z=new ArrayBuffer(J),le=new Uint8Array(Z),de=0;de<J;de++)le[de]=$.charCodeAt(de);return Z}function D($){return new d(function(J){var Z=$.transaction(v,E),le=c([""]);Z.objectStore(v).put(le,"key"),Z.onabort=function(de){de.preventDefault(),de.stopPropagation(),J(!1)},Z.oncomplete=function(){var de=navigator.userAgent.match(/Chrome\/(\d+)/),re=navigator.userAgent.match(/Edge\//);J(re||!de||parseInt(de[1],10)>=43)}}).catch(function(){return!1})}function R($){return typeof g=="boolean"?d.resolve(g):D($).then(function(J){return g=J,g})}function I($){var J=b[$.name],Z={};Z.promise=new d(function(le,de){Z.resolve=le,Z.reject=de}),J.deferredOperations.push(Z),J.dbReady?J.dbReady=J.dbReady.then(function(){return Z.promise}):J.dbReady=Z.promise}function T($){var J=b[$.name],Z=J.deferredOperations.pop();if(Z)return Z.resolve(),Z.promise}function P($,J){var Z=b[$.name],le=Z.deferredOperations.pop();if(le)return le.reject(J),le.promise}function N($,J){return new d(function(Z,le){if(b[$.name]=b[$.name]||V(),$.db)if(J)I($),$.db.close();else return Z($.db);var de=[$.name];J&&de.push($.version);var re=u.open.apply(u,de);J&&(re.onupgradeneeded=function(Ee){var ze=re.result;try{ze.createObjectStore($.storeName),Ee.oldVersion<=1&&ze.createObjectStore(v)}catch(qe){if(qe.name==="ConstraintError")console.warn('The database "'+$.name+'" has been upgraded from version '+Ee.oldVersion+" to version "+Ee.newVersion+', but the storage "'+$.storeName+'" already exists.');else throw qe}}),re.onerror=function(Ee){Ee.preventDefault(),le(re.error)},re.onsuccess=function(){var Ee=re.result;Ee.onversionchange=function(ze){ze.target.close()},Z(Ee),T($)}})}function B($){return N($,!1)}function W($){return N($,!0)}function G($,J){if(!$.db)return!0;var Z=!$.db.objectStoreNames.contains($.storeName),le=$.version<$.db.version,de=$.version>$.db.version;if(le&&($.version!==J&&console.warn('The database "'+$.name+`" can't be downgraded from version `+$.db.version+" to version "+$.version+"."),$.version=$.db.version),de||Z){if(Z){var re=$.db.version+1;re>$.version&&($.version=re)}return!0}return!1}function Q($){return new d(function(J,Z){var le=new FileReader;le.onerror=Z,le.onloadend=function(de){var re=btoa(de.target.result||"");J({__local_forage_encoded_blob:!0,data:re,type:$.type})},le.readAsBinaryString($)})}function te($){var J=y(atob($.data));return c([J],{type:$.type})}function X($){return $&&$.__local_forage_encoded_blob}function x($){var J=this,Z=J._initReady().then(function(){var le=b[J._dbInfo.name];if(le&&le.dbReady)return le.dbReady});return f(Z,$,$),Z}function O($){I($);for(var J=b[$.name],Z=J.forages,le=0;le<Z.length;le++){var de=Z[le];de._dbInfo.db&&(de._dbInfo.db.close(),de._dbInfo.db=null)}return $.db=null,B($).then(function(re){return $.db=re,G($)?W($):re}).then(function(re){$.db=J.db=re;for(var Ee=0;Ee<Z.length;Ee++)Z[Ee]._dbInfo.db=re}).catch(function(re){throw P($,re),re})}function M($,J,Z,le){le===void 0&&(le=1);try{var de=$.db.transaction($.storeName,J);Z(null,de)}catch(re){if(le>0&&(!$.db||re.name==="InvalidStateError"||re.name==="NotFoundError"))return d.resolve().then(function(){if(!$.db||re.name==="NotFoundError"&&!$.db.objectStoreNames.contains($.storeName)&&$.version<=$.db.version)return $.db&&($.version=$.db.version+1),W($)}).then(function(){return O($).then(function(){M($,J,Z,le-1)})}).catch(Z);Z(re)}}function V(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function q($){var J=this,Z={db:null};if($)for(var le in $)Z[le]=$[le];var de=b[Z.name];de||(de=V(),b[Z.name]=de),de.forages.push(J),J._initReady||(J._initReady=J.ready,J.ready=x);var re=[];function Ee(){return d.resolve()}for(var ze=0;ze<de.forages.length;ze++){var qe=de.forages[ze];qe!==J&&re.push(qe._initReady().catch(Ee))}var tt=de.forages.slice(0);return d.all(re).then(function(){return Z.db=de.db,B(Z)}).then(function(it){return Z.db=it,G(Z,J._defaultConfig.version)?W(Z):it}).then(function(it){Z.db=de.db=it,J._dbInfo=Z;for(var Pt=0;Pt<tt.length;Pt++){var sn=tt[Pt];sn!==J&&(sn._dbInfo.db=Z.db,sn._dbInfo.version=Z.version)}})}function ie($,J){var Z=this;$=h($);var le=new d(function(de,re){Z.ready().then(function(){M(Z._dbInfo,S,function(Ee,ze){if(Ee)return re(Ee);try{var qe=ze.objectStore(Z._dbInfo.storeName),tt=qe.get($);tt.onsuccess=function(){var it=tt.result;it===void 0&&(it=null),X(it)&&(it=te(it)),de(it)},tt.onerror=function(){re(tt.error)}}catch(it){re(it)}})}).catch(re)});return m(le,J),le}function ce($,J){var Z=this,le=new d(function(de,re){Z.ready().then(function(){M(Z._dbInfo,S,function(Ee,ze){if(Ee)return re(Ee);try{var qe=ze.objectStore(Z._dbInfo.storeName),tt=qe.openCursor(),it=1;tt.onsuccess=function(){var Pt=tt.result;if(Pt){var sn=Pt.value;X(sn)&&(sn=te(sn));var On=$(sn,Pt.key,it++);On!==void 0?de(On):Pt.continue()}else de()},tt.onerror=function(){re(tt.error)}}catch(Pt){re(Pt)}})}).catch(re)});return m(le,J),le}function pe($,J,Z){var le=this;$=h($);var de=new d(function(re,Ee){var ze;le.ready().then(function(){return ze=le._dbInfo,C.call(J)==="[object Blob]"?R(ze.db).then(function(qe){return qe?J:Q(J)}):J}).then(function(qe){M(le._dbInfo,E,function(tt,it){if(tt)return Ee(tt);try{var Pt=it.objectStore(le._dbInfo.storeName);qe===null&&(qe=void 0);var sn=Pt.put(qe,$);it.oncomplete=function(){qe===void 0&&(qe=null),re(qe)},it.onabort=it.onerror=function(){var On=sn.error?sn.error:sn.transaction.error;Ee(On)}}catch(On){Ee(On)}})}).catch(Ee)});return m(de,Z),de}function oe($,J){var Z=this;$=h($);var le=new d(function(de,re){Z.ready().then(function(){M(Z._dbInfo,E,function(Ee,ze){if(Ee)return re(Ee);try{var qe=ze.objectStore(Z._dbInfo.storeName),tt=qe.delete($);ze.oncomplete=function(){de()},ze.onerror=function(){re(tt.error)},ze.onabort=function(){var it=tt.error?tt.error:tt.transaction.error;re(it)}}catch(it){re(it)}})}).catch(re)});return m(le,J),le}function he($){var J=this,Z=new d(function(le,de){J.ready().then(function(){M(J._dbInfo,E,function(re,Ee){if(re)return de(re);try{var ze=Ee.objectStore(J._dbInfo.storeName),qe=ze.clear();Ee.oncomplete=function(){le()},Ee.onabort=Ee.onerror=function(){var tt=qe.error?qe.error:qe.transaction.error;de(tt)}}catch(tt){de(tt)}})}).catch(de)});return m(Z,$),Z}function fe($){var J=this,Z=new d(function(le,de){J.ready().then(function(){M(J._dbInfo,S,function(re,Ee){if(re)return de(re);try{var ze=Ee.objectStore(J._dbInfo.storeName),qe=ze.count();qe.onsuccess=function(){le(qe.result)},qe.onerror=function(){de(qe.error)}}catch(tt){de(tt)}})}).catch(de)});return m(Z,$),Z}function ve($,J){var Z=this,le=new d(function(de,re){if($<0){de(null);return}Z.ready().then(function(){M(Z._dbInfo,S,function(Ee,ze){if(Ee)return re(Ee);try{var qe=ze.objectStore(Z._dbInfo.storeName),tt=!1,it=qe.openKeyCursor();it.onsuccess=function(){var Pt=it.result;if(!Pt){de(null);return}$===0||tt?de(Pt.key):(tt=!0,Pt.advance($))},it.onerror=function(){re(it.error)}}catch(Pt){re(Pt)}})}).catch(re)});return m(le,J),le}function Ue($){var J=this,Z=new d(function(le,de){J.ready().then(function(){M(J._dbInfo,S,function(re,Ee){if(re)return de(re);try{var ze=Ee.objectStore(J._dbInfo.storeName),qe=ze.openKeyCursor(),tt=[];qe.onsuccess=function(){var it=qe.result;if(!it){le(tt);return}tt.push(it.key),it.continue()},qe.onerror=function(){de(qe.error)}}catch(it){de(it)}})}).catch(de)});return m(Z,$),Z}function ke($,J){J=p.apply(this,arguments);var Z=this.config();$=typeof $!="function"&&$||{},$.name||($.name=$.name||Z.name,$.storeName=$.storeName||Z.storeName);var le=this,de;if(!$.name)de=d.reject("Invalid arguments");else{var re=$.name===Z.name&&le._dbInfo.db,Ee=re?d.resolve(le._dbInfo.db):B($).then(function(ze){var qe=b[$.name],tt=qe.forages;qe.db=ze;for(var it=0;it<tt.length;it++)tt[it]._dbInfo.db=ze;return ze});$.storeName?de=Ee.then(function(ze){if(ze.objectStoreNames.contains($.storeName)){var qe=ze.version+1;I($);var tt=b[$.name],it=tt.forages;ze.close();for(var Pt=0;Pt<it.length;Pt++){var sn=it[Pt];sn._dbInfo.db=null,sn._dbInfo.version=qe}var On=new d(function(Dn,gr){var Xn=u.open($.name,qe);Xn.onerror=function(Oi){var Wi=Xn.result;Wi.close(),gr(Oi)},Xn.onupgradeneeded=function(){var Oi=Xn.result;Oi.deleteObjectStore($.storeName)},Xn.onsuccess=function(){var Oi=Xn.result;Oi.close(),Dn(Oi)}});return On.then(function(Dn){tt.db=Dn;for(var gr=0;gr<it.length;gr++){var Xn=it[gr];Xn._dbInfo.db=Dn,T(Xn._dbInfo)}}).catch(function(Dn){throw(P($,Dn)||d.resolve()).catch(function(){}),Dn})}}):de=Ee.then(function(ze){I($);var qe=b[$.name],tt=qe.forages;ze.close();for(var it=0;it<tt.length;it++){var Pt=tt[it];Pt._dbInfo.db=null}var sn=new d(function(On,Dn){var gr=u.deleteDatabase($.name);gr.onerror=function(){var Xn=gr.result;Xn&&Xn.close(),Dn(gr.error)},gr.onblocked=function(){console.warn('dropInstance blocked for database "'+$.name+'" until all open connections are closed')},gr.onsuccess=function(){var Xn=gr.result;Xn&&Xn.close(),On(Xn)}});return sn.then(function(On){qe.db=On;for(var Dn=0;Dn<tt.length;Dn++){var gr=tt[Dn];T(gr._dbInfo)}}).catch(function(On){throw(P($,On)||d.resolve()).catch(function(){}),On})})}return m(de,J),de}var Te={_driver:"asyncStorage",_initStorage:q,_support:l(),iterate:ce,getItem:ie,setItem:pe,removeItem:oe,clear:he,length:fe,key:ve,keys:Ue,dropInstance:ke};function Re(){return typeof openDatabase=="function"}var rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_t="~~local_forage_type~",mt=/^~~local_forage_type~([^~]+)~/,nt="__lfsc__:",_e=nt.length,He="arbf",et="blob",Dt="si08",Mt="ui08",Bt="uic8",Zt="si16",It="si32",pn="ur16",yn="ui32",$t="fl32",Ht="fl64",Nt=_e+He.length,Ot=Object.prototype.toString;function En($){var J=$.length*.75,Z=$.length,le,de=0,re,Ee,ze,qe;$[$.length-1]==="="&&(J--,$[$.length-2]==="="&&J--);var tt=new ArrayBuffer(J),it=new Uint8Array(tt);for(le=0;le<Z;le+=4)re=rt.indexOf($[le]),Ee=rt.indexOf($[le+1]),ze=rt.indexOf($[le+2]),qe=rt.indexOf($[le+3]),it[de++]=re<<2|Ee>>4,it[de++]=(Ee&15)<<4|ze>>2,it[de++]=(ze&3)<<6|qe&63;return tt}function Y($){var J=new Uint8Array($),Z="",le;for(le=0;le<J.length;le+=3)Z+=rt[J[le]>>2],Z+=rt[(J[le]&3)<<4|J[le+1]>>4],Z+=rt[(J[le+1]&15)<<2|J[le+2]>>6],Z+=rt[J[le+2]&63];return J.length%3===2?Z=Z.substring(0,Z.length-1)+"=":J.length%3===1&&(Z=Z.substring(0,Z.length-2)+"=="),Z}function z($,J){var Z="";if($&&(Z=Ot.call($)),$&&(Z==="[object ArrayBuffer]"||$.buffer&&Ot.call($.buffer)==="[object ArrayBuffer]")){var le,de=nt;$ instanceof ArrayBuffer?(le=$,de+=He):(le=$.buffer,Z==="[object Int8Array]"?de+=Dt:Z==="[object Uint8Array]"?de+=Mt:Z==="[object Uint8ClampedArray]"?de+=Bt:Z==="[object Int16Array]"?de+=Zt:Z==="[object Uint16Array]"?de+=pn:Z==="[object Int32Array]"?de+=It:Z==="[object Uint32Array]"?de+=yn:Z==="[object Float32Array]"?de+=$t:Z==="[object Float64Array]"?de+=Ht:J(new Error("Failed to get type for BinaryArray"))),J(de+Y(le))}else if(Z==="[object Blob]"){var re=new FileReader;re.onload=function(){var Ee=_t+$.type+"~"+Y(this.result);J(nt+et+Ee)},re.readAsArrayBuffer($)}else try{J(JSON.stringify($))}catch(Ee){console.error("Couldn't convert value into a JSON string: ",$),J(null,Ee)}}function ne($){if($.substring(0,_e)!==nt)return JSON.parse($);var J=$.substring(Nt),Z=$.substring(_e,Nt),le;if(Z===et&&mt.test(J)){var de=J.match(mt);le=de[1],J=J.substring(de[0].length)}var re=En(J);switch(Z){case He:return re;case et:return c([re],{type:le});case Dt:return new Int8Array(re);case Mt:return new Uint8Array(re);case Bt:return new Uint8ClampedArray(re);case Zt:return new Int16Array(re);case pn:return new Uint16Array(re);case It:return new Int32Array(re);case yn:return new Uint32Array(re);case $t:return new Float32Array(re);case Ht:return new Float64Array(re);default:throw new Error("Unkown type: "+Z)}}var Ce={serialize:z,deserialize:ne,stringToBuffer:En,bufferToString:Y};function Ve($,J,Z,le){$.executeSql("CREATE TABLE IF NOT EXISTS "+J.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],Z,le)}function Ke($){var J=this,Z={db:null};if($)for(var le in $)Z[le]=typeof $[le]!="string"?$[le].toString():$[le];var de=new d(function(re,Ee){try{Z.db=openDatabase(Z.name,String(Z.version),Z.description,Z.size)}catch(ze){return Ee(ze)}Z.db.transaction(function(ze){Ve(ze,Z,function(){J._dbInfo=Z,re()},function(qe,tt){Ee(tt)})},Ee)});return Z.serializer=Ce,de}function Pe($,J,Z,le,de,re){$.executeSql(Z,le,de,function(Ee,ze){ze.code===ze.SYNTAX_ERR?Ee.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[J.storeName],function(qe,tt){tt.rows.length?re(qe,ze):Ve(qe,J,function(){qe.executeSql(Z,le,de,re)},re)},re):re(Ee,ze)},re)}function Be($,J){var Z=this;$=h($);var le=new d(function(de,re){Z.ready().then(function(){var Ee=Z._dbInfo;Ee.db.transaction(function(ze){Pe(ze,Ee,"SELECT * FROM "+Ee.storeName+" WHERE key = ? LIMIT 1",[$],function(qe,tt){var it=tt.rows.length?tt.rows.item(0).value:null;it&&(it=Ee.serializer.deserialize(it)),de(it)},function(qe,tt){re(tt)})})}).catch(re)});return m(le,J),le}function me($,J){var Z=this,le=new d(function(de,re){Z.ready().then(function(){var Ee=Z._dbInfo;Ee.db.transaction(function(ze){Pe(ze,Ee,"SELECT * FROM "+Ee.storeName,[],function(qe,tt){for(var it=tt.rows,Pt=it.length,sn=0;sn<Pt;sn++){var On=it.item(sn),Dn=On.value;if(Dn&&(Dn=Ee.serializer.deserialize(Dn)),Dn=$(Dn,On.key,sn+1),Dn!==void 0){de(Dn);return}}de()},function(qe,tt){re(tt)})})}).catch(re)});return m(le,J),le}function De($,J,Z,le){var de=this;$=h($);var re=new d(function(Ee,ze){de.ready().then(function(){J===void 0&&(J=null);var qe=J,tt=de._dbInfo;tt.serializer.serialize(J,function(it,Pt){Pt?ze(Pt):tt.db.transaction(function(sn){Pe(sn,tt,"INSERT OR REPLACE INTO "+tt.storeName+" (key, value) VALUES (?, ?)",[$,it],function(){Ee(qe)},function(On,Dn){ze(Dn)})},function(sn){if(sn.code===sn.QUOTA_ERR){if(le>0){Ee(De.apply(de,[$,qe,Z,le-1]));return}ze(sn)}})})}).catch(ze)});return m(re,Z),re}function Ne($,J,Z){return De.apply(this,[$,J,Z,1])}function be($,J){var Z=this;$=h($);var le=new d(function(de,re){Z.ready().then(function(){var Ee=Z._dbInfo;Ee.db.transaction(function(ze){Pe(ze,Ee,"DELETE FROM "+Ee.storeName+" WHERE key = ?",[$],function(){de()},function(qe,tt){re(tt)})})}).catch(re)});return m(le,J),le}function ft($){var J=this,Z=new d(function(le,de){J.ready().then(function(){var re=J._dbInfo;re.db.transaction(function(Ee){Pe(Ee,re,"DELETE FROM "+re.storeName,[],function(){le()},function(ze,qe){de(qe)})})}).catch(de)});return m(Z,$),Z}function Ze($){var J=this,Z=new d(function(le,de){J.ready().then(function(){var re=J._dbInfo;re.db.transaction(function(Ee){Pe(Ee,re,"SELECT COUNT(key) as c FROM "+re.storeName,[],function(ze,qe){var tt=qe.rows.item(0).c;le(tt)},function(ze,qe){de(qe)})})}).catch(de)});return m(Z,$),Z}function st($,J){var Z=this,le=new d(function(de,re){Z.ready().then(function(){var Ee=Z._dbInfo;Ee.db.transaction(function(ze){Pe(ze,Ee,"SELECT key FROM "+Ee.storeName+" WHERE id = ? LIMIT 1",[$+1],function(qe,tt){var it=tt.rows.length?tt.rows.item(0).key:null;de(it)},function(qe,tt){re(tt)})})}).catch(re)});return m(le,J),le}function Me($){var J=this,Z=new d(function(le,de){J.ready().then(function(){var re=J._dbInfo;re.db.transaction(function(Ee){Pe(Ee,re,"SELECT key FROM "+re.storeName,[],function(ze,qe){for(var tt=[],it=0;it<qe.rows.length;it++)tt.push(qe.rows.item(it).key);le(tt)},function(ze,qe){de(qe)})})}).catch(de)});return m(Z,$),Z}function Le($){return new d(function(J,Z){$.transaction(function(le){le.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(de,re){for(var Ee=[],ze=0;ze<re.rows.length;ze++)Ee.push(re.rows.item(ze).name);J({db:$,storeNames:Ee})},function(de,re){Z(re)})},function(le){Z(le)})})}function Je($,J){J=p.apply(this,arguments);var Z=this.config();$=typeof $!="function"&&$||{},$.name||($.name=$.name||Z.name,$.storeName=$.storeName||Z.storeName);var le=this,de;return $.name?de=new d(function(re){var Ee;$.name===Z.name?Ee=le._dbInfo.db:Ee=openDatabase($.name,"","",0),$.storeName?re({db:Ee,storeNames:[$.storeName]}):re(Le(Ee))}).then(function(re){return new d(function(Ee,ze){re.db.transaction(function(qe){function tt(On){return new d(function(Dn,gr){qe.executeSql("DROP TABLE IF EXISTS "+On,[],function(){Dn()},function(Xn,Oi){gr(Oi)})})}for(var it=[],Pt=0,sn=re.storeNames.length;Pt<sn;Pt++)it.push(tt(re.storeNames[Pt]));d.all(it).then(function(){Ee()}).catch(function(On){ze(On)})},function(qe){ze(qe)})})}):de=d.reject("Invalid arguments"),m(de,J),de}var Xe={_driver:"webSQLStorage",_initStorage:Ke,_support:Re(),iterate:me,getItem:Be,setItem:Ne,removeItem:be,clear:ft,length:Ze,key:st,keys:Me,dropInstance:Je};function Et(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function wt($,J){var Z=$.name+"/";return $.storeName!==J.storeName&&(Z+=$.storeName+"/"),Z}function Cn(){var $="_localforage_support_test";try{return localStorage.setItem($,!0),localStorage.removeItem($),!1}catch{return!0}}function jn(){return!Cn()||localStorage.length>0}function nr($){var J=this,Z={};if($)for(var le in $)Z[le]=$[le];return Z.keyPrefix=wt($,J._defaultConfig),jn()?(J._dbInfo=Z,Z.serializer=Ce,d.resolve()):d.reject()}function St($){var J=this,Z=J.ready().then(function(){for(var le=J._dbInfo.keyPrefix,de=localStorage.length-1;de>=0;de--){var re=localStorage.key(de);re.indexOf(le)===0&&localStorage.removeItem(re)}});return m(Z,$),Z}function Ln($,J){var Z=this;$=h($);var le=Z.ready().then(function(){var de=Z._dbInfo,re=localStorage.getItem(de.keyPrefix+$);return re&&(re=de.serializer.deserialize(re)),re});return m(le,J),le}function Yn($,J){var Z=this,le=Z.ready().then(function(){for(var de=Z._dbInfo,re=de.keyPrefix,Ee=re.length,ze=localStorage.length,qe=1,tt=0;tt<ze;tt++){var it=localStorage.key(tt);if(it.indexOf(re)===0){var Pt=localStorage.getItem(it);if(Pt&&(Pt=de.serializer.deserialize(Pt)),Pt=$(Pt,it.substring(Ee),qe++),Pt!==void 0)return Pt}}});return m(le,J),le}function tn($,J){var Z=this,le=Z.ready().then(function(){var de=Z._dbInfo,re;try{re=localStorage.key($)}catch{re=null}return re&&(re=re.substring(de.keyPrefix.length)),re});return m(le,J),le}function at($){var J=this,Z=J.ready().then(function(){for(var le=J._dbInfo,de=localStorage.length,re=[],Ee=0;Ee<de;Ee++){var ze=localStorage.key(Ee);ze.indexOf(le.keyPrefix)===0&&re.push(ze.substring(le.keyPrefix.length))}return re});return m(Z,$),Z}function xe($){var J=this,Z=J.keys().then(function(le){return le.length});return m(Z,$),Z}function An($,J){var Z=this;$=h($);var le=Z.ready().then(function(){var de=Z._dbInfo;localStorage.removeItem(de.keyPrefix+$)});return m(le,J),le}function vn($,J,Z){var le=this;$=h($);var de=le.ready().then(function(){J===void 0&&(J=null);var re=J;return new d(function(Ee,ze){var qe=le._dbInfo;qe.serializer.serialize(J,function(tt,it){if(it)ze(it);else try{localStorage.setItem(qe.keyPrefix+$,tt),Ee(re)}catch(Pt){(Pt.name==="QuotaExceededError"||Pt.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ze(Pt),ze(Pt)}})})});return m(de,Z),de}function Rr($,J){if(J=p.apply(this,arguments),$=typeof $!="function"&&$||{},!$.name){var Z=this.config();$.name=$.name||Z.name,$.storeName=$.storeName||Z.storeName}var le=this,de;return $.name?de=new d(function(re){$.storeName?re(wt($,le._defaultConfig)):re($.name+"/")}).then(function(re){for(var Ee=localStorage.length-1;Ee>=0;Ee--){var ze=localStorage.key(Ee);ze.indexOf(re)===0&&localStorage.removeItem(ze)}}):de=d.reject("Invalid arguments"),m(de,J),de}var Nr={_driver:"localStorageWrapper",_initStorage:nr,_support:Et(),iterate:Yn,getItem:Ln,setItem:vn,removeItem:An,clear:St,length:xe,key:tn,keys:at,dropInstance:Rr},wi=function($,J){return $===J||typeof $=="number"&&typeof J=="number"&&isNaN($)&&isNaN(J)},di=function($,J){for(var Z=$.length,le=0;le<Z;){if(wi($[le],J))return!0;le++}return!1},uo=Array.isArray||function($){return Object.prototype.toString.call($)==="[object Array]"},Li={},Ei={},lo={INDEXEDDB:Te,WEBSQL:Xe,LOCALSTORAGE:Nr},Vs=[lo.INDEXEDDB._driver,lo.WEBSQL._driver,lo.LOCALSTORAGE._driver],oi=["dropInstance"],ya=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(oi),ea={description:"",driver:Vs.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ji($,J){$[J]=function(){var Z=arguments;return $.ready().then(function(){return $[J].apply($,Z)})}}function zi(){for(var $=1;$<arguments.length;$++){var J=arguments[$];if(J)for(var Z in J)J.hasOwnProperty(Z)&&(uo(J[Z])?arguments[0][Z]=J[Z].slice():arguments[0][Z]=J[Z])}return arguments[0]}var ta=function(){function $(J){a(this,$);for(var Z in lo)if(lo.hasOwnProperty(Z)){var le=lo[Z],de=le._driver;this[Z]=de,Li[de]||this.defineDriver(le)}this._defaultConfig=zi({},ea),this._config=zi({},this._defaultConfig,J),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return $.prototype.config=function(J){if((typeof J>"u"?"undefined":o(J))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Z in J){if(Z==="storeName"&&(J[Z]=J[Z].replace(/\W/g,"_")),Z==="version"&&typeof J[Z]!="number")return new Error("Database version must be a number.");this._config[Z]=J[Z]}return"driver"in J&&J.driver?this.setDriver(this._config.driver):!0}else return typeof J=="string"?this._config[J]:this._config},$.prototype.defineDriver=function(J,Z,le){var de=new d(function(re,Ee){try{var ze=J._driver,qe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!J._driver){Ee(qe);return}for(var tt=ya.concat("_initStorage"),it=0,Pt=tt.length;it<Pt;it++){var sn=tt[it],On=!di(oi,sn);if((On||J[sn])&&typeof J[sn]!="function"){Ee(qe);return}}var Dn=function(){for(var Xn=function(du){return function(){var mu=new Error("Method "+du+" is not implemented by the current driver"),fu=d.reject(mu);return m(fu,arguments[arguments.length-1]),fu}},Oi=0,Wi=oi.length;Oi<Wi;Oi++){var Nl=oi[Oi];J[Nl]||(J[Nl]=Xn(Nl))}};Dn();var gr=function(Xn){Li[ze]&&console.info("Redefining LocalForage driver: "+ze),Li[ze]=J,Ei[ze]=Xn,re()};"_support"in J?J._support&&typeof J._support=="function"?J._support().then(gr,Ee):gr(!!J._support):gr(!0)}catch(Xn){Ee(Xn)}});return f(de,Z,le),de},$.prototype.driver=function(){return this._driver||null},$.prototype.getDriver=function(J,Z,le){var de=Li[J]?d.resolve(Li[J]):d.reject(new Error("Driver not found."));return f(de,Z,le),de},$.prototype.getSerializer=function(J){var Z=d.resolve(Ce);return f(Z,J),Z},$.prototype.ready=function(J){var Z=this,le=Z._driverSet.then(function(){return Z._ready===null&&(Z._ready=Z._initDriver()),Z._ready});return f(le,J,J),le},$.prototype.setDriver=function(J,Z,le){var de=this;uo(J)||(J=[J]);var re=this._getSupportedDrivers(J);function Ee(){de._config.driver=de.driver()}function ze(it){return de._extend(it),Ee(),de._ready=de._initStorage(de._config),de._ready}function qe(it){return function(){var Pt=0;function sn(){for(;Pt<it.length;){var On=it[Pt];return Pt++,de._dbInfo=null,de._ready=null,de.getDriver(On).then(ze).catch(sn)}Ee();var Dn=new Error("No available storage method found.");return de._driverSet=d.reject(Dn),de._driverSet}return sn()}}var tt=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=tt.then(function(){var it=re[0];return de._dbInfo=null,de._ready=null,de.getDriver(it).then(function(Pt){de._driver=Pt._driver,Ee(),de._wrapLibraryMethodsWithReady(),de._initDriver=qe(re)})}).catch(function(){Ee();var it=new Error("No available storage method found.");return de._driverSet=d.reject(it),de._driverSet}),f(this._driverSet,Z,le),this._driverSet},$.prototype.supports=function(J){return!!Ei[J]},$.prototype._extend=function(J){zi(this,J)},$.prototype._getSupportedDrivers=function(J){for(var Z=[],le=0,de=J.length;le<de;le++){var re=J[le];this.supports(re)&&Z.push(re)}return Z},$.prototype._wrapLibraryMethodsWithReady=function(){for(var J=0,Z=ya.length;J<Z;J++)ji(this,ya[J])},$.prototype.createInstance=function(J){return new $(J)},$}(),Da=new ta;r.exports=Da},{3:3}]},{},[4])(4)})})(vB);var tAe=vB.exports;const $l=_k(tAe);let nAe=class{getItem(e){return $l.getItem(e)}setItem(e,n){return $l.setItem(e,n)}removeItem(e){return $l.removeItem(e)}clear(){return $l.clear()}key(e){return $l.key(e)}keys(){return $l.keys()}iterate(e){return $l.iterate(e)}};var rAe=Object.defineProperty,iAe=Object.getOwnPropertyDescriptor,oAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?iAe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&rAe(e,n,i),i},aAe=(t,e)=>(n,r)=>e(n,r,t);let P_=class{constructor(t){Mn(this,"visible$",new an),Mn(this,"componentKey$",new an),this._componentManager=t}set(t,e){return this._componentManager.register(t,e),this.componentKey$.next(t),je(()=>{this._componentManager.delete(t),this.visible$.complete(),this.componentKey$.complete()})}open(){this.visible$.next(!0)}close(){this.visible$.next(!1)}};P_=oAe([aAe(0,K(Jo))],P_);var sAe=Object.defineProperty,uAe=Object.getOwnPropertyDescriptor,lAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?uAe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&sAe(e,n,i),i},qA=(t,e)=>(n,r)=>e(n,r,t);const cAe="ui",dAe={};var Dg;let M_=(Dg=class extends b1{constructor(t={},e,n){super(cAe),Mn(this,"_config"),this._injector=e,this._localeService=n,this._config={...dAe,...t},this._localeService.load({zhCN:TIe})}onStarting(t){this._initDependencies(t)}onReady(){this._initUI()}_initDependencies(t){[[Jo],[xEe],[hB],[c8],[lu,{useClass:p_}],[Ak,{useClass:XEe}],[S1,{useClass:g_}],[yf,{useClass:hIe}],[$s,{useClass:v_,lazy:!0}],[wE,{useClass:$Ie,lazy:!0}],[mB,{useClass:xIe,lazy:!0}],[Ca,{useClass:NIe,lazy:!0}],[cd,{useClass:HIe,lazy:!0}],[Hk,{useClass:P_,lazy:!0}],[fB,{useClass:O_,lazy:!0}],[Ef,{useClass:FIe,lazy:!0}],[QL,{useClass:nAe,lazy:!0}],[MIe,{useClass:L_}],[LE,{useClass:C_}],[F0,{useClass:w_}],[Z4],[J4],[e7]].forEach(e=>t.add(e))}_initUI(){Promise.resolve().then(()=>this._injector.get(F0).bootstrapWorkbench(this._config))}},Mn(Dg,"type",Ir.Univer),Dg);M_=lAe([qA(1,K(wn)),qA(2,K(Gt))],M_);function a0(t){return t.length===0?t:t.replace(/^\s+|\s+$/gm,"")}function mAe(t,e=""){var n,r;let i=(r=(n=t==null?void 0:t.style)==null?void 0:n.cssText)!=null?r:"";if(i+=e,i.length===0)return{};const o=i.split(";"),a={},s={t:"",r:"",b:"",l:""};return o.forEach(u=>{u=u.toLowerCase();const l=a0(u.substr(0,u.indexOf(":"))),c=a0(u.substr(u.indexOf(":")+1));if(l==="font-weight")c==="bold"?a.bl=1:a.bl=0;else if(l==="font-style")c==="italic"?a.it=1:a.it=0;else if(l==="font-family")a.ff=c;else if(l==="font-size"){let d=Number.parseInt(c);i.indexOf("vertical-align")>-1&&(i.indexOf("sub")>-1||i.indexOf("sup")>-1)&&(d*=2),c.indexOf("px")!==-1&&(d=oge(Number.parseInt(c))),a.fs=d}else l==="color"?a.cl={rgb:c}:l==="background"||l==="background-color"?a.bg={rgb:c}:l==="text-decoration-line"?c==="underline"?(a.ul||(a.ul={s:1}),a.ul.s=1):c==="line-through"?(a.st||(a.st={s:1}),a.st.s=1):c==="overline"&&(a.ol||(a.ol={s:1}),a.ol.s=1):l==="text-decoration-color"?(a.hasOwnProperty("ul")&&(a.ul||(a.ul={s:1,cl:{rgb:c}}),a.ul.cl={rgb:c}),a.hasOwnProperty("st")&&(a.st||(a.st={s:1,cl:{rgb:c}}),a.st.cl={rgb:c}),a.hasOwnProperty("ol")&&(a.ol||(a.ol={s:1,cl:{rgb:c}}),a.ol.cl={rgb:c})):l==="text-decoration-style"?(a.hasOwnProperty("ul")&&(a.ul||(a.ul={s:1,t:Number(c)}),a.ul.t=Number(c)),a.hasOwnProperty("st")&&(a.st||(a.st={s:1,t:Number(c)}),a.st.t=Number(c)),a.hasOwnProperty("ol")&&(a.ol||(a.ol={s:1,t:Number(c)}),a.ol.t=Number(c))):(l==="text-decoration"||l==="univer-strike")&&c!=="none"&&(a.st={s:1});if(l==="univer-underline"&&(a.ul={s:1}),l==="vertical-align"&&(c==="sub"?a.va=yr.SUBSCRIPT:c==="super"?a.va=yr.SUPERSCRIPT:c==="top"?a.vt=1:c==="middle"?a.vt=2:c==="bottom"?a.vt=3:a.va=yr.NORMAL),l==="transform"){const d=c.split(")"),m=d.findIndex(f=>f.includes("rotate"));if(m>-1){const f=d[m].match(/\d+/g);let h=0,p=0;f!=null&&f.length&&(h=+f[0]),t!=null&&t.dataset.vertical&&(p=+t.dataset.vertical),a.tr={a:h,v:p}}}if(l==="text-align"&&(c==="left"?a.ht=1:c==="center"?a.ht=2:c==="right"?a.ht=3:c==="justify"?a.ht=4:a.ht=0),l==="overflow-wrap"||l==="word-wrap"?c==="break-word"&&(a.tb=3):l==="text-overflow"?c==="clip"&&(a.tb=2):l==="text-break"&&c==="overflow"&&(a.tb=1),l==="border-color"){const d=GA(c,")");if(a.bd)for(const m in d)a.bd[m].cl.rgb=d[m];else{a.bd={b:{cl:{rgb:"#000"},s:0},t:{cl:{rgb:"#000"},s:0},l:{cl:{rgb:"#000"},s:0},r:{cl:{rgb:"#000"},s:0}};for(const m in d)a.bd[m].cl.rgb=d[m]}}if(l==="border-width"||l==="border-style"){const d=GA(c," ");for(const m in d)s[m]+=` ${d[m]}`;a.bd?(a.bd.b.s=I1(s.b),a.bd.t.s=I1(s.t),a.bd.l.s=I1(s.l),a.bd.r.s=I1(s.r)):a.bd={b:{cl:{rgb:"#000"},s:I1(s.b)},t:{cl:{rgb:"#000"},s:I1(s.t)},l:{cl:{rgb:"#000"},s:I1(s.l)},r:{cl:{rgb:"#000"},s:I1(s.r)}}}if(l==="border-bottom"||l==="border-top"||l==="border-left"||l==="border-right"||l==="border"){a.bd||(a.bd={});const d=c.split(" "),m=`${d[0]} ${d[1]}`;d.splice(0,2);const f={cl:{rgb:d.join("")},s:I1(m)};l==="border-bottom"?a.bd.b=c==="none"?null:f:l==="border-top"?a.bd.t=c==="none"?null:f:l==="border-left"?a.bd.l=c==="none"?null:f:l==="border-right"?a.bd.r=c==="none"?null:f:l==="border"&&(a.bd={r:c==="none"?null:f,t:c==="none"?null:f,b:c==="none"?null:f,l:c==="none"?null:f})}}),a}function GA(t,e){let n;e===" "?n=t.trim().split(e):n=t.trim().split(e).slice(0,-1),n.forEach(i=>`${i.trim()})`);let r={};return n.length===1?r={t:n[0],r:n[0],b:n[0],l:n[0]}:n.length===2?r={t:n[0],r:n[1],b:n[0],l:n[1]}:n.length===3?r={t:n[0],r:n[1],b:n[2],l:n[1]}:n.length===4&&(r={t:n[0],r:n[1],b:n[2],l:n[3]}),r}var fAe=Object.defineProperty,hAe=(t,e,n)=>e in t?fAe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zo=(t,e,n)=>(hAe(t,typeof e!="symbol"?e+"":e,n),n);const pAe={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},gAe={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},vAe={layout:{docContainerConfig:gAe,toolbarConfig:pAe}},bAe="DocUI",_Ae={id:nu.id,binding:Ge.ARROW_UP,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.UP}},CAe={id:nu.id,binding:Ge.ARROW_DOWN,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.DOWN}},SAe={id:nu.id,binding:Ge.ARROW_LEFT,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.LEFT}},EAe={id:nu.id,binding:Ge.ARROW_RIGHT,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.RIGHT}},yAe={id:al.id,binding:Ge.ARROW_UP|Yt.SHIFT,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.UP}},DAe={id:al.id,binding:Ge.ARROW_DOWN|Yt.SHIFT,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.DOWN}},RAe={id:al.id,binding:Ge.ARROW_LEFT|Yt.SHIFT,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.LEFT}},IAe={id:al.id,binding:Ge.ARROW_RIGHT|Yt.SHIFT,preconditions:t=>t.getContextValue(So),staticParameters:{direction:ye.RIGHT}},AAe={id:PF.id,binding:Ge.A|Yt.CTRL_COMMAND,preconditions:t=>t.getContextValue(So)||t.getContextValue(Mr)};var TAe=Object.defineProperty,wAe=Object.getOwnPropertyDescriptor,LAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?wAe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&TAe(e,n,i),i},KA=(t,e)=>(n,r)=>e(n,r,t);let N_=class{constructor(e,n,r){zo(this,"_docContainer"),zo(this,"getComponent",i=>{if(this._docContainer=i,!i.getContentRef().current)throw new Error("container is not ready")}),zo(this,"changeLocale",i=>{this._localeService.setLocale(i)}),this._config=e,this._localeService=n,this._injector=r}getUIConfig(){return{injector:this._injector,config:this._config,changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(e){if(this._docContainer)return e(this._docContainer)}getDocContainer(){return this._docContainer}};N_=LAe([KA(1,K(Gt)),KA(2,K(wn))],N_);var OAe=Object.defineProperty,PAe=Object.getOwnPropertyDescriptor,MAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?PAe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&OAe(e,n,i),i},U3=(t,e)=>(n,r)=>e(n,r,t);let W6=class extends Ro{constructor(e,n,r,i,o){super(),zo(this,"_docContainerController"),zo(this,"changeLocale",a=>{this._localeService.setLocale(a)}),this._localeService=n,this._injector=r,this._textSelectionRenderManager=i,this._layoutService=o,this._docContainerController=this._injector.createInstance(N_,e),this._registerContainer()}_registerContainer(){this._layoutService&&this.disposeWithMe(this._layoutService.registerContainer(this._textSelectionRenderManager.__getEditorContainer()))}getDocContainerController(){return this._docContainerController}};W6=MAe([U3(1,K(Gt)),U3(2,K(wn)),U3(3,To),U3(4,W0(c8))],W6);const D8="UI_PLUGIN_DOCS",bB=`${D8}_COLOR_PICKER_COMPONENT`,_B=`${D8}_FONT_FAMILY_COMPONENT`,CB=`${D8}_FONT_FAMILY_ITEM_COMPONENT`,SB=`${D8}_FONT_SIZE_COMPONENT`;function NAe(t){const e=t.get(se);return{id:od.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",positions:[hn.TOOLBAR_START],activated$:new Wt(n=>{const r=e.onCommandExecuted(i=>{var o;const a=i.id;if(a===wo.id||a===_a.id){const s=Ll(t);if(s==null)return;const u=(o=s.ts)==null?void 0:o.bl;n.next(u===we.TRUE)}});return n.next(!1),r.dispose}),hidden$:cr(t,or.DOC)}}function xAe(t){const e=t.get(se);return{id:ad.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",positions:[hn.TOOLBAR_START],activated$:new Wt(n=>{const r=e.onCommandExecuted(i=>{var o;const a=i.id;if(a===wo.id||a===_a.id){const s=Ll(t);if(s==null)return;const u=(o=s.ts)==null?void 0:o.it;n.next(u===we.TRUE)}});return n.next(!1),r.dispose}),hidden$:cr(t,or.DOC)}}function FAe(t){const e=t.get(se);return{id:sd.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",positions:[hn.TOOLBAR_START],activated$:new Wt(n=>{const r=e.onCommandExecuted(i=>{var o;const a=i.id;if(a===wo.id||a===_a.id){const s=Ll(t);if(s==null)return;const u=(o=s.ts)==null?void 0:o.ul;n.next((u==null?void 0:u.s)===we.TRUE)}});return n.next(!1),r.dispose}),hidden$:cr(t,or.DOC)}}function $Ae(t){const e=t.get(se);return{id:ud.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",positions:[hn.TOOLBAR_START],activated$:new Wt(n=>{const r=e.onCommandExecuted(i=>{var o;const a=i.id;if(a===wo.id||a===_a.id){const s=Ll(t);if(s==null)return;const u=(o=s.ts)==null?void 0:o.st;n.next((u==null?void 0:u.s)===we.TRUE)}});return n.next(!1),r.dispose}),hidden$:cr(t,or.DOC)}}function kAe(t){const e=t.get(se);return{id:ol.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"SubscriptSingle",tooltip:"toolbar.subscript",positions:[hn.TOOLBAR_START],activated$:new Wt(n=>{const r=e.onCommandExecuted(i=>{var o;const a=i.id;if(a===wo.id||a===_a.id){const s=Ll(t);if(s==null)return;const u=(o=s.ts)==null?void 0:o.va;n.next(u===yr.SUBSCRIPT)}});return n.next(!1),r.dispose}),hidden$:cr(t,or.DOC)}}function BAe(t){const e=t.get(se);return{id:ld.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"SuperscriptSingle",tooltip:"toolbar.superscript",positions:[hn.TOOLBAR_START],activated$:new Wt(n=>{const r=e.onCommandExecuted(i=>{var o;const a=i.id;if(a===wo.id||a===_a.id){const s=Ll(t);if(s==null)return;const u=(o=s.ts)==null?void 0:o.va;n.next(u===yr.SUPERSCRIPT)}});return n.next(!1),r.dispose}),hidden$:cr(t,or.DOC)}}function UAe(t){const e=t.get(se);return{id:wc.id,tooltip:"toolbar.font",group:Kt.TOOLBAR_FORMAT,type:pt.SELECTOR,label:_B,positions:[hn.TOOLBAR_START],selections:S9.map(n=>({label:{name:CB,hoverable:!0},value:n.value})),value$:new Wt(n=>{const r=S9[0].value,i=e.onCommandExecuted(o=>{var a;const s=o.id;if(s===wo.id||s===wc.id){const u=Ll(t);if(u==null)return;const l=(a=u.ts)==null?void 0:a.ff;n.next(l??r)}});return n.next(r),i.dispose}),hidden$:cr(t,or.DOC)}}function VAe(t){const e=t.get(se);return{id:Tc.id,group:Kt.TOOLBAR_FORMAT,type:pt.SELECTOR,tooltip:"toolbar.fontSize",label:{name:SB,props:{min:1,max:400}},positions:[hn.TOOLBAR_START],selections:Ik,value$:new Wt(n=>{const r=e.onCommandExecuted(i=>{var o;const a=i.id;if(a===wo.id||a===Tc.id){const s=Ll(t);if(s==null)return;const u=(o=s.ts)==null?void 0:o.fs;n.next(u??14)}});return n.next(14),r.dispose}),hidden$:cr(t,or.DOC)}}function HAe(t){const e=t.get(se),n=t.get(_i);return{id:Lc.id,icon:"FontColor",tooltip:"toolbar.textColor.main",group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON_SELECTOR,positions:[hn.TOOLBAR_START],selections:[{label:{name:bB,hoverable:!1}}],value$:new Wt(r=>{const i=n.getCurrentTheme().textColor,o=e.onCommandExecuted(a=>{if(a.id===Lc.id){const s=a.params.value;r.next(s??i)}});return r.next(i),o.dispose}),hidden$:cr(t,or.DOC)}}function jAe(t){return{id:AF.id,group:Kt.TOOLBAR_LAYOUT,type:pt.BUTTON,icon:"OrderSingle",tooltip:"toolbar.order",positions:[hn.TOOLBAR_START],hidden$:cr(t,or.DOC)}}function zAe(t){return{id:IF.id,group:Kt.TOOLBAR_LAYOUT,type:pt.BUTTON,icon:"UnorderSingle",tooltip:"toolbar.unorder",positions:[hn.TOOLBAR_START],hidden$:cr(t,or.DOC)}}function Ll(t){var e;const n=t.get(ae),r=t.get(kr),i=n.getCurrentUniverDocInstance(),o=r.getActiveRange();if(i==null||o==null)return;const a=(e=i.getBody())==null?void 0:e.textRuns;if(a==null)return;const{startOffset:s}=o;return a.find(({st:u,ed:l})=>s>=u&&s<l)}var WAe=Object.defineProperty,YAe=Object.getOwnPropertyDescriptor,XAe=(t,e,n,r)=>{for(var i=r>1?void 0:r?YAe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&WAe(e,n,i),i},S2=(t,e)=>(n,r)=>e(n,r,t);let t7=class extends We{constructor(e,n,r,i,o,a){super(),this._injector=e,this._componentManager=n,this._commandService=r,this._shortcutService=i,this._menuService=o,this._uiController=a,this._init()}_initCustomComponents(){const e=this._componentManager;this.disposeWithMe(e.register(bB,$S)),this.disposeWithMe(e.register(_B,yk)),this.disposeWithMe(e.register(CB,Dk)),this.disposeWithMe(e.register(SB,Rk))}_initMenus(){[NAe,xAe,FAe,$Ae,kAe,BAe,VAe,UAe,HAe,jAe,zAe].forEach(e=>{this.disposeWithMe(this._menuService.addMenuItem(this._injector.invoke(e)))})}_init(){this._initCustomComponents(),this._initMenus()}};t7=XAe([yt(ot.Rendered,t7),S2(0,K(wn)),S2(1,K(Jo)),S2(2,se),S2(3,lu),S2(4,S1),S2(5,F0)],t7);const qAe={toolbar:{undo:"撤销",redo:"重做",font:"字体",fontSize:"字号",bold:"粗体",italic:"斜体",strikethrough:"删除线",subscript:"下标",superscript:"上标",underline:"下划线",textColor:{main:"文本颜色",right:"颜色选择"},resetColor:"重置颜色",order:"有序列表",unorder:"无序列表"}},GAe={id:RE.id,preconditions:t=>t.getContextValue(So),binding:Ge.ENTER},KAe={id:IE.id,preconditions:t=>t.getContextValue(So),binding:Ge.BACKSPACE},ZAe={id:EF.id,preconditions:t=>t.getContextValue(So),binding:Ge.DELETE},QAe=10,JAe=6;function eTe(){return Ie.generateRandomId(JAe)}function tTe(t){const e=t.match(/data-copy-id="([^\s]+)"/);return e&&e[1]?e[1]:null}let nTe=class{constructor(){zo(this,"_cache",new r5(QAe))}set(e,n){this._cache.set(e,n)}get(e){return this._cache.get(e)}clear(){this._cache.clear()}};const ZA=new nTe;function FE(t){const e=t.style,n={},r=t.tagName.toLowerCase();switch(r){case"b":case"em":case"strong":{n.bl=we.TRUE;break}case"s":{n.st={s:we.TRUE};break}case"u":{n.ul={s:we.TRUE};break}case"i":{n.it=we.TRUE;break}case"sub":case"sup":{n.va=r==="sup"?yr.SUPERSCRIPT:yr.SUBSCRIPT;break}}for(let i=0;i<e.length;i++){const o=e[i],a=e.getPropertyValue(o);switch(o){case"font-family":{n.ff=a;break}case"font-size":{const s=Number.parseInt(a);Number.isNaN(s)||a.endsWith("pt")&&(n.fs=s);break}case"font-style":{a==="italic"&&(n.it=we.TRUE);break}case"font-weight":{Number(a)>400&&(n.bl=we.TRUE);break}case"text-decoration":{/underline/.test(a)?n.ul={s:we.TRUE}:/overline/.test(a)?n.ol={s:we.TRUE}:/line-through/.test(a)&&(n.st={s:we.TRUE});break}case"color":{const s=new Xo(a);s.isValid&&(n.cl={rgb:s.toRgbString()});break}case"background-color":{const s=new Xo(a);s.isValid&&(n.bg={rgb:s.toRgbString()});break}}}return n}function rTe(t){const e=new DOMParser,n=`<x-univer id="univer-root">${t}</x-univer>`;return e.parseFromString(n,"text/html").querySelector("#univer-root")}function QA(t,e){const n=t.tagName.toLowerCase();return typeof e=="string"?n===e:Array.isArray(e)?e.some(r=>r===n):e(t)}const EB=class yB{constructor(){zo(this,"_styleCache",new Map),zo(this,"_styleRules",[]),zo(this,"_afterProcessRules",[])}static use(e){if(this._pluginList.includes(e))throw new Error(`Univer paste plugin ${e.name} already added`);this._pluginList.push(e)}convert(e){const n=yB._pluginList.find(o=>o.checkPasteType(e)),r=rTe(e),i={dataStream:"",textRuns:[]};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._styleCache.clear(),this._process(null,r==null?void 0:r.childNodes,i),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],i}_process(e,n,r){var i;for(const o of n)if(o.nodeType===Node.TEXT_NODE){const a=(i=o.nodeValue)==null?void 0:i.replace(/[\r\n]/g,"");let s;e&&this._styleCache.has(e)&&(s=this._styleCache.get(e)),r.dataStream+=a,s&&Object.getOwnPropertyNames(s).length&&r.textRuns.push({st:r.dataStream.length-a.length,ed:r.dataStream.length,ts:s})}else if(o.nodeType===Node.ELEMENT_NODE){const a=e?this._styleCache.get(e):{},s=this._styleRules.find(({filter:d})=>QA(o,d)),u=s?s.getStyle(o):FE(o);this._styleCache.set(o,{...a,...u});const{childNodes:l}=o;this._process(o,l,r);const c=this._afterProcessRules.find(({filter:d})=>QA(o,d));c&&c.handler(r,o)}}};zo(EB,"_pluginList",[]);let $E=EB;const iTe={name:"univer-doc-paste-plugin-lark",checkPasteType(t){return/lark-record-clipboard/i.test(t)},stylesRules:[{filter:["s"],getStyle(t){const e=FE(t);return{st:{s:we.TRUE},...e}}}],afterProcessRules:[{filter(t){return t.tagName==="DIV"&&/ace-line/i.test(t.className)},handler(t){t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]};function oTe(t){const e=t.style,n={};for(let r=0;r<e.length;r++){const i=e[r],o=e.getPropertyValue(i);switch(i){case"margin-top":{const a=Number.parseInt(o);n.spaceAbove=/pt/.test(o)?JA(a):a;break}case"margin-bottom":{const a=Number.parseInt(o);n.spaceBelow=/pt/.test(o)?JA(a):a;break}}}return Object.getOwnPropertyNames(n).length?n:null}function JA(t){return t/.75}const aTe={name:"univer-doc-paste-plugin-word",checkPasteType(t){return/word|mso/i.test(t)},stylesRules:[{filter:["b"],getStyle(t){const e=FE(t);return{bl:we.TRUE,...e}}}],afterProcessRules:[{filter(t){return t.tagName==="P"&&/mso/i.test(t.className)},handler(t,e){t.paragraphs==null&&(t.paragraphs=[]);const n={startIndex:t.dataStream.length},r=oTe(e);r&&(n.paragraphStyle=r),t.paragraphs.push(n),t.dataStream+="\r"}}]};function sTe(t,e){const{st:n,ed:r,ts:i={}}=e,{ff:o,fs:a,it:s,bl:u,ul:l,st:c,ol:d,bg:m,cl:f,va:h}=i;let p=t.slice(n,r);const v=[];return s===we.TRUE&&(p=`<i>${p}</i>`),h===yr.SUPERSCRIPT?p=`<sup>${p}</sup>`:h===yr.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(l==null?void 0:l.s)===we.TRUE&&(p=`<u>${p}</u>`),(c==null?void 0:c.s)===we.TRUE&&(p=`<s>${p}</s>`),u===we.TRUE&&(p=`<strong>${p}</strong>`),o&&v.push(`font-family: ${o}`),f&&v.push(`color: ${f.rgb}`),a&&v.push(`font-size: ${a}px`),d&&v.push("text-decoration: overline"),m&&v.push(`background: ${m.rgb}`),v.length?`<span style="${v.join(";")}">${p}</span>`:p}function eT(t,e=!0){const{dataStream:n,textRuns:r=[],paragraphs:i=[]}=t;let o=0;const a=[],s=[];for(const u of r){const{st:l,ed:c}=u;if(l!==o&&a.push(n.slice(o,l)),a.push(sTe(n,u)),o=c,e)for(const d of i){const{startIndex:m,paragraphStyle:f={}}=d;if(m>=l&&m<=c){const{spaceAbove:h,spaceBelow:p}=f,v=[];h!=null&&(typeof h=="number"?v.push(`margin-top: ${h}px`):v.push(`margin-top: ${h.v}px`)),p!=null&&(typeof p=="number"?v.push(`margin-bottom: ${p}px`):v.push(`margin-bottom: ${p.v}px`)),s.push(`<p className="UniverNormal" ${v.length?`style="${v.join(";")}"`:""}>${a.join("")}</p>`),a.length=0}}}return o<n.length&&a.push(n.slice(o,n.length)),s.join("")+a.join("")}let uTe=class{convert(e){if(e.length===0)throw new Error("The bodyList length at least to be 1");if(e.length===1)return eT(e[0]);let n="";for(const r of e)n+='<p className="UniverNormal">',n+=eT(r,!1),n+="</p>";return n}};var lTe=Object.defineProperty,cTe=Object.getOwnPropertyDescriptor,dTe=(t,e,n,r)=>{for(var i=r>1?void 0:r?cTe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&lTe(e,n,i),i},Gd=(t,e)=>(n,r)=>e(n,r,t);$E.use(aTe);$E.use(iTe);function mTe(t){const e=t.replace(/\n/g,"\r"),n=[];for(let r=0;r<e.length;r++)e[r]==="\r"&&n.push({startIndex:r});return{dataStream:e,paragraphs:n}}const Df=ln("doc.clipboard-service");let x_=class extends We{constructor(e,n,r,i,o){super(),zo(this,"_clipboardHooks",[]),zo(this,"_htmlToUDM",new $E),zo(this,"_umdToHtml",new uTe),this._currentUniverService=e,this._logService=n,this._commandService=r,this._clipboardInterfaceService=i,this._textSelectionManagerService=o}async copy(){const e=this._getDocumentBodyInRanges();try{this._setClipboardData(e)}catch(n){return this._logService.error("[DocClipboardService] copy failed",n),!1}return!0}async cut(){return this._cut()}async paste(e){const n=await this._generateBodyFromClipboardItems(e);return this._paste(n)}async legacyPaste(e,n){const r=this._generateBodyFromHtmlAndText(e,n);return this._paste(r)}async _cut(){var e;const{segmentId:n,endOffset:r,style:i}=(e=this._textSelectionManagerService.getActiveRange())!=null?e:{},o=this._textSelectionManagerService.getSelections();if(n==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),r==null||o==null)return!1;this.copy();try{let a=r;for(const u of o){const{startOffset:l,endOffset:c}=u;l==null||c==null||c<=r&&(a-=c-l)}const s=[{startOffset:a,endOffset:a,style:i}];return this._commandService.executeCommand(s8.id,{segmentId:n,textRanges:s})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(e){var n;const{segmentId:r,endOffset:i,style:o}=(n=this._textSelectionManagerService.getActiveRange())!=null?n:{},a=this._textSelectionManagerService.getSelections();if(r==null&&this._logService.error("[DocClipboardController] segmentId does not exist!"),i==null||a==null)return!1;try{let s=i;for(const l of a){const{startOffset:c,endOffset:d}=l;c==null||d==null||d<=i&&(s+=e.dataStream.length-(d-c))}const u=[{startOffset:s,endOffset:s,style:o}];return this._commandService.executeCommand(SF.id,{body:e,segmentId:r,textRanges:u})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(e){const n=eTe(),r=e.length>1?e.map(o=>o.dataStream).join(`
`):e[0].dataStream;let i=this._umdToHtml.convert(e);return e.length===1&&(i=i.replace(/(<[a-z]+)/,(o,a)=>`${a} data-copy-id="${n}"`),ZA.set(n,e[0])),this._clipboardInterfaceService.write(r,i)}addClipboardHook(e){return this._clipboardHooks.push(e),je(()=>{const n=this._clipboardHooks.indexOf(e);n>-1&&this._clipboardHooks.splice(n,1)})}_getDocumentBodyInRanges(){const e=this._textSelectionManagerService.getSelections(),n=this._currentUniverService.getCurrentUniverDocInstance(),r=[];if(e==null)return r;for(const i of e){const{startOffset:o,endOffset:a,collapsed:s}=i;if(s||o==null||a==null)continue;const u=n.sliceBody(o,a);u!=null&&r.push(u)}return r}async _generateBodyFromClipboardItems(e){try{let n="",r="";for(const i of e)for(const o of i.types)o===Mm?r=await i.getType(o).then(a=>a&&a.text()):o===Nm&&(n=await i.getType(o).then(a=>a&&a.text()));return this._generateBodyFromHtmlAndText(n,r)}catch(n){return Promise.reject(n)}}_generateBodyFromHtmlAndText(e,n){if(!e){if(n)return mTe(n);throw new Error("[DocClipboardService] html and text cannot be both empty!")}const r=tTe(e);if(r){const i=ZA.get(r);if(i)return i}return this._htmlToUDM.convert(e)}};x_=dTe([Gd(0,ae),Gd(1,oo),Gd(2,se),Gd(3,$s),Gd(4,K(kr))],x_);function R8(t){return t.getContextValue(So)||t.getContextValue(Mr)}const kE=999,fTe={id:vf.id,name:"doc.command.copy",type:ue.COMMAND,multi:!0,priority:kE,preconditions:R8,handler:async t=>t.get(Df).copy()},hTe={id:d8.id,name:"doc.command.cut",type:ue.COMMAND,multi:!0,priority:kE,preconditions:R8,handler:async t=>t.get(Df).cut()},pTe={id:bf.id,name:"doc.command.paste",type:ue.COMMAND,multi:!0,priority:kE,preconditions:R8,handler:async t=>{const e=t.get(Df),n=await t.get($s).read();return n.length===0?!1:e.paste(n)}};var gTe=Object.defineProperty,vTe=Object.getOwnPropertyDescriptor,bTe=(t,e,n,r)=>{for(var i=r>1?void 0:r?vTe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&gTe(e,n,i),i},Kd=(t,e)=>(n,r)=>e(n,r,t);let n7=class extends Ro{constructor(e,n,r,i,o){super(),this._commandService=e,this._clipboardInterfaceService=n,this._docClipboardService=r,this._textSelectionRenderManager=i,this._contextService=o,this._init()}_init(){[fTe,hTe,pTe].forEach(e=>this.disposeWithMe(this._commandService.registerMultipleCommand(e))),[SF,s8].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e))),this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var e;this._clipboardInterfaceService.supportClipboard||(e=this._textSelectionRenderManager)==null||e.onPaste$.pipe(Fi(this.dispose$)).subscribe(n=>{var r,i;if(!R8(this._contextService))return;n.event.preventDefault();const o=n.event,a=(r=o.clipboardData)==null?void 0:r.getData("text/html"),s=(i=o.clipboardData)==null?void 0:i.getData("text/plain");this._docClipboardService.legacyPaste(a,s)})}};n7=bTe([yt(ot.Steady,n7),Kd(0,se),Kd(1,$s),Kd(2,Df),Kd(3,To),Kd(4,pr)],n7);var _Te=Object.defineProperty,CTe=Object.getOwnPropertyDescriptor,STe=(t,e,n,r)=>{for(var i=r>1?void 0:r?CTe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&_Te(e,n,i),i},Rg=(t,e)=>(n,r)=>e(n,r,t),Ig;let F_=(Ig=class extends b1{constructor(t,e,n,r){super(bAe),this._config=t,this._injector=e,this._localeService=n,this._logService=r,this._localeService.load({zhCN:qAe}),this._config=Ie.deepMerge({},vAe,this._config),this._initDependencies(e),this._initializeCommands()}onRendered(){this._initModules(),this._markDocAsFocused()}onDestroy(){}_initializeCommands(){[_Ae,CAe,EAe,SAe,yAe,DAe,RAe,IAe,AAe,KAe,ZAe,GAe].forEach(t=>{this._injector.get(lu).registerShortcut(t)})}_initDependencies(t){[[t7],[n7],[W6,{useFactory:()=>this._injector.createInstance(W6,this._config)}],[Df,{useClass:x_}]].forEach(e=>{t.add(e)})}_markDocAsFocused(){const t=this._injector.get(ae);try{const e=t.getCurrentUniverDocInstance(),n=e.getUnitId();n!==Qr&&n!==qn&&t.focusUniverInstance(e.getUnitId())}catch(e){this._logService.warn(e)}}_initModules(){this._injector.get(W6)}},zo(Ig,"type",Ir.Doc),Ig);F_=STe([Rg(1,K(wn)),Rg(2,K(Gt)),Rg(3,oo)],F_);var ETe=Object.defineProperty,yTe=(t,e,n)=>e in t?ETe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fe=(t,e,n)=>(yTe(t,typeof e!="symbol"?e+"":e,n),n);function DTe(t,e,n,r,i){for(let o=0,a=t.length;o<a;o++){const s=t[o];if(e!==s.unitId||n!==s.sheetId)continue;const{startRow:u,startColumn:l,endRow:c,endColumn:d}=s.range;if(r>=u&&r<=c&&i>=l&&i<=d)return!0}return!1}var k=(t=>(t.DIV_BY_ZERO="#DIV/0!",t.NAME="#NAME?",t.VALUE="#VALUE!",t.NUM="#NUM!",t.NA="#N/A",t.CYCLE="#CYCLE!",t.REF="#REF!",t.SPILL="#SPILL!",t.CALC="#CALC!",t.ERROR="#ERROR!",t.CONNECT="#GETTING_DATA",t.NULL="#NULL!",t))(k||{});const I8=new Set(Object.values(k));var A=(t=>(t[t.Financial=0]="Financial",t[t.Date=1]="Date",t[t.Math=2]="Math",t[t.Statistical=3]="Statistical",t[t.Lookup=4]="Lookup",t[t.Database=5]="Database",t[t.Text=6]="Text",t[t.Logical=7]="Logical",t[t.Information=8]="Information",t[t.Engineering=9]="Engineering",t[t.Cube=10]="Cube",t[t.Compatibility=11]="Compatibility",t[t.Web=12]="Web",t[t.Array=13]="Array",t[t.Univer=14]="Univer",t[t.User=15]="User",t))(A||{}),sa=(t=>(t.PLUS="+",t.MINUS="-",t.MULTIPLY="*",t.DIVIDED="/",t.CONCATENATE="&",t.POWER="^",t.EQUALS="=",t.NOT_EQUAL="<>",t.GREATER_THAN=">",t.GREATER_THAN_OR_EQUAL=">=",t.LESS_THAN="<",t.LESS_THAN_OR_EQUAL="<=",t))(sa||{}),Rt=(t=>(t.EQUALS="=",t.NOT_EQUAL="<>",t.GREATER_THAN=">",t.GREATER_THAN_OR_EQUAL=">=",t.LESS_THAN="<",t.LESS_THAN_OR_EQUAL="<=",t))(Rt||{});const r7=new Map([["<>",3],["<",3],[">=",3],["=",3],[">",3],["<=",3],["&",2],["+",2],["-",2],["/",1],["*",1],["^",0]]),E6=new Set(r7.keys()),RTe=new Set(["=","<>",">",">=","<","<="]);var bn=(t=>(t.OPEN_BRACKET="(",t.CLOSE_BRACKET=")",t.COMMA=",",t.SINGLE_QUOTATION="'",t.DOUBLE_QUOTATION='"',t.OPEN_BRACES="{",t.CLOSE_BRACES="}",t.COLON=":",t.OPEN_SQUARE_BRACKET="[",t.CLOSE_SQUARE_BRACKET="]",t))(bn||{}),ru=(t=>(t.PERCENTAGE="%",t.POUND="#",t))(ru||{});const ITe=new Set(["%","#"]);var pi=(t=>(t.AT="@",t.MINUS="-",t))(pi||{});const DB=[...Object.values(Rt),...Object.values(sa),...Object.values(bn),...Object.values(ru),...Object.values(pi)];function i7(t){return DB.includes(t)}function ATe(t){for(const e of DB)if(t.indexOf(e)>-1)return!0;return!1}function TTe(t){return t[0]==="'"&&t[t.length-1]==="'"?t.substring(1,t.length-1):t}function RB(t){const e={};return Object.keys(t).forEach(n=>{const r=t[n];if(r==null)return!0;e[n]==null&&(e[n]={}),Object.keys(r).forEach(i=>{const o=r[i];e[n][i]=new Ye(o)})}),e}const BE={id:"formula.mutation.register-function",type:ue.MUTATION,handler:()=>!0};let A8=class{constructor(e){Fe(this,"_cache"),this._cache=new r5(e)}set(e,n){const r=this._hash(e);this._cache.set(r,n)}get(e){const n=this._hash(e);return this._cache.get(n)}clear(){this._cache.clear()}_hash(e){return OW(e)}};const sl='\\[([^\\[\\]\\/?:"<>|*\\\\]+)\\]',wTe=/[^0-9]/g,LTe=/[^A-Za-z]/g;function o7(t){const e=t[0]==="$",n=t.substring(1).indexOf("$")>-1;return e&&n?Hn.ALL:e?Hn.COLUMN:n?Hn.ROW:Hn.NONE}function OTe(t){const e=t.split("!");e.length>1&&(t=e[e.length-1]);const n=t.split(":");return n.length>1?{startAbsoluteRefType:o7(n[0]),endAbsoluteRefType:o7(n[1])}:{startAbsoluteRefType:o7(n[0])}}function tT(t=Hn.NONE){let e="",n="";return t===Hn.ROW?e="$":t===Hn.COLUMN?n="$":t===Hn.ALL&&(e="$",n="$"),{rowAbsoluteString:e,columnAbsoluteString:n}}function p1(t){const{startColumn:e,startRow:n,endColumn:r,endRow:i,startAbsoluteRefType:o,endAbsoluteRefType:a,rangeType:s=ct.NORMAL}=t,u=tT(o),l=tT(a);if(s===ct.ROW||s===ct.ALL){const m=`${u.rowAbsoluteString}${n+1}`,f=`${l.rowAbsoluteString}${i+1}`;return`${m}:${f}`}if(s===ct.COLUMN){const m=`${u.columnAbsoluteString}${Ie.chatAtABC(e)}`,f=`${l.columnAbsoluteString}${Ie.chatAtABC(r)}`;return`${m}:${f}`}const c=`${u.columnAbsoluteString}${Ie.chatAtABC(e)}${u.rowAbsoluteString}${n+1}`,d=`${l.columnAbsoluteString}${Ie.chatAtABC(r)}${l.rowAbsoluteString}${i+1}`;return c===d?c:`${c}:${d}`}function PTe(t,e){return A9(t)?`'${t}'!${p1(e)}`:`${t}!${p1(e)}`}function MTe(t,e,n){return A9(t)||A9(e)?`'[${t}]${e}'!${p1(n)}`:`[${t}]${e}!${p1(n)}`}function Y6(t){const{unitId:e,sheetName:n,range:r}=t;return e!=null&&e.length>0&&n!=null&&n.length>0?MTe(e,n,r):n!=null&&n.length>0?PTe(n,r):p1(r)}function Ag(t){const e=Number.parseInt(t.replace(wTe,""))-1,n=Ie.ABCatNum(t.replace(LTe,"")),r=o7(t);return{row:e,column:n,absoluteRefType:r}}function IB(t){const e=new RegExp(sl).exec(t);let n="";e!=null&&(n=e[0].trim(),n=n.slice(1,n.length-1),t=t.replace(new RegExp(sl),""));const r=t.indexOf("!");let i="",o="";return r>-1?(i=t.substring(0,r),i[0]==="'"&&i[i.length-1]==="'"&&(i=i.substring(1,i.length-1)),o=t.substring(r)):o=t,{refBody:o,sheetName:i,unitId:n}}function Ms(t){const{refBody:e,sheetName:n,unitId:r}=IB(t),i=e.indexOf(":");if(i===-1){const h=Ag(e),p=h.row,v=h.column,g=h.absoluteRefType;return{unitId:r,sheetName:n,range:{startRow:p,startColumn:v,endRow:p,endColumn:v,startAbsoluteRefType:g,endAbsoluteRefType:g}}}const o=e.substring(0,i),a=e.substring(i+1),s=Ag(o),u=Ag(a),l=s.row,c=s.column,d=u.row,m=u.column;let f=ct.NORMAL;return isNaN(l)&&isNaN(d)?f=ct.COLUMN:isNaN(c)&&isNaN(m)&&(f=ct.ROW),{unitId:r,sheetName:n,range:{startRow:l,startColumn:c,endRow:d,endColumn:m,startAbsoluteRefType:s.absoluteRefType,endAbsoluteRefType:u.absoluteRefType,rangeType:f}}}function A9(t){return t.length===0?!1:!!(ATe(t)||NTe(t)||xTe(t)||FTe(t)||/[\s!$%^&*()+\-=\[\]{};':"\\|,.<>\/?]/.test(t))}function NTe(t){const e=t.match(/[1-9][0-9]{0,6}/);return/^[A-Z]+[1-9][0-9]{0,6}$/.test(t)&&e!==null&&Number.parseInt(e[0],10)<=1048576}function xTe(t){return/^(R(-?[0-9]+)?C(-?[0-9]+)?|C(-?[0-9]+)?|R(-?[0-9]+)?)$/.test(t)}function FTe(t){return!new RegExp("^\\p{Letter}","u").test(t.charAt(0))}const dd="((?![\\[\\]\\/?*\\\\]).)*!",ul="$",UE="\\s*?:\\s*?",$_=`\\${ul}?[A-Za-z]+\\${ul}?[0-9]+`,$Te=`^(${pi.AT})?(${sl})?(${dd})?${$_}${UE}${$_}$`,T8=`^(${sl})?(${dd})?\\s*?${$_}(${ru.POUND})?$`,AB=`^(${sl})?(${dd})?\\${ul}?[0-9]+${UE}\\${ul}?[0-9]+$`,TB=`^(${sl})?(${dd})?\\${ul}?[A-Za-z]+${UE}\\${ul}?[A-Za-z]+$`,kTe=`^(${sl})?(${dd})?\\s*?\\${ul}?[0-9]+$`,BTe=`^(${sl})?(${dd})?\\s*?\\${ul}?[A-Za-z]+$`,wB="[.*?]",UTe="{.*?}";function VTe(t){return new RegExp(T8).test(t)||new RegExp($Te).test(t)||new RegExp(AB).test(t)||new RegExp(TB).test(t)}const Jl="P_1",el="R_1",k0="L_1",Rf="LR_1",LB="LO_1",HTe="LET",xm="LAMBDA";var ni=(t=>(t[t.NORMAL=0]="NORMAL",t[t.NUMBER=1]="NUMBER",t[t.STRING=2]="STRING",t[t.FUNCTION=3]="FUNCTION",t[t.REFERENCE=4]="REFERENCE",t[t.ARRAY=5]="ARRAY",t))(ni||{});function VE(t){let e="";for(const n of t)typeof n=="string"?e+=n:e+=n.token;return e}class Fn{constructor(){Fe(this,"_parent"),Fe(this,"_token",el),Fe(this,"_children",[]),Fe(this,"_lambdaId"),Fe(this,"_functionDefinitionPrivacyVar"),Fe(this,"_lambdaParameter",""),Fe(this,"_startIndex",-1),Fe(this,"_endIndex",-1)}dispose(){var e;this._children.forEach(n=>{typeof n!="string"&&n.dispose()}),(e=this._functionDefinitionPrivacyVar)==null||e.clear(),this._parent=null}getStartIndex(){return this._startIndex}getLambdaId(){return this._lambdaId}setLambdaId(e){this._lambdaId=e}getFunctionDefinitionPrivacyVar(){return this._functionDefinitionPrivacyVar}setLambdaPrivacyVar(e){this._functionDefinitionPrivacyVar=e}getLambdaParameter(){return this._lambdaParameter}setLambdaParameter(e){this._lambdaParameter=e}getParent(){return this._parent}setParent(e){this._parent=e}getChildren(){return this._children}setChildren(e){this._children=e}addChildren(e){this._children.push(e)}addChildrenFirst(e){this._children.unshift(e)}getToken(){return this._token}setToken(e){this._token=e}setIndex(e,n){this._startIndex=e,this._endIndex=n}replaceChild(e,n){const r=this._getIndexInParent(e);r!=null&&(this.getChildren().splice(r,1,n),n.setParent(this))}changeToParent(e){const n=this.getParent();n&&n.removeChild(this),this.setParent(e),e.getChildren().push(this)}removeChild(e){const n=this._getIndexInParent(e);n!=null&&this.getChildren().splice(n,1)}serialize(){const e=this.getToken(),n=this.getChildren(),r=[],i=n.length;for(let o=0;o<i;o++){const a=n[o];a instanceof Fn?r.push(a.serialize()):r.push(a)}return{token:e,st:this._startIndex,ed:this._endIndex,children:r}}_getIndexInParent(e){const n=this.getChildren(),r=n.length;for(let i=0;i<r;i++)if(n[i]===e)return i}}const OB=1e5,Tg=new A8(OB),wg=new A8(OB);let E1=class extends We{constructor(){super(...arguments),Fe(this,"_currentLexerNode",new Fn),Fe(this,"_upLevel",0),Fe(this,"_segment",""),Fe(this,"_bracketState",[]),Fe(this,"_squareBracketState",0),Fe(this,"_bracesState",0),Fe(this,"_singleQuotationState",0),Fe(this,"_doubleQuotationState",0),Fe(this,"_lambdaState",!1),Fe(this,"_colonState",!1),Fe(this,"_tableBracketState",!1)}dispose(){this._resetTemp(),this._currentLexerNode.dispose(),Tg.clear(),wg.clear()}getUpLevel(){return this._upLevel}isColonClose(){return this._colonState===!1}isColonOpen(){return this._colonState===!0}isDoubleQuotationClose(){return this._doubleQuotationState===0}isLambdaOpen(){return this._lambdaState===!0}isLambdaClose(){return this._lambdaState===!1}isSingleQuotationClose(){return this._singleQuotationState===0}isBracesClose(){return this._bracesState===0}isBracketClose(){return this._bracketState.length===0}isSquareBracketClose(){return this._squareBracketState===0}getCurrentLexerNode(){return this._currentLexerNode}getFunctionAndParameter(e,n){const r=this._getCurrentParamIndex(e,n);if(r==null||r===k.VALUE)return;const i=r[0];if(typeof i=="string")return;let o=i.getParent(),a=i;for(;o;){const s=o.getToken();if(s!==Jl&&!i7(s)&&o.getStartIndex()!==-1){const u=o.getChildren().indexOf(a);return{functionName:s,paramIndex:u}}a=o,o=o.getParent()}}moveFormulaRefOffset(e,n,r){const i=this.sequenceNodesBuilder(e);if(i==null)return e;const o=[];for(let a=0,s=i.length;a<s;a++){const u=i[a];if(typeof u=="string"||u.nodeType!==ni.REFERENCE){o.push(u);continue}const{token:l}=u,c=Ms(l),{range:d,sheetName:m,unitId:f}=c,h=ht.moveOffset(d,n,r);let p="";TW(h)?p=Y6({range:h,unitId:f,sheetName:m}):p=k.REF,o.push({...u,token:p})}return`=${VE(o)}`}checkIfAddBracket(e){let n=0,r=e.length-1,i=e[r];for(;(i===bn.CLOSE_BRACKET||i===" ")&&r>=0;)i===bn.CLOSE_BRACKET&&n++,i=e[--r];const o=this._getCurrentParamIndex(e,e.length-2);if(o==null||o===k.VALUE)return 0;const a=o[0];if(typeof a=="string")return 0;let s=a.getParent(),u=0;for(o[1]===bn.OPEN_BRACKET&&u++;s;){const l=s.getToken();l!==Jl&&l!==bn.COLON&&s.getStartIndex()!==-1&&l.toUpperCase()!==xm&&(n===0?u+=1:n--),s=s.getParent()}return u}sequenceNodesBuilder(e){const n=wg.get(e);if(n)return[...n];const r=this._getSequenceArray(e);if(r.length===0)return;const i=this.getSequenceNode(r);return wg.set(e,[...i]),i}getSequenceNode(e){const n=[];let r=!1;for(let i=0,o=e.length;i<o;i++){const a=e[i],s=e[i-1],{segment:u,currentString:l,cur:c}=a;if(l===bn.DOUBLE_QUOTATION&&(r=!0),(u!==""||i===0)&&i!==o-1){n.push(l);continue}let d=(s==null?void 0:s.segment)||"";const m=i-d.length;let f=i-1;const h=i-1;if(i===o-1&&this._isLastMergeString(l)&&(d+=l,f+=1),d===""||r7.has(d)){n.push(l);continue}const p=d.trim(),v=this._replacePrefixString(p);r===!0&&p[p.length-1]===bn.DOUBLE_QUOTATION?(r=!1,this._pushSequenceNode(n,{nodeType:ni.STRING,token:d,startIndex:m,endIndex:f},h)):new RegExp(T8).test(v)?this._pushSequenceNode(n,{nodeType:ni.REFERENCE,token:d,startIndex:m,endIndex:f},h):Ie.isStringNumber(p)?this._pushSequenceNode(n,{nodeType:ni.NUMBER,token:d,startIndex:m,endIndex:f},h):p.length>0&&this._pushSequenceNode(n,{nodeType:ni.FUNCTION,token:d,startIndex:m,endIndex:f},h),(i!==o-1||!this._isLastMergeString(l))&&n.push(l)}return this._mergeSequenceNodeReference(n)}_getCurrentParamIndex(e,n){return this._nodeMaker(e,void 0,n)}_isLastMergeString(e){return e===bn.DOUBLE_QUOTATION||Ie.isStringNumber(e)||!i7(e)}_mergeSequenceNodeReference(e){const n=[],r=e.length;let i=0;for(;i<r;){const o=e[i];if(typeof o=="string"){const a=e[i-1];if(o.trim()===bn.CLOSE_BRACES&&a!=null&&typeof a!="string"&&a.nodeType===ni.FUNCTION&&a.token.trim().substring(0,1)===bn.OPEN_BRACES){a.nodeType=ni.ARRAY,a.token+=o,a.endIndex+=o.length,i++;continue}n.push(o)}else{const a=e[i+1],s=e[i+2];a===bn.COLON&&typeof o!="string"&&s!=null&&typeof s!="string"&&VTe((o.token+a+s.token).trim())&&(o.nodeType=ni.REFERENCE,o.token+=a+s.token,o.endIndex=s.endIndex,i+=2),n.push(o)}i++}return n}_pushSequenceNode(e,n,r){const i=r-n.startIndex+1;e.splice(e.length-i,i,n)}_replacePrefixString(e){return e.replace(new RegExp(pi.AT,"g"),"").replace(new RegExp(pi.MINUS,"g"),"")}nodeMakerTest(e){return this._nodeMaker(e)}treeBuilder(e,n=!0,r){if(n===!0){const l=Tg.get(e);if(l)return l}this._resetCurrentLexerNode(),this._currentLexerNode.setToken(el);const i=[];let o=this._nodeMaker(e,i);if(o===k.VALUE||i.length===0)return o;let a=!1,s="";if(r){const{hasDefinedName:l,sequenceString:c}=r(i);a=l,s=c}if(a&&(this._resetCurrentLexerNode(),this._currentLexerNode.setToken(el),o=this._nodeMaker(`=${s}`),o===k.VALUE))return o;const u=this._getTopNode(this._currentLexerNode);return u&&(this._currentLexerNode=u),n&&(this._suffixExpressionHandler(this._currentLexerNode),Tg.set(e,this._currentLexerNode)),this._currentLexerNode}_suffixExpressionHandler(e){var n,r;const i=e.getChildren();if(!i)return;const o=i.length,a=[],s=[];for(let u=0;u<o;u++){const l=i[u];if(l instanceof Fn)this._suffixExpressionHandler(l),a.push(l);else{const c=l.trim();if(c==="")continue;if(E6.has(c)){for(;s.length>0;){const d=(n=s[s.length-1])==null?void 0:n.trim();if(!d||d===bn.OPEN_BRACKET)break;const m=r7.get(d),f=r7.get(c);if(!m||!f)break;if(f>=m)a.push(s.pop());else break}s.push(l)}else if(c===bn.OPEN_BRACKET)s.push(l);else if(c===bn.CLOSE_BRACKET)for(;s.length>0;){const d=(r=s[s.length-1])==null?void 0:r.trim();if(!d)break;if(d===bn.OPEN_BRACKET){s.pop();break}a.push(s.pop())}else a.push(l)}}for(;s.length>0;)a.push(s.pop());e.setChildren(a)}_resetCurrentLexerNode(){this._currentLexerNode=new Fn}_resetSegment(){this._segment=""}_openBracket(e=0){this._bracketState.push(e)}_closeBracket(){this._bracketState.pop()}_openSquareBracket(){this._squareBracketState+=1}_closeSquareBracket(){this._squareBracketState-=1}_getCurrentBracket(){const e=this._bracketState;return e[e.length-1]}_openBraces(){this._bracesState+=1}_closeBraces(){this._bracesState-=1}_openSingleQuotation(){this._singleQuotationState+=1}_closeSingleQuotation(){this._singleQuotationState-=1}_openDoubleQuotation(){this._doubleQuotationState+=1}_closeDoubleQuotation(){this._doubleQuotationState-=1}_openLambda(){this._lambdaState=!0}_closeLambda(){this._lambdaState=!1}_openColon(e){this._upLevel=e,this._colonState=!0}_closeColon(){this._upLevel=0,this._colonState=!1}_isTableBracket(){return this._tableBracketState}_openTableBracket(){this._tableBracketState=!0}_closeTableBracket(){this._tableBracketState=!1}_getLastChildCurrentLexerNode(){const e=this._currentLexerNode.getChildren();if(e&&e.length>0){const n=e[e.length-1];if(n instanceof Fn)return n}return!1}_getLastChildCurrent(){const e=this._currentLexerNode.getChildren();return e&&e.length>0?e[e.length-1]:!1}_setParentCurrentLexerNode(){const e=this._currentLexerNode.getParent();return e?(this._currentLexerNode=e,!0):!1}_setAncestorCurrentLexerNode(){var e,n,r,i,o,a;const s=(e=this._currentLexerNode)==null?void 0:e.getParent();let u=!1;if(s&&s.getToken()===k0){if((n=s==null?void 0:s.getParent())!=null&&n.getParent()){const l=(i=(r=this._currentLexerNode.getParent())==null?void 0:r.getParent())==null?void 0:i.getParent();l&&(this._currentLexerNode=l),u=!0}}else if(s!=null&&s.getParent()){const l=(o=this._currentLexerNode.getParent())==null?void 0:o.getParent();l&&(this._currentLexerNode=l),u=!0}for(let l=0;l<this._upLevel;l++){const c=(a=this._currentLexerNode)==null?void 0:a.getParent();c&&(this._currentLexerNode=c),this._currentLexerNode?u=!0:u=!1}return u}_segmentCount(){return this._segment.trim().length}_pushSegment(e){this._segment+=e}_pushNodeToChildren(e,n=!1){if(e!==""){const r=this._currentLexerNode.getChildren();if(!(e instanceof Fn)&&this.isColonOpen()){const i=new Fn;i.setToken(e),i.setParent(this._currentLexerNode),e=i}n?r.unshift(e):r.push(e)}this.isColonOpen()&&(this._setAncestorCurrentLexerNode(),this._closeColon())}_setCurrentLexerNode(e,n=!1){this._pushNodeToChildren(e,n),e.setParent(this._currentLexerNode),this._currentLexerNode=e}_newAndPushCurrentLexerNode(e,n,r=!1){const i=new Fn;i.setToken(e),i.setIndex(n-e.length,n-1),this._setCurrentLexerNode(i,r)}_getTopNode(e){let n=e;for(;n!=null&&n.getParent();)n=n.getParent();return n}_removeLastChild(){this._currentLexerNode.getChildren().splice(-1)}_findPreviousToken(e,n){for(;n>=0;){const r=e[n];if(r!==" ")return r;n--}}_negativeCondition(e){return!!(E6.has(e)||e===bn.OPEN_BRACKET||e===bn.COMMA||e==="")}_getSequenceArray(e){const n=[];return this._nodeMaker(e,n),n}_resetTemp(){this._currentLexerNode=new Fn,this._upLevel=0,this._segment="",this._bracketState=[],this._bracesState=0,this._singleQuotationState=0,this._doubleQuotationState=0,this._lambdaState=!1,this._colonState=!1}_checkSimilarErrorToken(e,n,r){if(e!==ru.POUND)return!0;let i=r[++n];for(;i===" ";)i=r[++n];return!!i7(i)}_nodeMaker(e,n,r){e.substring(0,1)===sa.EQUALS&&(e=e.substring(1));const i=e.split(""),o=i.length;let a=0;for(this._resetTemp();a<o;){const s=i[a];if(r===a)return[this._currentLexerNode,s];if(s===bn.OPEN_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())if(this._segmentCount()>0||this.isLambdaOpen()){this.isLambdaClose()&&(this._newAndPushCurrentLexerNode(this._segment,a),this._resetSegment()),this._openBracket(1),this._closeLambda();const u=i[a+1];if(u&&u===bn.CLOSE_BRACKET){if(!this._setParentCurrentLexerNode()&&a!==o-1)return k.VALUE;a++}else u&&this._newAndPushCurrentLexerNode(Jl,a)}else this._pushNodeToChildren(s),this._openBracket(0);else if(s===bn.CLOSE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){this._pushNodeToChildren(this._segment),this._resetSegment();const u=this._getCurrentBracket();if(u===0)this._pushNodeToChildren(s);else if(u===1){const l=i[a+1];if(l&&l===bn.OPEN_BRACKET){if(!this._setParentCurrentLexerNode()&&a!==o-1)return k.VALUE;this._newAndPushCurrentLexerNode(k0,a,!0),this._openLambda()}else if(!this._setAncestorCurrentLexerNode()&&a!==o-1)return k.VALUE}else return k.VALUE;this._closeBracket()}else if(s===bn.OPEN_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(s),this._openBraces();else if(s===bn.CLOSE_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(s),this._pushNodeToChildren(this._segment),this._resetSegment(),this._closeBraces();else if(s===bn.OPEN_SQUARE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._segment.length>0&&this._openTableBracket(),this._pushSegment(s),this._openSquareBracket();else if(s===bn.CLOSE_SQUARE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._closeSquareBracket(),this.isSquareBracketClose()?(this._pushSegment(s),this._isTableBracket()&&(this._pushNodeToChildren(this._segment),this._resetSegment()),this._closeTableBracket()):this._pushSegment(s);else if(s===bn.DOUBLE_QUOTATION&&this.isSingleQuotationClose()&&this.isBracesClose()&&this.isSquareBracketClose()){if(this.isDoubleQuotationClose())this._openDoubleQuotation();else{const u=i[a+1];u&&u===bn.DOUBLE_QUOTATION?a++:this._closeDoubleQuotation()}this._pushSegment(s)}else if(s===bn.SINGLE_QUOTATION&&this.isDoubleQuotationClose()){if(this.isSingleQuotationClose())this._openSingleQuotation();else{const u=i[a+1];u&&u===bn.SINGLE_QUOTATION?a++:this._closeSingleQuotation()}this._pushSegment(s)}else if(s===bn.COMMA&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose()&&this.isSquareBracketClose()){const u=this._getCurrentBracket();if(u===1||u==null){if(this._pushNodeToChildren(this._segment),this._resetSegment(),!this._setParentCurrentLexerNode()&&a!==o-1&&u!=null)return k.VALUE;this._newAndPushCurrentLexerNode(Jl,a)}else return k.VALUE}else if(s===bn.COLON&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose()&&this.isSquareBracketClose()){const u=new Fn;u.setToken(s);const l=new Fn;l.setToken(Jl),l.setParent(u);const c=new Fn;c.setToken(Jl),c.setParent(u),u.getChildren().push(l,c);let d=u,m=0;if(this._segmentCount()>0){let f,h,p=0;const v=this._segment.trim(),g=v[0],b=v[1];if(g===pi.MINUS&&(f=new Fn,f.setToken(pi.MINUS),p++),(g===pi.AT||b===pi.AT)&&(h=new Fn,h.setToken(pi.AT),f&&(f.addChildren(h),h.setParent(f)),p++),p>0&&(this._segment=v.slice(p)),m=p,h)if(h.addChildren(u),u.setParent(h),h.getParent()){const S=h.getParent();S&&(d=S)}else d=h;else f&&(d=f,f.addChildren(u),u.setParent(f));const C=new Fn;C.setToken(this._segment),C.setParent(l),l.getChildren().push(C),this._resetSegment()}else{const f=this._getLastChildCurrentLexerNode();f&&f.changeToParent(l)}this._setCurrentLexerNode(d),this._currentLexerNode=c,this._openColon(m)}else if(ITe.has(s)&&this._checkSimilarErrorToken(s,a,i)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isSquareBracketClose()){this._pushNodeToChildren(this._segment);const u=new Fn;u.setToken(s);const l=this._getLastChildCurrent();l instanceof Fn?l.changeToParent(u):l!==!1&&(u.getChildren().push(l),this._removeLastChild()),this._pushNodeToChildren(u),u.setParent(this._currentLexerNode),this._resetSegment()}else if(E6.has(s)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isSquareBracketClose()){let u=this._segment.trim();if(s===sa.MINUS&&u===""){const l=this._findPreviousToken(i,a-1)||"";if(this._negativeCondition(l)){this._pushSegment(sa.MINUS),n==null||n.push({segment:this._segment,currentString:s,cur:a,currentLexerNode:this._currentLexerNode}),a++;continue}}else this._segment.length>0&&u===""?u=this._segment:(this._pushNodeToChildren(this._segment),u="");if(s===sa.LESS_THAN||s===sa.GREATER_THAN){const l=i[a+1];l&&E6.has(s+l)?(this._pushNodeToChildren(u+s+l),a++):this._pushNodeToChildren(u+s)}else this._pushNodeToChildren(u+s);this._resetSegment()}else this._pushSegment(s);n==null||n.push({segment:this._segment,currentString:s,cur:a,currentLexerNode:this._currentLexerNode}),a++}this._pushNodeToChildren(this._segment)}};var jTe=Object.defineProperty,zTe=Object.getOwnPropertyDescriptor,WTe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zTe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&jTe(e,n,i),i},nT=(t,e)=>(n,r)=>e(n,r,t);let Ai=class extends We{constructor(e,n){super(),Fe(this,"_formulaData",{}),Fe(this,"_arrayFormulaRange",{}),Fe(this,"_arrayFormulaCellData",{}),Fe(this,"_numfmtItemMap",{}),this._currentUniverService=e,this._lexerTreeBuilder=n}clearPreviousArrayFormulaCellData(e){Object.keys(e).forEach(n=>{const r=e[n];if(r==null)return!0;Object.keys(r).forEach(i=>{var o,a,s,u;const l=r[i],c=(a=(o=this._arrayFormulaRange)==null?void 0:o[n])==null?void 0:a[i];if(c==null)return!0;let d=new Ye;((s=this._arrayFormulaCellData[n])==null?void 0:s[i])!=null&&(d=new Ye((u=this._arrayFormulaCellData[n])==null?void 0:u[i])),l.forValue((m,f)=>{var h;const p=(h=c==null?void 0:c[m])==null?void 0:h[f];if(p==null)return!0;const{startRow:v,startColumn:g,endRow:b,endColumn:C}=p;for(let S=v;S<=b;S++)for(let E=g;E<=C;E++)d.setValue(S,E,null)}),this._arrayFormulaCellData[n]&&(this._arrayFormulaCellData[n][i]=d.getData())})})}mergeArrayFormulaCellData(e){Object.keys(e).forEach(n=>{const r=e[n];if(r==null)return!0;this._arrayFormulaRange[n]==null&&(this._arrayFormulaRange[n]={}),this._arrayFormulaCellData[n]==null&&(this._arrayFormulaCellData[n]={}),Object.keys(r).forEach(i=>{var o,a,s,u;const l=r[i];let c=new Ye,d=new Ye;((o=this._arrayFormulaRange[n])==null?void 0:o[i])!=null&&(c=new Ye((a=this._arrayFormulaRange[n])==null?void 0:a[i])),((s=this._arrayFormulaCellData[n])==null?void 0:s[i])!=null&&(d=new Ye((u=this._arrayFormulaCellData[n])==null?void 0:u[i])),l.forValue((m,f)=>{const h=c==null?void 0:c.getValue(m,f);if(h==null)return!0;const{startRow:p,startColumn:v,endRow:g,endColumn:b}=h;for(let C=p;C<=g;C++)for(let S=v;S<=b;S++)d.setValue(C,S,null)}),l.forValue((m,f,h)=>{d.setValue(m,f,h)}),this._arrayFormulaCellData[n]&&(this._arrayFormulaCellData[n][i]=d.getData())})})}getFormulaData(){return this._formulaData}setFormulaData(e){this._formulaData=e}getArrayFormulaRange(){return this._arrayFormulaRange}setArrayFormulaRange(e){this._arrayFormulaRange=e}getArrayFormulaCellData(){return this._arrayFormulaCellData}setArrayFormulaCellData(e){this._arrayFormulaCellData=e}getNumfmtItemMap(){return this._numfmtItemMap}getNumfmtValue(e,n,r,i){var o,a,s;return(s=(a=(o=this._numfmtItemMap[e])==null?void 0:o[n])==null?void 0:a[r])==null?void 0:s[i]}setNumfmtItemMap(e){this._numfmtItemMap=e}updateNumfmtItemMap(e){Object.keys(e).forEach(n=>{const r=e[n];if(r==null)return!0;this._numfmtItemMap[n]==null&&(this._numfmtItemMap[n]={}),Object.keys(r).forEach(i=>{const o=r[i],a=new Ye(o);this._numfmtItemMap[n][i]==null&&(this._numfmtItemMap[n][i]={}),a.forValue((s,u,l)=>{this._numfmtItemMap[n][i][s]==null&&(this._numfmtItemMap[n][i][s]={}),this._numfmtItemMap[n][i][s][u]=l})})})}mergeArrayFormulaRange(e){Object.keys(e).forEach(n=>{const r=e[n];if(r==null)return!0;this._arrayFormulaRange[n]||(this._arrayFormulaRange[n]={}),Object.keys(r).forEach(i=>{var o,a;const s=new Ye(r[i]);let u=new Ye;(o=this._arrayFormulaRange[n])!=null&&o[i]&&(u=new Ye((a=this._arrayFormulaRange[n])==null?void 0:a[i])),s.forValue((l,c,d)=>{u.setValue(l,c,d)}),this._arrayFormulaRange[n]&&(this._arrayFormulaRange[n][i]=u.getData())})})}deleteArrayFormulaRange(e,n,r,i){var o;const a=(o=this._arrayFormulaRange[e])==null?void 0:o[n];if(a==null)return;const s=new Ye(a);s.getValue(r,i)&&(s.realDeleteValue(r,i),this._arrayFormulaRange[e]&&(this._arrayFormulaRange[e][n]=s.getData()))}initFormulaData(){this._currentUniverService.getAllUniverSheetsInstance();const e=this._currentUniverService.getCurrentUniverSheetInstance(),n=e.getUnitId();this._formulaData[n]={},e.getSheets().forEach(r=>{const i=r.getCellMatrix(),o=r.getSheetId();PB(this._formulaData,n,o,i)})}getCalculateData(){const e=this._currentUniverService.getAllUniverSheetsInstance(),n={},r={};for(const i of e){const o=i.getUnitId(),a=i.getSheets(),s={},u={};for(const l of a){const c=l.getSheetId(),d=l.getConfig();s[c]={cellData:new Ye(d.cellData),rowCount:d.rowCount,columnCount:d.columnCount},u[l.getName()]=l.getSheetId()}n[o]=s,r[o]=u}return{allUnitData:n,unitSheetNameMap:r}}updateFormulaData(e,n,r){const i=new Ye(r),o=this.getFormulaIdMap(e,n),a=new Map,s=this._formulaData;s[e]==null&&(s[e]={});const u=s[e];u[n]==null&&(u[n]={});const l=new Ye(u[n]);i.forValue((c,d,m)=>{const f=(m==null?void 0:m.f)||"",h=(m==null?void 0:m.si)||"",p=$i(f),v=La(h);if(p&&v)l.setValue(c,d,{f,si:h}),o.set(h,{f,r:c,c:d});else if(p&&!v)l.setValue(c,d,{f});else if(!p&&v)l.setValue(c,d,{f:"",si:h});else if(!p&&!v&&l.getValue(c,d)){const g=l.getValue(c,d),b=(g==null?void 0:g.f)||"",C=(g==null?void 0:g.si)||"";$i(b)&&La(C)&&a.set(C,b),l.realDeleteValue(c,d)}}),l.forValue((c,d,m)=>{const f=(m==null?void 0:m.f)||"",h=(m==null?void 0:m.si)||"";if(La(h)){const p=o.get(h),v=a.get(h);if(p&&!$i(f)){const g=p.f,b=d-p.c,C=c-p.r;l.setValue(c,d,{f:g,si:h,x:b,y:C})}else if(typeof v=="string"){const g=m.x||0,b=m.y||0,C=this._lexerTreeBuilder.moveFormulaRefOffset(v,g,b);a.set(h,{r:c,c:d,f:C}),l.setValue(c,d,{f:C,si:h})}else if(typeof v=="object"){const g=d-v.c,b=c-v.r;l.setValue(c,d,{f:v.f,si:h,x:g,y:b})}}})}updateArrayFormulaRange(e,n,r){var i;const o=(i=this._arrayFormulaRange[e])==null?void 0:i[n];if(!o)return;const a=new Ye(o);new Ye(r).forValue((s,u,l)=>{if((a==null?void 0:a.getValue(s,u))==null)return!0;const c=(l==null?void 0:l.f)||"",d=(l==null?void 0:l.si)||"",m=$i(c),f=La(d);!m&&!f&&a.realDeleteValue(s,u)})}updateArrayFormulaCellData(e,n,r){var i,o;const a=(i=this._arrayFormulaRange[e])==null?void 0:i[n];if(!a)return;const s=new Ye(a),u=(o=this._arrayFormulaCellData[e])==null?void 0:o[n];if(!u)return;const l=new Ye(u);new Ye(r).forValue((c,d,m)=>{const f=s==null?void 0:s.getValue(c,d);if(f==null)return!0;const h=(m==null?void 0:m.f)||"",p=(m==null?void 0:m.si)||"",v=$i(h),g=La(p);if(!v&&!g){const{startRow:b,startColumn:C,endRow:S,endColumn:E}=f;for(let y=b;y<=S;y++)for(let D=C;D<=E;D++)l.realDeleteValue(y,D)}})}updateNumfmtData(e,n,r){var i,o;const a=(i=this._arrayFormulaRange[e])==null?void 0:i[n],s=new Ye(a),u=(o=this._numfmtItemMap[e])==null?void 0:o[n];if(!u)return;const l=new Ye(u);new Ye(r).forValue((c,d,m)=>{const f=(m==null?void 0:m.f)||"",h=(m==null?void 0:m.si)||"",p=$i(f),v=La(h);if(!p&&!v){l.setValue(c,d,null);const g=s.getValue(c,d);if(g){const{startRow:b,startColumn:C,endRow:S,endColumn:E}=g;for(let y=b;y<=S;y++)for(let D=C;D<=E;D++)l.setValue(y,D,null)}}})}getFormulaItemBySId(e,n,r){const i=this._formulaData;if(i[r]==null)return null;const o=i[r];if((o==null?void 0:o[n])==null)return null;const a=new Ye(o[n]);let s=null;return a.forValue((u,l,c)=>{const{f:d,si:m,x:f=0,y:h=0}=c;if(m===e&&d.length>0&&f===0&&h===0)return s=c,!1}),s}getFormulaDataItem(e,n,r,i){var o,a,s,u;return(u=(s=(a=(o=this._formulaData)==null?void 0:o[i])==null?void 0:a[r])==null?void 0:s[e])==null?void 0:u[n]}getFormulaIdMap(e,n){const r=new Map,i=this._formulaData;if(i[e]==null)return r;const o=i[e];return(o==null?void 0:o[n])==null||new Ye(o[n]).forValue((a,s,u)=>{const l=(u==null?void 0:u.f)||"",c=(u==null?void 0:u.si)||"",d=(u==null?void 0:u.x)||0,m=(u==null?void 0:u.y)||0;$i(l)&&La(c)&&d===0&&m===0&&r.set(c,{f:l,r:a,c:s})}),r}};Ai=WTe([nT(0,ae),nT(1,K(E1))],Ai);function PB(t,e,n,r){const i=new Map,o=new Ye;r.forValue((a,s,u)=>{const l=(u==null?void 0:u.f)||"",c=(u==null?void 0:u.si)||"",d=$i(l),m=La(c);d&&m?(o.setValue(a,s,{f:l,si:c}),i.set(c,{f:l,r:a,c:s})):d&&!m?o.setValue(a,s,{f:l}):!d&&m&&o.setValue(a,s,{f:"",si:c})}),o.forValue((a,s,u)=>{const l=(u==null?void 0:u.f)||"",c=(u==null?void 0:u.si)||"";if(La(c)&&!$i(l)){const d=i.get(c);if(d){const m=d.f,f=s-d.c,h=a-d.r;o.setValue(a,s,{f:m,si:c,x:f,y:h})}}}),t[e]&&(t[e][n]=o.getData())}const V1={id:"formula.mutation.set-array-formula-data",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(Ai);return n.setArrayFormulaRange(e.arrayFormulaRange),n.setArrayFormulaCellData(e.arrayFormulaCellData),!0}},HE={id:"formula.mutation.set-defined-name",type:ue.MUTATION,handler:()=>!0},jE={id:"formula.mutation.remove-defined-name",type:ue.MUTATION,handler:()=>!0},MB={id:"formula.mutation.set-feature-calculation",type:ue.MUTATION,handler:()=>!0},NB={id:"formula.mutation.remove-feature-calculation",type:ue.MUTATION,handler:()=>!0},T9={id:"formula.mutation.set-formula-calculation-start",type:ue.MUTATION,handler:()=>!0},xB={id:"formula.mutation.set-formula-calculation-stop",type:ue.MUTATION,handler:()=>!0},w9={id:"formula.mutation.set-formula-calculation-notification",type:ue.MUTATION,handler:()=>!0},w8={id:"formula.mutation.set-formula-calculation-result",type:ue.MUTATION,handler:()=>!0},nc={id:"formula.mutation.set-formula-data",type:ue.MUTATION,handler:(t,e)=>(t.get(Ai).setFormulaData(e.formulaData),!0)},FB={id:"formula.mutation.set-other-formula",type:ue.MUTATION,handler:()=>!0},$B={id:"formula.mutation.remove-other-formula",type:ue.MUTATION,handler:()=>!0},YTe={id:"formula.mutation.set-super-table",type:ue.MUTATION,handler:()=>!0},XTe={id:"formula.mutation.remove-super-table",type:ue.MUTATION,handler:()=>!0},kB={id:"formula.mutation.set-super-table-option",type:ue.MUTATION,handler:()=>!0},zE={id:"formula.mutation.unregister-function",type:ue.MUTATION,handler:()=>!0};let L8=class extends We{constructor(){super(...arguments),Fe(this,"pattern","")}getPattern(){return this.pattern}setPattern(e){this.pattern=e}isError(){return!1}isAsyncObject(){return!1}isAsyncArrayObject(){return!1}isReferenceObject(){return!1}isValueObject(){return!1}isEqualType(e){return!1}};var Oc=(t=>(t.FALSE="FALSE",t.TRUE="TRUE",t))(Oc||{}),dc=(t=>(t[t.SUCCESS=0]="SUCCESS",t[t.ERROR=1]="ERROR",t))(dc||{}),ec=(t=>(t.ALL="#All",t.DATA="#Data",t.HEADERS="#Headers",t.TOTALS="#Totals",t))(ec||{}),bs=(t=>(t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK",t))(bs||{});let qTe=class{constructor(){Fe(this,"_cache",new Map),Fe(this,"_continueBuildingCache",new Map)}set(e,n,r,i,o){if(!this.shouldContinueBuildingCache(e,n,r,o))return;let a=this._cache.get(e);a==null&&(a=new Map,this._cache.set(e,a));let s=a.get(n);s==null&&(s=new Map,a.set(n,s));let u=s.get(r);u==null&&(u=new Map,s.set(r,u));let l=u.get(i);l==null&&(l=[],u.set(i,l)),l.push(o)}getCellValuePositions(e,n,r){var i,o;return(o=(i=this._cache.get(e))==null?void 0:i.get(n))==null?void 0:o.get(r)}getCellPositions(e,n,r,i){var o,a,s;return(s=(a=(o=this._cache.get(e))==null?void 0:o.get(n))==null?void 0:a.get(r))==null?void 0:s.get(i)}getCellPosition(e,n,r,i,o,a){const s=this.getCellPositions(e,n,r,i);if(s!=null){for(const u of s)if(u>=o&&u<=a)return u}}setContinueBuildingCache(e,n,r,i,o){let a=this._continueBuildingCache.get(e);a==null&&(a=new Map,this._continueBuildingCache.set(e,a));let s=a.get(n);s==null&&(s=new Map,a.set(n,s));let u=s.get(r);if(u==null){u={startRow:i,endRow:o},s.set(r,u);return}u.startRow=Math.min(u.startRow,i),u.endRow=Math.max(u.endRow,o)}shouldContinueBuildingCache(e,n,r,i){var o,a;const s=(a=(o=this._continueBuildingCache.get(e))==null?void 0:o.get(n))==null?void 0:a.get(r);if(s==null)return!0;const{startRow:u,endRow:l}=s;return!(i>=u&&i<=l)}canUseCache(e,n,r,i,o){var a,s;if(r===-1||i===-1||o===-1)return!1;const u=(s=(a=this._continueBuildingCache.get(e))==null?void 0:a.get(n))==null?void 0:s.get(r);if(u==null)return!1;const{startRow:l,endRow:c}=u;return!(i>c||o<l)}clear(){this._cache.clear(),this._continueBuildingCache.clear()}};const Au=new qTe;var H1=(t=>(t[t.MIN=0]="MIN",t[t.MAX=1]="MAX",t))(H1||{}),go=(t=>(t[t.NORMAL=0]="NORMAL",t[t.MIN=1]="MIN",t[t.MAX=2]="MAX",t))(go||{});function rT(){return Intl&&Intl.Collator?new Intl.Collator(void 0,{numeric:!1}).compare:(t,e)=>t.localeCompare(e)}function GTe(t){return t.indexOf("*")>-1||t.indexOf("?")>-1}function iT(t,e){const n=e.replace(/~?[*?]/g,r=>r.startsWith("~")?`\\${r.substring(1)}`:r==="*"?".*":r==="?"?".":r);return new RegExp(`^${n}$`).test(t)}function oT(t){return t.replace(/~?[*?]/g,e=>e.startsWith("~")?e.substring(1):" ")}function KTe(t,e,n){let r=!1;switch(n){case Rt.EQUALS:r=iT(t,e);break;case Rt.GREATER_THAN:case Rt.GREATER_THAN_OR_EQUAL:r=iT(t,e)||t>oT(e);break;case Rt.LESS_THAN:case Rt.LESS_THAN_OR_EQUAL:r=t<oT(e);break}return r}let qc=class extends L8{constructor(e){super(),this._rawValue=e}isValueObject(){return!0}toUnitRange(){return{range:{startColumn:-1,startRow:-1,endRow:-1,endColumn:-1},sheetId:"",unitId:""}}getValue(){return 0}getArrayValue(){return[]}setValue(e){}setArrayValue(e){}isArray(){return!1}isString(){return!1}isNumber(){return!1}isBoolean(){return!1}isLambda(){return!1}isError(){return!1}isNull(){return!1}sum(){return new j(k.VALUE)}max(){return new j(k.VALUE)}min(){return new j(k.VALUE)}count(){return new j(k.VALUE)}countA(){return new j(k.VALUE)}countBlank(){return new j(k.VALUE)}getNegative(){return new j(k.NAME)}getReciprocal(){return new j(k.NAME)}plus(e){return new j(k.NAME)}minus(e){return new j(k.NAME)}multiply(e){return new j(k.NAME)}divided(e){return new j(k.NAME)}map(e){return new j(k.NAME)}mapValue(e){return new j(k.NAME)}product(e,n){return n(this,e)}compare(e,n){return new j(k.NAME)}isEqual(e){return this.compare(e,Rt.EQUALS)}isNotEqual(e){return this.compare(e,Rt.NOT_EQUAL)}isGreaterThanOrEqual(e){return this.compare(e,Rt.GREATER_THAN_OR_EQUAL)}isLessThanOrEqual(e){return this.compare(e,Rt.LESS_THAN_OR_EQUAL)}isLessThan(e){return this.compare(e,Rt.LESS_THAN)}isGreaterThan(e){return this.compare(e,Rt.GREATER_THAN)}concatenateFront(e){return new j(k.NAME)}concatenateBack(e){return new j(k.NAME)}plusBy(e){return new j(k.NAME)}minusBy(e){return new j(k.NAME)}multiplyBy(e){return new j(k.NAME)}dividedBy(e){return new j(k.NAME)}compareBy(e,n){return new j(k.NAME)}concatenate(e,n=bs.FRONT){let r=this.getValue().toString();if(typeof e=="string")n===bs.FRONT?r=e+r:r+=e;else if(typeof e=="number")n===bs.FRONT?r=e.toString()+r:r+=e.toString();else if(typeof e=="boolean"){const i=e?"TRUE":"FALSE";n===bs.FRONT?r=i+r:r+=i}return r}pow(e){return new j(k.VALUE)}powInverse(e){return new j(k.VALUE)}sqrt(){return new j(k.VALUE)}cbrt(){return new j(k.VALUE)}cos(){return new j(k.VALUE)}acos(){return new j(k.VALUE)}acosh(){return new j(k.VALUE)}sin(){return new j(k.VALUE)}asin(){return new j(k.VALUE)}asinh(){return new j(k.VALUE)}tan(){return new j(k.VALUE)}tanh(){return new j(k.VALUE)}atan(){return new j(k.VALUE)}atan2(e){return new j(k.VALUE)}atan2Inverse(e){return new j(k.VALUE)}atanh(){return new j(k.VALUE)}mean(){return this}median(){return this}var(){return this}std(){return this}log(){return new j(k.VALUE)}log10(){return new j(k.VALUE)}exp(){return new j(k.VALUE)}abs(){return new j(k.VALUE)}round(e){return new j(k.VALUE)}roundInverse(e){return new j(k.VALUE)}floor(e){return new j(k.VALUE)}floorInverse(e){return new j(k.VALUE)}ceil(e){return new j(k.VALUE)}ceilInverse(e){return new j(k.VALUE)}};class j extends qc{constructor(e,n=""){super(e),this._errorType=e,this._errorContent=n}getValue(){return this._errorType}getErrorType(){return this._errorType}getErrorContent(){return this._errorContent}isEqualType(e){return e.getErrorType()===this.getErrorType()}isError(){return!0}}var ZTe=20,QTe=1,Pc=1e6,aT=1e6,JTe=-7,ewe=21,twe=!1,If="[big.js] ",Gc=If+"Invalid ",O8=Gc+"decimal places",nwe=Gc+"rounding mode",BB=If+"Division by zero",_r={},d1=void 0,rwe=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function UB(){function t(e){var n=this;if(!(n instanceof t))return e===d1?UB():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Gc+"value");e=e===0&&1/e<0?"-0":String(e)}iwe(n,e)}n.constructor=t}return t.prototype=_r,t.DP=ZTe,t.RM=QTe,t.NE=JTe,t.PE=ewe,t.strict=twe,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function iwe(t,e){var n,r,i;if(!rwe.test(e))throw Error(Gc+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),i=e.length,r=0;r<i&&e.charAt(r)=="0";)++r;if(r==i)t.c=[t.e=0];else{for(;i>0&&e.charAt(--i)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=i;)t.c[n++]=+e.charAt(r++)}return t}function Kc(t,e,n,r){var i=t.c;if(n===d1&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(nwe);if(e<1)r=n===3&&(r||!!i[0])||e===0&&(n===1&&i[0]>=5||n===2&&(i[0]>5||i[0]===5&&(r||i[1]!==d1))),i.length=1,r?(t.e=t.e-e+1,i[0]=1):i[0]=t.e=0;else if(e<i.length){if(r=n===1&&i[e]>=5||n===2&&(i[e]>5||i[e]===5&&(r||i[e+1]!==d1||i[e-1]&1))||n===3&&(r||!!i[0]),i.length=e,r){for(;++i[--e]>9;)if(i[e]=0,e===0){++t.e,i.unshift(1);break}}for(e=i.length;!i[--e];)i.pop()}return t}function md(t,e,n){var r=t.e,i=t.c.join(""),o=i.length;if(e)i=i.charAt(0)+(o>1?"."+i.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)i="0"+i;i="0."+i}else if(r>0)if(++r>o)for(r-=o;r--;)i+="0";else r<o&&(i=i.slice(0,r)+"."+i.slice(r));else o>1&&(i=i.charAt(0)+"."+i.slice(1));return t.s<0&&n?"-"+i:i}_r.abs=function(){var t=new this.constructor(this);return t.s=1,t};_r.cmp=function(t){var e,n=this,r=n.c,i=(t=new n.constructor(t)).c,o=n.s,a=t.s,s=n.e,u=t.e;if(!r[0]||!i[0])return r[0]?o:i[0]?-a:0;if(o!=a)return o;if(e=o<0,s!=u)return s>u^e?1:-1;for(a=(s=r.length)<(u=i.length)?s:u,o=-1;++o<a;)if(r[o]!=i[o])return r[o]>i[o]^e?1:-1;return s==u?0:s>u^e?1:-1};_r.div=function(t){var e=this,n=e.constructor,r=e.c,i=(t=new n(t)).c,o=e.s==t.s?1:-1,a=n.DP;if(a!==~~a||a<0||a>Pc)throw Error(O8);if(!i[0])throw Error(BB);if(!r[0])return t.s=o,t.c=[t.e=0],t;var s,u,l,c,d,m=i.slice(),f=s=i.length,h=r.length,p=r.slice(0,s),v=p.length,g=t,b=g.c=[],C=0,S=a+(g.e=e.e-t.e)+1;for(g.s=o,o=S<0?0:S,m.unshift(0);v++<s;)p.push(0);do{for(l=0;l<10;l++){if(s!=(v=p.length))c=s>v?1:-1;else for(d=-1,c=0;++d<s;)if(i[d]!=p[d]){c=i[d]>p[d]?1:-1;break}if(c<0){for(u=v==s?i:m;v;){if(p[--v]<u[v]){for(d=v;d&&!p[--d];)p[d]=9;--p[d],p[v]+=10}p[v]-=u[v]}for(;!p[0];)p.shift()}else break}b[C++]=c?l:++l,p[0]&&c?p[v]=r[f]||0:p=[r[f]]}while((f++<h||p[0]!==d1)&&o--);return!b[0]&&C!=1&&(b.shift(),g.e--,S--),C>S&&Kc(g,S,n.RM,p[0]!==d1),g};_r.eq=function(t){return this.cmp(t)===0};_r.gt=function(t){return this.cmp(t)>0};_r.gte=function(t){return this.cmp(t)>-1};_r.lt=function(t){return this.cmp(t)<0};_r.lte=function(t){return this.cmp(t)<1};_r.minus=_r.sub=function(t){var e,n,r,i,o=this,a=o.constructor,s=o.s,u=(t=new a(t)).s;if(s!=u)return t.s=-u,o.plus(t);var l=o.c.slice(),c=o.e,d=t.c,m=t.e;if(!l[0]||!d[0])return d[0]?t.s=-u:l[0]?t=new a(o):t.s=1,t;if(s=c-m){for((i=s<0)?(s=-s,r=l):(m=c,r=d),r.reverse(),u=s;u--;)r.push(0);r.reverse()}else for(n=((i=l.length<d.length)?l:d).length,s=u=0;u<n;u++)if(l[u]!=d[u]){i=l[u]<d[u];break}if(i&&(r=l,l=d,d=r,t.s=-t.s),(u=(n=d.length)-(e=l.length))>0)for(;u--;)l[e++]=0;for(u=e;n>s;){if(l[--n]<d[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=d[n]}for(;l[--u]===0;)l.pop();for(;l[0]===0;)l.shift(),--m;return l[0]||(t.s=1,l=[m=0]),t.c=l,t.e=m,t};_r.mod=function(t){var e,n=this,r=n.constructor,i=n.s,o=(t=new r(t)).s;if(!t.c[0])throw Error(BB);return n.s=t.s=1,e=t.cmp(n)==1,n.s=i,t.s=o,e?new r(n):(i=r.DP,o=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=i,r.RM=o,this.minus(n.times(t)))};_r.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};_r.plus=_r.add=function(t){var e,n,r,i=this,o=i.constructor;if(t=new o(t),i.s!=t.s)return t.s=-t.s,i.minus(t);var a=i.e,s=i.c,u=t.e,l=t.c;if(!s[0]||!l[0])return l[0]||(s[0]?t=new o(i):t.s=i.s),t;if(s=s.slice(),e=a-u){for(e>0?(u=a,r=l):(e=-e,r=s),r.reverse();e--;)r.push(0);r.reverse()}for(s.length-l.length<0&&(r=l,l=s,s=r),e=l.length,n=0;e;s[e]%=10)n=(s[--e]=s[e]+l[e]+n)/10|0;for(n&&(s.unshift(n),++u),e=s.length;s[--e]===0;)s.pop();return t.c=s,t.e=u,t};_r.pow=function(t){var e=this,n=new e.constructor("1"),r=n,i=t<0;if(t!==~~t||t<-aT||t>aT)throw Error(Gc+"exponent");for(i&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return i?n.div(r):r};_r.prec=function(t,e){if(t!==~~t||t<1||t>Pc)throw Error(Gc+"precision");return Kc(new this.constructor(this),t,e)};_r.round=function(t,e){if(t===d1)t=0;else if(t!==~~t||t<-Pc||t>Pc)throw Error(O8);return Kc(new this.constructor(this),t+this.e+1,e)};_r.sqrt=function(){var t,e,n,r=this,i=r.constructor,o=r.s,a=r.e,s=new i("0.5");if(!r.c[0])return new i(r);if(o<0)throw Error(If+"No square root");o=Math.sqrt(r+""),o===0||o===1/0?(e=r.c.join(""),e.length+a&1||(e+="0"),o=Math.sqrt(e),a=((a+1)/2|0)-(a<0||a&1),t=new i((o==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):t=new i(o+""),a=t.e+(i.DP+=4);do n=t,t=s.times(n.plus(r.div(n)));while(n.c.slice(0,a).join("")!==t.c.slice(0,a).join(""));return Kc(t,(i.DP-=4)+t.e+1,i.RM)};_r.times=_r.mul=function(t){var e,n=this,r=n.constructor,i=n.c,o=(t=new r(t)).c,a=i.length,s=o.length,u=n.e,l=t.e;if(t.s=n.s==t.s?1:-1,!i[0]||!o[0])return t.c=[t.e=0],t;for(t.e=u+l,a<s&&(e=i,i=o,o=e,l=a,a=s,s=l),e=new Array(l=a+s);l--;)e[l]=0;for(u=s;u--;){for(s=0,l=a+u;l>u;)s=e[l]+o[u]*i[l-u-1]+s,e[l--]=s%10,s=s/10|0;e[l]=s}for(s?++t.e:e.shift(),u=e.length;!e[--u];)e.pop();return t.c=e,t};_r.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==d1){if(t!==~~t||t<0||t>Pc)throw Error(O8);for(n=Kc(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return md(n,!0,!!r)};_r.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==d1){if(t!==~~t||t<0||t>Pc)throw Error(O8);for(n=Kc(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return md(n,!1,!!r)};_r[Symbol.for("nodejs.util.inspect.custom")]=_r.toJSON=_r.toString=function(){var t=this,e=t.constructor;return md(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};_r.toNumber=function(){var t=Number(md(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(If+"Imprecise conversion");return t};_r.toPrecision=function(t,e){var n=this,r=n.constructor,i=n.c[0];if(t!==d1){if(t!==~~t||t<1||t>Pc)throw Error(Gc+"precision");for(n=Kc(new r(n),t,e);n.c.length<t;)n.c.push(0)}return md(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!i)};_r.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(If+"valueOf disallowed");return md(t,t.e<=e.NE||t.e>=e.PE,!0)};var Ki=UB();function VB(t){let e;switch(t){case Rt.EQUALS:e=Rt.EQUALS;break;case Rt.GREATER_THAN:e=Rt.LESS_THAN;break;case Rt.GREATER_THAN_OR_EQUAL:e=Rt.LESS_THAN_OR_EQUAL;break;case Rt.LESS_THAN:e=Rt.GREATER_THAN;break;case Rt.LESS_THAN_OR_EQUAL:e=Rt.GREATER_THAN_OR_EQUAL;break;case Rt.NOT_EQUAL:e=Rt.NOT_EQUAL;break}return e}function WE(t,e){return Ki(t).times(e).toNumber()}function sT(t,e){const n=10**Math.floor(e);return Math.round(WE(t,n))/n}function uT(t,e){const n=10**Math.floor(e);return Math.floor(WE(t,n))/n}function lT(t,e){const n=10**Math.floor(e);return Math.ceil(WE(t,n))/n}function cT(t,e){return t**e}let G1=class extends qc{isNull(){return!0}plus(e){return new Tt(0,!0).plus(e)}minus(e){return new Tt(0,!0).minus(e)}multiply(e){return new Tt(0,!0).multiply(e)}divided(e){return new Tt(0,!0).divided(e)}compare(e,n){return e.isString()?new to("").compare(e,n):e.isBoolean()?new Zr(!1).compare(e,n):new Tt(0,!0).compare(e,n)}concatenateFront(e){return e.isArray()?e.concatenateBack(new to("")):new to(this.concatenate(e.getValue(),bs.FRONT))}concatenateBack(e){return e.isArray()?e.concatenateFront(new to("")):new to(this.concatenate(e.getValue(),bs.BACK))}plusBy(e){return new Tt(0).plusBy(e)}minusBy(e){return new Tt(0).minusBy(e)}multiplyBy(e){return new Tt(0).multiplyBy(e)}dividedBy(e){return new Tt(0).dividedBy(e)}compareBy(e,n){return typeof e=="string"?new to("").compareBy(e,n):typeof e=="boolean"?new Zr(!1).compareBy(e,n):new Tt(0,!0).compareBy(e,n)}pow(e){return new Tt(0,!0).pow(e)}sqrt(){return new Tt(0,!0).sqrt()}cbrt(){return new Tt(0,!0).cbrt()}cos(){return new Tt(0,!0).cos()}acos(){return new Tt(0,!0).acos()}acosh(){return new Tt(0,!0).acosh()}sin(){return new Tt(0,!0).sin()}asin(){return new Tt(0,!0).asin()}asinh(){return new Tt(0,!0).asinh()}tan(){return new Tt(0,!0).tan()}tanh(){return new Tt(0,!0).tanh()}atan(){return new Tt(0,!0).atan()}atan2(e){return new Tt(0,!0).atan2(e)}atanh(){return new Tt(0,!0).atanh()}log(){return new j(k.NUM)}log10(){return new j(k.NUM)}exp(){return new Tt(0,!0).exp()}abs(){return new Tt(0,!0).abs()}round(e){return new Tt(0,!0).round(e)}floor(e){return new Tt(0,!0).floor(e)}ceil(e){return new Tt(0,!0).ceil(e)}},Zr=class extends qc{constructor(e,n=!1){if(super(e),Fe(this,"_value",!1),n){this._value=e;return}if(typeof e=="boolean")this._value=e;else if(typeof e=="string"){const r=e.toLocaleUpperCase();r===Oc.TRUE?this._value=!0:r===Oc.FALSE&&(this._value=!1)}else e===1?this._value=!0:this._value=!1}getValue(){return this._value}isBoolean(){return!0}getNegative(){const e=this.getValue();let n=0;return e&&(n=1),new Tt(-n,!0)}getReciprocal(){return this.getValue()?new Tt(1,!0):new j(k.DIV_BY_ZERO)}plus(e){return this._convertTonNumber().plus(e)}minus(e){return this._convertTonNumber().minus(e)}multiply(e){return this._convertTonNumber().multiply(e)}divided(e){return this._convertTonNumber().divided(e)}compare(e,n){return this._convertTonNumber().compare(e,n)}concatenateFront(e){return this._convertTonNumber().concatenateFront(e)}concatenateBack(e){return this._convertTonNumber().concatenateBack(e)}_convertTonNumber(){const e=this.getValue();let n=0;return e&&(n=1),new Tt(n,!0)}pow(e){return this._convertTonNumber().pow(e)}sqrt(){return this._convertTonNumber().sqrt()}cbrt(){return this._convertTonNumber().cbrt()}cos(){return this._convertTonNumber().cos()}acos(){return this._convertTonNumber().acos()}acosh(){return this._convertTonNumber().acosh()}sin(){return this._convertTonNumber().sin()}asin(){return this._convertTonNumber().asin()}asinh(){return this._convertTonNumber().asinh()}tan(){return this._convertTonNumber().tan()}tanh(){return this._convertTonNumber().tanh()}atan(){return this._convertTonNumber().atan()}atan2(e){return this._convertTonNumber().atan2(e)}atanh(){return this._convertTonNumber().atanh()}log(){return this._convertTonNumber().log()}log10(){return this._convertTonNumber().log10()}exp(){return this._convertTonNumber().exp()}abs(){return this._convertTonNumber().abs()}round(e){return this._convertTonNumber().round(e)}floor(e){return this._convertTonNumber().floor(e)}ceil(e){return this._convertTonNumber().ceil(e)}},Tt=class zn extends qc{constructor(e,n=!1){if(super(e),Fe(this,"_value",0),n){this._value=e;return}this._value=Number(e)}getValue(){return this._value}setValue(e){this._value=e}isNumber(){return!0}getNegative(){return new zn(0).minus(this)}getReciprocal(){return new zn(1).divided(this)}plus(e){if(e.isArray())return e.plus(this);const n=this.plusBy(e.getValue());return n.isError()||n.setPattern(this.getPattern()||e.getPattern()),n}equalZero(){return this._value===0}minus(e){if(e.isArray()){const r=e.getNegative();return r.isError()?r:r.plus(this)}const n=this.minusBy(e.getValue());return n.isError()?this:(n.setPattern(this.getPattern()||e.getPattern()),n)}multiply(e){if(e.isArray())return e.multiply(this);const n=this.multiplyBy(e.getValue());return n.setPattern(this.getPattern()||e.getPattern()),n}divided(e){if(e.isArray()){const r=e.getReciprocal();return r.isError()?r:r.multiply(this)}const n=this.dividedBy(e.getValue());return n.setPattern(this.getPattern()||e.getPattern()),n}concatenateFront(e){return e.isArray()?e.concatenateBack(this):new to(this.concatenate(e.getValue(),bs.FRONT))}concatenateBack(e){return e.isArray()?e.concatenateFront(this):new to(this.concatenate(e.getValue(),bs.BACK))}compare(e,n){return e.isArray()?e.compare(this,VB(n)):this.compareBy(e.getValue(),n)}plusBy(e){const n=this.getValue();if(typeof e=="string")return I8.has(e)?new j(e):new j(k.VALUE);if(typeof e=="number"){if(!Number.isFinite(n)||!Number.isFinite(e))return new j(k.NUM);const r=Ki(n).plus(e).toNumber();return Number.isFinite(r)?new zn(r):new j(k.NUM)}return typeof e=="boolean"?new zn(Ki(n).plus(e?1:0).toNumber()):this}minusBy(e){const n=this.getValue();if(typeof e=="string")return new j(k.VALUE);if(typeof e=="number"){if(!Number.isFinite(n)||!Number.isFinite(e))return new j(k.NUM);const r=Ki(n).minus(e).toNumber();return Number.isFinite(r)?new zn(r):new j(k.NUM)}return typeof e=="boolean"?new zn(Ki(n).minus(e?1:0).toNumber()):this}multiplyBy(e){const n=this.getValue();if(typeof e=="string")return new j(k.VALUE);if(typeof e=="number"){if(!Number.isFinite(n)||!Number.isFinite(e))return new j(k.NUM);const r=Ki(n).times(e).toNumber();return Number.isFinite(r)?new zn(r):new j(k.NUM)}return typeof e=="boolean"?new zn(Ki(n).times(e?1:0).toNumber()):this}dividedBy(e){const n=this.getValue();if(typeof e=="string")return new j(k.VALUE);if(typeof e=="number"){if(e===0)return new j(k.DIV_BY_ZERO);if(!Number.isFinite(n)||!Number.isFinite(e))return new j(k.NUM);const r=Ki(n).div(e).toNumber();return Number.isFinite(r)?new zn(r):new j(k.NUM)}return typeof e=="boolean"?e===!1?new j(k.DIV_BY_ZERO):new zn(Ki(n).div(1).toNumber()):this}compareBy(e,n){const r=this.getValue();let i=!1;if(typeof e=="string")switch(n){case Rt.EQUALS:case Rt.GREATER_THAN:case Rt.GREATER_THAN_OR_EQUAL:i=!1;break;case Rt.LESS_THAN:case Rt.LESS_THAN_OR_EQUAL:case Rt.NOT_EQUAL:i=!0;break}else if(typeof e=="number")if(!Number.isFinite(r)||!Number.isFinite(e))i=this._compareInfinity(r,e,n);else switch(n){case Rt.EQUALS:i=Ki(r).eq(e);break;case Rt.GREATER_THAN:i=Ki(r).gt(e);break;case Rt.GREATER_THAN_OR_EQUAL:i=Ki(r).gte(e);break;case Rt.LESS_THAN:i=Ki(r).lt(e);break;case Rt.LESS_THAN_OR_EQUAL:i=Ki(r).lte(e);break;case Rt.NOT_EQUAL:i=!Ki(r).eq(e);break}else if(typeof e=="boolean")switch(n){case Rt.EQUALS:case Rt.GREATER_THAN:case Rt.GREATER_THAN_OR_EQUAL:i=!1;break;case Rt.LESS_THAN:case Rt.LESS_THAN_OR_EQUAL:case Rt.NOT_EQUAL:i=!0;break}return new Zr(i)}pow(e){if(e.isArray())return e.powInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return new j(k.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return new j(k.NUM);const i=cT(n,r);return Number.isFinite(i)?new zn(i):new j(k.NUM)}return typeof r=="boolean"?new zn(cT(n,r?1:0)):this}sqrt(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Ki(e).sqrt().toNumber();return Number.isFinite(n)?new zn(n):new j(k.NUM)}cbrt(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.cbrt(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}cos(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.cos(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}acos(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.acos(e);return Number.isNaN(n)?new j(k.NUM):new zn(n)}acosh(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.acosh(e);return Number.isNaN(n)?new j(k.NUM):new zn(n)}sin(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.sin(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}asin(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.asin(e);return Number.isNaN(n)?new j(k.NUM):new zn(n)}asinh(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.asinh(e);return Number.isNaN(n)?new j(k.NUM):new zn(n)}tan(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.tan(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}tanh(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.tanh(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}atan(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.atan(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}atan2(e){if(e.isArray())return e.atan2Inverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return new j(k.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return new j(k.NUM);const i=Math.atan2(n,r);return Number.isFinite(i)?new zn(i):new j(k.NUM)}return typeof r=="boolean"?new zn(Math.atan2(n,r?1:0)):this}atanh(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.atanh(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}log(){const e=this.getValue();if(typeof e=="number"&&e<=0)return new j(k.NUM);if(!Number.isFinite(e))return new j(k.NUM);const n=Math.log(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}log10(){const e=this.getValue();if(typeof e=="number"&&e<=0)return new j(k.NUM);if(!Number.isFinite(e))return new j(k.NUM);const n=Math.log10(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}exp(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.exp(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}abs(){const e=this.getValue();if(!Number.isFinite(e))return new j(k.NUM);const n=Math.abs(e);return Number.isFinite(n)?new zn(n):new j(k.NUM)}round(e){if(e.isArray())return e.roundInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return new j(k.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return new j(k.NUM);const i=sT(n,r);return Number.isFinite(i)?new zn(i):new j(k.NUM)}return typeof r=="boolean"?new zn(sT(n,r?1:0)):this}floor(e){if(e.isArray())return e.floorInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return new j(k.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return new j(k.NUM);const i=uT(n,r);return Number.isFinite(i)?new zn(i):new j(k.NUM)}return typeof r=="boolean"?new zn(uT(n,r?1:0)):this}ceil(e){if(e.isArray())return e.ceilInverse(this);const n=this.getValue(),r=e.getValue();if(typeof r=="string")return new j(k.VALUE);if(typeof r=="number"){if(!Number.isFinite(n)||!Number.isFinite(r))return new j(k.NUM);const i=lT(n,r);return Number.isFinite(i)?new zn(i):new j(k.NUM)}return typeof r=="boolean"?new zn(lT(n,r?1:0)):this}_compareInfinity(e,n,r){let i=!1;switch(r){case Rt.EQUALS:i=e===n;break;case Rt.GREATER_THAN:i=e>n;break;case Rt.GREATER_THAN_OR_EQUAL:i=e>=n;break;case Rt.LESS_THAN:i=e<n;break;case Rt.LESS_THAN_OR_EQUAL:i=e<=n;break;case Rt.NOT_EQUAL:i=e!==n;break}return i}};class to extends qc{constructor(e,n=!1){if(super(e),Fe(this,"_value"),n){this._value=e;return}let r=e.toString();r.charAt(0)==='"'&&r.charAt(r.length-1)==='"'&&(r=r.slice(1,-1),r=r.replace(/""/g,'"')),this._value=r}getValue(){return this._value}isString(){return!0}concatenateFront(e){return e.isArray()?e.concatenateBack(this):new to(this.concatenate(e.getValue(),bs.FRONT))}concatenateBack(e){return e.isArray()?e.concatenateFront(this):new to(this.concatenate(e.getValue(),bs.BACK))}compare(e,n){return e.isArray()?e.compare(this,VB(n)):this.compareBy(e.getValue(),n)}compareBy(e,n){const r=this.getValue();let i=!1;if(typeof e=="string"){if(GTe(e))return this._checkWildcard(e,n);switch(n){case Rt.EQUALS:i=r===e;break;case Rt.GREATER_THAN:i=r>e;break;case Rt.GREATER_THAN_OR_EQUAL:i=r>=e;break;case Rt.LESS_THAN:i=r<e;break;case Rt.LESS_THAN_OR_EQUAL:i=r<=e;break;case Rt.NOT_EQUAL:i=r!==e;break}}else if(typeof e=="number")switch(n){case Rt.NOT_EQUAL:case Rt.GREATER_THAN:case Rt.GREATER_THAN_OR_EQUAL:i=!0;break;case Rt.EQUALS:case Rt.LESS_THAN:case Rt.LESS_THAN_OR_EQUAL:i=!1;break}else if(typeof e=="boolean")switch(n){case Rt.EQUALS:case Rt.GREATER_THAN:case Rt.GREATER_THAN_OR_EQUAL:i=!1;break;case Rt.LESS_THAN:case Rt.LESS_THAN_OR_EQUAL:case Rt.NOT_EQUAL:i=!0;break}return new Zr(i)}_checkWildcard(e,n){const r=this.getValue().toLocaleLowerCase(),i=KTe(r,e,n);return new Zr(i)}}function owe(t){return""}function awe(t=[]){const e=[];for(let n=0;n<t.length;n++){const r=t[n];e[n]==null&&(e[n]=[]);for(let i=0;i<r.length;i++){const o=r[i];e[n][i]=Mc.create(o)}}return e}function swe(t=[]){const e=[];for(let n=0;n<t.length;n++){const r=t[n];e[n]==null&&(e[n]=[]);for(let i=0;i<r.length;i++){const o=r[i];o.isError()?e[n][i]=o.getErrorType():e[n][i]=o.getValue()}}return e}class Va extends qc{constructor(e){var n=(...r)=>(super(...r),Fe(this,"_values",[]),Fe(this,"_rowCount",-1),Fe(this,"_columnCount",-1),Fe(this,"_unitId",""),Fe(this,"_sheetId",""),Fe(this,"_currentRow",-1),Fe(this,"_currentColumn",-1),Fe(this,"_sliceCache",new Map),Fe(this,"_flattenCache"),Fe(this,"_flattenPosition"),this);if(typeof e=="string")n(e);else{const r=owe();n(r)}this._values=this._formatValue(e)}dispose(){this._values.forEach(e=>{e.forEach(n=>{n.dispose()})}),this._values=[],this._clearCache()}clone(){return this.map(e=>e)}getRowCount(){return this._rowCount}setRowCount(e){this._rowCount=e}getColumnCount(){return this._columnCount}setColumnCount(e){this._columnCount=e}setCurrent(e,n){this._currentRow=e,this._currentColumn=n}setUnitId(e){this._unitId=e}getUnitId(){return this._unitId}setSheetId(e){this._sheetId=e}getSheetId(){return this._sheetId}getCurrentRow(){return this._currentRow}getCurrentColumn(){return this._currentColumn}getArrayValue(){return this._values}setArrayValue(e){this._clearCache(),this._values=e}isArray(){return!0}get(e,n){const r=this._values[e];if(r==null)return new G1(0);const i=r[n];return i??new G1(0)}getRealValue(e,n){const r=this._values[e];if(r==null)return null;const i=r[n];return i??null}set(e,n,r){if(e>=this._rowCount||n>=this._columnCount)throw new Error("Exceeding array bounds.");this._clearCache(),this._values[e][n]=r}getRangePosition(){const e=this.getRowCount(),n=0,r=this.getColumnCount();return{startRow:0,endRow:e-1,startColumn:n,endColumn:r-1}}iterator(e){const{startRow:n,endRow:r,startColumn:i,endColumn:o}=this.getRangePosition(),a=this.getArrayValue();for(let s=n;s<=r;s++)for(let u=i;u<=o;u++)if(e(a[s][u],s,u)===!1)return}iteratorReverse(e){const{startRow:n,endRow:r,startColumn:i,endColumn:o}=this.getRangePosition(),a=this.getArrayValue();for(let s=r;s>=n;s--)for(let u=o;u>=i;u--)if(e(a[s][u],s,u)===!1)return}getLastTruePosition(){let e;return this.iteratorReverse((n,r,i)=>{if(n!=null&&n.isBoolean()&&n.getValue()===!0)return e={row:r,column:i},!1}),e}getFirstTruePosition(){let e;return this.iterator((n,r,i)=>{if(n!=null&&n.isBoolean()&&n.getValue()===!0)return e={row:r,column:i},!1}),e}getFirstCell(){const{startRow:e,startColumn:n}=this.getRangePosition();return this.get(e,n)}getLastCell(){const{endRow:e,endColumn:n}=this.getRangePosition();return this.get(e,n)}pick(e){const n=e.getRowCount(),r=e.getColumnCount();if(n!==this._rowCount||r!==this._columnCount)return this._createNewArray([[new G1(0)]],1,1);const i=[];i[0]=[];for(let o=0;o<n;o++)for(let a=0;a<r;a++){const s=e.get(o,a),u=this.get(o,a);s.isError()||s.getValue()===!0&&i[0].push(u)}return this._createNewArray(i,1,i[0].length)}flatten(){if(this._flattenCache!=null)return this._flattenCache;const e=[];e[0]=[];for(let r=0;r<this._rowCount;r++)for(let i=0;i<this._columnCount;i++){const o=this.get(r,i);e[0].push(o)}const n=this._createNewArray(e,1,e[0].length);return this._flattenCache=n,n}flattenPosition(){if(this._flattenPosition!=null)return this._flattenPosition;const e=[],n=[],r=[],i=[];let o=0;for(let s=0;s<this._rowCount;s++)for(let u=0;u<this._columnCount;u++){const l=this.get(s,u);if(l.isError()||l.isNull()){o++;continue}l.isString()?(e.push(l),r.push(o++)):(n.push(l),i.push(o++))}const a={stringArray:e,numberArray:n,stringPosition:r,numberPosition:i};return this._flattenPosition=a,a}slice(e,n){let r=0,i=this._rowCount,o=1,a=0,s=this._columnCount,u=1;if(e!=null&&(r=e[0]||0,i=e[1]||this._rowCount,o=e[2]||1),n!=null&&(a=n[0]||0,s=n[1]||this._columnCount,u=n[2]||1),r>=this._rowCount||a>=this._columnCount)return;const l=`${r}_${i}_${o}_${a}_${s}_${u}`,c=this._sliceCache.get(l);if(c!=null)return c;const d=[],m=this._values;let f=0,h=0;for(let b=r;b<i;b+=o){h=0,d[f]==null&&(d[f]=[]);for(let C=a;C<s;C+=u)d[f][h]=m[b][C],h++;f++}if(d.length===0||d[0].length===0)return;const p=o>1?-1:r+this._currentRow,v=u>1?-1:a+this._currentColumn,g=this._createNewArray(d,d.length,d[0].length,p,v);return this._sliceCache.set(l,g),g}sortByRow(e){const n=this._transposeArray(this._values);n.sort(this._sort(e)),this._clearCache(),this._values=this._transposeArray(n)}sortByColumn(e){this._clearCache(),this._values.sort(this._sort(e))}transpose(){const e=this._transposeArray(this._values),n=this._rowCount,r=this._columnCount;return this._createNewArray(e,r,n)}orderSearch(e,n=go.MIN,r=!1,i=!1){let o,a,s,u;const l=(c,d,m)=>{if(c==null)return!0;let f;if(i===!0?f=c.compare(e,Rt.EQUALS):f=c.isEqual(e),(f==null?void 0:f.getValue())===!0)return o=c,s={row:d,column:m},!1;n===go.MAX?c.isGreaterThan(e).getValue()===!0&&(a==null||c.minus(e).abs().isLessThanOrEqual(a.minus(e).abs()).getValue()===!0)&&(a=c,u={row:d,column:m}):n===go.MIN&&c.isLessThan(e).getValue()===!0&&(a==null||c.minus(e).abs().isLessThanOrEqual(a.minus(e).abs()).getValue()===!0)&&(a=c,u={row:d,column:m})};if(r){const c=this._values.length;if(this._values[0]==null)return;const d=this._values[0].length;for(let m=c-1;m>=0;m--)for(let f=d-1;f>=0;f--){const h=this._values[m][f];l(h,m,f)}}else this.iterator((c,d,m)=>{l(c,d,m)});if(o!=null)return s;if(a!=null)return u}binarySearch(e,n=H1.MIN){if(e.isError())return;const{stringArray:r,stringPosition:i,numberArray:o,numberPosition:a}=this.flattenPosition();return e.isString()?this._binarySearch(e,r,i,n):this._binarySearch(e,o,a,n)}_binarySearch(e,n,r,i=H1.MIN){const o=rT(),a=e.getValue().toString();let s=0,u=n.length-1,l=null;for(;s<=u;){const c=Math.floor((s+u)/2),d=n[c];let m=0;if(d.isNull())m=1;else{const f=d.getValue();m=o(f.toString(),a)}if(m===0)return r[c];m===-1?(s=c+1,i===H1.MIN&&(l=c)):(u=c-1,i===H1.MAX&&(l=c))}if(l!=null)return r[l]}sum(){let e=new Tt(0);return this.iterator(n=>{if(n==null||n.isString()||n.isBoolean()||n.isNull())return!0;if(n.isError())return e=n,!1;e=e.plus(n)}),e}max(){let e=new Tt(Number.NEGATIVE_INFINITY);return this.iterator(n=>{if(n==null)return!0;if(n.isError())return e=n,!1;if(n.isString()||n.isNull())return!0;e.isLessThan(n).getValue()&&(e=n)}),e}min(){let e=new Tt(Number.POSITIVE_INFINITY);return this.iterator(n=>{if(n==null)return!0;if(n.isError())return e=n,!1;if(n.isString()||n.isNull())return!0;e.isGreaterThan(n).getValue()&&(e=n)}),e}count(){let e=new Tt(0);return this.iterator(n=>{if(n==null||n.isError()||n.isString()||n.isNull()||n.isBoolean())return!0;e=e.plusBy(1)}),e}countA(){let e=new Tt(0);return this.iterator(n=>{if(n==null||n.isNull())return!0;e=e.plusBy(1)}),e}countBlank(){let e=new Tt(0);return this.iterator(n=>{if(n!=null&&!n.isNull())return!0;e=e.plusBy(1)}),e}getNegative(){return new Va("{0}").minus(this)}getReciprocal(){return new Va("{1}").divided(this)}plus(e){return this._batchOperator(e,1)}minus(e){return this._batchOperator(e,0)}multiply(e){return this._batchOperator(e,2)}divided(e){return this._batchOperator(e,3)}compare(e,n){return this._batchOperator(e,4,n)}concatenateFront(e){return this._batchOperator(e,5)}concatenateBack(e){return this._batchOperator(e,6)}product(e,n){return this._batchOperator(e,7,n)}map(e){const n=(r,i,o)=>r.isError()?r:e(r,i,o);return this.mapValue(n)}mapValue(e){var n,r;const i=this._rowCount,o=this._columnCount,a=[];for(let s=0;s<i;s++){const u=[];for(let l=0;l<o;l++){const c=(r=(n=this._values)==null?void 0:n[s])==null?void 0:r[l];c?u[l]=e(c,s,l):u[l]=new j(k.VALUE)}a.push(u)}return this._createNewArray(a,i,o)}pow(e){return this._batchOperator(e,8)}powInverse(e){return this.map(n=>n.isError()?n:e.pow(n))}sqrt(){return this.map(e=>e.isError()?e:e.sqrt())}cbrt(){return this.map(e=>e.isError()?e:e.cbrt())}cos(){return this.map(e=>e.isError()?e:e.cos())}acos(){return this.map(e=>e.isError()?e:e.acos())}acosh(){return this.map(e=>e.isError()?e:e.acosh())}sin(){return this.map(e=>e.isError()?e:e.sin())}asin(){return this.map(e=>e.isError()?e:e.asin())}asinh(){return this.map(e=>e.isError()?e:e.asinh())}tan(){return this.map(e=>e.isError()?e:e.tan())}tanh(){return this.map(e=>e.isError()?e:e.tanh())}atan(){return this.map(e=>e.isError()?e:e.atan())}atanh(){return this.map(e=>e.isError()?e:e.atanh())}atan2(e){return this._batchOperator(e,12)}atan2Inverse(e){return this.map(n=>n.isError()?n:e.atan2(n))}mean(){const e=this.sum(),n=this.count();return e.divided(n)}median(){const e=this.flattenPosition().numberArray,n=this._createNewArray([e],1,e.length),r=n.getColumnCount();if(r<=1)return n.get(0,0);if(n.sortByRow(0),r%2===0){const i=n.get(0,r/2),o=n.get(0,r/2-1);return i.plus(o).divided(new Tt(2,!0))}return n.get(0,(r-1)/2)}var(){const e=this.mean(),n=[[]];this.iterator(l=>{if(l==null||l.isError()||l.isString()||l.isBoolean()||l.isNull())return;const c=l.minus(e).pow(new Tt(2,!0));c.isError()||n[0].push(c)});const{_rowCount:r,_columnCount:i,_unitId:o,_sheetId:a,_currentRow:s,_currentColumn:u}=this;return new Va({calculateValueList:n,rowCount:1,columnCount:n[0].length,unitId:o,sheetId:a,row:s,column:u}).mean()}std(){const e=this.var();return e.isError()?e:e.sqrt()}log(){return this.map(e=>e.isError()?e:e.log())}log10(){return this.map(e=>e.isError()?e:e.log10())}exp(){return this.map(e=>e.isError()?e:e.exp())}abs(){return this.map(e=>e.isError()?e:e.abs())}round(e){return this._batchOperator(e,9)}roundInverse(e){return this.map(n=>n.isError()?n:e.round(n))}floor(e){return this._batchOperator(e,10)}floorInverse(e){return this.map(n=>n.isError()?n:e.floor(n))}ceil(e){return this._batchOperator(e,11)}ceilInverse(e){return this.map(n=>n.isError()?n:e.ceil(n))}toValue(){return swe(this._values)}_clearCache(){this._flattenCache=null,this._sliceCache.clear()}_sort(e){const n=rT();return(r,i)=>{const o=r[e],a=i[e];return o.isError()&&o.isError()?0:o.isError()?1:a.isError()?-1:n(o.getValue(),a.getValue())}}_transposeArray(e){const n=e.length,r=e[0].length,i=[];for(let o=0;o<r;o++){i[o]=[];for(let a=0;a<n;a++)i[o][a]=e[a][o]}return i}_batchOperator(e,n,r){const i=[];let o=this._rowCount,a=this._columnCount;if(e.isArray()){const u=e.getRowCount(),l=e.getColumnCount();if(o=Math.max(u,o),a=Math.max(l,a),u===1&&l===1){const c=e.getFirstCell();for(let d=0;d<a;d++)i.push(c)}else if(u===1&&this._columnCount>1){const c=e.getArrayValue();for(let d=0;d<a;d++)i.push(c[0][d])}else return this._batchOperatorArray(e,n,r)}else for(let u=0;u<a;u++)i.push(e);const s=[];for(let u=0;u<a;u++){const l=i[u];this._batchOperatorValue(l,u,s,n,r)}return this._createNewArray(s,o,a)}_batchOperatorValue(e,n,r,i,o){var a,s;const u=this._rowCount;let l=!1;const c=this.getUnitId(),d=this.getSheetId(),m=this.getCurrentRow(),f=this.getCurrentColumn();if(i===4&&(l=Au.canUseCache(c,d,n+f,m,m+u-1),l===!0)){if(o===Rt.EQUALS){const h=Au.getCellPositions(c,d,n+f,e.getValue());for(let p=0;p<u;p++)r[p]==null&&(r[p]=[]),h!=null&&h.includes(p+m)?r[p][n]=new Zr(!0):r[p][n]=new Zr(!1)}else{const h=Au.getCellValuePositions(c,d,n+f);if(h!=null){h.forEach((p,v)=>{let g;if(typeof v=="string"?g=new to(v):typeof v=="number"?g=new Tt(v):typeof v=="boolean"&&(g=new Zr(v)),g==null)return!0;g.compare(e,o).getValue()===!0&&p.forEach(b=>{b>=m&&b<=m+u-1&&(r[b-m]==null&&(r[b-m]=[]),r[b-m][n]=new Zr(!0))})});for(let p=0;p<u;p++)r[p]==null&&(r[p]=[]),r[p][n]==null&&(r[p][n]=new Zr(!1))}else for(let p=0;p<u;p++)r[p]==null&&(r[p]=[]),r[p][n]=new Zr(!1)}return}for(let h=0;h<u;h++){const p=(s=(a=this._values)==null?void 0:a[h])==null?void 0:s[n];if(r[h]==null&&(r[h]=[]),p&&e)if(p.isError())r[h][n]=p;else if(e.isError())r[h][n]=e;else switch(i){case 1:r[h][n]=p.plus(e);break;case 0:r[h][n]=p.minus(e);break;case 2:r[h][n]=p.multiply(e);break;case 3:r[h][n]=p.divided(e);break;case 4:o?r[h][n]=p.compare(e,o):r[h][n]=new j(k.VALUE);break;case 5:r[h][n]=p.concatenateFront(e);break;case 6:r[h][n]=p.concatenateBack(e);break;case 7:o?r[h][n]=p.product(e,o):r[h][n]=new j(k.VALUE);break;case 8:r[h][n]=p.pow(e);break;case 9:r[h][n]=p.round(e);break;case 10:r[h][n]=p.floor(e);break;case 12:r[h][n]=p.atan2(e);break;case 11:r[h][n]=p.ceil(e);break}else r[h][n]=new j(k.NA);p!=null&&(p.isError()?Au.set(c,d,n+f,p.getErrorType(),h+m):p.isNull()?Au.set(c,d,n+f,null,h+m):Au.set(c,d,n+f,p.getValue(),h+m))}Au.setContinueBuildingCache(c,d,n+f,m,m+u-1)}_batchOperatorArray(e,n,r){var i,o,a,s,u,l,c,d,m,f,h,p;let v=e.getRowCount(),g=e.getColumnCount();v<this._rowCount&&(v=this._rowCount),g<this._columnCount&&(g=this._columnCount);const b=[],C=e.getArrayValue(),S=this._checkArrayCalculateType(this),E=this._checkArrayCalculateType(e);for(let y=0;y<v;y++){const D=[];for(let R=0;R<g;R++){let I;S===3?I=(o=(i=this._values)==null?void 0:i[0])==null?void 0:o[0]:S===1?I=(s=(a=this._values)==null?void 0:a[0])==null?void 0:s[R]:S===2?I=(l=(u=this._values)==null?void 0:u[y])==null?void 0:l[0]:I=(d=(c=this._values)==null?void 0:c[y])==null?void 0:d[R];let T;if(E===3?T=(m=C==null?void 0:C[0])==null?void 0:m[0]:E===1?T=(f=C==null?void 0:C[0])==null?void 0:f[R]:E===2?T=(h=C==null?void 0:C[y])==null?void 0:h[0]:T=(p=C==null?void 0:C[y])==null?void 0:p[R],I&&T)if(I.isError())D[R]=I;else if(T.isError())D[R]=T;else switch(n){case 1:D[R]=I.plus(T);break;case 0:D[R]=I.minus(T);break;case 2:D[R]=I.multiply(T);break;case 3:D[R]=I.divided(T);break;case 4:r?D[R]=I.compare(T,r):D[R]=new j(k.VALUE);break;case 5:D[R]=I.concatenateFront(T);break;case 6:D[R]=I.concatenateBack(T);break;case 7:r?D[R]=I.product(T,r):D[R]=new j(k.VALUE);break;case 8:D[R]=I.pow(T);break;case 9:D[R]=I.round(T);break;case 12:D[R]=I.atan2(T);break;case 10:D[R]=I.floor(T);break;case 11:D[R]=I.ceil(T);break}else D[R]=new j(k.NA)}b.push(D)}return this._createNewArray(b,v,g)}_checkArrayCalculateType(e){return e.getRowCount()===1&&e.getColumnCount()===1?3:e.getRowCount()===1?1:e.getColumnCount()===1?2:0}_formatValue(e){if(typeof e!="string")return e=e,this._rowCount=e.rowCount,this._columnCount=e.columnCount,this._unitId=e.unitId,this._sheetId=e.sheetId,this._currentRow=e.row,this._currentColumn=e.column,e.calculateValueList;e=e.slice(1,-1);const n=e.split(";"),r=n.length,i=[];let o=0;for(let a=0;a<r;a++){const s=n[a].split(","),u=s.length;o<u&&(o=u);const l=[];for(let c=0;c<u;c++){const d=s[c].trim();l.push(Mc.create(d))}i.push(l)}return this._rowCount=r,this._columnCount=o,i}_createNewArray(e,n,r,i=-1,o=-1){(this._currentColumn===-1||this._currentRow===-1)&&(i=-1,o=-1);const a={calculateValueList:e,rowCount:n,columnCount:r,unitId:this.getUnitId(),sheetId:this.getSheetId(),row:i,column:o};return new Va(a)}}class Mc{static create(e){if(e==null)return new G1(0);if(typeof e=="boolean")return new Zr(e,!0);if(typeof e=="string"){const n=e.toLocaleUpperCase().trim();return I8.has(n)?new j(n):n===Oc.TRUE||n===Oc.FALSE?new Zr(n):n5(e)?new Tt(e):new RegExp(UTe,"g").test(e.replace(/\n/g,"").replace(/\r/g,""))?new Va(e.replace(/\n/g,"").replace(/\r/g,"")):new to(e)}return typeof e=="number"?Number.isFinite(e)?new Tt(e,!0):new j(k.NUM):new j(k.NA)}}function uwe(t){if(t===null)return 0;if(t!=null&&t.p){const e=t==null?void 0:t.p.body;if(e==null)return 0;const n=e.dataStream;return n.substring(n.length-2,n.length)===Sc?n.substring(0,n.length-2):n}return(t==null?void 0:t.v)||0}const lwe=1e5,k_=new A8(lwe);let Af=class extends L8{constructor(e){super(),Fe(this,"_forcedSheetId",""),Fe(this,"_forcedSheetName",""),Fe(this,"_defaultSheetId",""),Fe(this,"_rangeData",{startColumn:-1,startRow:-1,endRow:-1,endColumn:-1}),Fe(this,"_unitData",{}),Fe(this,"_defaultUnitId",""),Fe(this,"_forcedUnitId",""),Fe(this,"_runtimeData",{}),Fe(this,"_arrayFormulaCellData",{}),Fe(this,"_runtimeArrayFormulaCellData",{}),Fe(this,"_runtimeFeatureCellData",{}),Fe(this,"_numfmtItemData",{}),Fe(this,"_refOffsetX",0),Fe(this,"_refOffsetY",0),this._token=e}dispose(){this._unitData={},this._runtimeData={}}isExceedRange(){const{startRow:e,endRow:n,startColumn:r,endColumn:i}=this.getRangePosition();return e<0||r<0||n>=this.getRowCount()||i>=this.getColumnCount()}setRefOffset(e=0,n=0){this._refOffsetX=e,this._refOffsetY=n}getRefOffset(){return{x:this._refOffsetX,y:this._refOffsetY}}getRangePosition(){let e=this._rangeData.startRow+this._refOffsetY,n=this._rangeData.endRow+this._refOffsetY,r=this._rangeData.startColumn+this._refOffsetX,i=this._rangeData.endColumn+this._refOffsetX;return isNaN(e)&&(e=0),isNaN(r)&&(r=0),isNaN(n)&&(n=this.getRowCount()-1),isNaN(i)&&(i=this.getColumnCount()-1),{startRow:e,endRow:n,startColumn:r,endColumn:i}}isReferenceObject(){return!0}iterator(e){var n,r,i;const{startRow:o,endRow:a,startColumn:s,endColumn:u}=this.getRangePosition();if(this._checkIfWorksheetMiss())return e(new j(k.VALUE),o,s);const l=this._forcedUnitId||this._defaultUnitId,c=this._forcedSheetId||this._defaultSheetId;for(let d=o;d<=a;d++)for(let m=s;m<=u;m++){if(d<0||m<0)return e(new j(k.REF),d,m);const f=this.getCellData(d,m);let h=!1;if(f==null||T6(f)){h=e(null,d,m);continue}const p=this.getCellValueObject(f),v=(i=(r=(n=this._numfmtItemData[l])==null?void 0:n[c])==null?void 0:r[d])==null?void 0:i[m];if(v&&p.setPattern(v),h=e(p,d,m),h===!1)return}}getFirstCell(){var e,n,r;const{startRow:i,startColumn:o}=this.getRangePosition(),a=this.getCellData(i,o);if(!a)return new Tt(0,!0);const s=this.getCellValueObject(a),u=this._forcedUnitId||this._defaultUnitId,l=this._forcedSheetId||this._defaultSheetId,c=(r=(n=(e=this._numfmtItemData[u])==null?void 0:e[l])==null?void 0:n[i])==null?void 0:r[o];return c&&s.setPattern(c),s}getRangeData(){return this._rangeData}setRangeData(e){this._rangeData=e}getUnitId(){return this._forcedUnitId&&this._forcedUnitId.length>0?this._forcedUnitId:this._defaultUnitId}getSheetId(){return this._forcedSheetId&&this._forcedSheetId.length>0?this._forcedSheetId:this._defaultSheetId}setForcedUnitIdDirect(e){e.length>0&&(this._forcedUnitId=e)}getForcedUnitId(){return this._forcedUnitId}setForcedSheetId(e){var n;this._forcedSheetId=(n=e[this.getUnitId()])==null?void 0:n[this._forcedSheetName]}setForcedSheetIdDirect(e){this._forcedSheetId=e}getForcedSheetId(){return this._forcedSheetId}setForcedSheetName(e){e.length>0&&(this._forcedSheetName=e)}getForcedSheetName(){return this._forcedSheetName}setDefaultSheetId(e){this._defaultSheetId=e}getDefaultSheetId(){return this._defaultSheetId}setDefaultUnitId(e){this._defaultUnitId=e}getDefaultUnitId(){return this._defaultUnitId}getUnitData(){return this._unitData}setUnitData(e){this._unitData=e}getRuntimeData(){return this._runtimeData}setRuntimeData(e){this._runtimeData=e}getArrayFormulaCellData(){return this._arrayFormulaCellData}setArrayFormulaCellData(e){this._arrayFormulaCellData=e}getRuntimeArrayFormulaCellData(){return this._runtimeArrayFormulaCellData}setRuntimeArrayFormulaCellData(e){this._runtimeArrayFormulaCellData=e}getRuntimeFeatureCellData(){return this._runtimeFeatureCellData}setRuntimeFeatureCellData(e){this._runtimeFeatureCellData=e}getNumfmtItemData(){return this._numfmtItemData}setNumfmtItemData(e){this._numfmtItemData=e}getRowCount(){return this.getCurrentActiveSheetData().rowCount}getColumnCount(){return this.getCurrentActiveSheetData().columnCount}isCell(){return!1}isColumn(){return!1}isRow(){return!1}isRange(){return!1}isTable(){return!1}unionBy(e){return new j(k.REF)}unionRange(e,n){return{startRow:-1,startColumn:-1,endRow:-1,endColumn:-1}}getCellValueObject(e){const n=uwe(e);return I8.has(n)?new j(n):e.t===$n.NUMBER?new Tt(n):e.t===$n.STRING||e.t===$n.FORCE_STRING?new to(n):e.t===$n.BOOLEAN?new Zr(n):Mc.create(n)}getCellByRow(e){return this.getCellByPosition(e)}getCellByColumn(e){return this.getCellByPosition(void 0,e)}getCurrentActiveSheetData(){return this._unitData[this.getUnitId()][this.getSheetId()]}getCurrentRuntimeSheetData(){var e,n;return(n=(e=this._runtimeData)==null?void 0:e[this.getUnitId()])==null?void 0:n[this.getSheetId()]}getCurrentActiveArrayFormulaCellData(){var e,n;return(n=(e=this._arrayFormulaCellData)==null?void 0:e[this.getUnitId()])==null?void 0:n[this.getSheetId()]}getCurrentRuntimeActiveArrayFormulaCellData(){var e,n;return(n=(e=this._runtimeArrayFormulaCellData)==null?void 0:e[this.getUnitId()])==null?void 0:n[this.getSheetId()]}getCellData(e,n){const r=this.getCurrentActiveSheetData(),i=this.getCurrentRuntimeSheetData(),o=this.getCurrentActiveArrayFormulaCellData(),a=this.getCurrentRuntimeActiveArrayFormulaCellData();return(i==null?void 0:i.getValue(e,n))||(a==null?void 0:a.getValue(e,n))||this.getRuntimeFeatureCellValue(e,n)||(o==null?void 0:o.getValue(e,n))||(r==null?void 0:r.cellData.getValue(e,n))}getRuntimeFeatureCellValue(e,n){var r;const i=Object.keys(this._runtimeFeatureCellData);for(const o of i){const a=this._runtimeFeatureCellData[o],s=(r=a==null?void 0:a[this.getUnitId()])==null?void 0:r[this.getSheetId()];if(s==null)continue;const u=s.getValue(e,n);if(u!=null)return u}}getCellByPosition(e,n){e||(e=this._rangeData.startRow),n||(n=this._rangeData.startColumn);const r=this.getCellData(e,n);return r?this.getCellValueObject(r):new j(k.VALUE)}toArrayValueObject(e=!0){var n;const{startRow:r,endRow:i,startColumn:o,endColumn:a}=this.getRangePosition(),s=`${this.getUnitId()}_${this.getSheetId()}_${r}_${i}_${o}_${a}`,u=k_.get(s);if(u&&e)return u;const l=i-r+1,c=a-o+1;if(l<0||c<0)return this._getBlankArrayValueObject();const d=new Array(l);this.iterator((h,p,v)=>{const g=p-r,b=v-o;d[g]||(d[g]=new Array(c)),h==null&&(h=new G1(0)),d[g][b]=h});const m={calculateValueList:d,rowCount:d.length,columnCount:((n=d[0])==null?void 0:n.length)||0,unitId:this.getUnitId(),sheetId:this.getSheetId(),row:r,column:o},f=new Va(m);return e&&k_.set(s,f),f}toUnitRange(){return{range:this.getRangePosition(),sheetId:this.getSheetId(),unitId:this.getUnitId()}}_checkIfWorksheetMiss(){return(this._forcedSheetId==null||this._forcedSheetId.length===0)&&this._forcedSheetName.length>0}_getBlankArrayValueObject(){const e={calculateValueList:[],rowCount:0,columnCount:0,unitId:this.getUnitId(),sheetId:this.getSheetId(),row:0,column:0};return new Va(e)}},cwe=class extends L8{constructor(e){super(),this._promise=e}isAsyncObject(){return!0}async getValue(){return this._promise}},dwe=class extends L8{constructor(e){super(),this._promiseList=e}isAsyncArrayObject(){return!0}async getValue(){var e;const n=[];for(let i=0;i<this._promiseList.length;i++){const o=this._promiseList[i];n[i]==null&&(n[i]=[]);for(let a=0;a<o.length;a++){const s=o[a];s.isAsyncObject()?n[i][a]=await s.getValue():n[i][a]=s}}const r={calculateValueList:n,rowCount:n.length,columnCount:((e=n[0])==null?void 0:e.length)||0,unitId:"",sheetId:"",row:0,column:0};return new Va(r)}},Fm=class extends Af{constructor(e,n,r){super(""),this.setRangeData(e),n&&this.setForcedSheetIdDirect(n),r&&this.setForcedUnitIdDirect(r)}isRange(){return!0}};const dT=/[\[\]]/g;function mT(t,e){if(dT.test(t)){const n=Number(t.replace(dT,""));return e+n}return Number(t)-1}function Lg(t,e=0,n=0){t=t.toLocaleUpperCase();const r=t.split(/[RC]/),i=r[1],o=r[2],a=mT(i,e),s=mT(o,n);return{row:a,column:s,absoluteRefType:Hn.NONE}}function mwe(t,e=0,n=0){const{refBody:r,sheetName:i,unitId:o}=IB(t),a=r.indexOf(":");if(a===-1){const p=Lg(r,e,n),v=p.row,g=p.column,b=p.absoluteRefType;return{unitId:o,sheetName:i,range:{startRow:v,startColumn:g,endRow:v,endColumn:g,startAbsoluteRefType:b,endAbsoluteRefType:b}}}const s=r.substring(0,a),u=r.substring(a+1),l=Lg(s,e,n),c=Lg(u,e,n),d=l.row,m=l.column,f=c.row,h=c.column;return{unitId:o,sheetName:i,range:{startRow:d,startColumn:m,endRow:f,endColumn:h,startAbsoluteRefType:l.absoluteRefType,endAbsoluteRefType:c.absoluteRefType}}}function fwe(t){const e=V3(t.startRow,t.startAbsoluteRefType,!0),n=V3(t.startColumn,t.startAbsoluteRefType,!1),r=V3(t.endRow,t.endAbsoluteRefType,!0),i=V3(t.endColumn,t.endAbsoluteRefType,!1);return e===r&&n===i?`R${e}C${n}`:`R${e}C${n}:R${r}C${i}`}function V3(t,e=Hn.ALL,n){switch(t+=1,e){case Hn.ALL:return`${t}`;case Hn.ROW:return n?`${t}`:`[${t}]`;case Hn.COLUMN:return n?`[${t}]`:`${t}`;case Hn.NONE:return`[${t}]`}}const HB=[];class xn extends We{constructor(e){super(),Fe(this,"_unitId"),Fe(this,"_subUnitId"),Fe(this,"_row",-1),Fe(this,"_column",-1),this._name=e}get name(){return this._name}get unitId(){return this._unitId}get subUnitId(){return this._subUnitId}get row(){return this._row}get column(){return this._column}isAsync(){return!1}isAddress(){return!1}isCustom(){return!1}setRefInfo(e,n,r,i){this._unitId=e,this._subUnitId=n,this._row=r,this._column=i}calculateCustom(...e){return null}calculate(...e){return new j(k.VALUE)}checkArrayType(e){return e.isReferenceObject()||e.isValueObject()&&e.isArray()}getIndexNumValue(e,n=1){if(e.isArray()&&(e=e.getFirstCell()),e.isBoolean())return e.getValue()===!1?new j(k.VALUE):n;if(e.isString()){const r=Number(e.getValue());return isNaN(r)?new j(k.REF):r}else if(e.isNumber())return e.getValue();return new j(k.VALUE)}getZeroOrOneByOneDefault(e){if(e==null)return 1;let n=1;if(e.isArray()&&(e=e.getFirstCell()),e.isBoolean())e.getValue()===!1&&(n=0);else{if(e.isString())return;e.isNumber()&&e.getValue()===0&&(n=0)}return n}getMatchTypeValue(e){if(e==null)return 1;let n=1;if(e.isArray()&&(e=e.getFirstCell()),e.isBoolean())e.getValue()===!1&&(n=0);else{if(e.isString())return;if(e.isNumber()){const r=e.getValue();r<=0&&(n=r)}}return n}binarySearch(e,n,r,i){const o=n.binarySearch(e,i);if(o==null)return new j(k.NA);let a;return r.getRowCount()===1?a=r.get(0,o):a=r.get(o,0),a.isNull()?new j(k.NA):a}equalSearch(e,n,r,i=!0){const o=r.pick(n.isEqual(e));let a;return i?a=o.getFirstCell():a=o.getLastCell(),a.isNull()?new j(k.NA):a}fuzzySearch(e,n,r,i=!0){const o=r.pick(n.compare(e,Rt.EQUALS));let a;return i?a=o.getFirstCell():a=o.getLastCell(),a.isNull()?new j(k.NA):a}orderSearch(e,n,r,i=go.MIN,o=!1){const a=n.orderSearch(e,i,o);if(a==null)return new j(k.NA);const s=r.get(a.row,a.column);return s.isNull()?new j(k.NA):s}binarySearchExpand(e,n,r,i=0,o){const a=n.binarySearch(e,o);return a==null?new j(k.NA):i===0?r.slice([a,a+1]):r.slice(void 0,[a,a+1])}equalSearchExpand(e,n,r,i=!0,o=0){const a=n.isEqual(e);let s;return i?s=a.getFirstTruePosition():s=a.getLastTruePosition(),s==null?new j(k.NA):o===0?r.slice([s.row,s.row+1]):r.slice(void 0,[s.column,s.column+1])}fuzzySearchExpand(e,n,r,i=!0,o=0){const a=n.compare(e,Rt.EQUALS);let s;return i?s=a.getFirstTruePosition():s=a.getLastTruePosition(),s==null?new j(k.NA):o===0?r.slice([s.row,s.row+1]):r.slice(void 0,[s.column,s.column+1])}orderSearchExpand(e,n,r,i=go.MIN,o=!1,a=0){const s=n.orderSearch(e,i,o);return s==null?new j(k.NA):a===0?r.slice([s.row,s.row+1]):r.slice(void 0,[s.column,s.column+1])}}const jB=[];var kn=(t=>(t.BETADIST="BETADIST",t.BETAINV="BETAINV",t.BINOMDIST="BINOMDIST",t.CHIDIST="CHIDIST",t.CHIINV="CHIINV",t.CHITEST="CHITEST",t.CONFIDENCE="CONFIDENCE",t.COVAR="COVAR",t.CRITBINOM="CRITBINOM",t.EXPONDIST="EXPONDIST",t.FDIST="FDIST",t.FINV="FINV",t.FTEST="FTEST",t.GAMMADIST="GAMMADIST",t.GAMMAINV="GAMMAINV",t.HYPGEOMDIST="HYPGEOMDIST",t.LOGINV="LOGINV",t.LOGNORMDIST="LOGNORMDIST",t.MODE="MODE",t.NEGBINOMDIST="NEGBINOMDIST",t.NORMDIST="NORMDIST",t.NORMINV="NORMINV",t.NORMSDIST="NORMSDIST",t.NORMSINV="NORMSINV",t.PERCENTILE="PERCENTILE",t.PERCENTRANK="PERCENTRANK",t.POISSON="POISSON",t.QUARTILE="QUARTILE",t.RANK="RANK",t.STDEV="STDEV",t.STDEVP="STDEVP",t.TDIST="TDIST",t.TINV="TINV",t.TTEST="TTEST",t.VAR="VAR",t.VARP="VARP",t.WEIBULL="WEIBULL",t.ZTEST="ZTEST",t))(kn||{});const zB=[];var Tu=(t=>(t.CUBEKPIMEMBER="CUBEKPIMEMBER",t.CUBEMEMBER="CUBEMEMBER",t.CUBEMEMBERPROPERTY="CUBEMEMBERPROPERTY",t.CUBERANKEDMEMBER="CUBERANKEDMEMBER",t.CUBESET="CUBESET",t.CUBESETCOUNT="CUBESETCOUNT",t.CUBEVALUE="CUBEVALUE",t))(Tu||{});const WB=[];var ia=(t=>(t.DAVERAGE="DAVERAGE",t.DCOUNT="DCOUNT",t.DCOUNTA="DCOUNTA",t.DGET="DGET",t.DMAX="DMAX",t.DMIN="DMIN",t.DPRODUCT="DPRODUCT",t.DSTDEV="DSTDEV",t.DSTDEVP="DSTDEVP",t.DSUM="DSUM",t.DVAR="DVAR",t.DVARP="DVARP",t))(ia||{});const YE="yyyy-mm-dd;@";function XE(t){const e=new Date(Date.UTC(1900,0,1)),n=new Date(Date.UTC(1900,1,28)),r=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());let i=(r-e.getTime())/(1e3*3600*24);return r>n.getTime()&&(i+=1),Math.floor(i)+1}function Nc(t){const e=new Date(Date.UTC(1900,0,1)),n=new Date(Date.UTC(1900,1,28));let r=Math.floor(t)-1;return r>(n.getTime()-e.getTime())/(1e3*3600*24)&&(r-=1),new Date(e.getTime()+r*(1e3*3600*24))}function _o(t,e,n,r){const i=[];if(n.isArray()){const o=n.getRowCount(),a=n.getColumnCount();if(o===1&&a===1){const s=n.getFirstCell();for(let u=0;u<t;u++){const l=[];for(let c=0;c<e;c++)l.push(s);i.push(l)}}else if(o===1&&a>1)for(let s=0;s<t;s++){const u=[];for(let l=0;l<e;l++){const c=n.getRealValue(0,l)||(r??new G1(0));u.push(c)}i.push(u)}else if(a===1&&o>1)for(let s=0;s<t;s++){const u=[];for(let l=0;l<e;l++){const c=n.getRealValue(s,0)||(r??new G1(0));u.push(c)}i.push(u)}else for(let s=0;s<t;s++){const u=[];for(let l=0;l<e;l++){const c=n.getRealValue(s,l)||(r??new G1(0));u.push(c)}i.push(u)}}else for(let o=0;o<t;o++){const a=[];for(let s=0;s<e;s++)a.push(n);i.push(a)}return hwe(i,t,e)}function hwe(t,e,n){const r={calculateValueList:t,rowCount:e,columnCount:n,unitId:"",sheetId:"",row:-1,column:-1};return new Va(r)}let pwe=class extends xn{calculate(e,n,r){if(e==null||n==null||r==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return n;if(r.isError())return r;const i=Math.max(e.isArray()?e.getRowCount():1,n.isArray()?n.getRowCount():1,r.isArray()?r.getRowCount():1),o=Math.max(e.isArray()?e.getColumnCount():1,n.isArray()?n.getColumnCount():1,r.isArray()?r.getColumnCount():1),a=_o(i,o,e),s=_o(i,o,n),u=_o(i,o,r);return a.map((l,c,d)=>{const m=s.get(c,d),f=u.get(c,d);if(l.isError())return l;if(m.isError())return m;if(f.isError())return f;if(l.isString()||m.isString()||f.isString())return new j(k.VALUE);let h=+l.getValue();const p=Math.floor(+m.getValue()),v=+f.getValue();if(h<0||h>9999)return new j(k.NUM);h>=0&&h<1899&&(h+=1900);const g=new Date(h,p-1,v),b=XE(g);if(b<0)return new j(k.NUM);const C=new Tt(b);return C.setPattern(YE),C})}},gwe=class extends xn{calculate(e){return e==null?new j(k.NA):e.isError()?e:e.isArray()?e.map(n=>{if(n.isError())return n;if(n.isString()||n.isNull())return new j(k.VALUE);const r=+n.getValue();if(r<0)return new j(k.NUM);if(r===0)return new Tt(0);const i=Nc(r).getDate();return new Tt(i)}):new Tt(Nc(+e.getValue()).getDate())}},vwe=class extends xn{calculate(e,n){if(e==null||n==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return n;const r=Math.max(e.isArray()?e.getRowCount():1,n.isArray()?n.getRowCount():1),i=Math.max(e.isArray()?e.getColumnCount():1,n.isArray()?n.getColumnCount():1),o=_o(r,i,e),a=_o(r,i,n);return o.map((s,u,l)=>{const c=a.get(u,l);if(s.isError())return s;if(c.isError())return c;if(s.isString()||s.isBoolean()||c.isString()||c.isBoolean())return new j(k.VALUE);const d=+s.getValue();if(d<0)return new j(k.NUM);const m=Math.floor(+c.getValue()),f=Nc(d),h=f.getUTCFullYear(),p=f.getUTCMonth()+m,v=f.getUTCDate(),g=new Date(Date.UTC(h,p,v)),b=XE(g),C=new Tt(b);return C.setPattern(YE),C})}};var ur=(t=>(t.DATE="DATE",t.DATEDIF="DATEDIF",t.DATEVALUE="DATEVALUE",t.DAY="DAY",t.DAYS="DAYS",t.DAYS360="DAYS360",t.EDATE="EDATE",t.EOMONTH="EOMONTH",t.HOUR="HOUR",t.ISOWEEKNUM="ISOWEEKNUM",t.MINUTE="MINUTE",t.MONTH="MONTH",t.NETWORKDAYS="NETWORKDAYS",t.NETWORKDAYS_INTL="NETWORKDAYS.INTL",t.NOW="NOW",t.SECOND="SECOND",t.TIME="TIME",t.TIMEVALUE="TIMEVALUE",t.TODAY="TODAY",t.WEEKDAY="WEEKDAY",t.WEEKNUM="WEEKNUM",t.WORKDAY="WORKDAY",t.WORKDAY_INTL="WORKDAY.INTL",t.YEAR="YEAR",t.YEARFRAC="YEARFRAC",t))(ur||{});let bwe=class extends xn{calculate(e){return e==null?new j(k.NA):e.isError()?e:e.isArray()?e.map(n=>{if(n.isError())return n;if(n.isString())return new j(k.VALUE);const r=+n.getValue();if(r<0)return new j(k.NUM);if(r===0)return new Tt(1);const i=Nc(r).getUTCMonth()+1;return new Tt(i)}):new Tt(Nc(+e.getValue()).getUTCMonth()+1)}},_we=class extends xn{calculate(e){if(e)return new j(k.NA);const n=XE(new Date),r=new Tt(n);return r.setPattern(YE),r}},Cwe=class extends xn{calculate(e){return e==null?new j(k.NA):e.isError()?e:e.isArray()?e.map((n,r,i)=>{if(n.isError())return n;if(n.isString())return new j(k.VALUE);const o=+n.getValue();if(o<0)return new j(k.NUM);if(o===0)return new Tt(1900);const a=Nc(o).getUTCFullYear();return new Tt(a)}):new Tt(Nc(+e.getValue()).getUTCFullYear())}};const YB=[[pwe,ur.DATE],[gwe,ur.DAY],[vwe,ur.EDATE],[bwe,ur.MONTH],[_we,ur.TODAY],[Cwe,ur.YEAR]],XB=[];var un=(t=>(t.BESSELI="BESSELI",t.BESSELJ="BESSELJ",t.BESSELK="BESSELK",t.BESSELY="BESSELY",t.BIN2DEC="BIN2DEC",t.BIN2HEX="BIN2HEX",t.BIN2OCT="BIN2OCT",t.BITAND="BITAND",t.BITLSHIFT="BITLSHIFT",t.BITOR="BITOR",t.BITRSHIFT="BITRSHIFT",t.BITXOR="BITXOR",t.COMPLEX="COMPLEX",t.CONVERT="CONVERT",t.DEC2BIN="DEC2BIN",t.DEC2HEX="DEC2HEX",t.DEC2OCT="DEC2OCT",t.DELTA="DELTA",t.ERF="ERF",t.ERF_PRECISE="ERF.PRECISE",t.ERFC="ERFC",t.ERFC_PRECISE="ERFC.PRECISE",t.GESTEP="GESTEP",t.HEX2BIN="HEX2BIN",t.HEX2DEC="HEX2DEC",t.HEX2OCT="HEX2OCT",t.IMABS="IMABS",t.IMAGINARY="IMAGINARY",t.IMARGUMENT="IMARGUMENT",t.IMCONJUGATE="IMCONJUGATE",t.IMCOS="IMCOS",t.IMCOSH="IMCOSH",t.IMCOT="IMCOT",t.IMCSC="IMCSC",t.IMCSCH="IMCSCH",t.IMDIV="IMDIV",t.IMEXP="IMEXP",t.IMLN="IMLN",t.IMLOG10="IMLOG10",t.IMLOG2="IMLOG2",t.IMPOWER="IMPOWER",t.IMPRODUCT="IMPRODUCT",t.IMREAL="IMREAL",t.IMSEC="IMSEC",t.IMSECH="IMSECH",t.IMSIN="IMSIN",t.IMSINH="IMSINH",t.IMSQRT="IMSQRT",t.IMSUB="IMSUB",t.IMSUM="IMSUM",t.IMTAN="IMTAN",t.OCT2BIN="OCT2BIN",t.OCT2DEC="OCT2DEC",t.OCT2HEX="OCT2HEX",t))(un||{});const qB=[];var nn=(t=>(t.ACCRINT="ACCRINT",t.ACCRINTM="ACCRINTM",t.AMORDEGRC="AMORDEGRC",t.AMORLINC="AMORLINC",t.COUPDAYBS="COUPDAYBS",t.COUPDAYS="COUPDAYS",t.COUPDAYSNC="COUPDAYSNC",t.COUPNCD="COUPNCD",t.COUPNUM="COUPNUM",t.COUPPCD="COUPPCD",t.CUMIPMT="CUMIPMT",t.CUMPRINC="CUMPRINC",t.DB="DB",t.DDB="DDB",t.DISC="DISC",t.DOLLARDE="DOLLARDE",t.DOLLARFR="DOLLARFR",t.DURATION="DURATION",t.EFFECT="EFFECT",t.FV="FV",t.FVSCHEDULE="FVSCHEDULE",t.INTRATE="INTRATE",t.IPMT="IPMT",t.IRR="IRR",t.ISPMT="ISPMT",t.MDURATION="MDURATION",t.MIRR="MIRR",t.NOMINAL="NOMINAL",t.NPER="NPER",t.NPV="NPV",t.ODDFPRICE="ODDFPRICE",t.ODDFYIELD="ODDFYIELD",t.ODDLPRICE="ODDLPRICE",t.ODDLYIELD="ODDLYIELD",t.PDURATION="PDURATION",t.PMT="PMT",t.PPMT="PPMT",t.PRICE="PRICE",t.PRICEDISC="PRICEDISC",t.PRICEMAT="PRICEMAT",t.PV="PV",t.RATE="RATE",t.RECEIVED="RECEIVED",t.RRI="RRI",t.SLN="SLN",t.SYD="SYD",t.TBILLEQ="TBILLEQ",t.TBILLPRICE="TBILLPRICE",t.TBILLYIELD="TBILLYIELD",t.VDB="VDB",t.XIRR="XIRR",t.XNPV="XNPV",t.YIELD="YIELD",t.YIELDDISC="YIELDDISC",t.YIELDMAT="YIELDMAT",t))(nn||{}),jr=(t=>(t.CELL="CELL",t.ERROR_TYPE="ERROR.TYPE",t.INFO="INFO",t.ISBLANK="ISBLANK",t.ISERR="ISERR",t.ISERROR="ISERROR",t.ISEVEN="ISEVEN",t.ISFORMULA="ISFORMULA",t.ISLOGICAL="ISLOGICAL",t.ISNA="ISNA",t.ISNONTEXT="ISNONTEXT",t.ISNUMBER="ISNUMBER",t.ISODD="ISODD",t.ISOMITTED="ISOMITTED",t.ISREF="ISREF",t.ISTEXT="ISTEXT",t.N="N",t.NA="NA",t.SHEET="SHEET",t.SHEETS="SHEETS",t.TYPE="TYPE",t))(jr||{});let Swe=class extends xn{calculate(e){return e==null?new j(k.NA):e.isNull()?new Zr(!0):e.isArray()?e.map(n=>n.isNull()?new Zr(!0):new Zr(!1)):new Zr(!1)}};const GB=[[Swe,jr.ISBLANK]];let Ewe=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=!0,r=!0,i=null;for(const o of e){if(o.isError())return o;if(o.isArray()){if(o.iterator(a=>{if(a!=null&&a.isError())return i=a,!1;(a!=null&&a.isBoolean()||a!=null&&a.isNumber())&&(n=n&&!!a.getValue(),r=!1)}),i)return i}else(o.isBoolean()||o.isNumber())&&(n=n&&!!o.getValue(),r=!1)}return r?new j(k.VALUE):new Zr(n)}};var Fr=(t=>(t.AND="AND",t.BYCOL="BYCOL",t.BYROW="BYROW",t.FALSE="FALSE",t.IF="IF",t.IFERROR="IFERROR",t.IFNA="IFNA",t.IFS="IFS",t.LAMBDA="LAMBDA",t.LET="LET",t.MAKEARRAY="MAKEARRAY",t.MAP="MAP",t.NOT="NOT",t.OR="OR",t.REDUCE="REDUCE",t.SCAN="SCAN",t.SWITCH="SWITCH",t.TRUE="TRUE",t.XOR="XOR",t))(Fr||{});let ywe=class extends xn{calculate(e,n,r=new Zr(!1)){if(e==null||n==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return n;if(e=this._getSingleValueObject(e),!e.isArray())return e.getValue()?n:r;const i=Math.max(e.isArray()?e.getRowCount():1,n.isArray()?n.getRowCount():1,r.isArray()?r.getRowCount():1),o=Math.max(e.isArray()?e.getColumnCount():1,n.isArray()?n.getColumnCount():1,r.isArray()?r.getColumnCount():1),a=_o(i,o,e),s=_o(i,o,n,new j(k.NA)),u=_o(i,o,r,new j(k.NA));return a.map((l,c,d)=>{if(l.isNull())return new j(k.NA);{const m=s.get(c,d),f=u.get(c,d);return this._calculateSingleCell(l,m,f)}})}_getSingleValueObject(e){return e.isArray()&&e.getRowCount()===1&&e.getColumnCount()===1?e.getFirstCell():e}_calculateSingleCell(e,n,r){return e.isNull()?new j(k.NA):e.getValue()?n.isNull()?new j(k.NA):n:r.isNull()?new j(k.NA):r}},Dwe=class extends xn{calculate(e,n){if(e==null||n==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return n;if(!e.isArray())return e.isError()?n:e;const r=Math.max(e.isArray()?e.getRowCount():1,n.isArray()?n.getRowCount():1),i=Math.max(e.isArray()?e.getColumnCount():1,n.isArray()?n.getColumnCount():1),o=_o(r,i,e),a=_o(r,i,n);return o.iterator((s,u,l)=>{s!=null&&s.isError()&&o.set(u,l,a.get(u,l))}),o}},Rwe=class extends xn{calculate(...e){return new j(k.VALUE)}},Iwe=class extends xn{calculate(...e){if(e.length!==3)return new j(k.VALUE);const n=this.getIndexNumValue(e[0]);if(typeof n!="number")return n;const r=this.getIndexNumValue(e[1]);if(typeof r!="number")return r;if(!(e[2].isValueObject()&&e[2].isLambda()))return new j(k.VALUE);const i=e[2],o=[];for(let a=0;a<n;a++){o[a]==null&&(o[a]=[]);for(let s=0;s<r;s++){const u=i.execute(new Tt(a+1),new Tt(s+1));o[a][s]=u}}return new dwe(o)}isAsync(){return!0}};const KB=[[Ewe,Fr.AND],[Rwe,Fr.LAMBDA],[Iwe,Fr.MAKEARRAY],[ywe,Fr.IF],[Dwe,Fr.IFERROR]];let Awe=class extends xn{calculate(e,n,r,i,o){if(e==null||n==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return n;if(r!=null&&r.isError())return r;if(i!=null&&i.isError())return i;if(o!=null&&o.isError())return o;const a=Number(e.getValue())-1,s=Number(n.getValue())-1;if(Number.isNaN(a)||Number.isNaN(s))return new j(k.VALUE);const u=r?Twe(r.getValue()):Hn.ALL,l=this.getZeroOrOneByOneDefault(i),c=o?`${o.getValue()}`:"",d=A9(c)?`'${c}'`:c,m={startRow:a,startColumn:s,endRow:a,endColumn:s,startAbsoluteRefType:u,endAbsoluteRefType:u},f=i&&!l?fwe(m):p1(m);return new to(d!==""?`${d}!${f}`:f)}};function Twe(t){switch(t){case 1:return Hn.ALL;case 2:return Hn.ROW;case 3:return Hn.COLUMN;case 4:return Hn.NONE;default:return Hn.ALL}}var Sn=(t=>(t.ADDRESS="ADDRESS",t.AREAS="AREAS",t.CHOOSE="CHOOSE",t.CHOOSECOLS="CHOOSECOLS",t.CHOOSEROWS="CHOOSEROWS",t.COLUMN="COLUMN",t.COLUMNS="COLUMNS",t.DROP="DROP",t.EXPAND="EXPAND",t.FILTER="FILTER",t.FORMULATEXT="FORMULATEXT",t.GETPIVOTDATA="GETPIVOTDATA",t.HLOOKUP="HLOOKUP",t.HSTACK="HSTACK",t.HYPERLINK="HYPERLINK",t.IMAGE="IMAGE",t.INDEX="INDEX",t.INDIRECT="INDIRECT",t.LOOKUP="LOOKUP",t.MATCH="MATCH",t.OFFSET="OFFSET",t.ROW="ROW",t.ROWS="ROWS",t.RTD="RTD",t.SORT="SORT",t.SORTBY="SORTBY",t.TAKE="TAKE",t.TOCOL="TOCOL",t.TOROW="TOROW",t.TRANSPOSE="TRANSPOSE",t.UNIQUE="UNIQUE",t.VLOOKUP="VLOOKUP",t.VSTACK="VSTACK",t.WRAPCOLS="WRAPCOLS",t.WRAPROWS="WRAPROWS",t.XLOOKUP="XLOOKUP",t.XMATCH="XMATCH",t))(Sn||{});let wwe=class extends xn{calculate(e,n,r,i){if(e==null||n==null||r==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return new j(k.REF);if(!n.isArray())return new j(k.VALUE);if(r.isError())return new j(k.NA);if(i!=null&&i.isError())return new j(k.NA);const o=this.getZeroOrOneByOneDefault(i);if(o==null)return new j(k.VALUE);const a=this.getIndexNumValue(r);if(a instanceof j)return a;const s=n.slice([0,1]),u=n.slice([a-1,a]);return s==null||u==null?new j(k.VALUE):e.isArray()?e.map(l=>this._handleSingleObject(l,s,u,o)):this._handleSingleObject(e,s,u,o)}_handleSingleObject(e,n,r,i){return i===0?this.equalSearch(e,n,r):this.binarySearch(e,n,r)}},ZB=class extends Af{constructor(e){super(e);const n=Ms(e);this.setForcedUnitIdDirect(n.unitId),this.setForcedSheetName(n.sheetName),this.setRangeData(n.range)}isCell(){return!0}unionBy(e){if(!e.isCell())return new j(k.REF);const n=e,r=this.unionRange(this.getRangeData(),n.getRangeData());return this._createRange(r)}unionRange(e,n){const r=e.startRow,i=e.startColumn,o=n.startRow,a=n.startColumn,s={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};return r>o?(s.startRow=o,s.endRow=r):(s.startRow=r,s.endRow=o),i>a?(s.startColumn=a,s.endColumn=i):(s.startColumn=i,s.endColumn=a),s}_createRange(e){const n=new Fm(e,this.getForcedSheetId(),this.getForcedUnitId());n.setUnitData(this.getUnitData()),n.setDefaultSheetId(this.getDefaultSheetId()),n.setDefaultUnitId(this.getDefaultUnitId()),n.setRuntimeData(this.getRuntimeData()),n.setNumfmtItemData(this.getNumfmtItemData()),n.setArrayFormulaCellData(this.getArrayFormulaCellData()),n.setRuntimeArrayFormulaCellData(this.getRuntimeArrayFormulaCellData()),n.setRuntimeFeatureCellData(this.getRuntimeFeatureCellData());const{x:r,y:i}=this.getRefOffset();n.setRefOffset(r,i);const o=this.getForcedSheetId();n.setForcedSheetName(this.getForcedSheetName()),o!=null&&n.setForcedSheetIdDirect(o);const a=this.getForcedUnitId();return a&&n.setForcedUnitIdDirect(a),n}},QB=class extends Af{constructor(e){super(e);const n=Ms(e);this.setForcedUnitIdDirect(n.unitId),this.setForcedSheetName(n.sheetName);const r={startColumn:n.range.startColumn,startRow:Number.NaN,endColumn:-1,endRow:Number.NaN};this.setRangeData(r)}isColumn(){return!0}unionBy(e){if(!e.isColumn())return new j(k.REF);const n=e;if(n.getForcedSheetName()!==void 0&&n.getForcedSheetName()!=="")return new j(k.REF);const r=this.getRangeData(),i=n.getRangeData().startColumn,o=r.startColumn;return i>o?r.endColumn=i:(r.startColumn=i,r.endColumn=o),this}},JB=class extends Af{constructor(e){super(e);const n=Ms(e);this.setForcedUnitIdDirect(n.unitId),this.setForcedSheetName(n.sheetName);const r={startColumn:Number.NaN,startRow:n.range.startRow,endColumn:Number.NaN,endRow:-1};this.setRangeData(r)}isRow(){return!0}unionBy(e){if(!e.isRow())return new j(k.REF);const n=e;if(n.getForcedSheetName()!==void 0&&n.getForcedSheetName()!=="")return new j(k.REF);const r=this.getRangeData(),i=n.getRangeData().startRow,o=r.startRow;return i>o?r.endRow=i:(r.startRow=i,r.endRow=o),this}},Lwe=class extends xn{calculate(e,n){if(e==null)return new j(k.NA);if(e.isError())return e;let r=this.getZeroOrOneByOneDefault(n);if(r==null&&(r=1),e.isArray()){const c=e;if(c.getRowCount()===1&&c.getColumnCount()===1)e=c.getFirstCell();else return c.map(()=>new j(k.VALUE))}if(!e.isString())return new j(k.REF);const i=e.getValue();if(r===0){const c=mwe(i),{range:d,sheetName:m,unitId:f}=c,h=new Fm(d);return h.setForcedUnitIdDirect(f),h.setForcedSheetName(m),this._setDefault(h)}if(new RegExp(T8).test(i))return this._setDefault(new ZB(i));if(new RegExp(AB).test(i))return this._setDefault(new JB(i));if(new RegExp(TB).test(i))return this._setDefault(new QB(i));const o=Ms(i),{range:a,sheetName:s,unitId:u}=o,l=new Fm(a);return l.setForcedUnitIdDirect(u),l.setForcedSheetName(s),this._setDefault(l)}_setDefault(e){return this.unitId==null||this.subUnitId==null?new j(k.REF):(e.setDefaultUnitId(this.unitId),e.setDefaultSheetId(this.subUnitId),e)}},Owe=class extends xn{calculate(e,n,r){return e==null||n==null?new j(k.NA):e.isError()?e:n.isError()?new j(k.REF):n.isArray()?r!=null&&r.isError()?r:n.getColumnCount()===1||n.getRowCount()===1?r!=null&&!r.isArray()?new j(k.REF):this._handleVector(e,n,r):this._handleArray(e,n):new j(k.VALUE)}_handleVector(e,n,r){if(r==null)r=n;else if(r.getRowCount()!==n.getRowCount()||r.getColumnCount()!==n.getColumnCount())return new j(k.REF);return e.isArray()?e.map(i=>this.binarySearch(i,n,r)):this.binarySearch(e,n,r)}_handleArray(e,n){const r=n.getRowCount(),i=n.getColumnCount();let o,a;return i>r?(o=n.slice([0,1]),a=n.slice([r-1,r])):(o=n.slice(void 0,[0,1]),a=n.slice(void 0,[i-1,i])),o==null||a==null?new j(k.VALUE):e.isArray()?e.map(s=>this.binarySearch(s,o,a)):this.binarySearch(e,o,a)}},Pwe=class extends xn{calculate(e,n,r){if(e==null||n==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return new j(k.REF);if(!n.isArray())return new j(k.VALUE);const i=n.getRowCount(),o=n.getColumnCount();if(i!==1&&o!==1)return new j(k.NA);if(r!=null&&r.isError())return new j(k.NA);const a=this.getMatchTypeValue(r);return a==null?new j(k.VALUE):e.isArray()?e.map(s=>this._handleSingleObject(s,n,a)):this._handleSingleObject(e,n,a)}_handleSingleObject(e,n,r){const i=this._getSearchModeValue(r),o=n.orderSearch(e,i);if(o==null)return new j(k.NA);if(o instanceof j)return o;const a=n.getRowCount()===1?o.column+1:o.row+1;return new Tt(a)}_getSearchModeValue(e){switch(e){case 1:return go.MIN;case 0:return go.NORMAL;case-1:return go.MAX}}},Mwe=class extends xn{calculate(e,n,r,i,o){var a,s;if(e==null||n==null||r==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return n;if(r.isError())return r;if(i!=null&&i.isError())return i;if(o!=null&&o.isError())return o;if(!e.isArray())return new j(k.VALUE);const u=e.getCurrentRow(),l=e.getCurrentColumn(),c=this.getIndexNumValue(n),d=this.getIndexNumValue(r);if(typeof c!="number"||typeof d!="number")return new j(k.VALUE);const m=u+c,f=l+d;if(m<0||f<0||m>1048576||f>16384)return new j(k.REF);const h=(a=i&&this.getIndexNumValue(i))!=null?a:1,p=(s=o&&this.getIndexNumValue(o))!=null?s:1;if(typeof h!="number"||typeof p!="number")return new j(k.VALUE);if(h===0||p===0)return new j(k.REF);const v=h>0?m+h-1:m+h+1,g=p>0?f+p-1:f+p+1;if(v<0||g<0||v>1048576||g>16384)return new j(k.REF);const b=m<v?m:v,C=f<g?f:g,S=m>v?m:v,E=f>g?f:g,y={startRow:b,startColumn:C,endRow:S,endColumn:E},D=e.getUnitId(),R=e.getSheetId(),I=new Fm(y,R,D);return this._setDefault(I)}_setDefault(e){return this.unitId==null||this.subUnitId==null?new j(k.REF):(e.setDefaultUnitId(this.unitId),e.setDefaultSheetId(this.subUnitId),e)}},Nwe=class extends xn{calculate(e,n,r,i){if(e==null||n==null||r==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return new j(k.REF);if(!n.isArray())return new j(k.VALUE);if(r.isError())return new j(k.NA);if(i!=null&&i.isError())return new j(k.NA);const o=this.getZeroOrOneByOneDefault(i);if(o==null)return new j(k.VALUE);const a=this.getIndexNumValue(r);if(a instanceof j)return a;const s=n.slice(void 0,[0,1]),u=n.slice(void 0,[a-1,a]);return s==null||u==null?new j(k.VALUE):e.isArray()?e.map(l=>this._handleSingleObject(l,s,u,o)):this._handleSingleObject(e,s,u,o)}_handleSingleObject(e,n,r,i){return i===0?this.equalSearch(e,n,r):this.binarySearch(e,n,r)}},xwe=class extends xn{calculate(e,n,r,i,o,a){if(e==null||n==null||r==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return new j(k.REF);if(!n.isArray())return new j(k.VALUE);const s=n.getRowCount(),u=n.getColumnCount();if(s!==1&&u!==1)return new j(k.VALUE);if(r.isError())return new j(k.REF);if(!r.isArray())return new j(k.VALUE);const l=r.getRowCount(),c=r.getColumnCount();if(s!==l&&u!==c)return new j(k.VALUE);if(i!=null&&i.isError())return new j(k.NA);if(o!=null&&o.isError())return new j(k.NA);if(a!=null&&a.isError())return new j(k.NA);i==null&&(i=new j(k.NA));const d=this.getIndexNumValue(o||new Tt(0));if(d instanceof j)return d;const m=this.getIndexNumValue(a||new Tt(1));if(m instanceof j)return m;if(e.isArray()){let p;return s===1?p=r.slice([0,1]):p=r.slice(void 0,[0,1]),p==null?new j(k.NA):e.map(v=>{const g=this._handleSingleObject(v,n,p,d,m);return g.isError()?i:g})}if(u===c&&s===l){const p=this._handleSingleObject(e,n,r,d,m);return p.isError()?i:p}let f=0;u===c&&(f=1);const h=this._handleExpandObject(e,n,r,d,m,f);return h??new j(k.NA)}_handleExpandObject(e,n,r,i,o,a=0){return(o===2||o===-2)&&i!==2?this.binarySearchExpand(e,n,r,a,this._getSearchModeValue(o)):i===2?this.fuzzySearchExpand(e,n,r,o!==-1,a):i===-1||i===1?this.orderSearchExpand(e,n,r,i===1?go.MAX:go.MIN,o===-1,a):this.equalSearchExpand(e,n,r,o!==-1,a)}_handleSingleObject(e,n,r,i,o){return(o===2||o===-2)&&i!==2?this.binarySearch(e,n,r,this._getSearchModeValue(o)):i===2?this.fuzzySearch(e,n,r,o!==-1):i===-1||i===1?this.orderSearch(e,n,r,i===1?go.MAX:go.MIN,o===-1):this.equalSearch(e,n,r,o!==-1)}_getSearchModeValue(e){return e===-2?H1.MAX:H1.MIN}},Fwe=class extends xn{calculate(e,n,r,i){if(e==null||n==null)return new j(k.NA);if(e.isError())return e;if(n.isError())return new j(k.REF);if(!n.isArray())return new j(k.VALUE);const o=n.getRowCount(),a=n.getColumnCount();if(o!==1&&a!==1)return new j(k.VALUE);if(r!=null&&r.isError())return new j(k.NA);if(i!=null&&i.isError())return new j(k.NA);const s=this.getIndexNumValue(r||new Tt(0));if(s instanceof j)return s;const u=this.getIndexNumValue(i||new Tt(1));return u instanceof j?u:e.isArray()?e.map(l=>this._handleSingleObject(l,n,s,u)):this._handleSingleObject(e,n,s,u)}_handleSingleObject(e,n,r,i){let o;if((i===2||i===-2)&&r!==2){const a=this._getSearchModeValue(i);o=n.binarySearch(e,a)}else if(r===2){const a=n.compare(e,Rt.EQUALS);let s;if(i!==-1?s=a.getFirstTruePosition():s=a.getLastTruePosition(),s==null)return new j(k.NA);o=n.getRowCount()===1?s.column:s.row}else if(r===-1||r===1){const a=n.orderSearch(e,r===1?go.MAX:go.MIN,i===-1);if(a==null)return new j(k.NA);if(a instanceof j)return a;o=n.getRowCount()===1?a.column:a.row}else{const a=n.isEqual(e);let s;if(i!==-1?s=a.getFirstTruePosition():s=a.getLastTruePosition(),s==null)return new j(k.NA);o=n.getRowCount()===1?s.column:s.row}return o==null?new j(k.NA):new Tt(o+1)}_getSearchModeValue(e){return e===-2?H1.MAX:H1.MIN}};const eU=[[Awe,Sn.ADDRESS],[Lwe,Sn.INDIRECT],[Mwe,Sn.OFFSET],[Nwe,Sn.VLOOKUP],[Owe,Sn.LOOKUP],[Pwe,Sn.MATCH],[wwe,Sn.HLOOKUP],[xwe,Sn.XLOOKUP],[Fwe,Sn.XMATCH]];let $we=class extends xn{calculate(e){return e==null?new j(k.NA):e.isError()?new j(k.VALUE):e.abs()}},kwe=class extends xn{calculate(e){return e==null?new j(k.NA):e.isError()?e:e.acos()}},Bwe=class extends xn{calculate(e){return e==null?new j(k.NA):e.isError()?new j(k.VALUE):e.acosh()}},Uwe=class extends xn{calculate(e){return e==null?new j(k.NA):e.isError()?e:e.isArray()?e.map(n=>n.isError()?n:fT(n)):fT(e)}};function fT(t){let e=t.getValue();if(t.isBoolean()&&(e=e?1:0),!Number.isFinite(e))return new j(k.VALUE);const n=Math.atan(1/Number(e));return Number.isNaN(n)?new j(k.VALUE):new Tt(n)}var gt=(t=>(t.ABS="ABS",t.ACOS="ACOS",t.ACOSH="ACOSH",t.ACOT="ACOT",t.ACOTH="ACOTH",t.AGGREGATE="AGGREGATE",t.ARABIC="ARABIC",t.ASIN="ASIN",t.ASINH="ASINH",t.ATAN="ATAN",t.ATAN2="ATAN2",t.ATANH="ATANH",t.BASE="BASE",t.CEILING="CEILING",t.CEILING_MATH="CEILING.MATH",t.CEILING_PRECISE="CEILING.PRECISE",t.COMBIN="COMBIN",t.COMBINA="COMBINA",t.COS="COS",t.COSH="COSH",t.COT="COT",t.COTH="COTH",t.CSC="CSC",t.CSCH="CSCH",t.DECIMAL="DECIMAL",t.DEGREES="DEGREES",t.EVEN="EVEN",t.EXP="EXP",t.FACT="FACT",t.FACTDOUBLE="FACTDOUBLE",t.FLOOR="FLOOR",t.FLOOR_MATH="FLOOR.MATH",t.FLOOR_PRECISE="FLOOR.PRECISE",t.GCD="GCD",t.INT="INT",t.ISO_CEILING="ISO.CEILING",t.LCM="LCM",t.LET="LET",t.LN="LN",t.LOG="LOG",t.LOG10="LOG10",t.MDETERM="MDETERM",t.MINVERSE="MINVERSE",t.MMULT="MMULT",t.MOD="MOD",t.MROUND="MROUND",t.MULTINOMIAL="MULTINOMIAL",t.MUNIT="MUNIT",t.ODD="ODD",t.PI="PI",t.POWER="POWER",t.PRODUCT="PRODUCT",t.QUOTIENT="QUOTIENT",t.RADIANS="RADIANS",t.RAND="RAND",t.RANDARRAY="RANDARRAY",t.RANDBETWEEN="RANDBETWEEN",t.ROMAN="ROMAN",t.ROUND="ROUND",t.ROUNDDOWN="ROUNDDOWN",t.ROUNDUP="ROUNDUP",t.SEC="SEC",t.SECH="SECH",t.SERIESSUM="SERIESSUM",t.SEQUENCE="SEQUENCE",t.SIGN="SIGN",t.SIN="SIN",t.SINH="SINH",t.SQRT="SQRT",t.SQRTPI="SQRTPI",t.SUBTOTAL="SUBTOTAL",t.SUM="SUM",t.SUMIF="SUMIF",t.SUMIFS="SUMIFS",t.SUMPRODUCT="SUMPRODUCT",t.SUMSQ="SUMSQ",t.SUMX2MY2="SUMX2MY2",t.SUMX2PY2="SUMX2PY2",t.SUMXMY2="SUMXMY2",t.TAN="TAN",t.TANH="TANH",t.TRUNC="TRUNC",t))(gt||{});let Vwe=class extends xn{calculate(e,n){return new j(k.VALUE)}},Hwe=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=new Tt(0);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError())return i;if(i.isString())return new j(k.VALUE);if(n.isError())return n;i.isArray()&&(i=i.sum()),n=n.plus(i)}return n}};function jwe(t){const e=[Rt.EQUALS,Rt.NOT_EQUAL,Rt.GREATER_THAN_OR_EQUAL,Rt.GREATER_THAN,Rt.LESS_THAN_OR_EQUAL,Rt.LESS_THAN];for(const n of e)if(t.startsWith(n)){const r=t.substring(n.length);return[n,Mc.create(r)]}return[Rt.EQUALS,Mc.create(t)]}function tU(t,e,n){if(!n)if(e.isString()){const r=`${e.getValue()}`,[i,o]=jwe(r);n=i,e=o}else n=Rt.EQUALS;return t.compare(e,n)}function zwe(t,e){const n=Math.max(t.isArray()?t.getRowCount():1,e.isArray()?e.getRowCount():1),r=Math.max(t.isArray()?t.getColumnCount():1,e.isArray()?e.getColumnCount():1),i=_o(n,r,t),o=_o(n,r,e);return i.mapValue((a,s,u)=>{const l=o.get(s,u);return a!=null&&a.isError()?a:l!=null&&l.isError()?l:a!=null&&a.isBoolean()&&l!=null&&l.isBoolean()?new Zr(a.getValue()&&l.getValue()):new Zr(!1)})}let Wwe=class extends xn{calculate(e,n,r){return e==null||n==null?new j(k.NA):e.isError()||n.isError()||r!=null&&r.isError()?new j(k.NA):!e.isArray()||r&&!r.isArray()?new j(k.VALUE):n.isArray()?n.map(i=>this._handleSingleObject(e,i,r)):this._handleSingleObject(e,n,r)}_handleSingleObject(e,n,r){const i=tU(e,n),o=r?r.slice([0,e.getRowCount()],[0,e.getColumnCount()]):e;return o?o.pick(i).sum():new j(k.VALUE)}},Ywe=class extends xn{calculate(e,...n){if(e==null)return new j(k.NA);if(n.length<2)return new j(k.NA);if(e.isError())return new j(k.NA);if(!e.isArray())return new j(k.VALUE);if(n.length<2||n.length%2!==0)return new j(k.VALUE);if(n.some((c,d)=>d%2===0&&!c.isArray()))return new j(k.VALUE);const r=e.getRowCount(),i=e.getColumnCount();let o=0,a=0;n.forEach((c,d)=>{if(d%2===1)if(c.isArray()){const m=c;o=Math.max(o,m.getRowCount()),a=Math.max(a,m.getColumnCount())}else o=Math.max(o,1),a=Math.max(a,1)});const s=[];for(let c=0;c<n.length;c++){if(c%2===1)continue;const d=n[c],m=d.getRowCount(),f=d.getColumnCount();if(m!==r||f!==i)return _o(o,a,new j(k.NA));const h=n[c+1];_o(o,a,h,new j(k.NA)).iterator((p,v,g)=>{if(!p)return;const b=tU(d,p);if(s[v]===void 0&&(s[v]=[]),s[v][g]===void 0){s[v][g]=b;return}s[v][g]=zwe(s[v][g],b)})}const u=s.map(c=>c.map(d=>e.pick(d).sum())),l={calculateValueList:u,rowCount:u.length,columnCount:u[0].length,unitId:this.unitId||"",sheetId:this.subUnitId||"",row:this.row,column:this.column};return new Va(l)}};const nU=[[$we,gt.ABS],[kwe,gt.ACOS],[Bwe,gt.ACOSH],[Uwe,gt.ACOT],[Hwe,gt.SUM],[Wwe,gt.SUMIF],[Ywe,gt.SUMIFS],[Vwe,gt.POWER]];let Xwe=class extends xn{constructor(){super(...arguments),Fe(this,"_compareType",Rt.EQUALS)}setCompareType(e){this._compareType=e}calculate(e,n){return e.isError()||n.isError()?e:e.compare(n,this._compareType)}},qwe=class extends xn{calculate(e,n){return e.isError()||n.isError()?e:!n.isArray()&&n.getValue()===0?new j(k.DIV_BY_ZERO):e.divided(n)}};var po=(t=>(t.COMPARE="COMPARE",t.DIVIDED="DIVIDED",t.MINUS="MINUS",t.MULTIPLY="MULTIPLY",t.PLUS="PLUS",t.UNION="UNION",t))(po||{});let Gwe=class extends xn{calculate(e,n){return e.isError()||n.isError()?e:e.minus(n)}},Kwe=class extends xn{calculate(e,n){return e.isError()?e:n.isError()?n:e.multiply(n)}},Zwe=class extends xn{calculate(e,n){return e.isError()?e:n.isError()?n:e.plus(n)}};const rU=[[Xwe,po.COMPARE],[qwe,po.DIVIDED],[Gwe,po.MINUS],[Kwe,po.MULTIPLY],[Zwe,po.PLUS]];let Qwe=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=new Tt(0),r=new Tt(0);for(let i=0;i<e.length;i++){const o=e[i];if(o.isError())return o;if(n.isError())return n;o.isArray()?(n=n.plus(o.sum()),r=r.plus(o.count())):o.isNull()||(r=r.plus(new Tt(1)))}return n.divided(r)}},Jwe=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=new Tt(0);for(let r=0;r<e.length;r++){let i=e[r];i.isError()||(i.isArray()?(i=i.count(),n=n.plus(i)):!i.isNull()&&!i.isString()&&(n=n.plus(new Tt(1))))}return n}},eLe=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=new Tt(0);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError()){n=n.plus(new Tt(1));continue}i.isArray()?(i=i.countA(),n=n.plus(i)):i.isNull()||(n=n.plus(new Tt(1)))}return n}};var Oe=(t=>(t.AVEDEV="AVEDEV",t.AVERAGE="AVERAGE",t.AVERAGEA="AVERAGEA",t.AVERAGEIF="AVERAGEIF",t.AVERAGEIFS="AVERAGEIFS",t.BETA_DIST="BETA.DIST",t.BETA_INV="BETA.INV",t.BINOM_DIST="BINOM.DIST",t.BINOM_DIST_RANGE="BINOM.DIST.RANGE",t.BINOM_INV="BINOM.INV",t.CHISQ_DIST="CHISQ.DIST",t.CHISQ_DIST_RT="CHISQ.DIST.RT",t.CHISQ_INV="CHISQ.INV",t.CHISQ_INV_RT="CHISQ.INV.RT",t.CHISQ_TEST="CHISQ.TEST",t.CONFIDENCE_NORM="CONFIDENCE.NORM",t.CONFIDENCE_T="CONFIDENCE.T",t.CORREL="CORREL",t.COUNT="COUNT",t.COUNTA="COUNTA",t.COUNTBLANK="COUNTBLANK",t.COUNTIF="COUNTIF",t.COUNTIFS="COUNTIFS",t.COVARIANCE_P="COVARIANCE.P",t.COVARIANCE_S="COVARIANCE.S",t.DEVSQ="DEVSQ",t.EXPON_DIST="EXPON.DIST",t.F_DIST="F.DIST",t.F_DIST_RT="F.DIST.RT",t.F_INV="F.INV",t.F_INV_RT="F.INV.RT",t.F_TEST="F.TEST",t.FISHER="FISHER",t.FISHERINV="FISHERINV",t.FORECAST="FORECAST",t.FORECAST_ETS="FORECAST.ETS",t.FORECAST_ETS_CONFINT="FORECAST.ETS.CONFINT",t.FORECAST_ETS_SEASONALITY="FORECAST.ETS.SEASONALITY",t.FORECAST_ETS_STAT="FORECAST.ETS.STAT",t.FORECAST_LINEAR="FORECAST.LINEAR",t.FREQUENCY="FREQUENCY",t.GAMMA="GAMMA",t.GAMMA_DIST="GAMMA.DIST",t.GAMMA_INV="GAMMA.INV",t.GAMMALN="GAMMALN",t.GAMMALN_PRECISE="GAMMALN.PRECISE",t.GAUSS="GAUSS",t.GEOMEAN="GEOMEAN",t.GROWTH="GROWTH",t.HARMEAN="HARMEAN",t.HYPGEOM_DIST="HYPGEOM.DIST",t.INTERCEPT="INTERCEPT",t.KURT="KURT",t.LARGE="LARGE",t.LINEST="LINEST",t.LOGEST="LOGEST",t.LOGNORM_DIST="LOGNORM.DIST",t.LOGNORM_INV="LOGNORM.INV",t.MAX="MAX",t.MAXA="MAXA",t.MAXIFS="MAXIFS",t.MEDIAN="MEDIAN",t.MIN="MIN",t.MINA="MINA",t.MINIFS="MINIFS",t.MODE_MULT="MODE.MULT",t.MODE_SNGL="MODE.SNGL",t.NEGBINOM_DIST="NEGBINOM.DIST",t.NORM_DIST="NORM.DIST",t.NORM_INV="NORM.INV",t.NORM_S_DIST="NORM.S.DIST",t.NORM_S_INV="NORM.S.INV",t.PEARSON="PEARSON",t.PERCENTILE_EXC="PERCENTILE.EXC",t.PERCENTILE_INC="PERCENTILE.INC",t.PERCENTRANK_EXC="PERCENTRANK.EXC",t.PERCENTRANK_INC="PERCENTRANK.INC",t.PERMUT="PERMUT",t.PERMUTATIONA="PERMUTATIONA",t.PHI="PHI",t.POISSON_DIST="POISSON.DIST",t.PROB="PROB",t.QUARTILE_EXC="QUARTILE.EXC",t.QUARTILE_INC="QUARTILE.INC",t.RANK_AVG="RANK.AVG",t.RANK_EQ="RANK.EQ",t.RSQ="RSQ",t.SKEW="SKEW",t.SKEW_P="SKEW.P",t.SLOPE="SLOPE",t.SMALL="SMALL",t.STANDARDIZE="STANDARDIZE",t.STDEV_P="STDEV.P",t.STDEV_S="STDEV.S",t.STDEVA="STDEVA",t.STDEVPA="STDEVPA",t.STEYX="STEYX",t.T_DIST="T.DIST",t.T_DIST_2T="T.DIST.2T",t.T_DIST_RT="T.DIST.RT",t.T_INV="T.INV",t.T_INV_2T="T.INV.2T",t.T_TEST="T.TEST",t.TREND="TREND",t.TRIMMEAN="TRIMMEAN",t.VAR_P="VAR.P",t.VAR_S="VAR.S",t.VARA="VARA",t.VARPA="VARPA",t.WEIBULL_DIST="WEIBULL.DIST",t.Z_TEST="Z.TEST",t))(Oe||{});let tLe=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=new Tt(Number.NEGATIVE_INFINITY);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError())return i;i.isArray()&&(i=i.max()),!i.isNull()&&(n=this._validator(n,i))}return n}_validator(e,n){return e.isLessThan(n).getValue()&&(e=n),e}},hT=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=new Tt(Number.POSITIVE_INFINITY);for(let r=0;r<e.length;r++){let i=e[r];if(i.isError())return i;i.isArray()&&(i=i.min()),!i.isNull()&&(n=this._validator(n,i))}return n}_validator(e,n){return e.isGreaterThan(n).getValue()&&(e=n),e}};const iU=[[Qwe,Oe.AVERAGE],[Jwe,Oe.COUNT],[tLe,Oe.MAX],[hT,Oe.MIN],[hT,Oe.MIN],[eLe,Oe.COUNTA]];let nLe=class extends xn{calculate(...e){if(e.length===0)return new j(k.NA);let n=0,r=0;e.forEach(o=>{if(o.isArray()){const a=o;n=Math.max(n,a.getRowCount()),r=Math.max(r,a.getColumnCount())}else n=Math.max(n,1),r=Math.max(r,1)});let i=null;for(const o of e)i=_o(n,r,o,new j(k.NA)).mapValue((a,s,u)=>{var l,c;const d=i&&i.get(s,u);if(d!=null&&d.isError())return d;if(a.isError())return a;const m=d!=null&&d.isNull()?"":(l=d==null?void 0:d.getValue())!=null?l:"",f=a!=null&&a.isNull()?"":(c=a==null?void 0:a.getValue())!=null?c:"";return new to(`${m}${f}`)});return i||new j(k.VALUE)}};var fn=(t=>(t.ASC="ASC",t.ARRAYTOTEXT="ARRAYTOTEXT",t.BAHTTEXT="BAHTTEXT",t.CHAR="CHAR",t.CLEAN="CLEAN",t.CODE="CODE",t.CONCAT="CONCAT",t.CONCATENATE="CONCATENATE",t.DBCS="DBCS",t.DOLLAR="DOLLAR",t.EXACT="EXACT",t.FIND="FIND",t.FINDB="FINDB",t.FIXED="FIXED",t.LEFT="LEFT",t.LEFTB="LEFTB",t.LEN="LEN",t.LENB="LENB",t.LOWER="LOWER",t.MID="MID",t.MIDB="MIDB",t.NUMBERVALUE="NUMBERVALUE",t.PHONETIC="PHONETIC",t.PROPER="PROPER",t.REPLACE="REPLACE",t.REPLACEB="REPLACEB",t.REPT="REPT",t.RIGHT="RIGHT",t.RIGHTB="RIGHTB",t.SEARCH="SEARCH",t.SEARCHB="SEARCHB",t.SUBSTITUTE="SUBSTITUTE",t.T="T",t.TEXT="TEXT",t.TEXTAFTER="TEXTAFTER",t.TEXTBEFORE="TEXTBEFORE",t.TEXTJOIN="TEXTJOIN",t.TEXTSPLIT="TEXTSPLIT",t.TRIM="TRIM",t.UNICHAR="UNICHAR",t.UNICODE="UNICODE",t.UPPER="UPPER",t.VALUE="VALUE",t.VALUETOTEXT="VALUETOTEXT",t.CALL="CALL",t.EUROCONVERT="EUROCONVERT",t.REGISTER_ID="REGISTER.ID",t))(fn||{});const oU=[[nLe,fn.CONCATENATE]],aU=[],sU=[];var a7=(t=>(t.ENCODEURL="ENCODEURL",t.FILTERXML="FILTERXML",t.WEBSERVICE="WEBSERVICE",t))(a7||{});let rLe=class extends We{constructor(){super(...arguments),Fe(this,"_definedNameMap",new Map)}dispose(){this._definedNameMap.clear()}registerDefinedName(e,n,r){var i;this._definedNameMap.get(e)==null&&this._definedNameMap.set(e,new Map),(i=this._definedNameMap.get(e))==null||i.set(n,r)}removeDefinedName(e,n){var r;(r=this._definedNameMap.get(e))==null||r.delete(n)}getDefinedNameMap(e){return this._definedNameMap.get(e)}getValue(e,n){var r;return(r=this._definedNameMap.get(e))==null?void 0:r.get(n)}hasDefinedName(e){var n;return(((n=this._definedNameMap.get(e))==null?void 0:n.size)||0)!==0}};const P8=ln("univer.formula.defined-names.service");var iLe=Object.defineProperty,oLe=Object.getOwnPropertyDescriptor,aLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?oLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&iLe(e,n,i),i},sLe=(t,e)=>(n,r)=>e(n,r,t);let B_=class extends We{constructor(e){super(),Fe(this,"_unitData",{}),Fe(this,"_arrayFormulaCellData",{}),Fe(this,"_formulaData",{}),Fe(this,"_sheetNameMap",{}),Fe(this,"_forceCalculate",!1),Fe(this,"_dirtyRanges",[]),Fe(this,"_dirtyNameMap",{}),Fe(this,"_numfmtItemMap",{}),Fe(this,"_dirtyUnitFeatureMap",{}),Fe(this,"_excludedCell"),this._currentUniverService=e}dispose(){this._unitData={},this._formulaData={},this._arrayFormulaCellData={},this._sheetNameMap={},this._dirtyRanges=[],this._dirtyNameMap={},this._numfmtItemMap={},this._dirtyUnitFeatureMap={},this._excludedCell={}}getExcludedRange(){return this._excludedCell}getUnitData(){return this._unitData}getFormulaData(){return this._formulaData}getArrayFormulaCellData(){return this._arrayFormulaCellData}getSheetNameMap(){return this._sheetNameMap}isForceCalculate(){return this._forceCalculate}getDirtyRanges(){return this._dirtyRanges}getDirtyNameMap(){return this._dirtyNameMap}getNumfmtItemMap(){return this._numfmtItemMap}getDirtyUnitFeatureMap(){return this._dirtyUnitFeatureMap}load(e){if(e.allUnitData&&e.unitSheetNameMap)this._unitData=e.allUnitData,this._sheetNameMap=e.unitSheetNameMap;else{const{allUnitData:n,unitSheetNameMap:r}=this._loadSheetData();this._unitData=n,this._sheetNameMap=r}this._formulaData=e.formulaData,this._arrayFormulaCellData=RB(e.arrayFormulaCellData),this._forceCalculate=e.forceCalculate,this._dirtyRanges=e.dirtyRanges,this._dirtyNameMap=e.dirtyNameMap,this._numfmtItemMap=e.numfmtItemMap,this._dirtyUnitFeatureMap=e.dirtyUnitFeatureMap,this._excludedCell=e.excludedCell,this._mergeNameMap(this._sheetNameMap,this._dirtyNameMap)}loadDirtyRangesAndExcludedCell(e,n){this._dirtyRanges=e,this._excludedCell=n,this._dirtyNameMap={}}registerUnitData(e){this._unitData=e}registerFormulaData(e){this._formulaData=e}registerSheetNameMap(e){this._sheetNameMap=e}_mergeNameMap(e,n){Object.keys(n).forEach(r=>{n[r]&&Object.keys(n[r]).forEach(i=>{e[r]==null&&(e[r]={}),e[r][n[r][i]]=i})})}_loadSheetData(){const e=this._currentUniverService.getAllUniverSheetsInstance(),n={},r={};for(const i of e){const o=i.getUnitId(),a=i.getSheets(),s={},u={};for(const l of a){const c=l.getSheetId(),d=l.getConfig();s[c]={cellData:new Ye(d.cellData),rowCount:d.rowCount,columnCount:d.columnCount},u[l.getName()]=l.getSheetId()}n[o]=s,r[o]=u}return{allUnitData:n,unitSheetNameMap:r}}};B_=aLe([sLe(0,ae)],B_);const Zc=ln("univer.formula.current-data.service");var uLe=Object.defineProperty,lLe=Object.getOwnPropertyDescriptor,cLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?lLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&uLe(e,n,i),i},dLe=(t,e)=>(n,r)=>e(n,r,t),M1=(t=>(t[t.IDLE=0]="IDLE",t[t.START_DEPENDENCY=1]="START_DEPENDENCY",t[t.START_CALCULATION=2]="START_CALCULATION",t[t.CURRENTLY_CALCULATING=3]="CURRENTLY_CALCULATING",t[t.START_DEPENDENCY_ARRAY_FORMULA=4]="START_DEPENDENCY_ARRAY_FORMULA",t[t.START_CALCULATION_ARRAY_FORMULA=5]="START_CALCULATION_ARRAY_FORMULA",t[t.CURRENTLY_CALCULATING_ARRAY_FORMULA=6]="CURRENTLY_CALCULATING_ARRAY_FORMULA",t[t.CALCULATION_COMPLETED=7]="CALCULATION_COMPLETED",t))(M1||{}),j1=(t=>(t[t.INITIAL=0]="INITIAL",t[t.STOP_EXECUTION=1]="STOP_EXECUTION",t[t.NOT_EXECUTED=2]="NOT_EXECUTED",t[t.SUCCESS=3]="SUCCESS",t))(j1||{});let U_=class extends We{constructor(e){super(),Fe(this,"_formulaExecuteStage",0),Fe(this,"_stopState",!1),Fe(this,"_currentRow",-1),Fe(this,"_currentColumn",-1),Fe(this,"_currentRowCount",Number.NEGATIVE_INFINITY),Fe(this,"_currentColumnCount",Number.NEGATIVE_INFINITY),Fe(this,"_currentSubUnitId",""),Fe(this,"_currentUnitId",""),Fe(this,"_runtimeData",{}),Fe(this,"_runtimeOtherData",{}),Fe(this,"_unitArrayFormulaRange",{}),Fe(this,"_runtimeArrayFormulaCellData",{}),Fe(this,"_runtimeClearArrayFormulaCellData",{}),Fe(this,"_numfmtItemMap",{}),Fe(this,"_runtimeFeatureRange",{}),Fe(this,"_runtimeFeatureCellData",{}),Fe(this,"_functionsExecutedState",0),Fe(this,"_functionDefinitionPrivacyVar",new Map),Fe(this,"_totalFormulasToCalculate",0),Fe(this,"_completedFormulasCount",0),Fe(this,"_totalArrayFormulasToCalculate",0),Fe(this,"_completedArrayFormulasCount",0),Fe(this,"_isCycleDependency",!1),this._currentConfigService=e}get currentRow(){return this._currentRow}get currentColumn(){return this._currentColumn}get currentRowCount(){return this._currentRowCount}get currentColumnCount(){return this._currentColumnCount}get currentSubUnitId(){return this._currentSubUnitId}get currentUnitId(){return this._currentUnitId}dispose(){this.reset(),this._runtimeFeatureCellData={},this._runtimeFeatureRange={}}enableCycleDependency(){this._isCycleDependency=!0}disableCycleDependency(){this._isCycleDependency=!1}isCycleDependency(){return this._isCycleDependency}setTotalArrayFormulasToCalculate(e){this._totalArrayFormulasToCalculate=e}getTotalArrayFormulasToCalculate(){return this._totalArrayFormulasToCalculate}setCompletedArrayFormulasCount(e){this._completedArrayFormulasCount=e}getCompletedArrayFormulasCount(){return this._completedArrayFormulasCount}setTotalFormulasToCalculate(e){this._totalFormulasToCalculate=e}getTotalFormulasToCalculate(){return this._totalFormulasToCalculate}setCompletedFormulasCount(e){this._completedFormulasCount=e}getCompletedFormulasCount(){return this._completedFormulasCount}markedAsSuccessfullyExecuted(){this._functionsExecutedState=3}markedAsNoFunctionsExecuted(){this._functionsExecutedState=2}markedAsStopFunctionsExecuted(){this._functionsExecutedState=1}markedAsInitialFunctionsExecuted(){this._functionsExecutedState=0}stopExecution(){this._stopState=!0,this.setFormulaExecuteStage(0)}isStopExecution(){return this._stopState}setFormulaExecuteStage(e){this._formulaExecuteStage=e}getFormulaExecuteStage(){return this._formulaExecuteStage}reset(){this._formulaExecuteStage=0,this._runtimeData={},this._runtimeOtherData={},this._unitArrayFormulaRange={},this._numfmtItemMap={},this._runtimeArrayFormulaCellData={},this._runtimeClearArrayFormulaCellData={},this._functionDefinitionPrivacyVar.clear(),this.markedAsInitialFunctionsExecuted(),this._isCycleDependency=!1,this._totalFormulasToCalculate=0,this._completedFormulasCount=0}setCurrent(e,n,r,i,o,a){this._currentRow=e,this._currentColumn=n,this._currentRowCount=r,this._currentColumnCount=i,this._currentSubUnitId=o,this._currentUnitId=a}clearFunctionDefinitionPrivacyVar(){this._functionDefinitionPrivacyVar.clear()}registerFunctionDefinitionPrivacyVar(e,n){this._functionDefinitionPrivacyVar.set(e,n)}getFunctionDefinitionPrivacyVar(e){return this._functionDefinitionPrivacyVar.get(e)}setRuntimeOtherData(e,n){const r=this._currentSubUnitId,i=this._currentUnitId;this._runtimeOtherData[i]===void 0&&(this._runtimeOtherData[i]={});const o=this._runtimeOtherData[i];o[r]===void 0&&(o[r]={});const a=o[r];a[e]=this._objectValueToCellValue(n)}setRuntimeData(e){const n=this._currentRow,r=this._currentColumn,i=this._currentRowCount,o=this.currentColumnCount,a=this._currentSubUnitId,s=this._currentUnitId;this._runtimeData[s]==null&&(this._runtimeData[s]={});const u=this._runtimeData[s];u[a]==null&&(u[a]=new Ye),this._unitArrayFormulaRange[s]==null&&(this._unitArrayFormulaRange[s]={}),this._numfmtItemMap[s]==null&&(this._numfmtItemMap[s]={}),this._numfmtItemMap[s][a]==null&&(this._numfmtItemMap[s][a]={});const l=this._numfmtItemMap[s][a],c=this._unitArrayFormulaRange[s];let d=new Ye;c[a]&&(d=new Ye(c[a])),this._runtimeArrayFormulaCellData[s]===void 0&&(this._runtimeArrayFormulaCellData[s]={});const m=this._runtimeArrayFormulaCellData[s];m[a]==null&&(m[a]=new Ye),this._runtimeClearArrayFormulaCellData[s]===void 0&&(this._runtimeClearArrayFormulaCellData[s]={});const f=this._runtimeClearArrayFormulaCellData[s];f[a]==null&&(f[a]=new Ye);const h=u[a],p=m[a],v=f[a];if(e.isReferenceObject()||e.isValueObject()&&e.isArray()){const g=e,{startRow:b,startColumn:C,endRow:S,endColumn:E}=g.getRangePosition();if(b===S&&C===E){const D=g.getFirstCell(),R=this._objectValueToCellValue(D);h.setValue(n,r,R),v.setValue(n,r,R),l[n]==null&&(l[n]={}),l[n][r]=D.getPattern();return}const y={startRow:n,startColumn:r,endRow:S-b+n,endColumn:E-C+r};if(d.setValue(n,r,y),c[a]=d.getData(),this._checkIfArrayFormulaRangeHasData(s,a,n,r,y)||this._checkIfArrayFormulaExceeded(i,o,y)){const D=this._objectValueToCellValue(new j(k.SPILL));h.setValue(n,r,D),v.setValue(n,r,D)}else{const D=new j(k.SPILL);g.iterator((R,I,T)=>{const P=this._objectValueToCellValue(R);if(I===b&&T===C){if(R!=null&&R.isError()&&R.isEqualType(D))return v.setValue(n,r,{}),h.setValue(n,r,{...this._objectValueToCellValue(D)}),!1;h.setValue(n,r,{...P})}const N=I-b+n,B=T-C+r;p.setValue(N,B,P);const W=R==null?void 0:R.getPattern();W&&(l[N]==null&&(l[N]={}),l[N][B]=W)})}}else{const g=this._objectValueToCellValue(e);h.setValue(n,r,g),l[n]==null&&(l[n]={}),l[n][r]=e.getPattern(),v.setValue(n,r,g)}}getUnitData(){return this._runtimeData}getUnitArrayFormula(){return this._unitArrayFormulaRange}getNumfmtItemMap(){return this._numfmtItemMap}getRuntimeOtherData(){return this._runtimeOtherData}getRuntimeArrayFormulaCellData(){return this._runtimeArrayFormulaCellData}getRuntimeClearArrayFormulaCellData(){return this._runtimeClearArrayFormulaCellData}getRuntimeFeatureRange(){return this._runtimeFeatureRange}setRuntimeFeatureRange(e,n){this._runtimeFeatureRange[e]=n}getRuntimeFeatureCellData(){return this._runtimeFeatureCellData}setRuntimeFeatureCellData(e,n){this._runtimeFeatureCellData[e]=n}getAllRuntimeData(){return{unitData:this.getUnitData(),arrayFormulaRange:this.getUnitArrayFormula(),unitOtherData:this.getRuntimeOtherData(),functionsExecutedState:this._functionsExecutedState,arrayFormulaCellData:this.getRuntimeArrayFormulaCellData(),clearArrayFormulaCellData:this.getRuntimeClearArrayFormulaCellData(),numfmtItemMap:this.getNumfmtItemMap(),runtimeFeatureRange:this.getRuntimeFeatureRange(),runtimeFeatureCellData:this.getRuntimeFeatureCellData()}}getRuntimeState(){return{totalFormulasToCalculate:this.getTotalFormulasToCalculate(),completedFormulasCount:this.getCompletedFormulasCount(),totalArrayFormulasToCalculate:this.getTotalArrayFormulasToCalculate(),completedArrayFormulasCount:this.getCompletedArrayFormulasCount(),stage:this.getFormulaExecuteStage()}}_objectValueToCellValue(e){if(e==null)return{v:0,t:$n.NUMBER};if(e.isError())return{v:e.getErrorType(),t:$n.STRING};if(e.isValueObject()){const n=e,r=n.getValue();return n.isNumber()?{v:r,t:$n.NUMBER}:n.isBoolean()?{v:r,t:$n.BOOLEAN}:n.isString()&&n5(r)?{v:r,t:$n.FORCE_STRING}:{v:r,t:$n.STRING}}}_checkIfArrayFormulaRangeHasData(e,n,r,i,o){var a,s,u,l,c,d,m,f,h,p,v,g;const{startRow:b,startColumn:C,endRow:S,endColumn:E}=o,y=this._currentConfigService.getUnitData(),D=(u=(s=(a=this._unitArrayFormulaRange[e])==null?void 0:a[n])==null?void 0:s[r])==null?void 0:u[i];for(let R=b;R<=S;R++)for(let I=C;I<=E;I++){if(R===r&&i===I)continue;const T=(d=(c=(l=this._runtimeData)==null?void 0:l[e])==null?void 0:c[n])==null?void 0:d.getValue(R,I),P=(h=(f=(m=this._runtimeArrayFormulaCellData)==null?void 0:m[e])==null?void 0:f[n])==null?void 0:h.getValue(R,I),N=(g=(v=(p=y==null?void 0:y[e])==null?void 0:p[n])==null?void 0:v.cellData)==null?void 0:g.getValue(R,I);if(!T6(T)||!T6(P)&&!this._isInArrayFormulaRange(D,R,I)||!T6(N))return!0}return!1}_isInArrayFormulaRange(e,n,r){if(e==null)return!1;const{startRow:i,startColumn:o,endRow:a,endColumn:s}=e;return n>=i&&n<=a&&r>=o&&r<=s}_checkIfArrayFormulaExceeded(e,n,r){return r.endRow>=e||r.endColumn>=n}_isInDirtyRange(e,n,r,i){const o=this._currentConfigService.getDirtyRanges();return o.length===0?!0:DTe(o,e,n,r,i)}};U_=cLe([dLe(0,Zc)],U_);const ks=ln("univer.formula.runtime.service");var mLe=Object.defineProperty,fLe=Object.getOwnPropertyDescriptor,hLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?fLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&mLe(e,n,i),i},Og=(t,e)=>(n,r)=>e(n,r,t);let xc=class extends We{constructor(e,n,r){super(),this._definedNamesService=e,this._runtimeService=n,this._lexerTreeBuilder=r}treeBuilder(e,n=!0){return this._lexerTreeBuilder.treeBuilder(e,n,this._injectDefinedName.bind(this))}_injectDefinedName(e){var n;const r=this._runtimeService.currentUnitId;if(!this._definedNamesService.hasDefinedName(r))return{sequenceString:"",hasDefinedName:!1};const i=this._lexerTreeBuilder.getSequenceNode(e);let o="",a=!1;for(let s=0,u=i.length;s<u;s++){const l=i[s];if(typeof l=="string"){o+=l;continue}const{nodeType:c,token:d}=l;if(c===ni.REFERENCE||c===ni.FUNCTION){const m=(n=this._definedNamesService.getDefinedNameMap(r))==null?void 0:n.get(d);m?(o+=m,a=!0):o+=d}else o+=d}return{sequenceString:o,hasDefinedName:a}}};xc=hLe([Og(0,P8),Og(1,ks),Og(2,K(E1))],xc);var Pn=(t=>(t.REFERENCE="ReferenceNode",t.VALUE="ValueNode",t.OPERATOR="OperatorNode",t.FUNCTION="FunctionNode",t.LAMBDA="LambdaNode",t.LAMBDA_PARAMETER="LambdaNodeParameter",t.ERROR="ErrorNode",t.BASE="Base",t.ROOT="Root",t.UNION="UnionNode",t.PREFIX="PrefixNode",t.SUFFIX="SuffixNode",t.NULL="NullNode",t))(Pn||{});const y1=new Map([["ReferenceNode",7],["ValueNode",9],["OperatorNode",8],["FunctionNode",6],["LambdaNode",1],["LambdaNodeParameter",2],["Root",10],["UnionNode",3],["PrefixNode",4],["SuffixNode",5]]);let Sa=class extends We{constructor(e){super(),Fe(this,"_children",[]),Fe(this,"_parent"),Fe(this,"_valueObject"),Fe(this,"_calculateState",!1),Fe(this,"_async",!1),Fe(this,"_address",!1),Fe(this,"_refOffsetX",0),Fe(this,"_refOffsetY",0),this._token=e}dispose(){var e;this._children.forEach(n=>{n.dispose()}),(e=this._valueObject)==null||e.dispose(),this._parent=null}get nodeType(){return Pn.BASE}isAsync(){return this._async}isAddress(){return this._address}setAsync(){this._async=!0}setAddress(){this._address=!0}getParent(){return this._parent}setParent(e){this._parent=e,e.addChildren(this)}getChildren(){return this._children}addChildren(...e){this._children.push(...e)}getToken(){return this._token}setValue(e){this._valueObject=e}getValue(){return this._valueObject}isCalculated(){return this._calculateState}setCalculated(){this._calculateState=!0}execute(){}setNotEmpty(e=!0){}setRefOffset(e=0,n=0){this._refOffsetX=e,this._refOffsetY=n}getRefOffset(){return{x:this._refOffsetX,y:this._refOffsetY}}async executeAsync(){return Promise.resolve(dc.SUCCESS)}serialize(){const e=this.getToken(),n=this.getChildren(),r=[],i=n.length;for(let a=0;a<i;a++){const s=n[a];r.push(s.serialize())}const o={token:e,nodeType:this.nodeType};return i>0&&(o.children=r),o}},no=class uU extends Sa{constructor(e){super(e),Fe(this,"_errorValueObject"),this._errorValueObject=new j(e)}get nodeType(){return Pn.ERROR}static create(e){return new uU(e)}getValue(){return this._errorValueObject}};const D1=100;let R1=class extends We{get zIndex(){return 0}create(e,n,r){let i;return e instanceof Fn?i=e.getToken():i=e,new Sa(i)}checkAndCreateNodeType(e){}},V_=class extends Sa{get nodeType(){return Pn.ROOT}execute(){const e=this.getChildren()[0];this.setValue(e.getValue())}},lU=class extends R1{get zIndex(){return y1.get(Pn.ROOT)||D1}checkAndCreateNodeType(e){if(e instanceof Fn&&e.getToken()===el)return new V_(el)}},pLe=class extends We{constructor(){super(...arguments),Fe(this,"_functionExecutors",new Map),Fe(this,"_functionDescriptions",new Map)}dispose(){this._functionExecutors.clear(),this._functionDescriptions.clear()}registerExecutors(...e){for(let n=0;n<e.length;n++){const r=e[n];this._functionExecutors.set(r.name,r)}}getExecutors(){return this._functionExecutors}getExecutor(e){return this._functionExecutors.get(e)}hasExecutor(e){return this._functionExecutors.has(e)}unregisterExecutors(...e){for(let n=0;n<e.length;n++){const r=e[n];this._functionExecutors.delete(r)}}registerDescriptions(...e){for(let n=0;n<e.length;n++){const r=e[n];this._functionDescriptions.set(r.functionName,r)}}getDescriptions(){return this._functionDescriptions}getDescription(e){return this._functionDescriptions.get(e)}hasDescription(e){return this._functionDescriptions.has(e)}unregisterDescriptions(...e){for(let n=0;n<e.length;n++){const r=e[n];this._functionDescriptions.delete(r)}}};const Bs=ln("univer.formula.function.service");var gLe=Object.defineProperty,vLe=Object.getOwnPropertyDescriptor,bLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?vLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&gLe(e,n,i),i},pT=(t,e)=>(n,r)=>e(n,r,t);let L9=class extends Sa{constructor(e,n,r){super(n),this._accessor=e,this._operatorString=n,this._functionExecutor=r}get nodeType(){return Pn.PREFIX}execute(){let e=this.getChildren()[0].getValue(),n;if(e==null)throw new Error("object is null");e.isReferenceObject()&&(e=e.toArrayValueObject()),this._operatorString===pi.MINUS?n=this._functionExecutor.calculate(new Tt(0),e):this._operatorString===pi.AT?n=this._handlerAT(e):n=new j(k.VALUE),this.setValue(n)}_handlerAT(e){if(!e.isReferenceObject())return new j(k.VALUE);const n=e;if(n.isCell())return new j(k.VALUE);const r=this._accessor.get(ks),i=r.currentRow||0,o=r.currentColumn||0;return n.isRow()?n.getCellByColumn(o):n.isColumn()?n.getCellByRow(i):n.isRange()||n.isTable()?n.getCellByPosition():new j(k.VALUE)}},O9=class extends R1{constructor(e,n){super(),this._functionService=e,this._injector=n}get zIndex(){return y1.get(Pn.PREFIX)||D1}checkAndCreateNodeType(e){if(!(e instanceof Fn))return;const n=e.getToken(),r=n.trim();if(r.charAt(0)==='"'&&r.charAt(r.length-1)==='"')return;let i="";if(r===pi.MINUS)i=po.MINUS;else return r===pi.AT?new L9(this._injector,r):void 0;const o=this._functionService.getExecutor(i);return o?new L9(this._injector,r,o):(console.error(`No function ${n}`),no.create(k.NAME))}};O9=bLe([pT(0,Bs),pT(1,K(wn))],O9);var _Le=Object.defineProperty,CLe=Object.getOwnPropertyDescriptor,SLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?CLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&_Le(e,n,i),i},H3=(t,e)=>(n,r)=>e(n,r,t);let ELe=class extends Sa{constructor(e,n,r,i){super(e),this._functionExecutor=n,this._currentConfigService=r,this._runtimeService=i,this._functionExecutor.isAsync()&&this.setAsync(),this._functionExecutor.isAddress()&&this.setAddress()}get nodeType(){return Pn.FUNCTION}async executeAsync(){const e=[],n=this.getChildren(),r=n.length;this._compatibility();for(let a=0;a<r;a++){const s=n[a].getValue();s!=null&&(s.isReferenceObject()?e.push(s.toArrayValueObject()):e.push(s))}const i=this._calculate(e);let o;return i.isAsyncObject()||i.isAsyncArrayObject()?o=await i.getValue():o=i,this._setRefData(o),this.setValue(o),Promise.resolve(dc.SUCCESS)}execute(){const e=[],n=this.getChildren(),r=n.length;this._compatibility();for(let o=0;o<r;o++){const a=n[o].getValue();a!=null&&(a.isReferenceObject()?e.push(a.toArrayValueObject()):e.push(a))}const i=this._calculate(e);this._setRefData(i),this.setValue(i)}_compatibility(){this._lookupCompatibility()}_lookupCompatibility(){const e=this.getChildren(),n=e.length;if(this._functionExecutor.name!=="LOOKUP"||n!==3)return;const r=e[1].getValue(),i=e[2].getValue();if(!(r!=null&&r.isReferenceObject())&&!(i!=null&&i.isReferenceObject()))return;const o=r.getRangeData(),a=i.getRangeData(),{startRow:s,startColumn:u,endRow:l,endColumn:c}=o,d=l-s+1,m=c-u+1,{startRow:f,startColumn:h,endRow:p,endColumn:v}=a,g=p-f+1,b=v-h+1;d!==g&&(a.endRow+=d-g),m!==b&&(a.endColumn+=m-b)}_calculate(e){var n;let r;if(this._setRefInfo(),this._functionExecutor.isCustom()){const i=this._functionExecutor.calculateCustom(...e.map(o=>o.isArray()?o.toValue():o.getValue()));if(typeof i!="object"||i==null)r=Mc.create(i);else{const o=awe(i);r=new Va({calculateValueList:o,rowCount:o.length,columnCount:((n=o[0])==null?void 0:n.length)||0,unitId:"",sheetId:"",row:-1,column:-1})}}else r=this._functionExecutor.calculate(...e);return r}_setRefInfo(){const{currentUnitId:e,currentSubUnitId:n,currentRow:r,currentColumn:i}=this._runtimeService;this._functionExecutor.setRefInfo(e,n,r,i)}_setRefData(e){if(!e.isReferenceObject())return;const n=e;n.setForcedSheetId(this._currentConfigService.getSheetNameMap()),n.setUnitData(this._currentConfigService.getUnitData()),n.setArrayFormulaCellData(this._currentConfigService.getArrayFormulaCellData()),n.setRuntimeData(this._runtimeService.getUnitData()),n.setRuntimeArrayFormulaCellData(this._runtimeService.getRuntimeArrayFormulaCellData()),n.setRuntimeFeatureCellData(this._runtimeService.getRuntimeFeatureCellData())}},P9=class extends R1{constructor(e,n,r,i){super(),this._functionService=e,this._currentConfigService=n,this._runtimeService=r,this._injector=i}get zIndex(){return y1.get(Pn.FUNCTION)||D1}create(e){const n=this._functionService.getExecutor(e);return n?new ELe(e,n,this._currentConfigService,this._runtimeService):(console.error(`No function ${e}`),no.create(k.NAME))}checkAndCreateNodeType(e){if(typeof e=="string")return;let n=e.getToken().trim().toUpperCase(),r,i;const o=n.slice(0,2);let a=0;if(new RegExp(pi.MINUS,"g").test(o)){const s=this._functionService.getExecutor(po.MINUS);r=new L9(this._injector,pi.MINUS,s),a++}if(new RegExp(pi.AT,"g").test(o)&&(i=new L9(this._injector,pi.AT),r&&i.setParent(r),a++),a>0&&(n=n.slice(a)),this._functionService.hasExecutor(n)){const s=this.create(n);return i?s.setParent(i):r&&s.setParent(r),s}}};P9=SLe([H3(0,Bs),H3(1,Zc),H3(2,ks),H3(3,K(wn))],P9);var yLe=Object.defineProperty,DLe=Object.getOwnPropertyDescriptor,RLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?DLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&yLe(e,n,i),i},ILe=(t,e)=>(n,r)=>e(n,r,t);let B0=class extends We{constructor(e){super(),this._runtimeService=e}dispose(){}async executeAsync(e){if(!e)return new j(k.VALUE);await this._executeAsync(e);const n=e.getValue();if(n==null)throw new Error("node value is null");return Promise.resolve(n)}execute(e){if(!e)return new j(k.VALUE);this._execute(e);const n=e.getValue();if(n==null)throw new Error("node value is null");return n}executePreCalculateNode(e){return e.execute(),e.getValue()}checkAsyncNode(e){const n=[];this._checkAsyncNode(e,n);for(let r=0,i=n.length;r<i;r++)if(n[r]===!0)return!0;return!1}_checkAsyncNode(e,n){const r=e.getChildren(),i=r.length;for(let o=0;o<i;o++){const a=r[o];n.push(a.isAsync()),this._checkAsyncNode(a,n)}}async _executeAsync(e){if(this._runtimeService.isStopExecution())return Promise.resolve(dc.ERROR);const n=e.getChildren(),r=n.length;for(let i=0;i<r;i++){const o=n[i];if(o.getToken().toUpperCase()===xm&&o.isEmptyParamFunction()){o.execute();continue}await this._executeAsync(o)}return e.nodeType===Pn.FUNCTION&&e.isAsync()?await e.executeAsync():e.execute(),Promise.resolve(dc.SUCCESS)}_execute(e){if(this._runtimeService.isStopExecution())return dc.ERROR;const n=e.getChildren(),r=n.length;for(let i=0;i<r;i++){const o=n[i];if(o.getToken().toUpperCase()===xm&&o.isEmptyParamFunction()){o.execute();continue}this._execute(o)}return e.execute(),dc.SUCCESS}};B0=RLe([ILe(0,ks)],B0);function cU(t){return t instanceof Fn?t.getToken()===k0:!1}function ALe(t){return t instanceof Fn?t.getToken()===LB:!1}function dU(t){if(!t)return;if(t.getToken()!==Rf)return t;const e=t,n=e.getCurrentLambdaPrivacyVar(),r=e.getLambdaParameter();if(!n)return;const i=n.get(r);return i==null&&t.getValue()?t:dU(i)}let TLe=class extends qc{constructor(e,n,r){super(0),Fe(this,"_lambdaPrivacyValueMap",new Map),this._lambdaNode=e,this._interpreter=n,this._lambdaPrivacyVarKeys=r,this._lambdaPrivacyValueMap.clear()}isLambda(){return!0}execute(...e){const n=this._lambdaPrivacyVarKeys.length;if(e.length!==n)return new j(k.VALUE);this._setLambdaPrivacyValueMap(e),this._setLambdaNodeValue(this._lambdaNode),this._lambdaNode.setNotEmpty(!1);let r;if(this._interpreter.checkAsyncNode(this._lambdaNode))r=new cwe(this._interpreter.executeAsync(this._lambdaNode));else{const i=this._interpreter.execute(this._lambdaNode);i.isReferenceObject()?r=i.toArrayValueObject():r=i}return this._lambdaNode.setNotEmpty(!0),r}_setLambdaNodeValue(e){const n=e.getChildren(),r=n.length;for(let i=0;i<r;i++){const o=n[i];if(o.getToken()===Rf){const a=o.getLambdaParameter(),s=this._lambdaPrivacyValueMap.get(a);if(s)o.setValue(s);else{const u=o.getCurrentLambdaPrivacyVar(),l=dU(u.get(a));l!=null&&o.setValue(l.getValue())}continue}this._setLambdaNodeValue(o)}}_setLambdaPrivacyValueMap(e){for(let n=0;n<e.length;n++){const r=e[n],i=this._lambdaPrivacyVarKeys[n];this._lambdaPrivacyValueMap.set(i,r)}}};var wLe=Object.defineProperty,LLe=Object.getOwnPropertyDescriptor,OLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?LLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&wLe(e,n,i),i},gT=(t,e)=>(n,r)=>e(n,r,t);let PLe=class extends Sa{constructor(e,n,r,i){super(e),Fe(this,"_isNotEmpty",!0),this._lambdaId=n,this._interpreter=r,this._lambdaPrivacyVarKeys=i}get nodeType(){return Pn.LAMBDA}setNotEmpty(e=!1){this._isNotEmpty=e}isEmptyParamFunction(){return this.getChildren().length<2&&this._isNotEmpty}isFunctionParameter(){return this._lambdaId===null}getLambdaId(){return this._lambdaId}execute(){if(this.isEmptyParamFunction())this.setValue(new TLe(this,this._interpreter,this._lambdaPrivacyVarKeys));else{const e=this.getChildren(),n=e.length;this.setValue(e[n-1].getValue())}}},M9=class extends R1{constructor(e,n){super(),this._runtimeService=e,this._interpreter=n}get zIndex(){return y1.get(Pn.LAMBDA)||D1}create(e){const n=e.getChildren(),r=n[0];let i=n.slice(1,-1);const o=n[n.length-1];if(!(r instanceof Fn&&o instanceof Fn))return no.create(k.NAME);if(r.getToken()===k0){const u=r.getChildren();if(i.length!==u.length)return no.create(k.VALUE)}else i=n.slice(0,-1);const a=Ie.generateRandomId(8),s=new Map;for(let u=0;u<i.length;u++){const l=i[u];if(l instanceof Fn){const c=l.getChildren()[0];l.setToken(LB),s.set(c.trim(),void 0)}else return no.create(k.VALUE)}return this._runtimeService.registerFunctionDefinitionPrivacyVar(a,s),this._updateLambdaStatement(o,a,s),new PLe(e.getToken(),a,this._interpreter,[...s.keys()])}checkAndCreateNodeType(e){if(!(!(e instanceof Fn)||e.getToken().trim().toUpperCase()!==xm))return this.create(e)}_updateLambdaStatement(e,n,r){this._updateTree(e,n,r)}_updateTree(e,n,r){const i=e.getChildren(),o=i.length,a=i[0];for(let s=0;s<o;s++){const u=i[s];if(!(cU(a)&&s!==0))if(u instanceof Fn)this._updateTree(u,n,r);else{const l=u.trim();if(r.has(l)){const c=new Fn;c.setToken(Rf),c.setLambdaId(n),c.setLambdaPrivacyVar(r),c.setLambdaParameter(l),i[s]=c}}}}};M9=OLe([gT(0,ks),gT(1,K(B0))],M9);function mU(t){if(!t)return;if(t.getToken()!==Rf)return t;const e=t,n=e.getCurrentLambdaPrivacyVar(),r=e.getLambdaParameter();if(n)return mU(n.get(r))}let MLe=class extends Sa{constructor(e,n,r){super(e),this._lambdaParameter=n,this._currentLambdaPrivacyVar=r}getLambdaParameter(){return this._lambdaParameter}getCurrentLambdaPrivacyVar(){return this._currentLambdaPrivacyVar}get nodeType(){return Pn.LAMBDA_PARAMETER}execute(){const e=mU(this._currentLambdaPrivacyVar.get(this._lambdaParameter));if(e)this.setValue(e.getValue());else{const n=this.getValue();(n==null||n.isError())&&this.setValue(new j(k.SPILL))}}},fU=class extends R1{get zIndex(){return y1.get(Pn.LAMBDA_PARAMETER)||D1}create(e){const n=e.getFunctionDefinitionPrivacyVar(),r=e.getLambdaParameter();return n?new MLe(e.getToken(),r,n):new no(k.SPILL)}checkAndCreateNodeType(e){if(!(!(e instanceof Fn)||e.getToken().trim()!==Rf))return this.create(e)}},NLe=class extends Sa{constructor(e){super(e),this._operatorString=e}get nodeType(){return Pn.NULL}execute(){this.setValue(new G1(0))}};var xLe=Object.defineProperty,FLe=Object.getOwnPropertyDescriptor,$Le=(t,e,n,r)=>{for(var i=r>1?void 0:r?FLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&xLe(e,n,i),i},kLe=(t,e)=>(n,r)=>e(n,r,t);let BLe=class extends Sa{constructor(e,n){super(e),this._operatorString=e,this._functionExecutor=n}get nodeType(){return Pn.OPERATOR}execute(){const e=this.getChildren();this._functionExecutor.name===po.COMPARE&&this._functionExecutor.setCompareType(this.getToken());let n=e[0].getValue(),r=e[1].getValue();if(n==null||r==null)throw new Error("object1 or object2 is null");n.isReferenceObject()&&(n=n.toArrayValueObject()),r.isReferenceObject()&&(r=r.toArrayValueObject()),this.setValue(this._functionExecutor.calculate(n,r))}},N9=class extends R1{constructor(e){super(),this._functionService=e}get zIndex(){return y1.get(Pn.OPERATOR)||D1}create(e){let n="";const r=e;r===sa.PLUS?n=po.PLUS:r===sa.MINUS?n=po.MINUS:r===sa.MULTIPLY?n=po.MULTIPLY:r===sa.DIVIDED?n=po.DIVIDED:r===sa.CONCATENATE?n=fn.CONCATENATE:r===sa.POWER?n=gt.POWER:RTe.has(r)&&(n=po.COMPARE);const i=this._functionService.getExecutor(n);return i?new BLe(r,i):(console.error(`No function ${e}`),no.create(k.NAME))}checkAndCreateNodeType(e){if(e instanceof Fn)return;const n=e.trim();if(!(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')&&E6.has(n))return this.create(n)}};N9=$Le([kLe(0,Bs)],N9);let ULe=class extends We{constructor(){super(...arguments),Fe(this,"_tableMap",new Map),Fe(this,"_tableOptionMap",new Map)}dispose(){this._tableMap.clear(),this._tableOptionMap.clear()}remove(e,n){var r;(r=this._tableMap.get(e))==null||r.delete(n)}getTableMap(e){return this._tableMap.get(e)}getTableOptionMap(){return this._tableOptionMap}registerTable(e,n,r){var i;this._tableMap.get(e)==null&&this._tableMap.set(e,new Map),(i=this._tableMap.get(e))==null||i.set(n,r)}registerTableOptionMap(e,n){this._tableOptionMap.set(e,n)}};const qE=ln("univer.formula.super-table.service");let VLe=class extends Af{constructor(e,n,r,i){super(e),this._tableData=n,this._columnDataString=r;const o=this._tableData.sheetId,a=this._tableData.range,s=this._tableData.titleMap;this.setForcedSheetIdDirect(o);const u=this._stringToColumnData(this._columnDataString,s,i),l=u.startColumn,c=u.endColumn,d=u.type;let m=-1,f=-1;const h=a.startRow,p=a.startColumn;d===ec.ALL?(m=h,f=p):d===ec.DATA?(m=h+1,f=p):d===ec.HEADERS?(m=h,f=h):d===ec.TOTALS&&(m=p,f=p),this.setRangeData({startColumn:l,endColumn:c,startRow:m,endRow:f})}isTable(){return!0}_stringToColumnData(e,n,r){e=e.substring(1,-1);const i=e.indexOf(bn.COMMA);let o=-1,a=-1,s=ec.ALL;if(i===-1){const u=this._columnHandler(e,n);o=u.startColumn,a=u.endColumn}else{const u=e.substring(0,i).substring(1,-1),l=e.substring(i+1),c=this._columnHandler(l,n,!0);o=c.startColumn,a=c.endColumn,s=r.get(u),s||(s=ec.ALL)}return{startColumn:o,endColumn:a,type:s}}_columnHandler(e,n,r=!1){var i,o,a;let s=-1,u=-1;const l=e.indexOf(bn.COLON);if(new RegExp(wB,"g").test(e)){const c=e.substring(0,l).substring(1,-1),d=e.substring(l+1).substring(1,-1);s=(i=n.get(c))!=null?i:-1,u=(o=n.get(d))!=null?o:-1}else r&&(e=e.substring(1,-1)),s=(a=n.get(e))!=null?a:-1,u=s;return{startColumn:s,endColumn:u}}};var HLe=Object.defineProperty,jLe=Object.getOwnPropertyDescriptor,zLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?jLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&HLe(e,n,i),i},Zd=(t,e)=>(n,r)=>e(n,r,t);let j3=class extends Sa{constructor(e,n,r,i=!1){super(n),this._accessor=e,this._operatorString=n,this._referenceObject=r,this._isPrepareMerge=i}get nodeType(){return Pn.REFERENCE}execute(){const e=this._accessor.get(Zc),n=this._accessor.get(ks);this._referenceObject.setDefaultUnitId(n.currentUnitId),this._referenceObject.setDefaultSheetId(n.currentSubUnitId),this._referenceObject.setForcedSheetId(e.getSheetNameMap()),this._referenceObject.setUnitData(e.getUnitData()),this._referenceObject.setArrayFormulaCellData(e.getArrayFormulaCellData()),this._referenceObject.setRuntimeData(n.getUnitData()),this._referenceObject.setNumfmtItemData(e.getNumfmtItemMap()),this._referenceObject.setRuntimeArrayFormulaCellData(n.getRuntimeArrayFormulaCellData()),this._referenceObject.setRuntimeFeatureCellData(n.getRuntimeFeatureCellData());const{x:r,y:i}=this.getRefOffset();this._referenceObject.setRefOffset(r,i),!this._isPrepareMerge&&this._referenceObject.isExceedRange()?this.setValue(new j(k.NAME)):this.setValue(this._referenceObject)}},x9=class extends R1{constructor(e,n,r,i,o){super(),this._definedNamesService=e,this._superTableService=n,this._formulaRuntimeService=r,this._lexer=i,this._injector=o}get zIndex(){return y1.get(Pn.REFERENCE)||D1}checkAndCreateNodeType(e){var n,r;let i=!1,o,a=!1;if(e instanceof Fn?(i=!0,o=e.getToken().trim(),((r=(n=e.getParent())==null?void 0:n.getParent())==null?void 0:r.getToken().trim())===bn.COLON&&(a=!0)):o=e.trim(),!i&&o.charAt(0)==='"'&&o.charAt(o.length-1)==='"')return;if(new RegExp(T8).test(o))return new j3(this._injector,o,new ZB(o),a);if(i&&new RegExp(kTe).test(o))return new j3(this._injector,o,new JB(o),a);if(i&&new RegExp(BTe).test(o))return new j3(this._injector,o,new QB(o),a);const s=this._formulaRuntimeService.currentUnitId,u=this._superTableService.getTableMap(s),l=new RegExp(wB,"g"),c=o.replace(l,"");if(!i&&u!=null&&u.has(c)){const d=l.exec(o);let m="";d&&(m=d[0]);const f=u.get(c),h=this._superTableService.getTableOptionMap();return new j3(this._injector,o,new VLe(o,f,m,h))}}};x9=zLe([Zd(0,P8),Zd(1,qE),Zd(2,ks),Zd(3,K(xc)),Zd(4,K(wn))],x9);var WLe=Object.defineProperty,YLe=Object.getOwnPropertyDescriptor,XLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?YLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&WLe(e,n,i),i},vT=(t,e)=>(n,r)=>e(n,r,t);let bT=class extends Sa{constructor(e,n,r){super(n),this._accessor=e,this._operatorString=n,this._functionExecutor=r}get nodeType(){return Pn.SUFFIX}execute(){let e=this.getChildren()[0].getValue(),n;if(e==null)throw new Error("object is null");this._operatorString===ru.PERCENTAGE?(e.isReferenceObject()&&(e=e.toArrayValueObject()),n=this._functionExecutor.calculate(e,new Tt(100)),n.setPattern("0.00%")):this._operatorString===ru.POUND?n=this._handlerPound(e):n=new j(k.VALUE),this.setValue(n)}_handlerPound(e){var n,r,i,o;if(!e.isReferenceObject())return new j(k.VALUE);if(!e.isCell())return new j(k.VALUE);const a=this._accessor.get(Zc),s=this._accessor.get(xc),u=e,l=u.getRangePosition(),c=u.getUnitId(),d=u.getSheetId(),m=a.getFormulaData(),f=(o=(i=(r=(n=m==null?void 0:m[c])==null?void 0:n[d])==null?void 0:r[l.startRow])==null?void 0:i[l.startColumn])==null?void 0:o.f;return f?(s.treeBuilder(f),new j(k.VALUE)):new j(k.VALUE)}},F9=class extends R1{constructor(e,n){super(),this._functionService=e,this._injector=n}get zIndex(){return y1.get(Pn.SUFFIX)||D1}checkAndCreateNodeType(e){if(!(e instanceof Fn))return;const n=e.getToken().trim();if(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')return;let r="";if(n===ru.PERCENTAGE)r=po.DIVIDED;else return n===ru.POUND?new bT(this._injector,n):void 0;const i=this._functionService.getExecutor(r);return i?new bT(this._injector,n,i):(console.error(`No function ${e}`),no.create(k.NAME))}};F9=XLe([vT(0,Bs),vT(1,K(wn))],F9);var qLe=Object.defineProperty,GLe=Object.getOwnPropertyDescriptor,KLe=(t,e,n,r)=>{for(var i=r>1?void 0:r?GLe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&qLe(e,n,i),i},ZLe=(t,e)=>(n,r)=>e(n,r,t);let QLe=class extends Sa{constructor(e){super(e),this._operatorString=e}get nodeType(){return Pn.UNION}execute(){const e=this.getChildren(),n=e[0].getValue(),r=e[1].getValue();if(n==null||r==null)throw new Error("leftNode and rightNode");let i;this._operatorString===bn.COLON?i=this._unionFunction(n,r):i=new j(k.NAME),this.setValue(i)}_unionFunction(e,n){return e.isError()||n.isError()?new j(k.REF):!e.isReferenceObject()||!n.isReferenceObject()?new j(k.REF):(e=e,n=n,e.isCell()&&n.isCell()||e.isRow()&&n.isRow()||e.isColumn()&&n.isColumn()?e.unionBy(n):new j(k.REF))}},$9=class extends R1{constructor(e){super(),this._functionService=e}get zIndex(){return y1.get(Pn.UNION)||D1}create(e){return new QLe(e)}checkAndCreateNodeType(e){if(!(e instanceof Fn))return;const n=e.getToken().trim();if(!(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')&&n===bn.COLON)return this.create(n)}};$9=KLe([ZLe(0,Bs)],$9);let JLe=class extends Sa{constructor(e){super(e),this._operatorString=e}get nodeType(){return Pn.VALUE}execute(){this.setValue(Mc.create(this._operatorString))}},hU=class extends R1{get zIndex(){return y1.get(Pn.VALUE)||D1}_checkValueNode(e){if(isNaN(Number(e))){const n=e.trim(),r=n.charAt(0),i=n.charAt(n.length-1);if(I8.has(n))return this.create(n);if(r==='"'&&i==='"')return this.create(n);if(r==="{"&&i==="}")return this.create(n);if(n===Oc.TRUE||n===Oc.FALSE)return this.create(n)}else return this.create(e)}create(e){return new JLe(e)}checkAndCreateNodeType(e){if(!(e instanceof Fn))return this._checkValueNode(e)}};var eOe=Object.defineProperty,tOe=Object.getOwnPropertyDescriptor,nOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?tOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&eOe(e,n,i),i},es=(t,e)=>(n,r)=>e(n,r,t);let $m=class extends We{constructor(e,n,r,i,o,a,s,u,l,c,d){super(),Fe(this,"_astNodeFactoryList",[]),Fe(this,"_refOffsetX",0),Fe(this,"_refOffsetY",0),this._runtimeService=e,this._astRootNodeFactory=n,this._functionNodeFactory=r,this._lambdaNodeFactory=i,this._lambdaParameterNodeFactory=o,this._operatorNodeFactory=a,this._prefixNodeFactory=s,this._referenceNodeFactory=u,this._suffixNodeFactory=l,this._unionNodeFactory=c,this._valueNodeFactory=d,this._initializeAstNode()}dispose(){this._astNodeFactoryList.forEach(e=>{e.dispose()}),this._astNodeFactoryList=[]}parse(e,n=0,r=0){const i=new V_(el);return this._refOffsetX=n,this._refOffsetY=r,this._parse(e,i)}_lambdaParameterHandler(e,n){const r=n.getLambdaId(),i=new V_(el),o=this._runtimeService.getFunctionDefinitionPrivacyVar(r);if(!o)return!1;const a=[...o.keys()],s=e.getChildren(),u=s.length;for(let d=0;d<u;d++){const m=s[d];if(m instanceof Fn)this._parse(m,i);else return!1}const l=i.getChildren(),c=l.length;for(let d=0;d<c;d++){const m=l[d];o.set(a[d],m)}return i.setParent(n),n}_changeLetToLambda(e){const n=e.getChildren(),r=n.length;if(r%2!==1||r===0)return;const i=new Fn;i.setToken(xm);const o=new Fn;o.setToken(k0);const a=[...n];for(let u=0;u<r;u++){const l=a[u];if(!(l instanceof Fn))return;u%2===0?l.changeToParent(i):l.changeToParent(o)}i.addChildrenFirst(o),o.setParent(i);const s=e.getParent();return s==null||s.replaceChild(e,i),i}_getTopParent(e){let n=e;for(;n!=null&&n.getParent();)n=n.getParent();return n}_parse(e,n){const r=e.getChildren(),i=r.length,o=[];let a=null;const s=e.getToken().trim().toUpperCase();if(s===HTe){const c=this._changeLetToLambda(e);return c!=null?this._parse(c,n):no.create(k.ERROR)}if(s===Jl){if(a=n,i===0)return new NLe(el).setParent(n),a}else{if(s===k0){let c=this._lambdaParameterHandler(e,n);return c===!1&&(c=no.create(k.ERROR)),c}if(a=this._checkAstNode(e),a==null)return no.create(k.ERROR)}const u=r[0];for(let c=0;c<i;c++){const d=r[c];if(cU(u)){if(c!==0&&c!==i-1)continue}else if(ALe(d)&&c!==i-1)continue;let m=null;if(d instanceof Fn){if(m=this._parse(d,a),m===a)continue}else m=this._checkAstNode(d);if(m==null)return no.create(k.NAME);if(m=this._getTopParent(m),m==null)return;switch(m.nodeType){case Pn.ERROR:return m;case Pn.FUNCTION:o.push(m);break;case Pn.LAMBDA:o.push(m);break;case Pn.LAMBDA_PARAMETER:o.push(m);break;case Pn.OPERATOR:{const f=o.pop(),h=o.pop();if(h)h.setParent(m);else return no.create(k.ERROR);if(f)f.setParent(m);else return no.create(k.ERROR);o.push(m);break}case Pn.REFERENCE:m.setRefOffset(this._refOffsetX,this._refOffsetY),o.push(m);break;case Pn.ROOT:o.push(m);break;case Pn.UNION:o.push(m);break;case Pn.VALUE:o.push(m);break;case Pn.PREFIX:o.push(m);break;case Pn.SUFFIX:o.push(m);break}}const l=o.length;for(let c=0;c<l;c++)o[c].setParent(a);return a}_checkAstNode(e){let n=null;const r=this._astNodeFactoryList.length;for(let i=0;i<r&&(n=this._astNodeFactoryList[i].checkAndCreateNodeType(e),n==null);i++);return n}_initializeAstNode(){this._astNodeFactoryList=[this._astRootNodeFactory,this._functionNodeFactory,this._lambdaNodeFactory,this._lambdaParameterNodeFactory,this._operatorNodeFactory,this._prefixNodeFactory,this._referenceNodeFactory,this._suffixNodeFactory,this._unionNodeFactory,this._valueNodeFactory].sort(gs)}};$m=nOe([es(0,ks),es(1,K(lU)),es(2,K(P9)),es(3,K(M9)),es(4,K(fU)),es(5,K(N9)),es(6,K(O9)),es(7,K(x9)),es(8,K(F9)),es(9,K($9)),es(10,K(hU))],$m);let rOe=class extends We{constructor(){super(...arguments),Fe(this,"_referenceExecutorMap",new Map)}dispose(){this._referenceExecutorMap.clear()}remove(e){this._referenceExecutorMap.delete(e)}get(e){return this._referenceExecutorMap.get(e)}has(e){return this._referenceExecutorMap.has(e)}register(e,n){this._referenceExecutorMap.set(e,n)}getReferenceExecutorMap(){return this._referenceExecutorMap}};const M8=ln("univer.formula.feature-calculation-manager.service");let iOe=class extends We{constructor(){super(...arguments),Fe(this,"_otherFormulaData",{})}dispose(){this._otherFormulaData={}}remove(e){var n,r,i;const{unitId:o,subUnitId:a,formulaId:s}=e;(i=(r=(n=this._otherFormulaData)==null?void 0:n[o])==null?void 0:r[a])==null||delete i[s]}get(e){var n,r;const{unitId:i,subUnitId:o,formulaId:a}=e;return(r=(n=this._otherFormulaData[i])==null?void 0:n[o])==null?void 0:r[a]}has(e){var n,r;const{unitId:i,subUnitId:o,formulaId:a}=e;return((r=(n=this._otherFormulaData[i])==null?void 0:n[o])==null?void 0:r[a])!=null}register(e){const{unitId:n,subUnitId:r,formulaId:i,item:o}=e;this._otherFormulaData[n]&&(this._otherFormulaData[n]={}),this._otherFormulaData[n][r]&&(this._otherFormulaData[n][r]={}),this._otherFormulaData[n][r][i]=o}getOtherFormulaData(){return this._otherFormulaData}};const GE=ln("univer.formula.other-formula-manager.service");let Pg=class extends We{constructor(){super(...arguments),Fe(this,"node"),Fe(this,"children",[]),Fe(this,"parents",[]),Fe(this,"formula",""),Fe(this,"row",-1),Fe(this,"column",-1),Fe(this,"rowCount",Number.NEGATIVE_INFINITY),Fe(this,"columnCount",Number.NEGATIVE_INFINITY),Fe(this,"subUnitId",""),Fe(this,"unitId",""),Fe(this,"rangeList",[]),Fe(this,"formulaId"),Fe(this,"featureId"),Fe(this,"getDirtyData"),Fe(this,"_state",0)}dispose(){var e;this.children.forEach(n=>{n.dispose()}),this.rangeList=[],this.parents=[],(e=this.node)==null||e.dispose()}setAdded(){this._state=1}isAdded(){return this._state===1}setSkip(){this._state=2}isSkip(){return this._state===2}inRangeData(e){const n=e.startRow,r=e.startColumn,i=e.endRow,o=e.endColumn;return!(this.row<n||this.row>i||this.column<r||this.column>o)}dependencyRange(e,n,r){var i,o;if(this.rangeList.length===0)return!1;for(let a=0,s=this.rangeList.length;a<s;a++){const u=this.rangeList[a],{unitId:l,sheetId:c,range:d}=u;if(((i=n[l])==null?void 0:i[c])!=null)return!0;if(!e.has(l))continue;const m=e.get(l);if(!m.has(c))continue;const f=m.get(c),h=(o=r==null?void 0:r[l])==null?void 0:o[c];let{startRow:p,endRow:v,startColumn:g,endColumn:b}=d;isNaN(p)&&(p=0),isNaN(g)&&(g=0),isNaN(v)&&(v=Number.POSITIVE_INFINITY),isNaN(b)&&(b=Number.POSITIVE_INFINITY);for(const C of f){const{startRow:S,startColumn:E,endRow:y,endColumn:D}=C;if(!(p>y||v<S||g>D||b<E)){let R=!0;if(h==null||h.forValue((I,T)=>{if(I>=p&&I<=v&&T>=g&&T<=b)return R=!1,!1}),R)return!0}}}return!1}pushChildren(e){this.children.push(e),e._pushParent(this)}pushRangeList(e){this.rangeList.push(e)}dependency(e){if(this.rangeList.length===0)return!1;for(let n=0,r=this.rangeList.length;n<r;n++){const i=this.rangeList[n],o=i.unitId,a=i.sheetId,s=i.range;if(e.unitId===o&&e.subUnitId===a&&e.inRangeData(s))return!0}return!1}_pushParent(e){this.parents.push(e)}};var oOe=Object.defineProperty,aOe=Object.getOwnPropertyDescriptor,sOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?aOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&oOe(e,n,i),i},kl=(t,e)=>(n,r)=>e(n,r,t);const uOe=1e5,Mg=new A8(uOe);let X6=class extends We{constructor(e,n,r,i,o,a,s){super(),Fe(this,"_updateRangeFlattenCache",new Map),Fe(this,"_dirtyUnitSheetNameMap",{}),this._currentConfigService=e,this._runtimeService=n,this._otherFormulaManagerService=r,this._featureCalculationManagerService=i,this._interpreter=o,this._astTreeBuilder=a,this._lexer=s}dispose(){this._updateRangeFlattenCache.clear(),Mg.clear(),this._dirtyUnitSheetNameMap={}}async generate(){this._updateRangeFlatten();const e=this._currentConfigService.getFormulaData(),n=this._otherFormulaManagerService.getOtherFormulaData(),r=this._currentConfigService.getUnitData(),i=await this._generateTreeList(e,n,r),o=this._getUpdateTreeListAndMakeDependency(i);this._checkIsCycleDependency(o)&&this._runtimeService.enableCycleDependency();const a=this._calculateRunList(o);return Promise.resolve(a)}_isCyclicUtil(e,n,r){if(!n.has(e)){n.add(e),r.add(e);for(let i=0;i<e.children.length;i++)if(!n.has(e.children[i])&&this._isCyclicUtil(e.children[i],n,r)||r.has(e.children[i]))return!0}return r.delete(e),!1}_checkIsCycleDependency(e){const n=new Set,r=new Set;for(let i=0,o=e.length;i<o;i++){const a=e[i];if(this._isCyclicUtil(a,n,r)===!0)return!0}return!1}async _generateTreeList(e,n,r){const i=Object.keys(e),o=Object.keys(n),a=[];for(const s of i){const u=e[s];if(u==null)continue;const l=Object.keys(u);for(const c of l)new Ye(u[c]).forValue((d,m,f)=>{if(f==null)return!0;const{f:h,x:p,y:v}=f,g=this._generateAstNode(h,p,v),b=new Pg,C=r[s][c];b.node=g,b.formula=h,b.unitId=s,b.subUnitId=c,b.row=d,b.column=m,b.rowCount=C.rowCount,b.columnCount=C.columnCount,a.push(b)})}for(const s of o){const u=n[s];if(u==null)continue;const l=Object.keys(u);for(const c of l){const d=u[c];if(d==null)continue;const m=Object.keys(d);for(const f of m){const h=d[f],{f:p}=h,v=this._generateAstNode(p),g=new Pg;g.node=v,g.formula=p,g.unitId=s,g.subUnitId=c,g.formulaId=f,a.push(g)}}}this._featureCalculationManagerService.getReferenceExecutorMap().forEach((s,u)=>{const{unitId:l,subUnitId:c,dependencyRanges:d,getDirtyData:m}=s,f=new Pg;f.unitId=l,f.subUnitId=c,f.getDirtyData=m,f.featureId=u,f.rangeList=d,a.push(f)});for(let s=0,u=a.length;s<u;s++){const l=a[s];if(this._runtimeService.setCurrent(l.row,l.column,l.rowCount,l.columnCount,l.subUnitId,l.unitId),l.node==null)continue;const c=await this._getRangeListByNode(l.node);for(let d=0,m=c.length;d<m;d++)l.pushRangeList(c[d])}return a}_updateRangeFlatten(){const e=this._currentConfigService.isForceCalculate(),n=this._currentConfigService.getDirtyRanges();if(!e){this._updateRangeFlattenCache.clear();for(let r=0;r<n.length;r++){const i=n[r],o=i.range,a=i.sheetId,s=i.unitId;this._addFlattenCache(s,a,o)}this._dirtyUnitSheetNameMap=this._currentConfigService.getDirtyNameMap()}}_generateAstNode(e,n=0,r=0){let i=Mg.get(`${e}##${n}${r}`);if(i)return i;const o=this._lexer.treeBuilder(e);if(o in k)return no.create(o);if(i=this._astTreeBuilder.parse(o,n,r),i==null)throw new Error("astNode is null");return Mg.set(`${e}##${n}${r}`,i),i}_addFlattenCache(e,n,r){let i=this._updateRangeFlattenCache.get(e);i==null&&(i=new Map,this._updateRangeFlattenCache.set(e,i));let o=i.get(n);o==null&&(o=[],i.set(n,o)),o.push(r)}_isPreCalculateNode(e){return e.nodeType===Pn.UNION||e.nodeType===Pn.PREFIX&&e.getToken()===pi.AT||e.nodeType===Pn.SUFFIX&&e.getToken()===ru.POUND}_nodeTraversalRef(e,n){const r=e.getChildren(),i=r.length;for(let o=0;o<i;o++){const a=r[o];if(this._isPreCalculateNode(a)){n.push(a);continue}else a.nodeType===Pn.REFERENCE&&n.push(a);this._nodeTraversalRef(a,n)}}_nodeTraversalReferenceFunction(e,n){const r=e.getChildren(),i=r.length;for(let o=0;o<i;o++){const a=r[o];if(a.nodeType===Pn.FUNCTION&&a.isAddress()){n.push(a);continue}this._nodeTraversalReferenceFunction(a,n)}}async _executeNode(e){let n;return this._interpreter.checkAsyncNode(e)?n=await this._interpreter.executeAsync(e):n=this._interpreter.execute(e),n}async _getRangeListByNode(e){const n=[],r=[];this._nodeTraversalRef(e,n),this._nodeTraversalReferenceFunction(e,r);const i=[];for(let o=0,a=n.length;o<a;o++){const s=n[o],u=(await this._executeNode(s)).toUnitRange();i.push(u)}for(let o=0,a=r.length;o<a;o++){const s=r[o],u=(await this._executeNode(s)).toUnitRange();i.push(u)}return i}_getUpdateTreeListAndMakeDependency(e){const n=[],r=new Set,i=this._currentConfigService.isForceCalculate();for(let o=0,a=e.length;o<a;o++){const s=e[o];for(let u=0,l=e.length;u<l;u++){const c=e[u];s!==c&&s.dependency(c)&&s.pushChildren(c)}(i||s.dependencyRange(this._updateRangeFlattenCache,this._dirtyUnitSheetNameMap,this._currentConfigService.getExcludedRange())||this._includeTree(s))&&!r.has(s)&&(n.push(s),r.add(s))}return n}_includeTree(e){var n,r,i,o,a;const s=e.unitId,u=e.subUnitId,l=e.featureId;if(l!=null){const h=this._currentConfigService.getDirtyUnitFeatureMap();if(((r=(n=h==null?void 0:h[s])==null?void 0:n[u])==null?void 0:r[l])!=null)return!0}const c=(o=(i=this._currentConfigService.getExcludedRange())==null?void 0:i[s])==null?void 0:o[u];let d=!1;if(c==null||c.forValue((h,p)=>{if(e.row===h&&e.column===p)return d=!0,!1}),d)return!1;if(((a=this._dirtyUnitSheetNameMap[s])==null?void 0:a[u])!=null)return!0;if(!this._updateRangeFlattenCache.has(s))return!1;const m=this._updateRangeFlattenCache.get(s);if(!m.has(u))return!1;const f=m.get(u);for(const h of f)if(e.inRangeData(h))return!0;return!1}_calculateRunList(e){let n=e;const r=[];for(;n.length>0;){const i=n.pop();if(i===void 0||i.isSkip())continue;if(i.isAdded()){r.push(i);continue}const o=[];for(let a=0,s=i.parents.length;a<s;a++){const u=i.parents[a];o.push(u)}o.length===0?(r.push(i),i.setSkip()):(i.setAdded(),n.push(i),n=n.concat(o))}return r.reverse()}};X6=sOe([yt(ot.Rendered,X6),kl(0,Zc),kl(1,ks),kl(2,GE),kl(3,M8),kl(4,K(B0)),kl(5,K($m)),kl(6,K(xc))],X6);var lOe=Object.defineProperty,cOe=Object.getOwnPropertyDescriptor,dOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?cOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&lOe(e,n,i),i},Bl=(t,e)=>(n,r)=>e(n,r,t);const mOe=1;let q6=class extends We{constructor(e,n,r,i,o,a,s){super(),Fe(this,"_executionStartListener$",new an),Fe(this,"executionStartListener$",this._executionStartListener$.asObservable()),Fe(this,"_executionCompleteListener$",new an),Fe(this,"executionCompleteListener$",this._executionCompleteListener$.asObservable()),Fe(this,"_executionInProgressListener$",new an),Fe(this,"executionInProgressListener$",this._executionInProgressListener$.asObservable()),this._configService=e,this._lexer=n,this._currentConfigService=r,this._runtimeService=i,this._formulaDependencyGenerator=o,this._interpreter=a,this._astTreeBuilder=s}dispose(){}stopFormulaExecution(){this._runtimeService.stopExecution()}setRuntimeFeatureCellData(e,n){this._runtimeService.setRuntimeFeatureCellData(e,n)}setRuntimeFeatureRange(e,n){this._runtimeService.setRuntimeFeatureRange(e,n)}async execute(e){this._executionStartListener$.next(!0),this._currentConfigService.load(e),this._runtimeService.reset();const n=this._configService.getConfig("CYCLE_REFERENCE_COUNT")||mOe;for(let r=0;r<n&&(await this._execute(),!!this._runtimeService.isCycleDependency());r++);this._runtimeService.setFormulaExecuteStage(M1.CALCULATION_COMPLETED),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState()),this._executionCompleteListener$.next(this._runtimeService.getAllRuntimeData()),k_.clear(),Au.clear()}async _execute(){const e=await this._apply();if(e==null)return;const{arrayFormulaRange:n,runtimeFeatureRange:r}=e,{dirtyRanges:i,excludedCell:o}=this._getArrayFormulaDirtyRangeAndExcludedRange(n,r);return i==null||i.length===0||(this._currentConfigService.loadDirtyRangesAndExcludedCell(i,o),await this._apply(!0)),!0}_getArrayFormulaDirtyRangeAndExcludedRange(e,n){const r=[],i={};return Object.keys(e).forEach(o=>{const a=e[o];if(a==null)return!0;Object.keys(a).forEach(s=>{const u=new Ye(a[s]);if(u==null)return!0;const l=new Ye;u.forValue((c,d,m)=>{l.setValue(c,d,!0),r.push({unitId:o,sheetId:s,range:m})}),i[o]==null&&(i[o]={}),i[o][s]=l})}),Object.keys(n).forEach(o=>{const a=n[o];Object.keys(a).forEach(s=>{const u=a[s];if(u==null)return!0;Object.keys(u).forEach(l=>{const c=u[l];if(c==null)return!0;for(const d of c)r.push({unitId:s,sheetId:l,range:d})})})}),{dirtyRanges:r,excludedCell:i}}async _apply(e=!1){e?this._runtimeService.setFormulaExecuteStage(M1.START_DEPENDENCY_ARRAY_FORMULA):this._runtimeService.setFormulaExecuteStage(M1.START_DEPENDENCY),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState());const n=await this._formulaDependencyGenerator.generate(),r=this._interpreter;e?(this._runtimeService.setFormulaExecuteStage(M1.START_CALCULATION_ARRAY_FORMULA),this._runtimeService.setTotalArrayFormulasToCalculate(n.length)):(this._runtimeService.setFormulaExecuteStage(M1.START_CALCULATION),this._runtimeService.setTotalFormulasToCalculate(n.length)),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState());for(let i=0,o=n.length;i<o;i++){if(await new Promise(c=>{KL(c)}),this._runtimeService.isStopExecution()){this._runtimeService.setFormulaExecuteStage(M1.IDLE),this._runtimeService.markedAsStopFunctionsExecuted(),this._executionCompleteListener$.next(this._runtimeService.getAllRuntimeData());return}const a=n[i],s=a.node,u=a.getDirtyData;let l;if(s==null&&u==null)throw new Error("AstNode or executor is null");if(this._runtimeService.setCurrent(a.row,a.column,a.rowCount,a.columnCount,a.subUnitId,a.unitId),u!=null&&a.featureId!=null){const{runtimeCellData:c,dirtyRanges:d}=u(a);this._runtimeService.setRuntimeFeatureCellData(a.featureId,c),this._runtimeService.setRuntimeFeatureRange(a.featureId,d)}else s!=null&&(r.checkAsyncNode(s)?l=await r.executeAsync(s):l=r.execute(s),a.formulaId!=null?this._runtimeService.setRuntimeOtherData(a.formulaId,l):this._runtimeService.setRuntimeData(l));e?(this._runtimeService.setFormulaExecuteStage(M1.CURRENTLY_CALCULATING_ARRAY_FORMULA),this._runtimeService.setCompletedArrayFormulasCount(i+1)):(this._runtimeService.setFormulaExecuteStage(M1.CURRENTLY_CALCULATING),this._runtimeService.setCompletedFormulasCount(i+1)),this._executionInProgressListener$.next(this._runtimeService.getRuntimeState())}return n.length>0?this._runtimeService.markedAsSuccessfullyExecuted():e||this._runtimeService.markedAsNoFunctionsExecuted(),this._runtimeService.getAllRuntimeData()}calculate(e,n=!0){const r=this._lexer.treeBuilder(e,n);if(Object.values(k).includes(r))return no.create(r);const i=this._astTreeBuilder.parse(r);i==null||i.serialize()}};q6=dOe([yt(ot.Rendered,q6),Bl(0,K0),Bl(1,K(xc)),Bl(2,Zc),Bl(3,ks),Bl(4,K(X6)),Bl(5,K(B0)),Bl(6,K($m))],q6);const km={id:"formula.mutation.set-numfmt-formula-data",type:ue.MUTATION,handler:(t,e)=>(t.get(Ai).updateNumfmtItemMap(e.numfmtItemMap),!0)};var fOe=Object.defineProperty,hOe=Object.getOwnPropertyDescriptor,pOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?hOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&fOe(e,n,i),i},z3=(t,e)=>(n,r)=>e(n,r,t);let s7=class extends We{constructor(e,n,r,i){super(),this._commandService=e,this._calculateFormulaService=n,this._currentUniverService=r,this._formulaDataModel=i,this._initialize()}_initialize(){this._commandExecutedListener(),this._initialExecuteFormulaListener(),this._initialExecuteFormulaProcessListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((e,n)=>{if(e.id===xB.id)this._calculateFormulaService.stopFormulaExecution();else if(e.id===nc.id){const r=e.params.formulaData;this._formulaDataModel.setFormulaData(r)}else if(e.id===T9.id){const r=e.params;if(r.forceCalculation===!0)this._calculate(!0);else{const{dirtyRanges:i,dirtyNameMap:o,dirtyUnitFeatureMap:a,numfmtItemMap:s}=r;this._calculate(!1,i,o,a,s)}}else if(e.id===V1.id){const r=e.params;if(r==null)return;const{arrayFormulaRange:i,arrayFormulaCellData:o}=r;this._formulaDataModel.setArrayFormulaRange(i),this._formulaDataModel.setArrayFormulaCellData(o)}}))}async _calculate(e=!1,n=[],r={},i={},o={}){if(n.length===0&&Object.keys(r).length===0&&Object.keys(i).length===0&&e===!1)return;const a=this._formulaDataModel.getFormulaData(),s=this._formulaDataModel.getArrayFormulaCellData();this._calculateFormulaService.execute({formulaData:a,arrayFormulaCellData:s,forceCalculate:e,dirtyRanges:n,dirtyNameMap:r,dirtyUnitFeatureMap:i,numfmtItemMap:o})}_initialExecuteFormulaListener(){this._calculateFormulaService.executionCompleteListener$.subscribe(e=>{const n=e.functionsExecutedState;switch(n){case j1.NOT_EXECUTED:break;case j1.STOP_EXECUTION:break;case j1.SUCCESS:this._applyFormula(e);break;case j1.INITIAL:break}this._commandService.executeCommand(w9.id,{functionsExecutedState:n},{onlyLocal:!0})})}_initialExecuteFormulaProcessListener(){this._calculateFormulaService.executionInProgressListener$.subscribe(e=>{this._commandService.executeCommand(w9.id,{stageInfo:e},{onlyLocal:!0})})}async _applyFormula(e){const{unitData:n,unitOtherData:r,arrayFormulaRange:i,arrayFormulaCellData:o,clearArrayFormulaCellData:a,numfmtItemMap:s}=e;if(!n){console.error("No sheetData from Formula Engine!");return}i&&(this._formulaDataModel.clearPreviousArrayFormulaCellData(a),this._formulaDataModel.mergeArrayFormulaCellData(o),this._formulaDataModel.mergeArrayFormulaRange(i),this._commandService.executeCommand(V1.id,{arrayFormulaRange:this._formulaDataModel.getArrayFormulaRange(),arrayFormulaCellData:this._formulaDataModel.getArrayFormulaCellData()},{onlyLocal:!0})),Ie.isEmptyObject(s)||this._commandService.executeCommand(km.id,{numfmtItemMap:s},{onlyLocal:!0}),this._commandService.executeCommand(w8.id,{unitData:n,unitOtherData:r},{onlyLocal:!0})}};s7=pOe([yt(ot.Ready,s7),z3(0,se),z3(1,K(q6)),z3(2,ae),z3(3,K(Ai))],s7);var gOe=Object.defineProperty,vOe=Object.getOwnPropertyDescriptor,bOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?vOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&gOe(e,n,i),i},Ng=(t,e)=>(n,r)=>e(n,r,t);let G6=class extends We{constructor(e=[],n,r,i){super(),this._function=e,this._commandService=n,this._injector=r,this._functionService=i,this._initialize()}_initialize(){this._registerCommands(),this._registerFunctions()}_registerCommands(){[nc,V1,T9,xB,w9,w8,km,HE,jE,MB,NB,FB,$B,YTe,XTe,kB,BE,zE].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_registerFunctions(){const e=[...HB,...jB,...zB,...WB,...YB,...XB,...qB,...GB,...KB,...eU,...nU,...rU,...iU,...oU,...aU,...sU].concat(this._function).map(n=>{const r=n[0],i=n[1];return new r(i)});this._functionService.registerExecutors(...e)}};G6=bOe([yt(ot.Ready,G6),Ng(1,se),Ng(2,K(wn)),Ng(3,Bs)],G6);var _Oe=Object.defineProperty,COe=Object.getOwnPropertyDescriptor,SOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?COe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&_Oe(e,n,i),i},xg=(t,e)=>(n,r)=>e(n,r,t);let u7=class extends We{constructor(e,n,r){super(),this._commandService=e,this._formulaDataModel=n,this._functionService=r,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((e,n)=>{if(e.id===BE.id){const r=e.params;if(r==null)return;const{functions:i}=r,o=i.map(a=>{const s=a[0],u=a[1];return yOe(s,u)});this._functionService.registerExecutors(...o)}else if(e.id===zE.id){const r=e.params;if(r==null)return;const{functions:i}=r;this._functionService.unregisterExecutors(...i)}}))}};u7=SOe([yt(ot.Ready,u7),xg(0,se),xg(1,K(Ai)),xg(2,Bs)],u7);let EOe=class extends xn{isCustom(){return!0}};function yOe(t,e){const n=new EOe(e),r=new Function(`return ${t}`)();return n.calculateCustom=r,n}var DOe=Object.defineProperty,ROe=Object.getOwnPropertyDescriptor,IOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ROe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&DOe(e,n,i),i},_T=(t,e)=>(n,r)=>e(n,r,t);let l7=class extends We{constructor(e,n){super(),this._commandService=e,this._definedNamesService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===HE.id){const n=e.params;if(n==null)return;const{unitId:r,name:i,formulaOrRefString:o}=n;this._definedNamesService.registerDefinedName(r,i,o)}else if(e.id===jE.id){const n=e.params;if(n==null)return;const{unitId:r,name:i}=n;this._definedNamesService.removeDefinedName(r,i)}}))}};l7=IOe([yt(ot.Ready,l7),_T(0,se),_T(1,P8)],l7);var AOe=Object.defineProperty,TOe=Object.getOwnPropertyDescriptor,wOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?TOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&AOe(e,n,i),i},CT=(t,e)=>(n,r)=>e(n,r,t);let c7=class extends We{constructor(e,n){super(),this._commandService=e,this._featureCalculationManagerService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===MB.id){const n=e.params;if(n==null)return;const{featureId:r,calculationParam:i}=n;this._featureCalculationManagerService.register(r,i)}else if(e.id===NB.id){const n=e.params;if(n==null)return;const{featureId:r}=n;this._featureCalculationManagerService.remove(r)}}))}};c7=wOe([yt(ot.Ready,c7),CT(0,se),CT(1,M8)],c7);var LOe=Object.defineProperty,OOe=Object.getOwnPropertyDescriptor,POe=(t,e,n,r)=>{for(var i=r>1?void 0:r?OOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&LOe(e,n,i),i},ST=(t,e)=>(n,r)=>e(n,r,t);let d7=class extends We{constructor(e,n){super(),this._commandService=e,this._otherFormulaManagerService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===FB.id){const n=e.params;if(n==null)return;this._otherFormulaManagerService.register(n)}else if(e.id===$B.id){const n=e.params;if(n==null)return;this._otherFormulaManagerService.remove(n)}}))}};d7=POe([yt(ot.Ready,d7),ST(0,se),ST(1,GE)],d7);var MOe=Object.defineProperty,NOe=Object.getOwnPropertyDescriptor,xOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?NOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&MOe(e,n,i),i},ET=(t,e)=>(n,r)=>e(n,r,t);let m7=class extends We{constructor(e,n){super(),this._commandService=e,this._superTableService=n,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===HE.id){const n=e.params;if(n==null)return;const{unitId:r,tableName:i,reference:o}=n;this._superTableService.registerTable(r,i,o)}else if(e.id===jE.id){const n=e.params;if(n==null)return;const{unitId:r,tableName:i}=n;this._superTableService.remove(r,i)}else if(e.id===kB.id){const n=e.params;if(n==null)return;const{tableOption:r,tableOptionType:i}=n;this._superTableService.registerTableOptionMap(r,i)}}))}};m7=xOe([yt(ot.Ready,m7),ET(0,se),ET(1,qE)],m7);var FOe=Object.defineProperty,$Oe=Object.getOwnPropertyDescriptor,kOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?$Oe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&FOe(e,n,i),i},BOe=(t,e)=>(n,r)=>e(n,r,t);const UOe="base-formula-engine";let H_=class extends b1{constructor(e,n){super(UOe),this._config=e,this._injector=n}onStarting(){this._initialize()}_initialize(){var e;const n=[[Bs,{useClass:pLe}],[M8,{useClass:rOe}],[P8,{useClass:rLe}],[Ai],[E1],[G6,{useFactory:()=>{var r;return this._injector.createInstance(G6,(r=this._config)==null?void 0:r.function)}}],[c7]];(e=this._config)!=null&&e.notExecuteFormula||n.push([q6],[GE,{useClass:iOe}],[qE,{useClass:ULe}],[Zc,{useClass:B_}],[ks,{useClass:U_}],[s7],[l7],[d7],[m7],[u7],[X6],[B0],[$m],[xc],[lU],[P9],[M9],[fU],[N9],[O9],[x9],[F9],[$9],[hU]),n.forEach(r=>this._injector.add(r))}onReady(){this._injector.get(Ai).initFormulaData()}};H_=kOe([BOe(1,K(wn))],H_);var VOe=Object.defineProperty,HOe=(t,e,n)=>e in t?VOe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fr=(t,e,n)=>(HOe(t,typeof e!="symbol"?e+"":e,n),n),jOe=Object.defineProperty,zOe=Object.getOwnPropertyDescriptor,WOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&jOe(e,n,i),i},YOe=(t,e)=>(n,r)=>e(n,r,t);const Nn="normalSelectionPluginName";var f7=(t=>(t[t.MOVE_START=0]="MOVE_START",t[t.MOVING=1]="MOVING",t[t.MOVE_END=2]="MOVE_END",t))(f7||{});let dt=class{constructor(t){fr(this,"_selectionInfo",new Map),fr(this,"_currentSelection",null),fr(this,"_selectionMoveStart$",new an),fr(this,"selectionMoveStart$",this._selectionMoveStart$.asObservable()),fr(this,"_selectionMoving$",new an),fr(this,"selectionMoving$",this._selectionMoving$.asObservable()),fr(this,"_selectionMoveEnd$",new dn(null)),fr(this,"selectionMoveEnd$",this._selectionMoveEnd$.asObservable()),fr(this,"_dirty",!0),this._themeService=t}getCurrent(){return this._currentSelection}getLastByPlugin(t){if(this._currentSelection!=null)return this._getLastByParam({...this._currentSelection,pluginName:t})}changePlugin(t){var e,n;this._currentSelection!=null&&(this._currentSelection={pluginName:t,unitId:(e=this._currentSelection)==null?void 0:e.unitId,sheetId:(n=this._currentSelection)==null?void 0:n.sheetId},this._refresh(this._currentSelection))}changePluginNoRefresh(t){var e,n;this._currentSelection!=null&&(this._currentSelection={pluginName:t,unitId:(e=this._currentSelection)==null?void 0:e.unitId,sheetId:(n=this._currentSelection)==null?void 0:n.sheetId})}reset(){var t,e;this._currentSelection!=null&&(this._currentSelection={pluginName:Nn,unitId:(t=this._currentSelection)==null?void 0:t.unitId,sheetId:(e=this._currentSelection)==null?void 0:e.sheetId},this._selectionInfo.clear(),this._refresh(this._currentSelection))}resetPlugin(){this._currentSelection!=null&&(this._currentSelection.pluginName=Nn,this._refresh(this._currentSelection))}dispose(){this._selectionMoveEnd$.complete(),this._selectionMoveStart$.complete(),this._selectionMoving$.complete()}makeDirty(t=!0){this._dirty=t}refreshSelection(){this._currentSelection!=null&&this._refresh(this._currentSelection)}setCurrentSelection(t){this._dirty!==!1&&(this._currentSelection=t,this._refresh(t))}setCurrentSelectionNotRefresh(t){this._currentSelection=t}getSelectionInfo(){return this._selectionInfo}getSelectionDatasByParam(t){return this._getSelectionDatas(t)}getSelections(){return this._getSelectionDatas(this._currentSelection)}getSelectionRanges(){const t=this.getSelections();if(t!=null)return t.map(e=>e.range)}getFirst(){return this._getFirstByParam(this._currentSelection)}getLast(){return this._getLastByParam(this._currentSelection)}addNoRefresh(t){this._currentSelection!=null&&this._addByParam({...this._currentSelection,selectionDatas:t},!1)}add(t){this._currentSelection!=null&&this._addByParam({...this._currentSelection,selectionDatas:t})}replace(t,e=2){this._currentSelection!=null&&(this._replaceByParam({...this._currentSelection,selectionDatas:t}),e===0?this._refreshStart(this._currentSelection):e===1?this._refreshMoving(this._currentSelection):this._refresh(this._currentSelection))}replaceWithNoRefresh(t){this._currentSelection!=null&&this._replaceByParam({...this._currentSelection,selectionDatas:t})}clear(){this._currentSelection!=null&&this._clearByParam(this._currentSelection)}remove(t){this._currentSelection!=null&&this._removeByParam(t,this._currentSelection)}createDefaultAutoFillSelection(){return{strokeWidth:2,stroke:"#FFF000",fill:"rgba(0, 0, 0, 0.2)",widgets:{},hasAutoFill:!0}}createCopyPasteSelection(){return{strokeWidth:1.5,stroke:this._themeService.getCurrentTheme().primaryColor,fill:"rgba(178, 178, 178, 0.10)",widgets:{},hasAutoFill:!1,strokeDash:8}}createDefaultSelection(){return{strokeWidth:2,stroke:"#FFF000",fill:"rgba(0, 0, 0, 0.2)",widgets:{tr:!0,tl:!0,br:!0,bl:!0},hasAutoFill:!1}}isOverlapping(){const t=this.getSelections();return t==null?!1:t.some(({range:e},n)=>t.some(({range:r},i)=>n===i?!1:e.startRow<=r.endRow&&e.endRow>=r.startRow&&e.startColumn<=r.endColumn&&e.endColumn>=r.startColumn))}_getSelectionDatas(t){var e,n;if(t==null)return;const{pluginName:r,unitId:i,sheetId:o}=t;return(n=(e=this._selectionInfo.get(r))==null?void 0:e.get(i))==null?void 0:n.get(o)}_refresh(t){this._selectionMoveEnd$.next(this._getSelectionDatas(t))}_refreshStart(t){this._selectionMoveStart$.next(this._getSelectionDatas(t))}_refreshMoving(t){this._selectionMoving$.next(this._getSelectionDatas(t))}_getFirstByParam(t){const e=this._getSelectionDatas(t);return e==null?void 0:e[0]}_getLastByParam(t){const e=this._getSelectionDatas(t);return e==null?void 0:e[e.length-1]}_addByParam(t,e=!0){const{pluginName:n,unitId:r,sheetId:i,selectionDatas:o}=t;this._selectionInfo.has(n)||this._selectionInfo.set(n,new Map);const a=this._selectionInfo.get(n);a.has(r)||a.set(r,new Map);const s=a.get(r);if(!s.has(i))s.set(i,[...o]);else{let u=s.get(i);u==null&&(u=[],s.set(i,u)),u.push(...o)}e&&this._refresh({pluginName:n,unitId:r,sheetId:i})}_replaceByParam(t){const{pluginName:e,unitId:n,sheetId:r,selectionDatas:i}=t;this._selectionInfo.has(e)||this._selectionInfo.set(e,new Map);const o=this._selectionInfo.get(e);o.has(n)||o.set(n,new Map);const a=o.get(n);if(!a.has(r))a.set(r,i);else{let s=a.get(r);s==null&&(s=[],a.set(r,s)),s.splice(0,s.length,...i)}}_clearByParam(t){const e=this._getSelectionDatas(t);e==null||e.splice(0),this._refresh(t)}_removeByParam(t,e){const n=this._getSelectionDatas(e);n==null||n.splice(t,1),this._refresh(e)}};dt=WOe([YOe(0,K(_i))],dt);const XOe=Q0("CELL_CONTENT"),qOe=Q0("PERMISSION"),Rs={CELL_CONTENT:XOe,PERMISSION:qOe};var GOe=Object.defineProperty,KOe=Object.getOwnPropertyDescriptor,ZOe=(t,e,n,r)=>{for(var i=r>1?void 0:r?KOe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&GOe(e,n,i),i},QOe=(t,e)=>(n,r)=>e(n,r,t);let In=class extends We{constructor(t){super(),fr(this,"_interceptorsByName",new Map),fr(this,"_commandInterceptors",[]),fr(this,"_workbookDisposables",new Map),fr(this,"_worksheetDisposables",new Map),this._currentUniverService=t,this.disposeWithMe(je(this._currentUniverService.sheetAdded$.subscribe(e=>{this._interceptWorkbook(e)}))),this.disposeWithMe(je(this._currentUniverService.sheetDisposed$.subscribe(e=>this._disposeWorkbookInterceptor(e)))),this.intercept(Rs.CELL_CONTENT,{priority:-1,handler(e,n){const r=n.worksheet.getCellRaw(n.row,n.col);return e?{...r,...e}:r}}),this.intercept(Rs.PERMISSION,{priority:-1,handler:()=>!0})}dispose(){super.dispose(),this._workbookDisposables.forEach(t=>t.dispose()),this._workbookDisposables.clear(),this._worksheetDisposables.clear()}interceptCommand(t){if(this._commandInterceptors.includes(t))throw new Error("[SheetInterceptorService]: Interceptor already exists!");return this._commandInterceptors.push(t),this._commandInterceptors.sort((e,n)=>{var r,i;return((r=n.priority)!=null?r:0)-((i=e.priority)!=null?i:0)}),this.disposeWithMe(je(()=>r1(this._commandInterceptors,t)))}onCommandExecute(t){const e=this._commandInterceptors.map(n=>n.getMutations(t));return{undos:e.map(n=>n.undos).flat(),redos:e.map(n=>n.redos).flat()}}intercept(t,e){const n=t;this._interceptorsByName.has(n)||this._interceptorsByName.set(n,[]);const r=this._interceptorsByName.get(n);return r.push(e),this._interceptorsByName.set(n,r.sort((i,o)=>{var a,s;return((a=o.priority)!=null?a:0)-((s=i.priority)!=null?s:0)})),this.disposeWithMe(je(()=>r1(this._interceptorsByName.get(n),e)))}fetchThroughInterceptors(t){const e=t,n=this._interceptorsByName.get(e);return JL(n||[])}_interceptWorkbook(t){const e=new ws,n=t.getUnitId(),r=this,i=o=>{const a=o.getSheetId();o.__interceptViewModel(s=>{const u=new ws,l=s.registerCellContentInterceptor({getCell(c,d){return r.fetchThroughInterceptors(Rs.CELL_CONTENT)(o.getCellRaw(c,d),{unitId:n,subUnitId:a,row:c,col:d,worksheet:o,workbook:t})}});u.add(l),r._worksheetDisposables.set(yT(n,o),u)})};t.getSheets().forEach(o=>i(o)),e.add(je(t.sheetCreated$.subscribe(o=>i(o)))),e.add(je(t.sheetDisposed$.subscribe(o=>this._disposeSheetInterceptor(n,o)))),e.add(je(()=>t.getSheets().forEach(o=>this._disposeSheetInterceptor(n,o))))}_disposeWorkbookInterceptor(t){const e=t.getUnitId(),n=this._workbookDisposables.get(e);n&&(n.dispose(),this._workbookDisposables.delete(e))}_disposeSheetInterceptor(t,e){const n=yT(t,e),r=this._worksheetDisposables.get(n);r&&(r.dispose(),this._worksheetDisposables.delete(n))}};In=ZOe([yt(ot.Starting,In),QOe(0,ae)],In);function yT(t,e){return`${t}|${e.getSheetId()}`}const ci=(t,e)=>{const{unitId:n,subUnitId:r,cellValue:i}=e,o=t.get(ae).getUniverSheetInstance(n);if(o==null)throw new Error("workbook is null error!");const a=o.getSheetBySheetId(r);if(a==null)throw new Error("worksheet is null error!");const s=a.getCellMatrix(),u=o.getStyles(),l=new Ye;return new Ye(i).forValue((c,d,m)=>{const f=Ie.deepClone(s==null?void 0:s.getValue(c,d))||{},h=u.getStyleByCell(f),p=tPe(h,m&&m.s?m.s:null);f.s=p,l.setValue(c,d,JOe(f))}),{...e,options:{},cellValue:l.getMatrix()}};function JOe(t){return t==null?null:(t.f===void 0&&(t.f=null),t.si===void 0&&(t.si=null),t.p===void 0&&(t.p=null),t.v===void 0&&(t.v=null),t.t===void 0&&(t.t=null),t.s===void 0&&(t.s=null),t)}const Vt={id:"sheet.mutation.set-range-values",type:ue.MUTATION,handler:(t,e)=>{const{cellValue:n,subUnitId:r,unitId:i}=e,o=t.get(ae).getUniverSheetInstance(i);if(!o)return!1;const a=o.getSheetBySheetId(r);if(!a)return!1;const s=a.getCellMatrix(),u=o.getStyles();return new Ye(n).forValue((l,c,d)=>{if(!d)s==null||s.setValue(l,c,{});else{const m=s.getValue(l,c)||{},f=d.t===$n.FORCE_STRING?d.t:ePe(d.v===void 0?m.v:d.v);if(d.f!==void 0&&(m.f=d.f),d.si!==void 0&&(m.si=d.si),d.p!==void 0&&(m.p=d.p),d.v!==void 0&&(m.v=f===$n.NUMBER?Number(d.v):d.v),m.v!==void 0&&(m.t=f),d.s!==void 0){const h=u.getStyleByCell(m);h==null&&delete m.s,typeof d.s=="string"&&(d.s=u.get(d.s));const p=pU(h,d.s?d.s:null);p&&Ie.removeNull(p),Ie.isEmptyObject(p)?delete m.s:m.s=u.setValue(p),!d.p&&m.p&&iPe(m.p,d.s?d.s:null)}s.setValue(l,c,Ie.removeNull(m))}}),!0}};function ePe(t){return t===null?null:typeof t=="string"?aPe(t)?$n.NUMBER:sPe(t)?$n.BOOLEAN:$n.STRING:typeof t=="number"?$n.NUMBER:typeof t=="boolean"?$n.BOOLEAN:$n.FORCE_STRING}function tPe(t,e){return nPe(t,e)}function nPe(t,e){if(!e||!Object.keys(e).length)return t;const n=t||{};for(const r in e)r==="bd"?n[r]=rPe(n[r]||{},e[r]):r in n||(n[r]=null);return n}function rPe(t,e){if(!e||!Object.keys(e).length)return t;for(const n in e)n in t||(t[n]=null);return t}function pU(t,e,n=!1){if(e===null)return e;if(e===void 0)return t;const r=Ie.deepClone(t)||{};if(r){for(const i in e)n&&["bd","tr","td","ht","vt","tb","pd"].includes(i)||(i in r&&i==="bd"?r[i]=Object.assign(r[i],e[i]):r[i]=e[i]);return"cl"in r&&("ul"in r&&r.ul&&(r.ul.cl=r.cl),"ol"in r&&r.ol&&(r.ol.cl=r.cl),"st"in r&&r.st&&(r.st.cl=r.cl)),r}}function iPe(t,e){var n,r;(r=(n=t.body)==null?void 0:n.textRuns)==null||r.forEach(i=>{i.ts||(i.ts={});const o=i.ts||{},a=pU(o,e,!0);a&&Ie.removeNull(a),Ie.isEmptyObject(a)?delete i.ts:i.ts=a})}function oPe(t){return/^-?\d+(\.\d+)?$/.test(t)}function aPe(t){return oPe(t)?Number(t)<=Number.MAX_SAFE_INTEGER:!1}function sPe(t){return t.toUpperCase()==="TRUE"||t.toUpperCase()==="FALSE"}const Tf={id:"sheet.command.clear-selection-all",type:ue.COMMAND,handler:async t=>{const e=t.get(ae),n=t.get(se),r=t.get(dt),i=t.get(en),o=t.get(In),a=e.getCurrentUniverSheetInstance(),s=a.getUnitId(),u=a.getActiveSheet().getSheetId(),l=r.getSelectionRanges();if(!(l!=null&&l.length))return!1;const c=[],d=[],m={subUnitId:u,unitId:s,cellValue:uPe(l)},f=ci(t,m);c.push({id:Vt.id,params:m}),d.push({id:Vt.id,params:f});const h=o.onCommandExecute({id:Tf.id});return c.push(...h.redos),d.unshift(...h.undos),lr(c,n)?(i.pushUndoRedo({unitID:s,undoMutations:d,redoMutations:c}),!0):!1}};function uPe(t){const e=new Ye;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:a}=n;for(let s=r;s<=o;s++)for(let u=i;u<=a;u++)e.setValue(s,u,null)}),e.getData()}const wf={id:"sheet.command.clear-selection-content",type:ue.COMMAND,handler:async t=>{const e=t.get(ae),n=t.get(se),r=t.get(dt),i=t.get(en),o=t.get(In),a=e.getCurrentUniverSheetInstance(),s=a.getUnitId(),u=a.getActiveSheet().getSheetId(),l=r.getSelectionRanges();if(!(l!=null&&l.length))return!1;const c={subUnitId:u,unitId:s,cellValue:lPe(l)},d=ci(t,c),m=o.onCommandExecute({id:wf.id}),f=[{id:Vt.id,params:c},...m.redos],h=[...m.undos,{id:Vt.id,params:d}];return lr(f,n).result?(i.pushUndoRedo({unitID:s,undoMutations:h,redoMutations:f}),!0):!1}};function lPe(t){const e=new Ye;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:a}=n;for(let s=r;s<=o;s++)for(let u=i;u<=a;u++)e.setValue(s,u,{v:null,p:null,f:null,si:null})}),e.getData()}const ll={id:"sheet.command.clear-selection-format",type:ue.COMMAND,handler:async t=>{const e=t.get(ae),n=t.get(se),r=t.get(dt),i=t.get(en),o=t.get(In),a=e.getCurrentUniverSheetInstance(),s=a.getUnitId(),u=a.getActiveSheet().getSheetId(),l=r.getSelectionRanges();if(!(l!=null&&l.length))return!1;const c=[],d=[],m={subUnitId:u,unitId:s,cellValue:cPe(l)},f=ci(t,m);c.push({id:Vt.id,params:m}),d.push({id:Vt.id,params:f});const h=o.onCommandExecute({id:ll.id});return c.push(...h.redos),d.unshift(...h.undos),lr(c,n)?(i.pushUndoRedo({unitID:s,undoMutations:d,redoMutations:c}),!0):!1}};function cPe(t){const e=new Ye;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:a}=n;for(let s=r;s<=o;s++)for(let u=i;u<=a;u++)e.setValue(s,u,{s:null})}),e.getData()}const gU=(t,e)=>({subUnitId:e.sheet.id,unitId:e.unitId,subUnitName:e.sheet.name}),Eo={id:"sheet.mutation.insert-sheet",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae),{sheet:r,index:i,unitId:o}=e,a=n.getUniverSheetInstance(o);return a?a.addWorksheet(r.id,i,r):!1}},dPe=(t,e)=>{const n=t.get(ae).getCurrentUniverSheetInstance(),{subUnitId:r,unitId:i}=e,o=n.getSheetBySheetId(r).getConfig();return{index:n.getConfig().sheetOrder.findIndex(a=>a===r),sheet:o,unitId:i}},Qo={id:"sheet.mutation.remove-sheet",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae),{subUnitId:r,unitId:i}=e,o=n.getUniverSheetInstance(i);return o?o.removeSheet(r):!1}},vU={type:ue.COMMAND,id:"sheet.command.copy-sheet",handler:async(t,e)=>{var n,r;const i=t.get(se),o=t.get(en),a=t.get(ae),s=t.get(Gt);let u=a.getCurrentUniverSheetInstance().getUnitId(),l=a.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(u=(n=e.unitId)!=null?n:u,l=(r=e.subUnitId)!=null?r:l);const c=a.getUniverSheetInstance(u);if(!c)return!1;const d=c.getSheetBySheetId(l);if(!d)return!1;const m=Ie.deepClone(d.getConfig());m.name+=s.t("sheets.sheetCopy"),m.id=Ie.generateRandomId();const f={index:c.getSheetIndex(d)+1,sheet:m,unitId:u},h=gU(t,f);return i.syncExecuteCommand(Eo.id,f)?(o.pushUndoRedo({unitID:u,undoMutations:[{id:Qo.id,params:h}],redoMutations:[{id:Eo.id,params:f}]}),!0):!1}},qa={id:"sheet.mutation.move-range",type:ue.MUTATION,handler:(t,e)=>{const{from:n,to:r}=e;if(!n||!r)return!1;const i=t.get(ae).getCurrentUniverSheetInstance();if(!i)return!1;const o=i.getSheetBySheetId(e.from.subUnitId),a=i.getSheetBySheetId(e.to.subUnitId);if(!o||!a)return!1;const s=o.getCellMatrix(),u=a.getCellMatrix();return new Ye(n.value).forValue((l,c,d)=>{s.setValue(l,c,d)}),new Ye(r.value).forValue((l,c,d)=>{u.setValue(l,c,d)}),!0}},_n={id:"sheet.operation.set-selections",type:ue.OPERATION,handler:(t,e)=>{const n=t.get(dt);if(!e)return!1;const{selections:r,type:i}=e;return n.replace(r,i),!0}};function ca(t,e,n=!0){const r=e.getMatrixWithMergedCells(...kW(t)),i=[];if(r.forValue((a,s,u)=>{if(u.colSpan!==void 0&&u.rowSpan!==void 0){const l={startRow:a,startColumn:s,endRow:a+u.rowSpan-1,endColumn:s+u.colSpan-1};ht.contains(t,l)||i.push(l)}}),i.length===0)return t;const o=ht.union(t,...i);return n?ca(o,e,n):o}function k9(t,e,n){let r=null;return n.getMatrixWithMergedCells(t,e,t,e).forValue((i,o,a)=>(r={actualRow:i,actualColumn:o,startRow:i,startColumn:o,isMerged:a.rowSpan!==void 0||a.colSpan!==void 0,isMergedMainCell:a.rowSpan!==void 0&&a.colSpan!==void 0,endRow:i+(a.rowSpan!==void 0?a.rowSpan-1:0),endColumn:o+(a.colSpan!==void 0?a.colSpan-1:0),rangeType:ct.NORMAL},!1)),r||{actualColumn:e,actualRow:t,startRow:t,startColumn:e,endRow:t,endColumn:e,isMerged:!1,isMergedMainCell:!1,rangeType:ct.NORMAL}}function yo(t,e){const n=e.getMergedCell(t.startRow,t.startColumn);return n?{...n,actualRow:t.startRow,actualColumn:t.startColumn,rangeType:ct.NORMAL,isMerged:!0,isMergedMainCell:!0}:{startRow:t.startRow,startColumn:t.startColumn,endRow:t.startRow,endColumn:t.startColumn,actualRow:t.startRow,actualColumn:t.startColumn,rangeType:ct.NORMAL,isMerged:!1,isMergedMainCell:!1}}const Ol=(t,e,n)=>({id:_n.id,params:{unitId:e.getUnitId(),subUnitId:n.getSheetId(),pluginName:Nn,selections:[{range:t,primary:yo(t,n)}]}}),bU="sheet.command.move-range",Qc={type:ue.COMMAND,id:bU,handler:(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(Z0),a=i.getCurrentUniverSheetInstance(),s=a.getActiveSheet(),u=a.getUnitId(),l=s.getSheetId(),c=KE(t,{unitId:u,subUnitId:l,range:e.fromRange},{unitId:u,subUnitId:l,range:e.toRange});if(c===null)return o.emit("Across a merged cell."),!1;const d=t.get(In).onCommandExecute({id:Qc.id,params:{...e}}),m=[...c.redos,...d.redos,{id:_n.id,params:{unitId:u,subUnitId:l,pluginName:Nn,selections:[{range:e.toRange,primary:yo(e.toRange,s)}]}}],f=[{id:_n.id,params:{unitId:u,subUnitId:l,pluginName:Nn,selections:[{range:e.fromRange,primary:yo(e.fromRange,s)}]}},...c.undos,...d.undos];return lr(m,n).result?(r.pushUndoRedo({unitID:u,undoMutations:f,redoMutations:m}),!0):!1}};function KE(t,e,n,r=!1){const i=[],o=[],{range:a,subUnitId:s,unitId:u}=e,{range:l,subUnitId:c}=n,d=t.get(ae).getUniverSheetInstance(u),m=d==null?void 0:d.getSheetBySheetId(c),f=d==null?void 0:d.getSheetBySheetId(s),h=m==null?void 0:m.getCellMatrix(),p=f==null?void 0:f.getCellMatrix();if(m&&f&&h&&p){const v=ca(l,m,!1);if(!ht.equals(l,v)&&!r)return null;const g=new Ye,b=new Ye,C=(R,I)=>({startRow:R,endRow:R,startColumn:I,endColumn:I});mr.foreach(a,(R,I)=>{g.setValue(R,I,p.getValue(R,I)),b.setValue(R,I,null)});const S=new Ye;mr.foreach(l,(R,I)=>{S.setValue(R,I,h.getValue(R,I))});const E=new Ye;mr.foreach(a,(R,I)=>{const T=C(R,I),P=ht.getRelativeRange(T,a),N=ht.getPositionRange(P,l);E.setValue(N.startRow,N.startColumn,p.getValue(R,I))});const y={from:{value:b.getMatrix(),subUnitId:s},to:{value:E.getMatrix(),subUnitId:c},unitId:u},D={from:{value:g.getMatrix(),subUnitId:s},to:{value:S.getMatrix(),subUnitId:c},unitId:u};i.push({id:qa.id,params:y}),o.push({id:qa.id,params:D})}return{redos:i,undos:o}}const Ga={id:"sheet.command.set-range-values",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(dt),a=t.get(In),{value:s,range:u,unitId:l=i.getCurrentUniverSheetInstance().getUnitId(),subUnitId:c=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId()}=e,d=u?[u]:o.getSelectionRanges();if(!d||!d.length)return!1;const m=new Ye;let f;if(Ie.isArray(s))for(let S=0;S<d.length;S++){const{startRow:E,startColumn:y,endRow:D,endColumn:R}=d[S];for(let I=0;I<=D-E;I++)for(let T=0;T<=R-y;T++)m.setValue(I+E,T+y,s[I][T])}else if(jL(s))for(let S=0;S<d.length;S++){const{startRow:E,startColumn:y,endRow:D,endColumn:R}=d[S];for(let I=E;I<=D;I++)for(let T=y;T<=R;T++)m.setValue(I,T,s)}else f=s;const h={subUnitId:c,unitId:l,cellValue:f??m.getMatrix()},p=ci(t,h);if(!a.fetchThroughInterceptors(Rs.PERMISSION)(null,{id:Ga.id,params:h}))return!1;const v=n.syncExecuteCommand(Vt.id,h),{undos:g,redos:b}=a.onCommandExecute({id:Ga.id,params:{...h,range:d}}),C=await lr([...b],n);return v&&C.result?(r.pushUndoRedo({unitID:l,undoMutations:[{id:Vt.id,params:p},...g],redoMutations:[{id:Vt.id,params:h},...b]}),!0):!1}};function _U(t,e){const n=[],r=[],{unitId:i,subUnitId:o,range:a,shiftDimension:s,cellValue:u={}}=e,l=t.get(ae),c=t.get(In),d=l.getUniverSheetInstance(i),m=d==null?void 0:d.getSheetBySheetId(o);if(m){const f=m.getCellMatrix(),h=f.getDataRange();if(a.startColumn<=h.endColumn||a.startRow<=h.endRow){let C,S;if(s===Tr.COLUMNS){const y=Math.min(a.endRow,h.endRow);let D=0;for(let I=a.startRow;I<=y;I++){const T=f.getRow(I),P=T?Ss(T)-1:0;D=Math.max(D,P)}C={startRow:a.startRow,startColumn:a.startColumn,endRow:y,endColumn:D};const R=a.endColumn-a.startColumn+1;S={startRow:a.startRow,startColumn:C.startColumn+R,endRow:y,endColumn:C.endColumn+R}}else{const y=Math.min(a.endColumn,h.endColumn),D=h.endRow;C={startRow:a.startRow,startColumn:a.startColumn,endRow:D,endColumn:y};const R=a.endRow-a.startRow+1;S={startRow:C.startRow+R,startColumn:a.startColumn,endRow:C.endRow+R,endColumn:y}}const E=KE(t,{unitId:i,subUnitId:o,range:C},{unitId:i,subUnitId:o,range:S},!0);E&&(n.push(...E.redos),r.push(...E.undos))}if(Object.entries(u).length===0)for(let C=a.startRow;C<=a.endRow;C++){u[C]||(u[C]={});for(let S=a.startColumn;S<=a.endColumn;S++)u[C][S]=null}const p={subUnitId:o,unitId:i,cellValue:u},v=ci(t,p),{undos:g,redos:b}=c.onCommandExecute({id:Ga.id,params:{...p,range:a}});n.push({id:Vt.id,params:p},...b),r.push({id:Vt.id,params:v},...g)}return{redo:n,undo:r}}function CU(t,e){const n=[],r=[],{unitId:i,subUnitId:o,range:a,shiftDimension:s}=e,u=t.get(ae),l=t.get(In),c=u.getUniverSheetInstance(i),d=c==null?void 0:c.getSheetBySheetId(o);if(d){const m=d.getCellMatrix(),f=m.getDataRange(),h={subUnitId:o,unitId:i,cellValue:mPe([a])},p=ci(t,h),v=l.onCommandExecute({id:Ga.id,params:h});if(n.push({id:Vt.id,params:h},...v.redos),r.push(...v.undos,{id:Vt.id,params:p}),a.startColumn<=f.endColumn||a.startRow<=f.endRow){let g=null,b=null;if(s===Tr.COLUMNS&&a.endColumn<f.endColumn){const C=Math.min(a.endRow,f.endRow);let S=0;for(let y=a.startRow;y<=C;y++){const D=m.getRow(y),R=D?Ss(D)-1:0;S=Math.max(S,R)}g={startRow:a.startRow,startColumn:a.endColumn+1,endRow:C,endColumn:S};const E=a.endColumn-a.startColumn+1;b={startRow:a.startRow,startColumn:g.startColumn-E,endRow:C,endColumn:g.endColumn-E}}if(s===Tr.ROWS&&a.endRow<f.endRow){const C=Math.min(a.endColumn,f.endColumn),S=f.endRow;g={startRow:a.endRow+1,startColumn:a.startColumn,endRow:S,endColumn:C};const E=a.endRow-a.startRow+1;b={startRow:g.startRow-E,startColumn:a.startColumn,endRow:g.endRow-E,endColumn:C}}if(g&&b){const C=KE(t,{unitId:i,subUnitId:o,range:g},{unitId:i,subUnitId:o,range:b},!0);C&&(n.push(...C.redos),r.push(...C.undos))}}}return{redo:n,undo:r}}function N8(t,e,n,r,i,o){const{startRow:a,endRow:s,startColumn:u,endColumn:l}=e;if(i===Tr.ROWS){const c=s-a+1;for(let d=n;d>=a;d--)for(let m=u;m<=l;m++){const f=t.getValue(d,m);f==null?t.realDeleteValue(d+c,m):t.setValue(d+c,m,f)}for(let d=s;d>=a;d--)for(let m=u;m<=l;m++)o&&o[d]&&o[d][m]?t.setValue(d,m,o[d][m]):t.realDeleteValue(d,m)}else if(i===Tr.COLUMNS){const c=l-u+1;for(let d=a;d<=s;d++)for(let m=r;m>=u;m--){const f=t.getValue(d,m);f==null?t.realDeleteValue(d,m+c):t.setValue(d,m+c,f)}for(let d=a;d<=s;d++)for(let m=l;m>=u;m--)o&&o[d]&&o[d][m]?t.setValue(d,m,o[d][m]):t.realDeleteValue(d,m)}}function x8(t,e,n,r,i){const{startRow:o,endRow:a,startColumn:s,endColumn:u}=e,l=a-o+1,c=u-s+1;if(i===Tr.ROWS)for(let d=o;d<=n;d++)for(let m=s;m<=u;m++){const f=t.getValue(d+l,m);f==null?t.realDeleteValue(d,m):t.setValue(d,m,f)}else if(i===Tr.COLUMNS)for(let d=o;d<=a;d++)for(let m=s;m<=r;m++){const f=t.getValue(d,m+c);f==null?t.realDeleteValue(d,m):t.setValue(d,m,f)}}function mPe(t){const e=new Ye;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:a}=n;for(let s=r;s<=o;s++)for(let u=i;u<=a;u++)e.setValue(s,u,null)}),e.getData()}const SU="sheet.command.delete-range-move-left",Fc={type:ue.COMMAND,id:SU,handler:async(t,e)=>{var n;const r=t.get(se),i=t.get(en),o=t.get(ae),a=t.get(dt),s=t.get(In),u=o.getCurrentUniverSheetInstance().getUnitId(),l=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let c=e==null?void 0:e.range;if(c||(c=(n=a.getLast())==null?void 0:n.range),!c)return!1;const d=o.getUniverSheetInstance(u);if(!d)return!1;const m=d.getSheetBySheetId(l);if(!m)return!1;const f={range:c,subUnitId:l,unitId:u,shiftDimension:Tr.COLUMNS},h=s.onCommandExecute({id:Fc.id,params:{range:c}}),{redo:p,undo:v}=CU(t,f),g=[...p],b=[...v];return g.push(...h.redos),g.push(Ol(c,d,m)),b.push(...h.undos),lr(g,r).result?(i.pushUndoRedo({unitID:u,undoMutations:b.reverse(),redoMutations:g}),!0):!1}},EU="sheet.command.delete-range-move-up",$c={type:ue.COMMAND,id:EU,handler:async(t,e)=>{var n;const r=t.get(se),i=t.get(en),o=t.get(ae),a=t.get(dt),s=t.get(In),u=o.getCurrentUniverSheetInstance().getUnitId(),l=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let c=e==null?void 0:e.range;if(c||(c=(n=a.getLast())==null?void 0:n.range),!c)return!1;const d=o.getUniverSheetInstance(u);if(!d)return!1;const m=d.getSheetBySheetId(l);if(!m)return!1;const f={range:c,subUnitId:l,unitId:u,shiftDimension:Tr.ROWS},h=s.onCommandExecute({id:$c.id,params:{range:c}}),{redo:p,undo:v}=CU(t,f),g=[...p],b=[...v];return g.push(...h.redos),g.push(Ol(c,d,m)),b.push(...h.undos),await lr(g,r).result?(i.pushUndoRedo({unitID:u,undoMutations:b.reverse(),redoMutations:g}),!0):!1}},yU=(t,e)=>{if(t.get(ae).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}},kc={id:"sheet.mutation.insert-row",type:ue.MUTATION,handler:(t,e)=>{var n;const{unitId:r,subUnitId:i,range:o,rowInfo:a}=e,s=t.get(ae).getUniverSheetInstance(r);if(s==null)throw new Error("universheet is null error!");const u=s.getSheetBySheetId(i);if(u==null)throw new Error("worksheet is null error!");const l=u.getRowManager().getRowData(),c={h:u.getConfig().defaultRowHeight,hd:0},d=o.startRow,m=o.endRow-o.startRow+1;for(let f=d;f<d+m;f++)a?y0(f,(n=a[f-o.startRow])!=null?n:c,l):y0(f,c,l);return u.setRowCount(u.getRowCount()+o.endRow-o.startRow+1),u.getCellMatrix().insertRows(o.startRow,m),!0}},DU=(t,e)=>{if(t.get(ae).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range}},Bc={id:"sheet.mutation.insert-col",type:ue.MUTATION,handler:(t,e)=>{var n;const r=t.get(ae).getUniverSheetInstance(e.unitId);if(r==null)throw new Error("universheet is null error!");const i=r.getSheetBySheetId(e.subUnitId);if(!i)return!1;const o=i.getColumnManager(),{range:a,colInfo:s}=e,u=o.getColumnData(),l=a.startColumn,c=a.endColumn-a.startColumn+1,d=i.getConfig().defaultColumnWidth;for(let m=l;m<l+c;m++){const f={w:d,hd:0};s?y0(m,(n=s[m-a.startColumn])!=null?n:f,u):y0(m,f,u)}return i.setColumnCount(i.getColumnCount()+a.endColumn-a.startColumn+1),i.getCellMatrix().insertColumns(a.startColumn,c),!0}},fPe=(t,e)=>{const n=e.getRowManager().getRowData(),r={},i=t.range,o=DL(i.startRow,i.endRow,n),a=yL(r,o);return{unitId:t.unitId,subUnitId:t.subUnitId,range:t.range,rowInfo:a}},cl={id:"sheet.mutation.remove-rows",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=e.range,o=r.getRowManager().getRowData(),a=i.endRow-i.startRow+1;return Dh(i.startRow,a,o),r.getCellMatrix().removeRows(i.startRow,a),r.setRowCount(r.getRowCount()-a),!0}},hPe=(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("worksheet is null error!");const i=r.getColumnManager().getColumnData(),o={},a=e.range,s=DL(a.startColumn,a.endColumn,i),u=yL(o,s);return{unitId:e.unitId,subUnitId:e.subUnitId,range:e.range,colInfo:u}},dl={id:"sheet.mutation.remove-col",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=e.range,o=r.getColumnManager().getColumnData(),a=i.endColumn-i.startColumn+1;return Dh(i.startColumn,a,o),r.setColumnCount(r.getColumnCount()-a),r.getCellMatrix().removeColumns(i.startColumn,a),!0}},pPe="sheet.command.insert-range-move-down",ml={type:ue.COMMAND,id:"sheet.command.insert-range-move-down",handler:async(t,e)=>{var n;const r=t.get(se),i=t.get(en),o=t.get(ae),a=t.get(oo),s=t.get(dt),u=t.get(In);if(s.isOverlapping())return a.error("Cannot use that command on overlapping selections."),!1;const l=o.getCurrentUniverSheetInstance().getUnitId(),c=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let d=e==null?void 0:e.range;if(d||(d=(n=s.getLast())==null?void 0:n.range),!d)return!1;const m=o.getUniverSheetInstance(l);if(!m)return!1;const f=m.getSheetBySheetId(c);if(!f)return!1;const h=[],p=[],v=f.getCellMatrix(),g=v.getDataRange(),b=v.getSlice(g.startRow,g.endRow,d.startColumn,d.endColumn).getDataRange().endRow,C=Math.max(b+(d.endRow-d.startRow+1)-g.endRow,0);if(C>0){const I=d.startRow-1,T=f.getRowHeight(I),P={unitId:l,subUnitId:c,range:{startRow:g.endRow+1,endRow:g.endRow+C,startColumn:g.startColumn,endColumn:g.endColumn},rowInfo:new Array(C).fill(void 0).map(()=>({h:T,hd:we.FALSE}))};h.push({id:kc.id,params:P});const N=yU(t,P);p.push({id:cl.id,params:N})}const S={};mr.foreach(d,(I,T)=>{const P=f.getCell(I,T);P&&(S[I]||(S[I]={}),S[I][T]={s:P.s})});const E={range:d,subUnitId:c,unitId:l,shiftDimension:Tr.ROWS,cellValue:S},{redo:y,undo:D}=_U(t,E);h.push(...y),p.push(...D);const R=u.onCommandExecute({id:ml.id,params:{range:d}});return h.push(...R.redos),h.push(Ol(d,m,f)),p.push(...R.undos),lr(h,r)?(i.pushUndoRedo({unitID:l,undoMutations:p.reverse(),redoMutations:h}),!0):!1}},RU="sheet.command.insert-range-move-right",fl={type:ue.COMMAND,id:RU,handler:async(t,e)=>{var n;const r=t.get(se),i=t.get(en),o=t.get(ae),a=t.get(oo),s=t.get(dt),u=t.get(In);if(s.isOverlapping())return a.error("Cannot use that command on overlapping selections."),!1;const l=o.getCurrentUniverSheetInstance().getUnitId(),c=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();let d=e==null?void 0:e.range;if(d||(d=(n=s.getLast())==null?void 0:n.range),!d)return!1;const m=o.getUniverSheetInstance(l);if(!m)return!1;const f=m.getSheetBySheetId(c);if(!f)return!1;const h=[],p=[],v=f.getCellMatrix(),g=v.getDataRange(),b=v.getSlice(d.startRow,d.endRow,g.startColumn,g.endColumn).getDataRange().endColumn,C=Math.max(b+(d.endColumn-d.startColumn+1)-g.endColumn,0);if(C>0){const I=d.startColumn-1,T=f.getColumnWidth(I),P={unitId:l,subUnitId:c,range:{startRow:g.startRow+1,endRow:g.endRow,startColumn:g.endColumn+1,endColumn:g.endColumn+C},colInfo:new Array(C).fill(void 0).map(()=>({w:T,hd:we.FALSE}))};h.push({id:Bc.id,params:P});const N=DU(t,P);p.push({id:dl.id,params:N})}const S={};mr.foreach(d,(I,T)=>{const P=f.getCell(I,T);!P||!P.s||(S[I]||(S[I]={}),S[I][T]={s:P.s})});const E={range:d,subUnitId:c,unitId:l,shiftDimension:Tr.COLUMNS,cellValue:S},{redo:y,undo:D}=_U(t,E);h.push(...y),p.push(...D);const R=u.onCommandExecute({id:fl.id,params:{range:d}});return h.push(...R.redos),h.push(Ol(d,m,f)),p.push(...R.undos),lr(h,r).result?(i.pushUndoRedo({unitID:l,undoMutations:p.reverse(),redoMutations:h}),!0):!1}},IU="sheet.command.insert-row",Jc={type:ue.COMMAND,id:IU,handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(In),a=i.getUniverSheetInstance(e.unitId),s=a.getSheetBySheetId(e.subUnitId),{range:u,direction:l,unitId:c,subUnitId:d}=e,{startRow:m,endRow:f}=u,h=l===ye.UP?m:m-1,p=s.getRowHeight(h),v={unitId:c,subUnitId:d,range:u,rowInfo:new Array(f-m+1).fill(void 0).map(()=>({h:p,hd:we.FALSE}))},g=yU(t,v),b=o.onCommandExecute({id:Jc.id,params:e});return lr([{id:kc.id,params:v},...b.redos,Ol(u,a,s)],n).result?(r.pushUndoRedo({unitID:e.unitId,undoMutations:[{id:cl.id,params:g},...b.redos],redoMutations:[...b.undos,{id:kc.id,params:v}]}),!0):!1}},AU={type:ue.COMMAND,id:"sheet.command.insert-row-before",handler:async t=>{var e;const n=(e=t.get(dt).getSelections())==null?void 0:e.map(d=>d.range);let r;if((n==null?void 0:n.length)===1)r=n[0];else return!1;const i=t.get(ae).getCurrentUniverSheetInstance();if(!i)return!1;const o=i.getActiveSheet();if(!o)return!1;const a=i.getUnitId(),s=o.getSheetId(),u=r.endRow-r.startRow+1,l={};mr.foreach(r,(d,m)=>{const f=o.getCell(d,m);!f||!f.s||(l[d]||(l[d]={}),l[d][m]={s:f.s})});const c={unitId:a,subUnitId:s,direction:ye.UP,range:{startRow:r.startRow,endRow:r.startRow+u-1,startColumn:0,endColumn:o.getColumnCount()-1},cellValue:l};return t.get(se).executeCommand(Jc.id,c)}},TU={type:ue.COMMAND,id:"sheet.command.insert-row-after",handler:async t=>{var e;const n=(e=t.get(dt).getSelections())==null?void 0:e.map(c=>c.range);let r;if((n==null?void 0:n.length)===1)r=n[0];else return!1;const i=t.get(ae).getCurrentUniverSheetInstance();if(!i)return!1;const o=i.getActiveSheet();if(!o)return!1;const a=i.getUnitId(),s=o.getSheetId(),u=r.endRow-r.startRow+1,l={unitId:a,subUnitId:s,direction:ye.DOWN,range:{startRow:r.endRow+1,endRow:r.endRow+u,startColumn:0,endColumn:o.getColumnCount()-1}};return t.get(se).executeCommand(Jc.id,l)}},wU="sheet.command.insert-col",e2={type:ue.COMMAND,id:wU,handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(In),{range:a,direction:s,subUnitId:u,unitId:l,cellValue:c}=e,{startColumn:d,endColumn:m}=e.range,f=i.getUniverSheetInstance(e.unitId),h=f.getSheetBySheetId(e.subUnitId),p=s===ye.LEFT?d:d-1,v=h.getColumnWidth(p),g={unitId:l,subUnitId:u,range:a,colInfo:new Array(m-d+1).fill(void 0).map(()=>({w:v,hd:we.FALSE}))},b=DU(t,g);e.unitId,e.subUnitId,e.range,Tr.COLUMNS;const C=o.onCommandExecute({id:e2.id,params:e});return lr([{id:Bc.id,params:g},...C.redos,Ol(a,f,h)],n).result?(r.pushUndoRedo({unitID:e.unitId,undoMutations:[...C.undos,{id:dl.id,params:b}],redoMutations:[{id:Bc.id,params:g},...C.redos]}),!0):!1}},LU={type:ue.COMMAND,id:"sheet.command.insert-col-before",handler:async t=>{const e=t.get(dt).getSelections();let n;if((e==null?void 0:e.length)===1)n=e[0].range;else return!1;const r=t.get(ae).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),a=i.getSheetId(),s=n.endColumn-n.startColumn+1,u={};mr.foreach(n,(c,d)=>{const m=i.getCell(c,d);!m||!m.s||(u[c]||(u[c]={}),u[c][d]={s:m.s})});const l={unitId:o,subUnitId:a,direction:ye.LEFT,range:{startColumn:n.startColumn,endColumn:n.startColumn+s-1,startRow:0,endRow:i.getLastRowWithContent()},cellValue:u};return t.get(se).executeCommand(e2.id,l)}},OU={type:ue.COMMAND,id:"sheet.command.insert-col-after",handler:async t=>{const e=t.get(dt).getSelections();let n;if((e==null?void 0:e.length)===1)n=e[0].range;else return!1;const r=t.get(ae).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),a=i.getSheetId(),s=n.endColumn-n.startColumn+1,u={unitId:o,subUnitId:a,direction:ye.RIGHT,range:{startColumn:n.endColumn+1,endColumn:n.endColumn+s,startRow:0,endRow:i.getLastRowWithContent()}};return t.get(se).executeCommand(e2.id,u)}},PU={id:"sheet.command.insert-sheet",type:ue.COMMAND,handler:(t,e)=>{var n,r;const i=t.get(se),o=t.get(en),a=t.get(ae),s=t.get(Gt),u=(n=e==null?void 0:e.unitId)!=null?n:a.getCurrentUniverSheetInstance().getUnitId(),l=a.getUniverSheetInstance(u);if(!l)return!1;let c=l.getSheets().length,d=WL({});e?(c=(r=e.index)!=null?r:c,e.sheet?d=e.sheet:(d.id=Ie.generateRandomId(),d.name=l.generateNewSheetName(`${s.t("sheets.sheet")}`))):(d.id=Ie.generateRandomId(),d.name=l.generateNewSheetName(`${s.t("sheets.sheet")}`));const m={index:c,sheet:d,unitId:u},f=gU(t,m);return i.syncExecuteCommand(Eo.id,m)?(o.pushUndoRedo({unitID:u,undoMutations:[{id:Qo.id,params:f}],redoMutations:[{id:Eo.id,params:m}]}),!0):!1}};function gPe(t,e){const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,a=i.startRow>o.startRow,s=i.endRow-i.startRow+1;return a?{unitId:n,subUnitId:r,sourceRange:ht.clone(o),targetRange:{...i,endRow:i.endRow+s,startRow:i.startRow+s}}:{unitId:n,subUnitId:r,targetRange:ht.clone(i),sourceRange:{...o,endRow:o.endRow-s,startRow:o.startRow-s}}}const U0={id:"sheet.mutation.move-rows",type:ue.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,a=t.get(ae).getUniverSheetInstance(n);if(!a)throw new Error("[MoveRowMutation] univerSheet is null!");const s=a.getSheetBySheetId(r);if(!s)throw new Error("[MoveRowMutation] worksheet is null!");const u=i.startRow,l=i.endRow-i.startRow+1,c=o.startRow,d=s.getRowManager().getRowData();return Rh(u,l,c,d),s.getCellMatrix().moveRows(u,l,c),!0}};function vPe(t,e){const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,a=i.startColumn>o.startColumn,s=i.endColumn-i.startColumn+1;return a?{unitId:n,subUnitId:r,sourceRange:ht.clone(o),targetRange:{...i,endColumn:i.endColumn+s,startColumn:i.startColumn+s}}:{unitId:n,subUnitId:r,targetRange:ht.clone(i),sourceRange:{...o,startColumn:o.startColumn-s,endColumn:o.endColumn-s}}}const V0={id:"sheet.mutation.move-columns",type:ue.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,sourceRange:i,targetRange:o}=e,a=t.get(ae).getUniverSheetInstance(n);if(!a)throw new Error("[MoveColumnMutation] univerSheet is null!");const s=a.getSheetBySheetId(r);if(!s)throw new Error("[MoveColumnMutation] worksheet is null!");const u=i.startColumn,l=i.endColumn-i.startColumn+1,c=o.startColumn,d=s.getColumnManager().getColumnData();return Rh(u,l,c,d),s.getCellMatrix().moveColumns(u,l,c),!0}};function bPe(t,e){return e.getMergeData().some(n=>n.startRow<t&&t<=n.endRow)}function _Pe(t,e){return e.getMergeData().some(n=>n.startColumn<t&&t<=n.endColumn)}const MU="sheet.command.move-rows",fd={id:MU,type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(dt).getSelections(),{fromRange:{startRow:r},toRange:{startRow:i}}=e,o=n==null?void 0:n.filter(P=>P.range.rangeType===ct.ROW&&P.range.startRow<=r&&r<=P.range.endRow);if((o==null?void 0:o.length)!==1)return!1;const a=t.get(In),s=t.get(ae).getCurrentUniverSheetInstance();if(!s)return!1;const u=s.getActiveSheet();if(!u)return!1;const l=s.getUnitId(),c=u.getSheetId(),d=t.get(Z0),m=o[0].range,f=o[0].primary,h=ca(m,u,!1);if(!ht.equals(m,h))return d.emit("Only part of a merged cell is selected."),!1;if(bPe(i,u))return d.emit("Across a merged cell."),!1;const p={...m,startRow:i,endRow:i+m.endRow-m.startRow},v={unitId:l,subUnitId:c,sourceRange:m,targetRange:p},g=gPe(t,v),b=i-r<0,C=m.endRow-m.startRow+1,S=b?p:{...p,startRow:p.startRow-C,endRow:p.endRow-C},E={unitId:l,subUnitId:c,pluginName:Nn,selections:[{range:S,primary:yo(S,u),style:null}]},y={unitId:l,subUnitId:c,pluginName:Nn,selections:[{range:m,primary:f,style:null}]},D=t.get(se),R=a.onCommandExecute({id:fd.id,params:e}),I=[{id:U0.id,params:v},{id:_n.id,params:E},...R.redos],T=[{id:U0.id,params:g},{id:_n.id,params:y},...R.undos];return lr(I,D).result?(t.get(en).pushUndoRedo({unitID:l,undoMutations:T,redoMutations:I}),!0):!1}},NU="sheet.command.move-cols",hd={id:NU,type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(dt).getSelections(),{fromRange:{startColumn:r},toRange:{startColumn:i}}=e,o=n==null?void 0:n.filter(T=>T.range.rangeType===ct.COLUMN&&T.range.startColumn<=r&&r<=T.range.endColumn);if((o==null?void 0:o.length)!==1)return!1;const a=t.get(In),s=t.get(ae).getCurrentUniverSheetInstance();if(!s)return!1;const u=s.getActiveSheet();if(!u)return!1;const l=s.getUnitId(),c=u.getSheetId(),d=t.get(Z0),m=o[0].range,f=o[0].primary,h=ca(m,u,!1);if(!ht.equals(m,h))return d.emit("Only part of a merged cell is selected."),!1;if(_Pe(i,u))return d.emit("Across a merged cell."),!1;const p={...m,startColumn:i,endColumn:i+m.endColumn-m.startColumn},v={unitId:l,subUnitId:c,sourceRange:m,targetRange:p},g=vPe(t,v),b=m.endColumn-m.startColumn+1,C=i-r<0?p:{...p,startColumn:p.startColumn-b,endColumn:p.endColumn-b},S={unitId:l,subUnitId:c,pluginName:Nn,selections:[{range:C,primary:yo(C,u),style:null}]},E={unitId:l,subUnitId:c,pluginName:Nn,selections:[{range:m,primary:f,style:null}]},y=t.get(se),D=a.onCommandExecute({id:hd.id,params:e}),R=[{id:V0.id,params:v},{id:_n.id,params:S},...D.redos],I=[{id:V0.id,params:g},{id:_n.id,params:E},...D.undos];return lr(R,y).result&&t.get(en).pushUndoRedo({unitID:l,undoMutations:I,redoMutations:R}),!0}},xU="sheet.command.remove-row",t2={type:ue.COMMAND,id:xU,handler:async(t,e)=>{var n;const r=t.get(dt),i=t.get(In);let o=e==null?void 0:e.range;if(o||(o=(n=r.getLast())==null?void 0:n.range),!o)return!1;const a=t.get(ae).getCurrentUniverSheetInstance(),s=a.getActiveSheet(),u=a.getUnitId(),l=s.getSheetId();o={...o,startColumn:0,endColumn:Math.max(s.getMaxColumns()-1,0)};const c={unitId:u,subUnitId:l,range:o},d=fPe(c,s),m=i.onCommandExecute({id:t2.id,params:{range:o}}),f=t.get(se);return lr([{id:cl.id,params:c},...m.redos,Ol(o,a,s)],f).result?(t.get(en).pushUndoRedo({unitID:u,undoMutations:[...m.undos,{id:kc.id,params:d}],redoMutations:[{id:cl.id,params:c},...m.redos]}),!0):!1}},FU="sheet.command.remove-col",n2={type:ue.COMMAND,id:FU,handler:async(t,e)=>{var n;const r=t.get(dt),i=t.get(In);let o=e==null?void 0:e.range;if(o||(o=(n=r.getLast())==null?void 0:n.range),!o)return!1;const a=t.get(ae).getCurrentUniverSheetInstance(),s=a.getActiveSheet(),u=a.getUnitId(),l=s.getSheetId();o={...o,startRow:0,endRow:Math.max(s.getMaxRows()-1,0)};const c={unitId:u,subUnitId:l,range:o},d=hPe(t,c),m=i.onCommandExecute({id:n2.id,params:{range:o}}),f=t.get(se);return lr([{id:dl.id,params:c},...m.redos,Ol(o,a,s)],f).result?(t.get(en).pushUndoRedo({unitID:u,undoMutations:[...m.undos,{id:Bc.id,params:d}],redoMutations:[{id:dl.id,params:c},...m.redos]}),!0):!1}},Lf={id:"sheet.command.remove-sheet",type:ue.COMMAND,handler:async(t,e)=>{var n,r;const i=t.get(se),o=t.get(en),a=t.get(ae),s=t.get(In);let u=a.getCurrentUniverSheetInstance().getUnitId(),l=a.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(u=(n=e.unitId)!=null?n:u,l=(r=e.subUnitId)!=null?r:l);const c=a.getUniverSheetInstance(u);if(!c)return!1;const d=c.getSheetBySheetId(l);if(!d||c.getSheets().length<=1)return!1;const m=c.getSheetIndex(d);c.getConfig().sheetOrder[m+1];const f={subUnitId:l,unitId:u,subUnitName:d.getName()},h=dPe(t,f),p=s.onCommandExecute({id:Lf.id,params:{unitId:u,subUnitId:l}}),v=[{id:Qo.id,params:f},...p.redos],g=[...p.undos,{id:Eo.id,params:h}];return lr(v,i)?(o.pushUndoRedo({unitID:u,undoMutations:g,redoMutations:v}),!0):!1}},Fo=(t,e)=>{if(t.get(ae).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},Bn={id:"sheet.mutation.add-worksheet-merge",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getConfig().mergeData,o=e.ranges;for(let a=0;a<o.length;a++)i.push(o[a]);return!0}},Zi=(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("worksheet is null error!");const i=r.getConfig().mergeData,o=e.ranges,a=[];for(let s=0;s<o.length;s++)for(let u=i.length-1;u>=0;u--){const l=i[u],c=o[s];ht.intersects(l,c)&&a.push(i[u])}return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:a}},Un={id:"sheet.mutation.remove-worksheet-merge",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getConfig().mergeData,o=e.ranges;for(let a=0;a<o.length;a++)for(let s=i.length-1;s>=0;s--){const u=i[s],l=o[a];ht.intersects(u,l)&&i.splice(s,1)}return!0}},$U={type:ue.COMMAND,id:"sheet.command.remove-worksheet-merge",handler:async t=>{const e=t.get(dt),n=t.get(se),r=t.get(en),i=t.get(ae),o=e.getSelectionRanges();if(!(o!=null&&o.length))return!1;const a=i.getCurrentUniverSheetInstance().getUnitId(),s=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),u=i.getUniverSheetInstance(a);if(!u)return!1;const l=u.getSheetBySheetId(s);if(!l)return!1;const c={unitId:a,subUnitId:s,ranges:o};let d=!1;const m=l.getConfig().mergeData;if(o.forEach(h=>{m.forEach(p=>{ht.intersects(h,p)&&(d=!0)})}),!d)return!1;const f=Zi(t,c);return n.syncExecuteCommand(Un.id,c)?(r.pushUndoRedo({unitID:a,undoMutations:[{id:Bn.id,params:f}],redoMutations:[{id:Un.id,params:c}]}),!0):!1}};class hl{constructor(){fr(this,"_borderInfo",{type:ai.ALL,color:"#000000",style:Lt.THIN,activeBorderType:!1}),fr(this,"_borderInfo$",new dn(this._borderInfo)),fr(this,"borderInfo$",this._borderInfo$.asObservable())}dispose(){this._borderInfo$.complete()}setType(e){this._borderInfo.type=e,this.setActiveBorderType(!0),this.refresh()}setColor(e){this._borderInfo.color=e,this.refresh()}setStyle(e){this._borderInfo.style=e,this.refresh()}setActiveBorderType(e){this._borderInfo.activeBorderType=e}getBorderInfo(){return this._borderInfo}refresh(){this._borderInfo$.next(this._borderInfo)}}function CPe(t,e,n){const r=e?t.getUniverSheetInstance(e):t.getCurrentUniverSheetInstance();if(!r)throw new Error;const i=n?r.getSheetBySheetId(n):r.getActiveSheet();if(!i)throw new Error;return{workbook:r,worksheet:i,unitId:e??r.getUnitId(),subUnitId:n??i.getSheetId()}}function W3(t,e){const{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;for(let a=n;a<=i;a++)for(let s=r;s<=o;s++)e(a,s)}const j_={id:"sheet.command.set-border-basic",type:ue.COMMAND,handler:async(t,e)=>{const{unitId:n,subUnitId:r,value:i}=e,{type:o,color:a,style:s}=i,u=t.get(se),l=t.get(hl);return l.setType(o),l.setColor(a),l.setStyle(s),u.executeCommand(pl.id,{unitId:n,subUnitId:r})}},SPe={id:"sheet.command.set-border-position",type:ue.COMMAND,handler:async(t,e)=>{if(!e.value)return!1;const n=t.get(se);return t.get(hl).setType(e.value),n.executeCommand(pl.id)}},EPe={id:"sheet.command.set-border-style",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(se);return t.get(hl).setStyle(e.value),n.executeCommand(pl.id)}},yPe={id:"sheet.command.set-border-color",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(se);return t.get(hl).setColor(e.value),n.executeCommand(pl.id)}},pl={id:"sheet.command.set-border",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(dt),a=t.get(hl),{worksheet:s,unitId:u,subUnitId:l}=CPe(i,e==null?void 0:e.unitId,e==null?void 0:e.subUnitId),c=o.getSelectionRanges(),d=s.getConfig().mergeData;if(!(c!=null&&c.length))return!1;const{style:m,color:f,type:h,activeBorderType:p}=a.getBorderInfo();if(!p)return!1;const v=h===ai.TOP||h===ai.ALL||h===ai.OUTSIDE,g=h===ai.LEFT||h===ai.ALL||h===ai.OUTSIDE,b=h===ai.BOTTOM||h===ai.ALL||h===ai.OUTSIDE,C=h===ai.RIGHT||h===ai.ALL||h===ai.OUTSIDE,S=h===ai.VERTICAL||h===ai.ALL||h===ai.INSIDE,E=h===ai.HORIZONTAL||h===ai.ALL||h===ai.INSIDE,y=h.indexOf("tlbr")>-1,D=h.indexOf("tlbc")>-1,R=h.indexOf("tlmr")>-1,I=h.indexOf("bltr")>-1,T=h.indexOf("mltr")>-1,P=h.indexOf("bctr")>-1,N=c[0],B={startRow:N.startRow-1,startColumn:N.startColumn,endRow:N.startRow-1,endColumn:N.endColumn},W={startRow:N.startRow,startColumn:N.startColumn-1,endRow:N.endRow,endColumn:N.startColumn-1},G={startRow:N.endRow+1,startColumn:N.startColumn,endRow:N.endRow+1,endColumn:N.endColumn},Q={startRow:N.startRow,startColumn:N.endColumn+1,endRow:N.endRow,endColumn:N.endColumn+1},te={startRow:N.startRow,startColumn:N.startColumn,endRow:N.startRow,endColumn:N.endColumn},X={startRow:N.startRow,startColumn:N.startColumn,endRow:N.endRow,endColumn:N.startColumn},x={startRow:N.endRow,startColumn:N.startColumn,endRow:N.endRow,endColumn:N.endColumn},O={startRow:N.startRow,startColumn:N.endColumn,endRow:N.endRow,endColumn:N.endColumn},M=new Ye,V={s:m,cl:{rgb:f}},q=(oe,he)=>{let fe=null;return d.forEach(ve=>{ht.intersects(ve,{startColumn:he,endColumn:he,startRow:oe,endRow:oe})&&(fe=ve)}),fe};function ie(oe,he,fe){oe.startRow<0||oe.startColumn<0||W3(oe,(ve,Ue)=>{var ke,Te;const Re=q(ve,Ue);let rt=he;if(Re){if(fe){const _t=Ie.deepClone((ke=M.getValue(Re.startRow,Re.startColumn))==null?void 0:ke.s);rt=_t!=null&&_t.bd?Object.assign(_t.bd,he):he}M.setValue(Re.startRow,Re.startColumn,{s:{bd:rt}})}else{if(fe){const _t=Ie.deepClone((Te=M.getValue(ve,Ue))==null?void 0:Te.s);rt=_t!=null&&_t.bd?Object.assign(_t.bd,he):he}M.setValue(ve,Ue,{s:{bd:rt}})}})}v&&ie(te,{t:Ie.deepClone(V)},!0),b&&ie(x,{b:Ie.deepClone(V)},!0),g&&ie(X,{l:Ie.deepClone(V)},!0),C&&ie(O,{r:Ie.deepClone(V)},!0),y&&ie(N,{tl_br:Ie.deepClone(V)},!0),D&&ie(N,{tl_bc:Ie.deepClone(V)},!0),R&&ie(N,{tl_mr:Ie.deepClone(V)},!0),I&&ie(N,{bl_tr:Ie.deepClone(V)},!0),T&&ie(N,{ml_tr:Ie.deepClone(V)},!0),P&&ie(N,{bc_tr:Ie.deepClone(V)},!0),S&&W3(N,(oe,he)=>{var fe,ve,Ue,ke;const Te=q(oe,he);if(Te){if(Te.endColumn!==N.endColumn){const Re=(fe=M.getValue(Te.startRow,Te.startColumn))==null?void 0:fe.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{r:Ie.deepClone(V)}):{r:Ie.deepClone(V)}}})}if(Te.startColumn!==N.startColumn){const Re=(ve=M.getValue(Te.startRow,Te.startColumn))==null?void 0:ve.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{l:Ie.deepClone(V)}):{l:Ie.deepClone(V)}}})}}else{if(he!==N.endColumn){const Re=(Ue=M.getValue(oe,he))==null?void 0:Ue.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{r:Ie.deepClone(V)}):{r:Ie.deepClone(V)}}})}if(he!==N.startColumn){const Re=(ke=M.getValue(oe,he))==null?void 0:ke.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{l:Ie.deepClone(V)}):{l:Ie.deepClone(V)}}})}}}),E&&W3(N,(oe,he)=>{var fe,ve,Ue,ke;const Te=q(oe,he);if(Te){if(Te.endRow!==N.endRow){const Re=(fe=M.getValue(Te.startRow,Te.startColumn))==null?void 0:fe.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{b:Ie.deepClone(V)}):{b:Ie.deepClone(V)}}})}if(Te.startRow!==N.startRow){const Re=(ve=M.getValue(Te.startRow,Te.startColumn))==null?void 0:ve.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{t:Ie.deepClone(V)}):{t:Ie.deepClone(V)}}})}}else{if(oe!==N.endRow){const Re=(Ue=M.getValue(oe,he))==null?void 0:Ue.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{b:Ie.deepClone(V)}):{b:Ie.deepClone(V)}}})}if(oe!==N.startRow){const Re=(ke=M.getValue(oe,he))==null?void 0:ke.s;M.setValue(oe,he,{s:{bd:Re!=null&&Re.bd?Object.assign(Re.bd,{t:Ie.deepClone(V)}):{t:Ie.deepClone(V)}}})}}}),!v&&!b&&!g&&!C&&!S&&!E&&!y&&!D&&!R&&!I&&!T&&!P&&(ie(B,{b:null}),ie(te,{t:null},!0),ie(G,{t:null}),ie(x,{b:null},!0),ie(W,{r:null}),ie(X,{l:null},!0),ie(Q,{l:null}),ie(O,{r:null},!0),ie(N,{tl_br:null},!0),ie(N,{tl_bc:null},!0),ie(N,{tl_mr:null},!0),ie(N,{bl_tr:null},!0),ie(N,{ml_tr:null},!0),ie(N,{bc_tr:null},!0),W3(N,(oe,he)=>{var fe,ve,Ue,ke,Te,Re,rt,_t;const mt=q(oe,he);if(mt){if(mt.endColumn!==N.endColumn){const nt=(fe=M.getValue(mt.startRow,mt.startColumn))==null?void 0:fe.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{r:null}):{r:null}}})}if(mt.startColumn!==N.startColumn){const nt=(ve=M.getValue(mt.startRow,mt.startColumn))==null?void 0:ve.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{l:null}):{l:null}}})}if(mt.endRow!==N.endRow){const nt=(Ue=M.getValue(mt.startRow,mt.startColumn))==null?void 0:Ue.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{b:null}):{b:null}}})}if(mt.startRow!==N.startRow){const nt=(ke=M.getValue(mt.startRow,mt.startColumn))==null?void 0:ke.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{t:null}):{t:null}}})}}else{if(he!==N.endColumn){const nt=(Te=M.getValue(oe,he))==null?void 0:Te.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{r:null}):{r:null}}})}if(he!==N.startColumn){const nt=(Re=M.getValue(oe,he))==null?void 0:Re.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{l:null}):{l:null}}})}if(oe!==N.endRow){const nt=(rt=M.getValue(oe,he))==null?void 0:rt.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{b:null}):{b:null}}})}if(oe!==N.startRow){const nt=(_t=M.getValue(oe,he))==null?void 0:_t.s;M.setValue(oe,he,{s:{bd:nt!=null&&nt.bd?Object.assign(nt.bd,{t:null}):{t:null}}})}}}));const ce={unitId:u,subUnitId:l,cellValue:M.getData()},pe=ci(t,ce);return n.syncExecuteCommand(Vt.id,ce)?(r.pushUndoRedo({unitID:u,undoMutations:[{id:Vt.id,params:pe}],redoMutations:[{id:Vt.id,params:ce}]}),!0):!1}},DPe=(t,e)=>{if(t.get(ae).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},gl={id:"sheet.mutation.set-col-hidden",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getSheetBySheetId(e.subUnitId).getColumnManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let a=o.startColumn;a<o.endColumn+1;a++){const s=r.getColumnOrCreate(a);s!=null&&(s.hd=we.TRUE)}}return!0}},RPe=(t,e)=>{if(t.get(ae).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},vl={id:"sheet.mutation.set-col-visible",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getSheetBySheetId(e.subUnitId).getColumnManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let a=o.startColumn;a<o.endColumn+1;a++){const s=r.getColumnOrCreate(a);s!=null&&(s.hd=we.FALSE)}}return!0}},ZE={type:ue.COMMAND,id:"sheet.command.set-col-visible-on-cols",handler:async(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(ae).getUniverSheetInstance(n).getSheetBySheetId(r),a={unitId:n,subUnitId:r,ranges:i},s=RPe(t,a),u={unitId:n,subUnitId:r,pluginName:Nn,selections:i.map(d=>({range:d,primary:yo(d,o),style:null}))},l={unitId:n,subUnitId:r,pluginName:Nn,selections:BU(i).map(d=>({range:d,primary:yo(d,o),style:null}))},c=t.get(se);return lr([{id:vl.id,params:a},{id:_n.id,params:u}],c).result&&t.get(en).pushUndoRedo({unitID:n,undoMutations:[{id:gl.id,params:s},{id:_n.id,params:l}],redoMutations:[{id:vl.id,params:a},{id:_n.id,params:u}]}),!0}},kU={type:ue.COMMAND,id:"sheet.command.set-selected-cols-visible",handler:async t=>{var e;const n=(e=t.get(dt).getSelections())==null?void 0:e.map(u=>u.range).filter(u=>u.rangeType===ct.COLUMN);if(!(n!=null&&n.length))return!1;const r=t.get(ae).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),a=i.getSheetId(),s=n.map(u=>i.getHiddenCols(u.startColumn,u.endColumn)).flat();return t.get(se).executeCommand(ZE.id,{unitId:o,subUnitId:a,ranges:s})}},QE={type:ue.COMMAND,id:"sheet.command.set-col-hidden",handler:async t=>{var e;const n=(e=t.get(dt).getSelections())==null?void 0:e.map(d=>d.range).filter(d=>d.rangeType===ct.COLUMN);if(!(n!=null&&n.length))return!1;const r=t.get(ae).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),a=i.getSheetId(),s={unitId:o,subUnitId:a,ranges:n},u={unitId:o,subUnitId:a,pluginName:Nn,selections:BU(n).map(d=>({range:d,primary:yo(d,i),style:null}))},l={unitId:o,subUnitId:a,pluginName:Nn,selections:n.map(d=>({range:d,primary:yo(d,i),style:null}))},c=t.get(se);if(lr([{id:gl.id,params:s},{id:_n.id,params:u}],c).result){const d=t.get(en),m=DPe(t,s);return d.pushUndoRedo({unitID:o,undoMutations:[{id:vl.id,params:m},{id:_n.id,params:l}],redoMutations:[{id:gl.id,params:s},{id:_n.id,params:u}]}),!0}return!1}};function BU(t){return IPe(t).map(e=>{const n=e.startColumn===0?e.endColumn+1:e.startColumn-1;return{...e,startColumn:n,endColumn:n}})}function IPe(t){const e=[];let n;return t.sort((r,i)=>r.startColumn-i.startColumn).forEach(r=>{if(!n){n=r;return}n.endColumn===r.startColumn-1?n.endColumn=r.endColumn:(e.push(n),n=r)}),e.push(n),e}const Of=(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("worksheet is null error!");const i=r.getConfig().freeze;return{unitId:e.unitId,subUnitId:e.subUnitId,...i}},io={id:"sheet.mutation.set-frozen",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(!r)return!1;const i=r.getConfig(),{startRow:o,startColumn:a,ySplit:s,xSplit:u}=e;return i.freeze={startRow:o,startColumn:a,ySplit:s,xSplit:u},!0}},UU={type:ue.COMMAND,id:"sheet.command.set-frozen",handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=i.getCurrentUniverSheetInstance().getUnitId(),a=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),s=i.getUniverSheetInstance(o);if(!s)return!1;const u=s.getSheetBySheetId(a);if(!u)return!1;const{startColumn:l,startRow:c,xSplit:d,ySplit:m}=e;if(c>=u.getRowCount()||l>=u.getColumnCount()||d>=u.getColumnCount()||m>=u.getRowCount())return!1;const f={unitId:o,subUnitId:a,...e},h=Of(t,f);return n.syncExecuteCommand(io.id,f)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:io.id,params:h}],redoMutations:[{id:io.id,params:f}]}),!0):!1}},APe={type:ue.COMMAND,id:"sheet.command.set-frozen-cancel",handler:async t=>{const e=t.get(se),n=t.get(en),r=t.get(ae),i=r.getCurrentUniverSheetInstance().getUnitId(),o=r.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),a=r.getUniverSheetInstance(i);if(!a||!a.getSheetBySheetId(o))return!1;const s={unitId:i,subUnitId:o,startRow:-1,startColumn:-1,ySplit:0,xSplit:0},u=Of(t,s);return e.syncExecuteCommand(io.id,s)?(n.pushUndoRedo({unitID:i,undoMutations:[{id:io.id,params:u}],redoMutations:[{id:io.id,params:s}]}),!0):!1}},TPe=(t,e)=>{if(t.get(ae).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},bl={id:"sheet.mutation.set-row-visible",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId).getRowManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let a=o.startRow;a<o.endRow+1;a++){const s=r.getRowOrCreate(a);s!=null&&(s.hd=0)}}return!0}},wPe=(t,e)=>{if(t.get(ae).getUniverSheetInstance(e.unitId)==null)throw new Error("universheet is null error!");return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges}},_l={id:"sheet.mutation.set-row-hidden",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId).getRowManager();for(let i=0;i<e.ranges.length;i++){const o=e.ranges[i];for(let a=o.startRow;a<o.endRow+1;a++){const s=r.getRowOrCreate(a);s!=null&&(s.hd=1)}}return!0}},JE={type:ue.COMMAND,id:"sheet.command.set-specific-rows-visible",handler:async(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(se),a=t.get(en),s=t.get(ae).getUniverSheetInstance(n).getSheetBySheetId(r),u={unitId:n,subUnitId:r,ranges:i},l=TPe(t,u),c={unitId:n,subUnitId:r,pluginName:Nn,selections:i.map(m=>({range:m,primary:yo(m,s),style:null}))},d={unitId:n,subUnitId:r,pluginName:Nn,selections:HU(i).map(m=>({range:m,primary:yo(m,s),style:null}))};return lr([{id:bl.id,params:u},{id:_n.id,params:c}],o).result&&a.pushUndoRedo({unitID:n,undoMutations:[{id:_l.id,params:l},{id:_n.id,params:d}],redoMutations:[{id:bl.id,params:u},{id:_n.id,params:c}]}),!0}},VU={type:ue.COMMAND,id:"sheet.command.set-selected-rows-visible",handler:async t=>{var e;const n=t.get(dt),r=t.get(ae),i=(e=n.getSelections())==null?void 0:e.map(c=>c.range).filter(c=>c.rangeType===ct.ROW);if(!(i!=null&&i.length))return!1;const o=r.getCurrentUniverSheetInstance();if(!o)return!1;const a=o.getActiveSheet();if(!a)return!1;const s=o.getUnitId(),u=a.getSheetId(),l=i.map(c=>a.getHiddenRows(c.startRow,c.endRow)).flat();return t.get(se).executeCommand(JE.id,{unitId:s,subUnitId:u,ranges:l})}},ey={type:ue.COMMAND,id:"sheet.command.set-rows-hidden",handler:async t=>{var e;const n=t.get(dt),r=t.get(se),i=t.get(en),o=t.get(ae),a=(e=n.getSelections())==null?void 0:e.map(p=>p.range).filter(p=>p.rangeType===ct.ROW);if(!(a!=null&&a.length))return!1;const s=o.getCurrentUniverSheetInstance().getUnitId(),u=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),l=o.getUniverSheetInstance(s);if(!l)return!1;const c=l.getSheetBySheetId(u);if(!c)return!1;const d={unitId:s,subUnitId:u,ranges:a},m={unitId:s,subUnitId:u,pluginName:Nn,selections:HU(a).map(p=>({range:p,primary:yo(p,c),style:null}))},f={unitId:s,subUnitId:u,pluginName:Nn,selections:a.map(p=>({range:p,primary:yo(p,c),style:null}))},h=wPe(t,d);return lr([{id:_l.id,params:d},{id:_n.id,params:m}],r).result&&i.pushUndoRedo({unitID:s,undoMutations:[{id:bl.id,params:h},{id:_n.id,params:f}],redoMutations:[{id:_l.id,params:d},{id:_n.id,params:m}]}),!0}};function HU(t){return LPe(t).map(e=>{const n=e.startRow===0?e.endRow+1:e.startRow-1;return{...e,startRow:n,endRow:n}})}function LPe(t){const e=[];let n;return t.sort((r,i)=>r.startRow-i.startRow).forEach(r=>{if(!n){n=r;return}r.startRow===n.endRow+1?n.endRow=r.endRow:(e.push(n),n=r)}),e.push(n),e}const ii={type:ue.COMMAND,id:"sheet.command.set-style",handler:async(t,e)=>{const n=t.get(ae),{unitId:r=n.getCurrentUniverSheetInstance().getUnitId(),subUnitId:i=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),range:o,style:a}=e,s=t.get(se),u=t.get(en),l=t.get(dt),c=o?[o]:l.getSelectionRanges();if(!(c!=null&&c.length))return!1;const d=n.getUniverSheetInstance(r);if((d==null?void 0:d.getSheetBySheetId(i))==null)return!1;const m=new Ye;if(Ie.isArray(a.value))for(let C=0;C<c.length;C++){const{startRow:S,endRow:E,startColumn:y,endColumn:D}=c[C];for(let R=0;R<=E-S;R++)for(let I=0;I<=D-y;I++)m.setValue(R+S,I+y,{s:{[a.type]:a.value[R][I]}})}else for(let C=0;C<c.length;C++){const{startRow:S,endRow:E,startColumn:y,endColumn:D}=c[C],R={s:{[a.type]:a.value}};for(let I=S;I<=E;I++)for(let T=y;T<=D;T++)m.setValue(I,T,R)}const f={subUnitId:i,unitId:r,cellValue:m.getMatrix()},h=ci(t,f),p=s.syncExecuteCommand(Vt.id,f),{undos:v,redos:g}=t.get(In).onCommandExecute({id:ii.id,params:e}),b=lr([...g],s);return p&&b.result?(u.pushUndoRedo({unitID:r,undoMutations:[{id:Vt.id,params:h},...v],redoMutations:[{id:Vt.id,params:f},...g]}),!0):!1}},jU={type:ue.COMMAND,id:"sheet.command.set-bold",handler:async t=>{const e=t.get(dt).getLast();if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet(),{actualRow:r,actualColumn:i}=e.primary,o={style:{type:"bl",value:n.getRange(r,i).getFontWeight()===E0.BOLD?we.FALSE:we.TRUE}};return t.get(se).executeCommand(ii.id,o)}},zU={type:ue.COMMAND,id:"sheet.command.set-italic",handler:async t=>{const e=t.get(dt).getLast();if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet();let r=!0;if(e.primary){const{startRow:o,startColumn:a}=e.primary;r=n.getRange(o,a).getFontStyle()===S0.ITALIC}const i={style:{type:"it",value:r?we.FALSE:we.TRUE}};return t.get(se).executeCommand(ii.id,i)}},WU={type:ue.COMMAND,id:"sheet.command.set-underline",handler:async t=>{const e=t.get(dt).getLast();if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet();let r=!0;e.primary&&(r=!!n.getRange(e.primary.startRow,e.primary.startColumn).getUnderline().s);const i={style:{type:"ul",value:{s:r?we.FALSE:we.TRUE}}};return t.get(se).executeCommand(ii.id,i)}},YU={type:ue.COMMAND,id:"sheet.command.set-stroke",handler:async t=>{const e=t.get(dt).getLast();if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet();let r=!0;e.primary&&(r=!!n.getRange(e.primary.actualRow,e.primary.actualColumn).getStrikeThrough().s);const i={style:{type:"st",value:{s:r?we.FALSE:we.TRUE}}};return t.get(se).executeCommand(ii.id,i)}};ue.COMMAND;const XU={type:ue.COMMAND,id:"sheet.command.set-font-family",handler:async(t,e)=>{if(!e)return!1;const n=t.get(se),r={style:{type:"ff",value:e.value}};return n.executeCommand(ii.id,r)}},qU={type:ue.COMMAND,id:"sheet.command.set-font-size",handler:async(t,e)=>{if(!e)return!1;const n=t.get(se),r={style:{type:"fs",value:e.value}};return n.executeCommand(ii.id,r)}},GU={type:ue.COMMAND,id:"sheet.command.set-text-color",handler:async(t,e)=>{if(!e||!e.value)return!1;const n=t.get(se),r={style:{type:"cl",value:{rgb:e.value}}};return n.executeCommand(ii.id,r)}},KU={type:ue.COMMAND,id:"sheet.command.reset-text-color",handler:async t=>{const e=t.get(se),n={style:{type:"cl",value:{rgb:null}}};return e.executeCommand(ii.id,n)}},B9={type:ue.COMMAND,id:"sheet.command.set-background-color",handler:async(t,e)=>{if(!e||!e.value)return!1;const n=t.get(se),r={style:{type:"bg",value:{rgb:e.value}}};return n.executeCommand(ii.id,r)}},ZU={type:ue.COMMAND,id:"sheet.command.reset-background-color",handler:async t=>{const e=t.get(se),n={style:{type:"bg",value:{rgb:null}}};return e.executeCommand(ii.id,n)}},z_={type:ue.COMMAND,id:"sheet.command.set-vertical-text-align",handler:async(t,e)=>{if(!e)return!1;const n=t.get(se),r={style:{type:"vt",value:e.value}};return n.executeCommand(ii.id,r)}},W_={type:ue.COMMAND,id:"sheet.command.set-horizontal-text-align",handler:async(t,e)=>{if(!e)return!1;const n=t.get(se),r={style:{type:"ht",value:e.value}};return n.executeCommand(ii.id,r)}},Y_={type:ue.COMMAND,id:"sheet.command.set-text-wrap",handler:async(t,e)=>{if(!e)return!1;const n=t.get(se),r={style:{type:"tb",value:e.value}};return n.executeCommand(ii.id,r)}},X_={type:ue.COMMAND,id:"sheet.command.set-text-rotation",handler:async(t,e)=>{if(!e)return!1;const n=typeof e.value=="number"?{a:e.value}:{a:0,v:we.TRUE},r=t.get(se),i={style:{type:"tr",value:n}};return r.executeCommand(ii.id,i)}},OPe=(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId).getSheetBySheetId(e.subUnitId).getConfig().tabColor;return{...Ie.deepClone(e),color:n}},K6={id:"sheet.mutation.set-tab-color",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getSheetBySheetId(e.subUnitId);return r?(r.getConfig().tabColor=e.color,!0):!1}},QU={type:ue.COMMAND,id:"sheet.command.set-tab-color",handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=i.getCurrentUniverSheetInstance().getUnitId(),a=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),s=i.getUniverSheetInstance(o);if(!s||!s.getSheetBySheetId(a))return!1;const u={color:e.value,unitId:o,subUnitId:a},l=OPe(t,u);return n.syncExecuteCommand(K6.id,u)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:K6.id,params:l}],redoMutations:[{id:K6.id,params:u}]}),!0):!1}},Us={id:"sheet.operation.set-worksheet-active",type:ue.OPERATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getWorksheets();for(const[,i]of r)if(i.getSheetId()===e.subUnitId)return n.setActiveSheet(i),!0;return!1}},pd={type:ue.COMMAND,id:"sheet.command.set-worksheet-activate",handler:(t,e)=>{var n,r;const i=t.get(se),o=t.get(ae);let a=o.getCurrentUniverSheetInstance().getUnitId(),s=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(a=(n=e.unitId)!=null?n:a,s=(r=e.subUnitId)!=null?r:s);const u={unitId:a,subUnitId:s};return i.syncExecuteCommand(Us.id,u)}},JU=(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)throw new Error("universheet is null error!");const r=n.getSheetBySheetId(e.subUnitId);if(r==null)throw new Error("universheet is null error!");const i={},o=r.getColumnManager(),a=e.ranges;for(let s=0;s<a.length;s++){const u=a[s];for(let l=u.startColumn;l<u.endColumn+1;l++){const c=o.getColumnOrCreate(l);i[l]=c.w}}return{unitId:e.unitId,subUnitId:e.subUnitId,ranges:e.ranges,colWidth:i}},Wa={id:"sheet.mutation.set-worksheet-col-width",type:ue.MUTATION,handler:(t,e)=>{var n;const r=t.get(ae).getUniverSheetInstance(e.unitId);if(r==null)throw new Error("universheet is null error!");const i=r.getSheetBySheetId(e.subUnitId);if(!i)return!1;const o=i.getConfig().defaultColumnWidth,a=i.getColumnManager(),s=e.ranges;for(let u=0;u<s.length;u++){const l=s[u];for(let c=l.startColumn;c<l.endColumn+1;c++){const d=a.getColumnOrCreate(c);typeof e.colWidth=="number"?d.w=e.colWidth:d.w=(n=e.colWidth[c-l.startColumn])!=null?n:o}}return!0}},ty={type:ue.COMMAND,id:"sheet.command.delta-column-width",handler:async(t,e)=>{const n=t.get(dt).getSelections();if(!(n!=null&&n.length))return!1;const r=t.get(se),i=t.get(en),o=t.get(ae).getCurrentUniverSheetInstance(),a=o.getActiveSheet(),s=o.getUnitId(),u=a.getSheetId(),{anchorCol:l,deltaX:c}=e,d=a.getColumnWidth(l)+c,m=n.length===1&&n[0].range.rangeType===ct.ALL,f=n.filter(E=>E.range.rangeType===ct.COLUMN),h=m?ct.ALL:f.some(({range:E})=>{const{startColumn:y,endColumn:D}=E;return y<=l&&l<=D})?ct.COLUMN:ct.NORMAL;let p;if(h===ct.ALL){const E=a.getRowCount(),y=new Array(a.getColumnCount()).fill(void 0).map((D,R)=>({startRow:0,endRow:E-1,startColumn:R,endColumn:R}));p={subUnitId:u,unitId:s,colWidth:d,ranges:y}}else h===ct.COLUMN?p={subUnitId:u,unitId:s,ranges:f.map(E=>ht.clone(E.range)),colWidth:d}:p={subUnitId:u,unitId:s,colWidth:d,ranges:[{startRow:0,endRow:a.getMaxRows()-1,startColumn:l,endColumn:l}]};const v=JU(t,p),g=r.syncExecuteCommand(Wa.id,p),{undos:b,redos:C}=t.get(In).onCommandExecute({id:ty.id,params:p}),S=lr([...C],r);return g&&S.result&&i.pushUndoRedo({unitID:s,undoMutations:[{id:Wa.id,params:v},...b],redoMutations:[{id:Wa.id,params:p},...C]}),!0}},ny={type:ue.COMMAND,id:"sheet.command.set-worksheet-col-width",handler:async(t,e)=>{const n=t.get(dt),r=t.get(se),i=t.get(en),o=t.get(ae),a=n.getSelectionRanges();if(!(a!=null&&a.length))return!1;const s=o.getCurrentUniverSheetInstance().getUnitId(),u={subUnitId:o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),unitId:s,ranges:a,colWidth:e.value},l=JU(t,u),c=r.syncExecuteCommand(Wa.id,u),{undos:d,redos:m}=t.get(In).onCommandExecute({id:ny.id,params:u}),f=lr([...m],r);return c&&f.result?(i.pushUndoRedo({unitID:s,undoMutations:[{id:Wa.id,params:l},...d],redoMutations:[{id:Wa.id,params:u},...m]}),!0):!1}},eV=(t,e)=>{const n=t.get(ae).getCurrentUniverSheetInstance().getSheetBySheetId(e.subUnitId);if(n==null)throw new Error("worksheet is null error!");return{hidden:n.isSheetHidden(),unitId:e.unitId,subUnitId:n.getSheetId()}},Wo={id:"sheet.mutation.set-worksheet-hidden",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)return!1;const r=n.getSheetBySheetId(e.subUnitId);return r?(r.getConfig().hidden=e.hidden,!0):!1}},tV={type:ue.COMMAND,id:"sheet.command.set-worksheet-hidden",handler:async(t,e)=>{var n;const r=t.get(se),i=t.get(en),o=t.get(ae),a=t.get(Z0),s=o.getCurrentUniverSheetInstance().getUnitId();let u=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(u=(n=e.subUnitId)!=null?n:u);const l=o.getUniverSheetInstance(s);if(!l)return!1;const c=l.getSheetBySheetId(u);if(!c||c.getConfig().hidden===we.TRUE)return!1;const d={unitId:s,subUnitId:u,hidden:we.TRUE},m=eV(t,d);return l.getSheets().filter(f=>f.getConfig().hidden===we.FALSE).length===1?(a.emit("No visible sheet after you hide this."),!1):r.syncExecuteCommand(Wo.id,d)?(i.pushUndoRedo({unitID:s,undoMutations:[{id:Wo.id,params:m}],redoMutations:[{id:Wo.id,params:d}]}),!0):!1}},PPe=(t,e)=>{const n=t.get(ae).getCurrentUniverSheetInstance().getSheetBySheetId(e.subUnitId);if(n==null)throw new Error("worksheet is null error!");return{unitId:e.unitId,name:n.getName(),subUnitId:n.getSheetId()}},Bm={id:"sheet.mutation.set-worksheet-name",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(n==null)return!1;const r=n.getSheetBySheetId(e.subUnitId);return r?(r.getConfig().name=e.name,!0):!1}},F8={type:ue.COMMAND,id:"sheet.command.set-worksheet-name",handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(In),a=e.unitId||i.getCurrentUniverSheetInstance().getUnitId(),s={subUnitId:e.subUnitId||i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),name:e.name,unitId:a},u=PPe(t,s),l=o.onCommandExecute({id:F8.id,params:e}),c=[{id:Bm.id,params:s},...l.redos],d=[...l.undos,{id:Bm.id,params:u}];return await lr(c,n).result?(r.pushUndoRedo({unitID:a,undoMutations:d,redoMutations:c}),!0):!1}},MPe=(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId).getConfig().sheetOrder.findIndex(r=>r===e.subUnitId);return{...Ie.deepClone(e),order:n}},v0={id:"sheet.mutation.set-worksheet-order",type:ue.MUTATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId);if(!n)return!1;const r=n.getConfig(),i=r.sheetOrder.filter(o=>o!==e.subUnitId);return i.splice(e.order,0,e.subUnitId),r.sheetOrder=i,!0}},nV={type:ue.COMMAND,id:"sheet.command.set-worksheet-order",handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=e.unitId||i.getCurrentUniverSheetInstance().getUnitId(),a=e.subUnitId||i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),s=i.getUniverSheetInstance(o);if(!s||!s.getSheetBySheetId(a))return!1;const u={order:e.order,unitId:o,subUnitId:a},l=MPe(t,u);return n.syncExecuteCommand(v0.id,u)?(r.pushUndoRedo({unitID:o,undoMutations:[{id:v0.id,params:l}],redoMutations:[{id:v0.id,params:u}]}),!0):!1}},NPe=2e3,rV=(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(ae).getUniverSheetInstance(n),a=o==null?void 0:o.getSheetBySheetId(r);if(a==null)throw new Error("worksheet is null error!");const s={},u=a.getRowManager();for(const{startRow:l,endRow:c}of i)for(let d=l;d<c+1;d++){const m=u.getRowOrCreate(d);s[d]=m.h}return{unitId:n,subUnitId:r,ranges:i,rowHeight:s}},ry=(t,e)=>{const{unitId:n,subUnitId:r,ranges:i}=e,o=t.get(ae).getUniverSheetInstance(n).getSheetBySheetId(r),a={},s=o.getRowManager();for(const{startRow:u,endRow:l}of i)for(let c=u;c<=l;c++){const d=s.getRowOrCreate(c);a[c]=d.ia}return{unitId:n,subUnitId:r,ranges:i,autoHeightInfo:a}},xPe=(t,e)=>{const{unitId:n,subUnitId:r,rowsAutoHeightInfo:i}=e,o=t.get(ae).getUniverSheetInstance(n),a=o==null?void 0:o.getSheetBySheetId(r),s=[],u=a.getRowManager();for(const l of i){const{row:c}=l,{ah:d}=u.getRowOrCreate(c);s.push({row:c,autoHeight:d})}return{unitId:n,subUnitId:r,rowsAutoHeightInfo:s}},m1={id:"sheet.mutation.set-worksheet-row-height",type:ue.MUTATION,handler:(t,e)=>{var n;const{unitId:r,subUnitId:i,ranges:o,rowHeight:a}=e,s=t.get(ae).getUniverSheetInstance(r),u=s==null?void 0:s.getSheetBySheetId(i);if(!u)return!1;const l=u.getConfig().defaultRowHeight,c=u.getRowManager();for(const{startRow:d,endRow:m}of o)for(let f=d;f<=m;f++){const h=c.getRowOrCreate(f);typeof a=="number"?h.h=a:h.h=(n=a[f])!=null?n:l,h.h=Math.min(NPe,h.h)}return!0}},Is={id:"sheet.mutation.set-worksheet-row-is-auto-height",type:ue.MUTATION,handler:(t,e)=>{var n;const{unitId:r,subUnitId:i,ranges:o,autoHeightInfo:a}=e,s=t.get(ae).getUniverSheetInstance(r),u=s==null?void 0:s.getSheetBySheetId(i);if(!u)return!1;const l=void 0,c=u.getRowManager();for(const{startRow:d,endRow:m}of o)for(let f=d;f<=m;f++){const h=c.getRowOrCreate(f);typeof a=="number"?h.ia=a:h.ia=(n=a[f-d])!=null?n:l}return!0}},Um={id:"sheet.mutation.set-worksheet-row-auto-height",type:ue.MUTATION,handler:(t,e)=>{const{unitId:n,subUnitId:r,rowsAutoHeightInfo:i}=e,o=t.get(ae).getUniverSheetInstance(n),a=o==null?void 0:o.getSheetBySheetId(r);if(!a||!o)return!1;const s=a.getRowManager();for(const{row:u,autoHeight:l}of i){const c=s.getRowOrCreate(u);c.ah=l}return!0}},iV={type:ue.COMMAND,id:"sheet.command.delta-row-height",handler:async(t,e)=>{const n=t.get(dt).getSelections();if(!(n!=null&&n.length))return!1;const r=t.get(ae).getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=r.getUnitId(),a=i.getSheetId(),{anchorRow:s,deltaY:u}=e,l=i.getRowHeight(s)+u,c=n.length===1&&n[0].range.rangeType===ct.ALL,d=n.filter(C=>C.range.rangeType===ct.ROW),m=c?ct.ALL:d.some(({range:C})=>{const{startRow:S,endRow:E}=C;return S<=s&&s<=E})?ct.ROW:ct.NORMAL;let f;if(m===ct.ALL){const C=i.getRowCount(),S=new Array(i.getColumnCount()).fill(void 0).map((E,y)=>({startRow:y,endRow:y,startColumn:0,endColumn:C-1}));f={subUnitId:a,unitId:o,rowHeight:l,ranges:S}}else m===ct.ROW?f={subUnitId:a,unitId:o,ranges:d.map(C=>ht.clone(C.range)),rowHeight:l}:f={subUnitId:a,unitId:o,rowHeight:l,ranges:[{startRow:s,endRow:s,startColumn:0,endColumn:i.getMaxColumns()-1}]};const h=rV(t,f),p={unitId:o,subUnitId:a,ranges:f.ranges,autoHeightInfo:we.FALSE},v=ry(t,p),g=t.get(se),b=t.get(en);return lr([{id:m1.id,params:f},{id:Is.id,params:p}],g).result?(b.pushUndoRedo({unitID:o,undoMutations:[{id:m1.id,params:h},{id:Is.id,params:v}],redoMutations:[{id:m1.id,params:f},{id:Is.id,params:p}]}),!0):!1}},oV={type:ue.COMMAND,id:"sheet.command.set-row-height",handler:(t,e)=>{const n=t.get(dt),r=t.get(se),i=t.get(en),o=t.get(ae),a=n.getSelectionRanges();if(!(a!=null&&a.length))return!1;const s=o.getCurrentUniverSheetInstance(),u=s.getUnitId(),l=s.getActiveSheet().getSheetId(),c={subUnitId:l,unitId:u,ranges:a,rowHeight:e.value},d=rV(t,c),m={unitId:u,subUnitId:l,ranges:c.ranges,autoHeightInfo:we.FALSE},f=ry(t,m);return lr([{id:m1.id,params:c},{id:Is.id,params:m}],r).result?(i.pushUndoRedo({unitID:u,undoMutations:[{id:m1.id,params:d},{id:Is.id,params:f}],redoMutations:[{id:m1.id,params:c},{id:Is.id,params:m}]}),!0):!1}},Pf={type:ue.COMMAND,id:"sheet.command.set-row-is-auto-height",handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(dt),o=t.get(ae),a=o.getCurrentUniverSheetInstance().getUnitId(),s=o.getCurrentUniverSheetInstance().getActiveSheet(),u=s.getSheetId(),{anchorRow:l}=e??{},c=l!=null?[{startRow:l,endRow:l,startColumn:0,endColumn:s.getMaxColumns()-1}]:i.getSelectionRanges();if(!(c!=null&&c.length))return!1;const d={unitId:a,subUnitId:u,ranges:c,autoHeightInfo:we.TRUE},m=ry(t,d),f=n.syncExecuteCommand(Is.id,d),{undos:h,redos:p}=t.get(In).onCommandExecute({id:Pf.id,params:d}),v=lr([...p],n);return f&&v.result?(r.pushUndoRedo({unitID:a,undoMutations:[{id:Is.id,params:m},...h],redoMutations:[{id:Is.id,params:d},...p]}),!0):!1}},aV={type:ue.COMMAND,id:"sheet.command.set-worksheet-show",handler:async(t,e)=>{var n;const r=t.get(se),i=t.get(en),o=t.get(ae),a=o.getCurrentUniverSheetInstance().getUnitId();let s=o.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();e&&(s=(n=e.value)!=null?n:s);const u=o.getUniverSheetInstance(a);if(!u)return!1;const l=u.getSheetBySheetId(s);if(!l||l.getConfig().hidden===we.FALSE)return!1;const c={unitId:a,subUnitId:s,hidden:we.FALSE},d=eV(t,c),m=r.syncExecuteCommand(Wo.id,c),f={unitId:a,subUnitId:s},h=r.syncExecuteCommand(Us.id,f);return m&&h?(i.pushUndoRedo({unitID:a,undoMutations:[{id:Wo.id,params:d}],redoMutations:[{id:Wo.id,params:c}]}),!0):!1}},FPe=t=>{const e=new Ye;return t.forEach(n=>{mr.foreach(n,(r,i)=>{e.setValue(r,i,1)})}),e.forValue((n,r)=>{const i=e.getValue(n-1,r);i&&e.setValue(n,r,i+1)}),e},DT=t=>{const e={area:0},n=(r,i)=>e.area<r?(e.area=r,e.range=i,!0):!1;return t.forValue((r,i,o)=>{let a=1,s=o;n(a*s,{startRow:r-s+1,endRow:r,startColumn:i,endColumn:i});const u={startRow:r-s+1,endRow:r,startColumn:0,endColumn:i};for(let l=i-1;l>=0&&t.getValue(r,l);l--){s=Math.min(t.getValue(r,l)||0,s),a++;const c=s*a;u.startColumn=l,u.startRow=r-s+1,n(c,u)}}),e},$Pe=(t,e)=>(mr.foreach(e,(n,r)=>{t.realDeleteValue(n,r);let i=n+1,o=t.getValue(i,r)||0;for(;o>1;)t.setValue(i,r,o-1),i+=1,o=t.getValue(i,r)||0}),t),kPe=t=>{const e=[];let n=DT(t);for(;n.area>0;)n.range&&(e.push(n.range),$Pe(t,n.range)),n=DT(t);return e},g1=t=>{const e=FPe(t);return kPe(e)},BPe=(t,e,n="")=>t.reduce((r,i)=>{const o=i&&i[e];return typeof o!="string"?(console.warn(i,`${e} is not string`),r):(o?(r[o]||(r[o]=[]),r[o].push(i)):r[n].push(i),r)},{}),UPe=(t=0)=>{let e=t;return function(){return e++}},Ti=ln("INumfmtService");o5(ot.Rendered,Ti);const Mf=(t,e)=>{const n=t.get(Ti),{values:r,unitId:i,subUnitId:o}=e,a=[],s=[],u=n.getModel(i,o)||void 0;Object.keys(r).forEach(c=>{r[c].ranges.forEach(d=>{mr.foreach(d,(m,f)=>{const h=n.getValue(i,o,m,f,u);h?a.push({pattern:h.pattern,type:h.type,row:m,col:f}):s.push({startColumn:f,endColumn:f,startRow:m,endRow:m})})})});const l=[];if(a.length){const c=Cl(i,o,a);Object.keys(c.values).forEach(d=>{const m=c.values[d];m.ranges=g1(m.ranges)}),l.push({id:Do.id,params:Cl(i,o,a)})}return s.length&&l.push({id:Co.id,params:{unitId:i,subUnitId:o,ranges:s}}),l},Do={id:"sheet.mutation.set.numfmt",type:ue.MUTATION,handler:(t,e)=>{if(!e)return!1;const{values:n,refMap:r}=e,i=t.get(Ti),o=e.unitId,a=e.subUnitId,s=Object.keys(n).reduce((u,l)=>{const c=r[l],d=n[l].ranges;return c&&u.push({...c,ranges:d}),u},[]);return i.setValues(o,a,s),!0}},Co={id:"sheet.mutation.remove.numfmt",type:ue.MUTATION,handler:(t,e)=>{if(!e)return!1;const{unitId:n,subUnitId:r,ranges:i}=e;return t.get(Ti).deleteValues(n,r,i),!0}},Uc=(t,e)=>{const n=t.get(Ti),{ranges:r,unitId:i,subUnitId:o}=e,a=[],s=n.getModel(i,o)||void 0;if(r.forEach(l=>{mr.foreach(l,(c,d)=>{const m=n.getValue(i,o,c,d,s);m&&a.push({pattern:m.pattern,type:m.type,row:c,col:d})})}),!a.length)return[];const u=Cl(i,o,a);return Object.keys(u.values).forEach(l=>{const c=u.values[l];c.ranges=g1(c.ranges)}),[{id:Do.id,params:u}]},Cl=(t,e,n)=>{const r=BPe(n,"pattern"),i={},o={},a=UPe();return Object.keys(r).forEach(s=>{const u=r[s],l=u[0],c=a();i[c]={pattern:s,type:l.type},u.forEach(d=>{o[c]||(o[c]={ranges:[]}),o[c].ranges.push(VPe(d.row,d.col))})}),{unitId:t,subUnitId:e,refMap:i,values:o}},VPe=(t,e)=>({startRow:t,endRow:t,startColumn:e,endColumn:e}),sV="maxCellsPerSheet",HPe=3e6;var jPe=Object.defineProperty,zPe=Object.getOwnPropertyDescriptor,WPe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zPe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&jPe(e,n,i),i},RT=(t,e)=>(n,r)=>e(n,r,t);let h7=class extends We{constructor(e,n){super(),this._commandService=e,this._configService=n,[Bn,Tf,wf,ll,vU,Fc,$c,ty,iV,OU,LU,e2,Bc,ml,fl,TU,AU,Jc,kc,PU,Eo,hd,V0,Qc,qa,fd,U0,n2,dl,t2,cl,Lf,Qo,$U,Un,ZU,KU,B9,j_,yPe,pl,SPe,EPe,QE,gl,vl,ny,APe,UU,io,W_,Ga,Vt,oV,ey,_l,bl,kU,VU,ZE,JE,ii,QU,K6,GU,X_,Y_,z_,pd,Us,Wa,tV,Wo,F8,Bm,nV,v0,Um,m1,Pf,Is,aV,Do,_n,Co].forEach(r=>this.disposeWithMe(this._commandService.registerCommand(r))),this._configService.setConfig(sV,HPe)}};h7=WPe([yt(ot.Starting,h7),RT(0,se),RT(1,K0)],h7);var YPe=Object.defineProperty,XPe=Object.getOwnPropertyDescriptor,qPe=(t,e,n,r)=>{for(var i=r>1?void 0:r?XPe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&YPe(e,n,i),i},GPe=(t,e)=>(n,r)=>e(n,r,t);let p7=class extends We{constructor(e){super(),this._commandService=e,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id!==w8.id)return;const n=e.params,{unitData:r,unitOtherData:i}=n,o=Object.keys(r),a=[];return o.forEach(s=>{const u=r[s];if(u==null)return!0;Object.keys(u).forEach(l=>{const c=u[l];if(c==null)return!0;const d={subUnitId:l,unitId:s,cellValue:c.getData()};a.push({id:Vt.id,params:d})})}),a.every(s=>this._commandService.executeCommand(s.id,s.params,{onlyLocal:!0}))}))}};p7=qPe([yt(ot.Ready,p7),GPe(0,se)],p7);var KPe=Object.defineProperty,ZPe=Object.getOwnPropertyDescriptor,QPe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ZPe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&KPe(e,n,i),i},Y3=(t,e)=>(n,r)=>e(n,r,t);let g7=class extends We{constructor(e,n,r,i){super(),this._commandService=e,this._featureCalculationManagerService=n,this._currentUniverService=r,this._formulaDataModel=i}_initialize(){const e="test",n="workbook-01",r="sheet-0011",i={[n]:{[r]:new Ye({4:{0:{v:10,t:2}}})}},o={[n]:{[r]:[{startRow:4,startColumn:0,endRow:4,endColumn:0}]}};this._featureCalculationManagerService.register(e,{unitId:n,subUnitId:r,dependencyRanges:[{unitId:n,sheetId:r,range:{startRow:0,endRow:3,startColumn:0,endColumn:3}}],getDirtyData:()=>({runtimeCellData:i,dirtyRanges:o})})}};g7=QPe([yt(ot.Ready,g7),Y3(0,se),Y3(1,M8),Y3(2,ae),Y3(3,K(Ai))],g7);const Wn={MoveRangeCommandId:bU,InsertRowCommandId:IU,InsertColCommandId:wU,RemoveColCommandId:FU,RemoveRowCommandId:xU,DeleteRangeMoveLeftCommandId:SU,DeleteRangeMoveUpCommandId:EU,InsertRangeMoveDownCommandId:pPe,InsertRangeMoveRightCommandId:RU,MoveColsCommandId:NU,MoveRowsCommandId:MU};var Vr=(t=>(t[t.Set=0]="Set",t[t.Delete=1]="Delete",t[t.HorizontalMove=2]="HorizontalMove",t[t.VerticalMove=3]="VerticalMove",t[t.Unknown=4]="Unknown",t))(Vr||{}),JPe=Object.defineProperty,eMe=Object.getOwnPropertyDescriptor,tMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?eMe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&JPe(e,n,i),i},Fg=(t,e)=>(n,r)=>e(n,r,t);const nMe=Q0("MERGE_REDO"),rMe=Q0("MERGE_UNDO");let b0=class extends We{constructor(e,n,r){super(),fr(this,"interceptor",new eO({MERGE_REDO:nMe,MERGE_UNDO:rMe})),fr(this,"_refRangeManagerMap",new Map),fr(this,"_serializer",iMe()),fr(this,"_onRefRangeChange",()=>{this._sheetInterceptorService.interceptCommand({getMutations:i=>{const o=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet(),a=IT(this._univerInstanceService),s=AT(this._univerInstanceService),u=((()=>{switch(i.id){case Wn.MoveColsCommandId:{const d=i.params,m=Math.min(d.fromRange.startColumn,d.toRange.startColumn);return this._checkRange([{...d.fromRange,startColumn:m,endColumn:o.getColumnCount()-1}],a,s)}case Wn.MoveRowsCommandId:{const d=i.params,m=Math.min(d.fromRange.startRow,d.toRange.startRow);return this._checkRange([{...d.fromRange,startRow:m,endRow:o.getRowCount()-1}],a,s)}case Wn.MoveRangeCommandId:{const d=i;return this._checkRange([d.params.fromRange,d.params.toRange],a,s)}case Wn.InsertRowCommandId:{const d={startRow:i.params.range.startRow,endRow:o.getRowCount()-1,startColumn:0,endColumn:o.getColumnCount()-1};return this._checkRange([d],a,s)}case Wn.InsertColCommandId:{const d=i.params.range.startColumn,m={startRow:0,endRow:o.getRowCount()-1,startColumn:d,endColumn:o.getColumnCount()-1};return this._checkRange([m],a,s)}case Wn.RemoveRowCommandId:{const d={startRow:i.params.range.startRow,endRow:o.getRowCount()-1,startColumn:0,endColumn:o.getColumnCount()-1};return this._checkRange([d],a,s)}case Wn.RemoveColCommandId:{const d=i.params.range.startColumn,m={startRow:0,endRow:o.getRowCount()-1,startColumn:d,endColumn:o.getColumnCount()-1};return this._checkRange([m],a,s)}case Wn.DeleteRangeMoveUpCommandId:case Wn.InsertRangeMoveDownCommandId:{const d=i.params.range||TT(this._selectionManagerService)[0],m={startRow:d.startRow,startColumn:d.startColumn,endColumn:d.endColumn,endRow:o.getRowCount()-1};return this._checkRange([m],a,s)}case Wn.DeleteRangeMoveLeftCommandId:case Wn.InsertRangeMoveRightCommandId:{const d=i.params.range||TT(this._selectionManagerService)[0],m={startRow:d.startRow,startColumn:d.startColumn,endColumn:o.getColumnCount()-1,endRow:d.endRow};return this._checkRange([m],a,s)}}})()||[]).reduce((d,m)=>{const f=m(i);return d.push(f),d},[]).reduce((d,m)=>(d.redos.push(...m.redos),d.undos.push(...m.undos),d),{redos:[],undos:[]}),l=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_REDO)(u.redos,null)||[],c=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().MERGE_UNDO)(u.undos,null)||[];return{redos:l,undos:c}}})}),fr(this,"_checkRange",(i,o,a)=>{const s=wT(o,a),u=this._refRangeManagerMap.get(s);if(u){const l=new Set;return[...u.keys()].forEach(c=>{const d=u.get(c),m=this._serializer.deserialize(c);i.some(f=>ht.intersects(f,m))&&d&&d.forEach(f=>{l.add(f)})}),[...l]}return[]}),fr(this,"registerRefRange",(i,o,a,s)=>{const u=a||IT(this._univerInstanceService),l=s||AT(this._univerInstanceService),c=wT(u,l),d=this._serializer.serialize(i);let m=this._refRangeManagerMap.get(c);m||(m=new Map,this._refRangeManagerMap.set(c,m));const f=m.get(d);return f?f.add(o):m.set(d,new Set([o])),je(()=>{const h=m.get(d);h&&(h.delete(o),h.size||(m.delete(d),m.size||this._refRangeManagerMap.delete(c)))})}),this._sheetInterceptorService=e,this._univerInstanceService=n,this._selectionManagerService=r,this._onRefRangeChange(),this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_REDO,{priority:-1,handler:i=>i}),this.interceptor.intercept(this.interceptor.getInterceptPoints().MERGE_UNDO,{priority:-1,handler:i=>i})}};b0=tMe([yt(ot.Steady,b0),Fg(0,K(In)),Fg(1,K(ae)),Fg(2,K(dt))],b0);function IT(t){return t.getCurrentUniverSheetInstance().getUnitId()}function AT(t){return t.getCurrentUniverSheetInstance().getActiveSheet().getSheetId()}function TT(t){return t.getSelectionRanges()||[]}function wT(t,e){return`${t}_${e}`}function iMe(){const t=["startRow","startColumn","endRow","endColumn","rangeType"],e="_";return{deserialize:n=>{const r=t.reduce((i,o,a)=>(i[String(a)]=o,i),{});return n.split(e).reduce((i,o,a)=>{const s=String(a);return o&&r[s]&&(i[r[s]]=o),i},{})},serialize:n=>t.reduce((r,i,o)=>{const a=n[i];return a!==void 0?`${r}${o>0?e:""}${a}`:`${r}`},"")}}const X3=Number.MAX_SAFE_INTEGER,f1=t=>{const e={...t};return e.rangeType===ct.COLUMN&&(e.startRow=0,e.endRow=X3),e.rangeType===ct.ROW&&(e.startColumn=0,e.endColumn=X3),e.rangeType===ct.ALL&&(e.startColumn=0,e.endColumn=X3,e.startRow=0,e.endRow=X3),e},Sl=t=>({startRow:t.startColumn,endRow:t.endColumn,startColumn:t.startRow,endColumn:t.endRow}),uV=(t,e,n)=>{const r={...n},i={...e},o=(p,v)=>{const g=Math.max(p.start,v.start),b=Math.min(p.end,v.end);return b<g?null:{start:g,end:b}},a=p=>p.end-p.start+1,s=(p,v)=>({start:p.start-v.start,end:p.start-v.start+p.end-p.start}),u=(p,v)=>({start:v.start+p.start,end:v.start+p.start+p.end-p.start}),l=e.start>t.start;if(l){const p=Math.min(t.end,e.start)-t.start+1;i.start-=p,i.end-=p}const c=a(t),d=c,m=o(t,r),f=m&&a(m)>=a(r);if(t.end<r.start)r.start-=c,r.end-=c;else if(m){const p=a(m);if(f){const v=s(r,t),g=u(v,i);r.start=g.start,r.end=g.end}else m.start>t.start||l?r.end-=p:(r.start-=c,r.end-=c+p)}const h=o(i,r);if(i.start<=r.start&&!f)r.start+=d,r.end+=d;else if(h){const p=i.start;if(a(h)<=a(r))return{step:r.start-n.start,length:0};p<r.start?(r.start+=d,r.end+=d):p>=r.start&&p<=r.end&&(r.end+=d,r.start+=d)}return{step:r.start-n.start,length:a(r)-a(n)}},iy=(t,e)=>{const{fromRange:n,toRange:r}=t.params||{};if(!r||!n)return[];const i=f1(n),o=f1(r),a=f1(e),s=uV({start:i.startRow,end:i.endRow},{start:o.startRow,end:o.endRow},{start:a.startRow,end:a.endRow});return s===null?[{type:Vr.Delete}]:[{type:Vr.VerticalMove,step:s.step||0,length:s.length||0}]},oy=(t,e)=>{const{fromRange:n,toRange:r}=t.params||{};if(!r||!n)return[];const i=f1(n),o=f1(r),a=f1(e),s=uV({start:i.startColumn,end:i.endColumn},{start:o.startColumn,end:o.endColumn},{start:a.startColumn,end:a.endColumn});return s===null?[{type:Vr.Delete}]:[{type:Vr.HorizontalMove,step:s.step||0,length:s.length||0}]},lV=(t,e)=>{var n,r;const i=(n=t.params)==null?void 0:n.toRange,o=(r=t.params)==null?void 0:r.fromRange;if(!i||!o)return[];const a=[];if(ht.contains(i,e)&&a.push({type:Vr.Delete}),ht.contains(o,e)){a.push({type:Vr.Delete});const s=ht.getRelativeRange(e,o),u=ht.getPositionRange(s,i);return[{type:Vr.Set,range:u}]}return a},$8=(t,e)=>{const n=f1(t),r=f1(e),i=a=>a.endColumn-a.startColumn+1,o=a=>a.endRow-a.startRow+1;if(n.startRow<=r.startRow&&n.endRow>=r.endRow){if(r.startColumn<n.startColumn&&r.endColumn>=n.startColumn&&r.endColumn<=n.endColumn||r.startColumn<n.startColumn&&r.endColumn>=n.endColumn){const a=ht.getIntersects(r,n);if(a)return{step:0,length:-i(a)}}if(r.startColumn>=n.startColumn&&r.endColumn<=n.endColumn&&o(n)>=o(r))return null;if(r.startColumn>n.startColumn&&r.startColumn<=n.endColumn&&r.endColumn>n.endColumn){const a=ht.getIntersects(r,n);if(a){const s=-i(a);return{step:-(i(n)-i(a)),length:s}}}if(r.startColumn>n.endColumn)return{step:-i(n),length:0}}return{step:0,length:0}},cV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=$8(r,e);if(!o)i.push({type:Vr.Delete});else{const{step:a,length:s}=o;i.push({type:Vr.HorizontalMove,step:a,length:s})}return i},dV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=$8(Sl(r),Sl(e));if(!o)i.push({type:Vr.Delete});else{const{step:a,length:s}=o;i.push({type:Vr.VerticalMove,step:a,length:s})}return i},k8=(t,e)=>{const n=f1(t),r=f1(e),i=o=>o.endColumn-o.startColumn+1;if(n.startRow<=r.startRow&&n.endRow>=r.endRow){if(r.startColumn<n.startColumn&&r.endColumn>=n.startColumn&&r.endColumn<=n.endColumn||r.startColumn<n.startColumn&&r.endColumn>=n.endColumn)return{step:0,length:i(n)};if(r.startColumn>=n.startColumn&&r.endColumn<=n.endColumn||r.startColumn>n.startColumn&&r.startColumn<=n.endColumn&&r.endColumn>n.endColumn||r.startColumn>=n.endColumn)return{step:i(n),length:0}}return{step:0,length:0}},mV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=k8(Sl(r),Sl(e)),{step:a,length:s}=o;return i.push({type:Vr.VerticalMove,step:a,length:s}),i},fV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=k8(r,e),{step:a,length:s}=o;return i.push({type:Vr.HorizontalMove,step:a,length:s}),i},hV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=k8(Sl(r),Sl(e)),{step:a,length:s}=o;return i.push({type:Vr.VerticalMove,step:a,length:s}),i},pV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=k8(r,e),{step:a,length:s}=o;return i.push({type:Vr.HorizontalMove,step:a,length:s}),i},gV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=$8(r,e);if(!o)i.push({type:Vr.Delete});else{const{step:a,length:s}=o;i.push({type:Vr.HorizontalMove,step:a,length:s})}return i},vV=(t,e)=>{var n;const r=(n=t.params)==null?void 0:n.range;if(!r)return[];const i=[],o=$8(Sl(r),Sl(e));if(!o)i.push({type:Vr.Delete});else{const{step:a,length:s}=o;i.push({type:Vr.VerticalMove,step:a,length:s})}return i},xo=(t,e)=>{let n={...e};return t.forEach(r=>{switch(r.type){case Vr.Delete:{n=null;break}case Vr.HorizontalMove:{if(!n)return;n.startColumn+=r.step,n.endColumn+=r.step+(r.length||0);break}case Vr.VerticalMove:{if(!n)return;n.startRow+=r.step,n.endRow+=r.step+(r.length||0);break}case Vr.Set:{n=r.range;break}}}),n&&(n.endColumn<n.startColumn||n.endRow<n.startRow)?null:n};var oMe=Object.defineProperty,aMe=Object.getOwnPropertyDescriptor,sMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?aMe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&oMe(e,n,i),i},E2=(t,e)=>(n,r)=>e(n,r,t);function Nf(t,e){let n=t;if(e!==void 0){const r=[];for(let i=0;i<n.length;i++){const{startRow:o,endRow:a,startColumn:s,endColumn:u}=n[i];if(e===Tr.ROWS)for(let l=o;l<=a;l++){const c={startRow:l,endRow:l,startColumn:s,endColumn:u};r.push(c)}else if(e===Tr.COLUMNS)for(let l=s;l<=u;l++){const c={startRow:o,endRow:a,startColumn:l,endColumn:l};r.push(c)}}n=r}return n}let v7=class extends We{constructor(e,n,r,i,o,a){super(),this._commandService=e,this._refRangeService=n,this._univerInstanceService=r,this._injector=i,this._sheetInterceptorService=o,this._selectionManagerService=a,this._onRefRangeChange(),this._initCommandInterceptor()}_initCommandInterceptor(){const e=this;this._sheetInterceptorService.interceptCommand({getMutations(n){switch(n.id){case Tf.id:case ll.id:{const r=e._univerInstanceService.getCurrentUniverSheetInstance(),i=r.getUnitId(),o=r.getActiveSheet(),a=o.getSheetId(),s=o.getConfig().mergeData,u=e._selectionManagerService.getSelectionRanges();if(u&&u.length>0&&u.some(l=>s.some(c=>ht.intersects(c,l)))){const l={unitId:i,subUnitId:a,ranges:u},c=Zi(e._injector,l),d=[{id:Un.id,params:l}],m=[{id:Bn.id,params:c}];return{redos:d,undos:m}}}}return{redos:[],undos:[]}}})}_onRefRangeChange(){const e=new ws,n=(o,a)=>{const s=this._univerInstanceService.getUniverSheetInstance(o);if(!s)return;const u=s==null?void 0:s.getSheetBySheetId(a);if(!u)return;e.dispose();const l=u.getMergeData(),c=d=>{switch(d.id){case Qc.id:{const m=d.params;return this._handleMoveRangeCommand(m,o,a)}case Jc.id:{const m=d.params,f=m.unitId||o,h=m.subUnitId||a;return this._handleInsertRowCommand(m,f,h)}case e2.id:{const m=d.params,f=m.unitId||o,h=m.subUnitId||a;return this._handleInsertColCommand(m,f,h)}case n2.id:{const m=d.params;return this._handleRemoveColCommand(m,o,a)}case t2.id:{const m=d.params;return this._handleRemoveRowCommand(m,o,a)}case fl.id:{const m=d.params;return this._handleInsertRangeMoveRightCommand(m,o,a)}case ml.id:{const m=d.params;return this._handleInsertRangeMoveDownCommand(m,o,a)}case $c.id:{const m=d.params;return this._handleDeleteRangeMoveUpCommand(m,o,a)}case Fc.id:{const m=d.params;return this._handleDeleteRangeMoveLeftCommand(m,o,a)}case Wn.MoveColsCommandId:{const m=d.params;return this._handleMoveColsCommand(m,o,a)}case Wn.MoveRowsCommandId:{const m=d.params;return this._handleMoveRowsCommand(m,o,a)}}return{redos:[],undos:[]}};l.forEach(d=>{e.add(this._refRangeService.registerRefRange(d,c,o,a))})};this.disposeWithMe(this._commandService.onCommandExecuted(o=>{if(o.id===pd.id){const a=o.params,s=a.subUnitId,u=a.unitId;if(!s||!u)return;n(u,s)}if(o.id===Bn.id){const a=o.params,s=a.subUnitId,u=a.unitId;if(!s||!u)return;n(a.unitId,a.subUnitId)}}));const r=this._univerInstanceService.getCurrentUniverSheetInstance(),i=r.getActiveSheet();n(r.getUnitId(),i.getSheetId())}_handleMoveRowsCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const a=[...o.getMergeData()],s={unitId:n,subUnitId:r,ranges:a},u={unitId:n,subUnitId:r,ranges:[]};a.forEach(d=>{const m=iy({id:Wn.MoveRowsCommandId,params:e},d),f=xo(m,d);f&&u.ranges.push(f)});const l=Zi(this._injector,s),c=Fo(this._injector,u);return{redos:[{id:Un.id,params:s},{id:Bn.id,params:u}],undos:[{id:Un.id,params:c},{id:Bn.id,params:l}]}}_handleMoveColsCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const a=[...o.getMergeData()],s={unitId:n,subUnitId:r,ranges:a},u={unitId:n,subUnitId:r,ranges:[]};a.forEach(d=>{const m=oy({id:Wn.MoveColsCommandId,params:e},d),f=xo(m,d);f&&u.ranges.push(f)});const l=Zi(this._injector,s),c=Fo(this._injector,u);return{redos:[{id:Un.id,params:s},{id:Bn.id,params:u}],undos:[{id:Un.id,params:c},{id:Bn.id,params:l}]}}_handleMoveRangeCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const a=o.getMergeData(),s=a.filter(f=>ht.intersects(f,e.fromRange)),u=a.filter(f=>ht.intersects(f,e.toRange)),l=s.map(f=>ht.getRelativeRange(f,e.fromRange)).map(f=>ht.getPositionRange(f,e.toRange)),c=Nf(l).filter(f=>!a.some(h=>ht.equals(f,h))),d=[{id:Un.id,params:{unitId:n,subUnitId:r,ranges:s}},{id:Un.id,params:{unitId:n,subUnitId:r,ranges:u}},{id:Bn.id,params:{unitId:n,subUnitId:r,ranges:c}}],m=[{id:Un.id,params:{unitId:n,subUnitId:r,ranges:c}},{id:Bn.id,params:{unitId:n,subUnitId:r,ranges:u}},{id:Bn.id,params:{unitId:n,subUnitId:r,ranges:s}}];return{redos:d,undos:m}}_handleInsertRowCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const{range:a}=e,{startRow:s,endRow:u}=a,l=Ie.deepClone(o.getMergeData()),c=Ie.deepClone(o.getMergeData()).map(g=>{const b=u-s+1;return s>g.endRow?g:s<=g.startRow?ht.moveVertical(g,b):(g.endRow+=b,g)}),d={unitId:n,subUnitId:r,ranges:l},m=Zi(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},h=Fo(this._injector,f),p=[{id:Un.id,params:d},{id:Bn.id,params:f}],v=[{id:Un.id,params:h},{id:Bn.id,params:m}];return{redos:p,undos:v}}_handleInsertColCommand(e,n,r){const{range:i}=e,o=ts(this._univerInstanceService,n);if(!o)return this._handleNull();const a=ns(o,r);if(!a)return this._handleNull();const{startColumn:s,endColumn:u}=i,l=Ie.deepClone(a.getMergeData()),c=Ie.deepClone(a.getMergeData()).map(g=>{const b=u-s+1;return s>g.endColumn?g:s<=g.startColumn?ht.moveHorizontal(g,b):(g.endColumn+=b,g)}),d={unitId:n,subUnitId:r,ranges:l},m=Zi(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},h=Fo(this._injector,f),p=[{id:Un.id,params:d},{id:Bn.id,params:f}],v=[{id:Un.id,params:h},{id:Bn.id,params:m}];return{redos:p,undos:v}}_handleRemoveColCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const{range:a}=e,s=Ie.deepClone(o.getMergeData());for(let h=0;h<s.length;h++){const p=s[h],{startColumn:v,endColumn:g}=p,b=g-v+1,{startColumn:C,endColumn:S}=a,E=S-C+1;if(S<p.startColumn)p.startColumn-=E,p.endColumn-=E;else{if(C>p.endColumn)continue;if(C<=p.startColumn&&S>=p.endColumn)s.splice(h,1),h--;else{const y=ht.getIntersects(a,p),D=y.endColumn-y.startColumn+1,R=y.endRow-y.startRow===0;D===b-1&&R?(s.splice(h,1),h--):p.endColumn-=y.endColumn-y.startColumn+1}}}const u={unitId:n,subUnitId:r,ranges:Ie.deepClone(o.getMergeData())},l=Zi(this._injector,u),c={unitId:n,subUnitId:r,ranges:s},d=Fo(this._injector,c),m=[{id:Un.id,params:u},{id:Bn.id,params:c}],f=[{id:Un.id,params:d},{id:Bn.id,params:l}];return{redos:m,undos:f}}_handleRemoveRowCommand(e,n,r){const{range:i}=e,o=ts(this._univerInstanceService,n);if(!o)return this._handleNull();const a=ns(o,r);if(!a)return this._handleNull();const s=Ie.deepClone(a.getMergeData());for(let h=0;h<s.length;h++){const p=s[h],{startRow:v,endRow:g}=p,b=g-v+1,{startRow:C,endRow:S}=i,E=S-C+1;if(S<v)p.startRow-=E,p.endRow-=E;else{if(C>g)continue;if(C<=v&&S>=g)s.splice(h,1),h--;else{const y=ht.getIntersects(i,p),D=y.endRow-y.startRow+1,R=y.endColumn-y.startColumn===0;D===b-1&&R?(s.splice(h,1),h--):p.endRow-=y.endRow-y.startRow+1}}}const u={unitId:n,subUnitId:r,ranges:Ie.deepClone(a.getMergeData())},l=Zi(this._injector,u),c={unitId:n,subUnitId:r,ranges:s},d=Fo(this._injector,c),m=[{id:Un.id,params:u},{id:Bn.id,params:c}],f=[{id:Un.id,params:d},{id:Bn.id,params:l}];return{redos:m,undos:f}}_handleInsertRangeMoveRightCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const a=e.range,s=o.getMaxColumns()-1,u=o.getMergeData(),l=[],c=[];u.forEach(p=>{const{startRow:v,endRow:g,startColumn:b,endColumn:C}=a;if(ht.intersects({startRow:v,startColumn:b,endRow:g,endColumn:s},p)&&(l.push(p),ht.contains({startRow:v,startColumn:b,endRow:g,endColumn:s},p))){const S=C-b+1;c.push({startRow:p.startRow,startColumn:p.startColumn+S,endRow:p.endRow,endColumn:p.endColumn+S})}});const d={unitId:n,subUnitId:r,ranges:l},m=Zi(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},h=Fo(this._injector,f);return{redos:[{id:Un.id,params:d},{id:Bn.id,params:f}],undos:[{id:Bn.id,params:m},{id:Un.id,params:h}]}}_handleInsertRangeMoveDownCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const a=e.range,s=o.getMaxRows()-1,u=o.getMergeData(),l=[],c=[];u.forEach(g=>{const{startRow:b,startColumn:C,endColumn:S,endRow:E}=a;if(ht.intersects({startRow:b,startColumn:C,endRow:s,endColumn:S},g)&&(l.push(g),ht.contains({startRow:b,startColumn:C,endRow:s,endColumn:S},g))){const y=E-b+1;c.push({startRow:g.startRow+y,startColumn:g.startColumn,endRow:g.endRow+y,endColumn:g.endColumn})}});const d={unitId:n,subUnitId:r,ranges:l},m=Zi(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},h=Fo(this._injector,f),p=[{id:Un.id,params:d},{id:Bn.id,params:f}],v=[{id:Bn.id,params:m},{id:Un.id,params:h}];return{redos:p,undos:v}}_handleDeleteRangeMoveUpCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const a=e.range,s=o.getMaxRows()-1,u=o.getMergeData(),l=[],c=[];u.forEach(g=>{const{startRow:b,startColumn:C,endColumn:S,endRow:E}=a;if(ht.intersects({startRow:b,startColumn:C,endRow:s,endColumn:S},g)&&(l.push(g),ht.contains({startRow:b,startColumn:C,endRow:s,endColumn:S},g))){const y=E-b+1,D=ht.moveVertical(g,-y);c.push(D)}});const d={unitId:n,subUnitId:r,ranges:l},m=Zi(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},h=Fo(this._injector,f),p=[{id:Un.id,params:d},{id:Bn.id,params:f}],v=[{id:Bn.id,params:m},{id:Un.id,params:h}];return{redos:p,undos:v}}_handleDeleteRangeMoveLeftCommand(e,n,r){const i=ts(this._univerInstanceService,n);if(!i)return this._handleNull();const o=ns(i,r);if(!o)return this._handleNull();const a=e.range,s=o.getMaxColumns()-1,u=o.getMergeData(),l=[],c=[];u.forEach(p=>{const{startRow:v,endRow:g,startColumn:b,endColumn:C}=a;if(ht.intersects({startRow:v,startColumn:b,endRow:g,endColumn:s},p)&&(l.push(p),ht.contains({startRow:v,startColumn:b,endRow:g,endColumn:s},p))){const S=C-b+1;c.push({startRow:p.startRow,startColumn:p.startColumn-S,endRow:p.endRow,endColumn:p.endColumn-S})}});const d={unitId:n,subUnitId:r,ranges:l},m=Zi(this._injector,d),f={unitId:n,subUnitId:r,ranges:c},h=Fo(this._injector,f);return{redos:[{id:Un.id,params:d},{id:Bn.id,params:f}],undos:[{id:Bn.id,params:m},{id:Un.id,params:h}]}}_handleNull(){return{redos:[],undos:[]}}};v7=sMe([yt(ot.Steady,v7),E2(0,K(se)),E2(1,K(b0)),E2(2,K(ae)),E2(3,K(wn)),E2(4,K(In)),E2(5,K(dt))],v7);function ts(t,e){return e?t.getUniverSheetInstance(e):t.getCurrentUniverSheetInstance()}function ns(t,e){return e?t.getSheetBySheetId(e):t.getActiveSheet()}const uMe={sheets:{sheetCopy:"（副本）",sheet:"工作表"}};var lMe=Object.defineProperty,cMe=Object.getOwnPropertyDescriptor,dMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?cMe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&lMe(e,n,i),i},q3=(t,e)=>(n,r)=>e(n,r,t);const LT="SHEET_NUMFMT_PLUGIN";let b7=class extends We{constructor(e,n,r,i){super(),fr(this,"_numfmtModel",new Map),fr(this,"_refAliasModel",new Map),fr(this,"_modelReplace$",new an),fr(this,"modelReplace$",this._modelReplace$.asObservable()),this._commandService=e,this._resourceManagerService=n,this._univerInstanceService=r,this._logService=i,this._initModel(),this.disposeWithMe(je(()=>{this._numfmtModel.clear(),this._refAliasModel.clear()}))}_initModel(){const e=r=>{const i=r.getUnitId();this.disposeWithMe(this._resourceManagerService.registerPluginResource(i,LT,{toJson:o=>this._toJson(o),parseJson:o=>this._parseJson(o),onChange:(o,a)=>{const{model:s,refModel:u}=a;if(s){const l=Object.keys(s).reduce((c,d)=>(c.set(d,new Ye(s[d])),c),new Map);this._numfmtModel.set(o,l)}u&&this._refAliasModel.set(o,new cp(u,["pattern","i"])),this._modelReplace$.next(o)}}))};this.disposeWithMe(je(this._univerInstanceService.sheetAdded$.subscribe(e))),this.disposeWithMe(je(this._univerInstanceService.sheetDisposed$.subscribe(r=>{const i=r.getUnitId();this._numfmtModel.get(i)&&this._numfmtModel.delete(i),this._refAliasModel.get(i)&&this._refAliasModel.delete(i),this._resourceManagerService.disposePluginResource(i,LT)})));const n=this._univerInstanceService.getCurrentUniverSheetInstance();e(n)}_toJson(e){const n=this._numfmtModel.get(e),r=this._refAliasModel.get(e);if(!n||!r)return"";const i=[...n.keys()].reduce((a,s)=>{const u=n.get(s);return a[s]=u.toJSON(),a},{}),o=r.getValues().filter(a=>a.count>0);return JSON.stringify({model:i,refModel:o})}_parseJson(e){try{return JSON.parse(e)}catch{return{model:{},refModel:[]}}}_setValue(e,n,r,i,o){let a=this.getModel(e,n);if(!a){const s=this._numfmtModel.get(e)||new Map,u=s.get(n)||new Ye;s.set(n,u),this._numfmtModel.set(e,s),a=u}if(o)a.setValue(r,i,o);else if(a.realDeleteValue(r,i),!a.getSizeOf()){const s=this._numfmtModel.get(e);s==null||s.delete(n)}}_getUniqueRefId(e){const n=this._refAliasModel.get(e);if(!n)return"0";const r=n.getKeyMap("i");return`${Math.max(...r.map(i=>Number(i||0)),0)+1}`}getValue(e,n,r,i,o){const a=o||this.getModel(e,n);if(!a)return null;const s=this._refAliasModel.get(e),u=a.getValue(r,i);if(u&&s){const l=s.getValue(u==null?void 0:u.i);return l?{pattern:l.pattern,type:l.type}:(this._logService.error("[Numfmt Service]:","RefAliasModel is not match model"),null)}return null}deleteValues(e,n,r){let i=this._refAliasModel.get(e);const o=this.getModel(e,n);i||(i=new cp([],["pattern","i"]),this._refAliasModel.set(e,i)),r.forEach(a=>{mr.foreach(a,(s,u)=>{const l=this.getValue(e,n,s,u,o);if(l&&l.pattern){const c=i.getValue(l.pattern);c&&c.count--}this._setValue(e,n,s,u,null)})})}setValues(e,n,r){const i=this.getModel(e,n);let o=this._refAliasModel.get(e);o||(o=new cp([],["pattern","i"]),this._refAliasModel.set(e,o)),r.forEach(a=>{let s=o.getValue(a.pattern);s||(s={count:0,i:this._getUniqueRefId(e),pattern:a.pattern,type:r[0].type},o.addValue(s)),a.ranges.forEach(u=>{mr.foreach(u,(l,c)=>{if(i){const d=this.getValue(e,n,l,c,i);if(d&&d.pattern){const m=o.getValue(d.pattern);m&&m.count--}}this._setValue(e,n,l,c,{i:s.i}),s.count++})})})}getModel(e,n){const r=this._numfmtModel.get(e);return r==null?void 0:r.get(n)}getRefModel(e){return this._refAliasModel.get(e)}};b7=dMe([yt(ot.Starting,b7),q3(0,K(se)),q3(1,K(UC)),q3(2,K(ae)),q3(3,K(oo))],b7);const OT="univer.sheet.editable";class y2 extends IL{constructor(e,n){super(),fr(this,"id",OT),fr(this,"value",!0),fr(this,"unitID"),this._unitId=e,this._subUnitId=n,this.unitID=e,this.id=`${OT}_${e}_${n}`}}var mMe=Object.defineProperty,fMe=Object.getOwnPropertyDescriptor,hMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?fMe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&mMe(e,n,i),i},$g=(t,e)=>(n,r)=>e(n,r,t);let Z6=class extends We{constructor(e,n,r){super(),this._permissionService=e,this._univerInstanceService=n,this._sheetInterceptorService=r,this._init(),this._interceptCommandPermission()}_init(){const e=this._univerInstanceService.getCurrentUniverSheetInstance(),n=e.getUnitId();e.getSheets().forEach(r=>{const i=r.getSheetId(),o=new y2(n,i);this._permissionService.addPermissionPoint(e.getUnitId(),o)}),this.disposeWithMe(je(e.sheetCreated$.subscribe(r=>{const i=r.getSheetId(),o=new y2(n,i);this._permissionService.addPermissionPoint(e.getUnitId(),o)}))),this.disposeWithMe(je(e.sheetDisposed$.subscribe(r=>{const i=r.getSheetId(),o=new y2(n,i);this._permissionService.deletePermissionPoint(e.getUnitId(),o.id)})))}_interceptCommandPermission(){this.disposeWithMe(this._sheetInterceptorService.intercept(Rs.PERMISSION,{priority:99,handler:(e,n,r)=>{const i=this._univerInstanceService.getCurrentUniverSheetInstance(),o=i==null?void 0:i.getActiveSheet(),a=i==null?void 0:i.getUnitId(),s=o==null?void 0:o.getSheetId();if(!a||!s)return!1;switch(n.id){case Ga.id:return this.getSheetEditable(a,s)}return r()}}))}getEditable$(e,n){const r=this._univerInstanceService.getCurrentUniverSheetInstance(),i=e||r.getUnitId(),o=r.getActiveSheet(),a=n||o.getSheetId(),s=new y2(i,a);return this._permissionService.composePermission$(i,[Iv,s.id]).pipe(ja(([u,l])=>{const c=u.value&&l.value,d=$W([u,l]);return{value:c,status:d}}))}getSheetEditable(e,n){const r=this._univerInstanceService.getCurrentUniverSheetInstance(),i=e||r.getUnitId(),o=r.getActiveSheet(),a=n||o.getSheetId(),s=new y2(i,a);return this._permissionService.composePermission(i,[Iv,s.id]).every(u=>u.value)}setSheetEditable(e,n,r){const i=this._univerInstanceService.getCurrentUniverSheetInstance(),o=n||i.getUnitId(),a=i.getActiveSheet(),s=r||a.getSheetId(),u=new y2(o,s);this._permissionService.updatePermissionPoint(o,u.id,e)}};Z6=hMe([yt(ot.Ready,Z6),$g(0,K(VC)),$g(1,K(ae)),$g(2,K(In))],Z6);function ei(t){const e=t.get(ae),n=t.get(Z6),r=e.getCurrentUniverSheetInstance().getUnitId(),i=e.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();return new Wt(o=>{var a;const s=(a=n.getEditable$(r,i))==null?void 0:a.subscribe(u=>{o.next(!u.value)});return()=>{s==null||s.unsubscribe()}})}var pMe=Object.defineProperty,gMe=Object.getOwnPropertyDescriptor,vMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?gMe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&pMe(e,n,i),i},kg=(t,e)=>(n,r)=>e(n,r,t);const bMe="sheet";var Bg;let q_=(Bg=class extends b1{constructor(t,e,n,r){super(bMe),this._config=t,this._commandService=e,this._localeService=n,this._injector=r,this._initializeDependencies(r)}onRendered(){this._localeService.load({zhCN:uMe})}_initializeDependencies(t){var e;const n=[[hl],[dt],[b0],[Z6],[Ti,{useClass:b7}],[In],[h7],[v7]];(e=this._config)!=null&&e.notExecuteFormula||n.push([p7],[g7]),n.forEach(r=>{t.add(r)})}},fr(Bg,"type",Ir.Sheet),Bg);q_=vMe([kg(1,se),kg(2,K(Gt)),kg(3,K(wn))],q_);const bV=[m1.id,Is.id,Um.id,Wa.id,Us.id,U0.id,V0.id,gl.id,vl.id,_l.id,bl.id,Bc.id,kc.id,dl.id,cl.id],_Me=[Vt.id,qa.id,Un.id,Bn.id],U9=1.5,G3="rgba(255,255,255, 0.01)";function vc(t){const e=t.getCurrentTheme(),n=new Xo(e.colorBlack).setAlpha(.1).toRgbString();return{strokeWidth:1.5,stroke:e.primaryColor,fill:n,widgets:{},widgetSize:6,widgetStrokeWidth:1,widgetStroke:e.colorWhite,hasAutoFill:!0,AutofillSize:6,AutofillStrokeWidth:1,AutofillStroke:e.colorWhite,hasRowHeader:!0,rowHeaderFill:n,rowHeaderStroke:e.primaryColor,rowHeaderStrokeWidth:1,hasColumnHeader:!0,columnHeaderFill:n,columnHeaderStroke:e.primaryColor,columnHeaderStrokeWidth:1}}function _7(t){const{rangeWithCoord:e,primaryWithCoord:n,style:r}=t,i={range:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType},primary:null,style:r};return n!=null&&(i.primary=CMe(n)),i}function CMe(t){const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i}=t,{startRow:o,startColumn:a,endRow:s,endColumn:u}=t.mergeInfo;return{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:i,startRow:o,startColumn:a,endRow:s,endColumn:u}}function SMe(t,e,n){const r=Xc(t,e,n),i=IW(r);if(i)return{range:i,primary:r,style:null}}ue.MUTATION;var EMe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yMe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _V={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(typeof self<"u"?self:EMe,function(){return function(){var n={d:function(Y,z){for(var ne in z)n.o(z,ne)&&!n.o(Y,ne)&&Object.defineProperty(Y,ne,{enumerable:!0,get:z[ne]})},o:function(Y,z){return Object.prototype.hasOwnProperty.call(Y,z)}},r={};n.d(r,{default:function(){return En}});var i={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"};const o=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,a={},s={group:" ",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"∞",ampm:["AM","PM"],mmmm6:["Muharram","Safar","Rabiʻ I","Rabiʻ II","Jumada I","Jumada II","Rajab","Shaʻban","Ramadan","Shawwal","Dhuʻl-Qiʻdah","Dhuʻl-Hijjah"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhuʻl-Q.","Dhuʻl-H."],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function u(Y){const z=o.exec(Y);if(!z)throw new SyntaxError("Malformed locale: ".concat(Y));return{lang:z[1]+(z[2]?"_"+z[2]:""),language:z[1],territory:z[2]||"",codeset:z[3]||"",modifier:z[4]||""}}function l(Y){if(typeof Y=="number")return i[65535&Y]||null;const z=parseInt(Y,16);return isFinite(z)&&i[65535&z]?i[65535&z]||null:o.test(Y)?Y:null}function c(Y){const z=l(Y);let ne=null;if(z){const Ce=u(z);ne=a[Ce.lang]||a[Ce.language]||null}return ne}function d(Y){return Object.assign({},s,Y)}function m(Y,z){const ne=typeof z=="object"?z:u(z);return a[ne.lang]=d(Y),ne.language===ne.lang||a[ne.language]||(a[ne.language]=d(Y)),a[ne.lang]}const f=d({group:","});function h(Y,z){if(typeof Y!="number")return Y;if(Y<0)return-h(-Y,z);if(z){const ne=10**(z||0)||1;return h(Y*ne,0)/ne}return Math.round(Y)}f.isDefault=!0,m({group:",",ampm:["上午","下午"],mmmm:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["周日","周一","周二","周三","周四","周五","周六"]},"zh_CN"),m({group:",",nan:"非數值",ampm:["上午","下午"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["週日","週一","週二","週三","週四","週五","週六"]},"zh_TW"),m({group:",",ampm:["午前","午後"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ddd:["日","月","火","水","木","金","土"]},"ja"),m({group:",",ampm:["오전","오후"],mmmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],mmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dddd:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],ddd:["일","월","화","수","목","금","토"]},"ko"),m({group:",",ampm:["ก่อนเที่ยง","หลังเที่ยง"],mmmm:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],mmm:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dddd:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],ddd:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},"th"),m({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","února","března","dubna","května","června","července","srpna","září","října","listopadu","prosince"],mmm:["led","úno","bře","dub","kvě","čvn","čvc","srp","zář","říj","lis","pro"],dddd:["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],ddd:["ne","po","út","st","čt","pá","so"]},"cs"),m({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"da"),m({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl"),m({group:","},"en"),m({decimal:",",nan:"epäluku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kesäkuuta","heinäkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kesäk.","heinäk.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi"),m({group:" ",decimal:",",mmmm:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],mmm:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr"),m({group:".",decimal:",",mmmm:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de"),m({group:".",decimal:",",ampm:["π.μ.","μ.μ."],mmmm:["Ιανουαρίου","Φεβρουαρίου","Μαρτίου","Απριλίου","Μαΐου","Ιουνίου","Ιουλίου","Αυγούστου","Σεπτεμβρίου","Οκτωβρίου","Νοεμβρίου","Δεκεμβρίου"],mmm:["Ιαν","Φεβ","Μαρ","Απρ","Μαΐ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],dddd:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],ddd:["Κυρ","Δευ","Τρί","Τετ","Πέμ","Παρ","Σάβ"]},"el"),m({decimal:",",ampm:["de.","du."],mmmm:["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],mmm:["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],dddd:["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu"),m({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["janúar","febrúar","mars","apríl","maí","júní","júlí","ágúst","september","október","nóvember","desember"],mmm:["jan.","feb.","mar.","apr.","maí","jún.","júl.","ágú.","sep.","okt.","nóv.","des."],dddd:["sunnudagur","mánudagur","þriðjudagur","miðvikudagur","fimmtudagur","föstudagur","laugardagur"],ddd:["sun.","mán.","þri.","mið.","fim.","fös.","lau."]},"is"),m({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id"),m({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it"),m({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"nb"),m({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],dddd:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],ddd:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."]},"pl"),m({group:".",decimal:",",mmmm:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","sáb."]},"pt"),m({decimal:",",nan:"не число",mmmm:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],mmm:["янв.","февр.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],dddd:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],ddd:["вс","пн","вт","ср","чт","пт","сб"]},"ru"),m({decimal:",",mmmm:["januára","februára","marca","apríla","mája","júna","júla","augusta","septembra","októbra","novembra","decembra"],mmm:["jan","feb","mar","apr","máj","jún","júl","aug","sep","okt","nov","dec"],dddd:["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],ddd:["ne","po","ut","st","št","pi","so"]},"sk"),m({group:".",decimal:",",ampm:["a. m.","p. m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],ddd:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."]},"es"),m({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],ddd:["sön","mån","tis","ons","tors","fre","lör"]},"sv"),m({group:".",decimal:",",ampm:["ÖÖ","ÖS"],mmmm:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],mmm:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"]},"tr");function p(Y,z,ne){const Ce=Y<0?-1:1,Ve=10**(z||2),Ke=10**(ne||2);let Pe,Be,me=Math.abs(Y),De=0,Ne=0,be=0,ft=1;if((Y=me)%1==0)Be=[Y*Ce,1];else if(Y<1e-19)Be=[Ce,1e19];else if(Y>1e19)Be=[1e19*Ce,1];else{do if(me=1/(me-Math.floor(me)),Pe=ft,ft=ft*Math.floor(me)+De,De=Pe,Ne=be,be=Math.floor(Y*ft+.5),be>=Ve||ft>=Ke)return[Ce*Ne,De];while(Math.abs(Y-be/ft)>=1e-10&&me!==Math.floor(me));Be=[Ce*be,ft]}return Be}const v={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},g=Object.assign({},v);function b(Y){if(Y===null&&(Y=v),Y){for(const z in Y)if(z in v){const ne=Y[z];g[z]=ne??v[z]}}return{...g}}const C={"#":"",0:"0","?":" "},S={"@":"text","-":"minus","+":"plus"},E=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],y=["¤","$","£","¥","֏","؋","৳","฿","៛","₡","₦","₩","₪","₫","€","₭","₮","₱","₲","₴","₸","₹","₺","₼","₽","₾","₿"],D=new RegExp("["+y.join("")+"]");function R(Y,z,ne){return z[ne+"_max"]=Y.length,z[ne+"_min"]=Y.replace(/#/g,"").length,z}const I={};function T(Y){if(!(Y in I)){const z=[],ne=Y.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,Ce=>"?".repeat(Ce.length));for(let Ce=0;Ce<ne.length;Ce++){const Ve=ne.charAt(Ce);z[Ce]=Ve in C?C[Ve]:Ve}I[Y]=z.join("")}return I[Y]}function P(Y,z){typeof Y=="string"&&(Y={type:"string",value:Y=Y.replace(/ /g,C["?"])}),z.push(Y)}function N(Y){const z=[],ne={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:1,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:z};let Ce=Y+"",Ve="int",Ke=!1,Pe=null;const Be=[];let me,De,Ne=!1;for(;Ce&&!Ke;){if(me=/^General/i.exec(Ce))ne.general=!0,P({type:"general"},z);else if(Ve==="int"&&(me=/^[#?0]+(?:,[#?0]+)*/.exec(Ce))||Ve==="den"&&(me=/^[#?\d]+/.exec(Ce))||(me=/^[#?0]+/.exec(Ce)))ne[Ve+"_pattern"].push(me[0]),Pe={type:Ve,num:me[0]},P(Pe,z);else if((me=/^\//.exec(Ce))&&ne[Ve+"_pattern"].length){if(!Pe)throw new SyntaxError("Missing a numerator in pattern ".concat(Y));ne.fractions=!0,ne.num_pattern.push(ne[Ve+"_pattern"].pop()),Pe.type="num",Ve="den",P({type:"div"},z)}else if(me=/^,+/.exec(Ce)){const Me=Ce.charAt(1)in C;De.slice(-1)in C&&(me[0].length>1||!Me)?ne.scale=.001**me[0].length:ne.dec_fractions||P(me[0],z)}else{if(me=/^;/.exec(Ce)){Ke=!0;break}if(me=/^[@+-]/.exec(Ce))me[0]==="@"&&(ne.text=!0),P({type:S[me[0]]},z);else if(me=/^(?:\[(h+|m+|s+)\])/i.exec(Ce)){const Me=me[1].toLowerCase(),Le=Me[0],Je={type:"",size:0,date:1,raw:me[0],pad:Me.length};Le==="h"?(Je.size=16,Je.type="hour-elap"):Le==="m"?(Je.size=32,Je.type="min-elap"):(Je.size=64,Je.type="sec-elap"),ne.date=ne.date|Je.size,Be.push(Je),P(Je,z)}else if(me=/^(?:B2)/i.exec(Ce))Ne||(ne.date_system=6);else if(me=/^(?:B1)/i.exec(Ce))Ne||(ne.date_system=1);else if(me=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(Ce)){const Me={type:"",size:0,date:1,raw:me[0]},Le=me[0].toLowerCase(),Je=Le[0];if(Le==="y"||Le==="yy")Me.size=2,Me.type="year-short";else if(Je==="y"||Je==="e")Me.size=2,Me.type="year";else if(Le==="b"||Le==="bb")Me.size=2,Me.type="b-year-short";else if(Je==="b")Me.size=2,Me.type="b-year";else if(Le==="d"||Le==="dd")Me.size=8,Me.type="day",Me.pad=/dd/.test(Le);else if(Le==="ddd")Me.size=8,Me.type="weekday-short";else if(Je==="d")Me.size=8,Me.type="weekday";else if(Je==="h")Me.size=16,Me.type="hour",Me.pad=/hh/i.test(Le);else if(Je==="m"){Le.length===3?(Me.size=4,Me.type="monthname-short"):Le.length===5?(Me.size=4,Me.type="monthname-single"):Le.length>=4&&(Me.size=4,Me.type="monthname");const Xe=Be[Be.length-1];!Me.type&&Xe&&!Xe.used&&80&Xe.size&&(Xe.used=!0,Me.size=32,Me.type="min",Me.pad=/mm/.test(Le)),Me.type||(Me.size=4,Me.type="month",Me.pad=/mm/.test(Le),Me.indeterminate=!0)}else if(Je==="s"){Me.size=64,Me.type="sec",Me.pad=/ss/.test(Le);const Xe=Be[Be.length-1];Xe&&32&Xe.size?Me.used=!0:Xe&&Xe.indeterminate&&(delete Xe.indeterminate,Xe.size=32,Xe.type="min",Me.used=!0)}ne.date=ne.date|Me.size,ne.date_eval=!0,Be.push(Me),P(Me,z)}else if(me=/^(?:AM\/PM|am\/pm|A\/P)/.exec(Ce))ne.clock=12,ne.date=16|ne.date,ne.date_eval=!0,P({type:"am",short:me[0]==="A/P"},z);else if(ne.date&&(me=/^\.0{1,3}/i.exec(Ce))){const Me=me[0].length-1,Le=[64,128,256,512][Me];ne.date=ne.date|Le,ne.date_eval=!0,ne.sec_decimals=Math.max(ne.sec_decimals,Me),P({type:"subsec",size:Le,decimals:Me,date:1,raw:me[0]},z)}else if((me=/^\\(.)/.exec(Ce))||(me=/^"([^"]*?)"/.exec(Ce)))P(me[1],z);else if(me=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(Ce))ne.condition=[me[1],parseFloat(me[2],10)];else if(me=/^\[\$([^\]]+)\]/.exec(Ce)){const Me=me[1].split("-"),Le=Me.length<2?"":Me[Me.length-1],Je=Me[0];Je&&P(Je,z);const Xe=l(Le);Xe&&(ne.locale=Xe);const Et=parseInt(Le,16);isFinite(Et)&&16711680&Et&&(Et>>16&255)===6&&(ne.date_system=6),Ne=!0}else if(me=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(Ce))ne.color=me[2]?E[parseInt(me[2],10)]||"#000":me[1].toLowerCase();else if(!(me=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(Ce))){if(me=/^%/.exec(Ce))ne.scale=100,ne.percent=!0,P("%",z);else if(me=/^_(\\.|.)/.exec(Ce))P(" ",z);else if(me=/^\./.exec(Ce))P({type:"point",value:me[0]},z),ne.dec_fractions=!0,Ve="frac";else if(me=/^[Ee]([+-]?|(?=[0#?]))/.exec(Ce))ne.exponential=!0,ne.exp_plus=me[1]==="+",Ve="man",P({type:"exp",plus:me[1]==="+"},z);else if(!(me=/^\*(\\.|.)/.exec(Ce))){if(me=/^[BENn[]/.exec(Ce))throw new SyntaxError("Unexpected char ".concat(Ce.charAt(0)," in pattern ").concat(Y));Ce[0]==="("&&(ne.parens=!0),me=[Ce[0]],P(me[0],z)}}}De=me[0],Ce=Ce.slice(me?me[0].length:1)}if(ne.pattern=Y.slice(0,Y.length-Ce.length),/^((?:\[[^\]]+\])+)(;|$)/.test(ne.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(ne.pattern)&&P({type:"text"},z),ne.fractions&&ne.dec_fractions||ne.fractions&&ne.exponential)throw new SyntaxError("Invalid pattern: ".concat(ne.pattern));const be=ne.int_pattern.join("");if(ne.grouping=be.indexOf(",")>=0,ne.grouping){const Me=be.split(","),Le=Me.length;Le===2?(ne.group_pri=Me[1].length,ne.group_sec=ne.group_pri):Le>2&&(ne.group_pri=Me[Le-1].length,ne.group_sec=Me[Le-2].length)}else ne.group_pri=0,ne.group_sec=0;R(be.replace(/[,]/g,""),ne,"int"),R(ne.frac_pattern.join(""),ne,"frac"),R(ne.man_pattern.join(""),ne,"man");let ft=ne.num_pattern.join(""),Ze=ne.den_pattern.join("");const st=/\?/.test(Ze)||/\?/.test(ft);return Ze=Ze.replace(/\d/g,st?"?":"#"),st&&(Ze=Ze.replace(/#$/g,"?")),R(ft,ne,"num"),R(Ze,ne,"den"),st&&(ft=ft.replace(/#$/g,"?")),ne.int_padding=T(ne.int_pattern.join("")),ne.man_padding=T(ne.man_pattern.join("")),ne.num_padding=T(ft),ne.den_padding=T(Ze),ne.den_pattern.length&&(ne.denominator=parseInt(ne.den_pattern.join("").replace(/\D/g,""),10)),ne.integer=!!ne.int_pattern.join("").length,ne.fractions&&z.forEach((Me,Le)=>{const Je=z[Le+1];Me.type==="string"&&Je&&(Je.type==="num"?Me.rule="num+int":Je.type==="div"?Me.rule="num":Je.type==="den"&&(Me.rule="den"))}),ne}const B=Y=>{const z=Y.condition;z&&z[1]<0&&(z[0]==="<"||z[0]==="<="||z[0]==="=")||Y.tokens.unshift({type:"minus",volatile:!0})};function W(Y){const z=[];let ne,Ce=!1,Ve=null,Ke=Y,Pe=0,Be=!1,me=0,De=0;do{if(Be=N(Ke),(Be.date||Be.general)&&(Be.int_pattern.length||Be.frac_pattern.length||Be.scale!==1||Be.text))throw new Error("Illegal format");if(Be.condition&&(De++,Ce=!0),Be.text){if(Ve)throw new Error("Unexpected partition");Ve=Be}Be.locale&&(ne=l(Be.locale)),z.push(Be),Pe=Ke.charAt(Be.pattern.length)===";"?1:0,Ke=Ke.slice(Be.pattern.length+Pe),me++}while(Pe&&me<4&&De<3);if(Pe)throw new Error("Unexpected partition");if(De>2)throw new Error("Unexpected condition");const Ne=z[3];if(Ne&&(Ne.int_pattern.length||Ne.frac_pattern.length||Ne.date))throw new Error("Unexpected partition");if(Ce){const be=z.length;if(be===1&&(z[1]=N("General"),z[1].generated=!0),be<3){const ft=z[0],Ze=z[1];if(B(ft),Ze.condition)B(Ze);else{const st=ft.condition;(st[0]==="="||st[1]>=0&&(st[0]===">"||st[0]===">="))&&Ze.tokens.unshift({type:"minus",volatile:!0})}}else z.forEach(B)}else{if(z.length<4&&Ve)for(let be=0,ft=z.length;be<ft;be++)z[be]===Ve&&z.splice(be,1);if(z.length<1&&Ve&&(z[0]=N("General"),z[0].generated=!0),z.length<2){const be=N(z[0].pattern);be.tokens.unshift({type:"minus",volatile:!0}),be.generated=!0,z.push(be)}if(z.length<3){const be=N(z[0].pattern);be.generated=!0,z.push(be)}if(z.length<4)if(Ve)z.push(Ve);else{const be=N("@");be.generated=!0,z.push(be)}z[0].condition=[">",0],z[1].condition=["<",0],z[2].condition=null}return{pattern:Y,partitions:z,locale:ne}}const G=Math.floor;function Q(Y){if((!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&Y>=0){if(Y===0)return[1900,1,0];if(Y===60)return[1900,2,29];if(Y<60)return[1900,Y<32?1:2,(Y-1)%31+1]}let z=Y+68569+2415019;const ne=G(4*z/146097);z-=G((146097*ne+3)/4);const Ce=G(4e3*(z+1)/1461001);z=z-G(1461*Ce/4)+31;const Ve=G(80*z/2447),Ke=z-G(2447*Ve/80);z=G(Ve/11);const Pe=Ve+2-12*z;return[0|100*(ne-49)+Ce+z,0|Pe,0|Ke]}function te(Y){return Q(Y+1462)}function X(Y){if(Y===60)throw new Error("#VALUE!");if(Y<=1)return[1317,8,29];if(Y<60)return[1317,Y<32?9:10,1+(Y-2)%30];const z=10631/30,ne=.1335;let Ce=Y+466935;const Ve=G(Ce/10631);Ce-=10631*Ve;const Ke=G((Ce-ne)/z);Ce-=G(Ke*z+ne);const Pe=G((Ce+28.5001)/29.5);return Pe===13?[30*Ve+Ke,12,30]:[30*Ve+Ke,Pe,Ce-G(29.5001*Pe-29)]}function x(Y){let z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ne=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];const Ce=G(Y);return z===6?X(Ce):z===-1?te(Ce):Q(Ce,ne)}const O=Math.floor,M=86400;function V(Y,z){let ne=null;if(Array.isArray(Y)){const[Ce,Ve,Ke,Pe,Be,me]=Y;ne=Date.UTC(Ce,Ve==null?0:Ve-1,Ke??1,Pe||0,Be||0,me||0)}else if(Y instanceof Date&&(ne=1*Y,!z||!z.ignoreTimezone)){const Ce=new Date;Ce.setUTCFullYear(Y.getFullYear(),Y.getMonth(),Y.getDate()),Ce.setUTCHours(Y.getHours(),Y.getMinutes(),Y.getSeconds(),Y.getMilliseconds()),ne=1*Ce}if(ne!=null&&isFinite(ne)){const Ce=ne/864e5;return Ce-(Ce<=-25509?-25568:-25569)}return Y}function q(Y,z){let ne=0|Y;const Ce=M*(Y-ne);let Ve=O(Ce);Ce-Ve>.9999&&(Ve+=1,Ve===M&&(Ve=0,ne+=1));const Ke=Ve<0?M+Ve:Ve,[Pe,Be,me]=x(Y,0,z&&z.leap1900),De=O(Ke/60/60)%60,Ne=O(Ke/60)%60,be=O(Ke)%60;if(z&&z.nativeDate){const ft=new Date(0);return ft.setUTCFullYear(Pe,Be-1,me),ft.setUTCHours(De,Ne,be),ft}return[Pe,Be,me,De,Ne,be]}function ie(Y){return!!(Y[0]&&Y[0].percent||Y[1]&&Y[1].percent||Y[2]&&Y[2].percent||Y[3]&&Y[3].percent)}function ce(Y){return!!(Y[0]&&Y[0].date||Y[1]&&Y[1].date||Y[2]&&Y[2].date||Y[3]&&Y[3].date)}function pe(Y){const[z,ne,Ce,Ve]=Y;return!(z&&!z.generated||ne&&!ne.generated||Ce&&!Ce.generated||!Ve||!Ve.text||Ve.generated)}const oe={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},he=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]],fe={total:1,sign:0,period:0,int:1,frac:0},ve=(Y,z)=>Y.replace(/\./,z.decimal);function Ue(Y,z,ne,Ce){const Ve=0|ne;if(typeof ne=="string")Y.push(ne);else if(ne===Ve)Y.push(Math.abs(Ve));else{const Ke=Math.abs(ne);let Pe=Ke?Math.floor(Math.log10(Ke)):0,Be=Pe<0?Ke*10**-Pe:Ke/10**Pe;Be===10&&(Be=1,Pe++);const me=function(Ne){let be=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];const ft=Math.abs(Ne);if(!ft)return fe;const Ze=be&&Ne<0?1:0,st=Math.floor(ft),Me=Math.floor(Math.log10(ft)+1);let Le=0,Je=0;if(st!==ft){Le=1;const Xe=String(h(Me<0?ft*10**-Me:ft/10**Me,15));let Et=Xe.length,wt=!0,Cn=0;for(;Cn<=Xe.length;){if(Xe[Cn]==="."){Et--;break}Xe[Cn]==="0"&&wt?Et--:wt=!1,Cn++}Je=Et-Me,Je<0&&(Je=0,Le=0)}return{total:Ze+Math.max(Me,1)+Le+Je,digits:Math.max(Me,0)+Je,sign:Ze,period:Le,int:Math.max(Me,1),frac:Je}}(Ke),De=()=>{const Ne=Math.abs(Pe);let be;be=Be===1?Be:h(Be,5),Y.push(ve(be+"",Ce),Ce.exponent,Pe<0?Ce.negative:Ce.positive,Ne<10?"0":"",Ne)};if(Pe>=-4&&Pe<=-1){const Ne=Ke.toPrecision(10+Pe).replace(/\.?0+$/,"");Y.push(ve(Ne,Ce))}else if(Pe===10){const Ne=Ke.toFixed(10).slice(0,12).replace(/\.$/,"");Y.push(ve(Ne,Ce))}else if(Math.abs(Pe)<=9)if(me.total<=11){const Ne=h(Ke,9).toFixed(me.frac);Y.push(ve(Ne,Ce))}else Pe===9?Y.push(Math.floor(Ke)):Pe>=0&&Pe<9?Y.push(h(Ke,9-Pe)):De();else me.total>=12?De():Math.floor(Ke)===Ke?Y.push(Math.floor(Ke)):Y.push(ve(h(Ke,9).toFixed(me.frac),Ce))}return Y}const ke=86400,Te={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},Re=function(Y){let z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const ne=Math.floor(Math.log10(Y));return z>1?Math.floor(ne/z)*z:ne};function rt(Y,z,ne,Ce){let Ve="",Ke="",Pe="",Be="",me="",De=0,Ne=0|Y,be=0,ft=0,Ze=1,st=0,Me=0,Le=0,Je=0,Xe=0,Et=0;const wt=Ce||f;if(!z.text&&isFinite(z.scale)&&z.scale!==1&&(Y=function(tn){if(tn===0)return tn;const at=Math.ceil(Math.log10(tn<0?-tn:tn)),xe=10**(16-Math.floor(at));return Math.round(tn*xe)/xe}(Y*z.scale)),z.exponential){let tn=Math.abs(Y);if(tn){const at=10**-Re(tn,z.int_max),xe=h(tn*at,z.frac_max)/at;De=Re(xe,z.int_max)}tn/=10**De,Y=Y<0?-tn:tn,Ve+=Math.abs(De)}if(z.integer){const tn=Math.abs(h(Y,z.fractions?1:z.frac_max));me+=tn<1?"":Math.floor(tn)}if(z.grouping){let tn="",at=me.length;for(at>z.group_pri&&(at-=z.group_pri,tn=wt.group+me.slice(at,at+z.group_pri)+tn);at>z.group_sec;)at-=z.group_sec,tn=wt.group+me.slice(at,at+z.group_sec)+tn;me=at?me.slice(0,at)+tn:tn}z.dec_fractions&&(Be=String(h(Y,z.frac_max)).split(".")[1]||"");let Cn=!1;if(z.fractions){const tn=Math.abs(z.integer?Y%1:Y);if(tn)if(Cn=!0,isFinite(z.denominator))Pe+=z.denominator,Ke+=h(tn*z.denominator),Ke==="0"&&(Ke="",Pe="",Cn=!1,me||(me="0"));else{const at=p(tn,z.integer?z.num_max:1/0,z.den_max);Ke+=at[0],Pe+=at[1],z.integer&&Ke==="0"&&(me||(me="0"),Ke="",Pe="",Cn=!1)}}if(z.date){Ne=Math.trunc(Y);const tn=ke*(Y-Ne);if(be=Math.floor(tn),Et=tn-be,Math.abs(Et)<1e-6?Et=0:Et>.9999&&(Et=0,be+=1,be===ke&&(be=0,Ne+=1)),Et){const at=512&z.date||256&z.date||128&z.date;(at===512&&Et>.9995||at===256&&Et>.995||at===128&&Et>.95||!at&&Et>=.5)&&(be++,Et=0)}if(Ne||z.date_system){const at=x(Y,z.date_system,ne.leap1900);ft=at[0],Ze=at[1],st=at[2]}if(be){const at=be<0?ke+be:be;Xe=Math.floor(at)%60,Je=Math.floor(at/60)%60,Le=Math.floor(at/60/60)%60}if(Me=(6+Ne)%7,z.date_eval&&(jn=Y,nr=Ne+be/ke,ne.dateSpanLarge?jn<-694324||nr>=35830291:jn<0||nr>=2958466)){if(ne.dateErrorThrows)throw new Error("Date out of bounds");return ne.dateErrorNumber?Ue(Y<0?[wt.negative]:[],0,Y,wt).join(""):ne.overflow}}var jn,nr;if(z.int_padding&&(me=z.int_padding.length===1?me||z.int_padding:z.int_padding.substring(0,z.int_padding.length-me.length)+me),z.num_padding&&(Ke=z.num_padding.length===1?Ke||z.num_padding:z.num_padding.substring(0,z.num_padding.length-Ke.length)+Ke),z.den_padding&&(Pe=z.den_padding.length===1?Pe||z.den_padding:Pe+z.den_padding.slice(Pe.length)),z.man_padding){const tn=z.exp_plus?"+":"";Ve=z.man_padding.length===1?(De<0?"-":tn)+(Ve||z.man_padding):(De<0?"-":tn)+z.man_padding.slice(0,z.man_padding.length-Ve.length)+Ve}const St=[];let Ln=0;const Yn={int:0,frac:0,man:0,num:0,den:0};for(let tn=0,at=z.tokens.length;tn<at;tn++){const xe=z.tokens[tn],An=xe.num?xe.num.length:0;if(xe.type==="string")xe.rule?xe.rule==="num"?Cn?St.push(xe.value):(z.num_min>0||z.den_min>0)&&St.push(xe.value.replace(/./g,C["?"])):xe.rule==="num+int"?Cn&&me?St.push(xe.value):z.den_min>0&&(me||z.num_min)&&St.push(xe.value.replace(/./g,C["?"])):xe.rule==="den"&&(Cn?St.push(xe.value):(z.den_min>0||z.den_min>0)&&St.push(xe.value.replace(/./g,C["?"]))):St.push(xe.value);else if(xe.type==="error")St.push(ne.invalid);else if(xe.type==="point")St.push(z.date?xe.value:wt.decimal);else if(xe.type==="general")Ue(St,0,Y,wt);else if(xe.type==="exp")St.push(wt.exponent);else if(xe.type==="minus")xe.volatile&&z.date||xe.volatile&&(Y>=0||typeof Y!="number")||(xe.volatile&&!z.fractions&&(z.integer||z.dec_fractions)?(Y<0&&me&&me!=="0"||Be)&&St.push(wt.negative):St.push(wt.negative));else if(xe.type==="plus")St.push(wt.positive);else if(xe.type==="text")St.push(Y);else if(xe.type==="div")Cn?St.push("/"):z.num_min>0||z.den_min>0?St.push(C["?"]):St.push(C["#"]);else if(xe.type==="int")if(z.int_pattern.length===1)St.push(me);else{const vn=Ln?z.int_pattern.join("").length-Yn.int:1/0,Rr=Ln===z.int_pattern.length-1?0:z.int_pattern.join("").length-(Yn.int+xe.num.length);St.push(me.substring(me.length-vn,me.length-Rr)),Ln++,Yn.int+=xe.num.length}else if(xe.type==="frac"){const vn=Yn.frac;for(let Rr=0;Rr<An;Rr++)St.push(Be[Rr+vn]||C[xe.num[Rr]]);Yn.frac+=An}else if(xe.type in Te)z[xe.type+"_pattern"].length===1?(xe.type==="int"&&St.push(me),xe.type==="frac"&&St.push(Be),xe.type==="man"&&St.push(Ve),xe.type==="num"&&St.push(Ke),xe.type==="den"&&St.push(Pe)):(St.push(Te[xe.type].slice(Yn[xe.type],Yn[xe.type]+An)),Yn[xe.type]+=An);else if(xe.type==="year")ft<0&&St.push(wt.negative),St.push(String(Math.abs(ft)).padStart(4,"0"));else if(xe.type==="year-short"){const vn=ft%100;St.push(vn<10?"0":"",vn)}else if(xe.type==="month")St.push(xe.pad&&Ze<10?"0":"",Ze);else if(xe.type==="monthname-single")z.date_system===6?St.push(wt.mmmm6[Ze-1].charAt(0)):St.push(wt.mmmm[Ze-1].charAt(0));else if(xe.type==="monthname-short")z.date_system===6?St.push(wt.mmm6[Ze-1]):St.push(wt.mmm[Ze-1]);else if(xe.type==="monthname")z.date_system===6?St.push(wt.mmmm6[Ze-1]):St.push(wt.mmmm[Ze-1]);else if(xe.type==="weekday-short")St.push(wt.ddd[Me]);else if(xe.type==="weekday")St.push(wt.dddd[Me]);else if(xe.type==="day")St.push(xe.pad&&st<10?"0":"",st);else if(xe.type==="hour"){const vn=Le%z.clock||(z.clock<24?z.clock:0);St.push(xe.pad&&vn<10?"0":"",vn)}else if(xe.type==="min")St.push(xe.pad&&Je<10?"0":"",Je);else if(xe.type==="sec")St.push(xe.pad&&Xe<10?"0":"",Xe);else if(xe.type==="subsec"){St.push(wt.decimal);const vn=Et.toFixed(z.sec_decimals);St.push(vn.slice(2,2+xe.decimals))}else if(xe.type==="am"){const vn=Le<12?0:1;xe.short&&!Ce?St.push("AP"[vn]):St.push(wt.ampm[vn])}else if(xe.type==="hour-elap"){Y<0&&St.push(wt.negative);const vn=24*Ne+Math.floor(Math.abs(be)/3600);St.push(String(Math.abs(vn)).padStart(xe.pad,"0"))}else if(xe.type==="min-elap"){Y<0&&St.push(wt.negative);const vn=1440*Ne+Math.floor(Math.abs(be)/60);St.push(String(Math.abs(vn)).padStart(xe.pad,"0"))}else if(xe.type==="sec-elap"){Y<0&&St.push(wt.negative);const vn=Ne*ke+Math.abs(be);St.push(String(Math.abs(vn)).padStart(xe.pad,"0"))}else if(xe.type==="b-year")St.push(ft+543);else if(xe.type==="b-year-short"){const vn=(ft+543)%100;St.push(vn<10?"0":"",vn)}}return ne.nbsp?St.join(""):St.join("").replace(/\u00a0/g," ")}function _t(Y,z){for(let ne=0;ne<3;ne++){const Ce=z[ne];if(Ce){let Ve;if(Ce.condition){const Ke=Ce.condition[0],Pe=Ce.condition[1];Ke==="="?Ve=Y===Pe:Ke===">"?Ve=Y>Pe:Ke==="<"?Ve=Y<Pe:Ke===">="?Ve=Y>=Pe:Ke==="<="?Ve=Y<=Pe:Ke==="<>"&&(Ve=Y!==Pe)}else Ve=!0;if(Ve)return Ce}}}const mt=N("@"),nt="black",_e={};function He(Y,z){if(Y){const ne=Y[0];z[ne]=z[ne]||{},He(Y.slice(1),z[ne])}else z.$=!0}["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"].forEach(Y=>{He(Y,_e),He(Y+" x",_e),He(Y+" l",_e),He(Y+" l x",_e),He("l "+Y,_e),He("l "+Y+" x",_e),He(Y+" D",_e),He(Y+" D x",_e),He("D "+Y,_e),He("D "+Y+" x",_e)});const et={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},Dt={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},Mt={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},Bt=new Date().getUTCFullYear();function Zt(Y){const z=new RegExp("^([\\s+%"+y.join("")+"(-]*)(((?:(?:\\d[\\d,]*)(?:\\.\\d*)?|(?:\\.\\d+)))([eE][+-]?\\d+)?)([\\s%"+y.join("")+")]*)$").exec(Y);if(z){const[,ne,Ce,Ve,Ke,Pe]=z;let Be=1,me="",De=!1,Ne=!1,be=!1,ft=!1,Ze=!1,st=null,Me=!1,Le=parseFloat(Ce.replace(/,/g,""));if(!isFinite(Le))return null;for(let Xe=0;Xe<ne.length;Xe++){const Et=ne[Xe];if(Et==="-"){if(De||Ne)return null;De=!0,Be=-1}else if(D.test(Et)){if(Ze)return null;Ze=!0,st=Et}else if(Et==="("){if(Ne||De)return null;Ne=!0,Be=-1}else if(Et==="%"){if(ft)return null;ft=!0}}for(let Xe=0;Xe<Pe.length;Xe++){const Et=Pe[Xe];if(D.test(Et)){if(Ze)return null;Ze=!0,st=Et,Me=!0}else if(Et===")"){if(be||!Ne)return null;be=!0}else if(Et==="%"){if(ft)return null;ft=!0}}if(Ke){if(ft||Ze)return null;me="0.00E+00"}else if(ft){if(Ze)return null;me=Ve.includes(".")?"0.00%":"0%",Le*=.01}else if(Ze){const Xe=Ve.includes(".")?"#,##0.00":"#,##0";me=Me?Xe+st:st+Xe}else Ve.includes(",")&&(me=Ve.includes(".")?"#,##0.00":"#,##0");const Je={v:Le*Be};return me&&(Je.z=me),Je}}const It=(Y,z,ne)=>{const Ce=ne.path||"",Ve=Object.keys(z);for(let Ke=0;Ke<Ve.length;Ke++){let Pe;const Be=Ve[Ke];if(z[Be]){if(Be==="$"||Be==="€")Y||(Pe=ne);else if(Be==="-"){const me=/^(\s*([./-]|,\s)\s*|\s+)/.exec(Y);if(me){const De=me[1]==="-"||me[1]==="/"||me[1]==="."?me[1]:" ";if(!ne.sep||ne.sep===De){const Ne=me[0].replace(/\s+/g," ");Pe=It(Y.slice(me[0].length),z[Be],{...ne,sep:De,path:Ce+Ne})}}}else if(Be===" "){const me=/^[,.]?\s+/.exec(Y);if(me){const De=me[0].replace(/\s+/g," ");Pe=It(Y.slice(me[0].length),z[Be],{...ne,path:Ce+De})}}else if(Be==="j"||Be==="d"){const me=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(Y);me&&(Pe=It(Y.slice(me[0].length),z[Be],{...ne,day:me[0],path:Ce+Be}))}else if(Be==="n"||Be==="m"){const me=/^(0?[1-9]|1[012])\b/.exec(Y);me&&(Pe=It(Y.slice(me[0].length),z[Be],{...ne,month:+me[0],_mon:me[0],path:Ce+Be}))}else if(Be==="F"||Be==="M"){const me=/^([a-z]{3,9})\b/i.exec(Y),De=me&&(Be==="F"?Dt:et)[me[0].toLowerCase()];De&&(Pe=It(Y.slice(me[0].length),z[Be],{...ne,month:De,_mon:me[0],path:Ce+Be}))}else if(Be==="l"||Be==="D"){const me=/^([a-z]{3,9})\b/i.exec(Y);(me&&Mt[me[0].toLowerCase()])===Be&&(Pe=It(Y.slice(me[0].length),z[Be],{...ne,path:Ce+Be}))}else if(Be==="y"){const me=/^\d\d\b/.exec(Y);if(me){const De=+me[0]>=30?+me[0]+1900:+me[0]+2e3;Pe=It(Y.slice(me[0].length),z[Be],{...ne,year:De,path:Ce+Be})}}else if(Be==="Y"){const me=/^\d\d\d\d\b/.exec(Y);me&&(Pe=It(Y.slice(me[0].length),z[Be],{...ne,year:+me[0],path:Ce+Be}))}else{if(Be!=="x")throw new Error('Unknown date token "'.concat(Be,'"'));{const me=yn(Y);me&&(Pe=It("",z[Be],{...ne,time:me.v,tf:me.z,path:Ce+Be}))}}if(Pe)return Pe}}};function pn(Y,z){const ne=It(Y.trim(),_e,{path:""});if(ne){var Ce;if(ne.sep==="."&&ne.path.length===3)return null;const Ve=+((Ce=ne.year)!==null&&Ce!==void 0?Ce:Bt);if(ne.day||(ne.day=1),!function(Be,me,De){if(De<1||me<1||me>12)return!1;if(me===2){if(De>(Be%4==0&&Be%100!=0||Be%400==0||Be===1900?29:28))return!1}else if((me===4||me===6||me===9||me===11)&&De>30||(me===1||me===3||me===5||me===7||me===8||me===10||me===12)&&De>31)return!1;return!0}(Ve,ne.month,ne.day))return null;let Ke=-1/0;if(Ve<1900)return null;Ve<=1900&&ne.month<=2?Ke=25568:Ve<1e4&&(Ke=25569);const Pe=Date.UTC(Ve,ne.month-1,ne.day)/864e5+Ke+(ne.time||0);if(Pe>=0&&Pe<=2958465){const Be=ne._mon[0]==="0"||ne.day[0]==="0"||ne._mon.length===2&&ne.day.length===2,me=ne.path.replace(/[jdlDnmMFyYx-]/g,De=>De==="j"||De==="d"?Be?"dd":"d":De==="D"?"ddd":De==="l"?"dddd":De==="n"||De==="m"?Be?"mm":"m":De==="M"?"mmm":De==="F"?"mmmm":De==="y"?"yy":De==="x"?ne.tf||"":De==="Y"?"yyyy":De);return z&&z.nativeDate?{v:q(Pe,z),z:me}:{v:Pe,z:me}}}return null}function yn(Y){const z=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(Y);if(z){const[,ne,Ce,Ve,Ke,Pe]=z;if(Ke&&!Ve||!Pe&&!Ce&&!Ve)return null;let Be=1*(ne||0);if(Pe){if(Be>=13)return null;Pe[0]!=="p"&&Pe[0]!=="P"||(Be+=12)}return{v:(60*Be*60+60*(1*(Ce||0))+1*(Ve||0)+1*(Ke||0))/86400,z:(ne.length===2?"hh":"h")+":mm"+(Ve?":ss":"")+(Pe?" AM/PM":"")}}return null}function $t(Y){return/^\s*true\s*$/i.test(Y)?{v:!0}:/^\s*false\s*$/i.test(Y)?{v:!1}:null}const Ht={};function Nt(Y,z){const{pattern:ne,partitions:Ce,locale:Ve}=Y,Ke=me=>{const De=Object.assign({},b(),z,me);return Ve&&(De.locale=Ve),De},Pe=(me,De)=>{const Ne=Ke(De);return function(be,ft,Ze){const st=c(Ze.locale),Me=ft[3]?ft[3]:mt;if(typeof be=="boolean"&&(be=be?"TRUE":"FALSE"),be==null)return"";if(typeof be!="number")return rt(be,Me,Ze,st);if(!isFinite(be)){const Je=st||f;return isNaN(be)?Je.nan:(be<0?Je.negative:"")+Je.infinity}const Le=_t(be,ft);return Le?rt(be,Le,Ze,st):Ze.overflow}(V(me,Ne),Ce,Ne)};Pe.color=(me,De)=>function(Ne,be){if(typeof Ne!="number"||!isFinite(Ne))return(be[3]?be[3].color:mt.color)||nt;const ft=_t(Ne,be);return ft&&ft.color||nt}(V(me,Ke(De)),Ce);const Be=function(me){var De;let Ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const[be,ft]=me,Ze=be.frac_max,st={type:"general",isDate:ce(me),isText:pe(me),isPercent:ie(me),maxDecimals:be.general?9:Ze,scale:(De=be.scale)!==null&&De!==void 0?De:1,color:0,parentheses:0,grouped:be.grouping?1:0,_partitions:me},Me=!st.isDate&&!st.isText&&!be.error&&be.tokens.some(wt=>wt.type==="string"&&(Ne?wt.value===Ne:D.test(wt.value)));let Le="G",Je=Ze>=0?Math.min(15,Ze):"",Xe="",Et="";if(ft&&ft.color&&(Et="-",st.color=1),be.parens&&(Xe="()",st.parentheses=1),Me)Le="C",st.type="currency";else if(be.error)st.type="error",st.maxDecimals=0;else if(st.isDate){let wt=0,Cn=0,jn="";be.tokens.forEach(St=>{const Ln=St.type;/^(b-)?year/.test(Ln)?(jn+="Y",Cn++):Ln.startsWith("month")?(jn+="M",Cn++):/^(week)?day/.test(Ln)?(jn+="D",Cn++):Ln!=="hour"&&Ln!=="min"&&Ln!=="sec"&&Ln!=="am"||(jn+=Ln[0],wt++)}),st.type="date",Cn&&wt?st.type="datetime":!Cn&&wt&&(st.type="time");const nr=he.find(St=>jn.startsWith(St[0]));Le=nr?"D":"G",Je=nr?nr[1]:""}else st.isText?(Le="G",st.type="text",Je="",st.maxDecimals=0):be.general?(Le="G",st.type="general",Je=""):be.fractions?(Le="G",st.type="fraction",Je=""):be.exponential?(Le="S",st.type="scientific"):st.isPercent?(Le="P",st.type="percent"):be.grouping?(Le=",",st.type="grouped"):(be.int_max||Ze)&&(Le="F",st.type="number");return st.code=Le+Je+Et+Xe,st.level=oe[st.type],Object.freeze(st)}(Ce,(z||{}).currency)||new SyntaxError;return Pe.info=Be,Pe.dateInfo=function(me){const[De]=me;return{year:!!(2&De.date),month:!!(4&De.date),day:!!(8&De.date),hours:!!(16&De.date),minutes:!!(32&De.date),seconds:!!(64&De.date),clockType:De.clock===12?12:24}}(Ce),Pe.isPercent=()=>!!Be.isPercent,Pe.isDate=()=>!!Be.isDate,Pe.isText=()=>!!Be.isText,Pe.pattern=ne,Y.error&&(Pe.error=Y.error),Pe.options=Ke,Pe.locale=Ve||z&&z.locale||"",Object.freeze(Pe)}function Ot(Y,z){Y||(Y="General");let ne=null;return Ht[Y]?ne=Ht[Y]:(ne=Object.assign({},b(),z).throws?W(Y):function(Ce){try{return W(Ce)}catch(Ve){const Ke={tokens:[{type:"error"}],error:Ve.message};return{pattern:Ce,partitions:[Ke,Ke,Ke,Ke],error:Ve.message,locale:null}}}(Y),ne.error||(Ht[Y]=ne)),Nt(ne,z)}Ot.isDate=Y=>Ot(Y,{throws:!1}).isDate(),Ot.isPercent=Y=>Ot(Y,{throws:!1}).isPercent(),Ot.isText=Y=>Ot(Y,{throws:!1}).isText(),Ot.getInfo=(Y,z)=>Ot(Y,{...z,throws:!1}).info,Ot.getDateInfo=(Y,z)=>Ot(Y,{...z,throws:!1}).dateInfo,Ot.dateToSerial=V,Ot.dateFromSerial=q,Ot.options=b,Ot.dec2frac=p,Ot.round=h,Ot.codeToLocale=i,Ot.parseLocale=u,Ot.getLocale=c,Ot.addLocale=(Y,z)=>{const ne=u(z);return delete Ht[ne.lang],delete Ht[ne.language],m(Y,ne)},Ot.format=function(Y,z,ne){let Ce=arguments.length>3&&arguments[3]!==void 0&&arguments[3];const Ve=ne&&typeof ne=="object"?ne:{locale:ne,throws:!Ce};return Ot(Y,Ve)(V(z,Ve),Ve)},Ot.is_date=Ot.isDate,Ot.parseNumber=Zt,Ot.parseDate=pn,Ot.parseTime=yn,Ot.parseBool=$t,Ot.parseValue=function(Y,z){var ne,Ce,Ve;return(ne=(Ce=(Ve=Zt(Y))!==null&&Ve!==void 0?Ve:pn(Y,z))!==null&&Ce!==void 0?Ce:yn(Y))!==null&&ne!==void 0?ne:$t(Y)};var En=Ot;return r=r.default}()})})(_V);var DMe=_V.exports,RMe=DMe;const Ns=yMe(RMe);var IMe=Object.defineProperty,AMe=(t,e,n)=>e in t?IMe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,H=(t,e,n)=>(AMe(t,typeof e!="symbol"?e+"":e,n),n);const TMe="SheetUI";function bc(t,e){if(t==null)return;const n=e.getRenderById(t);if(n==null)return;const{mainComponent:r,scene:i,engine:o}=n;return{document:r,scene:i,engine:o}}const G_={零:0,一:1,二:2,三:3,四:4,五:5,六:6,七:7,八:8,九:9},V9=["零","一","二","三","四","五","六","七","八","九"],PT=["","万","亿","万亿","亿亿"],wMe=["","十","百","千"],CV={十:{value:10,secUnit:!1},百:{value:100,secUnit:!1},千:{value:1e3,secUnit:!1},万:{value:1e4,secUnit:!0},亿:{value:1e8,secUnit:!0}};function $1(t){if(!t)return 0;let e=0,n=0,r=0,i=!1;const o=t.split("");for(let a=0;a<o.length;a++){const s=G_[o[a]];if(typeof s<"u")r=s,a===o.length-1&&(n+=r);else{const u=CV[o[a]],l=u.value;i=u.secUnit,i?(n=(n+r)*l,e+=n,n=0):n+=r*l,r=0}}return e+n}function LMe(t){let e="",n="",r=0,i=!0;for(;t>0;){const o=t%10;o===0?i||(i=!0,n=V9[o]+n):(i=!1,e=V9[o],e+=wMe[r],n=e+n),r++,t=Math.floor(t/10)}return n}function OMe(t){let e=0,n="",r="",i=!1;if(t===0)return V9[0];for(;t>0;){const o=t%1e4;i&&(r=V9[0]+r),n=LMe(o),n+=o!==0?PT[e]:PT[0],r=n+r,i=o<1e3&&o>0,t=Math.floor(t/1e4),e++}return r}function PMe(t){if(!t)return!1;let e=!0;if(t)if(t.length===1)t==="日"||t in G_?e=!0:e=!1;else{const n=t.split("");for(let r=0;r<n.length;r++)if(!(n[r]in G_||n[r]in CV)){e=!1;break}}return e}function K3(t){if(!t)return{isExtendNumber:!1};const e=/0|([1-9]+[0-9]*)/g,n=e.test(t);if(n){const r=t.match(e);if(r&&r.length>0){const i=r[r.length-1],o=t.lastIndexOf(i),a=t.substr(0,o),s=t.substr(o+i.length);return{isExtendNumber:!0,matchTxt:Number(i),beforeTxt:a,afterTxt:s}}return{isExtendNumber:!1}}return{isExtendNumber:n}}function MMe(t){let e;return t.length===2&&(t==="周一"||t==="周二"||t==="周三"||t==="周四"||t==="周五"||t==="周六"||t==="周日")?e=!0:e=!1,e}function NMe(t){let e;return t.length===3&&(t==="星期一"||t==="星期二"||t==="星期三"||t==="星期四"||t==="星期五"||t==="星期六"||t==="星期日")?e=!0:e=!1,e}function xMe(t,e){let n=0;for(let r=0;r<t.length&&t[r]<e;r++)n++;return n}function xf(t){let e=!0;const n=t[1]-t[0];for(let r=1;r<t.length;r++)if(t[r]-t[r-1]!==n){e=!1;break}return e}function FMe(t,e,n){const r=[],i=Math.floor(e/t),o=e%t;let a=0;if(i>0){for(let s=0;s<i;s++)for(let u=0;u<n.length;u++)r[n[u]+s*t]=a,a++;for(let s=0;s<n.length&&n[s]<o;s++)r[n[s]+t*i]=a,a++}else for(let s=0;s<n.length&&n[s]<o;s++)r[n[s]]=a,a++;return r}function Vc(t,e){const n=[];for(let r=1;r<=e;r++){const i=(r-1)%t.length,o=Ie.deepClone(t[i]);n.push({v:null,s:null,p:null,f:null,si:null,t:null,...o})}return n}function $Me(t,e){var n;const r=[];for(let i=1;i<=e;i++){const o=(i-1)%t.length,a={s:(n=t[o])==null?void 0:n.s};r.push(a)}return r}function kMe(t){let e=!0;const n=t[1]/t[0];for(let r=1;r<t.length;r++)if(t[r]/t[r-1]!==n){e=!1;break}return e}function BMe(t){const e=[];for(let n=1;n<=t;n++)e.push(n);return e}function MT(t,e,n){var r,i,o,a;const s=[],u=[];for(let l=0;l<t.length;l++)u.push(Number((r=t[l])==null?void 0:r.v));if(t.length>2&&kMe(u))for(let l=1;l<=e;l++){const c=(l-1)%t.length,d=Ie.deepClone(t[c]),m=Number((i=t[t.length-1])==null?void 0:i.v)*(Number((o=t[1])==null?void 0:o.v)/Number((a=t[0])==null?void 0:a.v))**l;d&&(d.v=m,s.push(d))}else{const l=BMe(t.length);for(let c=1;c<=e;c++){const d=(c-1)%t.length,m=Ie.deepClone(t[d]),f=n===ye.DOWN||n===ye.RIGHT,h=UMe(t.length+c,u,l,f);m&&(m.v=h,s.push(m))}}return s}function UMe(t,e,n,r=!0){function i(d){let m=0;for(let f=0;f<d.length;f++)m+=d[f];return m/d.length}const o=i(n),a=i(e);let s=0,u=0;for(let d=0;d<n.length;d++)s+=(n[d]-o)*(e[d]-a),u+=(n[d]-o)*(n[d]-o);let l;u===0?l=r?1:-1:l=s/u;const c=a-l*o;return Math.round((c+l*t)*1e5)/1e5}function NT(t,e,n){var r;const i=[],o=/0|([1-9]+[0-9]*)/g;for(let a=1;a<=e;a++){const s=(a-1)%t.length,u=Ie.deepClone(t[s]),l=`${(r=t[t.length-1])==null?void 0:r.v}`,c=l==null?void 0:l.match(o),d=c==null?void 0:c[c.length-1],m=Math.abs(Number(d)+n*a);if(!l||!d)continue;const f=l.lastIndexOf(d),h=l.substr(0,f)+m.toString()+l.substr(f+d.length);u&&(u.v=h,i.push(u))}return i}function H0(t,e,n,r=0){var i,o;const a=[["日","一","二","三","四","五","六"],["周日","周一","周二","周三","周四","周五","周六"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]];if(r>=a.length)return[];const s=a[r],u=[];for(let l=1;l<=e;l++){const c=(l-1)%t.length,d=Ie.deepClone(t[c]);let m=0;if(((i=t[t.length-1])==null?void 0:i.v)===s[0])m=7+n*l;else{const h=`${(o=t[t.length-1])==null?void 0:o.v}`;if(h){const p=h.substr(h.length-1,1);m=$1(p)+n*l}}m<0&&(m=Math.ceil(Math.abs(m)/7)*7+m);const f=m%7;d&&(d.v=s[f],u.push(d))}return u}function xT(t,e,n){var r;const i=[];for(let o=1;o<=e;o++){const a=(o-1)%t.length,s=Ie.deepClone(t[a]),u=`${(r=t[t.length-1])==null?void 0:r.v}`,l=$1(u)+n*o;let c;l<=0?c="零":c=OMe(l),s&&(s.v=c,i.push(s))}return i}const Q6={enWeek1:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],enWeek2:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],enMonth1:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],enMonth2:["January","February","March","April","May","June","July","August","September","October","November","December"],chnMonth1:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],chnMonth2:["正月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","腊月"],chHour1:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],chHour2:["子时","丑时","寅时","卯时","辰时","巳时","午时","未时","申时","酉时","戌时","亥时"],chYear1:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],chSeason1:["春","夏","秋","冬"],chSeason2:["春季","夏季","秋季","冬季"]};function VMe(t){let e=!1;return Object.keys(Q6).forEach(n=>{Q6[n].includes(t)&&(e=!0)}),e}function Ug(t){let e="";const n=[];return Object.keys(Q6).forEach(r=>{Q6[r].includes(t)&&(e=r,n.push(...Q6[r]))}),{name:e,series:n}}function FT(t,e,n,r){var i;const o=r.length,a=[];for(let s=1;s<=e;s++){const u=(s-1)%t.length,l=Ie.deepClone(t[u]),c=`${(i=t[t.length-1])==null?void 0:i.v}`;let d=r.indexOf(c)+n*s;d<0&&(d+=Math.abs(n)*o);const m=d%o;l&&(l.v=r[m],a.push(l))}return a}function HMe(t,e){const n=[];let r;if(e.startRow<t.startRow)r=ye.UP;else if(e.endRow>t.endRow)r=ye.DOWN;else if(e.startColumn<t.startColumn)r=ye.LEFT;else if(e.endColumn>t.endColumn)r=ye.RIGHT;else return[];if(r===ye.DOWN||r===ye.UP){const i=t.endRow-t.startRow+1,o=e.endRow-e.startRow+1,a=Math.floor(o/i),s=o%i,u={startRow:0,startColumn:0,endRow:t.endRow-t.startRow,endColumn:t.endColumn-t.startColumn};if(r===ye.DOWN){for(let l=0;l<a;l++)n.push({repeatStartCell:{row:t.startRow+(l+1)*i,col:t.startColumn},relativeRange:u});s>0&&n.push({repeatStartCell:{row:t.startRow+(a+1)*i,col:t.startColumn},relativeRange:{startRow:0,startColumn:0,endRow:s-1,endColumn:t.endColumn-t.startColumn}})}else{for(let l=0;l<a;l++)n.push({repeatStartCell:{row:t.startRow-(l+1)*i,col:t.startColumn},relativeRange:u});s>0&&n.push({repeatStartCell:{row:t.startRow-(a+1)*i,col:t.startColumn},relativeRange:{startRow:i-s,endRow:i-1,startColumn:0,endColumn:t.endColumn-t.startColumn}})}}if(r===ye.RIGHT||r===ye.LEFT){const i=t.endColumn-t.startColumn+1,o=e.endColumn-e.startColumn+1,a=Math.floor(o/i),s=o%i,u={startRow:0,startColumn:0,endRow:t.endRow-t.startRow,endColumn:t.endColumn-t.startColumn};if(r===ye.RIGHT){for(let l=0;l<a;l++)n.push({repeatStartCell:{row:t.startRow,col:t.startColumn+(l+1)*i},relativeRange:u});s>0&&n.push({repeatStartCell:{row:t.startRow,col:t.startColumn+(a+1)*i},relativeRange:{startRow:0,startColumn:0,endRow:t.endRow-t.startRow,endColumn:s-1}})}else{for(let l=0;l<a;l++)n.push({repeatStartCell:{row:t.startRow,col:t.startColumn-(l+1)*i},relativeRange:u});s>0&&n.push({repeatStartCell:{row:t.startRow,col:t.startColumn-(a+1)*i},relativeRange:{startRow:0,startColumn:i-s,endRow:t.endRow-t.startRow,endColumn:i-1}})}}return n}function SV(t){const e=new Ye;return t.forEach(n=>{const{startRow:r,startColumn:i,endRow:o,endColumn:a}=n;for(let s=r;s<=o;s++)for(let u=i;u<=a;u++)e.setValue(s,u,{v:null,p:null,f:null,si:null})}),e.getData()}const jMe={type:ue.COMMAND,id:"sheet.command.auto-fill",handler:async(t,e)=>!0},C7={id:"sheet.command.auto-clear-content",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(ae),r=t.get(se),i=t.get(en),o=n.getCurrentUniverSheetInstance(),a=o.getUnitId(),s=o.getActiveSheet().getSheetId(),{clearRange:u,selectionRange:l}=e,c={subUnitId:s,unitId:a,cellValue:SV([u])},d=ci(t,c);return r.executeCommand(_n.id,{selections:[{primary:{...l},range:{...l}}],unitId:a,subUnitId:s}),r.syncExecuteCommand(Vt.id,c)?(i.pushUndoRedo({unitID:a,undoMutations:[{id:Vt.id,params:d}],redoMutations:[{id:Vt.id,params:c}],undo(){return r.syncExecuteCommand(Vt.id,d)},redo(){return r.syncExecuteCommand(Vt.id,c)}}),!0):!1}};function ay(t){return t.getContextValue(qo)}function ar(t){return t.getContextValue(qo)&&t.getContextValue(nl)&&!t.getContextValue(Mr)}function EV(t){return t.getContextValue(qo)&&t.getContextValue(nl)&&t.getContextValue(Mr)}function zMe(t){return t.getContextValue(Mr)}function yV(t){return t.getContextValue(W1)&&t.getContextValue(nl)}function Ff(t){return t.getContextValue(qo)&&t.getContextValue(Mr)&&t.getContextValue(rc)&&t.getContextValue(nl)}function H9(t){return t.getContextValue(qo)&&t.getContextValue(Mr)&&!t.getContextValue(rc)}var ho=(t=>(t.MAIN="__SpreadsheetRender__",t.ROW="__SpreadsheetRowHeader__",t.COLUMN="__SpreadsheetColumnHeader__",t.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__",t))(ho||{}),Ft=(t=>(t.VIEW_MAIN="viewMain",t.VIEW_MAIN_LEFT_TOP="viewMainLeftTop",t.VIEW_MAIN_TOP="viewMainTop",t.VIEW_MAIN_LEFT="viewMainLeft",t.VIEW_ROW_TOP="viewRowTop",t.VIEW_ROW_BOTTOM="viewRowBottom",t.VIEW_COLUMN_LEFT="viewColumnLeft",t.VIEW_COLUMN_RIGHT="viewColumnRight",t.VIEW_LEFT_TOP="viewLeftTop",t))(Ft||{});const $T=0,El=2,WMe=3,K_=[10,400],kT=1001;var YMe=Object.defineProperty,XMe=Object.getOwnPropertyDescriptor,qMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?XMe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&YMe(e,n,i),i},BT=(t,e)=>(n,r)=>e(n,r,t);let Dr=class{constructor(t,e){H(this,"_currentSkeleton",{unitId:"",sheetId:""}),H(this,"_sheetSkeletonParam",[]),H(this,"_currentSkeleton$",new dn(null)),H(this,"currentSkeleton$",this._currentSkeleton$.asObservable()),H(this,"_currentSkeletonBefore$",new dn(null)),H(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable()),this._currentUniverService=t,this._localeService=e}dispose(){this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete(),this._sheetSkeletonParam=[]}getCurrent(){return this._getCurrentBySearch(this._currentSkeleton)}setCurrent(t){const e=this._getCurrentBySearch(t);if(e!=null)this._reCalculate(e);else{const{unitId:r,sheetId:i}=t,o=this._currentUniverService.getUniverSheetInstance(t.unitId),a=o==null?void 0:o.getSheetBySheetId(t.sheetId);if(a==null||o==null)return;const s=this._buildSkeleton(a,o);this._sheetSkeletonParam.push({unitId:r,sheetId:i,skeleton:s,dirty:!1})}this._currentSkeleton=t;const n=this.getCurrent();return this._currentSkeletonBefore$.next(n),this._currentSkeleton$.next(n),this.getCurrent()}reCalculate(){const t=this.getCurrent();t!=null&&this._reCalculate(t)}_reCalculate(t){t.dirty&&(t.skeleton.makeDirty(!0),t.dirty=!1),t.skeleton.calculate()}makeDirtyCurrent(t=!0){this.makeDirty(this._currentSkeleton,t)}makeDirty(t,e=!0){const n=this._getCurrentBySearch(t);n!=null&&(n.dirty=e)}getOrCreateSkeleton(t){const e=this._getCurrentBySearch(t);if(e)return e.skeleton;const n=this._currentUniverService.getUniverSheetInstance(t.unitId),r=n==null?void 0:n.getSheetBySheetId(t.sheetId);if(!r||!n)return;const i=this._buildSkeleton(r,n);return this._sheetSkeletonParam.push({unitId:t.unitId,sheetId:t.sheetId,skeleton:i,dirty:!1}),i}_getCurrentBySearch(t){const e=this._sheetSkeletonParam.find(n=>n.unitId===t.unitId&&n.sheetId===t.sheetId);return e!=null&&(e.commandId=t.commandId),e}_buildSkeleton(t,e){const n=t.getConfig();return e_e.create(t,n,t.getCellMatrix(),e.getStyles(),this._localeService)}};Dr=qMe([BT(0,ae),BT(1,K(Gt))],Dr);let GMe=class{constructor(){H(this,"_startColumn",-1),H(this,"_startRow",-1),H(this,"_endColumn",-1),H(this,"_endRow",-1),H(this,"_startX",0),H(this,"_startY",0),H(this,"_endX",0),H(this,"_endY",0),H(this,"_currentCell"),H(this,"_rangeType",ct.NORMAL)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get currentCell(){return this._currentCell}get rangeType(){return this._rangeType}isEqual(e){const{startColumn:n,startRow:r,endColumn:i,endRow:o}=this,{startColumn:a,startRow:s,endColumn:u,endRow:l}=e;return n===a&&r===s&&i===u&&o===l}isInclude(e){const{startColumn:n,startRow:r,endColumn:i,endRow:o}=this,{startColumn:a,startRow:s,endColumn:u,endRow:l}=e;return!(u<n||a>i||s>o||l<r)}highlightToSelection(){return xC(this._currentCell)}getRange(){return{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY,rangeType:this.rangeType}}getCell(){return this._currentCell}getRangeType(){return this._rangeType}getValue(){return{rangeWithCoord:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY,rangeType:this._rangeType},primaryWithCoord:this._currentCell}}setValue(e,n){const{startColumn:r,startRow:i,endColumn:o,endRow:a,startX:s,startY:u,endX:l,endY:c,rangeType:d}=e;this._startColumn=r,this._startRow=i,this._endColumn=o,this._endRow=a,this._startX=s,this._startY=u,this._endX=l,this._endY=c,d!=null&&(this._rangeType=d),this.setCurrentCell(n)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}};const UT=.3;let j9=class{constructor(e,n,r=!0,i){H(this,"_leftControl"),H(this,"_rightControl"),H(this,"_topControl"),H(this,"_bottomControl"),H(this,"_backgroundControlTop"),H(this,"_backgroundControlBottom"),H(this,"_backgroundControlMiddleLeft"),H(this,"_backgroundControlMiddleRight"),H(this,"_fillControl"),H(this,"_selectionShape"),H(this,"_rowHeaderBackground"),H(this,"_rowHeaderBorder"),H(this,"_rowHeaderGroup"),H(this,"_rowHeaderHighlight"),H(this,"_columnHeaderBackground"),H(this,"_columnHeaderBorder"),H(this,"_columnHeaderGroup"),H(this,"_columnHeaderHighlight"),H(this,"_topLeftWidget"),H(this,"_topCenterWidget"),H(this,"_topRightWidget"),H(this,"_middleLeftWidget"),H(this,"_middleRightWidget"),H(this,"_bottomLeftWidget"),H(this,"_bottomCenterWidget"),H(this,"_bottomRightWidget"),H(this,"_dashRect"),H(this,"_selectionModel"),H(this,"_selectionStyle"),H(this,"_rowHeaderWidth",0),H(this,"_columnHeaderHeight",0),H(this,"_widgetRects",[]),H(this,"_dispose$",new dn(this)),H(this,"dispose$",this._dispose$.asObservable()),H(this,"selectionMoving$",new an),H(this,"selectionMoved$",new an),H(this,"selectionScaling$",new an),H(this,"selectionScaled$",new an),H(this,"selectionFilling$",new an),H(this,"_selectionFilled$",new an),H(this,"selectionFilled$",this._selectionFilled$.asObservable()),H(this,"_defaultStyle"),H(this,"_currentStyle"),H(this,"_isHelperSelection",!0),H(this,"_antLineOffset",0),H(this,"_antRequestNewFrame",-1),this._scene=e,this._zIndex=n,this._isHeaderHighlight=r,this._themeService=i,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}get topLeftWidget(){return this._topLeftWidget}get topCenterWidget(){return this._topCenterWidget}get topRightWidget(){return this._topRightWidget}get middleLeftWidget(){return this._middleLeftWidget}get middleRightWidget(){return this._middleRightWidget}get bottomLeftWidget(){return this._bottomLeftWidget}get bottomCenterWidget(){return this._bottomCenterWidget}get bottomRightWidget(){return this._bottomRightWidget}get selectionStyle(){return this._selectionStyle}get dashRect(){return this._dashRect}get isHelperSelection(){return this._isHelperSelection}setEvent(e){this.leftControl.evented=e,this.rightControl.evented=e,this.topControl.evented=e,this.bottomControl.evented=e}enableHeaderHighlight(){this._isHelperSelection=!0}disableHeaderHighlight(){this._isHeaderHighlight=!1}refreshSelectionFilled(e){this._selectionFilled$.next(e)}updateStyle(e){this._updateControl(e,this._rowHeaderWidth,this._columnHeaderHeight)}update(e,n=0,r=0,i,o){this._selectionModel.setValue(e,o),i==null&&(i=this._selectionStyle),this._updateControl(i,n,r)}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl(this._selectionStyle,this._rowHeaderWidth,this._columnHeaderHeight)}getScene(){return this._scene}dispose(){var e,n,r,i,o,a,s,u,l,c,d,m,f,h,p,v,g,b,C,S,E,y,D,R,I;(e=this._leftControl)==null||e.dispose(),(n=this._rightControl)==null||n.dispose(),(r=this._topControl)==null||r.dispose(),(i=this._bottomControl)==null||i.dispose(),(o=this._backgroundControlTop)==null||o.dispose(),(a=this._backgroundControlMiddleLeft)==null||a.dispose(),(s=this._backgroundControlMiddleRight)==null||s.dispose(),(u=this._backgroundControlBottom)==null||u.dispose(),(l=this._fillControl)==null||l.dispose(),(c=this._selectionShape)==null||c.dispose(),(d=this._rowHeaderBackground)==null||d.dispose(),(m=this._rowHeaderBorder)==null||m.dispose(),(f=this._rowHeaderGroup)==null||f.dispose(),(h=this._rowHeaderBackground)==null||h.dispose(),(p=this._columnHeaderBackground)==null||p.dispose(),(v=this._columnHeaderBorder)==null||v.dispose(),(g=this._columnHeaderGroup)==null||g.dispose(),(b=this._topLeftWidget)==null||b.dispose(),(C=this._topCenterWidget)==null||C.dispose(),(S=this._topRightWidget)==null||S.dispose(),(E=this._middleLeftWidget)==null||E.dispose(),(y=this._middleRightWidget)==null||y.dispose(),(D=this._bottomLeftWidget)==null||D.dispose(),(R=this._bottomCenterWidget)==null||R.dispose(),(I=this._bottomRightWidget)==null||I.dispose(),this._dispose$.next(this),this._dispose$.complete()}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let n;if(e.isMerged){const r=e.mergeInfo;n={startRow:r.startRow,endRow:r.endRow,startColumn:r.startColumn,endColumn:r.endColumn,startX:r.startX,endX:r.endX,startY:r.startY,endY:r.endY}}else{const{actualRow:r,actualColumn:i,startX:o,endX:a,startY:s,endY:u}=e;n={startRow:r,endRow:r,startColumn:i,endColumn:i,startX:o,endX:a,startY:s,endY:u}}return n}}getValue(){return{...this._selectionModel.getValue(),style:this._selectionStyle}}getRange(){return this._selectionModel.getValue().rangeWithCoord}enableHelperSelection(){this._isHelperSelection=!0}disableHelperSelection(){this._isHelperSelection=!1}updateStyleId(e){this._selectionStyle!=null&&(this._selectionStyle.id=e)}_updateControl(e,n,r){const{startX:i,startY:o,endX:a,endY:s}=this._selectionModel,u=this._defaultStyle;e==null&&(e=u),this._currentStyle=e;const{stroke:l=u.stroke,widgets:c=u.widgets,hasAutoFill:d=u.hasAutoFill,AutofillStroke:m=u.AutofillStroke,strokeDash:f,isAnimationDash:h}=e;let{strokeWidth:p=u.strokeWidth,AutofillSize:v=u.AutofillSize,AutofillStrokeWidth:g=u.AutofillStrokeWidth}=e;const b=this._getScale(),C=(p+U9)/2/b;p/=b,v/=b,g/=b<1?1:b;const S=U9/b,E=gi/b;if(this.leftControl.transformByState({height:s-o,left:-C+E,width:p,strokeWidth:S,top:-S/2+E}),this.leftControl.setProps({fill:l,stroke:G3}),this.rightControl.transformByState({height:s-o,left:a-i-C+E,width:p,strokeWidth:S,top:-S/2+E}),this.rightControl.setProps({fill:l,stroke:G3}),this.topControl.transformByState({width:a-i+p,top:-C+E,left:-C+E,height:p,strokeWidth:S}),this.topControl.setProps({fill:l,stroke:G3}),this.bottomControl.transformByState({width:a-i+p,top:s-o-C+E,height:p,left:-C+E,strokeWidth:S}),this.bottomControl.setProps({fill:l,stroke:G3}),f==null)this.dashRect.hide(),this._stopAntLineAnimation();else{const y=e.strokeWidth*2/b;this.dashRect.transformByState({height:s-o,width:a-i,strokeWidth:y,left:-y/2+E,top:-y/2+E}),this.dashRect.setProps({strokeDashArray:[0,f/b]}),this._stopAntLineAnimation(),h!==!1&&this._startAntLineAnimation(),this.dashRect.show()}d===!0&&!this._hasWidgets(c)?(this.fillControl.setProps({fill:l,stroke:m,strokeScaleEnabled:!1}),this.fillControl.transformByState({width:v-g,height:v-g,left:a-i-v/2+g/2,top:s-o-v/2+g/2,strokeWidth:g}),this.fillControl.show()):this.fillControl.hide(),this._updateBackgroundControl(e),this._updateBackgroundTitle(e,n,r),this._updateWidgets(e),this.selectionShape.show(),this.selectionShape.translate(i,o),this._selectionStyle=e,this._rowHeaderWidth=n||0,this._columnHeaderHeight=r||0,this.selectionShape.makeDirtyNoDebounce(!0)}_initialize(){this._defaultStyle=vc(this._themeService),this._selectionModel=new GMe;const e=this._zIndex;this._leftControl=new cn("__SpreadsheetSelectionShapeLeftControl__"+e,{zIndex:e}),this._rightControl=new cn("__SpreadsheetSelectionShapeRightControl__"+e,{zIndex:e}),this._topControl=new cn("__SpreadsheetSelectionTopControl__"+e,{zIndex:e}),this._bottomControl=new cn("__SpreadsheetSelectionBottomControl__"+e,{zIndex:e}),this._backgroundControlTop=new cn("__SpreadsheetSelectionBackgroundControlTop__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlBottom=new cn("__SpreadsheetSelectionBackgroundControlBottom__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new cn("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new cn("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{zIndex:e-1,evented:!1}),this._fillControl=new cn("__SpreadsheetSelectionFillControl__"+e,{zIndex:e+1}),this._dashRect=new cn("__SpreadsheetDragDashControl__"+e,{zIndex:e+2,evented:!1,stroke:"#fff"});const n=[this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom,this._dashRect];this._widgetRects=this._initialWidget(),this._selectionShape=new U4("__SpreadsheetSelectionShape__"+e,...n,...this._widgetRects),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=e;const r=this.getScene();r.addObject(this._selectionShape,WMe),r.onTransformChangeObservable.add(i=>{i.type===eo.scale&&this._updateControl(this._currentStyle,this._rowHeaderWidth,this._columnHeaderHeight)}),this._initialTitle()}_initialTitle(){const e=this._zIndex;this._rowHeaderBackground=new cn("__SpreadSheetSelectionRowHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderBorder=new cn("__SpreadSheetSelectionRowHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderGroup=new U4("__SpreadSheetSelectionRowHeaderGroup__"+e,this._rowHeaderBackground,this._rowHeaderBorder),this._rowHeaderGroup.hide(),this._rowHeaderGroup.evented=!1,this._rowHeaderGroup.zIndex=e,this._columnHeaderBackground=new cn("__SpreadSheetSelectionColumnHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderBorder=new cn("__SpreadSheetSelectionColumnHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderGroup=new U4("__SpreadSheetSelectionColumnHeaderGroup__"+e,this._columnHeaderBackground,this._columnHeaderBorder),this._columnHeaderGroup.hide(),this._columnHeaderGroup.evented=!1,this._columnHeaderGroup.zIndex=e,this.getScene().addObjects([this._rowHeaderGroup,this._columnHeaderGroup],ule)}_initialWidget(){const e=this._zIndex;return this._topLeftWidget=new cn("__SpreadSheetSelectionTopLeftWidget__"+e,{zIndex:e+1}),this._topCenterWidget=new cn("__SpreadSheetSelectionTopCenterWidget__"+e,{zIndex:e+1}),this._topRightWidget=new cn("__SpreadSheetSelectionTopRightWidget__"+e,{zIndex:e+1}),this._middleLeftWidget=new cn("__SpreadSheetSelectionMiddleLeftWidget__"+e,{zIndex:e+1}),this._middleRightWidget=new cn("__SpreadSheetSelectionMiddleRightWidget__"+e,{zIndex:e+1}),this._bottomLeftWidget=new cn("__SpreadSheetSelectionBottomLeftWidget__"+e,{zIndex:e+1}),this._bottomCenterWidget=new cn("__SpreadSheetSelectionBottomCenterWidget__"+e,{zIndex:e+1}),this._bottomRightWidget=new cn("__SpreadSheetSelectionBottomRightWidget__"+e,{zIndex:e+1}),[this._topLeftWidget,this._topCenterWidget,this._topRightWidget,this._middleLeftWidget,this._middleRightWidget,this._bottomLeftWidget,this._bottomCenterWidget,this._bottomRightWidget]}_updateBackgroundTitle(e,n,r){const{startX:i,startY:o,endX:a,endY:s,rangeType:u}=this._selectionModel,l=this._defaultStyle;e==null&&(e=l);const c=this._getScale(),{stroke:d,hasRowHeader:m,rowHeaderFill:f=l.rowHeaderFill,rowHeaderStroke:h=l.rowHeaderStroke,hasColumnHeader:p,columnHeaderFill:v=l.columnHeaderFill,columnHeaderStroke:g=l.columnHeaderStroke}=e;let{rowHeaderStrokeWidth:b=l.rowHeaderStrokeWidth,columnHeaderStrokeWidth:C=l.columnHeaderStrokeWidth}=e;if(b/=c,C/=c,p===!0){let S=v;this._isHeaderHighlight&&u===ct.COLUMN&&(S=new Xo(d).setAlpha(UT).toString()),this._columnHeaderBackground.setProps({fill:S}),this._columnHeaderBackground.resize(a-i,r),this._columnHeaderBorder.setProps({fill:g}),this._columnHeaderBorder.transformByState({width:a-i,height:C,top:r-C+1/c}),this._columnHeaderGroup.show(),this._columnHeaderGroup.translate(i,0)}else this._columnHeaderGroup.hide();if(this._columnHeaderGroup.makeDirty(!0),m===!0){let S=f;this._isHeaderHighlight&&u===ct.ROW&&(S=new Xo(d).setAlpha(UT).toString()),this._rowHeaderBackground.setProps({fill:S}),this._rowHeaderBackground.resize(n,s-o),this._rowHeaderBorder.setProps({fill:h}),this._rowHeaderBorder.transformByState({width:b,height:s-o,left:n-b+1/c}),this._rowHeaderGroup.show(),this._rowHeaderGroup.translate(0,o)}else this._rowHeaderGroup.hide();this._rowHeaderGroup.makeDirty(!0)}_updateBackgroundControl(e){const{startX:n,startY:r,endX:i,endY:o}=this._selectionModel,a=this._defaultStyle;e==null&&(e=a);const s=this._getScale(),{fill:u=a.fill}=e;let{strokeWidth:l=a.strokeWidth}=e;l/=s;const c=this._selectionModel.highlightToSelection();if(!c){this._backgroundControlTop.resize(i-n,o-r),this._backgroundControlTop.setProps({fill:u}),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),this._backgroundControlMiddleRight.resize(0,0);return}const{startX:d,startY:m,endX:f,endY:h}=c,p=l/2,v={left:-p,top:-p,width:i-n+p*2,height:m-r+p};v.height<0&&(v.width=0,v.height=0),this._backgroundControlTop.transformByState(v);const g={left:-p,top:m-r,width:d-n+p,height:h-m};g.width<0&&(g.width=0,g.height=0),this._backgroundControlMiddleLeft.transformByState(g);const b={left:f-n-p,top:m-r,width:i-f+p*2,height:h-m};b.width<0&&(b.width=0,b.height=0),this._backgroundControlMiddleRight.transformByState(b);const C={left:-p,top:h-r,width:i-n+p*2,height:o-h+p};C.height<0&&(C.width=0,C.height=0),this._backgroundControlBottom.transformByState(C),this._backgroundControlTop.setProps({fill:u}),this._backgroundControlMiddleLeft.setProps({fill:u}),this._backgroundControlMiddleRight.setProps({fill:u}),this._backgroundControlBottom.setProps({fill:u})}_updateWidgets(e){const{startX:n,startY:r,endX:i,endY:o}=this._selectionModel,a=this._defaultStyle;e==null&&(e=a);const{stroke:s=a.stroke,widgets:u=a.widgets,widgetStroke:l=a.widgetStroke}=e,c=this._getScale();let{widgetSize:d=a.widgetSize,widgetStrokeWidth:m=a.widgetStrokeWidth}=e;d/=c,m/=c;const f={left:-d/2+m/2,center:(i-n)/2-d/2+m/2,right:i-n-d/2+m/2,top:-d/2,middle:(o-r)/2-d/2,bottom:o-r-d/2+m/2},h=d-m;this._widgetRects.forEach(p=>{p.setProps({fill:s,stroke:l})}),u.tl===!0?(this._topLeftWidget.transformByState({height:h,width:h,left:f.left,top:f.top,strokeWidth:m}),this._topLeftWidget.show()):this._topLeftWidget.hide(),u.tc===!0?(this._topCenterWidget.transformByState({height:h,width:h,left:f.center,top:f.top,strokeWidth:m}),this._topCenterWidget.show()):this._topCenterWidget.hide(),u.tr===!0?(this._topRightWidget.transformByState({height:h,width:h,left:f.right,top:f.top,strokeWidth:m}),this._topRightWidget.show()):this._topRightWidget.hide(),u.ml===!0?(this._middleLeftWidget.transformByState({height:h,width:h,left:f.left,top:f.middle,strokeWidth:m}),this._middleLeftWidget.show()):this._middleLeftWidget.hide(),u.mr===!0?(this._middleRightWidget.transformByState({height:h,width:h,left:f.right,top:f.middle,strokeWidth:m}),this._middleRightWidget.show()):this._middleRightWidget.hide(),u.bl===!0?(this._bottomLeftWidget.transformByState({height:h,width:h,left:f.left,top:f.bottom,strokeWidth:m}),this._bottomLeftWidget.show()):this._bottomLeftWidget.hide(),u.bc===!0?(this._bottomCenterWidget.transformByState({height:h,width:h,left:f.center,top:f.bottom,strokeWidth:m}),this._bottomCenterWidget.show()):this._bottomCenterWidget.hide(),u.br===!0?(this._bottomRightWidget.transformByState({height:h,width:h,left:f.right,top:f.bottom,strokeWidth:m}),this._bottomRightWidget.show()):this._bottomRightWidget.hide()}_hasWidgets(e){if(e==null)return!1;const n=Object.keys(e);if(n.length===0)return!1;for(const r of n)if(e[r]===!0)return!0;return!0}_getScale(){const{scaleX:e,scaleY:n}=this._scene.getAncestorScale();return Math.max(e,n)}_stopAntLineAnimation(){this._antLineOffset=0,Ax(this._antRequestNewFrame)}_startAntLineAnimation(){const e=this._getScale();this._antLineOffset+=.6/e,this._antLineOffset>16/e&&(this._antLineOffset=0),this.dashRect.setProps({strokeDashOffset:-this._antLineOffset}),this._antRequestNewFrame=Rm(()=>{this._startAntLineAnimation()})}};const VT="__SpreadsheetHelperSelectionTempRect",KMe=35;class HT{constructor(e,n,r,i,o){H(this,"_startOffsetX",0),H(this,"_startOffsetY",0),H(this,"_relativeSelectionPositionRow",0),H(this,"_relativeSelectionPositionColumn",0),H(this,"_relativeSelectionRowLength",0),H(this,"_relativeSelectionColumnLength",0),H(this,"_moveObserver"),H(this,"_upObserver"),H(this,"_helperSelection"),H(this,"_scrollTimer"),H(this,"_activeViewport"),H(this,"_targetSelection",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),H(this,"_isInMergeState",!1),H(this,"_fillControlColors",[]),this._control=e,this._skeleton=n,this._scene=r,this._themeService=i,this._injector=o,this._initialControl(),this._initialWidget(),this._initialFill(),this._control.dispose$.subscribe(()=>{this.dispose()})}get isHelperSelection(){return this._control.isHelperSelection}dispose(){var e,n;(e=this._scrollTimer)==null||e.dispose(),this._fillControlColors=[],this._clearObserverEvent(),(n=this._helperSelection)==null||n.dispose()}_getFreeze(){var e;return(e=this._injector.get(Dr).getCurrent())==null?void 0:e.skeleton.getWorksheetConfig().freeze}_isSelectionInViewport(e,n){const r=this._getFreeze()||{startRow:-1,startColumn:-1,xSplit:0,ySplit:0};switch(n.viewPortKey){case Ft.VIEW_MAIN:return e.endRow>=r.startRow&&e.endColumn>=r.startColumn;case Ft.VIEW_MAIN_TOP:case Ft.VIEW_COLUMN_RIGHT:return e.endColumn>=r.startColumn&&e.startRow<r.startRow;case Ft.VIEW_MAIN_LEFT:case Ft.VIEW_ROW_BOTTOM:return e.endRow>=r.startRow&&e.startColumn<r.startColumn;case Ft.VIEW_MAIN_LEFT_TOP:case Ft.VIEW_COLUMN_LEFT:case Ft.VIEW_ROW_TOP:case Ft.VIEW_LEFT_TOP:return e.startRow<r.startRow&&e.startColumn<r.startColumn}}_clearObserverEvent(){this._scene.onPointerMoveObserver.remove(this._moveObserver),this._scene.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_initialControl(){const{leftControl:e,rightControl:n,topControl:r,bottomControl:i}=this._control;[e,n,r,i].forEach(o=>{o.onPointerEnterObserver.add(()=>{o.setCursor(Jt.MOVE)}),o.onPointerLeaveObserver.add(()=>{o.resetCursor()}),o.onPointerDownObserver.add(this._controlEvent.bind(this))})}_controlMoving(e,n){var r;const i=this._scene,o=i.getScrollXYByRelativeCoords(zt.FromArray([e,n])),{scaleX:a,scaleY:s}=i.getAncestorScale(),u=this._skeleton.getCellPositionByOffset(e,n,a,s,o),{row:l,column:c}=u,d=this._skeleton.getRowCount()-1,m=this._skeleton.getColumnCount()-1;let f=l+this._relativeSelectionPositionRow;f<0&&(f=0);let h=f+this._relativeSelectionRowLength;h>d&&(h=d,h-f<this._relativeSelectionRowLength&&(f=h-this._relativeSelectionRowLength));let p=c+this._relativeSelectionPositionColumn;p<0&&(p=0);let v=p+this._relativeSelectionColumnLength;v>m&&(v=m,v-p<this._relativeSelectionColumnLength&&(p=v-this._relativeSelectionColumnLength));const g=this._skeleton.getNoMergeCellPositionByIndex(f,p),b=this._skeleton.getNoMergeCellPositionByIndex(h,v),C=(g==null?void 0:g.startY)||0,S=(b==null?void 0:b.endY)||0,E=(g==null?void 0:g.startX)||0,y=(b==null?void 0:b.endX)||0;(r=this._helperSelection)==null||r.transformByState({left:E,top:C,width:y-E,height:S-C}),this._targetSelection={startY:C,endY:S,startX:E,endX:y,startRow:f,endRow:h,startColumn:p,endColumn:v},this._control.selectionMoving$.next(this._targetSelection)}_controlEvent(e){const{offsetX:n,offsetY:r}=e,i=this._scene,o=i.getRelativeCoord(zt.FromArray([n,r])),{x:a,y:s}=o,u=i.getScrollXYByRelativeCoords(o),{scaleX:l,scaleY:c}=i.getAncestorScale(),d=this._skeleton.getCellPositionByOffset(a,s,l,c,u);this._startOffsetX=a,this._startOffsetY=s;const{row:m,column:f}=d,{startRow:h,startColumn:p,endRow:v,endColumn:g}=this._control.model;let b=0,C=0;m<h?b-=1:m>v&&(b+=1),f<p?C-=1:f>g&&(C+=1),this._relativeSelectionPositionRow=h-m+b,this._relativeSelectionPositionColumn=p-f+C,this._relativeSelectionRowLength=v-h,this._relativeSelectionColumnLength=g-p;const S=this._control.selectionStyle,E=this._getScale();this.isHelperSelection&&(this._helperSelection=new cn(VT,{stroke:S.stroke,strokeWidth:S.strokeWidth/E}),i.addObject(this._helperSelection));const y=i.getViewport(Ft.VIEW_MAIN),D=c1.create(i);D.startScroll(a,s,y),this._scrollTimer=D,i.disableEvent(),this._moveObserver=i.onPointerMoveObserver.add(R=>{const{offsetX:I,offsetY:T}=R,{x:P,y:N}=i.getRelativeCoord(zt.FromArray([I,T]));this._controlMoving(P,N),i.setCursor(Jt.MOVE),D.scrolling(P,N,()=>{this._controlMoving(P,N)})}),this._upObserver=i.onPointerUpObserver.add(()=>{var R,I;(R=this._helperSelection)==null||R.dispose();const T=this._scene;T.resetCursor(),this._clearObserverEvent(),T.enableEvent(),(I=this._scrollTimer)==null||I.dispose(),this._control.selectionMoved$.next(this._targetSelection)})}_initialWidget(){const{topLeftWidget:e,topCenterWidget:n,topRightWidget:r,middleLeftWidget:i,middleRightWidget:o,bottomLeftWidget:a,bottomCenterWidget:s,bottomRightWidget:u}=this._control,l=[Jt.NORTH_WEST_RESIZE,Jt.NORTH_RESIZE,Jt.NORTH_EAST_RESIZE,Jt.WEST_RESIZE,Jt.EAST_RESIZE,Jt.SOUTH_WEST_RESIZE,Jt.SOUTH_RESIZE,Jt.SOUTH_EAST_RESIZE];[e,n,r,i,o,a,s,u].forEach((c,d)=>{c.onPointerEnterObserver.add(()=>{c.setCursor(l[d])}),c.onPointerLeaveObserver.add(()=>{c.resetCursor()}),c.onPointerDownObserver.add(m=>{this._widgetEvent(m,l[d])})})}_widgetMoving(e,n,r){const i=this._scene,o=i.getScrollXYByRelativeCoords(zt.FromArray([this._startOffsetX,this._startOffsetY])),{scaleX:a,scaleY:s}=i.getAncestorScale(),u=this._skeleton.getCellPositionByOffset(e,n,a,s,o),{row:l,column:c}=u,{rowHeaderWidth:d,columnHeaderHeight:m}=this._skeleton;let f=this._relativeSelectionPositionRow,h=this._relativeSelectionPositionColumn,p=l,v=c;r===Jt.NORTH_WEST_RESIZE?(f=l,h=c,p=this._relativeSelectionPositionRow,v=this._relativeSelectionPositionColumn):r===Jt.NORTH_RESIZE?(f=l,h=this._relativeSelectionPositionColumn,p=this._relativeSelectionPositionRow,v=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength):r===Jt.NORTH_EAST_RESIZE?(f=l,h=this._relativeSelectionPositionColumn,p=this._relativeSelectionPositionRow,v=c):r===Jt.WEST_RESIZE?(f=this._relativeSelectionPositionRow,h=c,p=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,v=this._relativeSelectionPositionColumn):r===Jt.EAST_RESIZE?p=this._relativeSelectionPositionRow+this._relativeSelectionRowLength:r===Jt.SOUTH_WEST_RESIZE?(f=this._relativeSelectionPositionRow,h=c,p=l,v=this._relativeSelectionPositionColumn):r===Jt.SOUTH_RESIZE&&(f=this._relativeSelectionPositionRow,h=this._relativeSelectionPositionColumn,p=l,v=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength);const{startRow:g,startColumn:b,endRow:C,endColumn:S}=this._swapPositions(f,h,p,v),E=this._skeleton.getNoMergeCellPositionByIndex(g,b),y=this._skeleton.getNoMergeCellPositionByIndex(C,S),D=(E==null?void 0:E.startY)||0,R=(y==null?void 0:y.endY)||0,I=(E==null?void 0:E.startX)||0,T=(y==null?void 0:y.endX)||0;this._targetSelection={startY:D,endY:R,startX:I,endX:T,startRow:f,endRow:p,startColumn:h,endColumn:v},this._control.update(this._targetSelection,d,m,this._control.selectionStyle),this._control.clearHighlight(),this._control.selectionScaling$.next(this._targetSelection)}_widgetEvent(e,n){const{offsetX:r,offsetY:i}=e,o=this._scene,a=o.getRelativeCoord(zt.FromArray([r,i])),{x:s,y:u}=a;this._startOffsetX=r,this._startOffsetY=i;const{startRow:l,startColumn:c,endRow:d,endColumn:m}=this._control.model;this._relativeSelectionPositionRow=l,this._relativeSelectionPositionColumn=c,this._relativeSelectionRowLength=d-l,this._relativeSelectionColumnLength=m-c,n===Jt.NORTH_WEST_RESIZE?(this._relativeSelectionPositionRow=d,this._relativeSelectionPositionColumn=m):n===Jt.NORTH_RESIZE?this._relativeSelectionPositionRow=d:n===Jt.NORTH_EAST_RESIZE?this._relativeSelectionPositionRow=d:n===Jt.WEST_RESIZE?this._relativeSelectionPositionColumn=m:n===Jt.SOUTH_WEST_RESIZE&&(this._relativeSelectionPositionColumn=m);const f=c1.create(o);f.startScroll(s,u),this._scrollTimer=f,o.disableEvent(),this._moveObserver=o.onPointerMoveObserver.add(h=>{const{offsetX:p,offsetY:v}=h,{x:g,y:b}=o.getRelativeCoord(zt.FromArray([p,v]));this._widgetMoving(g,b,n),o.setCursor(n),f.scrolling(g,b,()=>{this._widgetMoving(g,b,n)})}),this._upObserver=o.onPointerUpObserver.add(()=>{var h;const p=this._scene;p.resetCursor(),this._clearObserverEvent(),p.enableEvent(),(h=this._scrollTimer)==null||h.dispose(),this._control.selectionScaled$.next(this._targetSelection)})}_initialFill(){const{fillControl:e}=this._control;e.onPointerEnterObserver.add(()=>{e.setCursor(Jt.CROSSHAIR)}),e.onPointerLeaveObserver.add(()=>{e.resetCursor()}),e.onPointerDownObserver.add(this._fillEvent.bind(this))}_fillMoving(e,n){var r,i,o;const a=this._scene,s=a.getScrollXY(this._activeViewport),{scaleX:u,scaleY:l}=a.getAncestorScale(),c=this._skeleton.getCellPositionByOffset(e,n,u,l,s),{row:d,column:m}=c,f=a.getRelativeCoord(zt.FromArray([e,n])),h=this._skeleton.getRowCount()-1,p=this._skeleton.getColumnCount()-1;let v=this._relativeSelectionPositionRow,g=this._relativeSelectionPositionColumn,b=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,C=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength,S=!1,E=!0;if((m<g||m>C)&&d>=v&&d<=b){const B=this._fillRuler(m,g,C,this._relativeSelectionColumnLength,p);g=B.startRowOrColumn,C=B.endRowOrColumn,S=B.isLighten,E=!1}else if((d<v||d>b)&&m>=g&&m<=C){const B=this._fillRuler(d,v,b,this._relativeSelectionRowLength,h);v=B.startRowOrColumn,b=B.endRowOrColumn,S=B.isLighten}else if(Math.abs(this._startOffsetX-f.x-s.x)/2>Math.abs(this._startOffsetY-f.y-s.y)){const B=this._fillRuler(m,g,C,this._relativeSelectionColumnLength,p);g=B.startRowOrColumn,C=B.endRowOrColumn,S=B.isLighten,E=!1}else{const B=this._fillRuler(d,v,b,this._relativeSelectionRowLength,h);v=B.startRowOrColumn,b=B.endRowOrColumn,S=B.isLighten}const y=this._skeleton.getNoMergeCellPositionByIndex(v,g),D=this._skeleton.getNoMergeCellPositionByIndex(b,C),R=(y==null?void 0:y.startY)||0,I=(D==null?void 0:D.endY)||0,T=(y==null?void 0:y.startX)||0,P=(D==null?void 0:D.endX)||0;S?this._controlHandler((B,W)=>{const G=new Xo(this._fillControlColors[W]).lighten(KMe).toRgbString();B.setProps({fill:G})}):this._controlHandler((B,W)=>{B.setProps({fill:this._fillControlColors[W]})});const N=U9/this._getScale();v===b&&E===!0||g===C&&E===!1?(r=this._helperSelection)==null||r.hide():((i=this._helperSelection)==null||i.transformByState({left:T-N/2,top:R-N/2,width:P-T,height:I-R}),(o=this._helperSelection)==null||o.show()),this._targetSelection={startY:R,endY:I,startX:T,endX:P,startRow:v,endRow:b,startColumn:g,endColumn:C},this._control.selectionFilling$.next(this._targetSelection)}_fillEvent(e){const{offsetX:n,offsetY:r}=e,i=this._scene,o=i.getRelativeCoord(zt.FromArray([n,r])),{x:a,y:s}=o;this._startOffsetX=a,this._startOffsetY=s;const{startRow:u,startColumn:l,endRow:c,endColumn:d}=this._control.model;this._isInMergeState=this._hasMergeInRange(u,l,c,d),this._relativeSelectionPositionRow=u,this._relativeSelectionPositionColumn=l,this._relativeSelectionRowLength=c-u,this._relativeSelectionColumnLength=d-l;const m=this._control.selectionStyle;let f=m==null?void 0:m.stroke,h=m==null?void 0:m.strokeWidth;const p=vc(this._themeService);f==null&&(f=p.stroke),h==null&&(h=p.strokeWidth);const v=this._getScale();h/=v;const g=U9/v,b=new Xo(f).darken(2).toRgbString();this.isHelperSelection&&(this._helperSelection=new cn(VT,{stroke:b,strokeWidth:h+g/2}),i.addObject(this._helperSelection)),this._activeViewport=i.getActiveViewportByCoord(zt.FromArray([n,r]));const C=i.getViewport(Ft.VIEW_MAIN),S=c1.create(i,this._activeViewport.viewPortKey===Ft.VIEW_MAIN?$o.ALL:$o.NONE);S.startScroll(a,s,C),this._scrollTimer=S,i.disableEvent(),this._controlHandler(E=>{this._fillControlColors.push(E.fill)}),this._moveObserver=i.onPointerMoveObserver.add(E=>{var y;const{offsetX:D,offsetY:R}=E,I=i.getActiveViewportByCoord(zt.FromArray([D,R])),{x:T,y:P}=i.getRelativeCoord(zt.FromArray([D,R]));this._fillMoving(T,P),i.setCursor(Jt.CROSSHAIR);const N=this._targetSelection;if(C&&I&&((y=this._activeViewport)==null?void 0:y.viewPortKey)!==(I==null?void 0:I.viewPortKey)){let B;N.startRow!==u?(S.scrollTimerType=$o.Y,B={...N,endRow:N.startRow}):N.endRow!==c?(S.scrollTimerType=$o.Y,B={...N,startRow:N.endRow}):N.startColumn!==l?(S.scrollTimerType=$o.X,B={...N,endColumn:N.startColumn}):(S.scrollTimerType=$o.X,B={...N,startColumn:N.endColumn}),this._isSelectionInViewport(B,I)&&(C.scrollTo({x:S.scrollTimerType===$o.X?0:void 0,y:S.scrollTimerType===$o.Y?0:void 0}),this._activeViewport=I)}S.scrolling(T,P,()=>{this._fillMoving(T,P)})}),this._upObserver=i.onPointerUpObserver.add(()=>{var E,y;(E=this._helperSelection)==null||E.dispose();const D=this._scene;D.resetCursor(),this._clearObserverEvent(),D.enableEvent(),(y=this._scrollTimer)==null||y.dispose(),this._control.refreshSelectionFilled(this._targetSelection),this._isInMergeState=!1,this._controlHandler((R,I)=>{R.setProps({fill:this._fillControlColors[I]})}),this._fillControlColors=[]})}_hasMergeInRange(e,n,r,i){const o=this._skeleton.mergeData;if(!o)return!1;for(const a of o){const{startRow:s,startColumn:u,endRow:l,endColumn:c}=a;if(xx({left:n,top:e,right:i,bottom:r},{left:u,top:s,right:c,bottom:l}))return!0}return!1}_swapPositions(e,n,r,i){const o=Math.min(e,r),a=Math.min(n,i),s=Math.max(e,r),u=Math.max(n,i);return{startRow:o,startColumn:a,endRow:s,endColumn:u}}_controlHandler(e){const{leftControl:n,rightControl:r,topControl:i,bottomControl:o,backgroundControlTop:a,backgroundControlMiddleLeft:s,backgroundControlMiddleRight:u,backgroundControlBottom:l,fillControl:c}=this._control,d=[n,r,i,o,a,s,u,l,c];for(let m=0,f=d.length;m<f;m++){const h=d[m];e(h,m)}}_fillRuler(e,n,r,i,o){let a=!1;if(e<n)if(this._isInMergeState&&e<n){const s=n-e,u=i+1,l=Math.ceil(s/u);let c=n-l*u;c<0&&(c=n-(l-1)*u),n=c}else n=e;else if(e>=n&&e<=r)a=!0,r=e;else if(this._isInMergeState&&e>r){const s=e-r,u=i+1,l=Math.ceil(s/u);let c=r+l*u;c>o&&(c=r+(l-1)*u),r=c}else r=e;return{rowOrColumn:e,startRowOrColumn:n,endRowOrColumn:r,isLighten:a}}_getScale(){const{scaleX:e,scaleY:n}=this._scene.getAncestorScale();return Math.max(e,n)}}var ZMe=Object.defineProperty,QMe=Object.getOwnPropertyDescriptor,JMe=(t,e,n,r)=>{for(var i=r>1?void 0:r?QMe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&ZMe(e,n,i),i},Z3=(t,e)=>(n,r)=>e(n,r,t);let Z_=class{constructor(e,n,r,i){H(this,"hasSelection",!1),H(this,"_downObserver"),H(this,"_moveObserver"),H(this,"_upObserver"),H(this,"_controlFillConfig$",new dn(null)),H(this,"controlFillConfig$",this._controlFillConfig$.asObservable()),H(this,"_selectionControls",[]),H(this,"_startSelectionRange",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),H(this,"_startOffsetX",0),H(this,"_startOffsetY",0),H(this,"_scrollTimer"),H(this,"_cancelDownObserver"),H(this,"_cancelUpObserver"),H(this,"_skeleton"),H(this,"_scene"),H(this,"_isHeaderHighlight",!0),H(this,"_isDetectMergedCell",!0),H(this,"_selectionStyle"),H(this,"_isSelectionEnabled",!0),H(this,"_isShowPreviousEnable",0),H(this,"_isRemainLastEnable",!0),H(this,"_isSkipRemainLastEnable",!1),H(this,"_selectionMoveEnd$",new dn([])),H(this,"selectionMoveEnd$",this._selectionMoveEnd$.asObservable()),H(this,"_selectionMoving$",new an),H(this,"selectionMoving$",this._selectionMoving$.asObservable()),H(this,"_selectionMoveStart$",new an),H(this,"selectionMoveStart$",this._selectionMoveStart$.asObservable()),H(this,"_activeViewport"),this._themeService=e,this._shortcutService=n,this._sheetSkeletonManagerService=r,this._injector=i,this._selectionStyle=vc(this._themeService)}enableHeaderHighlight(){this._isHeaderHighlight=!0}disableHeaderHighlight(){this._isHeaderHighlight=!1}enableDetectMergedCell(){this._isDetectMergedCell=!0}disableDetectMergedCell(){this._isDetectMergedCell=!1}setStyle(e){this._selectionStyle=e}resetStyle(){this.setStyle(vc(this._themeService))}enableSelection(){this._isSelectionEnabled=!0}disableSelection(){this._isSelectionEnabled=!1}enableShowPrevious(){this._isShowPreviousEnable=!0}disableShowPrevious(){this._isShowPreviousEnable=!1}enableRemainLast(){this._isRemainLastEnable=!0}disableRemainLast(){this._isRemainLastEnable=!1}enableSkipRemainLast(){this._isSkipRemainLastEnable=!0}disableSkipRemainLast(){this._isSkipRemainLastEnable=!1}getViewPort(){return this._activeViewport}addControlToCurrentByRangeData(e){const n=this.getCurrentControls();if(!n)return;const{rangeWithCoord:r,primaryWithCoord:i}=e,o=this._skeleton;let a=e.style;a==null&&(a=vc(this._themeService));const s=this._scene;if(s==null||o==null)return;const u=new j9(s,n.length,this._isHeaderHighlight,this._themeService);new HT(u,o,s,this._themeService,this._injector);const{rowHeaderWidth:l,columnHeaderHeight:c}=o;u.update(r,l,c,a,i),this._isHeaderHighlight?u.enableHeaderHighlight():u.disableHeaderHighlight(),n.push(u)}updateControlForCurrentByRangeData(e){const n=this.getCurrentControls();if(!n)return;const r=this._skeleton;if(r==null)return;const{rowHeaderWidth:i,columnHeaderHeight:o}=r;for(let a=0,s=e.length;a<s;a++){const{rangeWithCoord:u,primaryWithCoord:l,style:c}=e[a];n[a].update(u,i,o,c,l)}}refreshSelectionMoveStart(){this._selectionMoveStart$.next(this.getSelectionDataWithStyle())}changeRuntime(e,n,r){this._skeleton=e,this._scene=n,this._activeViewport=r||n.getViewports()[0]}getSelectionDataWithStyle(){return this._selectionControls.map(e=>e.getValue())}getCurrentControls(){return this._selectionControls}_clearSelectionControls(){const e=this.getCurrentControls();if(e.length>0){for(const n of e)n.dispose();e.length=0}}_getFreeze(){var e;return(e=this._sheetSkeletonManagerService.getCurrent())==null?void 0:e.skeleton.getWorksheetConfig().freeze}_getViewportByCell(e,n){if(!this._scene||e===void 0||n===void 0)return null;const r=this._getFreeze();if(!r||r.startRow<=0&&r.startColumn<=0)return this._scene.getViewport(Ft.VIEW_MAIN);if(e>r.startRow&&n>r.startColumn)return this._scene.getViewport(Ft.VIEW_MAIN);if(e<=r.startRow&&n<=r.startColumn)return this._scene.getViewport(Ft.VIEW_MAIN_LEFT_TOP);if(e<=r.startRow&&n>r.startColumn)return this._scene.getViewport(Ft.VIEW_MAIN_TOP);if(e>r.startRow&&n<=r.startColumn)return this._scene.getViewport(Ft.VIEW_MAIN_LEFT)}getActiveSelections(){const e=this.getCurrentControls();if(e&&e.length>0)return e==null?void 0:e.map(n=>{const r=n.model,i=r.currentCell;let o=null;return i&&(o={actualRow:i.actualRow,actualColumn:i.actualColumn,isMerged:i.isMerged,isMergedMainCell:i.isMergedMainCell,startRow:i.mergeInfo.startRow,startColumn:i.mergeInfo.startColumn,endRow:i.mergeInfo.endRow,endColumn:i.mergeInfo.endColumn}),{range:{startRow:r.startRow,startColumn:r.startColumn,endRow:r.endRow,endColumn:r.endColumn},primary:o}})}getActiveRange(){const e=this.getCurrentControls(),n=e&&e[e.length-1].model;return n&&{startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn}}getActiveSelection(){const e=this.getCurrentControls();return e&&e[e.length-1]}endSelection(){this._endSelection(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),this._shortcutService.setDisable(!1)}reset(){this._clearSelectionControls(),this._moveObserver=null,this._upObserver=null,this._downObserver=null}resetAndEndSelection(){this.endSelection(),this.reset()}eventTrigger(e,n=0,r=ct.NORMAL,i,o=$o.ALL){var a,s;if(this._isSelectionEnabled===!1)return;const u=this._skeleton,{offsetX:l,offsetY:c}=e,d=this._scene;if(d==null||u==null)return;i!=null&&(this._activeViewport=i);const m=d.getViewport(Ft.VIEW_MAIN),f=d.getRelativeCoord(zt.FromArray([l,c]));let{x:h,y:p}=f;this._startOffsetX=h,this._startOffsetY=p;const v=d.getScrollXYByRelativeCoords(f),{scaleX:g,scaleY:b}=d.getAncestorScale();r===ct.ROW?h=0:r===ct.COLUMN&&(p=0);const C=this._getSelectedRangeWithMerge(h,p,g,b,v);if(!C)return!1;const{rangeWithCoord:S,primaryWithCoord:E}=C,{startRow:y,startColumn:D,endColumn:R,endRow:I,startY:T,endY:P,startX:N,endX:B}=S,{rowHeaderWidth:W,columnHeaderHeight:G}=u,Q={startColumn:D,startRow:y,endColumn:R,endRow:I,startY:T,endY:P,startX:N,endX:B,rangeType:r};this._startSelectionRange=Q;let te=this.getActiveSelection();const X=this.getCurrentControls();if(!X)return!1;for(const pe of X){if(e.button===2&&pe.model.isInclude(Q)){te=pe;return}if(pe.model.isEqual(Q)){te=pe;break}e.shiftKey||pe.clearHighlight()}if(X.length>0&&!e.ctrlKey&&!e.shiftKey&&!this._isShowPreviousEnable&&!this._isRemainLastEnable){for(const pe of X)pe.dispose();X.length=0}const x=te&&te.model.currentCell;if(te&&e.shiftKey&&x){const{actualRow:pe,actualColumn:oe,mergeInfo:he}=x,fe=Math.min(pe,Q.startRow,he.startRow),ve=Math.max(pe,Q.endRow,he.endRow),Ue=Math.min(oe,Q.startColumn,he.startColumn),ke=Math.max(oe,Q.endColumn,he.endColumn),Te=u.getMergeBounding(fe,Ue,ve,ke),Re=u.getNoMergeCellPositionByIndex(Te.startRow,Te.startColumn),rt=u.getNoMergeCellPositionByIndex(Te.endRow,Te.endColumn),_t={startColumn:Te.startColumn,startRow:Te.startRow,endColumn:Te.endColumn,endRow:Te.endRow,startY:Re.startY,endY:rt.endY,startX:Re.startX,endX:rt.endX,rangeType:r},mt=u.getCellByIndex(pe,oe);this._startSelectionRange={startColumn:mt.mergeInfo.startColumn,startRow:mt.mergeInfo.startRow,endColumn:mt.mergeInfo.endColumn,endRow:mt.mergeInfo.endRow,startY:mt.mergeInfo.startY||0,endY:mt.mergeInfo.endY||0,startX:mt.mergeInfo.startX||0,endX:mt.mergeInfo.endX||0,rangeType:r},te.update(_t,W,G,this._selectionStyle,x)}else this._isRemainLastEnable&&te&&!e.ctrlKey&&!e.shiftKey&&!this._isSkipRemainLastEnable?te.update(Q,W,G,this._selectionStyle,E):(te=new j9(d,X.length+n,this._isHeaderHighlight,this._themeService),new HT(te,u,d,this._themeService,this._injector),te.update(Q,W,G,this._selectionStyle,E),X.push(te));this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this.hasSelection=!0,this._endSelection(),d.disableEvent();const O=d.getActiveViewportByCoord(zt.FromArray([h,p])),M=c1.create(this._scene,o);M.startScroll((a=m==null?void 0:m.left)!=null?a:0,(s=m==null?void 0:m.top)!=null?s:0,m),this._scrollTimer=M,this._addCancelObserver(),(r===ct.ROW||r===ct.COLUMN)&&this._moving(h,p,te,r);let V=0,q=0,ie=h,ce=p;this._moveObserver=d.onPointerMoveObserver.add(pe=>{var oe,he,fe,ve,Ue,ke,Te,Re,rt,_t;const{offsetX:mt,offsetY:nt}=pe,{x:_e,y:He}=d.getRelativeCoord(zt.FromArray([mt,nt]));this._moving(_e,He,te,r);let et=_e,Dt=He;const Mt=this.getActiveSelection(),Bt=(oe=this._sheetSkeletonManagerService.getCurrent())==null?void 0:oe.skeleton.getWorksheetConfig().freeze,Zt=Mt==null?void 0:Mt.model,It=(he=d.getActiveViewportByCoord(zt.FromArray([mt,nt])))!=null?he:this._getViewportByCell(Zt==null?void 0:Zt.endRow,Zt==null?void 0:Zt.endColumn);if(O&&It&&m){const pn=ie<m.left&&_e>m.left||ie>m.left&&_e<m.left,yn=ce<m.top&&He>m.top||ce>m.top&&He<m.top;pn&&(V+=1),yn&&(q+=1);const $t=O.viewPortKey,Ht=It.viewPortKey;if($t===Ft.VIEW_ROW_TOP)nt<m.top&&((fe=Zt==null?void 0:Zt.endRow)!=null?fe:0)<((ve=Bt==null?void 0:Bt.startRow)!=null?ve:0)?Dt=m.top:yn&&q%2===1&&m.scrollTo({y:0});else if($t===Ft.VIEW_COLUMN_LEFT)mt<m.left&&((Ue=Zt==null?void 0:Zt.endColumn)!=null?Ue:0)<((ke=Bt==null?void 0:Bt.startColumn)!=null?ke:0)?et=m.left:pn&&V%2===1&&m.scrollTo({x:0});else if($t===Ht){let Nt=!1,Ot=!1;$t===Ft.VIEW_MAIN_LEFT_TOP?(Nt=!0,Ot=!0):$t===Ft.VIEW_MAIN_TOP?Ot=!0:$t===Ft.VIEW_MAIN_LEFT&&(Nt=!0),((Te=Zt==null?void 0:Zt.endRow)!=null?Te:0)>((Re=Bt==null?void 0:Bt.startRow)!=null?Re:0)&&(Ot=!1),((rt=Zt==null?void 0:Zt.endColumn)!=null?rt:0)>((_t=Bt==null?void 0:Bt.startColumn)!=null?_t:0)&&(Nt=!1),Nt&&(et=m.left),Ot&&(Dt=m.top)}else{const Nt={x:O.scrollX,y:O.scrollY},Ot={x:It.scrollX,y:It.scrollY},En=Nt.x!==Ot.x&&pn&&V%2===1,Y=Nt.y!==Ot.y&&yn&&q%2===1;(En||Y)&&(m.scrollTo({x:En?Nt.x:void 0,y:Y?Nt.y:void 0}),En||(et=m.left),Y||(Dt=m.top)),($t===Ft.VIEW_MAIN_LEFT_TOP&&Ht===Ft.VIEW_MAIN_LEFT||Ht===Ft.VIEW_MAIN_LEFT_TOP&&$t===Ft.VIEW_MAIN_LEFT)&&(et=m.left),($t===Ft.VIEW_MAIN_LEFT_TOP&&Ht===Ft.VIEW_MAIN_TOP||Ht===Ft.VIEW_MAIN_LEFT_TOP&&$t===Ft.VIEW_MAIN_TOP)&&(Dt=m.top)}ie=_e,ce=He}M.scrolling(et,Dt,()=>{this._moving(_e,He,te,r)})}),this._upObserver=d.onPointerUpObserver.add(pe=>{this._endSelection(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),this._shortcutService.setDisable(!1)}),this._shortcutService.setDisable(!0)}convertSelectionRangeToData(e){const{range:n,primary:r,style:i}=e;let o=this.convertRangeDataToSelection(n);return o==null&&(o={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1,startY:0,endY:0,startX:0,endX:0,rangeType:ct.NORMAL}),{rangeWithCoord:o,primaryWithCoord:this.convertCellRangeToInfo(r),style:i}}convertRangeDataToSelection(e){const{startRow:n,startColumn:r,endRow:i,endColumn:o,rangeType:a}=e,s=this._scene,u=this._skeleton;if(s==null||u==null)return;s.getAncestorScale();const l=u.getNoMergeCellPositionByIndex(n,r),c=u.getNoMergeCellPositionByIndex(i,o);return{startRow:n,startColumn:r,endRow:i,endColumn:o,rangeType:a,startY:(l==null?void 0:l.startY)||0,endY:(c==null?void 0:c.endY)||0,startX:(l==null?void 0:l.startX)||0,endX:(c==null?void 0:c.endX)||0}}convertCellRangeToInfo(e){if(e==null)return;const n=this._scene,r=this._skeleton;if(n==null||r==null)return;const{actualRow:i,actualColumn:o,isMerged:a,isMergedMainCell:s,startRow:u,startColumn:l,endRow:c,endColumn:d}=e,m=r.getNoMergeCellPositionByIndex(i,o),f=r.getNoMergeCellPositionByIndex(u,l),h=r.getNoMergeCellPositionByIndex(c,d);return{actualRow:i,actualColumn:o,isMerged:a,isMergedMainCell:s,startX:m.startX,startY:m.startY,endX:m.endX,endY:m.endY,mergeInfo:{startRow:u,startColumn:l,endRow:c,endColumn:d,startY:(f==null?void 0:f.startY)||0,endY:(h==null?void 0:h.endY)||0,startX:(f==null?void 0:f.startX)||0,endX:(h==null?void 0:h.endX)||0}}}_moving(e,n,r,i){var o;const a=this._skeleton,s=this._scene;if(s==null||a==null)return!1;const{startRow:u,startColumn:l,endRow:c,endColumn:d}=this._startSelectionRange,{startRow:m,endRow:f,startColumn:h,endColumn:p}=(r==null?void 0:r.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1},v=s.getViewport(Ft.VIEW_MAIN),g=(o=this._getViewportByCell(f,p))!=null?o:v,b=s.getScrollXYByRelativeCoords(zt.FromArray([this._startOffsetX,this._startOffsetY]),g),{scaleX:C,scaleY:S}=s.getAncestorScale(),{rowHeaderWidth:E,columnHeaderHeight:y}=a;i===ct.ROW?e=Number.POSITIVE_INFINITY:i===ct.COLUMN&&(n=Number.POSITIVE_INFINITY);const D=this._getSelectedRangeWithMerge(e,n,C,S,b);if(!D)return!1;const{rangeWithCoord:R,primaryWithCoord:I}=D,{startRow:T,startColumn:P,endColumn:N,endRow:B}=R,W=Math.min(T,u),G=Math.min(P,l),Q=Math.max(B,c),te=Math.max(N,d);let X={startRow:W,startColumn:G,endRow:Q,endColumn:te};if(this._isDetectMergedCell&&(X=a.getSelectionBounding(W,G,Q,te)),!X)return!1;const{startRow:x,startColumn:O,endRow:M,endColumn:V}=X,q=a.getNoMergeCellPositionByIndex(x,O),ie=a.getNoMergeCellPositionByIndex(M,V),ce={startColumn:O,startRow:x,endColumn:V,endRow:M,startY:(q==null?void 0:q.startY)||0,endY:(ie==null?void 0:ie.endY)||0,startX:(q==null?void 0:q.startX)||0,endX:(ie==null?void 0:ie.endX)||0};(h!==O||m!==x||p!==V||f!==M)&&r!=null&&(r.update(ce,E,y),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_endSelection(){var e,n;const r=this._scene;if(r==null)return;r.onPointerMoveObserver.remove(this._moveObserver),r.onPointerUpObserver.remove(this._upObserver),r.enableEvent(),(e=this._scrollTimer)==null||e.dispose();const i=(n=r.getEngine())==null?void 0:n.activeScene;i==null||i.onPointerDownObserver.remove(this._cancelDownObserver),i==null||i.onPointerUpObserver.remove(this._cancelUpObserver)}_addCancelObserver(){var e;const n=this._scene;if(n==null)return;const r=(e=n.getEngine())==null?void 0:e.activeScene;r==null||r===n||(r.onPointerDownObserver.remove(this._cancelDownObserver),r.onPointerUpObserver.remove(this._cancelUpObserver),this._cancelDownObserver=r.onPointerDownObserver.add(i=>{this._endSelection()}),this._cancelUpObserver=r.onPointerUpObserver.add(i=>{this._endSelection()}))}_getSelectedRangeWithMerge(e,n,r,i,o){var a;if(this._isDetectMergedCell){const g=(a=this._skeleton)==null?void 0:a.calculateCellIndexByPosition(e,n,r,i,o),b=xC(g);return b==null?void 0:{primaryWithCoord:g,rangeWithCoord:b}}const s=this._skeleton;if(s==null)return;const u=s.getCellPositionByOffset(e,n,r,i,o),{row:l,column:c}=u,d=s.getNoMergeCellPositionByIndex(l,c),{startX:m,startY:f,endX:h,endY:p}=d,v={startY:f,endY:p,startX:m,endX:h,startRow:l,endRow:l,startColumn:c,endColumn:c};return{primaryWithCoord:{actualRow:l,actualColumn:c,isMerged:!1,isMergedMainCell:!1,startY:f,endY:p,startX:m,endX:h,mergeInfo:v},rangeWithCoord:v}}};Z_=JMe([Z3(0,K(_i)),Z3(1,lu),Z3(2,K(Dr)),Z3(3,K(wn))],Z_);const Hi=ln("deprecated.univer.sheet.selection-render-service");var eNe=Object.defineProperty,tNe=Object.getOwnPropertyDescriptor,nNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?tNe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&eNe(e,n,i),i},Ul=(t,e)=>(n,r)=>e(n,r,t);const rNe=1e4,B8=ln("univer.mark-selection-service");let Q_=class extends We{constructor(e,n,r,i,o,a,s){super(),H(this,"_shapeMap",new Map),this._currentService=e,this._renderManagerService=n,this._selectionRenderService=r,this._commandService=i,this._sheetSkeletonManagerService=o,this._themeService=a,this._selectionManagerService=s}addShape(e,n=[],r=rNe){const i=this._currentService.getCurrentUniverSheetInstance(),o=i.getActiveSheet().getSheetId(),a=Ie.generateRandomId();return this._shapeMap.set(a,{selection:e,subUnitId:o,unitId:i.getUnitId(),zIndex:r,control:null,exits:n}),this.refreshShapes(),a}refreshShapes(){const e=this._currentService.getCurrentUniverSheetInstance().getUnitId(),n=this._currentService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();this._shapeMap.forEach(r=>{var i;const{unitId:o,subUnitId:a,selection:s,control:u,zIndex:l}=r;if(u&&u.dispose(),o!==e||a!==n)return;const{style:c}=s,{scene:d}=this._renderManagerService.getRenderById(o)||{},{rangeWithCoord:m,primaryWithCoord:f}=this._selectionRenderService.convertSelectionRangeToData(s),h=(i=this._sheetSkeletonManagerService.getCurrent())==null?void 0:i.skeleton;if(!d||!h)return;const{rowHeaderWidth:p,columnHeaderHeight:v}=h,g=new j9(d,l,!1,this._themeService);g.update(m,p,v,c,f),r.control=g})}getShapeMap(){return this._shapeMap}removeShape(e){const n=this._shapeMap.get(e);if(!n)return;const{control:r}=n;r&&r.dispose(),this._shapeMap.delete(e)}removeAllShapes(){for(const e of this._shapeMap.values()){const{control:n}=e;n&&n.dispose()}this._shapeMap.clear()}};Q_=nNe([Ul(0,ae),Ul(1,Jn),Ul(2,Hi),Ul(3,se),Ul(4,K(Dr)),Ul(5,K(_i)),Ul(6,K(dt))],Q_);const iNe=10,oNe=6;function aNe(){return Ie.generateRandomId(oNe)}function sNe(t){const e=t.match(/data-copy-id="([^\s]+)"/);return e&&e[1]?e[1]:null}class uNe{constructor(){H(this,"_cache",new r5(iNe))}set(e,n){this._cache.set(e,n)}get(e){return this._cache.get(e)}del(e){this._cache.delete(e)}clear(){this._cache.clear()}}var _s=(t=>(t.COPY="COPY",t.CUT="CUT",t))(_s||{});function lNe(t,e,n,r,i){const o=[],a=[];if(r.copyType===_s.CUT){const{undos:s,redos:u}=cNe(t,e,i);o.push(...u),a.push(...s)}else{const{undos:s,redos:u}=IV(e,n,i);o.push(...u),a.push(...s);const{undos:l,redos:c}=DV(e,n,i);o.push(...c),a.push(...l);const{undos:d,redos:m}=RV(e,n,i);o.push(...m),a.push(...d);const{undos:f,redos:h}=J_(e,n,i);o.push(...h),a.push(...f)}return{undos:a,redos:o}}function cNe(t,e,n){let r=[],i=[];const{range:o,subUnitId:a,unitId:s}=t,{range:u,subUnitId:l}=e;if(o&&u){const c=n.get(ae),d=n.get(In),m=c.getUniverSheetInstance(s),f=m==null?void 0:m.getSheetBySheetId(a),h=m==null?void 0:m.getSheetBySheetId(l);if(f&&h){const p=new Ye,v=new Ye,g=(te,X)=>({startRow:te,endRow:te,startColumn:X,endColumn:X}),b=f.getCellMatrix(),C=h.getCellMatrix();mr.foreach(o,(te,X)=>{p.setValue(te,X,Ie.deepClone(b.getValue(te,X))),v.setValue(te,X,null)});const S=new Ye;mr.foreach(u,(te,X)=>{S.setValue(te,X,Ie.deepClone(C.getValue(te,X)))});const E=new Ye;mr.foreach(o,(te,X)=>{const x=g(te,X),O=ht.getRelativeRange(x,o),M=ht.getPositionRange(O,u);E.setValue(M.startRow,M.startColumn,b.getValue(te,X))});const y={from:{value:v.getMatrix(),subUnitId:a},to:{value:E.getMatrix(),subUnitId:l},unitId:s},D={from:{value:p.getMatrix(),subUnitId:a},to:{value:S.getMatrix(),subUnitId:l},unitId:s},R=d.onCommandExecute({id:Qc.id,params:{toRange:u,fromRange:o}}),I=f.getMergeData(),T=h.getMergeData(),P=I.filter(te=>ht.intersects(te,o)),N=T.filter(te=>ht.intersects(te,u)),B=P.map(te=>ht.getRelativeRange(te,o)).map(te=>ht.getPositionRange(te,u)),W=Nf(B).filter(te=>!T.some(X=>ht.equals(te,X))),G=[{id:Un.id,params:{unitId:s,subUnitId:a,ranges:P}},{id:Un.id,params:{unitId:s,subUnitId:a,ranges:N}},{id:Bn.id,params:{unitId:s,subUnitId:l,ranges:W}}],Q=[{id:Un.id,params:{unitId:s,subUnitId:l,ranges:W}},{id:Bn.id,params:{unitId:s,subUnitId:l,ranges:N}},{id:Bn.id,params:{unitId:s,subUnitId:a,ranges:P}}];r=[{id:qa.id,params:y},...R.redos,...G,{id:_n.id,params:{unitId:s,subUnitId:l,pluginName:Nn,selections:[{range:u}]}}],i=[{id:_n.id,params:{unitId:s,sheetId:a,pluginName:Nn,selections:[{range:o}]}},...R.undos,...Q,{id:qa.id,params:D}]}}return{undos:i,redos:r}}function DV(t,e,n){const{unitId:r,subUnitId:i,range:o}=t,a=[],s=[],{startColumn:u,startRow:l}=o,c=new Ye;e.forValue((f,h,p)=>{c.setValue(f+l,h+u,{v:p.v})});const d={unitId:r,subUnitId:i,cellValue:c.getData()};a.push({id:Vt.id,params:d});const m=ci(n,d);return s.push({id:Vt.id,params:m}),{undos:s,redos:a}}function RV(t,e,n){const r=[],i=[],{unitId:o,subUnitId:a,range:s}=t,{startColumn:u,startRow:l}=s,c=new Ye;e.forValue((f,h,p)=>{var v;const g={s:p.s};(v=p.p)!=null&&v.body&&(g.p=p.p),c.setValue(f+l,h+u,g)});const d={unitId:o,subUnitId:a,cellValue:c.getData()};r.push({id:Vt.id,params:d});const m=ci(n,d);return i.push({id:Vt.id,params:m}),{undos:i,redos:r}}function IV(t,e,n){const r=[],i=[],o=new Ye,{unitId:a,subUnitId:s,range:u}=t,{startColumn:l,startRow:c}=u;if(e.forValue((d,m,f)=>{f.s&&o.setValue(d+c,m+l,{s:null})}),o.getLength()>0){const d={subUnitId:s,unitId:a,cellValue:o.getData()};r.push({id:Vt.id,params:d});const m=ci(n,d);i.push({id:Vt.id,params:m})}return{undos:i,redos:r}}function J_(t,e,n){const r=[],i=[],{unitId:o,subUnitId:a,range:s}=t,{startColumn:u,startRow:l,endColumn:c,endRow:d}=s;let m=!1;const f=[];if(e.forValue((v,g,b)=>{if(b.rowSpan){const C=b.colSpan||1,S={startRow:l+v,endRow:l+v+b.rowSpan-1,startColumn:u+g,endColumn:u+g+C-1};f.push(S),m=!0}else if(b.colSpan){const C=b.rowSpan||1,S={startRow:l+v,endRow:l+v+C-1,startColumn:u+g,endColumn:u+g+b.colSpan-1};f.push(S),m=!0}}),m){const v=n.get(ae).getUniverSheetInstance(o),g=v==null?void 0:v.getSheetBySheetId(a);if(v&&g){const b=g.getMergeData().filter(E=>ht.intersects({startRow:l,startColumn:u,endRow:d,endColumn:c},E)),C={unitId:o,subUnitId:a,ranges:b};r.push({id:Un.id,params:C});const S=Zi(n,C);i.push({id:Bn.id,params:S})}}const h={unitId:o,subUnitId:a,ranges:f};r.push({id:Bn.id,params:h});const p=Fo(n,h);return i.push({id:Un.id,params:p}),{undos:i,redos:r}}function AV(t){let e=t.replace(/(\r\n|\n)/g,"\r");e.endsWith(`\r
`)||(e+=`\r
`);const n=[];for(let r=0;r<e.length;r++)e[r]==="\r"&&n.push({startIndex:r});return{dataStream:e,paragraphs:n,sectionBreaks:[{startIndex:e.indexOf(`
`)}]}}function sy(t){const e=t.style,n={},r=t.tagName.toLowerCase();switch(r){case"b":case"em":case"strong":{n.bl=we.TRUE;break}case"s":{n.st={s:we.TRUE};break}case"u":{n.ul={s:we.TRUE};break}case"i":{n.it=we.TRUE;break}case"sub":case"sup":{n.va=r==="sup"?yr.SUPERSCRIPT:yr.SUBSCRIPT;break}}for(let i=0;i<e.length;i++){const o=e[i],a=e.getPropertyValue(o);switch(o){case"font-family":{n.ff=a;break}case"font-size":{const s=Number.parseInt(a);Number.isNaN(s)||a.endsWith("pt")&&(n.fs=s);break}case"font-style":{a==="italic"&&(n.it=we.TRUE);break}case"font-weight":{Number(a)>400&&(n.bl=we.TRUE);break}case"text-decoration":{/underline/.test(a)?n.ul={s:we.TRUE}:/overline/.test(a)?n.ol={s:we.TRUE}:/line-through/.test(a)&&(n.st={s:we.TRUE});break}case"color":{const s=new Xo(a);s.isValid&&(n.cl={rgb:s.toRgbString()});break}case"background-color":{const s=new Xo(a);s.isValid&&(n.bg={rgb:s.toRgbString()});break}}}return n}function dNe(t){const e=new DOMParser,n=`<x-univer id="univer-root">${t}</x-univer>`;return e.parseFromString(n,"text/html").querySelector("#univer-root")}function mNe(t){const e=t.style,n={};for(let r=0;r<e.length;r++){const i=e[r],o=e.getPropertyValue(i);switch(i){case"margin-top":{const a=Number.parseInt(o);n.spaceAbove=/pt/.test(o)?jT(a):a;break}case"margin-bottom":{const a=Number.parseInt(o);n.spaceBelow=/pt/.test(o)?jT(a):a;break}}}return Object.getOwnPropertyNames(n).length?n:null}function jT(t){return t/.75}function zT(t,e){const n=[];for(let r=0,i=t.length;r<i;r++)t[r]===mn.PARAGRAPH&&n.push({startIndex:r});if(e)for(const r of n)e.bullet&&(r.bullet=Ie.deepClone(e.bullet)),e.paragraphStyle&&(r.paragraphStyle=Ie.deepClone(e.paragraphStyle));return n}function WT(t,e){const n=t.tagName.toLowerCase();return typeof e=="string"?n===e:Array.isArray(e)?e.some(r=>r===n):e(t)}const TV=class wV{constructor(e){H(this,"styleCache",new Map),H(this,"styleRules",[]),H(this,"afterProcessRules",[]),H(this,"getCurrentSkeleton"),this.getCurrentSkeleton=e.getCurrentSkeleton}static use(e){if(this.pluginList.includes(e))throw new Error(`Univer paste plugin ${e.name} already added`);this.pluginList.push(e)}convert(e){const n=wV.pluginList.find(f=>f.checkPasteType(e));n&&(this.styleRules=[...n.stylesRules],this.afterProcessRules=[...n.afterProcessRules]);const r=new Ye,i=dNe(e),o={dataStream:"",textRuns:[]},a=[],s=[],u=e.match(/<table\b[^>]*>([\s\S]*?)<\/table>/gi),l=[];this.process(null,i==null?void 0:i.childNodes,o,l);const{paragraphs:c,dataStream:d,textRuns:m}=o;if(c){const f=c.map(h=>h.startIndex+1);f.unshift(0);for(let h=0;h<f.length;h++){let p;h===f.length-1?p=`${d.substring(f[h])}\r
`:p=`${d.substring(f[h],f[h+1]-1)}\r
`;const v=[];m==null||m.forEach(b=>{b.st>=f[h]&&b.ed<=f[h+1]&&v.push({st:b.st-f[h],ed:b.ed-f[h],ts:b.ts})});const g=this._generateDocumentDataModelSnapshot({body:{dataStream:p,textRuns:v,paragraphs:zT(p)}});r.setValue(r.getLength(),0,{v:p,p:g}),a.push({}),u&&l.forEach(b=>{const C=r.getDataRange().endRow+1;if(b.index===h){const S=u.shift(),{cellMatrix:E,colProperties:y,rowProperties:D}=this._parseTable(S);E&&E.forValue((R,I,T)=>{r.setValue(C+R,I,T)}),y&&s.push(...y),a.push(...D)}})}}else{if(d){const f=`${d}\r
`,h={dataStream:f,textRuns:m,paragraphs:zT(f)},p=this._generateDocumentDataModelSnapshot({body:h});r.setValue(0,0,{v:d,p}),a.push({})}u&&u.forEach(f=>{const h=r.getDataRange().endRow+1,{cellMatrix:p,rowProperties:v,colProperties:g}=this._parseTable(f);p&&p.forValue((b,C,S)=>{const{rowSpan:E=1,colSpan:y=1}=S;for(let D=0;D<E;D++)for(let R=0;R<y;R++)r.setValue(h+b+D,C+R,{v:""});r.setValue(h+b,C,S)}),g&&s.push(...g),a.push(...v)})}return{rowProperties:a,colProperties:s,cellMatrix:r}}_parseTable(e){const n=new Ye,r=pNe(e),{rowProperties:i,rowCount:o,cellMatrix:a}=fNe(e);return a&&a.forValue((s,u,l)=>{var c;const d=mAe(void 0,(c=l.properties)==null?void 0:c.style);if(/\r|\n/.test(l.content)){const m=AV(l.content),f=this._generateDocumentDataModelSnapshot({body:m});n.setValue(s,u,{v:l.content,p:f,s:d,rowSpan:l.rowSpan,colSpan:l.colSpan})}else n.setValue(s,u,{v:l.content,s:d,rowSpan:l.rowSpan,colSpan:l.colSpan})}),{rowProperties:i,colProperties:r,cellMatrix:n}}_generateDocumentDataModelSnapshot(e){var n;const r=this.getCurrentSkeleton();if(r==null)return null;const{skeleton:i}=r,o=(n=i.getBlankCellDocumentModel())==null?void 0:n.documentModel,a={...o==null?void 0:o.getSnapshot(),...e};return o==null||o.reset(a),o==null?void 0:o.getSnapshot()}process(e,n,r,i){var o,a;for(const s of n)if(s.nodeName.toLowerCase()==="table")i.push({index:((o=r==null?void 0:r.paragraphs)==null?void 0:o.length)||0});else if(s.nodeType===Node.TEXT_NODE){const u=(a=s.nodeValue)==null?void 0:a.replace(/[\r\n]/g,"");let l;e&&this.styleCache.has(e)&&(l=this.styleCache.get(e));const c={dataStream:"",textRuns:[]};r.dataStream+=u,c.dataStream+=u,l&&Object.getOwnPropertyNames(l).length&&(r.textRuns.push({st:r.dataStream.length-u.length,ed:r.dataStream.length,ts:l}),c.textRuns.push({st:r.dataStream.length-u.length,ed:r.dataStream.length,ts:l}))}else if(s.nodeType===Node.ELEMENT_NODE){const u=e?this.styleCache.get(e):{},l=this.styleRules.find(({filter:f})=>WT(s,f)),c=l?l.getStyle(s):sy(s);this.styleCache.set(s,{...u,...c});const{childNodes:d}=s;this.process(s,d,r,i);const m=this.afterProcessRules.find(({filter:f})=>WT(s,f));m&&m.handler(r,s)}}};H(TV,"pluginList",[]);let uy=TV;function fNe(t){const e=/<tr([\s\S]*?)>([\s\S]*?)<\/tr>/gi,n=t.matchAll(e);if(!n)return{rowProperties:[],rowCount:0,colCount:0,cellMatrix:null};const r=Array.from(n),i=r.map(s=>ly(s[1])),{colCount:o,cellMatrix:a}=hNe(r.map(s=>s[2]));return{rowProperties:i,rowCount:i.length,colCount:o,cellMatrix:a}}function hNe(t){const e=new Ye,n=new Map,r=/<td([\s\S]*?)>([\s\S]*?)<\/td>/gi;let i=0,o=0,a=0;return t.forEach((s,u)=>{const l=u===0,c=s.matchAll(r);o=0,Array.from(c).forEach(d=>{const m=ly(d[1]),f=gNe(d[2].replace("<br>","\r").replace(/<\/?[^>]*>/g,"")),h=m.rowspan?+m.rowspan:1,p=m.colspan?+m.colspan:1;if(!l){for(let g=o;g<i;g++)if(!(n.get(g)>=a)){o=g;break}}const v={content:f,properties:m};p>1&&(v.colSpan=+p),h>1&&(v.rowSpan=+h),l&&(i+=p);for(let g=o;g<o+p;g++)n.set(g,a+h-1);e.setValue(a,o,v),o+=p}),a+=1}),{colCount:i,cellMatrix:e}}function ly(t){if(!t)return{};const e=/([\w-]+)="([^"]*)"/gi,n=t.matchAll(e),r={};return Array.from(n).forEach(i=>{const[o,a,s]=i;r[a]=s}),r}function pNe(t){const e=/<colgroup([\s\S]*?)>(.*?)<\/colgroup>/,n=t.match(e);if(!n||!n[2])return null;const r=/<col([\s\S]*?)>/g,i=n[2].matchAll(r);return i?Array.from(i).map(o=>ly(o[1])):null}function gNe(t){const e={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&#39;":"'","&nbsp;":" "};return t.replace(/&lt;|&gt;|&amp;|&quot;|&#39;|&nbsp;|<br>/g,n=>e[n])}const vNe={name:"univer-doc-paste-plugin-lark",checkPasteType(t){return/lark-record-clipboard/i.test(t)},stylesRules:[{filter:["s"],getStyle(t){const e=sy(t);return{st:{s:we.TRUE},...e}}}],afterProcessRules:[{filter(t){return t.tagName==="DIV"&&/ace-line/i.test(t.className)},handler(t){t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]},bNe=vNe,_Ne={name:"univer-doc-paste-plugin-word",checkPasteType(t){return/word|mso/i.test(t)},stylesRules:[{filter:["b"],getStyle(t){const e=sy(t);return{bl:we.TRUE,...e}}}],afterProcessRules:[{filter(t){return t.tagName==="P"&&/mso/i.test(t.className)},handler(t,e){t.paragraphs==null&&(t.paragraphs=[]);const n={startIndex:t.dataStream.length},r=mNe(e);r&&(n.paragraphStyle=r),t.paragraphs.push(n),t.dataStream+="\r"}}]},CNe=_Ne;function SNe(t,e,n,r){const i=n.map(u=>{var l;return(l=u.onCopyRow)==null?void 0:l.call(u,t)}).filter(u=>!!u),o=cy(i),a=dy(o),s=e.map(u=>ENe(t,u,n,r)).filter(u=>!!u).join("");return`<tr${a}>${s}</tr>`}function ENe(t,e,n,r){const i=r.getValue(t,e),o=n.map(l=>{var c;return(c=l.onCopyCellStyle)==null?void 0:c.call(l,t,e,i==null?void 0:i.rowSpan,i==null?void 0:i.colSpan)}).filter(l=>!!l),a=cy(o),s=dy(a),u=n.reduce((l,c)=>{var d;return l||((d=c.onCopyCellContent)==null?void 0:d.call(c,t,e))||""},"");return`<td${s}>${u}</td>`}function yNe(t,e){return`<colgroup>${t.map(n=>{const r=e.map(o=>{var a;return(a=o.onCopyColumn)==null?void 0:a.call(o,n)}).filter(o=>!!o),i=cy(r);return`<col ${dy(i)}>`}).join("")}</colgroup>`}function cy(t){return t.reduce((e,n)=>(Object.keys(n).forEach(r=>{e[r]?e[r]+=`;${n[r]}`:e[r]=n[r]}),e),{})}function dy(t){return Object.keys(t).reduce((e,n)=>(e+=` ${n}="${t[n]}"`,e),"")}function DNe(t,e){const n=[];for(let r=t;r<=e;r++)n.push(r);return n}class RNe{convert(e,n,r){const{startColumn:i,endColumn:o}=n,a=yNe(DNe(i,o),r),s=[],{startRow:u,endRow:l,startColumn:c,endColumn:d}=e.getDataRange();for(let m=u;m<=l;m++){const f=Array.from({length:d-c+1},(h,p)=>c+p);s.push(SNe(m,f,r,e))}return`<google-sheets-html-origin><table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" cellpadding="0" dir="ltr" border="1" style="table-layout:fixed;font-size:10pt;font-family:Arial;width:0px;border-collapse:collapse;border:none">${a}
<tbody>${s.join("")}</tbody></table>`}}var INe=Object.defineProperty,ANe=Object.getOwnPropertyDescriptor,TNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?ANe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&INe(e,n,i),i},Su=(t,e)=>(n,r)=>e(n,r,t);const ro={DEFAULT_COPY:"default-copy",DEFAULT_PASTE:"default-paste",SPECIAL_PASTE_VALUE:"special-paste-value",SPECIAL_PASTE_FORMAT:"special-paste-format",SPECIAL_PASTE_COL_WIDTH:"special-paste-col-width",SPECIAL_PASTE_BESIDES_BORDER:"special-paste-besides-border"};uy.use(CNe);uy.use(bNe);const r2=ln("sheet.clipboard-service");let eC=class extends We{constructor(e,n,r,i,o,a,s,u){super(),H(this,"_clipboardHooks",[]),H(this,"_clipboardHooks$",new dn([])),H(this,"clipboardHooks$",this._clipboardHooks$.asObservable()),H(this,"_htmlToUSM"),H(this,"_usmToHtml"),H(this,"_copyContentCache"),H(this,"_copyMarkId",null),this._logService=e,this._currentUniverService=n,this._selectionManagerService=r,this._clipboardInterfaceService=i,this._undoRedoService=o,this._commandService=a,this._markSelectionService=s,this._sheetSkeletonManagerService=u,this._htmlToUSM=new uy({getCurrentSkeleton:()=>this._sheetSkeletonManagerService.getCurrent()}),this._usmToHtml=new RNe,this._copyContentCache=new uNe}copyContentCache(){return this._copyContentCache}async copy(e=_s.COPY){const n=this._selectionManagerService.getLast();if(!n)return!1;const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=this._clipboardHooks;o.forEach(m=>{var f;return(f=m.onBeforeCopy)==null?void 0:f.call(m,r.getUnitId(),i.getSheetId(),n.range)});const a=this._generateCopyContent(r.getUnitId(),i.getSheetId(),n.range,o);if(!a)return!1;const{html:s,plain:u,matrixFragment:l,copyId:c}=a;this._copyContentCache.set(c,{unitId:r.getUnitId(),subUnitId:i.getSheetId(),range:n.range,matrix:l,copyType:e}),await this._clipboardInterfaceService.write(u,s),this._markSelectionService.removeAllShapes();const d=this._selectionManagerService.createCopyPasteSelection();return this._copyMarkId=this._markSelectionService.addShape({...n,style:d}),o.forEach(m=>{var f;return(f=m.onAfterCopy)==null?void 0:f.call(m)}),!0}async cut(){return this.copy(_s.CUT)}async paste(e,n=ro.DEFAULT_PASTE){const r=e.types,i=r.indexOf(Mm)!==-1?await e.getType(Mm).then(a=>a&&a.text()):"",o=r.indexOf(Nm)!==-1?await e.getType(Nm).then(a=>a&&a.text()):"";return o?this._pasteHTML(o,n):i?this._pastePlainText(i,n):(this._logService.error("[SheetClipboardService]","No valid data on clipboard"),!1)}legacyPaste(e,n){return e?this._pasteHTML(e,ro.DEFAULT_PASTE):n?this._pastePlainText(n,ro.DEFAULT_PASTE):Promise.resolve(!1)}addClipboardHook(e){if(this._clipboardHooks.findIndex(r=>r.id===e.id)!==-1)return this._logService.error("[SheetClipboardService]","hook already exists",e.id),{dispose:()=>{}};const n=this._clipboardHooks.findIndex(r=>{const i=r.priority||0;return(e.priority||0)<i});return this._clipboardHooks.splice(n!==-1?n:this._clipboardHooks.length,0,e),this._notifyClipboardHook(),je(()=>{const r=this._clipboardHooks.indexOf(e);r>-1&&(this._clipboardHooks.splice(r,1),this._notifyClipboardHook())})}getClipboardHooks(){return this._clipboardHooks}_generateCopyContent(e,n,r,i){const o=this._currentUniverService.getUniverSheetInstance(e),a=o==null?void 0:o.getSheetBySheetId(n);if(!o||!a)return null;i.reduce((v,g)=>{var b;const C=(b=g.getFilteredOutRows)==null?void 0:b.call(g);return C==null||C.forEach(S=>v.add(S)),v},new Set);const{startColumn:s,startRow:u,endColumn:l,endRow:c}=r,d=a.getMatrixWithMergedCells(u,s,c,l),m=new Ye;for(let v=u;v<=c;v++)for(let g=s;g<=l;g++){const b=d.getValue(v,g);b?m.setValue(v-u,g-s,{...YT(),...Ie.deepClone(b)}):m.setValue(v-u,g-s,YT())}let f=this._usmToHtml.convert(d,r,i);const h=wNe(m),p=aNe();return f=f.replace(/(<[a-z]+)/,(v,g)=>`${g} data-copy-id="${p}"`),{copyId:p,plain:h,html:f,matrixFragment:m}}_notifyClipboardHook(){this._clipboardHooks$.next(this._clipboardHooks)}async _pastePlainText(e,n){const r=this._getPastingTarget();if(!r.selection)return!1;const i=r.selection.range,{unitId:o,subUnitId:a}=r,s=this._clipboardHooks,u=[];if(s.some(m=>{var f;return u.push(m)&&((f=m.onBeforePaste)==null?void 0:f.call(m,{unitId:o,subUnitId:a,range:i}))===!1}))return u.forEach(m=>{var f;return(f=m.onAfterPaste)==null?void 0:f.call(m,!1)}),!1;const l=[],c=[];u.forEach(m=>{var f;const h=(f=m.onPastePlainText)==null?void 0:f.call(m,{unitId:o,subUnitId:a,range:i},e,{pasteType:n});h&&(l.push(...h.redos),c.push(...h.undos))});const d=l.every(m=>this._commandService.executeCommand(m.id,m.params));return d&&this._undoRedoService.pushUndoRedo({unitID:this._currentUniverService.getCurrentUniverSheetInstance().getUnitId(),undoMutations:c,redoMutations:l}),d}async _pasteHTML(e,n){const r=sNe(e);return r&&this._copyContentCache.get(r)?this._pasteInternal(r,n):this._pasteExternal(e,n)}async _pasteExternal(e,n){const r=this._getPastingTarget(),{selection:i,unitId:o,subUnitId:a}=r;if(!i)return!1;const{rowProperties:s,colProperties:u,cellMatrix:l}=this._htmlToUSM.convert(e),{startColumn:c,endColumn:d,startRow:m,endRow:f}=l.getDataRange(),h=f-m+1,p=d-c+1;if(!l||d<c||f<m)return!1;const v=this._transformPastedData(h,p,l,i.range);return v?this._pasteUSM({rowProperties:s,colProperties:u,cellMatrix:l},{unitId:o,subUnitId:a,pastedRange:v},n):!1}async _pasteInternal(e,n){var r,i;const o=this._getPastingTarget(),{selection:a,unitId:s,subUnitId:u}=o,l=Ie.deepClone(this._copyContentCache.get(e)),{range:c,matrix:d,unitId:m,subUnitId:f}=l||{};if(!a||!d||!l||!c||!m||!f||!a||!d||!l)return!1;const h=(r=this._currentUniverService.getUniverSheetInstance(m))==null?void 0:r.getStyles();d.forValue((N,B,W)=>{if(typeof W.s=="string"){const G=Ie.deepClone(W);G.s=h==null?void 0:h.getStyleByCell(W),d.setValue(N,B,G)}});const{startColumn:p,endColumn:v,startRow:g,endRow:b}=c,C=this._transformPastedData(b-g+1,v-p+1,d,a.range);if(!C)return!1;const S=(i=this._currentUniverService.getUniverSheetInstance(m))==null?void 0:i.getSheetBySheetId(f);if(!S)return!1;const E=S.getColumnManager(),y=S.getRowManager(),D=S.getConfig().defaultColumnWidth,R=S.getConfig().defaultRowHeight,I=[],T=[];for(let N=p;N<=v;N++){const B=E.getColumnOrCreate(N);I.push({width:`${B.w||D}`})}for(let N=g;N<=b;N++){const B=y.getRowOrCreate(N);T.push({height:`${B.h||R}`})}const P=this._pasteUSM({cellMatrix:d,colProperties:I,rowProperties:T},{unitId:s,subUnitId:u,pastedRange:C},n,{range:c,unitId:l.unitId,subUnitId:l.subUnitId,copyType:l.copyType,copyId:e});return l.copyType===_s.CUT&&(this._copyContentCache.set(e,{...l,matrix:null}),this._copyMarkId&&this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null),P}_pasteUSM(e,n,r,i){const{rowProperties:o,colProperties:a,cellMatrix:s}=e,{unitId:u,subUnitId:l,pastedRange:c}=n,{startColumn:d,endColumn:m}=c,f=m-d+1,h=this._clipboardHooks,p=[];if(h.some(y=>{var D;return p.push(y)&&((D=y.onBeforePaste)==null?void 0:D.call(y,{unitId:u,subUnitId:l,range:c}))===!1}))return p.forEach(y=>{var D;return(D=y.onAfterPaste)==null?void 0:D.call(y,!1)}),!1;if(!s)return!1;const v=i?{unitId:i.unitId,subUnitId:i.subUnitId,range:i.range}:null,g={copyType:(i==null?void 0:i.copyType)||_s.COPY,copyId:i==null?void 0:i.copyId,pasteType:r},b=[],C=[];p.filter(y=>!y.specialPasteInfo&&y.id!==ro.DEFAULT_PASTE||r===y.id).forEach(y=>{var D,R,I;if(o){const N=(D=y.onPasteRows)==null?void 0:D.call(y,{range:c,unitId:u,subUnitId:l},o,{pasteType:r});N&&(b.push(...N.redos),C.push(...N.undos))}const T=(R=y.onPasteColumns)==null?void 0:R.call(y,{range:c,unitId:u,subUnitId:l},a||new Array(f).map(()=>({})),{pasteType:r});T&&(b.push(...T.redos),C.push(...T.undos));const P=(I=y.onPasteCells)==null?void 0:I.call(y,v,{range:c,unitId:u,subUnitId:l},s,g);P&&(b.push(...P.redos),C.push(...P.undos))});const S=this._getSetSelectionOperation(u,l,c,s);S&&b.push(S),this._logService.log("[SheetClipboardService]","pasting mutations",{undoMutationsInfo:C,redoMutationsInfo:b});const E=b.every(y=>this._commandService.executeCommand(y.id,y.params));return E&&this._undoRedoService.pushUndoRedo({unitID:u,undoMutations:C,redoMutations:b}),E}_getSetSelectionOperation(e,n,r,i){var o;const a=(o=this._currentUniverService.getUniverSheetInstance(e))==null?void 0:o.getSheetBySheetId(n);if(!a)return null;const{startRow:s,startColumn:u}=r,l=yo({startRow:s,endRow:s,startColumn:u,endColumn:u},a),c=i.getValue(0,0),d=(c==null?void 0:c.rowSpan)||1,m=(c==null?void 0:c.colSpan)||1;if(d>1||m>1){const h={startRow:s,endRow:s+d-1,startColumn:u,endColumn:u+m-1};l.startRow=h.startRow,l.endRow=h.endRow,l.startColumn=h.startColumn,l.endColumn=h.endColumn,l.isMerged=!0,l.isMergedMainCell=!0}const f={unitId:e,subUnitId:n,pluginName:Nn,selections:[{range:r,primary:l,style:null}]};return{id:_n.id,params:f}}_getPastingTarget(){const e=this._currentUniverService.getCurrentUniverSheetInstance(),n=e.getActiveSheet(),r=this._selectionManagerService.getLast();return{unitId:e.getUnitId(),subUnitId:n.getSheetId(),selection:r}}_transformPastedData(e,n,r,i){const{startRow:o,startColumn:a,endRow:s,endColumn:u}=i,l=s-o+1,c=u-a+1,d=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getMergeData().filter(g=>ht.intersects({startRow:o,startColumn:a,endRow:s,endColumn:u},g)),m=d[0];let f=0,h=0,p=0,v=0;if(m&&(f=m.startRow,h=m.startColumn,p=m.endRow,v=m.endColumn),l%e===0&&c%n===0)if(d.length>0&&(l!==e||c!==n))if(f===o&&h===a&&p===s&&v===u)if(NNe(r))for(let g=0;g<l;g++)for(let b=0;b<c;b++){const C=r.getValue(g%e,b%n);C&&r.setValue(g,b,C)}else r.forValue((g,b,C)=>{C.s=null,delete C.colSpan,delete C.rowSpan});else for(let g=0;g<l;g++)for(let b=0;b<c;b++){const C=r.getValue(g%e,b%n);C&&r.setValue(g,b,C)}else for(let g=0;g<l;g++)for(let b=0;b<c;b++){const C=r.getValue(g%e,b%n);C&&r.setValue(g,b,C)}else if(d.length>0)if(this._topLeftCellsMatch(e,n,i))i.endRow=o+e-1,i.endColumn=a+n-1;else{if(s>m.endRow||u>m.endColumn)return null;r.forValue((g,b,C)=>{C.s=null,delete C.colSpan,delete C.rowSpan})}else i.endRow=o+e-1,i.endColumn=a+n-1;return i}_topLeftCellsMatch(e,n,r){const i=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet(),{startRow:o,startColumn:a,endRow:s,endColumn:u}=r,l=PNe(o+e-1,a,a+e-1,i),c=MNe(a+n-1,o,o+e-1,i);return!l&&!c}};eC=TNe([Su(0,oo),Su(1,ae),Su(2,K(dt)),Su(3,$s),Su(4,en),Su(5,se),Su(6,B8),Su(7,K(Dr))],eC);function wNe(t){let e="";return t.forRow((n,r)=>{const i=[];r.forEach(o=>{const a=t.getValue(n,o);if(a){const s=LNe(a);i.push(s)}}),e+=i.join("	"),n!==t.getLength()-1&&(e+=`
`)}),e}function LNe(t){const e=t.v;return ONe((e==null?void 0:e.toString())||"")}const ONe=t=>t.replace(/&/g,"&amp;").replace(/\uFEFF/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");function PNe(t,e,n,r){return r.getMergeData().some(i=>i.startRow<=t&&t<i.endRow&&e<=i.startColumn&&i.startColumn<=n)}function MNe(t,e,n,r){return r.getMergeData().some(i=>i.startColumn<=t&&t<i.endColumn&&e<=i.startRow&&i.startRow<=n)}function NNe(t){let e=0;return t.forValue((n,r,i)=>{if(i&&e++,e>1)return!1}),e>1}function YT(){return{p:null,v:null,s:null,f:null,si:null,t:null}}const my=998,xNe={id:vf.id,name:"sheet.command.copy",type:ue.COMMAND,multi:!0,priority:my,preconditions:ay,handler:async t=>t.get(r2).copy()},FNe={id:d8.id,name:"sheet.command.cut",type:ue.COMMAND,multi:!0,priority:my,preconditions:ay,handler:async t=>t.get(r2).cut()},gd={id:bf.id,type:ue.COMMAND,multi:!0,name:"sheet.command.paste",priority:my,preconditions:ay,handler:async(t,e)=>{const n=t.get(oo);if(n.debug("[SheetPasteCommand]","the focusing element is",document.activeElement),!document.execCommand("paste")){n.debug("[SheetPasteCommand]","failed to execute paste command on the activeElement, trying to use clipboard API.");const r=await t.get($s).read(),i=t.get(r2);return r.length!==0?i.paste(r[0],e==null?void 0:e.value):!1}return!1}},LV={id:"sheet.command.paste-value",type:ue.COMMAND,handler:async t=>t.get(se).executeCommand(gd.id,{value:ro.SPECIAL_PASTE_VALUE})},OV={id:"sheet.command.paste-format",type:ue.COMMAND,handler:async t=>t.get(se).executeCommand(gd.id,{value:ro.SPECIAL_PASTE_FORMAT})},PV={id:"sheet.command.paste-col-width",type:ue.COMMAND,handler:async t=>t.get(se).executeCommand(gd.id,{value:ro.SPECIAL_PASTE_COL_WIDTH})},MV={id:"sheet.command.paste-besides-border",type:ue.COMMAND,handler:async t=>t.get(se).executeCommand(gd.id,{value:ro.SPECIAL_PASTE_BESIDES_BORDER})};var $Ne=Object.defineProperty,kNe=Object.getOwnPropertyDescriptor,BNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?kNe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&$Ne(e,n,i),i},XT=(t,e)=>(n,r)=>e(n,r,t);let Vm=class{constructor(e,n){H(this,"_current",null),H(this,"_shortcutParam",[]),this._currentUniverService=e,this._localeService=n}dispose(){this._shortcutParam=[]}getCurrentBySearch(e){return this._getCurrentBySearch(e)}getCurrent(){return this._getCurrentBySearch(this._current)}addOrUpdate(e){const n=this._getCurrentBySearch({unitId:e.unitId,sheetId:e.sheetId,keycode:e.keycode});if(n!=null){const r=this._shortcutParam.indexOf(n);this._shortcutParam.splice(r,1)}return this._shortcutParam.push(e),n}remove(e){if(e==null)return;const n=this._getCurrentBySearch(e);if(n==null)return;const r=this._shortcutParam.indexOf(n);return this._shortcutParam.splice(r,1)[0]}_getCurrentBySearch(e){return e==null?void 0:this._shortcutParam.find(n=>n.unitId===e.unitId&&n.sheetId===e.sheetId&&n.keycode===e.keycode)}};Vm=BNe([XT(0,ae),XT(1,K(Gt))],Vm);function Vu(t,e,n,r,i=!0,o=1,a=!0){let s={...t};r==null&&(r={startRow:0,endRow:n.getRowCount()-1,startColumn:0,endColumn:n.getColumnCount()-1});let u;switch(e){case ye.UP:for(u=t.startRow-o;u>-1&&!n.getRowVisible(u);)u-=1;u>=r.startRow?(s.startRow=u,s.endRow=u):a&&(s.startRow=r.endRow,s.endRow=r.endRow,i&&(s=Vu(s,ye.LEFT,n,r,!1)));break;case ye.DOWN:for(u=t.endRow+o;u<n.getRowCount()&&!n.getRowVisible(u);)u+=1;u<=r.endRow?(s.startRow=u,s.endRow=u):a&&(s.startRow=r.startRow,s.endRow=r.startRow,i&&(s=Vu(s,ye.RIGHT,n,r,!1)));break;case ye.LEFT:for(u=t.startColumn-o;u>-1&&!n.getColVisible(u);)u-=1;u>=r.startColumn?(s.startColumn=u,s.endColumn=u):a&&(s.startColumn=r.endColumn,s.endColumn=r.endColumn,i&&(s=Vu(s,ye.UP,n,r,!1)));break;case ye.RIGHT:for(u=t.endColumn+o;u<n.getColumnCount()&&!n.getColVisible(u);)u+=1;u<=r.endColumn?(s.startColumn=u,s.endColumn=u):a&&(s.startColumn=r.startColumn,s.endColumn=r.startColumn,i&&(s=Vu(s,ye.DOWN,n,r,!1)));break}return s}function fy(t,e,n){const r={...t},{startRow:i,startColumn:o,endRow:a,endColumn:s}=Hm(t,e,n);let u=Qd(n,i,o,a,s).hasValue,l=!0,c=!0;for(;c;){if(ye.UP===e){let d=r.startRow-1;for(;d>-1&&!n.getRowVisible(d);)d-=1;if(d===-1){c=!1;break}const{hasValue:m,matrix:f}=Qd(n,d,r.startColumn,d,r.endColumn);if(u&&!m&&!l){c=!1;break}else{if(f.getLength()!==0){let h=d;f.forValue(p=>{h=Math.min(p,h)}),r.startRow=h}else r.startRow=d;if(r.endRow=r.startRow,!u&&m){c=!1;break}u=m,l=!1}}if(ye.DOWN===e){let d=r.endRow+1;for(;d<n.getRowCount()&&!n.getRowVisible(d);)d+=1;if(d===n.getRowCount()){c=!1;break}const{hasValue:m,matrix:f}=Qd(n,d,r.startColumn,d,r.endColumn);if(u&&!m&&!l){c=!1;break}else{if(f.getLength()!==0){let h=d;f.forValue((p,v,g)=>{h=Math.max(p+(g.rowSpan||1)-1,h)}),r.endRow=h}else r.endRow=d;if(r.startRow=r.endRow,!u&&m){c=!1;break}u=m,l=!1}}if(ye.LEFT===e){let d=r.startColumn-1;for(;d>-1&&!n.getColVisible(d);)d-=1;if(d===-1){c=!1;break}const{hasValue:m,matrix:f}=Qd(n,r.startRow,d,r.endRow,d);if(u&&!m&&!l){c=!1;break}else{if(f.getLength()!==0){let h=d;f.forValue((p,v)=>{h=Math.min(v,h)}),r.startColumn=h}else r.startColumn=d;if(r.endColumn=r.startColumn,!u&&m){c=!1;break}u=m,l=!1}}if(ye.RIGHT===e){let d=r.endColumn+1;for(;d<n.getColumnCount()&&!n.getColVisible(d);)d+=1;if(d===n.getColumnCount()){c=!1;break}const{hasValue:m,matrix:f}=Qd(n,r.startRow,d,r.endRow,d);if(u&&!m&&!l){c=!1;break}else{if(f.getLength()!==0){let h=d;f.forValue((p,v,g)=>{h=Math.max(v+(g.colSpan||1)-1,h)}),r.endColumn=h}else r.endColumn=d;if(r.startColumn=r.endColumn,!u&&m){c=!1;break}u=m,l=!1}}}return ca(r,n,!0)}function NV(t,e,n){return Vu(t,e,n,void 0,!1,1,!1)}function UNe(t,e,n){const r=fy(t,e,n);return ca(ht.union(r,t),n,!0)}function VNe(t,e,n){const r=NV(t,e,n),i={startRow:Math.min(t.startRow,r.startRow),startColumn:Math.min(t.startColumn,r.startColumn),endRow:Math.max(t.endRow,r.endRow),endColumn:Math.max(t.endColumn,r.endColumn)};return ca(ht.union(t,i),n)}function HNe(t,e,n,r){const i=hL(n),o=fy(Hm(t,i,r),n,r);return n===ye.UP&&o.startRow<=t.startRow?ca({...e,startColumn:t.startColumn,endColumn:t.endColumn},r,!0):n===ye.DOWN&&o.endRow>=t.endRow?ca({...e,startColumn:t.startColumn,endColumn:t.endColumn},r,!0):n===ye.LEFT&&o.startColumn<=t.startColumn?ca({...e,startRow:t.startRow,endRow:t.endRow},r,!0):n===ye.RIGHT&&o.endColumn>=t.endColumn?ca({...e,startRow:t.startRow,endRow:t.endRow},r,!0):ht.union(ht.clone(e),o)}function jNe(t,e,n){const r=hL(e),i=Hm(t,r,n),o=Hm(t,e,n),a=NV(i,e,n);return ca(ht.union(o,a),n,!1)}function zNe(t,e,n){const{left:r,right:i,up:o,down:a}=e,s=n.getMaxRows(),u=n.getMaxColumns();let l=!0;const c={...t};for(;l;){if(l=!1,o&&c.startRow!==0){const d=c.startRow-1;n.getMatrixWithMergedCells(d,c.startColumn,d,c.endColumn).forValue((m,f,h)=>{h.v&&(c.startRow=Math.min(m,c.startRow),c.startColumn=Math.min(f,c.startColumn),c.endColumn=Math.max(f,c.endColumn),l=!0)})}if(a&&c.endRow!==s-1){const d=c.endRow+1;n.getMatrixWithMergedCells(d,c.startColumn,d,c.endColumn).forValue((m,f,h)=>{h.v&&(c.endRow=Math.max(m+(h.rowSpan!==void 0?h.rowSpan-1:0),c.endRow),c.startColumn=Math.min(f,c.startColumn),c.endColumn=Math.max(f,c.endColumn),l=!0)})}if(r&&c.startColumn!==0){const d=c.startColumn-1;n.getMatrixWithMergedCells(c.startRow,d,c.endRow,d).forValue((m,f,h)=>{h.v&&(c.startColumn=Math.min(f,c.startColumn),c.startRow=Math.min(m,c.startRow),c.endRow=Math.max(m,c.endRow),l=!0)})}if(i&&c.endColumn!==u-1){const d=c.endColumn+1;n.getMatrixWithMergedCells(c.startRow,d,c.endRow,d).forValue((m,f,h)=>{h.v&&(c.endColumn=Math.max(f+(h.colSpan!==void 0?h.colSpan-1:0),c.endColumn),c.startRow=Math.min(m,c.startRow),c.endRow=Math.max(m,c.endRow),l=!0)})}}return c}function qT(t){return{startRow:0,startColumn:0,endRow:t.getRowCount()-1,endColumn:t.getColumnCount()-1,rangeType:ct.ALL}}function Hm(t,e,n){let r;switch(e){case ye.UP:r={startRow:t.startRow,startColumn:t.startColumn,endRow:t.startRow,endColumn:t.endColumn,rangeType:ct.NORMAL};break;case ye.DOWN:r={startRow:t.endRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:ct.NORMAL};break;case ye.LEFT:r={startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.startColumn,rangeType:ct.NORMAL};break;case ye.RIGHT:r={startRow:t.startRow,startColumn:t.endColumn,endRow:t.endRow,endColumn:t.endColumn,rangeType:ct.NORMAL};break;default:throw new Error("Invalid direction")}return ca(r,n,!1)}function Qd(t,e,n,r,i){let o=!1;const a=t.getMatrixWithMergedCells(e,n,r,i).forValue((s,u,l)=>{if(l.v)return o=!0,!1});return{hasValue:o,matrix:a}}function tC(t,e,n){const r=ht.clone(t);if(e==null)return r;switch(n){case ye.UP:case ye.DOWN:r.startColumn=r.endColumn=e.actualColumn;break;case ye.LEFT:case ye.RIGHT:r.startRow=r.endRow=e.actualRow;break}return r}function WNe(t,e,n){const{primary:r,range:i}=t,o=ht.clone(i);switch(e){case ye.UP:case ye.DOWN:o.startRow=r.startRow,o.endRow=r.endRow;break;case ye.LEFT:case ye.RIGHT:o.startColumn=r.startColumn,o.endColumn=r.endColumn;break}const a=Hm(o,e,n);switch(e){case ye.DOWN:return i.startRow<a.startRow;case ye.UP:return i.endRow>a.endRow;case ye.LEFT:return a.endColumn<i.endColumn;case ye.RIGHT:return a.startColumn>i.startColumn}}function xV(t,e){let n=t[0].startRow,r=t[0].endRow;t.forEach(o=>{const{startRow:a,endRow:s}=o;n=Math.min(n,a),r=Math.max(r,s)});const i=new Array(r-n+1).fill(!1);return e.forEach(o=>{const{startRow:a,endRow:s}=o;for(let u=Math.max(a,n);u<=Math.min(s,r);u++)i[u-n]=!0}),t.every(o=>{const{startRow:a,endRow:s}=o;for(let u=a;u<=s;u++)if(!i[u-n])return!1;return!0})}function FV(t,e){let n=t[0].startColumn,r=t[0].endColumn;t.forEach(o=>{const{startColumn:a,endColumn:s}=o;n=Math.min(n,a),r=Math.max(r,s)});const i=new Array(r-n+1).fill(!1);return e.forEach(o=>{const{startColumn:a,endColumn:s}=o;for(let u=Math.max(a,n);u<=Math.min(s,r);u++)i[u-n]=!0}),t.every(o=>{const{startColumn:a,endColumn:s}=o;for(let u=a;u<=s;u++)if(!i[u-n])return!1;return!0})}var xs=(t=>(t[t.moveStopeOne=0]="moveStopeOne",t[t.moveGap=1]="moveGap",t[t.moveStepPage=2]="moveStepPage",t[t.moveStepEnd=3]="moveStepEnd",t))(xs||{});const vo={id:"sheet.command.move-selection",type:ue.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(dt).getLast();if(!i)return!1;const{direction:o,jumpOver:a}=e,{range:s,primary:u}=i,l=tC(s,u,o),c=a===1?fy(l,o,r):Vu(l,o,r),d=k9(c.startRow,c.startColumn,r);return ht.equals(d,l)?!1:(t.get(Vm).remove({unitId:n.getUnitId(),sheetId:r.getSheetId(),keycode:Ge.TAB}),t.get(se).executeCommand(_n.id,{unitId:n.getUnitId(),subUnitId:r.getSheetId(),pluginName:Nn,selections:[{range:ht.clone(d),primary:{startRow:d.startRow,startColumn:d.startColumn,endRow:d.endRow,endColumn:d.endColumn,actualRow:c.startRow,actualColumn:c.startColumn,isMerged:d.isMerged,isMergedMainCell:d.startRow===c.startRow&&d.startColumn===c.startColumn}}]}))}},i2={id:"sheet.command.move-selection-enter-tab",type:ue.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(dt).getLast(),o=n.getUnitId(),a=r.getSheetId();if(!i)return!1;const{direction:s,keycode:u}=e,{range:l,primary:c}=i;let d=tC(l,c,s);const m=t.get(Vm),f=m.getCurrentBySearch({unitId:o,sheetId:a,keycode:Ge.TAB});let h;const{startRow:p,endRow:v,startColumn:g,endColumn:b}=l;if(ht.equals(l,c)){if(u===Ge.TAB)f==null&&m.addOrUpdate({unitId:o,sheetId:a,keycode:Ge.TAB,selection:i});else{const E=f==null?void 0:f.selection;if(E!=null){const{range:y,primary:D}=E;d=tC(y,D,s)}m.remove({unitId:o,sheetId:a,keycode:Ge.TAB})}const C=Vu(d,s,r),S=k9(C.startRow,C.startColumn,r);if(ht.equals(S,d))return!1;h={range:ht.clone(S),primary:{startRow:S.startRow,startColumn:S.startColumn,endRow:S.endRow,endColumn:S.endColumn,actualRow:C.startRow,actualColumn:C.startColumn,isMerged:S.isMerged,isMergedMainCell:S.startRow===C.startRow&&S.startColumn===C.startColumn}}}else{m.remove({unitId:o,sheetId:a,keycode:Ge.TAB});const C=Ie.deepClone(c),S=Vu({startRow:C.startRow,startColumn:C.startColumn,endRow:C.endRow,endColumn:C.endColumn},s,r,{startRow:p,endRow:v,startColumn:g,endColumn:b}),E=k9(S.startRow,S.startColumn,r);h={range:ht.clone(l),primary:{startRow:E.startRow,startColumn:E.startColumn,endRow:E.endRow,endColumn:E.endColumn,actualRow:S.startRow,actualColumn:S.startColumn,isMerged:E.isMerged,isMergedMainCell:E.startRow===S.startRow&&E.startColumn===S.startColumn}}}return t.get(se).executeCommand(_n.id,{unitId:o,subUnitId:a,pluginName:Nn,selections:[h]})}},Fs={id:"sheet.command.expand-selection",type:ue.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(dt).getLast();if(!i)return!1;const{range:o,primary:a}=i,{jumpOver:s,direction:u}=e,l=WNe(i,u,r)?s===1?HNe(o,{...ht.clone(a),rangeType:ct.NORMAL},u,r):jNe(o,u,r):s===1?UNe(o,u,r):VNe(o,u,r);return ht.equals(l,o)?!1:t.get(se).executeCommand(_n.id,{unitId:n.getUnitId(),subUnitId:r.getSheetId(),pluginName:Nn,selections:[{range:l,primary:a}]})}};let zs=[],Vg="";const $V={id:"sheet.command.select-all",type:ue.COMMAND,onDispose(){zs=[],Vg=""},handler:async(t,e={expandToGapFirst:!0,loop:!1})=>{const n=t.get(dt).getLast(),r=t.get(ae).getCurrentUniverSheetInstance(),i=r.getActiveSheet();if(!n||!i)return!1;const o=`${r.getUnitId()}|${i.getSheetId()}`;o!==Vg&&(zs=[],Vg=o);const a=i.getMaxRows(),s=i.getMaxColumns(),{expandToGapFirst:u,loop:l}=e,{range:c,primary:d}=n,m=c.endColumn===s-1&&c.endRow===a-1&&c.startRow===0&&c.startColumn===0;zs.some(h=>ht.equals(h,c))||(zs=[],zs.push(c));let f;if(m)if(l){if(zs.findIndex(h=>ht.equals(h,c))!==zs.length-1)return!1;f=zs[0]}else return!1;else u?(f=zNe(c,{left:!0,right:!0,up:!0,down:!0},i),ht.equals(f,c)&&(f=qT(i))):f=qT(i);return zs.some(h=>ht.equals(h,f))||zs.push(f),t.get(se).executeCommand(_n.id,{unitId:r.getUnitId(),subUnitId:i.getSheetId(),pluginName:Nn,selections:[{range:f,primary:d}]})}};var YNe=Object.defineProperty,XNe=Object.getOwnPropertyDescriptor,qNe=(t,e,n,r)=>{for(var i=r>1?void 0:r?XNe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&YNe(e,n,i),i},Q3=(t,e)=>(n,r)=>e(n,r,t);const GNe=Q0("BEFORE_CELL_EDIT"),KNe=Q0("AFTER_CELL_EDIT");let nC=class extends We{constructor(e,n,r,i){super(),H(this,"_editorUnitId",Qr),H(this,"_isForceKeepVisible",!1),H(this,"_editorIsDirty",!1),H(this,"_visible",{visible:!1,eventType:dr.Dblclick}),H(this,"_currentEditCell",null),H(this,"_currentEditCellState",null),H(this,"_currentEditCellState$",new dn(null)),H(this,"currentEditCellState$",this._currentEditCellState$.asObservable()),H(this,"_visible$",new dn(this._visible)),H(this,"visible$",this._visible$.asObservable()),H(this,"_afterVisible$",new dn(this._visible)),H(this,"afterVisible$",this._afterVisible$.asObservable()),H(this,"interceptor",new eO({BEFORE_CELL_EDIT:GNe,AFTER_CELL_EDIT:KNe})),this._sheetSkeletonManagerService=e,this._selectionRenderService=n,this._themeService=r,this._currentUniverService=i,this.disposeWithMe(je(()=>{this._currentEditCellState$.complete(),this._currentEditCell=null})),this.disposeWithMe(je(this.interceptor.intercept(this.interceptor.getInterceptPoints().AFTER_CELL_EDIT,{priority:-1,handler:o=>o}))),this.disposeWithMe(je(this.interceptor.intercept(this.interceptor.getInterceptPoints().BEFORE_CELL_EDIT,{priority:-1,handler:o=>o})))}refreshEditCellState(){const e=this.getLatestEditCellState();this._currentEditCellState=e,this._currentEditCellState$.next(e)}setEditCell(e){this._currentEditCell=e;const n=this.getLatestEditCellState();this._currentEditCellState=n,this._currentEditCellState$.next(n)}getEditCellState(){return this._currentEditCellState}getLatestEditCellState(){var e,n;const r=this._currentEditCell;if(r==null)return;const i=this._sheetSkeletonManagerService.getCurrent();if(i==null)return;const{skeleton:o}=i,{primary:a,unitId:s,sheetId:u,scene:l,engine:c}=r,{startRow:d,startColumn:m}=a,f=this._selectionRenderService.convertCellRangeToInfo(a);if(f==null)return;const h=xC(f);if(h==null)return;const p=pF(c);let{startX:v,startY:g,endX:b,endY:C}=h;const{scaleX:S,scaleY:E}=l.getAncestorScale(),{scaleX:y,scaleY:D}=l.getPrecisionScale(),R=l.getScrollXY(this._selectionRenderService.getViewPort());v=rn(o.convertTransformToOffsetX(v,S,R),y),g=rn(o.convertTransformToOffsetY(g,E,R),D),b=rn(o.convertTransformToOffsetX(b,S,R),y),C=rn(o.convertTransformToOffsetY(C,E,R),D);const I=this._currentUniverService.getCurrentUniverSheetInstance(),T=I.getActiveSheet(),P={workbook:I,worksheet:T,unitId:I.getUnitId(),subUnitId:T.getSheetId(),row:d,col:m},N=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().BEFORE_CELL_EDIT)(T.getCell(d,m),P);let B=N&&o.getCellDocumentModelWithFormula(N);if(!B||B.documentModel==null){const W=o.getBlankCellDocumentModel(N);if(B!=null){const{verticalAlign:G,horizontalAlign:Q,wrapStrategy:te,textRotation:X,fill:x}=B,{centerAngle:O,vertexAngle:M}=Vx(X);W.documentModel.documentStyle.renderConfig={verticalAlign:G,horizontalAlign:Q,wrapStrategy:te,background:{rgb:x},centerAngle:O,vertexAngle:M}}B=W}if((e=B.documentModel)==null||e.setZoomRatio(Math.max(S,E)),(N==null?void 0:N.isInArrayFormulaRange)===!0){const W=(n=B.documentModel)==null?void 0:n.getBody();W&&(W.textRuns=[{st:0,ed:W.dataStream.length-2,ts:{cl:{rgb:this._themeService.getCurrentTheme().textColorSecondary}}}])}return{position:{startX:v,startY:g,endX:b,endY:C},scaleX:S,scaleY:E,canvasOffset:p,row:d,column:m,unitId:s,sheetId:u,documentLayoutObject:B,editorUnitId:this._editorUnitId,isInArrayFormulaRange:N==null?void 0:N.isInArrayFormulaRange}}getCurrentEditorId(){return this._editorUnitId}changeVisible(e){this._visible=e,e.visible&&(this._editorIsDirty=!1),this._visible$.next(this._visible),this._afterVisible$.next(this._visible)}isVisible(){return this._visible}enableForceKeepVisible(){this._isForceKeepVisible=!0}disableForceKeepVisible(){this._isForceKeepVisible=!1}isForceKeepVisible(){return this._isForceKeepVisible}changeEditorDirty(e){this._editorIsDirty=e}getEditorDirty(){return this._editorIsDirty}};nC=qNe([Q3(0,K(Dr)),Q3(1,Hi),Q3(2,K(_i)),Q3(3,ae)],nC);const Oo=ln("univer.sheet-editor-bridge.service"),v1={id:"sheet.operation.set-cell-edit-visible",type:ue.OPERATION,handler:(t,e)=>{const n=t.get(Oo);return e==null?!1:(n.changeVisible(e),!0)}},z9={id:"sheet.operation.set-cell-edit-visible-arrow",type:ue.OPERATION,handler:()=>!0};let Pl=class{constructor(){H(this,"_scrollInfo",new Map),H(this,"_currentScroll",null),H(this,"_scrollInfo$",new dn(null)),H(this,"scrollInfo$",this._scrollInfo$.asObservable())}dispose(){this._scrollInfo$.complete()}setCurrentScroll(e){this._currentScroll=e,this._refresh(e)}getScrollByParam(e){return this._getCurrentScroll(e)}getCurrentScroll(){return this._getCurrentScroll(this._currentScroll)}addOrReplace(e){this._currentScroll!=null&&this._addByParam({...this._currentScroll,...e})}addOrReplaceNoRefresh(e){this._currentScroll!=null&&this._addByParam({...this._currentScroll,...e},!1)}addOrReplaceByParam(e){this._addByParam(e)}clear(){this._currentScroll!=null&&this._clearByParam(this._currentScroll)}_addByParam(e,n=!0){const{unitId:r,sheetId:i,sheetViewStartColumn:o,sheetViewStartRow:a,offsetX:s,offsetY:u}=e;this._scrollInfo.has(r)||this._scrollInfo.set(r,new Map),this._scrollInfo.get(r).set(i,{sheetViewStartRow:a,sheetViewStartColumn:o,offsetX:s,offsetY:u}),n===!0&&this._refresh({unitId:r,sheetId:i})}_clearByParam(e){this._addByParam({...e,sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0}),this._refresh(e)}_getCurrentScroll(e){var n;if(e==null)return;const{unitId:r,sheetId:i}=e;return(n=this._scrollInfo.get(r))==null?void 0:n.get(i)}_refresh(e){this._scrollInfo$.next(this._getCurrentScroll(e))}};const U8={id:"sheet.operation.set-scroll",type:ue.OPERATION,handler:(t,e)=>{if(e==null)return!1;const n=t.get(Pl),r=t.get(ae).getUniverSheetInstance(e.unitId).getSheetBySheetId(e.sheetId),{xSplit:i,ySplit:o}=r.getConfig().freeze;return n.addOrReplaceByParam({...e,sheetViewStartRow:e.sheetViewStartRow-o,sheetViewStartColumn:e.sheetViewStartColumn-i}),!0}},V8={id:"sheet.operation.set-editor-resize",type:ue.OPERATION,handler:(t,e)=>!0},Ml={id:"sheet.operation.set-zoom-ratio",type:ue.OPERATION,handler:(t,e)=>{const n=t.get(ae).getUniverSheetInstance(e.unitId),r=n==null?void 0:n.getSheetBySheetId(e.subUnitId);return r==null?!1:(r.getConfig().zoomRatio=e.zoomRatio,!0)}};var kV={exports:{}},H8={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZNe=Se,QNe=Symbol.for("react.element"),JNe=Symbol.for("react.fragment"),exe=Object.prototype.hasOwnProperty,txe=ZNe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nxe={key:!0,ref:!0,__self:!0,__source:!0};function BV(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)exe.call(e,r)&&!nxe.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:QNe,type:t,key:o,ref:a,props:i,_owner:txe.current}}H8.Fragment=JNe;H8.jsx=BV;H8.jsxs=BV;kV.exports=H8;var U=kV.exports,Fa=function(){return Fa=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Fa.apply(this,arguments)},rxe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},Ea=_.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,a=rxe(t,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),u=_.useRef("_".concat(axe()));return UV(n,"".concat(r),{defIds:n.defIds,idSuffix:u.current},Fa({ref:e,className:s},a),o)});function UV(t,e,n,r,i){return _.createElement(t.tag,Fa(Fa({key:e},ixe(t,n,i)),r),(oxe(t,n).children||[]).map(function(o,a){return UV(o,"".concat(e,"-").concat(t.tag,"-").concat(a),n,void 0,i)}))}function ixe(t,e,n){var r=Fa({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var a=o[0],s=o[1];typeof s=="string"&&(r[a]=s.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function oxe(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?Fa(Fa({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?Fa(Fa({},i),{attrs:Fa(Fa({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function axe(){return Math.random().toString(36).substring(2,8)}Ea.displayName="UniverIcon";var sxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M11.0363 12.2367V14.0367C11.0363 14.3681 11.3049 14.6367 11.6363 14.6367C11.9676 14.6367 12.2363 14.3681 12.2363 14.0367V12.2367H14.0364C14.3677 12.2367 14.6364 11.9681 14.6364 11.6367C14.6364 11.3054 14.3677 11.0367 14.0364 11.0367H12.2363V9.23672C12.2363 8.90535 11.9676 8.63672 11.6363 8.63672C11.3049 8.63672 11.0363 8.90535 11.0363 9.23672V11.0367H9.23635C8.90498 11.0367 8.63635 11.3054 8.63635 11.6367C8.63635 11.9681 8.90498 12.2367 9.23635 12.2367H11.0363Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.56365 1.36377C1.90091 1.36377 1.36365 1.90103 1.36365 2.56377V6.16377C1.36365 6.82651 1.90091 7.36377 2.56365 7.36377H6.16365C6.82639 7.36377 7.36365 6.82651 7.36365 6.16377V2.56377C7.36365 1.90103 6.82639 1.36377 6.16365 1.36377H2.56365zM6.16365 2.56377H2.56365L2.56365 6.16377H6.16365V2.56377zM2.56365 8.63647C1.90091 8.63647 1.36365 9.17373 1.36365 9.83647V13.4365C1.36365 14.0992 1.90091 14.6365 2.56365 14.6365H6.16365C6.82639 14.6365 7.36365 14.0992 7.36365 13.4365V9.83647C7.36365 9.17373 6.82639 8.63647 6.16365 8.63647H2.56365zM6.16365 9.83647H2.56365L2.56365 13.4365H6.16365V9.83647zM9.83635 7.36377C9.17361 7.36377 8.63635 6.82651 8.63635 6.16377V2.56377C8.63635 1.90103 9.17361 1.36377 9.83635 1.36377H13.4364C14.0991 1.36377 14.6364 1.90103 14.6364 2.56377V6.16377C14.6364 6.82651 14.0991 7.36377 13.4364 7.36377H9.83635zM9.83635 6.16377V2.56377L13.4364 2.56377V6.16377H9.83635z",fillRule:"evenodd",clipRule:"evenodd"}}]},VV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"autofill",ref:e,icon:sxe}))});VV.displayName="Autofill";const uxe=VV;var lxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.44 3.57291C14.698 3.83093 14.698 4.24927 14.44 4.50729L6.44342 12.5037C6.28721 12.6599 6.03395 12.6599 5.87774 12.5037L1.55992 8.18578C1.3019 7.92776 1.3019 7.50942 1.55993 7.2514C1.81795 6.99338 2.23629 6.99338 2.49431 7.25141L6.01916 10.7763C6.09727 10.8544 6.2239 10.8544 6.30201 10.7763L13.5056 3.57291C13.7636 3.31489 14.1819 3.31489 14.44 3.57291Z",fillRule:"evenodd",clipRule:"evenodd"}}]},HV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"check-mark-single",ref:e,icon:lxe}))});HV.displayName="CheckMarkSingle";const W9=HV;var cxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.57061 3.65132C4.31677 3.39748 3.90521 3.39748 3.65137 3.65132C3.39753 3.90516 3.39753 4.31672 3.65137 4.57056L7.08079 7.99998L3.65123 11.4295C3.39739 11.6834 3.39739 12.0949 3.65123 12.3488C3.90507 12.6026 4.31662 12.6026 4.57047 12.3488L8.00003 8.91921L11.4295 12.3487C11.6834 12.6026 12.0949 12.6026 12.3488 12.3487C12.6026 12.0949 12.6026 11.6833 12.3488 11.4295L8.91927 7.99998L12.3486 4.57061C12.6025 4.31677 12.6025 3.90521 12.3486 3.65137C12.0948 3.39753 11.6832 3.39753 11.4294 3.65137L8.00003 7.08074L4.57061 3.65132Z"}}]},jV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"close-single",ref:e,icon:cxe}))});jV.displayName="CloseSingle";const dxe=jV;var mxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1213",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_1213)"},children:[{tag:"path",attrs:{d:"M1.22297.954345C1.3529.929358 1.51542.914795 1.7147.914795H6.85715C7.0561.914795 7.21986.929297 7.35152.959681 7.48737.991031 7.5967 1.04983 7.67995 1.13863 7.76349 1.22774 7.81571 1.34646 7.84615 1.48343L7.84671 1.48597C7.87164 1.62058 7.88612 1.79252 7.88612 2.00111V7.16269C7.88612 7.36211 7.87154 7.52439 7.84667 7.6587 7.82039 7.79533 7.76169 7.91004 7.67831 7.9934 7.59462 8.0771 7.48565 8.13006 7.35692 8.16096 7.22966 8.1915 7.06561 8.20599 6.87627 8.20599H1.7147C1.52177 8.20599 1.36349 8.19641 1.23252 8.17122 1.09967 8.14567.98914 8.09813.90398 8.0134.818184 7.93285.765734 7.8172.735395 7.68573.705177 7.55478.68573 7.38178.68573 7.16269V1.9581C.68573 1.7541.700286 1.58699.725186 1.45253.751461 1.31589.810166 1.20119.893537 1.11782.978617 1.03274 1.08895.98522 1.22033.954901L1.22297.954345zM2.02733 2.07424C1.95064 2.07854 1.91191 2.09755 1.89153 2.11849 1.86949 2.1517 1.85476 2.19738 1.85473 2.25901L1.86389 3.92571H3.72054V2.07424H2.02733zM4.8991 2.07901V3.92571H6.70756V2.20184C6.70756 2.15684 6.7041 2.12531 6.69899 2.10487 6.69675 2.09591 6.69467 2.09093 6.69349 2.08853 6.68344 2.08345 6.66389 2.07901 6.61819 2.07901H4.8991zM1.86466 5.08037L1.87384 6.90902C1.87384 6.95115 1.87723 6.98219 1.8825 7.00371 1.8864 7.01961 1.89067 7.02788 1.8933 7.03179 1.8933 7.03179 1.89686 7.03365 1.8996 7.03479 1.90589 7.03741 1.91476 7.04025 1.92666 7.04282 1.95062 7.04799 1.98341 7.05133 2.02535 7.05133H3.72532V5.08037H1.86466zM4.8991 5.08037V7.05133H6.55606C6.63148 7.05133 6.67174 7.04228 6.68909 7.03374 6.69039 7.03177 6.69349 7.02643 6.69691 7.01502 6.70311 6.99436 6.70756 6.96264 6.70756 6.91894V5.08037H4.8991zM8.65114 7.83368C8.78108 7.80869 8.94359 7.79413 9.14288 7.79413H14.2853C14.4843 7.79413 14.648 7.80863 14.7797 7.83902 14.9155 7.87037 15.0249 7.92916 15.1081 8.01797 15.1917 8.10707 15.2439 8.2258 15.2743 8.36277L15.2749 8.36531C15.2998 8.49991 15.3143 8.67185 15.3143 8.88045V14.042C15.3143 14.2414 15.2997 14.4037 15.2748 14.538 15.2486 14.6747 15.1899 14.7894 15.1065 14.8727 15.0228 14.9564 14.9138 15.0094 14.7851 15.0403 14.6578 15.0708 14.4938 15.0853 14.3044 15.0853H9.14288C8.94995 15.0853 8.79166 15.0757 8.6607 15.0506 8.52785 15.025 8.41732 14.9775 8.33216 14.8927 8.24636 14.8122 8.19391 14.6965 8.16358 14.5651 8.13336 14.4341 8.11391 14.2611 8.11391 14.042V8.83744C8.11391 8.63343 8.12847 8.46633 8.15337 8.33186 8.17964 8.19523 8.23835 8.08053 8.32172 7.99716 8.4068 7.91208 8.51713 7.86456 8.64851 7.83424L8.65114 7.83368zM9.45551 8.95357C9.37882 8.95788 9.34009 8.97689 9.3197 8.99782 9.29767 9.03103 9.28294 9.07672 9.28291 9.13834L9.29206 10.805H11.1487V8.95357H9.45551zM12.3273 8.95835V10.805H14.1357V9.08118C14.1357 9.03618 14.1323 9.00465 14.1272 8.98421 14.1249 8.97524 14.1228 8.97026 14.1217 8.96786 14.1116 8.96278 14.0921 8.95835 14.0464 8.95835H12.3273zM9.29283 11.9597L9.30202 13.7884C9.30202 13.8305 9.30541 13.8615 9.31068 13.883 9.31457 13.8989 9.31885 13.9072 9.32148 13.9111L9.32448 13.9127 9.32778 13.9141C9.33407 13.9167 9.34293 13.9196 9.35484 13.9222 9.3788 13.9273 9.41159 13.9307 9.45353 13.9307H11.1535V11.9597H9.29283zM12.3273 11.9597V13.9307H13.9842C14.0597 13.9307 14.0999 13.9216 14.1173 13.9131 14.1186 13.9111 14.1217 13.9058 14.1251 13.8944 14.1313 13.8737 14.1357 13.842 14.1357 13.7983V11.9597H12.3273z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M9.46247 2.15033C9.46247 1.74649 9.78985 1.41911 10.1937 1.41911H12.3873C13.5988 1.41911 14.581 2.40124 14.581 3.61276V5.80641C14.581 6.21025 14.2536 6.53762 13.8498 6.53762 13.4459 6.53762 13.1185 6.21025 13.1185 5.80641V3.61276C13.1185 3.20893 12.7912 2.88154 12.3873 2.88154H10.1937C9.78985 2.88154 9.46247 2.55417 9.46247 2.15033zM2.88154 10.1937C2.88154 9.78986 2.55416 9.46248 2.15032 9.46248 1.74648 9.46248 1.4191 9.78986 1.4191 10.1937V12.3873C1.4191 13.5988 2.40123 14.581 3.61275 14.581H5.8064C6.21024 14.581 6.53761 14.2536 6.53761 13.8498 6.53761 13.4459 6.21024 13.1186 5.8064 13.1186H3.61275C3.20892 13.1186 2.88154 12.7912 2.88154 12.3873V10.1937z"}}]}]},zV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"convert-single",ref:e,icon:mxe}))});zV.displayName="ConvertSingle";const fxe=zV;var hxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_371_77",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_371_77)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.85869 12.9216C8.38445 13.4708 7.61555 13.4708 7.14131 12.9216L0.358114 5.06726C-0.406895 4.18144 0.134916 2.66683 1.2168 2.66683L14.7832 2.66683C15.8651 2.66683 16.4069 4.18144 15.6419 5.06726L8.85869 12.9216Z"}}]}]},WV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"dropdown-single",ref:e,icon:hxe}))});WV.displayName="DropdownSingle";const GT=WV;var pxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.6905 4.78738C2.01709 4.61737 2.41966 4.7443 2.58967 5.07089C2.75217 5.38305 3.00913 5.69251 3.36183 5.98156C4.36103 6.80048 6.03866 7.37872 7.99833 7.37872C9.958 7.37872 11.6356 6.80049 12.6348 5.98157C12.9875 5.69251 13.2445 5.38304 13.407 5.0709C13.577 4.7443 13.9796 4.61737 14.3062 4.78737C14.6327 4.95738 14.7597 5.35995 14.5897 5.68654C14.329 6.18726 13.9448 6.63187 13.48 7.01281C13.4365 7.04842 13.3923 7.08356 13.3473 7.11821L14.8065 8.57746C15.0669 8.83781 15.0669 9.25992 14.8065 9.52027C14.5462 9.78062 14.124 9.78062 13.8637 9.52027L12.1741 7.83063C11.6495 8.08125 11.0697 8.28368 10.451 8.43104L10.9916 10.4486C11.0869 10.8042 10.8759 11.1698 10.5202 11.2651C10.1646 11.3604 9.79902 11.1493 9.70373 10.7937L9.13044 8.6541C8.7607 8.69234 8.38239 8.71205 7.99833 8.71205C7.61155 8.71205 7.2306 8.69206 6.85837 8.65329L6.28486 10.7937C6.18957 11.1494 5.82401 11.3604 5.46837 11.2651C5.11272 11.1698 4.90167 10.8043 4.99696 10.4486L5.53804 8.42923C4.92309 8.28224 4.34666 8.0808 3.82483 7.8317L2.13636 9.52018C1.87602 9.78053 1.45391 9.78053 1.19355 9.52018C0.933204 9.25983 0.933203 8.83772 1.19355 8.57737L2.65127 7.11965C2.60559 7.08453 2.56072 7.04892 2.51667 7.01281C2.05184 6.63186 1.66764 6.18725 1.40699 5.68655C1.23698 5.35996 1.36391 4.95739 1.6905 4.78738Z"}}]},YV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"eyelash-single",ref:e,icon:pxe}))});YV.displayName="EyelashSingle";const gxe=YV;var vxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_367_60",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_367_60)"},children:[{tag:"path",attrs:{d:"M5.48334 4.89587C5.35517 4.89587 5.26008 4.777 5.28822 4.65196L5.37367 4.27223C5.47369 3.84311 5.65731 3.4768 5.93107 3.18085 6.23007 2.85761 6.67323 2.71538 7.21663 2.71538 7.41772 2.71538 7.63284 2.73908 7.86113 2.78378 7.88014 2.7875 7.89899 2.79139 7.91771 2.79543 8.12915 2.84113 8.35624 2.74611 8.43956 2.54647L8.66692 2.00173C8.75382 1.79351 8.65103 1.55537 8.43507 1.49007 8.40283 1.48032 8.36953 1.47045 8.33516 1.46047 8.0467 1.37763 7.70317 1.3335 7.29999 1.3335 6.2394 1.3335 5.44639 1.60069 4.89385 2.10573 4.32912 2.62202 3.92814 3.3605 3.70338 4.33753L2.25629 10.5523C2.18051 10.8899 2.08525 11.253 1.96769 11.6425 1.849 12.0347 1.70655 12.4208 1.54146 12.7986 1.37502 13.1773 1.18738 13.5375.978805 13.8784.912697 13.9865.8444 14.0896.773916 14.1876.684332 14.3122.753952 14.4944.905805 14.5167 1.5556 14.6123 2.23715 14.4376 2.60122 13.8909 2.74587 13.6737 2.88704 13.426 3.02434 13.1464 3.3856 12.411 3.72447 11.3716 4.03792 10.0188L4.88825 6.37667C4.90938 6.28616 4.99007 6.22214 5.08301 6.22214H7.04403C7.22895 6.22214 7.38976 6.09538 7.43296 5.91557L7.55939 5.3893C7.61982 5.13775 7.42917 4.89587 7.17046 4.89587H5.48334zM13.7403 5.0817L11.9317 7.33096 10.8281 5.13886C10.7615 4.99145 10.6146 4.89673 10.4529 4.89673H9.73214C9.4277 4.89673 9.22847 5.21561 9.36195 5.48923L10.8281 8.41635 8.21708 11.5106C7.98512 11.7771 8.17444 12.1929 8.5278 12.1929H9.10532C9.22597 12.1929 9.37975 12.1436 9.45801 12.0518L11.53 9.62616 12.5369 11.9223C12.5978 12.0844 12.7522 12.1929 12.9254 12.1929H13.7193C14.0023 12.1929 14.161 11.9788 14.0619 11.7137L12.592 8.64761C12.592 8.64761 14.8202 5.81675 15.0205 5.54025 15.2159 5.27062 15.0215 4.89673 14.6886 4.89673H14.0854C13.9467 4.89673 13.8525 4.9502 13.7403 5.0817z"}}]}]},XV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"fx-single",ref:e,icon:vxe}))});XV.displayName="FxSingle";const bxe=XV;var _xe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_249",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_249)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.74717 2.0944C8.74717 1.68671 8.41279 1.3562 8.00032 1.3562C7.58785 1.3562 7.25347 1.68671 7.25347 2.0944V7.26186H2.02541C1.61294 7.26186 1.27856 7.59237 1.27856 8.00007C1.27856 8.40777 1.61294 8.73827 2.02541 8.73827H7.25347V13.9057C7.25347 14.3134 7.58785 14.6439 8.00032 14.6439C8.41279 14.6439 8.74717 14.3134 8.74717 13.9057V8.73827H13.975C14.3874 8.73827 14.7218 8.40777 14.7218 8.00007C14.7218 7.59237 14.3874 7.26186 13.975 7.26186H8.74717V2.0944Z"}}]}]},qV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"increase-single",ref:e,icon:_xe}))});qV.displayName="IncreaseSingle";const Cxe=qV;var Sxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.629584 3.99986C1.13729 3.4922 1.9604 3.49224 2.46806 3.99995L7.57569 9.10806C7.81 9.3424 8.18992 9.3424 8.42424 9.10808L13.5323 3.99998C14.04 3.4923 14.8631 3.4923 15.3708 3.99998C15.8785 4.50766 15.8785 5.33078 15.3708 5.83846L9.41415 11.7951C8.63307 12.5762 7.36669 12.5762 6.58565 11.7951L0.629497 5.83834C0.121839 5.33063 0.121879 4.50752 0.629584 3.99986Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},GV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"more-down-single",ref:e,icon:Sxe}))});GV.displayName="MoreDownSingle";const rC=GV;var Exe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.45493 2.80093C5.74783 2.49409 6.2227 2.49409 6.5156 2.80093L11.0156 7.51523C11.3085 7.82207 11.3085 8.31956 11.0156 8.6264L6.44488 13.27C6.15199 13.5768 5.67711 13.5768 5.38422 13.27C5.09133 12.9631 5.09133 12.4656 5.38422 12.1588L9.28804 8.20898C9.36409 8.13203 9.36517 8.00855 9.29047 7.93029L5.45493 3.9121C5.16204 3.60526 5.16204 3.10777 5.45493 2.80093Z",fillRule:"evenodd",clipRule:"evenodd"}}]},KV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"more-single",ref:e,icon:Exe}))});KV.displayName="MoreSingle";const KT=KV;var yxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1204",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1204)"},children:[{tag:"rect",attrs:{width:12.62,height:2.79,x:1.69,y:12.25,fill:"colorChannel1",rx:1.4}},{tag:"path",attrs:{fill:"currentColor",d:"M7.74646 2.1642C7.34284 1.65121 6.85947 1.28205 6.38447 1.09593C5.86863 0.893787 5.15166 0.852126 4.70047 1.42917C4.29842 1.94344 4.33082 2.70249 4.57691 3.50395C4.68808 3.8661 4.86846 4.22254 5.12522 4.56617C5.13695 4.58185 5.14927 4.5968 5.16211 4.61102C5.17152 4.6214 5.18122 4.63139 5.19115 4.64096C5.20459 4.65393 5.21855 4.66618 5.23296 4.6777L3.5064 6.40422C3.26756 6.64306 3.26756 7.03033 3.5064 7.26919L7.23756 11.0004C7.47648 11.2392 7.86375 11.2392 8.1026 11.0004L12.8329 6.27001C13.0717 6.03117 13.0717 5.6439 12.8329 5.40505L9.10172 1.67387C8.86288 1.43503 8.47561 1.43503 8.23676 1.67387L7.74646 2.1642ZM7.46162 4.50638C7.47252 4.57574 7.48163 4.64652 7.4888 4.71868C7.52232 5.05481 7.82194 5.30013 8.15807 5.26661C8.4942 5.23311 8.73954 4.93345 8.70601 4.59732C8.65786 4.11463 8.54251 3.6666 8.37892 3.26169L8.66928 2.97135L11.5354 5.83753L10.6106 6.76237H4.87824L7.40802 4.2326C7.42885 4.32128 7.44684 4.41255 7.46162 4.50638ZM6.87284 3.03784C6.57441 2.62008 6.22261 2.34634 5.93815 2.23487C5.80233 2.18165 5.71528 2.17827 5.67638 2.18335C5.6725 2.18387 5.66929 2.18443 5.6666 2.18497L5.6619 2.18607C5.64166 2.21954 5.53594 2.45979 5.74626 3.1449C5.81241 3.36036 5.92262 3.58602 6.09307 3.81761L6.87284 3.03784Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.1932 11.5463C12.6454 11.5463 13.012 11.1797 13.012 10.7275C13.012 10.4475 12.6981 9.92821 12.459 9.5733C12.3299 9.38173 12.0564 9.38174 11.9274 9.57331C11.6883 9.92822 11.3744 10.4475 11.3744 10.7275C11.3744 11.1797 11.741 11.5463 12.1932 11.5463Z"}}]}]},ZV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"paint-bucket",ref:e,icon:yxe}))});ZV.displayName="PaintBucket";const Dxe=ZV;var Rxe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.49152 1.3335C1.79021 1.3335 1.22168 1.90202 1.22168 2.60334V13.397C1.22168 14.0983 1.79021 14.6668 2.49152 14.6668H9.42803C9.98031 14.6668 10.428 14.2191 10.428 13.6668V13.397V10.9234C10.428 10.7577 10.5623 10.6234 10.728 10.6234H13.2852H13.555C14.1073 10.6234 14.555 10.1757 14.555 9.62343V2.60334C14.555 1.90202 13.9865 1.3335 13.2852 1.3335H2.49152ZM8.85819 13.397C9.02387 13.397 9.15819 13.2627 9.15819 13.097V10.9234C9.15819 10.7577 9.02387 10.6234 8.85819 10.6234H6.60104C6.43536 10.6234 6.30104 10.7577 6.30104 10.9234V13.097C6.30104 13.2627 6.43536 13.397 6.60104 13.397H8.85819ZM13.2852 9.05359C13.2852 9.21927 13.1509 9.35359 12.9852 9.35359H10.728C10.5623 9.35359 10.428 9.21927 10.428 9.05359V6.96718C10.428 6.80149 10.5623 6.66718 10.728 6.66718H12.9852C13.1509 6.66718 13.2852 6.80149 13.2852 6.96718V9.05359ZM8.85819 9.35359C9.02387 9.35359 9.15819 9.21927 9.15819 9.05359V6.96718C9.15819 6.80149 9.02387 6.66718 8.85819 6.66718H6.60104C6.43536 6.66718 6.30104 6.80149 6.30104 6.96718V9.05359C6.30104 9.21927 6.43536 9.35359 6.60104 9.35359H8.85819ZM13.2852 5.09734C13.2852 5.26302 13.1509 5.39734 12.9852 5.39734H10.728C10.5623 5.39734 10.428 5.26302 10.428 5.09734V2.90334C10.428 2.73765 10.5623 2.60334 10.728 2.60334H12.9852C13.1509 2.60334 13.2852 2.73765 13.2852 2.90334V5.09734ZM8.85819 5.39734C9.02387 5.39734 9.15819 5.26302 9.15819 5.09734V2.90334C9.15819 2.73765 9.02387 2.60334 8.85819 2.60334H6.60104C6.43536 2.60334 6.30104 2.73765 6.30104 2.90334V5.09734C6.30104 5.26302 6.43536 5.39734 6.60104 5.39734H8.85819ZM5.0312 2.90334C5.0312 2.73765 4.89689 2.60334 4.7312 2.60334H2.79152C2.62584 2.60334 2.49152 2.73765 2.49152 2.90334V5.09734C2.49152 5.26302 2.62584 5.39734 2.79152 5.39734H4.7312C4.89689 5.39734 5.0312 5.26302 5.0312 5.09734V2.90334ZM5.0312 6.96718C5.0312 6.80149 4.89689 6.66718 4.7312 6.66718H2.79152C2.62584 6.66718 2.49152 6.80149 2.49152 6.96718V9.05359C2.49152 9.21927 2.62584 9.35359 2.79152 9.35359H4.7312C4.89689 9.35359 5.0312 9.21927 5.0312 9.05359V6.96718ZM5.0312 10.9234C5.0312 10.7577 4.89689 10.6234 4.7312 10.6234H2.79152C2.62584 10.6234 2.49152 10.7577 2.49152 10.9234V13.097C2.49152 13.2627 2.62584 13.397 2.79152 13.397H4.7312C4.89689 13.397 5.0312 13.2627 5.0312 13.097V10.9234Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.0703 11.9137C12.0445 11.75 12.2176 11.6277 12.3633 11.7068L14.6735 12.9609C14.8412 13.052 14.7972 13.3003 14.6155 13.3333C14.6046 13.3352 14.5937 13.3371 14.5831 13.34L13.58 13.6178L12.8438 14.5421C12.7486 14.7038 12.5031 14.6572 12.4739 14.4718L12.0703 11.9137Z"}}]},QV=_.forwardRef(function(t,e){return _.createElement(Ea,Object.assign({},t,{id:"select-range-single",ref:e,icon:Rxe}))});QV.displayName="SelectRangeSingle";const Ixe=QV,Axe="univer-range-selector",Txe="univer-range-selector-editor",wxe="univer-range-selector-icon",Lxe="univer-range-selector-active",Vl={rangeSelector:Axe,rangeSelectorEditor:Txe,rangeSelectorIcon:wxe,rangeSelectorActive:Lxe};function Oxe(t){const{onChange:e,onActive:n}=t,[r,i]=_.useState(!1),o=_.useRef(null),a=Ct(Gt),s=Ct(dt);_.useEffect(()=>{var m;if(r){n(r);const f=s.selectionMoveEnd$.subscribe(h=>{const p=["A1","B2:C3","Sheet2!A1:B2","D10:E11,F1:G2,H3:I4"],v=Math.floor(Math.random()*p.length),g=p[v];o.current&&(o.current.innerHTML=g)});return document.addEventListener("click",u),()=>{document.removeEventListener("click",u),f.unsubscribe()}}e(((m=o.current)==null?void 0:m.innerHTML)||"")},[r]);function u(m){var f,h,p;if((f=m.target)!=null&&f.closest('[data-range-selector="true"]')||m.target===o.current)return;const v=(h=m.target)==null?void 0:h.closest(`.${Vl.rangeSelector}`);(v==null?void 0:v.querySelector(`.${Vl.rangeSelectorEditor}`))!==o.current&&(i(!1),(p=o.current)==null||p.blur())}function l(m){m.stopPropagation(),m.key==="Enter"&&(m.preventDefault(),m.currentTarget.blur(),i(!1))}function c(){i(!0)}function d(){var m;if(!r){(m=o.current)==null||m.focus();return}i(!r)}return U.jsxs("div",{className:r?`${Vl.rangeSelector} ${Vl.rangeSelectorActive}`:Vl.rangeSelector,children:[U.jsx("div",{ref:o,className:Vl.rangeSelectorEditor,contentEditable:!0,"data-placeholder":a.t("rangeSelector.placeholder"),onKeyDown:l,onFocus:c}),U.jsx(df,{title:a.t("rangeSelector.tooltip"),placement:"bottom",children:U.jsx("button",{className:Vl.rangeSelectorIcon,onClick:d,children:U.jsx(Ixe,{})})})]})}var s0=(t=>(t.Append="APPEND",t.Default="DEFAULT",t.Only="ONLY",t))(s0||{}),Si=(t=>(t.NUMBER="number",t.DATE="date",t.EXTEND_NUMBER="extendNumber",t.CHN_NUMBER="chnNumber",t.CHN_WEEK2="chnWeek2",t.CHN_WEEK3="chnWeek3",t.LOOP_SERIES="loopSeries",t.FORMULA="formula",t.OTHER="other",t))(Si||{}),tr=(t=>(t.COPY="0",t.SERIES="1",t.ONLY_FORMAT="2",t.NO_FORMAT="3",t))(tr||{});const Pxe={type:Si.NUMBER,priority:1e3,match:t=>typeof(t==null?void 0:t.v)=="number"||(t==null?void 0:t.t)===$n.NUMBER,isContinue:(t,e)=>t.type===Si.NUMBER,applyFunctions:{[tr.SERIES]:(t,e,n)=>{const{data:r}=t;return n===ye.LEFT||n===ye.UP?(r.reverse(),MT(r,e,n).reverse()):MT(r,e,n)}}},JV={type:Si.OTHER,priority:0,match:()=>!0,isContinue:(t,e)=>t.type===Si.OTHER},Mxe={type:Si.EXTEND_NUMBER,priority:900,match:t=>K3(`${t==null?void 0:t.v}`||"").isExtendNumber,isContinue:(t,e)=>{var n;if(t.type===Si.EXTEND_NUMBER){const{beforeTxt:r,afterTxt:i}=K3(`${(n=t.cellData)==null?void 0:n.v}`||""),{beforeTxt:o,afterTxt:a}=K3(`${e==null?void 0:e.v}`||"");if(r===o&&i===a)return!0}return!1},applyFunctions:{[tr.SERIES]:(t,e,n)=>{var r;const{data:i}=t,o=n===ye.UP||n===ye.LEFT;let a;if(i.length===1)return a=o?-1:1,Ha(NT(i,e,a),o);const s=[];for(let u=0;u<i.length;u++){const l=`${(r=i[u])==null?void 0:r.v}`;l&&s.push(Number(K3(l).matchTxt))}return o&&(i.reverse(),s.reverse()),xf(s)?(a=s[1]-s[0],Ha(NT(i,e,a),o)):Vc(i,e)}}},Nxe={type:Si.CHN_NUMBER,priority:830,match:t=>!!PMe(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>t.type===Si.CHN_NUMBER,applyFunctions:{[tr.SERIES]:(t,e,n)=>{var r,i,o;const{data:a}=t,s=n===ye.LEFT||n===ye.UP;if(a.length===1){const d=`${(r=a[0])==null?void 0:r.v}`;let m;return s?m=-1:m=1,d&&(d==="日"||$1(d)<7)?Ha(H0(a,e,m),s):Ha(xT(a,e,m),s)}let u=!1;for(let d=0;d<a.length;d++)if(((i=a[d])==null?void 0:i.v)==="日"){u=!0;break}const l=[];let c=0;for(let d=0;d<a.length;d++){const m=`${(o=a[d])==null?void 0:o.v}`;m==="日"?d===0?l.push(0):(c++,l.push(c*7)):u&&$1(m)>0&&$1(m)<7?l.push($1(m)+c*7):l.push($1(m))}if(s&&(a.reverse(),l.reverse()),xf(l)){if(u||l[l.length-1]<6&&l[0]>0||l[0]<6&&l[l.length-1]>0){const m=l[1]-l[0];return Ha(H0(a,e,m),s)}const d=l[1]-l[0];return Ha(xT(a,e,d),s)}return Vc(a,e)}}},xxe={type:Si.CHN_WEEK2,priority:820,match:t=>!!MMe(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>t.type===Si.CHN_WEEK2,applyFunctions:{[tr.SERIES]:(t,e,n)=>{var r;const{data:i}=t,o=n===ye.LEFT||n===ye.UP;if(i.length===1){let u;return o?u=-1:u=1,Ha(H0(i,e,u,1),o)}const a=[];let s=0;for(let u=0;u<i.length;u++){const l=`${(r=i[u])==null?void 0:r.v}`,c=l==null?void 0:l.substr(l.length-1,1);l==="周日"?u===0?a.push(0):(s++,a.push(s*7)):a.push($1(c)+s*7)}if(o&&(i.reverse(),a.reverse()),xf(a)){const u=a[1]-a[0];return Ha(H0(i,e,u,1),o)}return Vc(i,e)}}},Fxe={type:Si.CHN_WEEK3,priority:810,match:t=>NMe(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>t.type===Si.CHN_WEEK3,applyFunctions:{[tr.SERIES]:(t,e,n)=>{var r;const{data:i}=t,o=n===ye.LEFT||n===ye.UP;if(i.length===1){let u;return o?u=-1:u=1,Ha(H0(i,e,u,2),o)}const a=[];let s=0;for(let u=0;u<i.length;u++){const l=`${(r=i[u])==null?void 0:r.v}`;if(l){const c=l.substr(l.length-1,1);l==="星期日"?u===0?a.push(0):(s++,a.push(s*7)):a.push($1(c)+s*7)}}if(o&&(i.reverse(),a.reverse()),xf(a)){const u=a[1]-a[0];return Ha(H0(i,e,u,2),o)}return Vc(i,e)}}},$xe={type:Si.LOOP_SERIES,priority:800,match:t=>VMe(`${t==null?void 0:t.v}`||""),isContinue:(t,e)=>{var n;return t.type===Si.LOOP_SERIES?Ug(`${(n=t.cellData)==null?void 0:n.v}`||"").name===Ug(`${e==null?void 0:e.v}`||"").name:!1},applyFunctions:{[tr.SERIES]:(t,e,n)=>{var r,i;const{data:o}=t,a=n===ye.LEFT||n===ye.UP,{series:s}=Ug(`${(r=o[0])==null?void 0:r.v}`||"");if(o.length===1){let c;return a?c=-1:c=1,Ha(FT(o,e,c,s),a)}const u=[];let l=0;for(let c=0;c<o.length;c++){const d=`${(i=o[c])==null?void 0:i.v}`;d&&(d===s[0]?c===0?u.push(0):(l++,u.push(l*s.length)):u.push(s.indexOf(d)+l*7))}if(a&&(o.reverse(),u.reverse()),xf(u)){const c=u[1]-u[0];return Ha(FT(o,e,c,s),a)}return Vc(o,e)}}};function Ha(t,e){return e?t.reverse():t}var kxe=Object.defineProperty,Bxe=Object.getOwnPropertyDescriptor,Uxe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Bxe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&kxe(e,n,i),i},Hg=(t,e)=>(n,r)=>e(n,r,t);let S7=class extends We{constructor(e,n,r){super(),H(this,"_rules",[]),H(this,"_hooks",[]),H(this,"_applyType$",new dn(tr.SERIES)),H(this,"_isFillingStyle",!0),H(this,"_autoFillLocation$",new dn(null)),H(this,"autoFillLocation$",this._autoFillLocation$.asObservable()),H(this,"_showMenu$",new dn(!1)),H(this,"showMenu$",this._showMenu$.asObservable()),H(this,"_direction",ye.DOWN),H(this,"applyType$",this._applyType$.asObservable()),H(this,"_menu$",new dn([{label:"autoFill.copy",value:tr.COPY,disable:!1},{label:"autoFill.series",value:tr.SERIES,disable:!1},{label:"autoFill.formatOnly",value:tr.ONLY_FORMAT,disable:!1},{label:"autoFill.noFormat",value:tr.NO_FORMAT,disable:!1}])),H(this,"menu$",this._menu$.asObservable()),this._sheetInterceptorService=e,this._univerInstanceService=n,this._selectionManagerService=r,this._init()}_init(){this._rules=[Pxe,Mxe,Nxe,xxe,Fxe,$xe,JV].sort((e,n)=>n.priority-e.priority),this._isFillingStyle=!0}getOneByPriority(e){return e.length<=0?[]:[e.reduce((n,r)=>(r.priority||0)>(n.priority||0)?r:n,e[0])]}addHook(e){if(this._hooks.find(n=>n.id===e.id))throw new Error(`Add hook failed, hook id '${e.id}' already exist!`);return e.priority===void 0&&(e.priority=0),e.type===void 0&&(e.type=s0.Append),this._hooks.push(e),je(()=>{const n=this._hooks.findIndex(r=>r===e);n>-1&&this._hooks.splice(n,1)})}registerRule(e){if(this._rules.find(r=>r.type===e.type))throw new Error(`Registry rule failed, type '${e.type}' already exist!`);const n=this._rules.findIndex(r=>r.priority<e.priority);this._rules.splice(n===-1?this._rules.length:n,0,e)}getRules(){return this._rules}getAllHooks(){return this._hooks}getActiveHooks(){const{source:e,target:n,unitId:r,subUnitId:i}=this.autoFillLocation||{};if(!e||!n||!r||!i)return[];const o=this._hooks.filter(l=>{var c;return!((c=l.disable)!=null&&c.call(l,{source:e,target:n,unitId:r,subUnitId:i},this._direction,this.applyType))}),a=o.filter(l=>l.type===s0.Only);if(a.length>0)return this.getOneByPriority(a);const s=this.getOneByPriority(o.filter(l=>l.type===s0.Default)),u=o.filter(l=>l.type===s0.Append)||[];return[...s,...u]}get applyType(){return this._applyType$.getValue()}set applyType(e){this._applyType$.next(e)}get menu(){return this._menu$.getValue()}get direction(){return this._direction}set direction(e){this._direction=e}isFillingStyle(){return this._isFillingStyle}setFillingStyle(e){this._isFillingStyle=e}get autoFillLocation(){return this._autoFillLocation$.getValue()}set autoFillLocation(e){this._autoFillLocation$.next(e)}setDisableApplyType(e,n){this._menu$.next(this._menu$.getValue().map(r=>r.value===e?{...r,disable:n}:r))}setShowMenu(e){this._showMenu$.next(e)}};S7=Uxe([yt(ot.Rendered,S7),Hg(0,K(In)),Hg(1,K(ae)),Hg(2,K(dt))],S7);const vd=ln("univer.auto-fill-service");var Vxe=Object.defineProperty,Hxe=Object.getOwnPropertyDescriptor,jxe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Hxe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Vxe(e,n,i),i},w1=(t,e)=>(n,r)=>e(n,r,t);let E7=class extends We{constructor(e,n,r,i,o,a,s,u,l){super(),H(this,"_beforeApplyData",[]),H(this,"_copyData",[]),H(this,"_defaultHook"),this._univerInstanceService=e,this._selectionRenderService=n,this._commandService=r,this._undoRedoService=i,this._autoFillService=o,this._editorBridgeService=a,this._sheetInterceptorService=s,this._selectionManagerService=u,this._injector=l,this._defaultHook={id:"default",type:s0.Default,priority:0,onBeforeFillData:(c,d)=>{this._presetAndCacheData(c,d)},onFillData:(c,d,m)=>this._fillData(c,d,m)},this._init()}_init(){this._initDefaultHook(),this._onSelectionControlFillChanged(),this._onApplyTypeChanged(),[jMe,C7].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))})}_initDefaultHook(){this._autoFillService.addHook(this._defaultHook)}_onSelectionControlFillChanged(){const e=new ws;this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(n.id!==_n.id)return;const r=this._selectionManagerService.getCurrent();(r==null?void 0:r.pluginName)===Nn&&(e.dispose(),this._selectionRenderService.getCurrentControls().forEach(i=>{e.add(je(i.selectionFilled$.subscribe(o=>{if(o==null||o.startColumn===-1||o.startRow===-1||o.endColumn===-1||o.endRow===-1)return;const a={startColumn:i.model.startColumn,endColumn:i.model.endColumn,startRow:i.model.startRow,endRow:i.model.endRow},s={startColumn:o.startColumn,endColumn:o.endColumn,startRow:o.startRow,endRow:o.endRow};this._triggerAutoFill(a,s)}))),e.add(je(i.fillControl.onDblclickObserver.add(()=>{const o={startColumn:i.model.startColumn,endColumn:i.model.endColumn,startRow:i.model.startRow,endRow:i.model.endRow};this._handleDbClickFill(o)}))),e.add(je(i.fillControl.onPointerDownObserver.add(()=>{this._editorBridgeService.isVisible().visible&&this._editorBridgeService.changeVisible({visible:!1,eventType:dr.PointerDown})})))}))}))}_onApplyTypeChanged(){this.disposeWithMe(je(this._autoFillService.applyType$.subscribe(()=>{this._handleFillData()})))}_triggerAutoFill(e,n){var r;if(e.startColumn===n.startColumn&&e.startRow===n.startRow&&e.endColumn===n.endColumn&&e.endRow===n.endRow)return;if(n.endColumn<e.endColumn&&n.endColumn>e.startColumn){this._commandService.executeCommand(C7.id,{clearRange:{startRow:n.startRow,endRow:n.endRow,startColumn:n.endColumn+1,endColumn:e.endColumn},selectionRange:n});return}if(n.endRow<e.endRow&&n.endRow>e.startRow){this._commandService.executeCommand(C7.id,{clearRange:{startRow:n.endRow+1,endRow:e.endRow,startColumn:n.startColumn,endColumn:n.endColumn},selectionRange:n});return}const i={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn};let o=null;if(n.startRow<e.startRow)o=ye.UP,i.endRow=e.startRow-1;else if(n.endRow>e.endRow)o=ye.DOWN,i.startRow=e.endRow+1;else if(n.startColumn<e.startColumn)o=ye.LEFT,i.endColumn=e.startColumn-1;else if(n.endColumn>e.endColumn)o=ye.RIGHT,i.startColumn=e.endColumn+1;else return;const a=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),s=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();this._autoFillService.direction=o,this._autoFillService.autoFillLocation={source:e,target:i,unitId:a,subUnitId:s},this._autoFillService.getActiveHooks().forEach(u=>{var l;(l=u==null?void 0:u.onBeforeFillData)==null||l.call(u,{source:e,target:i,unitId:a,subUnitId:s},o)}),(r=this._autoFillService.menu.find(u=>u.value===tr.SERIES))!=null&&r.disable?this._autoFillService.applyType=tr.COPY:this._autoFillService.applyType=tr.SERIES}_handleDbClickFill(e){const n=this._detectFillRange(e);n.endRow<=e.endRow||this._triggerAutoFill(e,n)}_detectFillRange(e){var n,r,i,o,a,s;const{startRow:u,endRow:l,startColumn:c,endColumn:d}=e,m=(n=this._univerInstanceService.getCurrentUniverSheetInstance())==null?void 0:n.getActiveSheet();if(!m)return e;const f=m.getCellMatrix(),h=m.getMaxRows()-1,p=m.getMaxColumns()-1;let v=l;if(c>0&&((r=f.getValue(u,c-1))==null?void 0:r.v)!=null){let g=u;for(;((i=f.getValue(g,c-1))==null?void 0:i.v)!=null&&g<h;)g+=1;v=g-1}else if(d<p&&((o=f.getValue(l,d+1))==null?void 0:o.v)!=null){let g=u;for(;((a=f.getValue(g,d+1))==null?void 0:a.v)!=null&&g<h;)g+=1;v=g-1}for(let g=l+1;g<=v;g++)for(let b=c;b<=d;b++)if(((s=f.getValue(g,b))==null?void 0:s.v)!=null){v=g-1;break}return{startColumn:c,endColumn:d,startRow:u,endRow:v}}_handleFillData(){const{source:e,target:n,unitId:r=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),subUnitId:i=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId()}=this._autoFillService.autoFillLocation||{},o=this._autoFillService.direction;if(!e||!n)return;const a=ht.union(e,n),s=this._autoFillService.applyType,u=this._autoFillService.getActiveHooks();this._commandService.syncExecuteCommand(_n.id,{selections:[{primary:{...a,actualRow:a.startRow,actualColumn:a.startColumn,endColumn:a.startColumn,endRow:a.startRow},range:{...a,rangeType:ct.NORMAL}}],unitId:r,subUnitId:i});const l=[],c=[];u.forEach(d=>{var m;const{undos:f,redos:h}=((m=d.onFillData)==null?void 0:m.call(d,{source:e,target:n,unitId:r,subUnitId:i},o,s))||{};f&&l.push(...f),h&&c.push(...h)}),c.every(d=>this._commandService.syncExecuteCommand(d.id,d.params))&&this._undoRedoService.pushUndoRedo({unitID:r,undoMutations:l,redoMutations:c}),u.forEach(d=>{var m;(m=d.onAfterFillData)==null||m.call(d,{source:e,target:n,unitId:r,subUnitId:i},o,s)}),this._autoFillService.setShowMenu(!0)}_getApplyData(e,n,r,i,o,a=!0){const s=[],u=Math.floor(r/n),l=r%n,c=this._autoFillService.getRules();if(!a&&o===tr.ONLY_FORMAT)return console.error("ERROR: only format can not be applied when hasStyle is false"),[];const d={};c.forEach(m=>{d[m.type]=[]}),c.forEach(m=>{const{type:f,applyFunctions:h={}}=m,p=e[f];p&&p.forEach(v=>{const g=xMe(v.index,l),b=v.index.length*u+g,C=this._applyFunctions(v,b,i,o,h,e),S=FMe(n,r,v.index);d[f].push({data:C,index:S})})});for(let m=0;m<r;m++)c.forEach(f=>{const{type:h}=f,p=d[h];for(let v=0;v<p.length;v++)m in p[v].index&&s.push(p[v].data[p[v].index[m]])});return s}_applyFunctions(e,n,r,i,o,a){const{data:s}=e,u=r===ye.UP||r===ye.LEFT;if(i===tr.COPY){const l=o==null?void 0:o[tr.COPY];return l?l(e,n,r,a):(u&&s.reverse(),Vc(s,n))}if(i===tr.SERIES){const l=o==null?void 0:o[tr.SERIES];return l?l(e,n,r,a):(u&&s.reverse(),o!=null&&o[tr.COPY]?o[tr.COPY](e,n,r,a):Vc(s,n))}if(i===tr.ONLY_FORMAT){const l=o==null?void 0:o[tr.ONLY_FORMAT];return l?l(e,n,r,a):$Me(s,n)}}_getCopyData(e,n){const{startRow:r,startColumn:i,endRow:o,endColumn:a}=e,s=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getCellMatrix(),u=this._autoFillService.getRules(),l=[],c=n===ye.DOWN||n===ye.UP;let d,m,f,h;c?(d=i,m=a,f=r,h=o):(d=r,m=o,f=i,h=a);for(let p=d;p<=m;p++){const v=this._getEmptyCopyDataPiece(),g={type:void 0,cellData:void 0};for(let b=f;b<=h;b++){let C;c?C=s.getValue(b,p):C=s.getValue(p,b);const{type:S,isContinue:E}=u.find(y=>y.match(C))||JV;if(E(g,C)){const y=v[S],D=y[y.length-1];D.data.push(C),D.index.push(b-f)}else{const y=v[S];y?y.push({data:[C],index:[b-f]}):v[S]=[{data:[C],index:[b-f]}]}g.type=S,g.cellData=C}l.push(v)}return l}_getEmptyCopyDataPiece(){const e={};return this._autoFillService.getRules().forEach(n=>{e[n.type]=[]}),e}_getMergeApplyData(e,n,r,i){const o=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getMergeData(),a=[];for(let s=e.startRow;s<=e.endRow;s++)for(let u=e.startColumn;u<=e.endColumn;u++){const{isMergedMainCell:l,startRow:c,startColumn:d,endRow:m,endColumn:f}=Xc(s,u,o);if(l){if(r===ye.DOWN){let h=c+i,p=m+i;for(;p<=n.endRow;)a.push({startRow:h,startColumn:d,endRow:p,endColumn:f}),h+=i,p+=i}else if(r===ye.UP){let h=c-i,p=m-i;for(;h>=n.startRow;)a.push({startRow:h,startColumn:d,endRow:p,endColumn:f}),h-=i,p-=i}else if(r===ye.RIGHT){let h=d+i,p=f+i;for(;p<=n.endColumn;)a.push({startRow:c,startColumn:h,endRow:m,endColumn:p}),h+=i,p+=i}else if(r===ye.LEFT){let h=d-i,p=f-i;for(;h>=n.startColumn;)a.push({startRow:c,startColumn:h,endRow:m,endColumn:p}),h-=i,p-=i}}}return a}_presetAndCacheData(e,n){const{source:r,target:i}=e,o=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getCellMatrix(),a=[];for(let s=i.startRow;s<=i.endRow;s++){const u=[];for(let l=i.startColumn;l<=i.endColumn;l++)u.push(Ie.deepClone(o.getValue(s,l)));a.push(u)}this._beforeApplyData=a,this._copyData=this._getCopyData(r,n),this._hasSeries(this._copyData)?this._autoFillService.setDisableApplyType(tr.SERIES,!1):this._autoFillService.setDisableApplyType(tr.SERIES,!0)}_fillData(e,n,r){var i,o;const a=[],s=[];let u=!0;r===tr.NO_FORMAT&&(u=!1,r=tr.SERIES);const{source:l,target:c,unitId:d,subUnitId:m}=e;if(!l||!c||n==null)return{undos:a,redos:s};const{startRow:f,startColumn:h,endRow:p,endColumn:v}=l,{startRow:g,startColumn:b,endRow:C,endColumn:S}=c,E=this._copyData;let y;n===ye.DOWN||n===ye.UP?y=p-f+1:y=v-h+1;const D=[];if(n===ye.DOWN||n===ye.UP){const ce=C-g+1,pe=[];for(let oe=b;oe<=S;oe++){const he=E[oe-b],fe=this._getApplyData(he,y,ce,n,r,u);pe.push(fe)}for(let oe=0;oe<pe[0].length;oe++){const he=[];for(let fe=0;fe<pe.length;fe++)he.push({s:null,...pe[fe][oe]});D.push(he)}}else{const ce=S-b+1;for(let pe=g;pe<=C;pe++){const oe=E[pe-g],he=this._getApplyData(oe,y,ce,n,r,u),fe=[];for(let ve=0;ve<he.length;ve++)fe.push({s:null,...he[ve]});D.push(fe)}}let R=[];const I=this._univerInstanceService.getCurrentUniverSheetInstance().getStyles();u?(R=this._getMergeApplyData(l,c,n,y),D.forEach(ce=>{ce.forEach(pe=>{pe&&I&&I&&(pe.s=I.getStyleByCell(pe))})})):D.forEach((ce,pe)=>{ce.forEach((oe,he)=>{oe&&I&&(oe.s=I.getStyleByCell(this._beforeApplyData[pe][he])||null)})}),r===tr.ONLY_FORMAT&&D.forEach((ce,pe)=>{ce.forEach((oe,he)=>{if(oe){const fe=this._beforeApplyData[pe][he]||{};oe.f=fe.f,oe.si=fe.si,oe.t=fe.t,oe.v=fe.v}})});const T={get:this._injector.get.bind(this._injector)},P=[],N=(o=(i=this._univerInstanceService.getUniverSheetInstance(d))==null?void 0:i.getSheetBySheetId(m))==null?void 0:o.getMergeData();N&&N.forEach(ce=>{ht.intersects(ce,c)&&P.push(ce)});const B={unitId:d,subUnitId:m,ranges:P},W=Zi(T,B);s.push({id:Un.id,params:B}),a.push({id:Bn.id,params:W});const G={subUnitId:m,unitId:d,cellValue:SV([c])},Q=ci(T,G),te=this._sheetInterceptorService.onCommandExecute({id:wf.id});s.push({id:Vt.id,params:G},...te.redos),a.push(...te.undos,{id:Vt.id,params:Q});const X=new Ye,{startRow:x,startColumn:O,endRow:M,endColumn:V}=c;for(let ce=0;ce<=M-x;ce++)for(let pe=0;pe<=V-O;pe++)D[ce][pe]&&X.setValue(ce+x,pe+O,D[ce][pe]);const q={subUnitId:m,unitId:d,cellValue:X.getMatrix()},ie=ci(T,q);if(a.push({id:Vt.id,params:ie}),s.push({id:Vt.id,params:q}),R!=null&&R.length){const ce=Nf(R),pe={unitId:d,subUnitId:m,ranges:ce},oe=Fo(T,pe);a.push({id:Un.id,params:oe}),s.push({id:Bn.id,params:pe})}return{undos:a,redos:s}}_hasSeries(e){return e.some(n=>Object.keys(n).some(r=>{var i;return!!((i=n[r])!=null&&i.length&&![Si.OTHER,Si.FORMULA].includes(r))}))}};E7=jxe([yt(ot.Steady,E7),w1(0,ae),w1(1,Hi),w1(2,se),w1(3,en),w1(4,vd),w1(5,Oo),w1(6,K(In)),w1(7,K(dt)),w1(8,K(wn))],E7);const eH={id:"sheet.command.hide-row-confirm",type:ue.COMMAND,handler:async t=>{var e;const n=(e=t.get(dt).getSelections())==null?void 0:e.map(o=>o.range);if(!(n!=null&&n.length))return!1;const r=t.get(se),i=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet().getVisibleRows();if(xV(i,n)){const o=t.get(Ca),a=t.get(Gt);return await o.confirm({id:"sheet.confirm.hide-row",title:{title:a.t("info.problem")},children:{title:a.t("rightClick.hideAllRowsAlert")},cancelText:a.t("button.cancel"),confirmText:a.t("button.confirm")}),!1}return await r.executeCommand(ey.id),!0}},tH={id:"sheet.command.hide-col-confirm",type:ue.COMMAND,handler:async t=>{var e;const n=(e=t.get(dt).getSelections())==null?void 0:e.map(o=>o.range);if(!(n!=null&&n.length))return!1;const r=t.get(se),i=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet().getVisibleCols();if(FV(i,n)){const o=t.get(Ca),a=t.get(Gt);return await o.confirm({id:"sheet.confirm.hide-col",title:{title:a.t("info.problem")},children:{title:a.t("rightClick.hideAllColumnsAlert")},cancelText:a.t("button.cancel"),confirmText:a.t("button.confirm")}),!1}return await r.executeCommand(QE.id),!0}},hy={type:ue.COMMAND,id:"sheet.command.set-range-bold",handler:async t=>{const e=t.get(se);return t.get(pr).getContextValue(Mr)?e.executeCommand(od.id):e.executeCommand(jU.id)}},py={type:ue.COMMAND,id:"sheet.command.set-range-italic",handler:async t=>{const e=t.get(se);return t.get(pr).getContextValue(Mr)?e.executeCommand(ad.id):e.executeCommand(zU.id)}},gy={type:ue.COMMAND,id:"sheet.command.set-range-underline",handler:async t=>{const e=t.get(se);return t.get(pr).getContextValue(Mr)?e.executeCommand(sd.id):e.executeCommand(WU.id)}},vy={type:ue.COMMAND,id:"sheet.command.set-range-stroke",handler:async t=>{const e=t.get(se);return t.get(pr).getContextValue(Mr)?e.executeCommand(ud.id):e.executeCommand(YU.id)}},zxe={type:ue.COMMAND,id:"sheet.command.set-range-subscript",handler:async t=>{const e=t.get(se);return t.get(pr).getContextValue(Mr)?e.executeCommand(ol.id):!1}},Wxe={type:ue.COMMAND,id:"sheet.command.set-range-superscript",handler:async t=>{const e=t.get(se);return t.get(pr).getContextValue(Mr)?e.executeCommand(ld.id):!1}},nH={type:ue.COMMAND,id:"sheet.command.set-range-fontsize",handler:async(t,e)=>{const n=t.get(se);return t.get(pr).getContextValue(Mr)?n.executeCommand(Tc.id,e):n.executeCommand(qU.id,e)}},rH={type:ue.COMMAND,id:"sheet.command.set-range-font-family",handler:async(t,e)=>{const n=t.get(se);return t.get(pr).getContextValue(Mr)?n.executeCommand(wc.id,e):n.executeCommand(XU.id,e)}},Y9={type:ue.COMMAND,id:"sheet.command.set-range-text-color",handler:async(t,e)=>{const n=t.get(se);return t.get(pr).getContextValue(Mr)?n.executeCommand(Lc.id,e):n.executeCommand(GU.id,e)}};function iH(t,e){return e.some(n=>Yxe(t,n))}function Yxe(t,e){const{startRow:n,startColumn:r,endColumn:i,endRow:o}=e,a=t.getMatrixWithMergedCells(n,r,o,i);let s=!1;return a.forValue((u,l,c)=>{if(c&&(u!==n||l!==r)&&t.cellHasValue(c))return s=!0,!1}),s}function oH(t,e,n,r){const i=[],o=[],a=n.getSheetId();return r.forEach(s=>{const u=Xxe(n,s),l={unitId:e,subUnitId:a,cellValue:u.getData()},c=ci(t,l);i.push({id:Vt.id,params:c}),o.push({id:Vt.id,params:l})}),{undos:i,redos:o}}function Xxe(t,e){const{startRow:n,startColumn:r,endColumn:i,endRow:o}=e,a=t.getMatrixWithMergedCells(n,r,o,i),s=new Ye;return a.forValue((u,l,c)=>{c&&(u!==n||l!==r)&&s.setValue(u,l,null)}),s}var qxe=Object.defineProperty,Gxe=Object.getOwnPropertyDescriptor,Kxe=(t,e,n,r)=>{for(var i=r>1?void 0:r?Gxe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&qxe(e,n,i),i},jg=(t,e)=>(n,r)=>e(n,r,t),As=(t=>(t[t.OFF=0]="OFF",t[t.ONCE=1]="ONCE",t[t.INFINITE=2]="INFINITE",t))(As||{});const bd=ln("univer.format-painter-service");let iC=class extends We{constructor(e,n,r){super(),H(this,"status$"),H(this,"_selectionFormat"),H(this,"_markId",null),H(this,"_status$"),this._selectionManagerService=e,this._univerInstanceService=n,this._markSelectionService=r,this._status$=new dn(0),this.status$=this._status$.asObservable(),this._selectionFormat={styles:new Ye,merges:[]}}setStatus(e){e!==0&&this._getSelectionRangeFormat(),this._updateRangeMark(e),this._status$.next(e)}getStatus(){return this._status$.getValue()}_updateRangeMark(e){if(this._markSelectionService.removeAllShapes(),this._markId=null,e!==0){const n=this._selectionManagerService.getLast();if(n){const r=this._selectionManagerService.createCopyPasteSelection();e===2?this._markId=this._markSelectionService.addShape({...n,style:r}):this._markId=this._markSelectionService.addShape({...n,style:r},[Vt.id])}}}_getSelectionRangeFormat(){const e=this._selectionManagerService.getLast(),n=e==null?void 0:e.range;if(!n)return;const{startRow:r,endRow:i,startColumn:o,endColumn:a}=n,s=this._univerInstanceService.getCurrentUniverSheetInstance(),u=(s==null?void 0:s.getActiveSheet()).getCellMatrix(),l=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getMergeData(),c=s.getStyles(),d=new Ye;for(let m=r;m<=i;m++)for(let f=o;f<=a;f++){const h=u.getValue(m,f);d.setValue(m,f,c.getStyleByCell(h)||{});const{isMergedMainCell:p,...v}=Xc(m,f,l);p&&this._selectionFormat.merges.push({startRow:v.startRow,startColumn:v.startColumn,endRow:v.endRow,endColumn:v.endColumn})}this._selectionFormat.styles=d}getSelectionFormat(){return this._selectionFormat}};iC=Kxe([jg(0,K(dt)),jg(1,ae),jg(2,B8)],iC);const by={id:"sheet.operation.set-format-painter",type:ue.OPERATION,handler:(t,e)=>e?(t.get(bd).setStatus(e.status),!0):!1},aH={type:ue.COMMAND,id:"sheet.command.set-infinite-format-painter",handler:async t=>{const e=t.get(bd).getStatus();let n;return e!==As.OFF?n=As.OFF:n=As.INFINITE,t.get(se).executeCommand(by.id,{status:n})}},_y={type:ue.COMMAND,id:"sheet.command.set-once-format-painter",handler:async t=>{const e=t.get(bd).getStatus();let n;return e!==As.OFF?n=As.OFF:n=As.ONCE,t.get(se).executeCommand(by.id,{status:n})}},sH={type:ue.COMMAND,id:"sheet.command.apply-format-painter",handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(dt),a=t.get(In),{styleValues:s,styleRange:u,mergeRanges:l,unitId:c=i.getCurrentUniverSheetInstance().getUnitId(),subUnitId:d=i.getCurrentUniverSheetInstance().getActiveSheet().getSheetId()}=e,m=u?[u]:o.getSelectionRanges();if(!m||!m.length)return!1;const f=new Ye;let h;if(Ie.isArray(s))for(let W=0;W<m.length;W++){const{startRow:G,startColumn:Q,endRow:te,endColumn:X}=m[W];for(let x=0;x<=te-G;x++)for(let O=0;O<=X-Q;O++)f.setValue(x+G,O+Q,s[x][O])}else if(jL(s))for(let W=0;W<m.length;W++){const{startRow:G,startColumn:Q}=m[W];f.setValue(G,Q,s)}else h=s;const p={subUnitId:d,unitId:c,cellValue:h??f.getMatrix()},v=ci(t,p);if(!a.fetchThroughInterceptors(Rs.PERMISSION)(null,{id:Ga.id,params:p}))return!1;const g=n.syncExecuteCommand(Vt.id,p),{undos:b,redos:C}=a.onCommandExecute({id:Ga.id,params:{...p,range:m}}),S=Nf(l),E=i.getUniverSheetInstance(c).getSheetBySheetId(d),y=[],D=[],R=iH(E,S),I={unitId:c,subUnitId:d,ranges:S},T={unitId:c,subUnitId:d,ranges:S};y.push({id:Un.id,params:I}),y.push({id:Bn.id,params:T});const P=Zi(t,I),N=Fo(t,T);if(D.push({id:Un.id,params:N}),D.push({id:Bn.id,params:P}),R){const W=oH(t,c,E,S);y.unshift(...W.redos),D.push(...W.undos)}const B=await lr([...C,...y],n);return g&&B.result?(r.pushUndoRedo({unitID:c,undoMutations:[{id:Vt.id,params:v},...b,...D],redoMutations:[{id:Vt.id,params:p},...C,...y]}),!0):!1}},j8={type:ue.COMMAND,id:"sheet.command.set-selection-frozen",handler:async(t,e)=>{const{type:n}=e||{},r=t.get(ae),i=t.get(en),o=r.getCurrentUniverSheetInstance().getUnitId(),a=r.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),s=t.get(se),u=t.get(dt).getSelections();if(!u)return!1;const l=u[(u==null?void 0:u.length)-1],{range:c}=l,d=t.get(Pl),{sheetViewStartRow:m=0,sheetViewStartColumn:f=0}=d.getCurrentScroll()||{};let h,p,v,g;const{startRow:b,startColumn:C,rangeType:S}=c;if(S===ct.ROW||n===1)h=b,v=b-m,p=-1,g=0;else if(S===ct.COLUMN||n===2)h=-1,v=0,p=C,g=C-f;else if(S===ct.NORMAL)h=b,v=b-m,p=C,g=C-f;else return!1;const E={unitId:o,subUnitId:a,startRow:h,startColumn:p,xSplit:p>0?Math.max(1,g):g,ySplit:h>0?Math.max(1,v):v},y=Of(t,E);return s.syncExecuteCommand(io.id,E)&&i.pushUndoRedo({unitID:o,undoMutations:[{id:io.id,params:y}],redoMutations:[{id:io.id,params:E}]}),!0}},uH={type:ue.COMMAND,id:"sheet.command.set-row-frozen",handler:async t=>(t.get(se).executeCommand(j8.id,{type:1}),!0)},lH={type:ue.COMMAND,id:"sheet.command.set-col-frozen",handler:async t=>(t.get(se).executeCommand(j8.id,{type:2}),!0)},cH={type:ue.COMMAND,id:"sheet.command.cancel-frozen",handler:async t=>{const e=t.get(se),n=t.get(ae),r=t.get(en),i=n.getCurrentUniverSheetInstance().getUnitId(),o=n.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),a={unitId:i,subUnitId:o,startRow:-1,startColumn:-1,xSplit:0,ySplit:0},s=Of(t,a);return e.syncExecuteCommand(io.id,a)&&r.pushUndoRedo({unitID:i,undoMutations:[{id:io.id,params:s}],redoMutations:[{id:io.id,params:a}]}),!0}},_d="UI_PLUGIN_SHEETS",z8=`${_d}_COLOR_PICKER_COMPONENT`,dH=`${_d}_FONT_FAMILY_COMPONENT`,mH=`${_d}_FONT_FAMILY_ITEM_COMPONENT`,fH=`${_d}_FONT_SIZE_COMPONENT`,Cy=`${_d}_MENU_ITEM_INPUT_COMPONENT`,Zxe="univer-sheets-ui-context-menu-input",Qxe="univer-sheets-ui-context-menu-input-container",Jxe="univer-sheets-ui-context-menu-input-number",zg={sheetsUiContextMenuInput:Zxe,sheetsUiContextMenuInputContainer:Qxe,sheetsUiContextMenuInputNumber:Jxe},eFe=t=>{const{prefix:e,suffix:n,value:r,onChange:i,min:o=Number.MIN_SAFE_INTEGER,max:a=Number.MAX_SAFE_INTEGER}=t,s=Ct(Gt),[u,l]=_.useState(),c=m=>{var f;l(m==null?void 0:m.toString()),i((f=m==null?void 0:m.toString())!=null?f:"")};_.useEffect(()=>{l(r)},[r]);function d(m){m.key==="Backspace"&&m.stopPropagation()}return U.jsxs("div",{className:zg.sheetsUiContextMenuInput,children:[s.t(e),U.jsx("span",{className:zg.sheetsUiContextMenuInputContainer,onClick:m=>m.stopPropagation(),children:U.jsx(of,{className:zg.sheetsUiContextMenuInputNumber,value:Number(u),precision:0,onKeyDown:d,onChange:c,min:o,max:a})}),s.t(n)]})};var bi=(t=>(t.ROW_HEADER_CONTEXT_MENU="rowHeaderContextMenu",t.COL_HEADER_CONTEXT_MENU="colHeaderContextMenu",t.SHEET_BAR="sheetBar",t))(bi||{});function tFe(t){const e=t.get(bd);return{id:_y.id,subId:aH.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"BrushSingle",title:"Format Painter",tooltip:"toolbar.formatPainter",positions:[hn.TOOLBAR_START],activated$:new Wt(n=>{let r=!1;const i=e.status$.subscribe(o=>{r=o!==As.OFF,n.next(r)});return n.next(r),()=>{i.unsubscribe()}}),hidden$:cr(t,or.SHEET),disabled$:ei(t)}}function nFe(t){const e=t.get(se),n=t.get(ae),r=t.get(pr),i=t.get(dt);return{id:hy.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",positions:[hn.TOOLBAR_START],disabled$:ei(t),activated$:new Wt(o=>{const a=e.onCommandExecuted(s=>{var u,l;const c=s.id;if(c===Vt.id||c===_n.id){const d=(u=i.getLast())==null?void 0:u.primary,m=n.getCurrentUniverSheetInstance().getActiveSheet();let f=E0.NORMAL;if(d!=null){const h=m.getRange(d.startRow,d.startColumn);f=h==null?void 0:h.getFontWeight()}o.next(f===E0.BOLD)}if((c===wo.id||c===_a.id)&&r.getContextValue(Mr)&&r.getContextValue(qo)){const d=kf(t);if(d==null)return;const m=(l=d.ts)==null?void 0:l.bl;o.next(m===we.TRUE)}});return o.next(!1),a.dispose}),hidden$:cr(t,or.SHEET)}}function rFe(t){const e=t.get(se),n=t.get(ae),r=t.get(dt),i=t.get(pr);return{id:py.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",positions:[hn.TOOLBAR_START],disabled$:ei(t),activated$:new Wt(o=>{const a=e.onCommandExecuted(s=>{var u,l;const c=s.id;if(c===Vt.id||c===_n.id){const d=(u=r.getLast())==null?void 0:u.primary,m=n.getCurrentUniverSheetInstance().getActiveSheet();let f=S0.NORMAL;if(d!=null){const h=m.getRange(d.startRow,d.startColumn);f=h==null?void 0:h.getFontStyle()}o.next(f===S0.ITALIC)}if((c===wo.id||c===_a.id)&&i.getContextValue(Mr)&&i.getContextValue(qo)){const d=kf(t);if(d==null)return;const m=(l=d.ts)==null?void 0:l.it;o.next(m===we.TRUE)}});return o.next(!1),a.dispose}),hidden$:cr(t,or.SHEET)}}function iFe(t){const e=t.get(se),n=t.get(ae),r=t.get(dt),i=t.get(pr);return{id:gy.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",positions:[hn.TOOLBAR_START],disabled$:ei(t),activated$:new Wt(o=>{const a=e.onCommandExecuted(s=>{var u,l;const c=s.id;if(c===Vt.id||c===_n.id){const d=(u=r.getLast())==null?void 0:u.primary,m=n.getCurrentUniverSheetInstance().getActiveSheet();let f;if(d!=null){const h=m.getRange(d.startRow,d.startColumn);f=h==null?void 0:h.getUnderline()}o.next(!!(f&&f.s))}if((c===wo.id||c===_a.id)&&i.getContextValue(Mr)&&i.getContextValue(qo)){const d=kf(t);if(d==null)return;const m=(l=d.ts)==null?void 0:l.ul;o.next((m==null?void 0:m.s)===we.TRUE)}});return o.next(!1),a.dispose}),hidden$:cr(t,or.SHEET)}}function oFe(t){const e=t.get(se),n=t.get(ae),r=t.get(dt),i=t.get(pr);return{id:vy.id,group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",positions:[hn.TOOLBAR_START],disabled$:ei(t),activated$:new Wt(o=>{const a=e.onCommandExecuted(s=>{var u,l;const c=s.id;if(c===Vt.id||c===_n.id){const d=(u=r.getLast())==null?void 0:u.primary,m=n.getCurrentUniverSheetInstance().getActiveSheet();let f;if(d!=null){const h=m.getRange(d.startRow,d.startColumn);f=h==null?void 0:h.getStrikeThrough()}o.next(!!(f&&f.s))}if((c===wo.id||c===_a.id)&&i.getContextValue(Mr)&&i.getContextValue(qo)){const d=kf(t);if(d==null)return;const m=(l=d.ts)==null?void 0:l.st;o.next((m==null?void 0:m.s)===we.TRUE)}});return o.next(!1),a.dispose}),hidden$:cr(t,or.SHEET)}}function aFe(t){const e=t.get(se),n=t.get(ae),r=t.get(dt);return{id:rH.id,tooltip:"toolbar.font",group:Kt.TOOLBAR_FORMAT,type:pt.SELECTOR,label:dH,positions:[hn.TOOLBAR_START],selections:S9.map(i=>({label:{name:mH,hoverable:!0},value:i.value})),disabled$:ei(t),value$:new Wt(i=>{const o=S9[0].value,a=e.onCommandExecuted(s=>{var u;const l=s.id;if(l!==Vt.id&&l!==_n.id)return;const c=(u=r.getLast())==null?void 0:u.primary,d=n.getCurrentUniverSheetInstance().getActiveSheet();let m;if(c!=null){const f=d.getRange(c.startRow,c.startColumn);m=f==null?void 0:f.getFontFamily()}i.next(m??o)});return i.next(o),a.dispose}),hidden$:cr(t,or.SHEET)}}function sFe(t){const e=t.get(se),n=t.get(ae),r=t.get(dt),i=t.get(pr),o=ei(t);return{id:nH.id,group:Kt.TOOLBAR_FORMAT,type:pt.SELECTOR,tooltip:"toolbar.fontSize",label:{name:fH,props:{min:1,max:400,disabled$:o}},positions:[hn.TOOLBAR_START],selections:Ik,disabled$:o,value$:new Wt(a=>{const s=e.onCommandExecuted(u=>{var l,c;const d=u.id;if(d===Vt.id||d===_n.id){const m=(l=r.getLast())==null?void 0:l.primary,f=n.getCurrentUniverSheetInstance().getActiveSheet();let h;if(m!=null){const p=f.getRange(m.startRow,m.startColumn);h=p==null?void 0:p.getFontSize()}a.next(h??14)}if((d===wo.id||d===_a.id)&&i.getContextValue(Mr)&&i.getContextValue(qo)){const m=kf(t);if(m==null)return;const f=(c=m.ts)==null?void 0:c.fs;a.next(f??14)}});return a.next(14),s.dispose}),hidden$:cr(t,or.SHEET)}}function uFe(t){return{id:KU.id,type:pt.BUTTON,title:"toolbar.resetColor",icon:"NoColor",positions:Y9.id,disabled$:ei(t)}}function lFe(t){const e=t.get(se),n=t.get(_i);return{id:Y9.id,icon:"FontColor",tooltip:"toolbar.textColor.main",group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON_SELECTOR,positions:[hn.TOOLBAR_START],selections:[{label:{name:z8,hoverable:!1}}],value$:new Wt(r=>{const i=n.getCurrentTheme().textColor,o=e.onCommandExecuted(a=>{if(a.id===Y9.id){const s=a.params.value;r.next(s??i)}});return r.next(i),o.dispose}),hidden$:cr(t,or.SHEET),disabled$:ei(t)}}function cFe(t){return{id:ZU.id,type:pt.BUTTON,title:"toolbar.resetColor",icon:"NoColor",positions:B9.id,disabled$:ei(t)}}function dFe(t){const e=t.get(se),n=t.get(_i);return{id:B9.id,tooltip:"toolbar.fillColor.main",group:Kt.TOOLBAR_FORMAT,type:pt.BUTTON_SELECTOR,positions:[hn.TOOLBAR_START],icon:"PaintBucket",selections:[{label:{name:z8,hoverable:!1}}],value$:new Wt(r=>{const i=n.getCurrentTheme().primaryColor,o=e.onCommandExecuted(a=>{if(a.id===B9.id){const s=a.params.value;r.next(s??i)}});return r.next(i),o.dispose}),hidden$:cr(t,or.SHEET),disabled$:ei(t)}}const ZT=[{label:"align.left",icon:"LeftJustifyingSingle",value:Zn.LEFT},{label:"align.center",icon:"HorizontallySingle",value:Zn.CENTER},{label:"align.right",icon:"RightJustifyingSingle",value:Zn.RIGHT}];function mFe(t){const e=t.get(ae),n=t.get(dt);return{id:W_.id,icon:ZT[0].icon,positions:[hn.TOOLBAR_START],tooltip:"toolbar.horizontalAlignMode.main",group:Kt.TOOLBAR_LAYOUT,type:pt.SELECTOR,selections:ZT,value$:new Wt(r=>{const i=t.get(se).onCommandExecuted(o=>{var a;const s=o.id;if(s!==W_.id&&s!==_n.id)return;const u=(a=n.getLast())==null?void 0:a.primary,l=e.getCurrentUniverSheetInstance().getActiveSheet();let c;if(u!=null){const d=l.getRange(u.startRow,u.startColumn);c=d==null?void 0:d.getHorizontalAlignment()}r.next(c??Zn.LEFT)});return r.next(Zn.LEFT),i.dispose}),hidden$:cr(t,or.SHEET),disabled$:ei(t)}}const QT=[{label:"align.top",icon:"AlignTopSingle",value:li.TOP},{label:"align.middle",icon:"VerticalCenterSingle",value:li.MIDDLE},{label:"align.bottom",icon:"AlignBottomSingle",value:li.BOTTOM}];function fFe(t){const e=t.get(ae),n=t.get(dt);return{id:z_.id,icon:QT[0].icon,tooltip:"toolbar.verticalAlignMode.main",group:Kt.TOOLBAR_LAYOUT,type:pt.SELECTOR,positions:[hn.TOOLBAR_START],selections:QT,value$:new Wt(r=>{const i=t.get(se).onCommandExecuted(o=>{var a;const s=o.id;if(s!==z_.id&&s!==_n.id)return;const u=(a=n.getLast())==null?void 0:a.primary,l=e.getCurrentUniverSheetInstance().getActiveSheet();let c;if(u!=null){const d=l.getRange(u.startRow,u.startColumn);c=d==null?void 0:d.getVerticalAlignment()}r.next(c??li.TOP)});return r.next(li.TOP),i.dispose}),hidden$:cr(t,or.SHEET),disabled$:ei(t)}}const JT=[{label:"textWrap.overflow",icon:"OverflowSingle",value:Ar.OVERFLOW},{label:"textWrap.wrap",icon:"AutowrapSingle",value:Ar.WRAP},{label:"textWrap.clip",icon:"TruncationSingle",value:Ar.CLIP}];function hFe(t){const e=t.get(dt),n=t.get(ae);return{id:Y_.id,tooltip:"toolbar.textWrapMode.main",icon:JT[0].icon,group:Kt.TOOLBAR_LAYOUT,type:pt.SELECTOR,positions:[hn.TOOLBAR_START],selections:JT,value$:new Wt(r=>{const i=t.get(se).onCommandExecuted(o=>{var a;const s=o.id;if(s!==Y_.id&&s!==_n.id)return;const u=(a=e.getLast())==null?void 0:a.primary,l=n.getCurrentUniverSheetInstance().getActiveSheet();let c;if(u!=null){const d=l.getRange(u.startRow,u.startColumn);c=d==null?void 0:d.getWrapStrategy()}r.next(c??Ar.OVERFLOW)});return r.next(Ar.OVERFLOW),i.dispose}),hidden$:cr(t,or.SHEET),disabled$:ei(t)}}const ew=[{label:"textRotate.none",icon:"NoRotationSingle",value:0},{label:"textRotate.angleUp",icon:"LeftRotationFortyFiveDegreesSingle",value:-45},{label:"textRotate.angleDown",icon:"RightRotationFortyFiveDegreesSingle",value:45},{label:"textRotate.vertical",icon:"VerticalTextSingle",value:"v"},{label:"textRotate.rotationUp",icon:"LeftRotationNinetyDegreesSingle",value:-90},{label:"textRotate.rotationDown",icon:"RightRotationNinetyDegreesSingle",value:90}];function pFe(t){const e=t.get(dt),n=t.get(ae);return{id:X_.id,tooltip:"toolbar.textRotateMode.main",icon:ew[0].icon,group:Kt.TOOLBAR_LAYOUT,type:pt.SELECTOR,selections:ew,positions:[hn.TOOLBAR_START],value$:new Wt(r=>{const i=t.get(se).onCommandExecuted(o=>{var a,s;const u=o.id;if(u!==X_.id&&u!==_n.id)return;const l=(a=e.getLast())==null?void 0:a.primary,c=n.getCurrentUniverSheetInstance().getActiveSheet();let d;if(l!=null){const m=c.getRange(l.startRow,l.startColumn);d=m==null?void 0:m.getTextRotation()}(d==null?void 0:d.v)===we.TRUE?r.next("v"):r.next((s=d&&d.a)!=null?s:0)});return r.next(0),i.dispose}),hidden$:cr(t,or.SHEET),disabled$:ei(t)}}function Cd(t){return new Wt(e=>e.next(!t.get($s).supportClipboard))}function gFe(){return{id:vf.id,group:Kt.CONTEXT_MENU_FORMAT,type:pt.BUTTON,title:"rightClick.copy",icon:"Copy",positions:[hn.CONTEXT_MENU,"colHeaderContextMenu","rowHeaderContextMenu"]}}function vFe(t){return{id:bf.id,group:Kt.CONTEXT_MENU_FORMAT,type:pt.BUTTON,title:"rightClick.paste",icon:"PasteSpecial",disabled$:Cd(t),positions:[hn.CONTEXT_MENU,"colHeaderContextMenu","rowHeaderContextMenu"]}}const Sd="sheet.menu.paste-special";function bFe(t){return{id:Sd,group:Kt.CONTEXT_MENU_FORMAT,type:pt.SUBITEMS,icon:"PasteSpecial",title:"rightClick.pasteSpecial",disabled$:Cd(t),positions:[hn.CONTEXT_MENU,"colHeaderContextMenu","rowHeaderContextMenu"]}}function _Fe(t){return{id:LV.id,type:pt.BUTTON,title:"rightClick.pasteValue",positions:[Sd],disabled$:Cd(t)}}function CFe(t){return{id:OV.id,type:pt.BUTTON,title:"rightClick.pasteFormat",positions:[Sd],disabled$:Cd(t)}}function SFe(t){return{id:PV.id,type:pt.BUTTON,title:"rightClick.pasteColWidth",positions:[Sd],disabled$:Cd(t)}}function EFe(t){return{id:MV.id,type:pt.BUTTON,title:"rightClick.pasteBesidesBorder",positions:[Sd],disabled$:Cd(t)}}function yFe(){return{id:Pf.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,positions:["rowHeaderContextMenu"],icon:"AutoHeight",title:"rightClick.fitContent"}}const $f="sheet.menu.sheet-frozen";function DFe(){return{id:$f,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",positions:[hn.CONTEXT_MENU]}}const Sy="sheet.header-menu.sheet-frozen";function RFe(){return{id:Sy,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",positions:["rowHeaderContextMenu","colHeaderContextMenu"]}}function IFe(){return{id:j8.id,type:pt.BUTTON,positions:[$f,Sy],title:"rightClick.freeze",icon:"FreezeToSelectedSingle"}}function AFe(){return{id:uH.id,type:pt.BUTTON,positions:[$f],title:"rightClick.freezeRow",icon:"FreezeRowSingle"}}function TFe(){return{id:lH.id,type:pt.BUTTON,positions:[$f],title:"rightClick.freezeCol",icon:"FreezeColumnSingle"}}function wFe(){return{id:cH.id,type:pt.BUTTON,positions:[$f,Sy],title:"rightClick.cancelFreeze",icon:"CancelFreezeSingle"}}function LFe(){return{id:eH.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,positions:["rowHeaderContextMenu"],icon:"Hide",title:"rightClick.hideSelectedRow"}}function OFe(){return{id:tH.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,positions:["colHeaderContextMenu"],icon:"Hide",title:"rightClick.hideSelectedColumn"}}function PFe(t){const e=t.get(ae),n=t.get(dt);function r(){var o;const a=e.getCurrentUniverSheetInstance().getActiveSheet(),s=(o=n.getSelections())==null?void 0:o.map(u=>u.range).filter(u=>u.rangeType===ct.ROW);return!!(s!=null&&s.some(u=>{for(let l=u.startRow;l<=u.endRow;l++)if(!a.getRowVisible(l))return!0;return!1}))}const i=t.get(se);return{id:VU.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,positions:["rowHeaderContextMenu"],title:"rightClick.showHideRow",hidden$:new Wt(o=>{const a=i.onCommandExecuted(s=>{(s.id===_n.id||s.id===_l.id||s.id===bl.id)&&o.next(!r())});return o.next(!r()),()=>a.dispose()})}}function MFe(t){const e=t.get(ae),n=t.get(dt);function r(){var o;const a=e.getCurrentUniverSheetInstance().getActiveSheet(),s=(o=n.getSelections())==null?void 0:o.map(u=>u.range).filter(u=>u.rangeType===ct.COLUMN);return!s||s.length===0?!1:!!s.some(u=>{for(let l=u.startColumn;l<=u.endColumn;l++)if(!a.getColVisible(l))return!0;return!1})}const i=t.get(se);return{id:kU.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,positions:["colHeaderContextMenu"],title:"rightClick.showHideColumn",hidden$:new Wt(o=>{const a=i.onCommandExecuted(s=>{(s.id===_n.id||s.id===gl.id||s.id===vl.id)&&o.next(!r())});return o.next(!r()),()=>a.dispose()})}}function NFe(t){const e=t.get(se),n=t.get(ae),r=t.get(dt);return{id:oV.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,icon:"AdjustHeight",positions:["rowHeaderContextMenu"],label:{name:Cy,props:{prefix:"rightClick.rowHeight",suffix:"px",min:2,max:1e3}},value$:new Wt(i=>{function o(){var s;const u=(s=r.getLast())==null?void 0:s.primary,l=n.getCurrentUniverSheetInstance().getActiveSheet();let c;u!=null&&(c=l.getRowHeight(u.startRow)),i.next(c??0)}const a=e.onCommandExecuted(s=>{const u=s.id;if(u===Vt.id||u===_n.id)return o()});return o(),a.dispose})}}function xFe(t){const e=t.get(se),n=t.get(ae),r=t.get(dt);return{id:ny.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,icon:"AdjustWidth",positions:["colHeaderContextMenu"],label:{name:Cy,props:{prefix:"rightClick.columnWidth",suffix:"px",min:2,max:1e3}},value$:new Wt(i=>{function o(){var s;const u=(s=r.getLast())==null?void 0:s.primary,l=n.getCurrentUniverSheetInstance().getActiveSheet();let c=0;u!=null&&(c=l.getColumnWidth(u.startColumn)),i.next(c)}const a=e.onCommandExecuted(s=>{const u=s.id;if(u===Vt.id||u===_n.id)return o()});return o(),a.dispose})}}function kf(t){var e;const n=t.get(ae),r=t.get(kr),i=n.getUniverDocInstance(Qr),o=r.getActiveRange();if(i==null||o==null)return;const a=(e=i.getBody())==null?void 0:e.textRuns;if(a==null)return;const{startOffset:s}=o;return a.find(({st:u,ed:l})=>s>=u&&s<l)}function pa(t,e){const n=t.getCurrentUniverSheetInstance().getUnitId(),r=e.getRenderById(n);if(r==null)return;const{components:i,mainComponent:o,scene:a,engine:s}=r,u=o,l=i.get(ho.ROW),c=i.get(ho.COLUMN),d=i.get(ho.LEFT_TOP);return{spreadsheet:u,spreadsheetRowHeader:l,spreadsheetColumnHeader:c,spreadsheetLeftTopPlaceholder:d,scene:a,engine:s}}function tw(t,e,n,r){const{startX:i,startY:o,endX:a,endY:s}=r.getCellByIndex(t,e);return{startX:i,startY:o,endX:a,endY:s}}function jm(t,e,n,r,i){const o=n.getRelativeCoord(zt.FromArray([t,e])),{x:a,y:s}=o,u=n.getScrollXYByRelativeCoords(o,i),{scaleX:l,scaleY:c}=n.getAncestorScale(),d=r.getCellPositionByOffset(a,s,l,c,u),{row:m,column:f}=d,h=r.getNoMergeCellPositionByIndex(m,f),{startX:p,startY:v,endX:g,endY:b}=h;return{startX:p,startY:v,endX:g,endY:b,row:m,column:f}}function Wg(t,e,n,r){const i=n.getRelativeCoord(zt.FromArray([t,e])),o=n.getViewport(Ft.VIEW_MAIN),a=n.getScrollXYByRelativeCoords(i,o),{scaleX:s,scaleY:u}=n.getAncestorScale(),{x:l,y:c}=a,d=t/s+l,m=e/u+c;return{x:d,y:m}}const FFe={spreadsheetLabel:"插件",spreadsheetRightLabel:"更多 Sheets",toolbar:{undo:"撤销",redo:"重做",formatPainter:"格式刷",currencyFormat:"货币格式",percentageFormat:"百分比格式",numberDecrease:"减少小数位数",numberIncrease:"增加小数位数",moreFormats:"更多格式",font:"字体",fontSize:"字号",bold:"粗体",italic:"斜体",strikethrough:"删除线",subscript:"下标",superscript:"上标",underline:"下划线",textColor:{main:"文本颜色",right:"颜色选择"},resetColor:"重置颜色",customColor:"自定义",alternatingColors:"交替颜色",confirmColor:"确定颜色",cancelColor:"取消",collapse:"收起",fillColor:{main:"单元格颜色",right:"颜色选择"},border:{main:"边框",right:"边框类型"},mergeCell:{main:"合并单元格",right:"选择合并类型"},horizontalAlignMode:{main:"水平对齐",right:"对齐方式"},verticalAlignMode:{main:"垂直对齐",right:"对齐方式"},textWrapMode:{main:"文本换行",right:"换行方式"},textRotateMode:{main:"文本旋转",right:"旋转方式"},freezeTopRow:"冻结首行",sortAndFilter:"排序和筛选",findAndReplace:"查找替换",sum:"求和",autoSum:"自动求和",moreFunction:"更多函数",conditionalalFormat:"条件格式",comment:"批注",pivotTable:"数据透视表",chart:"图表",screenshot:"截图",splitColumn:"分列",insertImage:"插入图片",insertLink:"插入链接",dataValidation:"数据验证",protection:"保护工作表内容",clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",toolMore:"更多",toolLess:"少于",toolClose:"收起",toolMoreTip:"更多功能",moreOptions:"更多选项",cellFormat:"设置单元格格式",print:"打印",borderMethod:{top:"上框线",bottom:"下框线",left:"左框线",right:"右框线"},more:"更多"},defaultFmt:{Automatic:{text:"自动",value:"General",example:""},Number:{text:"数字",value:"##0.00",example:"1000.12"},Percent:{text:"百分比",value:"#0.00%",example:"12.21%"},PlainText:{text:"纯文本",value:"@",example:""},Scientific:{text:"科学计数",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"会计",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"万元",value:"w",example:"1亿2000万2500"},Currency:{text:"货币",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"日期",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"时间",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"时间24H",value:"hh:mm",example:"15:00"},DateTime:{text:"日期时间",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"日期时间24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"自定义格式",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"更多货币格式",moreDateTime:"更多日期与时间格式",moreNumber:"更多数字格式",titleCurrency:"货币格式",decimalPlaces:"小数位数",titleDateTime:"日期与时间格式",titleNumber:"数字格式"},print:{normalBtn:"常规视图",layoutBtn:"页面布局",pageBtn:"分页预览",menuItemPrint:"打印(Ctrl+P)",menuItemAreas:"打印区域",menuItemRows:"打印标题行",menuItemColumns:"打印标题列"},align:{left:"左对齐",center:"中间对齐",right:"右对齐",top:"顶部对齐",middle:"居中对齐",bottom:"底部对齐"},button:{confirm:"确定",cancel:"取消",close:"关闭",update:"Update",delete:"Delete",insert:"新建",prevPage:"上一页",nextPage:"下一页",total:"总共："},punctuation:{tab:"Tab 键",semicolon:"分号",comma:"逗号",space:"空格"},colorPicker:{collapse:"收起",customColor:"自定义",change:"切换",confirmColor:"确定",cancelColor:"取消"},borderLine:{borderTop:"上框线",borderBottom:"下框线",borderLeft:"左框线",borderRight:"右框线",borderNone:"无",borderAll:"所有",borderOutside:"外侧",borderInside:"内侧",borderHorizontal:"内侧横线",borderVertical:"内侧竖线",borderColor:"边框颜色",borderSize:"边框粗细",borderType:"边框线类型"},merge:{all:"全部合并",vertical:"垂直合并",horizontal:"水平合并",cancel:"取消合并",overlappingError:"不能合并重叠区域",partiallyError:"无法对部分合并单元格执行此操作",confirm:{title:"合并单元格仅保存左上角单元格的值，是否继续？",cancel:"取消合并",confirm:"继续合并",waring:"警告",dismantleMergeCellWaring:"此操作会导致一些合并单元格被拆散，是否继续?"}},textWrap:{overflow:"溢出",wrap:"自动换行",clip:"截断"},textRotate:{none:"无旋转",angleUp:"向上倾斜",angleDown:"向下倾斜",vertical:"竖排文字",rotationUp:"向上90°",rotationDown:"向下90°"},sheetConfig:{delete:"删除",copy:"复制",rename:"重命名",changeColor:"更改颜色",hide:"隐藏",unhide:"取消隐藏",moveLeft:"向左移",moveRight:"向右移",resetColor:"重置颜色",cancelText:"取消",chooseText:"确定颜色",tipNameRepeat:"标签页的名称不能重复！请重新修改",noMoreSheet:"工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。",confirmDelete:"是否删除",redoDelete:"可以通过Ctrl+Z撤销删除",noHide:"不能隐藏, 至少保留一个sheet标签",chartEditNoOpt:"图表编辑模式下不允许该操作！",sheetNameErrorTitle:"错误",sheetNameSpecCharError:`名称不能超过31个字符，首尾不能是' 且名称不能包含:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"名称不能为空。",sheetNameAlreadyExistsError:"工作表已存在，请输入其它名称。",deleteSheet:"删除工作表",deleteSheetContent:"确认删除此工作表，删除后将不可找回，确定要删除吗？"},rightClick:{copy:"复制",copyAs:"复制为",cut:"剪切",paste:"粘贴",pasteSpecial:"选择性粘贴",pasteValue:"仅粘贴值",pasteFormat:"仅粘贴格式",pasteColWidth:"仅粘贴列宽",pasteBesidesBorder:"仅粘贴边框以外内容",insert:"插入",delete:"删除",insertRow:"插入行",insertRowBefore:"在上方插入行",insertColumn:"插入列",insertColumnBefore:"在左侧插入列",deleteCell:"删除单元格",insertCell:"插入单元格",deleteSelected:"删除选中",hide:"隐藏",hideSelected:"隐藏选中",showHide:"显示隐藏",toTopAdd:"向上增加",toBottomAdd:"向下增加",toLeftAdd:"向左增加",toRightAdd:"向右增加",deleteSelectedRow:"删除选中行",deleteSelectedColumn:"删除选中列",hideSelectedRow:"隐藏选中行",showHideRow:"显示隐藏行",rowHeight:"行高",hideSelectedColumn:"隐藏选中列",showHideColumn:"显示隐藏列",columnWidth:"列宽",to:"向",left:"左",right:"右",top:"上",bottom:"下",moveLeft:"左移",moveUp:"上移",moveRight:"右移",moveDown:"下移",add:"增加",row:"行",column:"列",width:"宽",height:"高",number:"数字",confirm:"确认",orderAZ:"A-Z顺序排列",orderZA:"Z-A降序排列",clearSelection:"清除ㄎㄎ",clearContent:"清除内容ㄎㄎ",clearFormat:"清除格式ㄎㄎ",clearAll:"清除全部",matrix:"矩阵操作选区",sortSelection:"排序选区",filterSelection:"筛选选区",chartGeneration:"图表生成",firstLineTitle:"首行为标题",untitled:"无标题",array1:"一维数组",array2:"二维数组",array3:"多维数组",diagonal:"对角线",antiDiagonal:"反对角线",diagonalOffset:"对角偏移",offset:"偏移量",boolean:"布尔值",flip:"翻转",upAndDown:"上下",leftAndRight:"左右",clockwise:"顺时针",counterclockwise:"逆时针",transpose:"转置",matrixCalculation:"矩阵计算",plus:"加",minus:"减",multiply:"乘",divided:"除",power:"次方",root:"次方根",log:"log",delete0:"删除两端0值",removeDuplicate:"删除重复值",byRow:"按行",byCol:"按列",generateNewMatrix:"生成新矩阵",fitContent:"适合数据",freeze:"冻结",freezeCol:"冻结列",freezeRow:"冻结行",cancelFreeze:"取消冻结",zenEditor:"禅模式编辑",deleteAllRowsAlert:"您无法删除工作表上的所有行",deleteAllColumnsAlert:"您无法删除工作表上的所有列",hideAllRowsAlert:"您无法隐藏工作表上的所有行",hideAllColumnsAlert:"您无法隐藏工作表上的所有列"},info:{tooltip:"提示",notChangeMerge:"不能对合并单元格做部分更改",detailUpdate:"新打开",detailSave:"已恢复本地缓存",row:"行",column:"列",loading:"渲染中···",copy:"副本",return:"返回",rename:"重命名",tips:"重命名",noName:"无标题的电子表格",wait:"待更新",add:"添加",addLast:"在底部添加",backTop:"回到顶部",pageInfo:"共${total}条，${totalPage}页，当前已显示${currentPage}页",nextPage:"下一页",tipInputNumber:"请输入数字",tipInputNumberLimit:"增加范围限制在1-100",tipRowHeightLimit:"行高必须在0 ~ 545之间",tipColumnWidthLimit:"列宽必须在0 ~ 2038之间",pageInfoFull:"共${total}条，${totalPage}页，已显示全部数据",problem:"出现了一个问题"},clipboard:{paste:{exceedMaxCells:"粘贴区域超出最大单元格数"}},statusbar:{sum:"求和",average:"平均值",min:"最小值",max:"最大值",count:"数值计数",countA:"计数",clickToCopy:"点击复制数值",copied:"已复制"},autoFill:{copy:"复制单元格",series:"填充序列",formatOnly:"仅填充格式",noFormat:"不带格式填充"},rangeSelector:{placeholder:"选择范围或输入值",tooltip:"选择范围"},shortcut:{sheet:{"zoom-in":"放大","zoom-out":"缩小","reset-zoom":"恢复缩放","select-below-cell":"选择下方单元格","select-up-cell":"选择上方单元格","select-left-cell":"选择左侧单元格","select-right-cell":"选择右侧单元格","select-next-cell":"选择后一个单元格","select-previous-cell":"选择前一个单元格","select-up-value-cell":"选择上方有值的单元格","select-below-value-cell":"选择下方有值的单元格","select-left-value-cell":"选择左侧有值的单元格","select-right-value-cell":"选择右侧有值的单元格","expand-selection-down":"向下扩展选区","expand-selection-up":"向上扩展选区","expand-selection-left":"向左扩展选区","expand-selection-right":"向右扩展选区","expand-selection-to-left-gap":"向左扩展选区到下一个边界","expand-selection-to-below-gap":"向下扩展选区到下一个边界","expand-selection-to-right-gap":"向右扩展选区到下一个边界","expand-selection-to-up-gap":"向上扩展选区到下一个边界","select-all":"全选","toggle-editing":"开始 / 结束编辑","delete-and-start-editing":"清空并开始编辑","abort-editing":"放弃编辑","break-line":"换行","set-bold":"切换粗体","set-italic":"切换斜体","set-underline":"切换下划线","set-strike-through":"切换删除线"}},"sheet-view":"浏览表格","sheet-edit":"编辑表格"},$Fe=(t,e,n=!1)=>{const r=d=>d.endRow-d.startRow+1,i=d=>d.endColumn-d.startColumn+1,o=r(e)%r(t),a=i(e)%i(t),s={startRow:0,endRow:r(t)-1,startColumn:0,endColumn:i(t)-1},u=Math.floor(r(e)/r(t)),l=Math.floor(i(e)/i(t)),c=[];if(!o&&!a)for(let d=1;d<=u;d++)for(let m=1;m<=l;m++){const f=r(t)*(d-1),h=i(t)*(m-1),p={startRow:f+e.startRow,endRow:f+e.startRow,startColumn:h+e.startColumn,endColumn:h+e.startColumn};c.push({repeatRelativeRange:s,startRange:p})}else if(!o&&a&&!n)for(let d=1;d<=u;d++){const m=r(t)*(d-1),f=0,h={startRow:m+e.startRow,endRow:m+e.startRow,startColumn:f+e.startColumn,endColumn:f+e.startColumn};c.push({repeatRelativeRange:s,startRange:h})}else if(o&&!a&&!n)for(let d=1;d<=l;d++){const m=i(t)*(d-1),f={startRow:0+e.startRow,endRow:0+e.startRow,startColumn:m+e.startColumn,endColumn:m+e.startColumn};c.push({repeatRelativeRange:s,startRange:f})}else{const d={startRow:e.startRow,endRow:e.startRow,startColumn:e.startColumn,endColumn:e.startColumn};c.push({startRange:d,repeatRelativeRange:s})}return c};class kFe{constructor(){H(this,"_state",null),H(this,"_rect",null),H(this,"_focus",!1),H(this,"_state$",new dn(null)),H(this,"state$",this._state$.asObservable()),H(this,"_rect$",new dn(null)),H(this,"rect$",this._rect$.asObservable()),H(this,"_focus$",new dn(this._focus)),H(this,"focus$",this._focus$.asObservable())}dispose(){this._state$.complete(),this._state=null,this._rect$.complete(),this._rect=null}setState(e){this._state=e,this._refresh(e)}getRect(){return this._rect}setRect(e){this._rect=e,this._rect$.next(e)}getState(){return this._state}setFocus(e=!1){this._focus=e,this._focus$.next(e)}_refresh(e){this._state$.next(e)}}const o2=ln("univer.sheet-cell-editor-manager.service");class BFe{constructor(){H(this,"_position",null),H(this,"_position$",new dn(null)),H(this,"position$",this._position$.asObservable()),H(this,"_focus",!1),H(this,"_focus$",new dn(this._focus)),H(this,"focus$",this._focus$.asObservable()),H(this,"_fxBtnClick$",new dn(!1)),H(this,"fxBtnClick$",this._fxBtnClick$.asObservable()),H(this,"_foldBtnStatus$",new dn(!1)),H(this,"foldBtnStatus$",this._foldBtnStatus$.asObservable())}dispose(){this._position$.complete(),this._focus$.complete(),this._position=null,this._focus=!1}setPosition(e){this._position=e,this._refresh(e)}getPosition(){return this._position}setFocus(e=!1){this._focus=e,this._focus$.next(e)}handleFxBtnClick(e){this._fxBtnClick$.next(e)}handleFoldBtnClick(e){this._foldBtnStatus$.next(e)}_refresh(e){this._position$.next(e)}}const Bf=ln("univer.sheet-formula-editor-manager.service");var UFe=Object.defineProperty,VFe=Object.getOwnPropertyDescriptor,HFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?VFe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&UFe(e,n,i),i},nw=(t,e)=>(n,r)=>e(n,r,t);let y7=class extends We{constructor(e,n){super(),H(this,"_previousSheetIndex",-1),this._commandService=e,this._univerInstanceService=n,this.disposeWithMe(this._commandService.beforeCommandExecuted((r,i)=>{if(r.id===Qo.id)return this._beforeAdjustActiveSheetOnRemoveSheet(r)})),this.disposeWithMe(this._commandService.onCommandExecuted((r,i)=>{if(r.id===Qo.id)return this._adjustActiveSheetOnRemoveSheet(r);if(r.id===Wo.id&&r.params.hidden)return this._adjustActiveSheetOnHideSheet(r);if(!(i!=null&&i.fromCollab)){if(r.id===Eo.id)return this._adjustActiveSheetOnInsertSheet(r);if(r.id===Wo.id&&!r.params.hidden)return this._adjustActiveSheetOnShowSheet(r)}}))}_adjustActiveSheetOnHideSheet(e){const{unitId:n,subUnitId:r}=e.params,i=this._univerInstanceService.getUniverSheetInstance(n);if(!i||i.getActiveSheet().getSheetId()!==r)return;const o=i.getActiveSheetIndex(),a=rw(i,o);this._switchToNextSheet(n,a)}_beforeAdjustActiveSheetOnRemoveSheet(e){const{unitId:n,subUnitId:r}=e.params,i=this._univerInstanceService.getUniverSheetInstance(n);if(!i)return;const o=i.getSheetBySheetId(r);o&&(this._previousSheetIndex=i.getSheetIndex(o))}_adjustActiveSheetOnRemoveSheet(e){if(this._previousSheetIndex===-1)return;const{unitId:n}=e.params,r=this._univerInstanceService.getUniverSheetInstance(n);if(!r||r.getRawActiveSheet())return;const i=this._previousSheetIndex,o=i>=1?i-1:0,a=rw(r,o);this._switchToNextSheet(n,a)}_adjustActiveSheetOnInsertSheet(e){const{unitId:n,sheet:r}=e.params;this._switchToNextSheet(n,r.id)}_adjustActiveSheetOnShowSheet(e){const{unitId:n,subUnitId:r}=e.params;this._switchToNextSheet(n,r)}_switchToNextSheet(e,n){this._commandService.executeCommand(Us.id,{unitId:e,subUnitId:n})}};y7=HFe([yt(ot.Ready,y7),nw(0,se),nw(1,ae)],y7);function rw(t,e){const n=t.getSheetSize();for(let r=e;r>-1;r--){const i=t.getSheetByIndex(r);if(!i.getConfig().hidden)return i.getSheetId()}for(let r=e;r<n;r++){const i=t.getSheetByIndex(r);if(!i.getConfig().hidden)return i.getSheetId()}throw new Error("[ActiveWorksheetController]: could not find the next unhidden sheet! Collaboration error perhaps.")}var jFe=Object.defineProperty,zFe=Object.getOwnPropertyDescriptor,WFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zFe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&jFe(e,n,i),i},Jd=(t,e)=>(n,r)=>e(n,r,t);let D7=class{constructor(e,n,r,i,o){this._injector=e,this._sheetInterceptorService=n,this._selectionManagerService=r,this._univerInstanceService=i,this._sheetSkeletonManagerService=o,this._initialize()}_getUndoRedoParamsOfAutoHeight(e){const{_univerInstanceService:n,_sheetSkeletonManagerService:r,_injector:i}=this,{skeleton:o}=r.getCurrent(),a=o.calculateAutoHeightInRange(e),s=n.getCurrentUniverSheetInstance(),u=s.getUnitId(),l={subUnitId:s.getActiveSheet().getSheetId(),unitId:u,rowsAutoHeightInfo:a},c=xPe(i,l);return{undos:[{id:Um.id,params:c}],redos:[{id:Um.id,params:l}]}}_initialize(){const{_sheetInterceptorService:e,_selectionManagerService:n}=this;e.interceptCommand({getMutations:r=>r.id!==Ga.id?{redos:[],undos:[]}:this._getUndoRedoParamsOfAutoHeight(r.params.range)}),e.interceptCommand({getMutations:r=>r.id!==Pf.id?{redos:[],undos:[]}:this._getUndoRedoParamsOfAutoHeight(r.params.ranges)}),e.interceptCommand({getMutations:r=>{var i;if(r.id!==ii.id)return{redos:[],undos:[]};if(!["ff","fs","tr","tb"].includes((i=r.params)==null?void 0:i.style.type))return{redos:[],undos:[]};const o=n.getSelectionRanges();return o!=null&&o.length?this._getUndoRedoParamsOfAutoHeight(o):{redos:[],undos:[]}}})}};D7=WFe([yt(ot.Ready,D7),Jd(0,K(wn)),Jd(1,K(In)),Jd(2,K(dt)),Jd(3,K(ae)),Jd(4,K(Dr))],D7);var YFe=Object.defineProperty,XFe=Object.getOwnPropertyDescriptor,qFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?XFe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&YFe(e,n,i),i},rs=(t,e)=>(n,r)=>e(n,r,t);let R7=class extends Ro{constructor(e,n,r,i,o,a,s,u,l,c,d){var m;super(),this._injector=e,this._currentUniverSheet=n,this._commandService=r,this._contextService=i,this._configService=o,this._sheetClipboardService=a,this._clipboardInterfaceService=s,this._messageService=u,this._sheetSkeletonManagerService=l,this._localService=c,this._textSelectionRenderManager=d,this._init(),this._clipboardInterfaceService.supportClipboard||(m=this._textSelectionRenderManager)==null||m.onPaste$.pipe(Fi(this.dispose$)).subscribe(f=>{var h,p;if(!ar(this._contextService))return;f.event.preventDefault();const v=f.event,g=(h=v.clipboardData)==null?void 0:h.getData("text/html"),b=(p=v.clipboardData)==null?void 0:p.getData("text/plain");this._sheetClipboardService.legacyPaste(g,b)})}_init(){[xNe,FNe,gd].forEach(n=>this.disposeWithMe(this._commandService.registerMultipleCommand(n))),[LV,OV,PV,MV].forEach(n=>this.disposeWithMe(this._commandService.registerCommand(n))),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initCopyingHooks())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initPastingHook()));const e=this._initSpecialPasteHooks().map(n=>this._sheetClipboardService.addClipboardHook(n));this.disposeWithMe({dispose:()=>e.forEach(n=>n.dispose())})}_initCopyingHooks(){const e=this;let n=null;return{id:ro.DEFAULT_COPY,isDefaultHook:!0,onBeforeCopy(r,i){n=e._getWorksheet(r,i)},onCopyCellContent(r,i){const o=n.getCell(r,i);return`${(o==null?void 0:o.v)||""}`},onCopyCellStyle:(r,i,o,a)=>{const s={};(o||a)&&(s.rowspan=`${o||1}`,s.colspan=`${a||1}`);const u=n.getRange(r,i).getTextStyle();let l="";return u&&(l=AW(u)),l&&(s.style=l),s},onCopyColumn(r){return{width:`${n.getColumnWidth(r)}`}},onCopyRow(r){return{style:`height: ${n.getRowHeight(r)}px;`}},onAfterCopy(){n=null}}}_initPastingHook(){const e=this;let n=null,r=null,i=null;return{id:ro.DEFAULT_PASTE,isDefaultHook:!0,onBeforePaste({unitId:o,subUnitId:a,range:s}){i=e._getWorksheet(o,a),n=o,r=a;const u=e._configService.getConfig(sV),{endRow:l,endColumn:c}=s;return u&&l*c>u?(e._messageService.show({type:q5.Error,content:e._localService.t("clipboard.paste.exceedMaxCells")}),!1):!0},onPasteRows(o,a){const{range:s}=o,u=[],l=i.getMaxRows(),c=s.endRow-l,d=a.length-c;if(c>0){const h={};a.slice(d).forEach((v,g)=>{const{style:b,height:C}=v||{};if(b){const S=b.split(";");let E=Ev;S.find(y=>{y=y.toLowerCase();const D=a0(y.substr(0,y.indexOf(":"))),R=a0(y.substr(y.indexOf(":")+1));return D==="height"?(E=Number.parseFloat(R),!0):!1}),h[g]={h:E,hd:we.FALSE}}else C&&(h[g]={h:Number.parseFloat(C),hd:we.FALSE})});const p={unitId:n,subUnitId:r,range:{...s,startRow:l},rowInfo:h};u.push({id:kc.id,params:p})}const m={};a.slice(0,d).forEach((h,p)=>{const{style:v,height:g}=h;if(v){const b=v.split(";");let C=Ev;b.find(S=>{S=S.toLowerCase();const E=a0(S.substr(0,S.indexOf(":"))),y=a0(S.substr(S.indexOf(":")+1));return E==="height"?(C=Number.parseFloat(y),!0):!1}),m[p+s.startRow]=C}else g&&(m[p+s.startRow]=Number.parseFloat(g))});const f={unitId:n,subUnitId:r,ranges:[{...s,endRow:Math.min(s.endRow,l)}],rowHeight:m};return u.push({id:m1.id,params:f}),{redos:u,undos:[]}},onPasteColumns(o,a,s){var u;const{range:l}=o,c=[],d=i.getMaxColumns(),m=l.endColumn-d,f=a.length-m,h=(u=e._configService.getConfig(mD))!=null?u:yv;if(m>0){const v={unitId:n,subUnitId:r,range:{...l,startColumn:d},colInfo:a.slice(f).map(g=>({w:g.width?+g.width:h,hd:we.FALSE}))};c.push({id:Bc.id,params:v})}const p={unitId:n,subUnitId:r,ranges:[{...l,endRow:Math.min(l.endColumn,d)}],colWidth:a.slice(0,f).map(v=>v.width?+v.width:h)};return c.push({id:Wa.id,params:p}),{redos:c,undos:[]}},onPastePlainText(o,a,s){return e._onPastePlainText(o,a,s)},onPasteCells(o,a,s,u){return e._onPasteCells(o,a,s,u)},onAfterPaste(o){i=null}}}_generateDocumentDataModelSnapshot(e){var n;const r=this._sheetSkeletonManagerService.getCurrent();if(r==null)return null;const{skeleton:i}=r,o=(n=i.getBlankCellDocumentModel())==null?void 0:n.documentModel,a={...o==null?void 0:o.getSnapshot(),...e};return o==null||o.reset(a),o==null?void 0:o.getSnapshot()}_onPastePlainText(e,n,r){const{range:i,unitId:o,subUnitId:a}=e;let s;if(/\r|\n/.test(n)){const l=AV(n),c=this._generateDocumentDataModelSnapshot({body:l});s={[i.startRow]:{[i.startColumn]:{p:c}}}}else s={[i.startRow]:{[i.startColumn]:{v:n}}};const u={unitId:o,subUnitId:a,cellValue:s};return{redos:[{id:Vt.id,params:u}],undos:[{id:Vt.id,params:ci(this._injector,u)}]}}_onPasteCells(e,n,r,i){const o={get:this._injector.get.bind(this._injector)};return lNe(e,n,r,i,o)}_initSpecialPasteHooks(){const e={get:this._injector.get.bind(this._injector)},n=this,r={id:ro.SPECIAL_PASTE_VALUE,specialPasteInfo:{label:"specialPaste.value"},onPasteCells:(s,u,l,c)=>{const d=n._currentUniverSheet.getCurrentUniverSheetInstance();return d.getUnitId(),d.getActiveSheet().getSheetId(),DV(u,l,e)}},i={id:ro.SPECIAL_PASTE_FORMAT,specialPasteInfo:{label:"specialPaste.format"},onPasteCells(s,u,l,c){const d=n._currentUniverSheet.getCurrentUniverSheetInstance();d.getUnitId(),d.getActiveSheet().getSheetId();const m=[],f=[],{undos:h,redos:p}=IV(u,l,e);m.push(...p),f.push(...h);const{undos:v,redos:g}=J_(u,l,e);m.push(...g),f.push(...v);const{undos:b,redos:C}=RV(u,l,e);return m.push(...C),f.push(...b),{undos:f,redos:m}}},o={id:ro.SPECIAL_PASTE_COL_WIDTH,specialPasteInfo:{label:"specialPaste.colWidth"},onPasteCells(){return{undos:[],redos:[]}},onPasteColumns(s,u,l){var c;const d=n._currentUniverSheet.getCurrentUniverSheetInstance(),m=d.getUnitId(),f=d.getActiveSheet().getSheetId(),h=[],p=n._getWorksheet(m,f),{range:v}=s,g=p.getMaxColumns(),b=v.endColumn-g,C=u.length-b,S=(c=n._configService.getConfig(mD))!=null?c:yv,E={unitId:m,subUnitId:f,ranges:[{...v,endRow:Math.min(v.endColumn,g)}],colWidth:u.slice(0,C).map(y=>y.width?+y.width:S)};return h.push({id:Wa.id,params:E}),h.push({id:Wa.id,params:E}),{redos:h,undos:[]}}},a={id:ro.SPECIAL_PASTE_BESIDES_BORDER,specialPasteInfo:{label:"specialPaste.besidesBorder"},onPasteCells(s,u,l,c){n._currentUniverSheet.getCurrentUniverSheetInstance();const d=[],m=[],{range:f,unitId:h,subUnitId:p}=u,{startColumn:v,startRow:g,endColumn:b,endRow:C}=f,S=new Ye;l.forValue((I,T,P)=>{const N=P.s;typeof N=="object"&&S.setValue(I+g,T+v,{s:{...N,bd:void 0},v:P.v})});const E={unitId:h,subUnitId:p,cellValue:S.getData()};d.push({id:Vt.id,params:E});const y=ci(e,E);m.push({id:Vt.id,params:y});const{undos:D,redos:R}=J_(u,l,e);return m.push(...D),d.push(...R),{redos:d,undos:m}}};return[r,i,o,a]}_getWorksheet(e,n){var r;const i=(r=this._currentUniverSheet.getUniverSheetInstance(e))==null?void 0:r.getSheetBySheetId(n);if(!i)throw new Error(`[SheetClipboardController]: cannot find a worksheet with unitId ${e} and subUnitId ${n}.`);return i}};R7=qFe([yt(ot.Steady,R7),rs(0,K(wn)),rs(1,ae),rs(2,se),rs(3,pr),rs(4,K0),rs(5,r2),rs(6,$s),rs(7,Ef),rs(8,K(Dr)),rs(9,K(Gt)),rs(10,W0(To))],R7);var GFe=Object.defineProperty,KFe=Object.getOwnPropertyDescriptor,ZFe=(t,e,n,r)=>{for(var i=r>1?void 0:r?KFe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&GFe(e,n,i),i},e6=(t,e)=>(n,r)=>e(n,r,t);let I7=class extends We{constructor(e,n,r,i,o){super(),this._currentUniverService=e,this._contextMenuService=n,this._renderManagerService=r,this._selectionManagerService=i,this._selectionRenderService=o,this._currentUniverService.currentSheet$.subscribe(a=>{if(a==null)throw new Error("workbook is null");this._addListeners()})}_addListeners(){const e=pa(this._currentUniverService,this._renderManagerService);if(!e)return;const n=e.spreadsheet.onPointerDownObserver,r=n.add(a=>{if(a.button===2){const s=this._selectionManagerService.getSelections(),u=s==null?void 0:s[0];if(!u)return;const l=u.range.rangeType,c=this._selectionRenderService.convertSelectionRangeToData(u).rangeWithCoord,d=()=>{if(!c)return!1;const f=a.offsetX,h=a.offsetY;switch(l){case ct.ROW:return c.startY<=h&&c.endY>=h;case ct.COLUMN:return c.startX<=f&&c.endX>=f;default:return c.startX<=f&&c.endX>=f&&c.startY<=h&&c.endY>=h}},m=f=>{this._contextMenuService.triggerContextMenu(a,f)};d()?l===ct.COLUMN?m(bi.COL_HEADER_CONTEXT_MENU):l===ct.ROW?m(bi.ROW_HEADER_CONTEXT_MENU):m(hn.CONTEXT_MENU):m(hn.CONTEXT_MENU)}});this.disposeWithMe(je(()=>n.remove(r)));const i=e.spreadsheetRowHeader.onPointerDownObserver.add(a=>{a.button===2&&this._contextMenuService.triggerContextMenu(a,bi.ROW_HEADER_CONTEXT_MENU)});this.disposeWithMe(je(()=>n.remove(i)));const o=e.spreadsheetColumnHeader.onPointerDownObserver.add(a=>{a.button===2&&this._contextMenuService.triggerContextMenu(a,bi.COL_HEADER_CONTEXT_MENU)});this.disposeWithMe(je(()=>n.remove(o)))}};I7=ZFe([yt(ot.Rendered,I7),e6(0,ae),e6(1,yf),e6(2,Jn),e6(3,K(dt)),e6(4,Hi)],I7);var QFe=Object.defineProperty,JFe=Object.getOwnPropertyDescriptor,e$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?JFe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&QFe(e,n,i),i},Yg=(t,e)=>(n,r)=>e(n,r,t);let A7=class extends Ro{constructor(e,n,r){super(),this._currentUniverService=e,this._renderManagerService=n,this._undoRedoService=r,this._initialize(),this._commandExecutedListener()}_initialize(){this._initialNormalInput(),this._listenEditorBlur()}_listenEditorBlur(){this._currentUniverService.currentDoc$.pipe(Fi(this.dispose$)).subscribe(e=>{e!=null&&e.getUnitId()!==Qr&&this._undoRedoService.clearUndoRedo(Qr)})}_initialNormalInput(){const e={};this._currentUniverService.getCurrentUniverSheetInstance().getSheets().forEach(n=>{const r=n.getConfig();e[n.getSheetId()]={cellData:new Ye(r.cellData),rowCount:r.rowCount,columnCount:r.columnCount}})}_commandExecutedListener(){}_getDocObject(){return r8(this._currentUniverService,this._renderManagerService)}};A7=e$e([yt(ot.Steady,A7),Yg(0,ae),Yg(1,Jn),Yg(2,K(en))],A7);const hH=[Ge.ARROW_DOWN,Ge.ARROW_UP,Ge.ARROW_LEFT,Ge.ARROW_RIGHT],t$e=[Ge.ENTER,Ge.TAB,...hH];function n$e(){const t=[];for(const e of hH)t.push({id:z9.id,binding:e,preconditions:n=>H9(n),staticParameters:{visible:!1,eventType:dr.Keyboard,keycode:e,isShift:!1}}),t.push({id:z9.id,binding:e|Yt.SHIFT,preconditions:n=>H9(n),staticParameters:{visible:!1,eventType:dr.Keyboard,keycode:e,isShift:!0}});return t}const r$e={id:v1.id,binding:Ge.ENTER,description:"shortcut.sheet.toggle-editing",group:"4_sheet-edit",preconditions:t=>H9(t),staticParameters:{visible:!1,eventType:dr.Keyboard,keycode:Ge.ENTER}},i$e={id:v1.id,binding:Ge.TAB,preconditions:t=>H9(t),staticParameters:{visible:!1,eventType:dr.Keyboard,keycode:Ge.TAB}},o$e={id:v1.id,binding:Ge.ESC,description:"shortcut.sheet.abort-editing",group:"4_sheet-edit",preconditions:t=>EV(t),staticParameters:{visible:!1,eventType:dr.Keyboard,keycode:Ge.ESC}},a$e={id:RE.id,description:"shortcut.sheet.break-line",group:"4_sheet-edit",preconditions:t=>EV(t),binding:Ge.ENTER|Yt.ALT},s$e={id:IE.id,preconditions:t=>zMe(t)||yV(t),binding:Ge.BACKSPACE},u$e={id:v1.id,description:"shortcut.sheet.delete-and-start-editing",group:"4_sheet-edit",preconditions:t=>ar(t)&&!yV(t),binding:Ge.BACKSPACE,staticParameters:{visible:!0,eventType:dr.Keyboard,keycode:Ge.BACKSPACE}};var l$e=Object.defineProperty,c$e=Object.getOwnPropertyDescriptor,d$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?c$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&l$e(e,n,i),i},Ws=(t,e)=>(n,r)=>e(n,r,t);function m$e(t){const{textRuns:e=[],paragraphs:n=[]}=t;return e.some(r=>r.ts&&!Ie.isEmptyObject(r.ts))||n.some(r=>r.bullet)||n.length>=2}let T7=class extends We{constructor(e,n,r,i,o,a,s,u,l,c){super(),H(this,"_onInputSubscription"),H(this,"_cursorChangeObservers"),H(this,"_editorVisiblePrevious",!1),H(this,"_isCursorChange",0),this._currentUniverService=e,this._renderManagerService=n,this._commandService=r,this._editorBridgeService=i,this._contextService=o,this._cellEditorManagerService=a,this._lexerTreeBuilder=s,this._undoRedoService=u,this._sheetInterceptorService=l,this._selectionManagerService=c,this._initialize(),this._commandExecutedListener()}dispose(){var e;(e=this._onInputSubscription)==null||e.unsubscribe();const n=this._getEditorObject();if(n==null)return;const{document:r}=n;r.onPointerDownObserver.remove(this._cursorChangeObservers)}_initialize(){this._initialExitInput(),this._cursorStateListener()}_initialExitInput(){this._onInputSubscription=this._editorBridgeService.visible$.subscribe(e=>{const{visible:n,keycode:r,eventType:i}=e;if(n===this._editorVisiblePrevious)return;if(this._editorVisiblePrevious=n,n===!0){this._isCursorChange=i===dr.PointerDown?2:1;return}this._isCursorChange=0;const o=this._selectionManagerService.getSelections(),a=this._selectionManagerService.getCurrent();if(a==null)return;const{unitId:s,sheetId:u,pluginName:l}=a;if(this._exitInput(e),r===Ge.ESC){this._commandService.syncExecuteCommand(_n.id,{unitId:s,subUnitId:u,pluginName:l,selections:o});return}const c=this._editorBridgeService.getEditCellState();if(c==null)return;const{unitId:d,sheetId:m,row:f,column:h,documentLayoutObject:p}=c;if(this._editorBridgeService.getEditorDirty()===!1){this._moveCursor(r);return}const v=this._currentUniverService.getUniverSheetInstance(d),g=v==null?void 0:v.getSheetBySheetId(m);if(g==null)return;const b=f$e(g.getCellRaw(f,h)||{},p,this._lexerTreeBuilder);if(b==null){this._moveCursor(r);return}const C={subUnitId:m,unitId:d,workbook:v,worksheet:g,row:f,col:h},S=this._editorBridgeService.interceptor.fetchThroughInterceptors(this._editorBridgeService.interceptor.getInterceptPoints().AFTER_CELL_EDIT)(b,C);this._commandService.executeCommand(Ga.id,{subUnitId:m,unitId:d,range:{startRow:f,startColumn:h,endRow:f,endColumn:h},value:S}),this._moveCursor(r),s===d&&m!==u&&this._editorBridgeService.isForceKeepVisible()&&this._commandService.executeCommand(pd.id,{subUnitId:m,unitId:d}),this._selectionManagerService.refreshSelection()})}_exitInput(e){this._contextService.setContextValue(rc,!1),this._contextService.setContextValue(Mr,!1),this._contextService.setContextValue(BC,!1),this._contextService.setContextValue(W1,!1),this._cellEditorManagerService.setState({show:e.visible});const n=this._editorBridgeService.getCurrentEditorId();n!=null&&(this._undoRedoService.clearUndoRedo(n),this._undoRedoService.clearUndoRedo(qn))}_moveCursor(e){if(e==null||!t$e.includes(e))return;let n=ye.LEFT;switch(e){case Ge.ENTER:n=ye.DOWN;break;case Ge.TAB:n=ye.RIGHT;break;case Ge.ARROW_DOWN:n=ye.DOWN;break;case Ge.ARROW_UP:n=ye.UP;break;case Ge.ARROW_LEFT:n=ye.LEFT;break;case Ge.ARROW_RIGHT:n=ye.RIGHT;break}e===Ge.ENTER||e===Ge.TAB?this._commandService.executeCommand(i2.id,{keycode:e,direction:n}):this._commandService.executeCommand(vo.id,{direction:n})}_cursorStateListener(){const e=this._getEditorObject();if(e==null)return;const{document:n}=e;this._cursorChangeObservers=n.onPointerDownObserver.add(()=>{this._isCursorChange===1&&(this._isCursorChange=2)})}_commandExecutedListener(){const e=[z9.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=n.params,{keycode:i,isShift:o}=r;if(i!=null&&this._isCursorChange===2){this._moveInEditor(i,o);return}this._editorBridgeService.changeVisible(r)}}))}_moveInEditor(e,n){let r=ye.LEFT;e===Ge.ARROW_DOWN?r=ye.DOWN:e===Ge.ARROW_UP?r=ye.UP:e===Ge.ARROW_RIGHT&&(r=ye.RIGHT),n?this._commandService.executeCommand(al.id,{direction:r}):this._commandService.executeCommand(nu.id,{direction:r})}_getEditorObject(){return bc(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};T7=d$e([yt(ot.Steady,T7),Ws(0,ae),Ws(1,Jn),Ws(2,se),Ws(3,Oo),Ws(4,pr),Ws(5,o2),Ws(6,K(E1)),Ws(7,en),Ws(8,K(In)),Ws(9,K(dt))],T7);function f$e(t,e,n){t=Ie.deepClone(t);const{documentModel:r}=e;if(r==null)return null;const i=r.getSnapshot(),{body:o}=i;if(o==null)return null;const a=o.dataStream;let s=a.substring(a.length-2,a.length)===Sc?a.substring(0,a.length-2):a;if($i(s)){if(t.f===s)return null;const u=n.checkIfAddBracket(s);for(let l=0;l<u;l++)s+=bn.CLOSE_BRACKET;t.f=s,t.v=null,t.p=null}else if(m$e(o))o.dataStream===`\r
`?(t.v="",t.f=null,t.si=null,t.p=null):(t.p=i,t.v=null,t.f=null,t.si=null);else{if((s===t.v||s===""&&t.v==null)&&t.p==null)return null;t.v=s,t.f=null,t.si=null,t.p=null}return t}var h$e=Object.defineProperty,p$e=Object.getOwnPropertyDescriptor,g$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?p$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&h$e(e,n,i),i},Ys=(t,e)=>(n,r)=>e(n,r,t);let w7=class extends Ro{constructor(e,n,r,i,o,a,s,u,l,c){super(),H(this,"_loadedMap",new Set),this._univerInstanceService=e,this._renderManagerService=n,this._editorBridgeService=r,this._docSkeletonManagerService=i,this._docViewModelManagerService=o,this._commandService=a,this._contextService=s,this._formulaEditorManagerService=u,this._undoRedoService=l,this._textSelectionManagerService=c,this._initialize()}_initialize(){this._syncFormulaEditorContent(),this._commandExecutedListener(),this._syncEditorSize(),this._listenFxBtnClick(),this._listenFoldBtnClick(),this._renderManagerService.currentRender$.pipe(Fi(this.dispose$)).subscribe(e=>{e===qn&&(this._loadedMap.has(e)||(this._initialMain(e),this._loadedMap.add(e)))}),this._textSelectionManagerService.textSelection$.pipe(Fi(this.dispose$)).subscribe(e=>{if(e==null)return;const{unitId:n}=e;n!==qn&&(this._contextService.setContextValue(W1,!1),this._undoRedoService.clearUndoRedo(qn))})}_listenFxBtnClick(){this._formulaEditorManagerService.fxBtnClick$.pipe(Fi(this.dispose$)).subscribe(()=>{var e;if(this._contextService.getContextValue(BC)&&!this._contextService.getContextValue(Mr)){this._univerInstanceService.setCurrentUniverDocInstance(qn),this._contextService.setContextValue(W1,!0);const n=this._univerInstanceService.getUniverDocInstance(qn);this._editorBridgeService.isVisible().visible===!1&&this._editorBridgeService.changeVisible({visible:!0,eventType:dr.PointerDown});const r=(e=n==null?void 0:n.getBody())==null?void 0:e.dataStream;if(r==null)return;let i=r.startsWith("=")?r:`=${r}`;i=i.replace(/\r\n$/,"");const o=[{startOffset:i.length,endOffset:i.length}],a={unitId:qn,body:{dataStream:i},segmentId:""};this._commandService.executeCommand(wF.id,a),this._textSelectionManagerService.replaceTextRanges(o)}})}_listenFoldBtnClick(){this._formulaEditorManagerService.foldBtnStatus$.pipe(Fi(this.dispose$)).subscribe(()=>{this._textSelectionManagerService.refreshSelection()})}_initialMain(e){const n=this._renderManagerService.getRenderById(e);if(n==null)return;const{mainComponent:r}=n;r!=null&&this.disposeWithMe(je(r.onPointerDownObserver.add(()=>{this._contextService.setContextValue(W1,!0),this._undoRedoService.clearUndoRedo(qn),this._editorBridgeService.isVisible().visible===!1&&this._editorBridgeService.changeVisible({visible:!0,eventType:dr.PointerDown})})))}_syncEditorSize(){this._formulaEditorManagerService.position$.pipe(Fi(this.dispose$)).subscribe(e=>{if(e==null)return;const n=bc(qn,this._renderManagerService),r=this._univerInstanceService.getUniverDocInstance(qn);if(n==null||r==null)return;const{width:i,height:o}=e,{engine:a}=n;r.updateDocumentDataPageSize(i),this._autoScroll(),requestIdleCallback(()=>{a.resizeBySize(i,o)})})}_syncFormulaEditorContent(){this._editorBridgeService.currentEditCellState$.pipe(Fi(this.dispose$)).subscribe(e=>{e==null||this._editorBridgeService.isForceKeepVisible()||this._editorSyncHandler(e)}),this._editorBridgeService.visible$.pipe(Fi(this.dispose$)).subscribe(e=>{if(e==null||e.visible===!1||this._editorBridgeService.isForceKeepVisible())return;const n=this._editorBridgeService.getLatestEditCellState();n!=null&&this._editorSyncHandler(n)})}_editorSyncHandler(e){var n;const r=(n=e.documentLayoutObject.documentModel)==null?void 0:n.getBody();let i=r==null?void 0:r.dataStream,o=r==null?void 0:r.paragraphs,a=[];i==null||o==null||(e.isInArrayFormulaRange===!0&&this._editorBridgeService.isVisible().eventType===dr.Dblclick?(i=`\r
`,o=[{startIndex:0}]):e.isInArrayFormulaRange===!0&&(a=(r==null?void 0:r.textRuns)||[]),this._syncContentAndRender(qn,i,o,a),this._autoScroll())}_commandExecutedListener(){const e=[Lo.id,V8.id],n=[Qr,qn];this.disposeWithMe(this._commandService.onCommandExecuted(i=>{var o,a;if(e.includes(i.id)){const s=i.params,{unitId:u}=s;if(n.includes(u)){const l=this._univerInstanceService.getUniverDocInstance(u),c=(o=l==null?void 0:l.getBody())==null?void 0:o.dataStream,d=(a=l==null?void 0:l.getBody())==null?void 0:a.paragraphs,m=u===qn?Qr:qn;if(c==null||d==null)return;this._syncContentAndRender(m,c,d),this._autoScroll()}}}));const r=[Vt.id,qa.id];this.disposeWithMe(this._commandService.onCommandExecuted(i=>{var o,a,s,u,l;if(r.includes(i.id)){const c=this._editorBridgeService.getLatestEditCellState();if(c==null)return;let d=!1;const{row:m,column:f}=c;if(i.id===Vt.id&&i.params?(a=(o=i.params.cellValue)==null?void 0:o[m])!=null&&a[f]&&(d=!0):i.id===qa.id&&i.params&&(u=(s=i.params.to.value)==null?void 0:s[m])!=null&&u[f]&&(d=!0),d){const h=(l=c.documentLayoutObject.documentModel)==null?void 0:l.getBody();if(h==null)return;const{dataStream:p,paragraphs:v=[]}=h;this._syncContentAndRender(qn,p,v),this._autoScroll()}}}))}_syncContentAndRender(e,n,r,i=[]){var o;const a=[Qr,qn],s=this._docSkeletonManagerService.getSkeletonByUnitId(e),u=this._univerInstanceService.getUniverDocInstance(e),l=this._docViewModelManagerService.getViewModel(e);if(u==null||l==null||s==null)return;u.getBody().dataStream=n,u.getBody().paragraphs=this._clearParagraph(r),e===qn&&(u.getBody().textRuns=[]),i.length>0&&(u.getBody().textRuns=i),l.reset(u);const{skeleton:c}=s,d=this._renderManagerService.getRenderById(e);d!=null&&(c.calculate(),a.includes(e)&&((o=d.mainComponent)==null||o.makeDirty()))}_clearParagraph(e){const n=Ie.deepClone(e);for(const r of n)r.paragraphStyle&&(r.paragraphStyle.horizontalAlign=Zn.UNSPECIFIED);return n}_autoScroll(){var e,n;const r=(e=this._docSkeletonManagerService.getSkeletonByUnitId(qn))==null?void 0:e.skeleton,i=this._formulaEditorManagerService.getPosition(),o=this._renderManagerService.getRenderById(qn),a=this._univerInstanceService.getUniverDocInstance(qn);if(r==null||i==null||o==null||a==null)return;const{marginTop:s=0,marginBottom:u=0}=a.getSnapshot().documentStyle,{scene:l,mainComponent:c}=o;let{actualHeight:d}=r.getActualSize();d+=s+u;const{width:m,height:f}=i,h=l.getViewport(x0.VIEW_MAIN);let p=h==null?void 0:h.getScrollBar();l.transformByState({width:m,height:d}),c==null||c.resize(m,d),d>f?p==null?h&&new n8(h,{enableHorizontal:!1,barSize:8}):h==null||h.resetSizeAndScrollBar():(p=null,h==null||h.scrollTo({x:0,y:0}),(n=h==null?void 0:h.getScrollBar())==null||n.dispose())}};w7=g$e([yt(ot.Steady,w7),Ys(0,ae),Ys(1,Jn),Ys(2,Oo),Ys(3,K(Zo)),Ys(4,K(tu)),Ys(5,se),Ys(6,pr),Ys(7,Bf),Ys(8,en),Ys(9,K(kr))],w7);var v$e=Object.defineProperty,b$e=Object.getOwnPropertyDescriptor,_$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?b$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&v$e(e,n,i),i},C$e=(t,e)=>(n,r)=>e(n,r,t);let L7=class extends We{constructor(e){super(),this._currentUniverService=e,setTimeout(()=>{this._initialize()},0)}_initialize(){this._currentUniverService.createDoc({id:Qr,body:{dataStream:`${Sc}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{}});const e={id:qn,body:{dataStream:`${Sc}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginTop:5,marginBottom:5,marginRight:0,marginLeft:0,paragraphLineGapDefault:0,renderConfig:{horizontalAlign:Zn.UNSPECIFIED,verticalAlign:li.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:Ar.WRAP}}};this._currentUniverService.createDoc(e)}};L7=_$e([yt(ot.Rendered,L7),C$e(0,ae)],L7);const S$e="36",E$e="univer-sheet-container",pH={sheetFooterBarHeight:S$e,sheetContainer:E$e};var y$e=Object.defineProperty,D$e=Object.getOwnPropertyDescriptor,R$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?D$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&y$e(e,n,i),i},is=(t,e)=>(n,r)=>e(n,r,t);const iw=-1e3,ow=5,I$e=2;let O7=class extends We{constructor(e,n,r,i,o,a,s,u,l,c,d){super(),H(this,"_onInputSubscription"),H(this,"_onInputActivateSubscription"),H(this,"_editorVisiblePrevious",!1),this._docSkeletonManagerService=e,this._docViewModelManagerService=n,this._contextService=r,this._currentUniverService=i,this._renderManagerService=o,this._editorBridgeService=a,this._cellEditorManagerService=s,this._textSelectionRenderManager=u,this._textSelectionManagerService=l,this._commandService=c,this._localService=d,this._initialize(),this._commandExecutedListener()}dispose(){var e,n;(e=this._onInputSubscription)==null||e.unsubscribe(),(n=this._onInputActivateSubscription)==null||n.unsubscribe()}_initialize(){this._initialEditFocusListener(),this._initialStartEdit(),this._initialKeyboardListener(),this._initialCursorSync(),this._listenEditorFocus()}_listenEditorFocus(){const e=this._getEditorObject();e!=null&&this.disposeWithMe(je(e.document.onPointerDownObserver.add(()=>{var n;if(this._editorBridgeService.isVisible()){const r=this._editorBridgeService.getEditCellState(),i=this._editorBridgeService.getCurrentEditorId();if(r==null||i==null)return;const o=(n=this._docSkeletonManagerService.getSkeletonByUnitId(i))==null?void 0:n.skeleton;if(o==null)return;const{position:a,documentLayoutObject:s,canvasOffset:u,scaleX:l,scaleY:c}=r;this._fitTextSize(a,u,o,s,l,c)}})))}_initialCursorSync(){this._cellEditorManagerService.focus$.subscribe(()=>{this._textSelectionRenderManager.sync()})}_initialEditFocusListener(){this._onInputSubscription=this._editorBridgeService.currentEditCellState$.subscribe(e=>{if(e==null||this._editorBridgeService.isForceKeepVisible())return;const{position:n,documentLayoutObject:r,scaleX:i,editorUnitId:o}=e;if(this._getEditorObject()==null)return;const{startX:a,endX:s}=n,{textRotation:u,wrapStrategy:l,documentModel:c}=r,{a:d}=u;c.updateDocumentId(o),l===Ar.WRAP&&d===0&&c.updateDocumentDataPageSize((s-a)/i),this._currentUniverService.changeDoc(o,c),this._contextService.setContextValue(BC,!0),this._textSelectionManagerService.replaceTextRanges([{startOffset:0,endOffset:0}]),this._textSelectionRenderManager.activate(iw,iw)})}_fitTextSize(e,n,r,i,o=1,a=1){const{startX:s,startY:u,endX:l,endY:c}=e,d=i.documentModel;if(d==null)return;const{actualWidth:m,actualHeight:f}=this._predictingSize(e,n,r,i,o,a),{verticalAlign:h,paddingData:p,fill:v}=i;let g=l-s,b=c-u;if(g<m&&(g=m),b<f)b=f,d.updateDocumentDataMargin(p);else{let C=b-f||0;h===li.MIDDLE?C=(b-f)/2:h===li.TOP&&(C=p.t||0),C/=a,C=C<(p.t||0)?p.t||0:C,d.updateDocumentDataMargin({t:C})}r.calculate(),this._editAreaProcessing(g,b,e,n,v,o,a)}_predictingSize(e,n,r,i,o=1,a=1){const{startX:s,endX:u}=e,{textRotation:l,wrapStrategy:c}=i,d=i.documentModel,{a:m}=l,f=document.body.clientWidth;if(c===Ar.WRAP&&m===0){const{actualWidth:v,actualHeight:g}=r.getActualSize();return{actualWidth:v*o,actualHeight:g*a}}d==null||d.updateDocumentDataPageSize((f-s-n.left)/o),r.calculate();const h=r.getActualSize();let p=u-s;return p<h.actualWidth*o+ow*o&&(p=h.actualWidth*o+ow*o),d==null||d.updateDocumentDataPageSize(p/o),d==null||d.updateDocumentRenderConfig({horizontalAlign:Zn.UNSPECIFIED}),{actualWidth:p,actualHeight:h.actualHeight*a}}_editAreaProcessing(e,n,r,i,o,a=1,s=1){var u;const l=this._getEditorObject();if(l==null)return;let{startX:c,startY:d}=r;const{document:m,scene:f,engine:h}=l,p=f.getViewport(x0.VIEW_MAIN),v=document.body.clientHeight-d-Number.parseFloat(pH.sheetFooterBarHeight)-i.top-I$e*2,g=document.body.clientWidth-c-i.left;let b=n,C=p==null?void 0:p.getScrollBar();b>v?(b=v,C==null?p&&new n8(p,{enableHorizontal:!1,barSize:8}):p==null||p.resetSizeAndScrollBar()):(C=null,(u=p==null?void 0:p.getScrollBar())==null||u.dispose()),e+=(C==null?void 0:C.barSize)||0,e>g&&(e=g),c-=gi,d-=gi,this._addBackground(f,e/a,n/s,o);const{scaleX:S,scaleY:E}=f.getPrecisionScale();f.transformByState({width:e/a,height:n/s,scaleX:a,scaleY:s}),m.resize(e/a,n/s),requestIdleCallback(()=>{h.resizeBySize(rn(e,S),rn(b,E))}),this._cellEditorManagerService.setState({startX:c,startY:d,endX:e+c,endY:b+d,show:!0})}_addBackground(e,n,r,i){const o="_backgroundRectHelperColor_",a=e.getObject(o);a==null&&i==null||(a==null?e.addObjects([new cn(o,{width:n,height:r,fill:i,evented:!1})],m_):i==null?a.dispose():(a.setProps({fill:i}),a.transformByState({width:n,height:r})))}_initialStartEdit(){this._onInputActivateSubscription=this._editorBridgeService.visible$.subscribe(e=>{var n,r,i;const{visible:o,eventType:a,keycode:s}=e;if(o===this._editorVisiblePrevious||(this._editorVisiblePrevious=o,o===!1))return;const u=this._editorBridgeService.getEditCellState();if(u==null)return;const{position:l,documentLayoutObject:c,canvasOffset:d,scaleX:m,scaleY:f,editorUnitId:h,unitId:p,isInArrayFormulaRange:v=!1}=u,g=this._getEditorObject();if(g==null)return;const{document:b,scene:C}=g;this._contextService.setContextValue(Mr,!0);const{documentModel:S}=c,E=this._docSkeletonManagerService.getSkeletonByUnitId(h);if(E==null||S==null)return;const{skeleton:y}=E;if(this._fitTextSize(l,d,y,c,m,f),a===dr.Keyboard||a===dr.Dblclick&&v){const D=Ie.deepClone(S.snapshot),R=(n=this._docViewModelManagerService.getCurrent())==null?void 0:n.docViewModel;this._resetBodyStyle(D.body),S.reset(D),R.reset(S),b.makeDirty(),(s===Ge.BACKSPACE||a===dr.Dblclick)&&(y.calculate(),this._editorBridgeService.changeEditorDirty(!0)),this._textSelectionManagerService.replaceTextRanges([{startOffset:0,endOffset:0}])}else if(a===dr.Dblclick){const D=S.getBody().dataStream.length-2||0;(r=C.getViewport(x0.VIEW_MAIN))==null||r.scrollTo({y:Number.POSITIVE_INFINITY}),this._textSelectionManagerService.replaceTextRanges([{startOffset:D,endOffset:D}])}(i=this._renderManagerService.getRenderById(p))==null||i.scene.resetCursor()})}_resetBodyStyle(e){e.dataStream=Sc,e.textRuns!=null&&(e.textRuns.length===1?(e.textRuns[0].st=0,e.textRuns[0].ed=1):e.textRuns=void 0),e.paragraphs!=null&&(e.paragraphs.length===1?e.paragraphs[0].startIndex=0:e.paragraphs=[{startIndex:0}]),e.sectionBreaks!=null&&(e.sectionBreaks=void 0),e.tables!=null&&(e.tables=void 0),e.customRanges!=null&&(e.customRanges=void 0),e.customBlocks!=null&&(e.customBlocks=void 0)}_initialKeyboardListener(){this._textSelectionRenderManager.onInputBefore$.subscribe(e=>{const n=this._contextService.getContextValue(W1);this._contextService.getContextValue(qo)&&!n&&this._showEditorByKeyboard(e)})}_showEditorByKeyboard(e){if(e==null)return;const n=e.event;this._commandService.executeCommand(v1.id,{visible:!0,eventType:dr.Keyboard,keycode:n.which})}_commandExecutedListener(){const e=[Lo.id,V8.id],n=[Qr,qn];this.disposeWithMe(this._commandService.onCommandExecuted(r=>{var i;if(e.includes(r.id)){const o=r.params,{unitId:a}=o,s=this._editorBridgeService.getCurrentEditorId();if(s==null)return;this._editorBridgeService.changeEditorDirty(!0);const u=(i=this._docSkeletonManagerService.getSkeletonByUnitId(s))==null?void 0:i.skeleton;if(u==null||!n.includes(a))return;const l=this._editorBridgeService.getEditCellState();if(l==null)return;const{position:c,documentLayoutObject:d,canvasOffset:m,scaleX:f,scaleY:h}=l;this._fitTextSize(c,m,u,d,f,h)}}))}_getEditorObject(){return bc(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};O7=R$e([yt(ot.Steady,O7),is(0,K(Zo)),is(1,K(tu)),is(2,pr),is(3,ae),is(4,Jn),is(5,Oo),is(6,o2),is(7,To),is(8,K(kr)),is(9,se),is(10,K(Gt))],O7);const W8={id:"sheet.command.change-zoom-ratio",type:ue.COMMAND,handler:async(t,e)=>{if(!e)return!1;const{delta:n,reset:r}=e,i=t.get(ae).getCurrentUniverSheetInstance(),o=i.getActiveSheet(),a=i.getUnitId(),s=o.getSheetId();let u=r?100:Math.round((o.getConfig().zoomRatio+n)*100);u=Math.max(K_[0],u),u=Math.min(K_[1],u);const l=u/100;return t.get(se).executeCommand(Ml.id,{unitId:a,subUnitId:s,zoomRatio:l})}},Y8={id:"sheet.command.set-zoom-ratio",type:ue.COMMAND,handler:async(t,e)=>{if(!e)return!1;const{unitId:n,subUnitId:r,zoomRatio:i}=e;return t.get(se).executeCommand(Ml.id,{unitId:n,subUnitId:r,zoomRatio:i})}},gH={id:"sheet.operation.set-activate-cell-edit",type:ue.OPERATION,handler:(t,e)=>(t.get(Oo).setEditCell(e),!0)};var A$e=Object.defineProperty,T$e=Object.getOwnPropertyDescriptor,w$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?T$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&A$e(e,n,i),i},D2=(t,e)=>(n,r)=>e(n,r,t);let P7=class extends Ro{constructor(e,n,r,i,o,a){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._editorBridgeService=o,this._selectionManagerService=a,this._initialize(),this._commandExecutedListener()}dispose(){}_initialize(){this._initSelectionChangeListener(),this._initialEventListener()}_initSelectionChangeListener(){Q9(this._selectionManagerService.selectionMoveEnd$,this._selectionManagerService.selectionMoveStart$).pipe(Fi(this.dispose$)).subscribe(e=>this._handleSelectionListener(e))}_handleSelectionListener(e){const n=this._selectionManagerService.getCurrent();if((n==null?void 0:n.pluginName)!==Nn||this._editorBridgeService.isVisible().visible===!0)return;const r=this._sheetSkeletonManagerService.getCurrent();if(r==null||e==null||e.length===0||e[e.length-1]==null)return;const{primary:i}=e[e.length-1];if(i==null)return;const o=this._getSheetObject();if(o==null)return;const{unitId:a,sheetId:s}=r,{scene:u,engine:l}=o;this._commandService.executeCommand(gH.id,{scene:u,engine:l,primary:i,unitId:a,sheetId:s})}_initialEventListener(){const e=this._getSheetObject();if(e==null)return;const{spreadsheet:n,spreadsheetColumnHeader:r,spreadsheetLeftTopPlaceholder:i,spreadsheetRowHeader:o}=e;n.onDblclickObserver.add(a=>{a.button!==2&&this._commandService.executeCommand(v1.id,{visible:!0,eventType:dr.Dblclick})}),n.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this)),r.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this)),i.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this)),o.onPointerDownObserver.add(this._keepVisibleHideEditor.bind(this))}_keepVisibleHideEditor(){this._editorBridgeService.isForceKeepVisible()||this._hideEditor()}_hideEditor(){this._editorBridgeService.isVisible().visible===!0&&(this._selectionManagerService.makeDirty(!1),this._commandService.executeCommand(v1.id,{visible:!1,eventType:dr.PointerDown}),setTimeout(()=>{this._selectionManagerService.makeDirty(!0)},0))}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}_commandExecutedListener(){const e=bV;this.disposeWithMe(this._commandService.onCommandExecuted((n,r)=>{r!=null&&r.fromCollab||(n.id===Us.id?this._keepVisibleHideEditor():e.includes(n.id)&&this._hideEditor())})),this.disposeWithMe(this._commandService.onCommandExecuted(n=>{n.id===Y8.id&&this._editorBridgeService.refreshEditCellState()}))}};P7=w$e([yt(ot.Rendered,P7),D2(0,K(Dr)),D2(1,ae),D2(2,se),D2(3,Jn),D2(4,Oo),D2(5,K(dt))],P7);var L$e=Object.defineProperty,O$e=Object.getOwnPropertyDescriptor,P$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?O$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&L$e(e,n,i),i},t6=(t,e)=>(n,r)=>e(n,r,t);let M7=class extends We{constructor(e,n,r,i,o){super(),this._commandService=e,this._formatPainterService=n,this._currentUniverService=r,this._renderManagerService=i,this._selectionRenderService=o,this._initialize()}_initialize(){this._commandExecutedListener(),this._bindFormatPainterStatus()}_bindFormatPainterStatus(){this._formatPainterService.status$.subscribe(e=>{const{scene:n}=this._getSheetObject()||{};n&&(e!==As.OFF?n.setDefaultCursor(Jt.CELL):n.setDefaultCursor(Jt.DEFAULT))})}_commandExecutedListener(){this.disposeWithMe(je(this._selectionRenderService.selectionMoveEnd$.subscribe(e=>{if(this._formatPainterService.getStatus()!==As.OFF){const{rangeWithCoord:n}=e[e.length-1];this._applyFormatPainter({startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn}),this._formatPainterService.getStatus()===As.ONCE&&this._commandService.executeCommand(_y.id)}})))}async _applyFormatPainter(e){const{styles:n,merges:r}=this._formatPainterService.getSelectionFormat(),i=this._currentUniverService.getCurrentUniverSheetInstance().getUnitId(),o=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();if(!n)return;const{startRow:a,startColumn:s,endRow:u,endColumn:l}=n.getDataRange(),c=u-a+1,d=l-s+1,m=Array.from({length:e.endRow-e.startRow+1},()=>Array.from({length:e.endColumn-e.startColumn+1},()=>({}))),f=[];m.forEach((p,v)=>{p.forEach((g,b)=>{const C=v%c+a,S=b%d+s,E=n.getValue(C,S);E&&(m[v][b].s=E)})}),r.forEach(p=>{const v={startRow:p.startRow-a,startColumn:p.startColumn-s,endRow:p.endRow-a,endColumn:p.endColumn-s},g=Math.max(1,Math.floor((e.endRow-e.startRow+1)/c)),b=Math.max(1,Math.floor((e.endColumn-e.startColumn+1)/d));for(let C=0;C<g;C++)for(let S=0;S<b;S++)f.push({startRow:v.startRow+C*c+e.startRow,startColumn:v.startColumn+S*d+e.startColumn,endRow:v.endRow+C*c+e.startRow,endColumn:v.endColumn+S*d+e.startColumn})});const h={subUnitId:o,unitId:i,styleRange:e,styleValues:m,mergeRanges:f};await this._commandService.executeCommand(sH.id,h)}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}};M7=P$e([yt(ot.Rendered,M7),t6(0,se),t6(1,bd),t6(2,ae),t6(3,Jn),t6(4,Hi)],M7);const N7={id:"sheet.command.set-scroll-relative",type:ue.COMMAND,handler:async(t,e={offsetX:0,offsetY:0})=>{const n=t.get(se),r=t.get(Pl),i=t.get(ae).getCurrentUniverSheetInstance(),o=i.getActiveSheet(),{xSplit:a,ySplit:s}=o.getConfig().freeze,u=r.getCurrentScroll(),{offsetX:l=0,offsetY:c=0}=e||{},{sheetViewStartRow:d=0,sheetViewStartColumn:m=0,offsetX:f=0,offsetY:h=0}=u||{};return n.executeCommand(U8.id,{unitId:i.getUnitId(),sheetId:o.getSheetId(),sheetViewStartRow:d+s,sheetViewStartColumn:m+a,offsetX:f+l,offsetY:h+c})}},_0={id:"sheet.command.scroll-view",type:ue.COMMAND,handler:async(t,e)=>{if(!e)return!1;const n=t.get(ae).getCurrentUniverSheetInstance(),r=n.getActiveSheet(),i=t.get(Pl).getCurrentScroll();if(!r)return!1;const o=t.get(se),{sheetViewStartRow:a,sheetViewStartColumn:s,offsetX:u,offsetY:l}=e,{sheetViewStartColumn:c,sheetViewStartRow:d,offsetX:m,offsetY:f}=i||{},{xSplit:h,ySplit:p}=r.getConfig().freeze;return o.executeCommand(U8.id,{unitId:n.getUnitId(),sheetId:r.getSheetId(),sheetViewStartRow:a??(d??0)+p,sheetViewStartColumn:s??(c??0)+h,offsetX:u??m,offsetY:l??f})}};ue.COMMAND;var M$e=Object.defineProperty,N$e=Object.getOwnPropertyDescriptor,x$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?N$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&M$e(e,n,i),i},Xs=(t,e)=>(n,r)=>e(n,r,t);const F$e="__SpreadsheetFreezeRowMainName__",$$e="__SpreadsheetFreezeRowHeaderName__",k$e="__SpreadsheetFreezeColumnMainName__",B$e="__SpreadsheetFreezeColumnHeaderName__",Xg=4,U$e=.01;let x7=class extends We{constructor(e,n,r,i,o,a,s,u,l,c){super(),H(this,"_rowFreezeHeaderRect"),H(this,"_rowFreezeMainRect"),H(this,"_columnFreezeHeaderRect"),H(this,"_columnFreezeMainRect"),H(this,"_freezeDownObservers",[]),H(this,"_freezeMoveObservers",[]),H(this,"_freezeLeaveObservers",[]),H(this,"_moveObserver"),H(this,"_upObserver"),H(this,"_changeToRow",-1),H(this,"_changeToColumn",-1),H(this,"_changeToOffsetX",0),H(this,"_changeToOffsetY",0),H(this,"_activeViewport",null),H(this,"_freezeNormalHeaderColor",""),H(this,"_freezeNormalMainColor",""),H(this,"_freezeActiveColor",""),H(this,"_freezeHoverColor",""),H(this,"_lastFreeze"),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionRenderService=o,this._selectionManagerService=a,this._scrollManagerService=s,this._themeService=u,this._sheetInterceptorService=l,this._injector=c,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._themeChangeListener(),this._interceptorCommands(),this._bindViewportScroll(),this._zoomRefresh()}_createFreeze(e=0,n){var r;const i=n??this._getFreeze();if(i==null)return;const o=(r=this._sheetSkeletonManagerService.getCurrent())==null?void 0:r.skeleton;if(o==null)return;const{startRow:a,startColumn:s}=i,u=this._getPositionByIndex(a,s);if(u==null)return;const l=this._getSheetObject();if(l==null)return;const c=l.engine,d=(c==null?void 0:c.width)||0,m=(c==null?void 0:c.height)||0,f=l.scene,{startX:h,startY:p}=u,{rowTotalHeight:v,columnTotalWidth:g,rowHeaderWidthAndMarginLeft:b,columnHeaderHeightAndMarginTop:C}=o,S=d>g+b?d:g+C,E=m>v+C?m:v+C;this._changeToRow=a,this._changeToColumn=s,this._changeToOffsetX=h,this._changeToOffsetY=p;const y=Math.max(f.scaleX,f.scaleY),D=Xg/(y<1?1:y);if(e===0){const R=D;this._rowFreezeHeaderRect=new cn($$e,{fill:this._freezeNormalHeaderColor,width:b,height:D,left:0,top:p-R,zIndex:3});let I=this._freezeNormalHeaderColor;(a===-1||a===0)&&(I=this._freezeNormalMainColor),this._rowFreezeMainRect=new cn(F$e,{fill:I,width:S*2,height:D,left:b,top:p-R,zIndex:3}),f.addObjects([this._rowFreezeHeaderRect,this._rowFreezeMainRect],El)}else{const R=D;this._columnFreezeHeaderRect=new cn(B$e,{fill:this._freezeNormalHeaderColor,width:D,height:C,left:h-R,top:0,zIndex:3});let I=this._freezeNormalHeaderColor;(s===-1||s===0)&&(I=this._freezeNormalMainColor),this._columnFreezeMainRect=new cn(k$e,{fill:I,width:D,height:E*2,left:h-R,top:C,zIndex:3}),f.addObjects([this._columnFreezeHeaderRect,this._columnFreezeMainRect],El)}this._eventBinding(e)}_eventBinding(e=0){let n=this._rowFreezeHeaderRect,r=this._rowFreezeMainRect;e===1&&(n=this._columnFreezeHeaderRect,r=this._columnFreezeMainRect);const i=this._getSheetObject();if(i==null)return;const{scene:o}=i;this._freezeMoveObservers.push(n==null?void 0:n.onPointerEnterObserver.add(()=>{n==null||n.setProps({fill:this._freezeHoverColor,zIndex:4}),o.setCursor(Jt.GRAB)})),this._freezeMoveObservers.push(r==null?void 0:r.onPointerEnterObserver.add(()=>{n==null||n.setProps({fill:this._freezeHoverColor,zIndex:4}),o.setCursor(Jt.GRAB)})),this._freezeLeaveObservers.push(n==null?void 0:n.onPointerLeaveObserver.add(()=>{n==null||n.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),o.resetCursor()})),this._freezeLeaveObservers.push(r==null?void 0:r.onPointerLeaveObserver.add(()=>{n==null||n.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),o.resetCursor()})),this._freezeDownObservers.push(n==null?void 0:n.onPointerDownObserver.add(a=>{this._freezeDown(a,n,r,e)})),this._freezeDownObservers.push(r==null?void 0:r.onPointerDownObserver.add(a=>{this._freezeDown(a,n,r,e)}))}_getCurrentLastVisibleRow(){var e,n,r,i;const o=this._getSheetObject();if(o==null)return;const a=(e=this._sheetSkeletonManagerService.getCurrent())==null?void 0:e.skeleton;if(a==null)return;const s=o.scene,u=Math.max(s.scaleX,s.scaleY),l=this._scrollManagerService.getCurrentScroll(),c=(o.engine.height-a.columnHeaderHeight)/u,d=(n=l==null?void 0:l.sheetViewStartRow)!=null?n:0,m=d===0?-((r=l==null?void 0:l.offsetY)!=null?r:0):a.rowHeightAccumulation[d-1]-((i=l==null?void 0:l.offsetY)!=null?i:0);let f=0,h=!1;for(let p=d,v=a.rowHeightAccumulation.length;p<v;p++)if(a.rowHeightAccumulation[p]-m>c){f=p,h=!0;break}return h||(f=a.rowHeightAccumulation.length-1),f}_getActiveViewport(e){var n;const r=(n=this._getSheetObject())==null?void 0:n.scene.getViewports();return r&&r.find(i=>i.isHit(new zt(e.offsetX,e.offsetY)))||null}_freezeDown(e,n,r,i=0){var o;const a=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(a==null)return;const s=this._getSheetObject();if(s==null)return;const{scene:u}=s;u.setCursor(Jt.GRABBING),u.disableEvent();const l=this._getCurrentLastVisibleRow(),c=l===void 0?Number.POSITIVE_INFINITY:a.rowHeightAccumulation[l];this._activeViewport=null;const d=this._getFreeze();d&&(this._changeToColumn=d.startColumn,this._changeToRow=d.startRow),this._moveObserver=u.onPointerMoveObserver.add(m=>{var f,h,p,v;const g=this._getActiveViewport(m),{startX:b,startY:C,row:S,column:E}=jm(m.offsetX,m.offsetY,u,a,g||void 0);u.setCursor(Jt.GRABBING);const y=Xg/Math.max(u.scaleX,u.scaleY);i===0?((f=n.transformByState({top:Math.min(C,c)-y/2}))==null||f.setProps({fill:this._freezeActiveColor}),(h=r.transformByState({top:Math.min(C,c)-y/2}))==null||h.setProps({fill:this._freezeNormalHeaderColor}),this._changeToRow=l===void 0?S:Math.min(S,l),this._changeToOffsetY=Math.min(C,c),this._activeViewport=g):((p=n.transformByState({left:b-y/2}))==null||p.setProps({fill:this._freezeActiveColor}),(v=r.transformByState({left:b-y/2}))==null||v.setProps({fill:this._freezeNormalHeaderColor}),this._changeToColumn=E,this._changeToOffsetX=b,this._activeViewport=g)}),this._upObserver=u.onPointerUpObserver.add(()=>{var m,f;u.resetCursor(),u.enableEvent(),this._clearObserverEvent();const{rowHeaderWidthAndMarginLeft:h,columnHeaderHeightAndMarginTop:p}=a;i===0&&(this._changeToRow===0||this._changeToRow===-1)||i===1&&(this._changeToColumn===0||this._changeToColumn===-1)?(n.setProps({fill:this._freezeNormalHeaderColor}),r.setProps({fill:this._freezeNormalMainColor})):(n==null||n.setProps({fill:this._freezeNormalHeaderColor}),r==null||r.setProps({fill:this._freezeNormalHeaderColor}));const v=Xg/Math.max(u.scaleX,u.scaleY);i===0?(this._changeToRow===0||this._changeToRow===-1)&&(n.transformByState({top:p-v}),r.transformByState({top:p-v})):(this._changeToColumn===0||this._changeToColumn===-1)&&(n.transformByState({left:h-v}),r.transformByState({left:h-v}));const g=this._scrollManagerService.getCurrentScroll()||{sheetViewStartRow:0,sheetViewStartColumn:0},{sheetViewStartRow:b,sheetViewStartColumn:C}=g;if(C==null||b==null)return;const S=this._currentUniverService.getCurrentUniverSheetInstance(),E=S.getActiveSheet(),y=(m=E.getConfig())==null?void 0:m.freeze;let D=(y==null?void 0:y.xSplit)||0,R=(y==null?void 0:y.ySplit)||0;const I=(f=this._activeViewport)==null?void 0:f.viewPortKey;i===0&&(!I||I===Ft.VIEW_LEFT_TOP||I===Ft.VIEW_MAIN_LEFT_TOP||I===Ft.VIEW_MAIN_TOP||I===Ft.VIEW_ROW_TOP?R=this._changeToRow-(y.startRow-y.ySplit):R=this._changeToRow-b,R=R<0?0:R),i===1&&(!I||I===Ft.VIEW_LEFT_TOP||I===Ft.VIEW_MAIN_LEFT_TOP||I===Ft.VIEW_MAIN_LEFT||I===Ft.VIEW_COLUMN_LEFT?D=this._changeToColumn-(y.startColumn-y.xSplit):D=this._changeToColumn-C,D=D<0?0:D),this._commandService.executeCommand(UU.id,{startRow:R===0?-1:this._changeToRow,startColumn:D===0?-1:this._changeToColumn,ySplit:R,xSplit:D,unitId:S.getUnitId(),subUnitId:E.getSheetId()})})}_getViewports(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e,r=n.getViewport(Ft.VIEW_COLUMN_LEFT),i=n.getViewport(Ft.VIEW_COLUMN_RIGHT),o=n.getViewport(Ft.VIEW_ROW_TOP),a=n.getViewport(Ft.VIEW_ROW_BOTTOM),s=n.getViewport(Ft.VIEW_LEFT_TOP),u=n.getViewport(Ft.VIEW_MAIN),l=n.getViewport(Ft.VIEW_MAIN_LEFT_TOP),c=n.getViewport(Ft.VIEW_MAIN_LEFT),d=n.getViewport(Ft.VIEW_MAIN_TOP);if(!(r==null||i==null||o==null||a==null||s==null||u==null||l==null||c==null||d==null))return{viewMain:u,viewMainLeftTop:l,viewMainLeft:c,viewMainTop:d,viewColumnLeft:r,viewColumnRight:i,viewRowTop:o,viewRowBottom:a,viewLeftTop:s}}_bindViewportScroll(){const e=this._getViewports();if(!e)return;const{viewMain:n,viewRowBottom:r,viewColumnRight:i,viewMainLeft:o,viewMainTop:a}=e;this.disposeWithMe(n.onScrollAfterObserver.add(s=>{const{scrollX:u,scrollY:l,actualScrollX:c,actualScrollY:d}=s;r.isActive&&r.updateScroll({scrollY:l,actualScrollY:d}).makeDirty(!0),i.isActive&&i.updateScroll({scrollX:u,actualScrollX:c}).makeDirty(!0),o.isActive&&o.updateScroll({scrollY:l,actualScrollY:d}).makeDirty(!0),a.isActive&&a.updateScroll({scrollX:u,actualScrollX:c}).makeDirty(!0)}))}_updateViewport(e=-1,n=-1,r=0,i=0,o=3){var a;const s=(a=this._sheetSkeletonManagerService.getCurrent())==null?void 0:a.skeleton;if(s==null)return;const{rowHeaderWidthAndMarginLeft:u,columnHeaderHeightAndMarginTop:l}=s,c=this._getViewports();if(!c)return;const{viewMain:d,viewMainLeftTop:m,viewMainLeft:f,viewMainTop:h,viewColumnLeft:p,viewColumnRight:v,viewRowTop:g,viewRowBottom:b,viewLeftTop:C}=c;v.resize({left:u,top:0,height:l,right:0}),b.resize({left:0,top:l,bottom:0,width:u}),C.resize({left:0,top:0,width:u,height:l});let S=!0,E=!0;m.enable(),(e===-1||e===0)&&(S=!1),(n===-1||n===0)&&(E=!1);const y=s.getNoMergeCellPositionByIndexWithNoHeader(e-r,n-i),D=s.getNoMergeCellPositionByIndexWithNoHeader(e,n);if(m.disable(),h.disable(),f.disable(),g.disable(),p.disable(),m.resetPadding(),h.resetPadding(),f.resetPadding(),g.resetPadding(),p.resetPadding(),S===!1&&E===!1)d.resize({left:u,top:l,bottom:0,right:0}),d.resetPadding();else if(S===!0&&E===!1){const R=D.startY-y.startY;d.resize({left:u,top:l+R,bottom:0,right:0}),d.setPadding({startY:y.startY,endY:D.startY,startX:0,endX:0}),o&2&&this._commandService.executeCommand(_0.id,{sheetViewStartRow:0,offsetY:0}),h.resize({left:u,top:l,height:R,right:0}),h.updateScroll({actualScrollY:y.startY,x:d.scrollX,actualScrollX:d.actualScrollX}).makeDirty(!0),g.resize({left:0,top:l,width:u,height:R}),g.updateScroll({actualScrollY:y.startY}).makeDirty(!0),b.resize({left:0,top:l+R,bottom:0,width:u}),h.enable(),g.enable()}else if(S===!1&&E===!0){const R=D.startX-y.startX;d.resize({left:u+R,top:l,bottom:0,right:0}),d.setPadding({startX:y.startX,endX:D.startX,startY:0,endY:0}),o&1&&this._commandService.executeCommand(_0.id,{sheetViewStartColumn:0,offsetX:0}),f.resize({left:u,top:l,width:R,bottom:0,right:0}),f.updateScroll({actualScrollX:y.startX,y:d.scrollY,actualScrollY:d.actualScrollY}).makeDirty(!0),p.resize({left:u,top:0,width:R,height:l}),p.updateScroll({actualScrollX:y.startX}).makeDirty(!0),v.resize({left:u+R,top:0,height:l,right:0}),f.enable(),p.enable()}else{const R=D.startX-y.startX,I=D.startY-y.startY;d.resize({left:u+R,top:l+I,bottom:0,right:0}),d.setPadding({startY:y.startY,endY:D.startY,startX:y.startX,endX:D.startX}),o&&this._commandService.executeCommand(_0.id,{...o&1?{sheetViewStartColumn:0,offsetX:0}:null,...o&2?{sheetViewStartRow:0,offsetY:0}:null}),f.resize({left:u,top:l+I,width:R,bottom:0}),f.updateScroll({actualScrollX:y.startX,y:d.scrollY,actualScrollY:d.actualScrollY}).makeDirty(!0),h.resize({left:u+R,top:l,height:I,right:0}),h.updateScroll({actualScrollY:y.startY,x:d.scrollX,actualScrollX:d.actualScrollX}).makeDirty(!0),m.resize({left:u,top:l,width:R,height:I}),m.updateScroll({actualScrollX:y.startX,actualScrollY:y.startY}).makeDirty(!0),g.resize({left:0,top:l,width:u,height:I}),g.updateScroll({actualScrollY:y.startY}).makeDirty(!0),b.resize({left:0,top:l+I,bottom:0,width:u}),p.resize({left:u,top:0,width:R,height:l}),p.updateScroll({actualScrollX:y.startX}).makeDirty(!0),v.resize({left:u+R,top:0,height:l,right:0}),m.enable(),h.enable(),f.enable(),g.enable(),p.enable()}}_skeletonListener(){this.disposeWithMe(je(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{[Us.id,ml.id,fl.id].includes((e==null?void 0:e.commandId)||"")&&this._refreshCurrent()})))}_refreshCurrent(){const e=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getConfig().freeze,{startRow:n=-1,startColumn:r=-1,ySplit:i=0,xSplit:o=0}=e;this._refreshFreeze(n,r,i,o,0)}_themeChangeListener(){this._themeChange(this._themeService.getCurrentTheme()),this.disposeWithMe(je(this._themeService.currentTheme$.subscribe(e=>{this._clearFreeze(),this._themeChange(e),this._refreshCurrent()})))}_themeChange(e){this._freezeNormalHeaderColor=e.grey400,this._freezeNormalMainColor=new Xo(e.grey400).setAlpha(U$e).toRgbString(),this._freezeActiveColor=e.primaryColor,this._freezeHoverColor=e.grey500}_interceptorCommands(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:e=>{const n={redos:[],undos:[]},r=this._getFreeze();if(!r)return n;const i=o=>{const a=this._currentUniverService.getCurrentUniverSheetInstance(),s=a.getUnitId(),u=a.getActiveSheet().getSheetId();this._refreshFreeze(o.startRow,o.startColumn,o.ySplit,o.xSplit,0);const l={...o,unitId:s,subUnitId:u,resetScroll:!1},c=Of(this._injector,l);return{undos:[{id:io.id,params:c}],redos:[{id:io.id,params:l}]}};if(e.id===hd.id){const o=this._selectionManagerService.getSelections(),{fromRange:{startColumn:a},toRange:{startColumn:s}}=e.params,u=o==null?void 0:o.filter(v=>v.range.rangeType===ct.COLUMN&&v.range.startColumn<=a&&a<=v.range.endColumn);if(!(u!=null&&u.length))return n;const l=u[0].range,c={...l,startColumn:s,endColumn:s+l.endColumn-l.startColumn};if(!r||r.startColumn<=0||l.startColumn>=r.startColumn&&c.startColumn>=r.startColumn||l.startColumn===c.startColumn||l.endColumn<r.startColumn&&c.startColumn<r.startColumn)return n;const d=l.endColumn-l.startColumn+1,m=Math.max(Math.min(r.startColumn,l.endColumn+1)-l.startColumn,0);let f,h;c.startColumn>=r.startColumn?(f=Math.max(r.startColumn-m,1),h=Math.max(r.xSplit-m,1)):(f=r.startColumn+d-m,h=r.xSplit+d-m);const p={...r,startColumn:f,xSplit:h};return i(p)}if(e.id===fd.id){const o=this._selectionManagerService.getSelections(),{fromRange:{startRow:a},toRange:{startRow:s}}=e.params,u=o==null?void 0:o.filter(v=>v.range.rangeType===ct.ROW&&v.range.startRow<=a&&a<=v.range.endRow);if(!(u!=null&&u.length))return n;const l=u[0].range,c={...l,startRow:s,endRow:s+l.endRow-l.startRow};if(!r||r.startRow<=0||l.startRow>=r.startRow&&c.startRow>=r.startRow||l.startRow===c.startRow||l.endRow<r.startRow&&c.startRow<r.startRow)return n;const d=l.endRow-l.startRow+1,m=Math.max(Math.min(r.startRow,l.endRow+1)-l.startRow,0);let f,h;c.startRow>=r.startRow?(f=Math.max(r.startRow-m,1),h=Math.max(r.ySplit-m,1)):(f=r.startRow+d-m,h=r.ySplit+d-m);const p={...r,startRow:f,ySplit:h};return i(p)}if(e.id===n2.id||e.id===t2.id){const o=e.params,a=o.range;if(a.rangeType===ct.COLUMN&&a.startColumn<r.startColumn){const s=Math.min(r.startColumn,a.endColumn+1)-a.startColumn,u={...r,startColumn:Math.max(1,r.startColumn-s),xSplit:Math.max(1,r.xSplit-s)};return i(u)}if(o.range.rangeType===ct.ROW&&a.startRow<r.startRow){const s=Math.min(r.startRow,a.endRow+1)-a.startRow,u={...r,startRow:Math.max(1,r.startRow-s),ySplit:Math.max(1,r.ySplit-s)};return i(u)}}return n}}))}_commandExecutedListener(){const e=[io.id,Ml.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._lastFreeze,i=this._currentUniverService.getCurrentUniverSheetInstance(),o=i.getActiveSheet(),a=n.params,{unitId:s,subUnitId:u}=a;if(!(s===i.getUnitId()&&u===o.getSheetId()))return;const l=o.getConfig().freeze;if(this._lastFreeze=l,l==null)return;let c=0;const{startRow:d=-1,startColumn:m=-1,ySplit:f=0,xSplit:h=0}=l;(!r||r.startRow!==d||r.ySplit!==f)&&(c|=2),(!r||r.startColumn!==m||r.xSplit!==h)&&(c|=1),a.resetScroll===!1&&(c=0),this._refreshFreeze(d,m,f,h,c)}else if(n.id===m1.id){const r=this._getFreeze();n.params&&r&&n.params.ranges.some(i=>i.startRow<r.startRow)&&this._refreshCurrent()}else if(n.id===Wa.id){const r=this._getFreeze();n.params&&r&&n.params.ranges.some(i=>i.startColumn<r.startColumn)&&this._refreshCurrent()}else if(n.id===Um.id){const r=n.params,i=this._getFreeze();if(i&&i.startRow>-1&&r.rowsAutoHeightInfo.some(o=>o.row<i.startRow)){const o=this._sheetSkeletonManagerService.currentSkeleton$.subscribe(()=>{this._refreshCurrent(),setTimeout(()=>{o.unsubscribe()})})}}else if(n.id===gl.id||n.id===vl.id){const r=n.params,i=this._getFreeze(),o=r.ranges;i&&i.startColumn>-1&&o.some(a=>a.startColumn<i.startColumn)&&this._refreshCurrent()}else if(n.id===_l.id||n.id===bl.id){const r=n.params,i=this._getFreeze(),o=r.ranges;i&&i.startRow>-1&&o.some(a=>a.startRow<i.startRow)&&this._refreshCurrent()}}))}_zoomRefresh(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;n.onTransformChangeObservable.add(r=>{r.type===eo.scale&&this._refreshCurrent()})}_clearObserverEvent(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;n.onPointerMoveObserver.remove(this._moveObserver),n.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_clearFreeze(){var e,n,r,i;(e=this._rowFreezeHeaderRect)==null||e.dispose(),(n=this._rowFreezeMainRect)==null||n.dispose(),(r=this._columnFreezeHeaderRect)==null||r.dispose(),(i=this._columnFreezeMainRect)==null||i.dispose();const o=this._getSheetObject();if(o==null)return;const{scene:a}=o;[...this._freezeDownObservers,...this._freezeMoveObservers,...this._freezeLeaveObservers].forEach(s=>{a.onPointerDownObserver.remove(s),a.onPointerMoveObserver.remove(s),a.onPointerLeaveObserver.remove(s)}),a.onPointerEnterObserver.remove(this._moveObserver),a.onPointerMoveObserver.remove(this._upObserver)}_getPositionByIndex(e,n){var r;if(this._getSheetObject()==null)return;const i=(r=this._sheetSkeletonManagerService.getCurrent())==null?void 0:r.skeleton,o=i==null?void 0:i.getNoMergeCellPositionByIndex(e,n);if(i==null)return;if(o!=null&&(!isNaN(o.endX)||!isNaN(o.endY)))return o;const{rowHeaderWidthAndMarginLeft:a,columnHeaderHeightAndMarginTop:s}=i;return{startX:a,endX:a,startY:s,endY:s}}_getFreeze(){var e;const n=(e=this._sheetSkeletonManagerService.getCurrent())==null?void 0:e.skeleton.getWorksheetConfig();if(n!=null)return n.freeze}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}_refreshFreeze(e,n,r,i,o){var a;const s={startRow:e,startColumn:n,ySplit:r,xSplit:i};this._clearFreeze(),this._createFreeze(0,s),this._createFreeze(1,s),this._updateViewport(e,n,r,i,o),(a=this._getSheetObject())==null||a.spreadsheet.makeForceDirty()}};x7=x$e([yt(ot.Rendered,x7),Xs(0,K(Dr)),Xs(1,ae),Xs(2,se),Xs(3,Jn),Xs(4,Hi),Xs(5,K(dt)),Xs(6,K(Pl)),Xs(7,K(_i)),Xs(8,K(In)),Xs(9,K(wn))],x7);var oC=(t=>(t[t.NORMAL=0]="NORMAL",t[t.HIGHLIGHT=1]="HIGHLIGHT",t))(oC||{});const V$e="rgba(0, 0, 0, 0.15)",N1="rgb(0, 0, 0)",J3="rgb(255, 255, 255, 1)";class H$e extends ff{constructor(e,n){super(e,n),H(this,"_size",12),H(this,"_iconRatio",.4),H(this,"_mode",0),this.setShapeProps(n)}setShapeProps(e){e!=null&&e.size&&(this._size=e.size),e!=null&&e.mode&&(this._mode=e.mode),this.transformByState({width:this._size,height:this._size})}_draw(e){this._mode===1&&cn.drawWith(e,{width:this._size,height:this._size,radius:this._size,fill:V$e});const n=this._size*.5*this._iconRatio,r=Math.PI/180*60,i=n*Math.sin(r),o=n*Math.cos(r);r0.drawWith(e,{pointsGroup:[[{x:-i+this._size/2,y:-o+this._size/2},{x:i+this._size/2,y:-o+this._size/2},{x:this._size/2,y:n+this._size/2}]],fill:N1})}}var j$e=Object.defineProperty,z$e=Object.getOwnPropertyDescriptor,W$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?z$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&j$e(e,n,i),i},R2=(t,e)=>(n,r)=>e(n,r,t);const Y$e="__SpreadsheetHeaderMenuSHAPEControllerShape__",X$e="__SpreadsheetHeaderMenuMAINControllerShape__",q$e="rgba(0, 0, 0, 0.1)";let F7=class extends We{constructor(e,n,r,i,o,a){super(),H(this,"_hoverRect"),H(this,"_hoverMenu"),H(this,"_currentColumn",Number.POSITIVE_INFINITY),H(this,"_observers",[]),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._contextMenuService=i,this._commandService=o,this._selectionManagerService=a,this._initialize()}dispose(){var e,n;(e=this._hoverRect)==null||e.dispose(),(n=this._hoverMenu)==null||n.dispose();const r=this._getSheetObject();if(r==null)return;const{spreadsheetRowHeader:i,spreadsheetColumnHeader:o}=r;this._observers.forEach(a=>{i.onPointerEnterObserver.remove(a),i.onPointerMoveObserver.remove(a),i.onPointerLeaveObserver.remove(a),o.onPointerEnterObserver.remove(a),o.onPointerMoveObserver.remove(a),o.onPointerLeaveObserver.remove(a)})}_initialize(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;this._hoverRect=new cn(Y$e,{fill:q$e,evented:!1}),this._hoverMenu=new H$e(X$e,{zIndex:100,visible:!1}),n.addObjects([this._hoverRect,this._hoverMenu],El),this._initialHover(0),this._initialHover(1),this._initialHoverMenu()}_initialHover(e=0){const n=this._getSheetObject();if(n==null)return;const{spreadsheetColumnHeader:r,spreadsheetRowHeader:i}=n,o=e===0?i:r;this._observers.push(o==null?void 0:o.onPointerEnterObserver.add(()=>{var a;(a=this._hoverRect)==null||a.show()})),this._observers.push(o==null?void 0:o.onPointerMoveObserver.add(a=>{var s,u,l;const c=(s=this._sheetSkeletonManagerService.getCurrent())==null?void 0:s.skeleton;if(c==null)return;const d=this._getSheetObject();if(d==null)return;const{rowHeaderWidth:m,columnHeaderHeight:f}=c,{startX:h,startY:p,endX:v,endY:g,column:b}=jm(a.offsetX,a.offsetY,d.scene,c);if(e===0)(u=this._hoverRect)==null||u.transformByState({width:m,height:g-p,left:0,top:p});else{if(this._currentColumn=b,(l=this._hoverRect)==null||l.transformByState({width:v-h,height:f,left:h,top:0}),this._hoverMenu==null)return;if(v-h<f*2){this._hoverMenu.hide();return}const C=f*.8;this._hoverMenu.transformByState({left:v-f,top:f/2-C/2}),this._hoverMenu.setShapeProps({size:C}),this._hoverMenu.show()}})),this._observers.push(o==null?void 0:o.onPointerLeaveObserver.add(()=>{var a,s;(a=this._hoverRect)==null||a.hide(),(s=this._hoverMenu)==null||s.hide()}))}_initialHoverMenu(){this._hoverMenu!=null&&(this._hoverMenu.onPointerEnterObserver.add(()=>{if(this._hoverMenu==null)return;const e=this._getSheetObject();e!=null&&(this._hoverMenu.setProps({mode:oC.HIGHLIGHT,visible:!0}),e.scene.setCursor(Jt.POINTER))}),this._hoverMenu.onPointerLeaveObserver.add(()=>{if(this._hoverMenu==null)return;const e=this._getSheetObject();e!=null&&(this._hoverMenu.setProps({mode:oC.NORMAL,visible:!1}),e.scene.resetCursor())}),this._hoverMenu.onPointerDownObserver.add(e=>{if(!this._getSheetObject())return;const n=this._currentColumn,r=this._selectionManagerService.getSelectionRanges();if(!(r!=null&&r.filter(i=>i.rangeType===ct.COLUMN).find(i=>{const{startColumn:o,endColumn:a}=i;return n>=o&&n<=a}))){const i=this._getSelectionOnColumn(n);this._commandService.syncExecuteCommand(_n.id,i)}e.stopPropagation(),e.preventDefault(),this._contextMenuService.triggerContextMenu(e,bi.COL_HEADER_CONTEXT_MENU)}))}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}_getSelectionOnColumn(e){const n=this._currentUniverService.getCurrentUniverSheetInstance(),r=n.getActiveSheet();return{unitId:n.getUnitId(),subUnitId:r.getSheetId(),pluginName:Nn,selections:[{range:{startRow:0,startColumn:e,endRow:r.getRowCount()-1,endColumn:e,rangeType:ct.COLUMN},primary:{startRow:0,startColumn:e,endRow:0,endColumn:e,actualRow:0,actualColumn:e,isMerged:!1,isMergedMainCell:!1},style:null}]}}};F7=W$e([yt(ot.Rendered,F7),R2(0,K(Dr)),R2(1,ae),R2(2,Jn),R2(3,yf),R2(4,se),R2(5,K(dt))],F7);var G$e=Object.defineProperty,K$e=Object.getOwnPropertyDescriptor,Z$e=(t,e,n,r)=>{for(var i=r>1?void 0:r?K$e(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&G$e(e,n,i),i},I2=(t,e)=>(n,r)=>e(n,r,t);const Q$e="__SpreadsheetHeaderMoveControllerBackground__",J$e="__SpreadsheetHeaderMoveControllerShapeLine__",eke="rgba(0, 0, 0, 0.1)",tke="rgb(119, 119, 119)",nke=4;let $7=class extends We{constructor(e,n,r,i,o,a){super(),H(this,"_startOffsetX",Number.NEGATIVE_INFINITY),H(this,"_startOffsetY",Number.NEGATIVE_INFINITY),H(this,"_moveHelperBackgroundShape"),H(this,"_moveHelperLineShape"),H(this,"_sheetObject"),H(this,"_rowOrColumnDownObservers",[]),H(this,"_rowOrColumnMoveObservers",[]),H(this,"_rowOrColumnLeaveObservers",[]),H(this,"_moveObserver"),H(this,"_upObserver"),H(this,"_scrollTimer"),H(this,"_changeFromColumn",-1),H(this,"_changeFromRow",-1),H(this,"_changeToColumn",-1),H(this,"_changeToRow",-1),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._commandService=i,this._selectionRenderService=o,this._selectionManagerService=a,this._initialize()}dispose(){var e,n;(e=this._moveHelperBackgroundShape)==null||e.dispose(),(n=this._moveHelperLineShape)==null||n.dispose();const r=this._getSheetObject();if(r==null)return;const{spreadsheetRowHeader:i,spreadsheetColumnHeader:o,scene:a}=r;[...this._rowOrColumnDownObservers,...this._rowOrColumnMoveObservers,...this._rowOrColumnLeaveObservers].forEach(s=>{i.onPointerDownObserver.remove(s),o.onPointerDownObserver.remove(s)}),a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),this._scrollTimer.dispose()}_initialize(){const e=this._getSheetObject();e!=null&&(this._sheetObject=e,this._initialRowOrColumn(0),this._initialRowOrColumn(1))}_initialRowOrColumn(e=0){const{spreadsheetColumnHeader:n,spreadsheetRowHeader:r,scene:i}=this._sheetObject,o=e===0?r:n;this._rowOrColumnMoveObservers.push(o==null?void 0:o.onPointerMoveObserver.add(a=>{var s;const u=(s=this._sheetSkeletonManagerService.getCurrent())==null?void 0:s.skeleton;if(u==null)return;const{row:l,column:c}=jm(a.offsetX,a.offsetY,i,u);if(this._checkInHeaderRange(e===0?l:c,e)===!1){i.resetCursor(),this._selectionRenderService.enableSelection();return}i.setCursor(Jt.GRAB),this._selectionRenderService.disableSelection()})),this._rowOrColumnLeaveObservers.push(o==null?void 0:o.onPointerLeaveObserver.add(()=>{var a,s;(a=this._moveHelperBackgroundShape)==null||a.hide(),(s=this._moveHelperLineShape)==null||s.hide(),i.resetCursor(),this._selectionRenderService.enableSelection()})),this._rowOrColumnDownObservers.push(o==null?void 0:o.onPointerDownObserver.add(a=>{var s;const u=(s=this._sheetSkeletonManagerService.getCurrent())==null?void 0:s.skeleton;if(u==null)return;const{offsetX:l,offsetY:c}=a,d=i.getRelativeCoord(zt.FromArray([l,c])),{x:m,y:f}=d;this._startOffsetX=m,this._startOffsetY=f;const{row:h,column:p}=jm(a.offsetX,a.offsetY,i,u);let v;e===0?(this._changeFromRow=h,v=$o.Y):(this._changeFromColumn=p,v=$o.X);const g=this._checkInHeaderRange(e===0?h:p,e);if(g===!1)return;const b=i.getScrollXYByRelativeCoords(zt.FromArray([this._startOffsetX,this._startOffsetY]));this._newBackgroundAndLine(),i.setCursor(Jt.GRABBING),i.disableEvent();let C=!1,S;const E=()=>{if(C)return;S=c1.create(i,v);const y=i.getViewport(Ft.VIEW_MAIN);S.startScroll(m,f,y),this._scrollTimer=S,C=!0};this._moveObserver=i.onPointerMoveObserver.add(y=>{E();const{offsetX:D,offsetY:R}=y,{x:I,y:T}=i.getRelativeCoord(zt.FromArray([D,R]));i.setCursor(Jt.GRABBING),this._rowColumnMoving(I,T,g,b,e),S.scrolling(I,T,()=>{this._rowColumnMoving(I,T,g,b,e)})}),this._upObserver=i.onPointerUpObserver.add(()=>{var y,D,R;this._disposeBackgroundAndLine(),i.resetCursor(),i.enableEvent(),this._clearObserverEvent(),(y=this._scrollTimer)==null||y.dispose();const I=this._selectionManagerService.getSelections();if(e===0){if(this._changeFromRow!==this._changeToRow&&this._changeToRow!==-1){const T=(D=((I==null?void 0:I.filter(P=>P.range.rangeType===ct.ROW&&P.range.startRow<=this._changeFromRow&&this._changeFromRow<=P.range.endRow))||[])[0])==null?void 0:D.range;T&&this._commandService.executeCommand(fd.id,{fromRange:T,toRange:{...T,startRow:this._changeToRow,endRow:this._changeToRow+T.endRow-T.startRow}})}this._changeToRow=this._changeFromRow=-1}else{if(this._changeFromColumn!==this._changeToColumn&&this._changeToColumn!==-1){const T=(R=((I==null?void 0:I.filter(P=>P.range.rangeType===ct.COLUMN&&P.range.startColumn<=this._changeFromColumn&&this._changeFromColumn<=P.range.endColumn))||[])[0])==null?void 0:R.range;T&&this._commandService.executeCommand(hd.id,{fromRange:T,toRange:{...T,startColumn:this._changeToColumn,endColumn:this._changeToColumn+T.endColumn-T.startColumn}})}this._changeToColumn=this._changeFromColumn=-1}})}))}_rowColumnMoving(e,n,r,i,o){var a,s,u,l,c,d,m;const{scene:f}=this._sheetObject,h=(a=this._sheetSkeletonManagerService.getCurrent())==null?void 0:a.skeleton;if(h==null)return;const{rowHeaderWidth:p,columnHeaderHeight:v,rowTotalHeight:g,columnTotalWidth:b}=h,C=f.getScrollXY(f.getViewport(Ft.VIEW_MAIN)),{scaleX:S,scaleY:E}=f.getAncestorScale(),y=h.getCellPositionByOffset(e,n,S,E,C),{row:D,column:R}=y,I=h.getNoMergeCellPositionByIndex(D,R),{startX:T,startY:P,endX:N,endY:B}=I,W=this._selectionRenderService.convertRangeDataToSelection(r.range);if(W==null)return;const G=Math.max(S,S),{startX:Q,endX:te,startY:X,endY:x,startRow:O,startColumn:M,endRow:V,endColumn:q}=W;o===0?(s=this._moveHelperBackgroundShape)==null||s.transformByState({height:x-X,width:b+p,left:0,top:X+(n-this._startOffsetY)/G+C.y-i.y}):(u=this._moveHelperBackgroundShape)==null||u.transformByState({height:g+v,width:te-Q,left:Q+(e-this._startOffsetX)/G+C.x-i.x,top:0}),(l=this._moveHelperBackgroundShape)==null||l.show();const ie=nke/G;if(o===0){let ce=0;if(D<=O)ce=P-ie/2,this._changeToRow=D;else if(D>V)ce=B-ie/2,this._changeToRow=D+1;else return;(c=this._moveHelperLineShape)==null||c.transformByState({height:ie,width:b,left:p,top:ce})}else{let ce=0;if(R<=M)ce=T-ie/2,this._changeToColumn=R;else if(R>q)ce=N-ie/2,this._changeToColumn=R+1;else return;(d=this._moveHelperLineShape)==null||d.transformByState({height:g,width:ie,left:ce,top:v})}(m=this._moveHelperLineShape)==null||m.show()}_checkInHeaderRange(e,n=0){var r;const i=this._selectionManagerService.getSelections();if(((r=this._selectionManagerService.getCurrent())==null?void 0:r.pluginName)!==Nn)return!1;const o=i==null?void 0:i.find(s=>{const u=s.range,{startRow:l,endRow:c,startColumn:d,endColumn:m,rangeType:f}=u;return n===1?e>=d&&e<=m&&ct.COLUMN===f:e>=l&&e<=c&&ct.ROW===f}),a=o==null?void 0:o.range;return o==null||a==null||a.rangeType===ct.ALL||a.rangeType===ct.NORMAL||a.rangeType===ct.ROW&&n!==0||a.rangeType===ct.COLUMN&&n!==1?!1:o}_clearObserverEvent(){const{scene:e}=this._sheetObject;e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_newBackgroundAndLine(){const{scene:e}=this._sheetObject;this._moveHelperBackgroundShape=new cn(Q$e,{fill:eke,evented:!1,zIndex:100}),this._moveHelperLineShape=new cn(J$e,{fill:tke,evented:!1,zIndex:100}),e.addObjects([this._moveHelperBackgroundShape,this._moveHelperLineShape],El)}_disposeBackgroundAndLine(){var e,n;(e=this._moveHelperBackgroundShape)==null||e.dispose(),(n=this._moveHelperLineShape)==null||n.dispose()}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}};$7=Z$e([yt(ot.Rendered,$7),I2(0,K(Dr)),I2(1,ae),I2(2,Jn),I2(3,se),I2(4,Hi),I2(5,K(dt))],$7);var aC=(t=>(t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t))(aC||{});const rke="rgba(120, 120, 120, 0.01)",qg="rgb(68, 71, 70)",y6=12,sC=4;class aw extends ff{constructor(e,n){super(e,n),H(this,"_size",y6),H(this,"_color",qg),H(this,"_mode",0),this.setShapeProps(n)}get size(){return this._size}get mode(){return this._mode}get color(){return this._color}_draw(e){let{width:n,height:r}=this,i=0,o=0;const a=this.getScene(),{scaleX:s,scaleY:u}=a.getAncestorScale(),l=Math.max(s,u),c=y6/l,d=sC/l;this.mode===0?(n=d,i=c-d):(r=d,o=c-d),cn.drawWith(e,{width:this.width,height:this.height,left:0,top:0,fill:rke}),cn.drawWith(e,{width:n,height:r,fill:qg,radius:d}),e.save(),e.transform(1,0,0,1,i,o),cn.drawWith(e,{width:n,height:r,fill:qg,radius:d}),e.restore()}setShapeProps(e){return e!=null&&e.size&&(this._size=e.size),e!=null&&e.mode&&(this._mode=e.mode),e!=null&&e.color&&(this._color=e.color),this.mode===0?this.transformByState({width:y6,height:this.size}):this.transformByState({width:this.size,height:y6}),this}}var ike=Object.defineProperty,oke=Object.getOwnPropertyDescriptor,ake=(t,e,n,r)=>{for(var i=r>1?void 0:r?oke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&ike(e,n,i),i},n6=(t,e)=>(n,r)=>e(n,r,t);const ske="__SpreadsheetHeaderResizeControllerShapeRow__",uke="__SpreadsheetHeaderResizeControllerShapeColumn__",sw="__SpreadsheetHeaderResizeControllerShapeHelper__",uw="rgb(199, 199, 199)",lke=2;let k7=class extends We{constructor(e,n,r,i,o){super(),H(this,"_currentRow",0),H(this,"_currentColumn",0),H(this,"_rowResizeRect"),H(this,"_columnResizeRect"),H(this,"_observers",[]),H(this,"_moveObserver"),H(this,"_upObserver"),H(this,"_resizeHelperShape"),H(this,"_startOffsetX",Number.POSITIVE_INFINITY),H(this,"_startOffsetY",Number.POSITIVE_INFINITY),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._editorBridgeService=o,this._initialize()}dispose(){var e,n;(e=this._rowResizeRect)==null||e.dispose(),this._rowResizeRect=null,(n=this._columnResizeRect)==null||n.dispose(),this._columnResizeRect=null;const r=this._getSheetObject();if(r==null)return;const{spreadsheetRowHeader:i,spreadsheetColumnHeader:o}=r;this._observers.forEach(a=>{i.onPointerMoveObserver.remove(a),i.onPointerLeaveObserver.remove(a),o.onPointerMoveObserver.remove(a),o.onPointerLeaveObserver.remove(a)}),this._observers=[]}_initialize(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;this._rowResizeRect=new aw(ske,{visible:!1,mode:aC.HORIZONTAL,zIndex:100}),this._columnResizeRect=new aw(uke,{visible:!1,mode:aC.VERTICAL,zIndex:100}),n.addObjects([this._rowResizeRect,this._columnResizeRect],El),this._initialHover(0),this._initialHover(1),this._initialHoverResize(0),this._initialHoverResize(1)}_initialHover(e=0){const n=this._getSheetObject();if(n==null)return;const{spreadsheetRowHeader:r,spreadsheetColumnHeader:i,scene:o}=n,a=e===0?r:i;this._observers.push(a==null?void 0:a.onPointerMoveObserver.add((s,u)=>{var l;const c=(l=this._sheetSkeletonManagerService.getCurrent())==null?void 0:l.skeleton;if(c==null||this._rowResizeRect==null||this._columnResizeRect==null)return;const{rowHeaderWidth:d,columnHeaderHeight:m}=c,{startX:f,startY:h,endX:p,endY:v,row:g,column:b}=jm(s.offsetX,s.offsetY,o,c),C=Wg(s.offsetX,s.offsetY,o),{scaleX:S,scaleY:E}=o.getAncestorScale(),y=Math.max(S,E),D=y6/y;if(e===0){let R=h-D/2;if(C.y<=h+D/2&&C.y>=h)this._currentRow=g-1;else if(C.y>=v-D/2&&C.y<=v)this._currentRow=g,R=v-D/2;else{this._rowResizeRect.hide();return}if(this._currentRow===-1)return;const I=d/3;this._rowResizeRect.transformByState({left:d/2-I/2,top:R}),this._rowResizeRect.setShapeProps({size:I}),this._rowResizeRect.show()}else{let R=f-D/2;if(C.x<=f+D/2&&C.x>=f)this._currentColumn=b-1;else if(C.x>=p-D/2&&C.x<=p)this._currentColumn=b,R=p-D/2;else{this._columnResizeRect.hide();return}if(this._currentColumn===-1)return;const I=m*.7;this._columnResizeRect.transformByState({left:R,top:m/2-I/2}),this._columnResizeRect.setShapeProps({size:I}),this._columnResizeRect.show()}})),this._observers.push(a==null?void 0:a.onPointerLeaveObserver.add((s,u)=>{var l,c;(l=this._rowResizeRect)==null||l.hide(),(c=this._columnResizeRect)==null||c.hide()}))}_initialHoverResize(e=0){const n=this._getSheetObject();if(n==null)return;const{scene:r}=n,i=e===0?this._rowResizeRect:this._columnResizeRect;if(i==null)return;const o=r.getEngine(),a=(o==null?void 0:o.width)||0,s=(o==null?void 0:o.height)||0;this.disposeWithMe(je(i.onPointerEnterObserver.add(()=>{i!=null&&(i.show(),r.setCursor(e===0?Jt.ROW_RESIZE:Jt.COLUMN_RESIZE))}))),this.disposeWithMe(je(i.onPointerLeaveObserver.add(()=>{i!=null&&(i.hide(),r.resetCursor())}))),this.disposeWithMe(je(i.onPointerDownObserver.add((u,l)=>{var c,d,m,f,h,p,v;const g=(c=this._sheetSkeletonManagerService.getCurrent())==null?void 0:c.skeleton;if(g==null)return;const b=this._getSheetObject();if(b==null)return;const{scene:C}=b,S=C.getViewport(Ft.VIEW_MAIN),E=(((m=(d=S==null?void 0:S.getScrollBar())==null?void 0:d.horizonBarRect)==null?void 0:m.height)||0)+10,y=(((h=(f=S==null?void 0:S.getScrollBar())==null?void 0:f.verticalBarRect)==null?void 0:h.width)||0)+10,D=Wg(u.offsetX,u.offsetY,C),{scaleX:R,scaleY:I}=C.getAncestorScale();this._startOffsetX=D.x,this._startOffsetY=D.y;const T=g.getOffsetByPositionX(this._currentColumn),P=g.getOffsetByPositionY(this._currentRow),N=g.getNoMergeCellPositionByIndex(this._currentRow,this._currentColumn);let B=!1,W=0,G=0;const{columnTotalWidth:Q,rowHeaderWidth:te,rowTotalHeight:X,columnHeaderHeight:x}=g,O=a>Q+te?a:Q+te,M=s>X+x?s:X+x,V=Math.max(R,I),q=sC/V;e===0?this._resizeHelperShape=new cn(sw,{width:O,height:q,fill:uw,left:0,top:P-q/2}):this._resizeHelperShape=new cn(sw,{width:q,height:M,fill:uw,left:T-q/2,top:0});const ie=((p=this._columnResizeRect)==null?void 0:p.left)||0,ce=((v=this._rowResizeRect)==null?void 0:v.top)||0;C.addObject(this._resizeHelperShape,El),C.disableEvent(),this._editorBridgeService.changeVisible({visible:!1,eventType:dr.PointerDown}),this._moveObserver=C.onPointerMoveObserver.add(pe=>{var oe,he,fe,ve,Ue,ke;const Te=C.getRelativeCoord(zt.FromArray([this._startOffsetX,this._startOffsetY])),Re=C.getScrollXYByRelativeCoords(Te,S),rt=Wg(pe.offsetX,pe.offsetY,C),{x:_t,y:mt}=rt,{scaleX:nt,scaleY:_e}=C.getAncestorScale(),He=Math.max(nt,_e),et=sC/He;W=_t-this._startOffsetX-et/2,G=mt-this._startOffsetY-et/2,Math.abs(e===0?G:W)>=lke&&(B=!0),e===0?(G>s-E+Re.y-N.startY&&(G=s-E+Re.y-N.startY),G<-(N.endY-N.startY)+2&&(G=-(N.endY-N.startY)+2),B&&((oe=this._resizeHelperShape)==null||oe.transformByState({top:P+G}),(he=this._rowResizeRect)==null||he.transformByState({top:ce+G+et/2}),(fe=this._rowResizeRect)==null||fe.show(),C.setCursor(Jt.ROW_RESIZE))):(W>a-y+Re.x-N.startX&&(W=a-y+Re.x-N.startX),W<-(N.endX-N.startX)+2&&(W=-(N.endX-N.startX)+2),B&&((ve=this._resizeHelperShape)==null||ve.transformByState({left:T+W}),(Ue=this._columnResizeRect)==null||Ue.transformByState({left:ie+W+et/2}),(ke=this._columnResizeRect)==null||ke.show(),C.setCursor(Jt.COLUMN_RESIZE)))}),this._upObserver=C.onPointerUpObserver.add(pe=>{var oe,he,fe;const ve=pa(this._currentUniverService,this._renderManagerService);if(ve==null)return;this._clearObserverEvent(),(oe=this._resizeHelperShape)==null||oe.dispose(),this._resizeHelperShape=null;const{scene:Ue}=ve;Ue.enableEvent(),B&&(Ue.resetCursor(),(he=this._rowResizeRect)==null||he.hide(),(fe=this._columnResizeRect)==null||fe.hide(),e===0?this._commandService.executeCommand(iV.id,{deltaY:G,anchorRow:this._currentRow}):this._commandService.executeCommand(ty.id,{deltaX:W,anchorCol:this._currentColumn}))})}))),this.disposeWithMe(je(i.onDblclickObserver.add(()=>{var u;if(e===0){const l=this._getSheetObject();if(l==null)return;const{scene:c}=l;c.resetCursor(),this._commandService.executeCommand(Pf.id,{anchorRow:this._currentRow}),(u=this._rowResizeRect)==null||u.hide()}})))}_clearObserverEvent(){const e=this._getSheetObject();if(e==null)return;const{scene:n}=e;n.onPointerMoveObserver.remove(this._moveObserver),n.onPointerUpObserver.remove(this._upObserver),this._moveObserver=null,this._upObserver=null}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}};k7=ake([yt(ot.Rendered,k7),n6(0,K(Dr)),n6(1,ae),n6(2,se),n6(3,Jn),n6(4,Oo)],k7);var uC=(t=>(t[t.ROW=0]="ROW",t[t.COLUMN=1]="COLUMN",t))(uC||{});const D6=12,cke=.4;class lw extends ff{constructor(e,n,r){super(e,n),H(this,"_size",D6),H(this,"_iconRatio",cke),H(this,"_hovered",!0),H(this,"_hasPrevious",!0),H(this,"_hasNext",!0),H(this,"_unhideType"),n&&this.setShapeProps(n),this.onPointerEnterObserver.add(()=>this.setShapeProps({hovered:!0})),this.onPointerLeaveObserver.add(()=>this.setShapeProps({hovered:!1})),this.onPointerDownObserver.add(()=>r==null?void 0:r())}setShapeProps(e){e.type!==void 0&&(this._unhideType=e.type),e.hovered!==void 0&&(this._hovered=e.hovered),e.hasPrevious!==void 0&&(this._hasPrevious=e.hasPrevious),e.hasNext!==void 0&&(this._hasNext=e.hasNext),this.transformByState({width:this._size*(this._unhideType===1?2:1),height:this._size*(this._unhideType===0?2:1)})}_draw(e){this._unhideType===0?this._drawOnRow(e):this._drawOnCol(e)}_drawOnRow(e){this._hovered&&(!this._hasNext||!this._hasPrevious?cn.drawWith(e,{width:this._size,height:this._size,stroke:N1,fill:J3}):cn.drawWith(e,{width:this._size,height:2*this._size,stroke:N1,fill:J3}));const n=this._size*.5*this._iconRatio,r=Math.PI/3,i=n*Math.cos(r),o=n*Math.sin(r);if(this._hasPrevious&&r0.drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size/2-o},{x:this._size/2-o,y:this._size/2+i},{x:this._size/2+o,y:this._size/2+i}]],fill:N1}),this._hasNext){const a=this._hasPrevious?3:1;r0.drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size*a/2+o},{x:this._size/2-o,y:this._size*a/2-i},{x:this._size/2+o,y:this._size*a/2-i}]],fill:N1})}}_drawOnCol(e){this._hovered&&(!this._hasNext||!this._hasPrevious?cn.drawWith(e,{width:this._size,height:this._size,stroke:N1,fill:J3}):cn.drawWith(e,{width:2*this._size,height:this._size,stroke:N1,fill:J3}));const n=this._size*.5*this._iconRatio,r=Math.PI/3,i=n*Math.cos(r),o=n*Math.sin(r);if(this._hasPrevious&&r0.drawWith(e,{pointsGroup:[[{x:-i+this._size/2,y:this._size/2},{x:this._size/2+o,y:this._size/2-o},{x:this._size/2+o,y:this._size/2+o}]],fill:N1}),this._hasNext){const a=this._hasPrevious?3:1;r0.drawWith(e,{pointsGroup:[[{x:i+this._size*a/2,y:this._size/2},{x:-o+this._size*a/2,y:this._size/2-o},{x:-o+this._size*a/2,y:this._size/2+o}]],fill:N1})}}}var dke=Object.defineProperty,mke=Object.getOwnPropertyDescriptor,fke=(t,e,n,r)=>{for(var i=r>1?void 0:r?mke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&dke(e,n,i),i},e4=(t,e)=>(n,r)=>e(n,r,t);const cw="__SpreadsheetHeaderUnhideSHAPEControllerShape__",hke=[_l.id,bl.id,gl.id,vl.id];let B7=class extends Ro{constructor(e,n,r,i){super(),H(this,"_shapes",new Map),this._sheetSkeletonManagerService=e,this._cmdSrv=n,this._univerInstanceService=r,this._rendererManagerService=i,this._init()}dispose(){super.dispose()}_init(){if(!this._getSheetObject())return;const e=this._univerInstanceService.getCurrentUniverSheetInstance(),n=e.getActiveSheet();n&&this._initForWorksheet(e,n),this._sheetSkeletonManagerService.currentSkeleton$.pipe(Fi(this.dispose$),Fz(void 0),xz()).subscribe(([r,i])=>{if(i){const o=this._univerInstanceService.getUniverSheetInstance(i.unitId),a=o.getSheetBySheetId(i.sheetId);this._updateWorksheet(o,a,r==null?void 0:r.sheetId)}}),this.disposeWithMe(this._cmdSrv.onCommandExecuted(r=>{if(!hke.includes(r.id)||!r.params||!r.params.unitId||!r.params.subUnitId)return;const i=this._univerInstanceService.getUniverSheetInstance(r.params.unitId),o=i==null?void 0:i.getSheetBySheetId(r.params.subUnitId);o&&this._updateWorksheet(i,o,o.getSheetId())}))}_initForWorksheet(e,n){var r;const i=(r=this._sheetSkeletonManagerService.getCurrent())==null?void 0:r.skeleton;if(!i)return;const o=n.getHiddenRows(),a=n.getHiddenCols(),s=this._getSheetObject();if(!s)return;const{scene:u}=s,l=n.getRowCount(),c=o.map(f=>{const{startRow:h,endRow:p}=f,v=tw(h,0,u,i),g=h!==0,b=p!==l-1;return new lw(cw,{type:uC.ROW,hovered:!1,hasPrevious:g,hasNext:b,top:v.startY-(g?D6:0),left:v.startX-D6},()=>this._cmdSrv.executeCommand(JE.id,{unitId:e.getUnitId(),subUnitId:n.getSheetId(),ranges:[f]}))}),d=n.getColumnCount(),m=a.map(f=>{const{startColumn:h,endColumn:p}=f,v=tw(0,h,u,i),g=h!==0,b=p!==d-1;return new lw(cw,{type:uC.COLUMN,hovered:!1,hasPrevious:g,hasNext:b,left:v.startX-(g?D6:0),top:20-D6},()=>this._cmdSrv.executeCommand(ZE.id,{unitId:e.getUnitId(),subUnitId:n.getSheetId(),ranges:[f]}))});u.addObjects(m,kT),u.addObjects(c,kT),this._shapes.set(bY(e,n),{cols:m,rows:c})}_updateWorksheet(e,n,r){if(r){const i=this._shapes.get(`${e.getUnitId()}|${r}`);i==null||i.cols.forEach(o=>o.dispose()),i==null||i.rows.forEach(o=>o.dispose())}this._initForWorksheet(e,n)}_getSheetObject(){return pa(this._univerInstanceService,this._rendererManagerService)}};B7=fke([yt(ot.Rendered,B7),e4(0,K(Dr)),e4(1,se),e4(2,ae),e4(3,Jn)],B7);var pke=Object.defineProperty,gke=Object.getOwnPropertyDescriptor,vke=(t,e,n,r)=>{for(var i=r>1?void 0:r?gke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&pke(e,n,i),i},Gg=(t,e)=>(n,r)=>e(n,r,t);let U7=class extends We{constructor(e,n,r){super(),this._markSelectionService=e,this._commandService=n,this._sheetSkeletonManagerService=r,this._initListeners()}_initListeners(){this._addRemoveListener(),this._addRefreshListener()}_addRemoveListener(){const e=[v1.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{e.includes(n.id)?this._markSelectionService.removeAllShapes():this._markSelectionService.getShapeMap().forEach((r,i)=>{r.exits.includes(n.id)&&this._markSelectionService.removeShape(i)})}))}_addRefreshListener(){this.disposeWithMe(je(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{e&&this._markSelectionService.refreshShapes()})))}};U7=vke([yt(ot.Steady,U7),Gg(0,K(B8)),Gg(1,se),Gg(2,K(Dr))],U7);var bke=Object.defineProperty,_ke=Object.getOwnPropertyDescriptor,Cke=(t,e,n,r)=>{for(var i=r>1?void 0:r?_ke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&bke(e,n,i),i},Kg=(t,e)=>(n,r)=>e(n,r,t);let V7=class extends We{constructor(e,n,r){super(),H(this,"_initialize",()=>{const i=new ws;this.disposeWithMe(je(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{i.dispose();const o=this._selectionManagerService.getCurrent();(o==null?void 0:o.pluginName)===Nn&&this._selectionRenderService.getCurrentControls().forEach(a=>{i.add(je(a.selectionMoved$.subscribe(s=>{if(!s)return;const u=a.model.getRange(),l={startRow:u.startRow,startColumn:u.startColumn,endRow:u.endRow,endColumn:u.endColumn,rangeType:u.rangeType},c={startRow:s.startRow,startColumn:s.startColumn,endRow:s.endRow,endColumn:s.endColumn,rangeType:u.rangeType};if(l.startRow===c.startRow&&l.startColumn===c.startColumn||c.startRow<0||c.startColumn<0)return;const d={fromRange:l,toRange:c};this._commandService.executeCommand(Qc.id,d)})))})})))}),this._selectionRenderService=e,this._selectionManagerService=n,this._commandService=r,this._initialize()}};V7=Cke([yt(ot.Steady,V7),Kg(0,K(Hi)),Kg(1,K(dt)),Kg(2,K(se))],V7);var Ske=Object.defineProperty,Eke=Object.getOwnPropertyDescriptor,yke=(t,e,n,r)=>{for(var i=r>1?void 0:r?Eke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Ske(e,n,i),i},A2=(t,e)=>(n,r)=>e(n,r,t);let C0=class extends We{constructor(e,n,r,i,o,a){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionManagerService=o,this._scrollManagerService=a,this._initialize()}scrollToVisible(e=!0){var n,r,i,o;let a,s;const u=this._selectionManagerService.getLast();if(u==null)return;const{startRow:l,startColumn:c,actualRow:d,actualColumn:m}=u.primary,f=e?d:l,h=e?m:c,{rowHeightAccumulation:p,columnWidthAccumulation:v}=(r=(n=this._sheetSkeletonManagerService.getCurrent())==null?void 0:n.skeleton)!=null?r:{};if(p==null||v==null)return;const g=(i=this._getSheetObject())==null?void 0:i.scene;if(g==null)return;const b=g.getViewport(Ft.VIEW_MAIN);if(b==null||this._getSheetObject()==null)return;const C=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet(),{startColumn:S,startRow:E,ySplit:y,xSplit:D}=C.getFreeze(),R=b.getBounding(),I=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(I==null)return;const{startRow:T,startColumn:P,endRow:N,endColumn:B}=I.getRowColumnSegment(R);if(f>=E&&h>=S-D&&(f<=T&&(a=f),f>=N)){const Q=p[f]-b.height;for(let te=T;te<=f;te++)if(p[te]>=Q){a=te+1;break}}if(h>=S&&f>=E-y&&(h<=P&&(s=h),h>=B)){const Q=v[h]-b.width;for(let te=P;te<=h;te++)if(v[te]>=Q){s=te+1;break}}if(a===void 0&&s===void 0)return;const{offsetX:W,offsetY:G}=this._scrollManagerService.getCurrentScroll()||{};this._commandService.executeCommand(_0.id,{sheetViewStartRow:a,sheetViewStartColumn:s,offsetX:s===void 0?W:0,offsetY:a===void 0?G:0})}dispose(){super.dispose()}_initialize(){this._scrollEventBinding(),this._scrollSubscribeBinding(),this._skeletonListener()}_getFreeze(){var e;const n=(e=this._sheetSkeletonManagerService.getCurrent())==null?void 0:e.skeleton.getWorksheetConfig();if(n!=null)return n.freeze}_scrollEventBinding(){var e;const n=(e=this._getSheetObject())==null?void 0:e.scene;if(n==null)return;const r=n.getViewport(Ft.VIEW_MAIN);this.disposeWithMe(je(r==null?void 0:r.onScrollAfterObserver.add(i=>{var o;const a=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(a==null||i.isTrigger===!1)return;const s=this._getSheetObject();if(a==null||s==null)return;const{actualScrollX:u=0,actualScrollY:l=0}=i,{row:c,column:d,rowOffset:m,columnOffset:f}=a.getDecomposedOffset(u,l);this._scrollManagerService.addOrReplaceNoRefresh({sheetViewStartRow:c,sheetViewStartColumn:d,offsetX:f,offsetY:m})}))),this.disposeWithMe(je(r==null?void 0:r.onScrollByBarObserver.add(i=>{var o;const a=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(a==null||i.isTrigger===!1)return;const s=this._getSheetObject();if(a==null||s==null)return;const{actualScrollX:u=0,actualScrollY:l=0}=i,c=this._getFreeze(),{row:d,column:m,rowOffset:f,columnOffset:h}=a.getDecomposedOffset(u,l);this._commandService.executeCommand(_0.id,{sheetViewStartRow:d+((c==null?void 0:c.ySplit)||0),sheetViewStartColumn:m+((c==null?void 0:c.xSplit)||0),offsetX:h,offsetY:f})})))}_scrollSubscribeBinding(){this.disposeWithMe(je(this._scrollManagerService.scrollInfo$.subscribe(e=>{var n;const r=(n=this._sheetSkeletonManagerService.getCurrent())==null?void 0:n.skeleton,i=this._getSheetObject();if(r==null||i==null)return;const o=i.scene;i.scene.getAncestorScale();const a=o.getViewport(Ft.VIEW_MAIN);if(a==null)return;if(e==null){a.scrollTo({x:0,y:0});return}const{sheetViewStartRow:s,sheetViewStartColumn:u,offsetX:l,offsetY:c}=e,{startX:d,startY:m}=r.getCellByIndexWithNoHeader(s,u),f=d+l,h=m+c,p=a.getBarScroll(f,h);a.scrollTo(p)})))}_skeletonListener(){this.disposeWithMe(je(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n,sheetId:r}=e;this._renderManagerService.getRenderById(n)!=null&&(this._updateSceneSize(e),this._scrollManagerService.setCurrentScroll({unitId:n,sheetId:r}))})))}_updateSceneSize(e){var n;if(e==null)return;const{skeleton:r,unitId:i}=e,o=(n=this._renderManagerService.getRenderById(i))==null?void 0:n.scene;if(r==null||o==null)return;const{rowTotalHeight:a,columnTotalWidth:s,rowHeaderWidthAndMarginLeft:u,columnHeaderHeightAndMarginTop:l}=r;o==null||o.transformByState({width:u+s,height:l+a})}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}};C0=yke([yt(ot.Rendered,C0),A2(0,K(Dr)),A2(1,ae),A2(2,se),A2(3,Jn),A2(4,K(dt)),A2(5,K(Pl))],C0);var Dke=Object.defineProperty,Rke=Object.getOwnPropertyDescriptor,Ike=(t,e,n,r)=>{for(var i=r>1?void 0:r?Rke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Dke(e,n,i),i},dw=(t,e)=>(n,r)=>e(n,r,t);const Ake=[vo.id,i2.id];let H7=class extends We{constructor(e,n){super(),this._commandService=e,this._scrollController=n,this.disposeWithMe(this._commandService.onCommandExecuted(r=>{Ake.includes(r.id)&&this._scrollController.scrollToVisible()}))}};H7=Ike([yt(ot.Rendered,H7),dw(0,se),dw(1,K(C0))],H7);var Tke=Object.defineProperty,wke=Object.getOwnPropertyDescriptor,Lke=(t,e,n,r)=>{for(var i=r>1?void 0:r?wke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Tke(e,n,i),i},Eu=(t,e)=>(n,r)=>e(n,r,t);let j7=class extends We{constructor(e,n,r,i,o,a,s,u){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionRenderService=o,this._selectionManagerService=a,this._themeService=s,this._scrollController=u,this._initialize()}_initialize(){const e=this._currentUniverService.getCurrentUniverSheetInstance(),n=e.getActiveSheet(),r=this._getSheetObject();if(r==null)return;this._initViewMainListener(r),this._initRowHeader(r),this._initColumnHeader(r),this._initLeftTop(r),this._initSelectionChangeListener(),this._initThemeChangeListener(),this._initSkeletonChangeListener(),this._initCommandListener(),this._initUserActionSyncListener();const i=e.getUnitId(),o=n.getSheetId();this._selectionManagerService.setCurrentSelection({pluginName:Nn,unitId:i,sheetId:o})}_getActiveViewport(e){const n=this._getSheetObject();return n==null?void 0:n.scene.getActiveViewportByCoord(zt.FromArray([e.offsetX,e.offsetY]))}_initViewMainListener(e){const{spreadsheet:n}=e;this.disposeWithMe(je(n==null?void 0:n.onPointerDownObserver.add((r,i)=>{this._selectionRenderService.enableDetectMergedCell(),this._selectionRenderService.eventTrigger(r,n.zIndex+1,ct.NORMAL,this._getActiveViewport(r)),r.button!==2&&i.stopPropagation()})))}_initThemeChangeListener(){this.disposeWithMe(je(this._themeService.currentTheme$.subscribe(()=>{this._selectionRenderService.resetStyle();const e=this._selectionManagerService.getSelections(),n=this._selectionManagerService.getCurrent();e==null||(n==null?void 0:n.pluginName)!==Nn||this._refreshSelection(e)})))}_refreshSelection(e){const n=e.map(r=>{const i=this._selectionRenderService.convertSelectionRangeToData(r);return i.style=vc(this._themeService),i});this._selectionRenderService.updateControlForCurrentByRangeData(n)}_initRowHeader(e){const{spreadsheetRowHeader:n,spreadsheet:r}=e;this.disposeWithMe(je(n==null?void 0:n.onPointerDownObserver.add((i,o)=>{this._selectionRenderService.disableDetectMergedCell(),this._selectionRenderService.eventTrigger(i,((r==null?void 0:r.zIndex)||1)+1,ct.ROW,this._getActiveViewport(i),$o.Y),i.button!==2&&o.stopPropagation()})))}_initColumnHeader(e){const{spreadsheetColumnHeader:n,spreadsheet:r}=e;this.disposeWithMe(je(n==null?void 0:n.onPointerDownObserver.add((i,o)=>{this._selectionRenderService.disableDetectMergedCell(),this._selectionRenderService.eventTrigger(i,((r==null?void 0:r.zIndex)||1)+1,ct.COLUMN,this._getActiveViewport(i),$o.X),i.button!==2&&o.stopPropagation()})))}_initLeftTop(e){const{spreadsheetLeftTopPlaceholder:n}=e;this.disposeWithMe(je(n==null?void 0:n.onPointerDownObserver.add((r,i)=>{var o;const a=(o=this._sheetSkeletonManagerService.getCurrent())==null?void 0:o.skeleton;if(a==null)return;this._selectionRenderService.reset();const s=this._getAllRange(a),u=this._selectionRenderService.convertSelectionRangeToData(s);this._selectionRenderService.addControlToCurrentByRangeData(u),this._selectionRenderService.refreshSelectionMoveStart(),r.button!==2&&i.stopPropagation()})))}_initSelectionChangeListener(){this.disposeWithMe(je(this._selectionManagerService.selectionMoveEnd$.subscribe(e=>{if(this._selectionRenderService.reset(),e!=null)for(const n of e){if(n==null)continue;const r=this._selectionRenderService.convertSelectionRangeToData(n);this._selectionRenderService.addControlToCurrentByRangeData(r)}})))}_initUserActionSyncListener(){this._selectionRenderService.selectionMoveStart$.subscribe(e=>{this._move(e,f7.MOVE_START)}),this._selectionRenderService.selectionMoving$.subscribe(e=>{this._move(e,f7.MOVING)}),this._selectionRenderService.selectionMoveEnd$.subscribe(e=>{this._move(e,f7.MOVE_END)})}_move(e,n){const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getUnitId(),o=r.getActiveSheet().getSheetId(),a=this._selectionManagerService.getCurrent();e==null||e.length===0||this._commandService.executeCommand(_n.id,{unitId:i,subUnitId:o,type:n,pluginName:(a==null?void 0:a.pluginName)||Nn,selections:e.map(s=>_7(s))})}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}_initCommandListener(){const e=[Ml.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=n.params,{unitId:a,subUnitId:s}=o;if(!(a===r.getUnitId()&&s===i.getSheetId()))return;this._selectionManagerService.refreshSelection()}}))}_initSkeletonChangeListener(){this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:n,sheetId:r,skeleton:i}=e,o=this._renderManagerService.getRenderById(n);if(o==null)return;const{scene:a}=o,s=a.getViewport(Ft.VIEW_MAIN);this._selectionRenderService.changeRuntime(i,a,s);const u=this._selectionManagerService.getCurrent(),l=(u==null?void 0:u.pluginName)||Nn;if((u==null?void 0:u.unitId)===n&&u.sheetId===r){const c=this._selectionManagerService.getSelections();c!=null&&this._refreshSelection(c)}else this._selectionManagerService.setCurrentSelection({pluginName:l,unitId:n,sheetId:r});l===Nn&&this._selectionManagerService.getLast()==null&&this._selectionManagerService.add([this._getZeroRange(i)])})}_getAllRange(e){return{range:{startRow:0,startColumn:0,endRow:e.getRowCount()-1,endColumn:e.getColumnCount()-1,rangeType:ct.ALL},primary:this._getZeroRange(e).primary,style:null}}_getZeroRange(e){const n=e.mergeData;return SMe(0,0,n)||{range:{startRow:0,startColumn:0,endRow:0,endColumn:0},primary:{actualRow:0,actualColumn:0,startRow:0,startColumn:0,endRow:0,endColumn:0,isMerged:!1,isMergedMainCell:!1},style:null}}};j7=Lke([yt(ot.Rendered,j7),Eu(0,K(Dr)),Eu(1,ae),Eu(2,se),Eu(3,Jn),Eu(4,Hi),Eu(5,K(dt)),Eu(6,K(_i)),Eu(7,K(C0))],j7);var Oke=Object.defineProperty,Pke=Object.getOwnPropertyDescriptor,Mke=(t,e,n,r)=>{for(var i=r>1?void 0:r?Pke(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Oke(e,n,i),i},T2=(t,e)=>(n,r)=>e(n,r,t);let z7=class extends We{constructor(e,n,r,i,o,a){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._renderManagerService=r,this._commandService=i,this._selectionRenderService=o,this._selectionManagerService=a,this._initialize(),this._commandExecutedListener()}dispose(){super.dispose()}_initialize(){this._initialRenderRefresh()}_initialRenderRefresh(){this.disposeWithMe(je(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{skeleton:n,unitId:r,sheetId:i}=e,o=this._currentUniverService.getUniverSheetInstance(r),a=o==null?void 0:o.getSheetBySheetId(i);if(o==null||a==null)return;const s=this._renderManagerService.getRenderById(r);if(s==null)return;const{mainComponent:u,components:l,scene:c}=s,d=u,m=l.get(ho.ROW),f=l.get(ho.COLUMN),h=l.get(ho.LEFT_TOP),{rowHeaderWidth:p,columnHeaderHeight:v}=n;d==null||d.updateSkeleton(n),m==null||m.updateSkeleton(n),f==null||f.updateSkeleton(n),h==null||h.transformByState({width:p,height:v})})))}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((e,n)=>{var r,i;const o=this._currentUniverService.getCurrentUniverSheetInstance(),a=o.getUnitId();if(bV.includes(e.id)){const s=o.getActiveSheet(),u=s.getSheetId(),l=e.params,{unitId:c,subUnitId:d}=l;if(!(c===o.getUnitId()&&d===s.getSheetId()))return;e.id!==Us.id&&this._sheetSkeletonManagerService.makeDirty({unitId:c,sheetId:u,commandId:e.id},!0),this._sheetSkeletonManagerService.setCurrent({unitId:c,sheetId:u,commandId:e.id})}else _Me.includes(e.id)&&this._sheetSkeletonManagerService.reCalculate();e.type===ue.MUTATION&&((i=(r=this._renderManagerService.getRenderById(a))==null?void 0:r.mainComponent)==null||i.makeDirty())}))}};z7=Mke([yt(ot.Ready,z7),T2(0,K(Dr)),T2(1,ae),T2(2,Jn),T2(3,se),T2(4,Hi),T2(5,K(dt))],z7);const cu={type:ue.COMMAND,id:"sheet.command.add-worksheet-merge",handler:async(t,e)=>{const n=t.get(se),r=t.get(en),i=t.get(ae),o=t.get(Ca),a=t.get(Gt),s=e.unitId,u=e.subUnitId,l=e.selections,c=Nf(l,e.value),d=i.getUniverSheetInstance(s).getSheetBySheetId(u),m=[],f=[],h=iH(d,c);if(h&&!await o.confirm({id:"merge.confirm.add-worksheet-merge",title:{title:"merge.confirm.title"},cancelText:a.t("merge.confirm.cancel"),confirmText:a.t("merge.confirm.confirm")}))return!1;const p={unitId:s,subUnitId:u,ranges:c},v={unitId:s,subUnitId:u,ranges:c};m.push({id:Un.id,params:p}),m.push({id:Bn.id,params:v});const g=Zi(t,p),b=Fo(t,v);if(f.push({id:Un.id,params:b}),f.push({id:Bn.id,params:g}),h){const C=oH(t,s,d,c);m.unshift(...C.redos),f.push(...C.undos)}return lr(m,n).result?(r.pushUndoRedo({unitID:s,undoMutations:f,redoMutations:m}),!0):!1}},vH={type:ue.COMMAND,id:"sheet.command.add-worksheet-merge-all",handler:async t=>{const e=t.get(se),n=t.get(dt).getSelectionRanges();if(!(n!=null&&n.length))return!1;const r=t.get(ae).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),a=i.getSheetId();return e.executeCommand(cu.id,{selections:n,unitId:o,subUnitId:a})}},bH={type:ue.COMMAND,id:"sheet.command.add-worksheet-merge-vertical",handler:async t=>{const e=t.get(se),n=t.get(dt).getSelectionRanges();if(!(n!=null&&n.length))return!1;const r=t.get(ae).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),a=i.getSheetId();return e.executeCommand(cu.id,{value:Tr.COLUMNS,selections:n,unitId:o,subUnitId:a})}},_H={type:ue.COMMAND,id:"sheet.command.add-worksheet-merge-horizontal",handler:async t=>{const e=t.get(se),n=t.get(dt).getSelectionRanges();if(!(n!=null&&n.length))return!1;const r=t.get(ae).getCurrentUniverSheetInstance();if(!r)return!1;const i=r.getActiveSheet();if(!i)return!1;const o=r.getUnitId(),a=i.getSheetId();return e.executeCommand(cu.id,{value:Tr.ROWS,selections:n,unitId:o,subUnitId:a})}},Ey={type:ue.COMMAND,id:"sheet.command.delete-range-move-left-confirm",handler:async t=>{const e=t.get(Ca),n=t.get(se),r=t.get(Gt),i=t.get(dt),o=t.get(ae),a=i.getSelections();if(!a)return!1;const s=o.getCurrentUniverSheetInstance().getActiveSheet();let u=a[0].range;if(!u)return!1;u={...u,endColumn:s.getColumnCount()-1};const l=c=>c.endRow-c.startRow;return s.getMergeData().find(c=>{const d=ht.getIntersects(c,u);return d?l(c)>l(d):!1})?await e.confirm({id:Ey.id,title:{title:r.t("merge.confirm.waring")},children:{title:r.t("merge.confirm.dismantleMergeCellWaring")},cancelText:r.t("button.cancel"),confirmText:r.t("button.confirm")})?n.executeCommand(Fc.id):!0:n.executeCommand(Fc.id)}},yy={type:ue.COMMAND,id:"sheet.command.delete-range-move-up-confirm",handler:async t=>{const e=t.get(Ca),n=t.get(se),r=t.get(Gt),i=t.get(dt),o=t.get(ae),a=i.getSelections();if(!a)return!1;const s=o.getCurrentUniverSheetInstance().getActiveSheet();let u=a[0].range;if(!u)return!1;u={...u,endRow:s.getColumnCount()-1};const l=c=>c.endColumn-c.startColumn;return s.getMergeData().find(c=>{const d=ht.getIntersects(c,u);return d?l(c)>l(d):!1})?await e.confirm({id:yy.id,title:{title:r.t("merge.confirm.waring")},children:{title:r.t("merge.confirm.dismantleMergeCellWaring")},cancelText:r.t("button.cancel"),confirmText:r.t("button.confirm")})?n.executeCommand($c.id):!0:n.executeCommand($c.id)}},Dy={type:ue.COMMAND,id:"sheet.command.insert-range-move-down-confirm",handler:async t=>{const e=t.get(Ca),n=t.get(se),r=t.get(Gt),i=t.get(dt),o=t.get(ae),a=i.getSelections();if(!a)return!1;const s=o.getCurrentUniverSheetInstance().getActiveSheet();let u=a[0].range;if(!u)return!1;u={...u,endRow:s.getColumnCount()-1};const l=c=>c.endColumn-c.startColumn;return s.getMergeData().find(c=>{const d=ht.getIntersects(c,u);return d?l(c)>l(d):!1})?await e.confirm({id:Dy.id,title:{title:r.t("merge.confirm.waring")},children:{title:r.t("merge.confirm.dismantleMergeCellWaring")},cancelText:r.t("button.cancel"),confirmText:r.t("button.confirm")})?n.executeCommand(ml.id):!0:n.executeCommand(ml.id)}},Ry={type:ue.COMMAND,id:"sheet.command.insert-range-move-right-confirm",handler:async t=>{const e=t.get(Ca),n=t.get(se),r=t.get(Gt),i=t.get(dt),o=t.get(ae),a=i.getSelections();if(!a)return!1;const s=o.getCurrentUniverSheetInstance().getActiveSheet();let u=a[0].range;if(!u)return!1;u={...u,endColumn:s.getColumnCount()-1};const l=c=>c.endRow-c.startRow;return s.getMergeData().find(c=>{const d=ht.getIntersects(c,u);return d?l(c)>l(d):!1})?await e.confirm({id:Ry.id,title:{title:r.t("merge.confirm.waring")},children:{title:r.t("merge.confirm.dismantleMergeCellWaring")},cancelText:r.t("button.cancel"),confirmText:r.t("button.confirm")})?n.executeCommand(fl.id):!0:n.executeCommand(fl.id)}},CH={id:"sheet.command.refill",type:ue.COMMAND,handler:async(t,e)=>{const n=t.get(vd);return n.applyType=e.type,!0}},SH={id:"sheet.command.remove-row-confirm",type:ue.COMMAND,handler:async(t,e)=>{var n;const r=t.get(dt);let i=e==null?void 0:e.range;if(i||(i=(n=r.getLast())==null?void 0:n.range),!i)return!1;const o=t.get(se),a=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet().getVisibleRows();if(xV(a,[i])){const s=t.get(Ca),u=t.get(Gt);return await s.confirm({id:"sheet.confirm.remove-row",title:{title:u.t("info.problem")},children:{title:u.t("rightClick.deleteAllRowsAlert")},cancelText:u.t("button.cancel"),confirmText:u.t("button.confirm")}),!1}return await o.executeCommand(t2.id,{range:i}),!0}},EH={id:"sheet.command.remove-col-confirm",type:ue.COMMAND,handler:async(t,e)=>{var n;const r=t.get(dt);let i=e==null?void 0:e.range;if(i||(i=(n=r.getLast())==null?void 0:n.range),!i)return!1;const o=t.get(se),a=t.get(ae).getCurrentUniverSheetInstance().getActiveSheet().getVisibleCols();if(FV(a,[i])){const s=t.get(Ca),u=t.get(Gt);return await s.confirm({id:"sheet.confirm.remove-col",title:{title:u.t("info.problem")},children:{title:u.t("rightClick.deleteAllColumnsAlert")},cancelText:u.t("button.cancel"),confirmText:u.t("button.confirm")}),!1}return await o.executeCommand(n2.id,{range:i}),!0}},yH={id:"sheet.command.remove-sheet-confirm",type:ue.COMMAND,handler:async(t,e)=>{const{subUnitId:n}=e,r=t.get(Ca),i=t.get(se),o=t.get(Gt);return await r.confirm({id:"merge.confirm.add-worksheet-merge",title:{title:o.t("sheetConfig.deleteSheet")},children:{title:o.t("sheetConfig.deleteSheetContent")},cancelText:o.t("button.cancel"),confirmText:o.t("button.confirm")})?(await i.executeCommand(Lf.id,{subUnitId:n}),!0):!1}},Ed=ln("univer.sheetbar-service");class Nke extends We{constructor(){super(),H(this,"renameId$"),H(this,"removeId$"),H(this,"scroll$"),H(this,"scrollX$"),H(this,"addSheet$"),H(this,"_renameId$"),H(this,"_removeId$"),H(this,"_scroll$"),H(this,"_scrollX$"),H(this,"_addSheet$"),H(this,"_currentHandler",null),this._renameId$=new an,this.renameId$=this._renameId$.asObservable(),this._removeId$=new an,this.removeId$=this._removeId$.asObservable(),this._scroll$=new an,this.scroll$=this._scroll$.asObservable(),this._scrollX$=new an,this.scrollX$=this._scrollX$.asObservable(),this._addSheet$=new an,this.addSheet$=this._addSheet$.asObservable()}setRenameId(e){this._renameId$.next(e)}setRemoveId(e){this._removeId$.next(e)}setScroll(e){this._scroll$.next(e)}setScrollX(e){this._scrollX$.next(e)}setAddSheet(e){this._addSheet$.next(e)}triggerSheetBarMenu(){var e;(e=this._currentHandler)==null||e.handleSheetBarMenu()}registerSheetBarMenuHandler(e){if(this._currentHandler)throw new Error("There is already a context menu handler!");return this._currentHandler=e,je(()=>{this._currentHandler=null})}}const DH={id:"ui-sheet.command.show-menu-list",type:ue.OPERATION,handler:async t=>(t.get(Ed).triggerSheetBarMenu(),!0)},RH={id:"sheet.operation.rename-sheet",type:ue.OPERATION,handler:async(t,e)=>{const n=t.get(Ed);return e&&n.setRenameId(e.subUnitId),!0}},xke=()=>U.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("path",{d:"M0.98999 1.08218H-0.0100098V0.0821838H0.98999V1.08218Z",fill:"black"}),U.jsx("path",{d:"M5.78992 1.08218H2.78992V0.0821838H5.78992V1.08218Z",fill:"black"}),U.jsx("path",{d:"M7.58984 1.08218H8.58984V0.0821838H7.58984V1.08218Z",fill:"black"}),U.jsx("path",{d:"M14.9152 1.08218H13.9152V0.0821838H14.9152V1.08218Z",fill:"black"}),U.jsx("path",{d:"M16.7151 1.08218H19.7151V0.0821838H16.7151V1.08218Z",fill:"black"}),U.jsx("path",{d:"M22.515 1.08218H21.515V0.0821838H22.515V1.08218Z",fill:"black"}),U.jsx("path",{d:"M27.8405 1.08218H28.8405V0.0821838H27.8405V1.08218Z",fill:"black"}),U.jsx("path",{d:"M33.6404 1.08218H30.6404V0.0821838H33.6404V1.08218Z",fill:"black"}),U.jsx("path",{d:"M35.4403 1.08218H36.4403V0.0821838H35.4403V1.08218Z",fill:"black"}),U.jsx("path",{d:"M42.7657 1.08218H41.7657V0.0821838H42.7657V1.08218Z",fill:"black"}),U.jsx("path",{d:"M44.5657 1.08218H47.5657V0.0821838H44.5657V1.08218Z",fill:"black"}),U.jsx("path",{d:"M50.3656 1.08218H49.3656V0.0821838H50.3656V1.08218Z",fill:"black"}),U.jsx("path",{d:"M55.691 1.08218H56.691V0.0821838H55.691V1.08218Z",fill:"black"}),U.jsx("path",{d:"M61.491 1.08218H58.491V0.0821838H61.491V1.08218Z",fill:"black"}),U.jsx("path",{d:"M63.2909 1.08218H64.2909V0.0821838H63.2909V1.08218Z",fill:"black"}),U.jsx("path",{d:"M70.6163 1.08218H69.6163V0.0821838H70.6163V1.08218Z",fill:"black"}),U.jsx("path",{d:"M72.4163 1.08218H75.4163V0.0821838H72.4163V1.08218Z",fill:"black"}),U.jsx("path",{d:"M78.2162 1.08218H77.2162V0.0821838H78.2162V1.08218Z",fill:"black"}),U.jsx("path",{d:"M83.5416 1.08218H84.5416V0.0821838H83.5416V1.08218Z",fill:"black"}),U.jsx("path",{d:"M89.3416 1.08218H86.3416V0.0821838H89.3416V1.08218Z",fill:"black"}),U.jsx("path",{d:"M91.1415 1.08218H92.1415V0.0821838H91.1415V1.08218Z",fill:"black"}),U.jsx("path",{d:"M98.4669 1.08218H97.4669V0.0821838H98.4669V1.08218Z",fill:"black"}),U.jsx("path",{d:"M100.267 1.08218H103.267V0.0821838H100.267V1.08218Z",fill:"black"}),U.jsx("path",{d:"M106.067 1.08218H105.067V0.0821838H106.067V1.08218Z",fill:"black"}),U.jsx("path",{d:"M111.392 1.08218H112.392V0.0821838H111.392V1.08218Z",fill:"black"}),U.jsx("path",{d:"M117.192 1.08218H114.192V0.0821838H117.192V1.08218Z",fill:"black"}),U.jsx("path",{d:"M118.992 1.08218H119.992V0.0821838H118.992V1.08218Z",fill:"black"})]}),Fke=()=>U.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("path",{d:"M-0.0100098 1.15771H0.98999V0.157715H-0.0100098V1.15771Z",fill:"black"}),U.jsx("path",{d:"M2.78992 1.15771H5.78992V0.157715H2.78992V1.15771Z",fill:"black"}),U.jsx("path",{d:"M8.58984 1.15771H7.58984V0.157715H8.58984V1.15771Z",fill:"black"}),U.jsx("path",{d:"M10.3899 1.15771H11.3899V0.157715H10.3899V1.15771Z",fill:"black"}),U.jsx("path",{d:"M19.0903 1.15771H18.0903V0.157715H19.0903V1.15771Z",fill:"black"}),U.jsx("path",{d:"M20.8903 1.15771H23.8903V0.157715H20.8903V1.15771Z",fill:"black"}),U.jsx("path",{d:"M26.6902 1.15771H25.6902V0.157715H26.6902V1.15771Z",fill:"black"}),U.jsx("path",{d:"M28.4902 1.15771H29.4902V0.157715H28.4902V1.15771Z",fill:"black"}),U.jsx("path",{d:"M37.1907 1.15771H36.1907V0.157715H37.1907V1.15771Z",fill:"black"}),U.jsx("path",{d:"M38.9906 1.15771H41.9906V0.157715H38.9906V1.15771Z",fill:"black"}),U.jsx("path",{d:"M44.7905 1.15771H43.7905V0.157715H44.7905V1.15771Z",fill:"black"}),U.jsx("path",{d:"M46.5906 1.15771H47.5906V0.157715H46.5906V1.15771Z",fill:"black"}),U.jsx("path",{d:"M55.291 1.15771H54.291V0.157715H55.291V1.15771Z",fill:"black"}),U.jsx("path",{d:"M57.0909 1.15771H60.0909V0.157715H57.0909V1.15771Z",fill:"black"}),U.jsx("path",{d:"M62.8909 1.15771H61.8909V0.157715H62.8909V1.15771Z",fill:"black"}),U.jsx("path",{d:"M64.6909 1.15771H65.6909V0.157715H64.6909V1.15771Z",fill:"black"}),U.jsx("path",{d:"M73.3914 1.15771H72.3914V0.157715H73.3914V1.15771Z",fill:"black"}),U.jsx("path",{d:"M75.1913 1.15771H78.1913V0.157715H75.1913V1.15771Z",fill:"black"}),U.jsx("path",{d:"M80.9912 1.15771H79.9912V0.157715H80.9912V1.15771Z",fill:"black"}),U.jsx("path",{d:"M82.7913 1.15771H83.7913V0.157715H82.7913V1.15771Z",fill:"black"}),U.jsx("path",{d:"M91.4917 1.15771H90.4917V0.157715H91.4917V1.15771Z",fill:"black"}),U.jsx("path",{d:"M93.2916 1.15771H96.2916V0.157715H93.2916V1.15771Z",fill:"black"}),U.jsx("path",{d:"M99.0916 1.15771H98.0916V0.157715H99.0916V1.15771Z",fill:"black"}),U.jsx("path",{d:"M100.892 1.15771H101.892V0.157715H100.892V1.15771Z",fill:"black"}),U.jsx("path",{d:"M109.592 1.15771H108.592V0.157715H109.592V1.15771Z",fill:"black"}),U.jsx("path",{d:"M111.392 1.15771H114.392V0.157715H111.392V1.15771Z",fill:"black"}),U.jsx("path",{d:"M117.192 1.15771H116.192V0.157715H117.192V1.15771Z",fill:"black"}),U.jsx("path",{d:"M118.992 1.15771H119.992V0.157715H118.992V1.15771Z",fill:"black"})]}),$ke=()=>U.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("path",{d:"M-0.00842285 1.22449H2.99158V0.224487H-0.00842285V1.22449Z",fill:"black"}),U.jsx("path",{d:"M6.14941 1.22449H9.14941V0.224487H6.14941V1.22449Z",fill:"black"}),U.jsx("path",{d:"M15.3073 1.22449H12.3073V0.224487H15.3073V1.22449Z",fill:"black"}),U.jsx("path",{d:"M18.4651 1.22449H21.4651V0.224487H18.4651V1.22449Z",fill:"black"}),U.jsx("path",{d:"M27.6229 1.22449H24.6229V0.224487H27.6229V1.22449Z",fill:"black"}),U.jsx("path",{d:"M30.7808 1.22449H33.7808V0.224487H30.7808V1.22449Z",fill:"black"}),U.jsx("path",{d:"M39.9386 1.22449H36.9386V0.224487H39.9386V1.22449Z",fill:"black"}),U.jsx("path",{d:"M43.0964 1.22449H46.0964V0.224487H43.0964V1.22449Z",fill:"black"}),U.jsx("path",{d:"M52.2543 1.22449H49.2543V0.224487H52.2543V1.22449Z",fill:"black"}),U.jsx("path",{d:"M55.4121 1.22449H58.4121V0.224487H55.4121V1.22449Z",fill:"black"}),U.jsx("path",{d:"M64.5699 1.22449H61.5699V0.224487H64.5699V1.22449Z",fill:"black"}),U.jsx("path",{d:"M67.7278 1.22449H70.7278V0.224487H67.7278V1.22449Z",fill:"black"}),U.jsx("path",{d:"M76.8856 1.22449H73.8856V0.224487H76.8856V1.22449Z",fill:"black"}),U.jsx("path",{d:"M80.0435 1.22449H83.0435V0.224487H80.0435V1.22449Z",fill:"black"}),U.jsx("path",{d:"M89.2013 1.22449H86.2013V0.224487H89.2013V1.22449Z",fill:"black"}),U.jsx("path",{d:"M92.3591 1.22449H95.3591V0.224487H92.3591V1.22449Z",fill:"black"}),U.jsx("path",{d:"M101.517 1.22449H98.517V0.224487H101.517V1.22449Z",fill:"black"}),U.jsx("path",{d:"M104.675 1.22449H107.675V0.224487H104.675V1.22449Z",fill:"black"}),U.jsx("path",{d:"M113.833 1.22449H110.833V0.224487H113.833V1.22449Z",fill:"black"}),U.jsx("path",{d:"M116.99 1.22449H119.99V0.224487H116.99V1.22449Z",fill:"black"})]}),kke=()=>U.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("path",{d:"M-0.00976562 1.65707H0.990234V0.657074H-0.00976562V1.65707Z",fill:"black"}),U.jsx("path",{d:"M2.32361 1.65707H3.32361V0.657074H2.32361V1.65707Z",fill:"black"}),U.jsx("path",{d:"M5.65698 1.65707H4.65698V0.657074H5.65698V1.65707Z",fill:"black"}),U.jsx("path",{d:"M6.99036 1.65707H7.99036V0.657074H6.99036V1.65707Z",fill:"black"}),U.jsx("path",{d:"M10.3237 1.65707H9.32373V0.657074H10.3237V1.65707Z",fill:"black"}),U.jsx("path",{d:"M11.6571 1.65707H12.6571V0.657074H11.6571V1.65707Z",fill:"black"}),U.jsx("path",{d:"M14.9905 1.65707H13.9905V0.657074H14.9905V1.65707Z",fill:"black"}),U.jsx("path",{d:"M16.3239 1.65707H17.3239V0.657074H16.3239V1.65707Z",fill:"black"}),U.jsx("path",{d:"M19.6572 1.65707H18.6572V0.657074H19.6572V1.65707Z",fill:"black"}),U.jsx("path",{d:"M20.9906 1.65707H21.9906V0.657074H20.9906V1.65707Z",fill:"black"}),U.jsx("path",{d:"M24.324 1.65707H23.324V0.657074H24.324V1.65707Z",fill:"black"}),U.jsx("path",{d:"M25.6573 1.65707H26.6573V0.657074H25.6573V1.65707Z",fill:"black"}),U.jsx("path",{d:"M28.9907 1.65707H27.9907V0.657074H28.9907V1.65707Z",fill:"black"}),U.jsx("path",{d:"M30.3241 1.65707H31.3241V0.657074H30.3241V1.65707Z",fill:"black"}),U.jsx("path",{d:"M33.6575 1.65707H32.6575V0.657074H33.6575V1.65707Z",fill:"black"}),U.jsx("path",{d:"M34.9908 1.65707H35.9908V0.657074H34.9908V1.65707Z",fill:"black"}),U.jsx("path",{d:"M38.3242 1.65707H37.3242V0.657074H38.3242V1.65707Z",fill:"black"}),U.jsx("path",{d:"M39.6576 1.65707H40.6576V0.657074H39.6576V1.65707Z",fill:"black"}),U.jsx("path",{d:"M42.991 1.65707H41.991V0.657074H42.991V1.65707Z",fill:"black"}),U.jsx("path",{d:"M44.3243 1.65707H45.3243V0.657074H44.3243V1.65707Z",fill:"black"}),U.jsx("path",{d:"M47.6577 1.65707H46.6577V0.657074H47.6577V1.65707Z",fill:"black"}),U.jsx("path",{d:"M48.9911 1.65707H49.9911V0.657074H48.9911V1.65707Z",fill:"black"}),U.jsx("path",{d:"M52.3245 1.65707H51.3245V0.657074H52.3245V1.65707Z",fill:"black"}),U.jsx("path",{d:"M53.6578 1.65707H54.6578V0.657074H53.6578V1.65707Z",fill:"black"}),U.jsx("path",{d:"M56.9912 1.65707H55.9912V0.657074H56.9912V1.65707Z",fill:"black"}),U.jsx("path",{d:"M58.3246 1.65707H59.3246V0.657074H58.3246V1.65707Z",fill:"black"}),U.jsx("path",{d:"M61.658 1.65707H60.658V0.657074H61.658V1.65707Z",fill:"black"}),U.jsx("path",{d:"M62.9913 1.65707H63.9913V0.657074H62.9913V1.65707Z",fill:"black"}),U.jsx("path",{d:"M66.3247 1.65707H65.3247V0.657074H66.3247V1.65707Z",fill:"black"}),U.jsx("path",{d:"M67.6581 1.65707H68.6581V0.657074H67.6581V1.65707Z",fill:"black"}),U.jsx("path",{d:"M70.9915 1.65707H69.9915V0.657074H70.9915V1.65707Z",fill:"black"}),U.jsx("path",{d:"M72.3248 1.65707H73.3248V0.657074H72.3248V1.65707Z",fill:"black"}),U.jsx("path",{d:"M75.6582 1.65707H74.6582V0.657074H75.6582V1.65707Z",fill:"black"}),U.jsx("path",{d:"M76.9916 1.65707H77.9916V0.657074H76.9916V1.65707Z",fill:"black"}),U.jsx("path",{d:"M80.325 1.65707H79.325V0.657074H80.325V1.65707Z",fill:"black"}),U.jsx("path",{d:"M81.6583 1.65707H82.6583V0.657074H81.6583V1.65707Z",fill:"black"}),U.jsx("path",{d:"M84.9917 1.65707H83.9917V0.657074H84.9917V1.65707Z",fill:"black"}),U.jsx("path",{d:"M86.3251 1.65707H87.3251V0.657074H86.3251V1.65707Z",fill:"black"}),U.jsx("path",{d:"M89.6584 1.65707H88.6584V0.657074H89.6584V1.65707Z",fill:"black"}),U.jsx("path",{d:"M90.9918 1.65707H91.9918V0.657074H90.9918V1.65707Z",fill:"black"}),U.jsx("path",{d:"M94.3252 1.65707H93.3252V0.657074H94.3252V1.65707Z",fill:"black"}),U.jsx("path",{d:"M95.6586 1.65707H96.6586V0.657074H95.6586V1.65707Z",fill:"black"}),U.jsx("path",{d:"M98.9919 1.65707H97.9919V0.657074H98.9919V1.65707Z",fill:"black"}),U.jsx("path",{d:"M100.325 1.65707H101.325V0.657074H100.325V1.65707Z",fill:"black"}),U.jsx("path",{d:"M103.659 1.65707H102.659V0.657074H103.659V1.65707Z",fill:"black"}),U.jsx("path",{d:"M104.992 1.65707H105.992V0.657074H104.992V1.65707Z",fill:"black"}),U.jsx("path",{d:"M108.325 1.65707H107.325V0.657074H108.325V1.65707Z",fill:"black"}),U.jsx("path",{d:"M109.659 1.65707H110.659V0.657074H109.659V1.65707Z",fill:"black"}),U.jsx("path",{d:"M112.992 1.65707H111.992V0.657074H112.992V1.65707Z",fill:"black"}),U.jsx("path",{d:"M114.325 1.65707H115.325V0.657074H114.325V1.65707Z",fill:"black"}),U.jsx("path",{d:"M117.659 1.65707H116.659V0.657074H117.659V1.65707Z",fill:"black"}),U.jsx("path",{d:"M118.992 1.65707H119.992V0.657074H118.992V1.65707Z",fill:"black"})]}),Bke=()=>U.jsx("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:U.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 2.42035H-0.0090332V0.420349H119.991V2.42035Z",fill:"black"})}),Uke=()=>U.jsxs("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("path",{d:"M-0.0100098 2.47614H1.98999V0.476135H-0.0100098V2.47614Z",fill:"black"}),U.jsx("path",{d:"M3.99014 2.47614H9.99014V0.476135H3.99014V2.47614Z",fill:"black"}),U.jsx("path",{d:"M13.9901 2.47614H11.9901V0.476135H13.9901V2.47614Z",fill:"black"}),U.jsx("path",{d:"M21.1904 2.47614H23.1904V0.476135H21.1904V2.47614Z",fill:"black"}),U.jsx("path",{d:"M31.1906 2.47614H25.1906V0.476135H31.1906V2.47614Z",fill:"black"}),U.jsx("path",{d:"M33.1906 2.47614H35.1906V0.476135H33.1906V2.47614Z",fill:"black"}),U.jsx("path",{d:"M44.3909 2.47614H42.3909V0.476135H44.3909V2.47614Z",fill:"black"}),U.jsx("path",{d:"M46.391 2.47614H52.391V0.476135H46.391V2.47614Z",fill:"black"}),U.jsx("path",{d:"M56.391 2.47614H54.391V0.476135H56.391V2.47614Z",fill:"black"}),U.jsx("path",{d:"M63.5913 2.47614H65.5913V0.476135H63.5913V2.47614Z",fill:"black"}),U.jsx("path",{d:"M73.5915 2.47614H67.5915V0.476135H73.5915V2.47614Z",fill:"black"}),U.jsx("path",{d:"M75.5915 2.47614H77.5915V0.476135H75.5915V2.47614Z",fill:"black"}),U.jsx("path",{d:"M86.7917 2.47614H84.7917V0.476135H86.7917V2.47614Z",fill:"black"}),U.jsx("path",{d:"M88.7919 2.47614H94.7919V0.476135H88.7919V2.47614Z",fill:"black"}),U.jsx("path",{d:"M98.7919 2.47614H96.7919V0.476135H98.7919V2.47614Z",fill:"black"}),U.jsx("path",{d:"M105.992 2.47614H107.992V0.476135H105.992V2.47614Z",fill:"black"}),U.jsx("path",{d:"M115.992 2.47614H109.992V0.476135H115.992V2.47614Z",fill:"black"}),U.jsx("path",{d:"M117.992 2.47614H119.992V0.476135H117.992V2.47614Z",fill:"black"})]}),Vke=()=>U.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("path",{d:"M-0.0100098 2.00415H1.98999V0.00415039H-0.0100098V2.00415Z",fill:"black"}),U.jsx("path",{d:"M3.99014 2.00415H9.99014V0.00415039H3.99014V2.00415Z",fill:"black"}),U.jsx("path",{d:"M13.9901 2.00415H11.9901V0.00415039H13.9901V2.00415Z",fill:"black"}),U.jsx("path",{d:"M15.9901 2.00415H17.9901V0.00415039H15.9901V2.00415Z",fill:"black"}),U.jsx("path",{d:"M27.4905 2.00415H25.4905V0.00415039H27.4905V2.00415Z",fill:"black"}),U.jsx("path",{d:"M29.4906 2.00415H35.4906V0.00415039H29.4906V2.00415Z",fill:"black"}),U.jsx("path",{d:"M39.4906 2.00415H37.4906V0.00415039H39.4906V2.00415Z",fill:"black"}),U.jsx("path",{d:"M41.4906 2.00415H43.4906V0.00415039H41.4906V2.00415Z",fill:"black"}),U.jsx("path",{d:"M52.991 2.00415H50.991V0.00415039H52.991V2.00415Z",fill:"black"}),U.jsx("path",{d:"M54.9911 2.00415H60.9911V0.00415039H54.9911V2.00415Z",fill:"black"}),U.jsx("path",{d:"M64.9911 2.00415H62.9911V0.00415039H64.9911V2.00415Z",fill:"black"}),U.jsx("path",{d:"M66.9911 2.00415H68.9911V0.00415039H66.9911V2.00415Z",fill:"black"}),U.jsx("path",{d:"M78.4915 2.00415H76.4915V0.00415039H78.4915V2.00415Z",fill:"black"}),U.jsx("path",{d:"M80.4916 2.00415H86.4916V0.00415039H80.4916V2.00415Z",fill:"black"}),U.jsx("path",{d:"M90.4916 2.00415H88.4916V0.00415039H90.4916V2.00415Z",fill:"black"}),U.jsx("path",{d:"M92.4916 2.00415H94.4916V0.00415039H92.4916V2.00415Z",fill:"black"}),U.jsx("path",{d:"M103.992 2.00415H101.992V0.00415039H103.992V2.00415Z",fill:"black"}),U.jsx("path",{d:"M105.992 2.00415H111.992V0.00415039H105.992V2.00415Z",fill:"black"}),U.jsx("path",{d:"M115.992 2.00415H113.992V0.00415039H115.992V2.00415Z",fill:"black"}),U.jsx("path",{d:"M117.992 2.00415H119.992V0.00415039H117.992V2.00415Z",fill:"black"})]}),Hke=()=>U.jsxs("svg",{width:"118",height:"3",viewBox:"0 0 118 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[U.jsx("path",{d:"M-0.00854492 2.94815H1.99146V0.948151H-0.00854492V2.94815Z",fill:"black"}),U.jsx("path",{d:"M6.09668 2.94815H8.09668V0.948151H6.09668V2.94815Z",fill:"black"}),U.jsx("path",{d:"M14.2019 2.94815H12.2019V0.948151H14.2019V2.94815Z",fill:"black"}),U.jsx("path",{d:"M18.3071 2.94815H20.3071V0.948151H18.3071V2.94815Z",fill:"black"}),U.jsx("path",{d:"M26.4124 2.94815H24.4124V0.948151H26.4124V2.94815Z",fill:"black"}),U.jsx("path",{d:"M30.5176 2.94815H32.5176V0.948151H30.5176V2.94815Z",fill:"black"}),U.jsx("path",{d:"M38.6228 2.94815H36.6228V0.948151H38.6228V2.94815Z",fill:"black"}),U.jsx("path",{d:"M42.728 2.94815H44.728V0.948151H42.728V2.94815Z",fill:"black"}),U.jsx("path",{d:"M50.8333 2.94815H48.8333V0.948151H50.8333V2.94815Z",fill:"black"}),U.jsx("path",{d:"M54.9385 2.94815H56.9385V0.948151H54.9385V2.94815Z",fill:"black"}),U.jsx("path",{d:"M63.0437 2.94815H61.0437V0.948151H63.0437V2.94815Z",fill:"black"}),U.jsx("path",{d:"M67.1489 2.94815H69.1489V0.948151H67.1489V2.94815Z",fill:"black"}),U.jsx("path",{d:"M75.2542 2.94815H73.2542V0.948151H75.2542V2.94815Z",fill:"black"}),U.jsx("path",{d:"M79.3594 2.94815H81.3594V0.948151H79.3594V2.94815Z",fill:"black"}),U.jsx("path",{d:"M87.4645 2.94815H85.4645V0.948151H87.4645V2.94815Z",fill:"black"}),U.jsx("path",{d:"M91.5697 2.94815H93.5697V0.948151H91.5697V2.94815Z",fill:"black"}),U.jsx("path",{d:"M99.6749 2.94815H97.6749V0.948151H99.6749V2.94815Z",fill:"black"}),U.jsx("path",{d:"M103.78 2.94815H105.78V0.948151H103.78V2.94815Z",fill:"black"}),U.jsx("path",{d:"M111.885 2.94815H109.885V0.948151H111.885V2.94815Z",fill:"black"}),U.jsx("path",{d:"M115.991 2.94815H117.991V0.948151H115.991V2.94815Z",fill:"black"})]}),jke=()=>U.jsx("svg",{width:"120",height:"4",viewBox:"0 0 120 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:U.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 3.86215H-0.0090332V0.862152H119.991V3.86215Z",fill:"black"})}),mw=()=>U.jsx("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:U.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 1.15668H-0.0090332V0.156677H119.991V1.15668Z",fill:"black"})});function fw(t){const{type:e=Lt.THIN}=t;switch(e){case Lt.DASH_DOT:return U.jsx(xke,{});case Lt.DASH_DOT_DOT:return U.jsx(Fke,{});case Lt.DASHED:return U.jsx($ke,{});case Lt.HAIR:return U.jsx(kke,{});case Lt.MEDIUM:return U.jsx(Bke,{});case Lt.MEDIUM_DASH_DOT:return U.jsx(Uke,{});case Lt.MEDIUM_DASH_DOT_DOT:return U.jsx(Vke,{});case Lt.MEDIUM_DASHED:return U.jsx(Hke,{});case Lt.THICK:return U.jsx(jke,{});case Lt.THIN:return U.jsx(mw,{});default:return U.jsx(mw,{})}}const zke="univer-ui-plugin-sheets-border-panel",Wke="univer-ui-plugin-sheets-border-panel-position",Yke="univer-ui-plugin-sheets-border-panel-position-item",Xke="univer-ui-plugin-sheets-border-panel-styles",qke="univer-ui-plugin-sheets-border-panel-board",Gke="univer-ui-plugin-sheets-border-panel-button",Kke="univer-ui-plugin-sheets-border-panel-more-icon",L1={uiPluginSheetsBorderPanel:zke,uiPluginSheetsBorderPanelPosition:Wke,uiPluginSheetsBorderPanelPositionItem:Yke,uiPluginSheetsBorderPanelStyles:Xke,uiPluginSheetsBorderPanelBoard:qke,uiPluginSheetsBorderPanelButton:Gke,uiPluginSheetsBorderPanelMoreIcon:Kke},IH=`${_d}_BORDER_PANEL_COMPONENT`,AH=[{label:"borderLine.borderTop",icon:"UpBorder",value:"top"},{label:"borderLine.borderBottom",icon:"DownBorder",value:"bottom"},{label:"borderLine.borderLeft",icon:"LeftBorder",value:"left"},{label:"borderLine.borderRight",icon:"RightBorder",value:"right"},{label:"borderLine.borderNone",icon:"NoBorderSingle",value:"none"},{label:"borderLine.borderAll",icon:"AllBorderSingle",value:"all"},{label:"borderLine.borderOutside",icon:"OuterBorder",value:"outside"},{label:"borderLine.borderInside",icon:"InnerBorder",value:"inside"},{label:"borderLine.borderHorizontal",icon:"InnerBorder",value:"horizontal"},{label:"borderLine.borderVertical",icon:"InnerBorder",value:"vertical"},{label:"borderLine.borderTlbr",icon:"BackSlashSingle",value:"tlbr"},{label:"borderLine.borderTlbcTlmr",icon:"LeftDoubleDiagonalSingle",value:"tlbc_tlmr"},{label:"borderLine.borderTlbrTlbcTlmr",icon:"LeftTridiagonalSingle",value:"tlbr_tlbc_tlmr"},{label:"borderLine.borderBlTr",icon:"SlashSingle",value:"bltr"},{label:"borderLine.borderMltrBctr",icon:"RightDoubleDiagonalSingle",value:"mltr_bctr"}],Zke=[{label:Lt.THIN,value:Lt.THIN},{label:Lt.HAIR,value:Lt.HAIR},{label:Lt.DOTTED,value:Lt.DOTTED},{label:Lt.DASHED,value:Lt.DASHED},{label:Lt.DASH_DOT,value:Lt.DASH_DOT},{label:Lt.DASH_DOT_DOT,value:Lt.DASH_DOT_DOT},{label:Lt.MEDIUM,value:Lt.MEDIUM},{label:Lt.MEDIUM_DASHED,value:Lt.MEDIUM_DASHED},{label:Lt.MEDIUM_DASH_DOT,value:Lt.MEDIUM_DASH_DOT},{label:Lt.MEDIUM_DASH_DOT_DOT,value:Lt.MEDIUM_DASH_DOT_DOT},{label:Lt.THICK,value:Lt.THICK}];function Qke(t){var e;const n=Ct(Jo),{onChange:r,value:i}=t;function o(u,l){r==null||r({...i,[l]:u})}function a(u){const l=n.get(u);return l&&U.jsx(l,{extend:{colorChannel1:"rgb(var(--primary-color))"}})}function s(u){u.stopPropagation()}return U.jsxs("section",{className:L1.uiPluginSheetsBorderPanel,children:[U.jsx("div",{className:L1.uiPluginSheetsBorderPanelPosition,children:AH.map(u=>U.jsx("div",{className:L1.uiPluginSheetsBorderPanelPositionItem,onClick:()=>o(u.value,"type"),children:a(u.icon)},u.value))}),U.jsxs("div",{className:L1.uiPluginSheetsBorderPanelStyles,children:[U.jsx("div",{children:U.jsx(eu,{align:{offset:[0,18]},overlay:U.jsx("section",{className:L1.uiPluginSheetsBorderPanelBoard,onClick:s,children:U.jsx($S,{onChange:u=>o(u,"color")})}),children:U.jsxs("a",{className:L1.uiPluginSheetsBorderPanelButton,onClick:s,children:[U.jsx(Dxe,{extend:{colorChannel1:(e=i.color)!=null?e:"rgb(var(--primary-color))"}}),U.jsx("span",{className:L1.uiPluginSheetsBorderPanelMoreIcon,children:U.jsx(rC,{})})]})})}),U.jsx("div",{children:U.jsx(eu,{align:{offset:[0,18]},overlay:U.jsx("section",{onClick:s,children:U.jsx(ZN,{children:Zke.map(u=>U.jsx(l9,{eventKey:u.value.toString(),onClick:()=>o(u.value,"style"),children:U.jsx(fw,{type:u.value})},u.value))})}),children:U.jsxs("a",{className:L1.uiPluginSheetsBorderPanelButton,onClick:s,children:[U.jsx(fw,{type:Lt.THIN}),U.jsx("span",{className:L1.uiPluginSheetsBorderPanelMoreIcon,children:U.jsx(rC,{})})]})})})]})]})}const Jke="univer-count-bar",eBe={countBar:Jke},tBe=[50,80,100,130,150,170,200,400],nBe=100;function rBe(){const t=Ct(se),e=Ct(ae),n=Ct(pr),r=s(),[i,o]=_.useState(r),a=!xae(()=>TC(n.subscribeContextValue$(nl),n.subscribeContextValue$(Mr)).pipe(ja(([l,c])=>l&&!c),LC(nBe)),!1,!0,[nl]);_.useEffect(()=>t.onCommandExecuted(l=>{if(l.id===Ml.id||l.id===pd.id){const c=s();o(c)}}).dispose,[t]);function s(){const l=e.getCurrentUniverSheetInstance().getActiveSheet().getZoomRatio()*100||100;return Math.round(l)}function u(l){o(l);const c=e.getCurrentUniverSheetInstance(),d=c==null?void 0:c.getActiveSheet();if(d==null)return;const m=l/100;t.executeCommand(Y8.id,{unitId:c.getUnitId(),subUnitId:d.getSheetId(),zoomRatio:m})}return U.jsx(Pae,{disabled:a,min:K_[0],value:i,shortcuts:tBe,onChange:u})}function iBe(t){return U.jsx("section",{className:eBe.countBar,children:U.jsx(rBe,{})})}const oBe="univer-editor-container",aBe="univer-editor-input",hw={editorContainer:oBe,editorInput:aBe},X9=-1e3,pw={width:0,height:0,top:X9,left:X9},sBe=()=>{const[t,e]=_.useState({...pw}),n=_.useRef(null),r=Ct(Jn),i=Ct(o2);return _.useEffect(()=>{const o=n.current;if(!o)return;const a=r.currentRender$.pipe(PC(()=>{var s;const u=(s=r.getRenderById(Qr))==null?void 0:s.engine;return u==null||u.setContainer(o),i.state$})).subscribe(s=>{if(s==null)return;const{startX:u=X9,startY:l=X9,endX:c=0,endY:d=0,show:m=!1}=s;if(!m)e({...pw});else{e({width:c-u,height:d-l,left:u,top:l});const f=n.current;if(!f)return;const{left:h,top:p,width:v,height:g}=f.getBoundingClientRect();i.setRect({left:h,top:p,width:v,height:g})}});return()=>{a.unsubscribe()}},[]),_.useEffect(()=>{i.setFocus(!0)},[t]),U.jsx("div",{className:hw.editorContainer,style:{left:t.left,top:t.top,width:t.width,height:t.height},children:U.jsx("div",{className:hw.editorInput,ref:n})})},uBe="univer-formula-box",lBe="univer-name-ranges",cBe="univer-name-ranges-input",dBe="univer-formula-bar",mBe="univer-formula-icon",fBe="univer-formula-icon-wrapper",hBe="univer-icon-container",pBe="univer-icon-container-success",gBe="univer-formula-active",vBe="univer-icon-container-error",bBe="univer-formula-input",_Be="univer-formula-content",CBe="univer-arrow-container",Mi={formulaBox:uBe,nameRanges:lBe,nameRangesInput:cBe,formulaBar:dBe,formulaIcon:mBe,formulaIconWrapper:fBe,iconContainer:hBe,iconContainerSuccess:pBe,formulaActive:gBe,iconContainerError:vBe,formulaInput:bBe,formulaContent:_Be,arrowContainer:CBe};function SBe(){const[t,e]=_.useState(Mi.formulaGrey),[n,r]=_.useState(0),i=_.useRef(null),o=Ct(Jn),a=Ct(Bf),s=Ct(Oo);_.useEffect(()=>{const m=i.current;if(!m)return;const f=o.currentRender$.subscribe(p=>{var v;if(p!==qn)return;const g=(v=o.getRenderById(qn))==null?void 0:v.engine;g==null||g.setContainer(m)}),h=new ResizeObserver(()=>{const p=m.getBoundingClientRect();a.setPosition(p)});return h.observe(m),s.visible$.subscribe(p=>{e(p.visible?Mi.formulaActive:Mi.formulaGrey)}),()=>{h.unobserve(m),f.unsubscribe()}},[]);function u(){r(n===0?1:0),setTimeout(()=>{a.handleFoldBtnClick(n===1)},150)}function l(){s.isVisible().visible&&s.changeVisible({visible:!1,eventType:dr.Keyboard,keycode:Ge.ESC})}function c(){s.isVisible().visible&&s.changeVisible({visible:!1,eventType:dr.PointerDown})}function d(){a.handleFxBtnClick(!0)}return U.jsxs("div",{className:Mi.formulaBox,style:{height:n===0?"28px":"82px"},children:[U.jsx("div",{className:Mi.nameRanges,children:U.jsx("div",{className:Mi.nameRangesInput})}),U.jsxs("div",{className:Mi.formulaBar,children:[U.jsx("div",{className:Mi.formulaIcon,children:U.jsxs("div",{className:Mi.formulaIconWrapper,children:[U.jsx("span",{className:Ci(Mi.iconContainer,Mi.iconContainerError,t),onClick:l,children:U.jsx(dxe,{})}),U.jsx("span",{className:Ci(Mi.iconContainer,Mi.iconContainerSuccess,t),onClick:c,children:U.jsx(W9,{})}),U.jsx("span",{className:Mi.iconContainer,onClick:d,children:U.jsx(bxe,{})})]})}),U.jsxs("div",{className:Mi.formulaInput,children:[U.jsx("div",{onContextMenu:m=>m.preventDefault(),className:Mi.formulaContent,ref:i}),U.jsx("div",{className:Mi.arrowContainer,onClick:u,children:n===0?U.jsx(GT,{}):U.jsx(GT,{style:{transform:"rotateZ(180deg)"}})})]})]})]})}const EBe="univer-operate-container",yBe="univer-auto-fill-popup-menu",DBe="univer-auto-fill-popup-menu-item",RBe="univer-auto-fill-popup-menu-item-icon",IBe="univer-auto-fill-popup-menu-item-title",ABe="univer-auto-fill-popup-menu-item-hide",TBe="univer-btn-container",wBe="univer-btn-container-expand",tc={operateContainer:EBe,autoFillPopupMenu:yBe,autoFillPopupMenuItem:DBe,autoFillPopupMenuItemIcon:RBe,autoFillPopupMenuItemTitle:IBe,autoFillPopupMenuItemHide:ABe,btnContainer:TBe,btnContainerExpand:wBe},LBe=()=>{const[,t]=_.useState({});return _.useCallback(()=>t(e=>!e),[])},OBe=()=>{var t;const e=Ct(se),n=Ct(Dr),r=Ct(ae),i=Ct(Jn),o=Ct(Hi),a=Ct(vd),s=Ct(Gt),[u,l]=_.useState([]),[c,d]=_.useState(!1),[m,f]=_.useState({row:-1,col:-1}),[h,p]=_.useState(tr.SERIES),[v,g]=_.useState(!1),b=()=>{g(!0)},C=()=>{g(!1)},S=LBe(),E=pa(r,i);if(E==null)return null;const{scene:y}=E;if(_.useEffect(()=>{const O=[v1.id,C7.id,Ml.id,Us.id,qa.id];return e.onCommandExecuted(M=>{M.id===U8.id&&S(),O.includes(M.id)&&f({row:-1,col:-1})}).dispose},[S,e]),_.useEffect(()=>je(a.menu$.subscribe(O=>{l(O.map(M=>({...M,index:O.indexOf(M)})))})).dispose,[a]),_.useEffect(()=>je(a.showMenu$.subscribe(O=>{const{source:M,target:V}=a.autoFillLocation||{source:null,target:null};if(O&&M&&V){const q=ht.union(M,V);f({row:q.endRow,col:q.endColumn})}})).dispose,[a]),_.useEffect(()=>je(a.applyType$.subscribe(O=>{p(O)})).dispose,[a]),_.useEffect(()=>{function O(){d(!1)}return document.addEventListener("wheel",O),()=>{document.removeEventListener("wheel",O)}},[c]),m.col<0||m.row<0)return null;const D=(t=n.getCurrent())==null?void 0:t.skeleton,R=o.getViewPort(),I=y==null?void 0:y.scaleX,T=y==null?void 0:y.scaleY,P=y==null?void 0:y.getScrollXY(R);if(!I||!y||!I||!T||!P)return null;const N=(D==null?void 0:D.getNoMergeCellPositionByIndex(m.row,m.col).endX)||0,B=(D==null?void 0:D.getNoMergeCellPositionByIndex(m.row,m.col).endY)||0,W=D==null?void 0:D.convertTransformToOffsetX(N,I,P),G=D==null?void 0:D.convertTransformToOffsetY(B,T,P);if(W==null||G==null)return null;const Q=O=>{d(O)},te=O=>{e.executeCommand(CH.id,{type:O.value})},X=c||v,x=u.filter(O=>!O.disable);return U.jsx("div",{onMouseEnter:b,onMouseLeave:C,style:{left:`${W+2}px`,top:`${G+2}px`,position:"absolute"},children:U.jsx(eu,{placement:"bottomLeft",trigger:["click"],overlay:U.jsx("ul",{className:tc.autoFillPopupMenu,children:x.map(O=>U.jsxs("li",{onClick:()=>te(O),className:tc.autoFillPopupMenuItem,children:[U.jsx("span",{className:tc.autoFillPopupMenuItemIcon,children:O.value===h&&U.jsx(W9,{style:{color:"rgb(var(--green-700, #409f11))"}})}),U.jsx("span",{className:tc.autoFillPopupMenuItemTitle,children:s.t(O.label)})]},O.index))}),visible:c,onVisibleChange:Q,children:U.jsxs("div",{className:Ci(tc.btnContainer,{[tc.btnContainerExpand]:c}),children:[U.jsx(uxe,{style:{color:"#35322B"},extend:{colorChannel1:"rgb(var(--green-700, #409f11))"}}),X&&U.jsx(rC,{style:{color:"#CCCCCC",fontSize:"8px",marginLeft:"8px"}})]})})})},PBe=()=>U.jsx("div",{className:tc.operateContainer,children:U.jsx(OBe,{})}),MBe="univer-sheet-bar",NBe="univer-sheet-bar-options",xBe="univer-sheet-bar-options-divider",t4={sheetBar:MBe,sheetBarOptions:NBe,sheetBarOptionsDivider:xBe},FBe="univer-sheet-bar-btn",$Be={sheetBarBtn:FBe};function W7(t){const{children:e,className:n,style:r,disabled:i=!1,onClick:o,...a}=t,s=u=>{if(i){u.preventDefault();return}o&&o(u)};return U.jsx("button",{className:$Be.sheetBarBtn,style:r,disabled:i,onClick:s,...a,children:e})}const kBe="univer-sheet-bar-menu",BBe="univer-sheet-bar-menu-item",UBe="univer-sheet-bar-menu-item-icon",VBe="univer-sheet-bar-menu-item-hide",HBe="univer-sheet-bar-menu-item-select",jBe="univer-sheet-bar-menu-item-label",yu={sheetBarMenu:kBe,sheetBarMenuItem:BBe,sheetBarMenuItemIcon:UBe,sheetBarMenuItemHide:VBe,sheetBarMenuItemSelect:HBe,sheetBarMenuItemLabel:jBe};function zBe(t){const{style:e}=t,[n,r]=_.useState([]),[i,o]=_.useState(!1),a=Ct(ae),s=Ct(se),u=Ct(Ed),l=a.getCurrentUniverSheetInstance(),c=p=>{const{sheetId:v}=p;v&&(p.hidden?s.executeCommand(aV.id,{value:v}):p.selected||s.executeCommand(pd.id,{unitId:l.getUnitId(),subUnitId:v}),o(!1))};_.useEffect(()=>{m();const p=new ws;return p.add(d()),p.add(u.registerSheetBarMenuHandler({handleSheetBarMenu:f})),()=>{p.dispose()}},[]);const d=()=>s.onCommandExecuted(p=>{switch(p.id){case Wo.id:case Qo.id:case Bm.id:case Eo.id:case v0.id:case Us.id:m();break}}),m=()=>{const p=l.getSheets(),v=l.getActiveSheet(),g=p.map((b,C)=>({label:b.getName(),index:`${C}`,sheetId:b.getSheetId(),hidden:b.isSheetHidden()===we.TRUE,selected:v===b}));r(g)};function f(){o(!0)}const h=p=>{o(p)};return U.jsx(eu,{placement:"topLeft",trigger:["click"],overlay:U.jsx("ul",{className:yu.sheetBarMenu,style:{...e},children:n.map(p=>U.jsxs("li",{onClick:()=>c(p),className:p.selected?`${yu.sheetBarMenuItem} ${yu.sheetBarMenuItemSelect}`:p.hidden?`${yu.sheetBarMenuItem} ${yu.sheetBarMenuItemHide}`:yu.sheetBarMenuItem,children:[U.jsx("span",{className:yu.sheetBarMenuItemIcon,children:p.selected?U.jsx(W9,{}):p.hidden?U.jsx(gxe,{}):U.jsx(W9,{})}),U.jsx("span",{className:yu.sheetBarMenuItemLabel,children:p.label})]},p.index))}),visible:i,onVisibleChange:h,children:U.jsx(W7,{children:U.jsx(fxe,{})})})}const WBe="univer-slide-tab-bar-container",YBe="univer-slide-tab-bar",XBe="univer-slide-tab-item",qBe="univer-slide-tab-active",GBe="univer-slide-tab-span",KBe="univer-slide-tab-span-edit",ZBe="univer-slide-tab-item-dropdown",wa={slideTabBarContainer:WBe,slideTabBar:YBe,slideTabItem:XBe,slideTabActive:qBe,slideTabSpan:GBe,slideTabSpanEdit:KBe,slideTabItemDropdown:ZBe};function QBe(t){const{sheetId:e,label:n,color:r,selected:i}=t,[o,a]=_.useState(i),s=Ct(_i);_.useEffect(()=>{a(i)},[i]);const u=l=>{const c=s.getCurrentTheme(),d=c.textColor,m=c.colorWhite;return new Xo(l).isDark()?m:d};return U.jsx("div",{"data-id":e,className:o?`${wa.slideTabActive} ${wa.slideTabItem}`:wa.slideTabItem,style:{backgroundColor:!o&&r?r:"",color:!o&&r?u(r):"",boxShadow:o&&r?`0px 0px 8px rgba(0, 0, 0, 0.08), inset 0px -2px 0px 0px ${r}`:""},children:U.jsx("span",{className:wa.slideTabSpan,children:n})},e)}const JBe={easeOutStrong(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},backOut(t,e,n,r,i){return typeof i>"u"&&(i=.7),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e}},eUe={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(t){},success(t){},cancel(t){},complete(t){}};class tUe{constructor(e){H(this,"_config"),H(this,"_status",0),H(this,"_start",0),H(this,"_handle",0),H(this,"_delayHandle",null),this._config={...eUe,...e},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}static success(...e){let n=0;return new Promise(r=>{for(let i=0;i<e.length;i++){const o=e[i],a=o._config,s=a.success;a.loop||(a.success=u=>{n++,s&&s.call(o,u),n===e.length&&r()})}})}request(){this._config.delay===0?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout(()=>{this._status=0,this._start=Date.now(),this._fakeHandle()},this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}_fakeHandle(){let e=Date.now()-this._start;e=e>=this._config.duration?this._config.duration:e;const n=JBe[this._config.type](e,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);if(this._config.receive(n),this._status===1){this._config.cancel(n),this._config.complete(n);return}if(e===this._config.duration){this._config.success(n),this._config.complete(n);return}this._handle=requestAnimationFrame(()=>{this._fakeHandle()})}}let Zg=class Y7{constructor(e,n){H(this,"_slideTabItem"),H(this,"_animate"),H(this,"_midline",0),H(this,"_translateX"),H(this,"_scrollbar"),H(this,"_slideTabBar"),H(this,"_editMode"),H(this,"_placeholder"),this._slideTabItem=e,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=n,this._placeholder=null,this._scrollbar=n.getScrollbar(),this.update()}static midline(e){return e.getBoundingRect().x+e.getBoundingRect().width/2}static leftLine(e){return e.getBoundingRect().x}static rightLine(e){return e.getBoundingRect().x+e.getBoundingRect().width}static make(e,n){const r=[];return e.forEach(i=>r.push(new Y7(i,n))),r}getSlideTabItem(){return this._slideTabItem}getEditor(){return this._slideTabItem.querySelector("span")}focus(){var e;(e=this.getEditor())==null||e.focus()}selectAll(){const e=this.getEditor();e&&X7.keepSelectAll(e)}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}translateX(e){return this._translateX=e,this._slideTabItem.style.transform=`translateX(${e}px)`,this.getTranslateXDirection()}setEditor(e){let n=!0;if(this._editMode===!1){const r=this._slideTabItem.querySelector("span"),i=l=>{if(!this.nameCheck()){if(this._editMode=!1,r&&(r.removeAttribute("contentEditable"),r.removeEventListener("blur",i),r.removeEventListener("compositionstart",a),r.removeEventListener("compositionend",s),r.removeEventListener("input",u),r.removeEventListener("keydown",o),r.classList.remove(this._slideTabBar.getConfig().slideTabBarSpanEditClassName)),this._slideTabBar.removeListener(),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName){const c=(r==null?void 0:r.innerText)||"",d=this.getId();this._slideTabBar.getConfig().onChangeName(d,c)}e&&e(l)}};let o=l=>{r&&(l.stopPropagation(),l.key==="Enter"&&r.blur())};const a=l=>{n=!1},s=l=>{n=!0},u=l=>{if(!r)return;const c=50;setTimeout(()=>{if(n){const d=r.innerText;d.length>c&&(r.innerText=d.substring(0,c),X7.keepLastIndex(r))}},0)};r&&(r.setAttribute("contentEditable","true"),r.addEventListener("blur",i),r.addEventListener("compositionstart",a),r.addEventListener("compositionend",s),r.addEventListener("input",u),r.addEventListener("keydown",o),r.classList.add(this._slideTabBar.getConfig().slideTabBarSpanEditClassName),this._editMode=!0,X7.keepSelectAll(r))}}nameCheck(){const e=this._slideTabItem.querySelector("span");if(!e)return!1;const n=e.innerText;return this._slideTabBar.getConfig().onNameCheckAlert(n)}animate(){return{translateX:e=>{this._translateX!==e&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new tUe({begin:this._translateX,end:e,receive:n=>{this._slideTabItem.style.transform=`translateX(${n}px)`}}),this._translateX=e,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(e){this._slideTabItem.after(e._slideTabItem||e)}update(){this._midline=Y7.midline(this)}disableFixed(){if(this._placeholder){const e=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("background"),this._slideTabItem.style.removeProperty("padding"),this._slideTabItem.style.removeProperty("box-sizing"),this._slideTabItem.style.removeProperty("font-size"),this._slideTabItem.style.removeProperty("font-family"),this._slideTabItem.style.removeProperty("font-weight"),this._slideTabItem.style.removeProperty("color"),this._slideTabItem.style.removeProperty("border-radius"),this._placeholder.after(this._slideTabItem),e.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const e=document.createElement("div"),n=this.getBoundingRect(),r=getComputedStyle(this._slideTabItem),i=this._slideTabItem.querySelector("span");if(this._placeholder=e,this._placeholder.style.width=`${n.width}px`,this._placeholder.style.height=`${n.height}px`,this._placeholder.style.flexShrink="0",this._placeholder.style.margin=r.margin,this._slideTabItem.style.background=r.background,i){const o=getComputedStyle(i).padding;this._slideTabItem.style.padding=o}this._slideTabItem.style.boxSizing=r.boxSizing,this._slideTabItem.style.fontSize=r.fontSize,this._slideTabItem.style.fontFamily=r.fontFamily,this._slideTabItem.style.fontWeight=r.fontWeight,this._slideTabItem.style.color=r.color,this._slideTabItem.style.borderRadius=r.borderRadius,this._slideTabItem.style.left=`${n.x-this.getScrollbar().getScrollX()}px`,this._slideTabItem.style.top=`${n.y}px`,this._slideTabItem.style.width=`${n.width}px`,this._slideTabItem.style.height=`${n.height}px`,this._slideTabItem.style.position="fixed",this._slideTabItem.after(e),document.body.appendChild(this._slideTabItem)}addEventListener(e,n,r){this._slideTabItem.addEventListener(e,n,r)}removeEventListener(e,n,r){this._slideTabItem.removeEventListener(e,n,r)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const e=this._slideTabItem.getBoundingClientRect();return e.x+=this._scrollbar.getScrollX(),e}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const e=Y7.midline(this);return e>this._midline?1:e<this._midline?-1:0}equals(e){return e&&e._slideTabItem===this._slideTabItem}getId(){return this._slideTabItem.dataset.id||""}};class nUe{constructor(e){H(this,"_slideTabBar"),H(this,"_scrollX");const n=e.primeval();this._scrollX=n.scrollLeft,this._slideTabBar=e}scrollX(e){const n=this._slideTabBar.primeval();n.scrollLeft=e,this._scrollX=n.scrollLeft}scrollRight(){const e=this._slideTabBar.primeval();e.scrollLeft=e.scrollWidth,this._scrollX=e.scrollLeft}getScrollX(){return this._scrollX}}const lC=class cC{constructor(e){H(this,"_activeTabItemIndex",0),H(this,"_slideTabBar"),H(this,"_slideTabItems",[]),H(this,"_config"),H(this,"_downActionX",0),H(this,"_moveActionX",0),H(this,"_compareIndex",0),H(this,"_activeTabItem",null),H(this,"_moveAction"),H(this,"_upAction"),H(this,"_downAction"),H(this,"_wheelAction"),H(this,"_scrollIncremental",0),H(this,"_compareDirection",0),H(this,"_autoScrollTime",null),H(this,"_slideScrollbar"),H(this,"_longPressTimer",null),H(this,"_leftBoundingLine",0),H(this,"_rightBoundingLine",0),H(this,"_leftMoveX",0),H(this,"_rightMoveX",0);var n;if(e.slideTabBarContainer==null)throw new Error("not found slide-tab-bar root element");const r=e.slideTabBarContainer.querySelector(`.${(n=e.slideTabBarClassName)!=null?n:"slide-tab-bar"}`);if(r==null)throw new Error("not found slide-tab-bar");this._slideTabBar=r,this._slideScrollbar=new nUe(this),this._config=e,this._initConfig();let i=0,o=0,a=0;this._downAction=s=>{var u,l,c,d,m,f;if((u=this._activeTabItem)!=null&&u.isEditMode())return;const h=(c=(l=s.target)==null?void 0:l.closest(`.${e.slideTabBarItemClassName}`))==null?void 0:c.getAttribute("data-id"),p=this._slideTabItems.findIndex(N=>N.getId()===h);if(h==null||p===-1)return;if(this._activeTabItemIndex!==p){(d=this._activeTabItem)==null||d.removeEventListener("pointermove",this._moveAction),(m=this._activeTabItem)==null||m.removeEventListener("pointerup",this._upAction),this.removeListener(),this._config.onChangeTab(s,h);return}if(this._compareIndex=p,this._downActionX=s.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[p],!this._activeTabItem){console.error("Not found active slide-tab-item in sheet bar");return}const v=this._activeTabItem.getSlideTabItem();v==null||v.setPointerCapture(s.pointerId),(f=this._activeTabItem)==null||f.addEventListener("pointerup",this._upAction);const{x:g,width:b}=this._activeTabItem.getBoundingRect(),{x:C,width:S}=this.getBoundingRect(),E=this._slideScrollbar.getScrollX();if(this._leftBoundingLine=this._downActionX-(g-E),this._rightBoundingLine=g-E+b-this._downActionX,this._leftMoveX=g-C-E,this._rightMoveX=C+S-(g+b)+E,s.button===2||this._hasEditItem())return;const{pageX:y,pageY:D}=s,R=Date.now(),I=R-a<=cC.DoubleClickDelay,T=Math.abs(y-i)<10,P=Math.abs(D-o)<10;I&&T&&P&&this._activeTabItem.setEditor(),i=y,o=D,a=R,this._longPressTimer=setTimeout(()=>{var N,B;(N=this._activeTabItem)==null||N.enableFixed(),this._startAutoScroll(),v&&(v.setPointerCapture(s.pointerId),v.style.cursor="move",(B=this._activeTabItem)==null||B.addEventListener("pointermove",this._moveAction))},cC.LongPressDelay)},this._upAction=s=>{var u,l,c;if(this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null),!this._activeTabItem)return;this._closeAutoScroll(),this._activeTabItem.disableFixed(),this.updateItems();const d=(u=this._activeTabItem)==null?void 0:u.getSlideTabItem();d&&(d.style.cursor="",d.releasePointerCapture(s.pointerId),(l=this._activeTabItem)==null||l.removeEventListener("pointermove",this._moveAction),(c=this._activeTabItem)==null||c.removeEventListener("pointerup",this._upAction),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&(this.removeListener(),this._config.onSlideEnd(s,this._compareIndex||0)),this._scrollIncremental=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0)},this._moveAction=s=>{this._activeTabItem&&(this._moveActionX=s.pageX-this._downActionX,this._moveActionX<=-this._leftMoveX?this._moveActionX=-this._leftMoveX:this._moveActionX>=this._rightMoveX&&(this._moveActionX=this._rightMoveX),this._scrollIncremental=0,this._scrollLeft(s),this._scrollRight(s))},this._wheelAction=s=>{this.setScroll(s.deltaY)},this.addListener()}static checkedSkipSlide(e){let n=e.target;for(;n!=null&&n!==document.body;){if(n.getAttribute("data-slide-skip"))return!0;n=n.parentElement}return!1}static keepLastIndex(e){setTimeout(()=>{const n=window.getSelection();n&&(n.selectAllChildren(e),n.collapseToEnd())})}static keepSelectAll(e){setTimeout(()=>{const n=window.getSelection();if(!n)return;const r=document.createRange();r.selectNodeContents(e),n.removeAllRanges(),n.addRange(r)})}update(e){this._config.currentIndex=e,this._initConfig(),this.removeListener(),this.addListener()}primeval(){return this._slideTabBar}updateItems(){for(let e=0;e<this._slideTabItems.length;e++)this._slideTabItems[e].animate().cancel(),this._slideTabItems[e].translateX(0),this._slideTabItems[e].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}getActiveItem(){return this._activeTabItem}isLeftEnd(){return this._slideTabBar.scrollLeft===0}isRightEnd(){const e=this._slideTabBar.parentElement;return e?this._slideTabBar.scrollWidth-e.clientWidth===this._slideTabBar.scrollLeft:!1}addListener(){this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.addEventListener("pointerdown",this._downAction)})}removeListener(){this._slideTabBar.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.removeEventListener("pointerdown",this._downAction)})}setScroll(e){if(this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e),e>0){const n=this.calculateLeftScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}else if(e<0){const n=this.calculateRightScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}flipPage(e){if(e>0){const n=this.calculateLeftScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}else if(e<0){const n=this.calculateRightScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+n)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}calculateLeftScrollX(e){let n=0;const r=4;return this._slideTabItems.some(i=>{const o=this._slideTabBar.getBoundingClientRect(),a=o.left+o.width,s=i.getSlideTabItem().getBoundingClientRect(),u=s.left,l=s.width;return u<a&&u+l+r*2>a?(n=e?u-o.left-r:u+l-a+r,!0):!1}),n}calculateRightScrollX(e){let n=0;const r=4;return this._slideTabItems.some(i=>{const o=this._slideTabBar.getBoundingClientRect(),a=o.left,s=i.getSlideTabItem().getBoundingClientRect(),u=s.left,l=s.width;return u-r*2<a&&u+l>a?(n=e?u+l-o.left-o.width+r:u-a-r,!0):!1}),n}destroy(){this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=[],this._activeTabItem=null,this.removeListener()}_hasEditItem(){for(let e=0;e<this._slideTabItems.length;e++)if(this._slideTabItems[e].isEditMode())return!0;return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break}case 0:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break}case-1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft();break}}this._autoScrollTime=requestAnimationFrame(()=>{this._autoScrollFrame()})}_startAutoScroll(){this._autoScrollTime==null&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(e){const n=this.getBoundingRect(),r=e.pageX-n.x;r<this._leftBoundingLine&&(this._scrollIncremental=-Math.min(Math.abs(r-this._leftBoundingLine)*.1,50))}_scrollRight(e){const n=this.getBoundingRect(),r=e.pageX-n.x;r>n.width-this._rightBoundingLine&&(this._scrollIncremental=Math.min(Math.abs(r-(n.width-this._rightBoundingLine))*.1,50))}_sortedItems(){if(this._activeTabItem!=null&&this._activeTabItemIndex!=null&&this._compareIndex!=null&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let e=0;e<this._slideTabItems.length;e++){const n=this._slideTabItems[e],r=this._slideTabItems[e+1];r&&n.after(r)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){const e=this._slideTabItems.findIndex(o=>o.equals(this._activeTabItem)),n=this._slideTabItems.length,r=[];for(let o=0;o<e&&!(o>=e);o++)r.push(this._slideTabItems[o]);for(let o=e+1;o<n;o++)this._slideTabItems[o].animate().translateX(0);let i=!0;for(let o=r.length-1;o>=0;o--){const a=r[o];Zg.leftLine(this._activeTabItem)<a.getMidLine()?(a.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=o,i=!1):(a.animate().translateX(0),i&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){const e=this._slideTabItems.findIndex(o=>o.equals(this._activeTabItem)),n=this._slideTabItems.length,r=[];for(let o=e+1;o<n;o++)r.push(this._slideTabItems[o]);for(let o=0;o<e;o++)this._slideTabItems[o].animate().translateX(0);let i=!0;for(let o=0;o<r.length;o++){const a=r[o];Zg.rightLine(this._activeTabItem)>a.getMidLine()?(a.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=e+o+1,i=!1):(a.animate().translateX(0),i&&(this._compareIndex=this._activeTabItemIndex))}}}_initConfig(){var e;const n=this._slideTabBar.querySelectorAll(`.${(e=this._config.slideTabBarItemClassName)!=null?e:"slide-tab-item"}`);this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=Zg.make(n,this),this._activeTabItemIndex=this._config.currentIndex,this._activeTabItem=this._slideTabItems[this._activeTabItemIndex]}};H(lC,"LongPressDelay",500),H(lC,"DoubleClickDelay",300);let X7=lC;function rUe(){const[t,e]=_.useState([]),[n,r]=_.useState(""),[i,o]=_.useState(""),[a,s]=_.useState(!1),[u,l]=_.useState([0,0]),c=_.useRef({slideTabBar:null}),d=_.useRef(null),m=Ct(ae),f=Ct(se),h=Ct(Ed),p=Ct(Gt),v=Ct(Ca),g=Ct(Hi),b=Ct(Oo),C=gf(),S=m.getCurrentUniverSheetInstance();_.useEffect(()=>{N();const M=E(),V=P(),q=[B(),W(),G(),Q()];return()=>{V.dispose(),M.destroy(),q.forEach(ie=>ie.unsubscribe())}},[]),_.useEffect(()=>{t.length>0&&T()},[t]);const E=()=>{const M=new X7({slideTabBarClassName:wa.slideTabBar,slideTabBarItemActiveClassName:wa.slideTabActive,slideTabBarItemClassName:wa.slideTabItem,slideTabBarSpanEditClassName:wa.slideTabSpanEdit,slideTabBarItemAutoSort:!0,slideTabBarContainer:d.current,currentIndex:0,onChangeName:(V,q)=>{f.executeCommand(F8.id,{subUnitId:V,name:q})},onSlideEnd:(V,q)=>{f.executeCommand(nV.id,{order:q})},onChangeTab:(V,q)=>{f.executeCommand(pd.id,{subUnitId:q,unitId:S.getUnitId()}).then(()=>{V.button===2&&O(!0)}),setTimeout(()=>{C.get(To).focus()},0)},onScroll:V=>{h.setScroll(V)},onNameCheckAlert:V=>y(V)||D(V)});return c.current.slideTabBar=M,x(M),M},y=M=>{if(M.trim()===""){const V="sheetNameEmptyAlert";return v.open({id:V,title:{title:p.t("sheetConfig.sheetNameErrorTitle")},children:{title:p.t("sheetConfig.sheetNameCannotIsEmptyError")},cancelText:p.t("button.cancel"),confirmText:p.t("button.confirm"),onClose(){R(),v.close(V)},onConfirm(){R(),v.close(V)}}),!0}return!1},D=M=>{const V=m.getCurrentUniverSheetInstance();if(V.getActiveSheet().getName()===M)return!1;const q=V.checkSheetName(M);if(q){const ie="sheetNameRepeatAlert";v.open({id:ie,title:{title:p.t("sheetConfig.sheetNameErrorTitle")},children:{title:p.t("sheetConfig.sheetNameAlreadyExistsError")},cancelText:p.t("button.cancel"),confirmText:p.t("button.confirm"),onClose(){v.close(ie),R()},onConfirm(){v.close(ie),R()}})}return q},R=()=>{g.endSelection(),setTimeout(()=>{var M;const V=(M=c.current.slideTabBar)==null?void 0:M.getActiveItem();V&&(V.focus(),V.selectAll())},0)},I=()=>{var M,V;(V=(M=c.current.slideTabBar)==null?void 0:M.getActiveItem())==null||V.setEditor()},T=()=>{var M;const V=t.findIndex(q=>q.selected);(M=c.current.slideTabBar)==null||M.update(V)},P=()=>f.onCommandExecuted(M=>{switch(M.id){case K6.id:case Wo.id:case Qo.id:case Bm.id:case Eo.id:case v0.id:case Us.id:N();break}}),N=()=>{const M=S.getActiveSheet().getSheetId();r(M);const V=S.getSheets(),q=S.getActiveSheet(),ie=V.filter(ce=>!ce.isSheetHidden()).map((ce,pe)=>{var oe;return{sheetId:ce.getSheetId(),label:ce.getName(),index:pe,selected:q===ce,color:(oe=ce.getTabColor())!=null?oe:void 0}});e(ie)},B=()=>h.scroll$.subscribe(M=>{te(M)}),W=()=>h.scrollX$.subscribe(M=>{var V;(V=c.current.slideTabBar)==null||V.flipPage(M)}),G=()=>h.renameId$.subscribe(()=>{I()}),Q=()=>h.addSheet$.subscribe(()=>{var M;(M=c.current.slideTabBar)==null||M.getScrollbar().scrollRight()}),te=M=>{const{leftEnd:V,rightEnd:q}=M;let ie="";V&&q?ie="":V&&!q?ie="inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!V&&q?ie="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!V&&!q&&(ie="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)"),o(ie)},X=M=>{h.setScroll({leftEnd:M.isLeftEnd(),rightEnd:M.isRightEnd()})},x=M=>{var V;const q=(V=d.current)==null?void 0:V.querySelector(`.${wa.slideTabBar}`);q&&new ResizeObserver(()=>{X(M)}).observe(q)},O=M=>{var V,q,ie,ce,pe;if(!b.isForceKeepVisible()){if(M){const{left:oe}=(q=(V=d.current)==null?void 0:V.getBoundingClientRect())!=null?q:{},{left:he}=(pe=(ce=(ie=c.current.slideTabBar)==null?void 0:ie.getActiveItem())==null?void 0:ce.getSlideTabItem().getBoundingClientRect())!=null?pe:{};oe!==void 0&&he!==void 0&&l([he-oe,0])}s(M)}};return U.jsx(eu,{className:wa.slideTabItemDropdown,visible:a,align:{offset:u},trigger:["contextMenu"],overlay:U.jsx(E9,{menuType:bi.SHEET_BAR,onOptionSelect:M=>{const{label:V,value:q}=M;f.executeCommand(V,{value:q,subUnitId:n}),s(!1)}}),onVisibleChange:O,children:U.jsx("div",{className:wa.slideTabBarContainer,ref:d,children:U.jsx("div",{className:wa.slideTabBar,style:{boxShadow:i},children:t.map(M=>_.createElement(QBe,{...M,key:M.sheetId,selected:n===M.sheetId}))})})})}const gw=100,iUe=()=>{const[t,e]=_.useState(!0),[n,r]=_.useState(!0),i=Ct(se),o=Ct(Ed);_.useEffect(()=>{const c=o.scroll$.subscribe(d=>{a(d)});return()=>{c.unsubscribe()}},[]);const a=c=>{const{leftEnd:d,rightEnd:m}=c;e(d),r(m)},s=()=>{i.executeCommand(PU.id),setTimeout(()=>{o.setAddSheet(0)},0)},u=()=>{o.setScrollX(-gw)},l=()=>{o.setScrollX(gw)};return U.jsxs("div",{className:t4.sheetBar,children:[U.jsxs("div",{className:t4.sheetBarOptions,children:[U.jsx(W7,{onClick:s,children:U.jsx(Cxe,{})}),U.jsx(zBe,{})]}),U.jsx(rUe,{}),(!t||!n)&&U.jsxs("div",{className:`${t4.sheetBarOptions} ${t4.sheetBarOptionsDivider}`,children:[U.jsx(W7,{disabled:t,onClick:u,children:U.jsx(KT,{style:{transform:"rotateZ(180deg)"}})}),U.jsx(W7,{disabled:n,onClick:l,children:U.jsx(KT,{})})]})]})};class oUe{constructor(){H(this,"_functions",[{func:Oe.MAX,filter:e=>{var n,r,i,o;return((r=(n=e.values.find(a=>a.func===Oe.COUNTA))==null?void 0:n.value)!=null?r:0)>1&&((o=(i=e.values.find(a=>a.func===Oe.COUNT))==null?void 0:i.value)!=null?o:0)>0}},{func:Oe.MIN,filter:e=>{var n,r,i,o;return((r=(n=e.values.find(a=>a.func===Oe.COUNTA))==null?void 0:n.value)!=null?r:0)>1&&((o=(i=e.values.find(a=>a.func===Oe.COUNT))==null?void 0:i.value)!=null?o:0)>0}},{func:gt.SUM,filter:e=>{var n,r,i,o;return((r=(n=e.values.find(a=>a.func===Oe.COUNTA))==null?void 0:n.value)!=null?r:0)>1&&((o=(i=e.values.find(a=>a.func===Oe.COUNT))==null?void 0:i.value)!=null?o:0)>0}},{func:Oe.COUNTA,filter:e=>{var n,r;return((r=(n=e.values.find(i=>i.func===Oe.COUNTA))==null?void 0:n.value)!=null?r:0)>1}},{func:Oe.COUNT,filter:e=>{var n,r,i,o;return((r=(n=e.values.find(a=>a.func===Oe.COUNTA))==null?void 0:n.value)!=null?r:0)>1&&((o=(i=e.values.find(a=>a.func===Oe.COUNT))==null?void 0:i.value)!=null?o:0)>0}},{func:Oe.AVERAGE,filter:e=>{var n,r,i,o;return((r=(n=e.values.find(a=>a.func===Oe.COUNTA))==null?void 0:n.value)!=null?r:0)>1&&((o=(i=e.values.find(a=>a.func===Oe.COUNT))==null?void 0:i.value)!=null?o:0)>0}}]),H(this,"_state$",new dn(null)),H(this,"state$",this._state$.asObservable())}dispose(){this._state$.complete()}setState(e){var n;const r={values:[],pattern:null};e==null||e.values.forEach(i=>{const o=this._functions.find(a=>a.func===i.func);o&&(o.filter===void 0||o.filter(e))&&r.values.push(i)}),r.pattern=(n=e==null?void 0:e.pattern)!=null?n:null,this._state$.next(r)}getState(){return this._state$.getValue()}getFunctions(){return this._functions}addFunctions(e){this._functions.push(...e)}}const Iy=ln("univer.sheet-status-bar.service"),aUe="univer-status-bar",sUe="univer-single-mode",uUe="univer-status-bar-div",lUe="univer-statistic-list",cUe="univer-statistic-list-column",dUe="univer-statistic-item",mUe="univer-statistic-picker",fUe="univer-statistic-picker-item",hUe="univer-statistic-more",k2={statusBar:aUe,singleMode:sUe,statusBarDiv:uUe,statisticList:lUe,statisticListColumn:cUe,statisticItem:dUe,statisticPicker:mUe,statisticPickerItem:fUe,statisticMore:hUe},pUe=[gt.SUM,Oe.AVERAGE,Oe.MIN,Oe.MAX],vw={[gt.SUM]:"statusbar.sum",[Oe.AVERAGE]:"statusbar.average",[Oe.MIN]:"statusbar.min",[Oe.MAX]:"statusbar.max",[Oe.COUNT]:"statusbar.count",[Oe.COUNTA]:"statusbar.countA",[fn.CONCATENATE]:"concatenate"},Qg=t=>{const e=Ct(Gt),n=Ct(Ef),r=Ct($s),i=gUe(t),o=async()=>{await r.writeText(t.value.toString()),n.show({type:q5.Success,content:e.t("statusbar.copied")})};return U.jsx(df,{title:e.t("statusbar.clickToCopy"),placement:"top",children:U.jsx("div",{className:k2.statisticItem,onClick:o,children:U.jsx("span",{children:`${e.t((vw==null?void 0:vw[t.name])||t.name)}: ${i}`})},t.name)})};function gUe(t){const{pattern:e,value:n}=t;return typeof n!="number"?"Invalid input":n>=1e8?n.toExponential(2):e&&pUe.includes(t.name)?Ns.format(e,n):n.toLocaleString()}const bw=800,vUe=3,bUe=()=>{const[t,e]=_.useState(window.innerWidth<bw),[n,r]=_.useState(!0),i=Ct(Iy),o=i.getFunctions().map((m,f)=>({name:m.func,value:0,show:!0,disable:!1,pattern:null})),[a,s]=_.useState(o),u=a.find(m=>m.show&&!m.disable),l=t&&u?[u]:a.filter(m=>m.show&&!m.disable);_.useEffect(()=>{const m=i.state$.subscribe(f=>{const h=f==null?void 0:f.values;if(!h||h.length===0)r(!1);else{r(!0);const p=a.map(v=>{var g;const b=h.find(C=>C.func===v.name);return b?(v.value=b.value,v.disable=!1):v.disable=!0,v.pattern=(g=f==null?void 0:f.pattern)!=null?g:null,v});s(p)}});return()=>{m.unsubscribe()}},[i]);const c=_Ue(()=>{const m=window.innerWidth<bw;t!==m&&e(m)},100);_.useEffect(()=>(window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}),[t]);let d=null;if(l.length>vUe){const m=[];l.forEach((f,h)=>{h%2===0&&m.push(l.slice(h,h+2))}),d=U.jsxs(U.Fragment,{children:[" ",m.map((f,h)=>U.jsxs("div",{className:k2.statisticListColumn,children:[(f==null?void 0:f[0])&&U.jsx(Qg,{...f==null?void 0:f[0]},f==null?void 0:f[0].name),(f==null?void 0:f[1])&&U.jsx(Qg,{...f==null?void 0:f[1]},f==null?void 0:f[1].name)]},`stat-col-${h}`))," "]})}else d=U.jsx(U.Fragment,{children:l.map(m=>U.jsx(Qg,{...m},m.name))});return n&&U.jsxs("div",{className:Ci(k2.statusBar,{[k2.singleMode]:t}),children:[U.jsx("div",{className:Ci(k2.statisticList),children:d}),U.jsx("div",{className:k2.statusBarDiv})]})};function _Ue(t,e){let n;return function(...r){const i=this,o=function(){n=null,t.apply(i,r)};clearTimeout(n),n=setTimeout(o,e)}}function CUe(){return U.jsxs("section",{className:pH.sheetContainer,"data-range-selector":!0,children:[U.jsx(iUe,{}),U.jsx(bUe,{}),U.jsx(iBe,{})]})}function SUe(){return U.jsx(U.Fragment,{children:U.jsx(SBe,{})})}function EUe(){return U.jsxs(U.Fragment,{children:[U.jsx(sBe,{}),U.jsx(PBe,{})]})}function yUe(t){const e=t.get(hl),n=ei(t);return{id:j_.id,icon:new Wt(r=>{const i="AllBorderSingle",o=t.get(hl),a=t.get(se).onCommandExecuted(s=>{var u;if(s.id!==j_.id)return;const{type:l}=o.getBorderInfo(),c=AH.find(m=>m.value===l),d=(u=c==null?void 0:c.icon)!=null?u:i;r.next(d)});return r.next(i),a.dispose}),group:Kt.TOOLBAR_FORMAT,tooltip:"toolbar.border.main",positions:[hn.TOOLBAR_START],type:pt.BUTTON_SELECTOR,selections:[{label:{name:IH,hoverable:!1},value$:e.borderInfo$}],value$:e.borderInfo$,hidden$:cr(t,or.SHEET),disabled$:n}}const X8="sheet.menu.clear-selection";function DUe(){return{id:X8,group:Kt.CONTEXT_MENU_FORMAT,type:pt.SUBITEMS,icon:"ClearFormat",title:"rightClick.clearSelection",positions:[hn.CONTEXT_MENU,bi.COL_HEADER_CONTEXT_MENU,bi.ROW_HEADER_CONTEXT_MENU]}}function RUe(){return{id:wf.id,type:pt.BUTTON,title:"rightClick.clearContent",positions:[X8]}}function IUe(){return{id:ll.id,type:pt.BUTTON,title:"rightClick.clearFormat",positions:[X8]}}function AUe(){return{id:Tf.id,type:pt.BUTTON,title:"rightClick.clearAll",positions:[X8]}}const Uf="sheet.menu.delete";function TUe(){return{id:Uf,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.SUBITEMS,title:"rightClick.delete",icon:"Reduce",positions:[hn.CONTEXT_MENU]}}function wUe(){return{id:EH.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,icon:"DeleteColumn",positions:[Uf,bi.COL_HEADER_CONTEXT_MENU],title:"rightClick.deleteSelectedColumn"}}function LUe(){return{id:SH.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,icon:"DeleteRow",positions:[Uf,bi.ROW_HEADER_CONTEXT_MENU],title:"rightClick.deleteSelectedRow"}}function OUe(){return{id:Ey.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,title:"rightClick.moveLeft",icon:"DeleteCellShiftLeft",positions:[Uf]}}function PUe(){return{id:yy.id,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.BUTTON,title:"rightClick.moveUp",icon:"DeleteCellShiftUp",positions:[Uf]}}const Ay="sheet.menu.col-insert";function MUe(){return{id:Ay,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.SUBITEMS,title:"rightClick.insert",icon:"Insert",positions:[bi.COL_HEADER_CONTEXT_MENU]}}const Ty="sheet.menu.row-insert";function NUe(){return{id:Ty,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.SUBITEMS,title:"rightClick.insert",icon:"Insert",positions:[bi.ROW_HEADER_CONTEXT_MENU]}}const Vf="sheet.menu.cell-insert";function xUe(){return{id:Vf,group:Kt.CONTEXT_MENU_LAYOUT,type:pt.SUBITEMS,title:"rightClick.insert",icon:"Insert",positions:[hn.CONTEXT_MENU]}}function FUe(t){const e=t.get(dt);return{id:AU.id,type:pt.BUTTON,title:"rightClick.insertRowBefore",icon:"InsertRowAbove",positions:[Ty,Vf],hidden$:new Wt(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function $Ue(t){const e=t.get(dt);return{id:TU.id,type:pt.BUTTON,positions:[Ty],title:"rightClick.insertRow",icon:"InsertRowBelow",hidden$:new Wt(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function kUe(t){const e=t.get(dt);return{id:LU.id,type:pt.BUTTON,positions:[Ay,Vf],title:"rightClick.insertColumnBefore",icon:"LeftInsertColumn",hidden$:new Wt(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function BUe(t){const e=t.get(dt);return{id:OU.id,type:pt.BUTTON,positions:[Ay],title:"rightClick.insertColumn",icon:"RightInsertColumn",hidden$:new Wt(n=>{const r=e.getSelections();n.next((r==null?void 0:r.length)!==1)})}}function UUe(){return{id:Ry.id,type:pt.BUTTON,title:"rightClick.moveRight",icon:"InsertCellShiftRight",positions:[Vf]}}function VUe(){return{id:Dy.id,type:pt.BUTTON,title:"rightClick.moveDown",icon:"InsertCellDown",positions:[Vf]}}function HUe(t){const e=ei(t);return{id:cu.id,icon:"MergeAllSingle",tooltip:"toolbar.mergeCell.main",positions:[hn.TOOLBAR_START],group:Kt.TOOLBAR_LAYOUT,type:pt.SUBITEMS,hidden$:cr(t,or.SHEET),disabled$:e}}function jUe(t){return{id:vH.id,type:pt.BUTTON,title:"merge.all",icon:"MergeAllSingle",positions:[cu.id]}}function zUe(t){return{id:bH.id,type:pt.BUTTON,title:"merge.vertical",icon:"VerticalIntegrationSingle",positions:[cu.id]}}function WUe(t){return{id:_H.id,type:pt.BUTTON,title:"merge.horizontal",icon:"HorizontalMergeSingle",positions:[cu.id]}}function YUe(t){return{id:$U.id,type:pt.BUTTON,title:"merge.cancel",icon:"CancelMergeSingle",positions:[cu.id]}}function XUe(t){const e=t.get(ae),n=t.get(se);return{id:yH.id,type:pt.BUTTON,positions:[bi.SHEET_BAR],title:"sheetConfig.delete",disabled$:new Wt(r=>{const i=n.onCommandExecuted(o=>{const a=o.id;if(a===Qo.id||a===Eo.id||a===Wo.id){const s=e.getCurrentUniverSheetInstance().getWorksheets(),u=Array.from(s.values()).filter(l=>l.getConfig().hidden===we.FALSE);r.next(u.length===1)}});return r.next(!1),i.dispose})}}function qUe(){return{id:vU.id,type:pt.BUTTON,positions:[bi.SHEET_BAR],title:"sheetConfig.copy"}}function GUe(){return{id:RH.id,type:pt.BUTTON,positions:[bi.SHEET_BAR],title:"sheetConfig.rename"}}function KUe(){return{id:QU.id,title:"sheetConfig.changeColor",positions:[bi.SHEET_BAR],type:pt.SELECTOR,selections:[{label:{name:z8,hoverable:!1}}]}}function ZUe(t){const e=t.get(ae),n=t.get(se);return{id:tV.id,type:pt.BUTTON,positions:[bi.SHEET_BAR],title:"sheetConfig.hide",disabled$:new Wt(r=>{const i=n.onCommandExecuted(o=>{const a=o.id;if(a===Qo.id||a===Eo.id||a===Wo.id){const s=e.getCurrentUniverSheetInstance().getWorksheets(),u=Array.from(s.values()).filter(l=>l.getConfig().hidden===we.FALSE);r.next(u.length===1)}});return r.next(!1),i.dispose})}}function QUe(t){const e=t.get(ae),n=t.get(se);return{id:DH.id,type:pt.BUTTON,positions:[bi.SHEET_BAR],title:"sheetConfig.unhide",disabled$:new Wt(r=>{const i=n.onCommandExecuted(o=>{const a=o.id;if(a===Qo.id||a===Eo.id||a===Wo.id){const s=e.getCurrentUniverSheetInstance().getWorksheets(),u=Array.from(s.values());r.next(u.length===1)}});return r.next(!1),i.dispose})}}const JUe={id:ey.id,preconditions:t=>ar(t),binding:Ge.Digit9|Yt.CTRL_COMMAND},eVe={id:QE.id,preconditions:t=>ar(t),binding:Ge.Digit0|Yt.CTRL_COMMAND|Yt.SHIFT},tVe={id:vo.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:Ge.ARROW_DOWN,priority:100,preconditions:ar,staticParameters:{direction:ye.DOWN}},nVe={id:vo.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:Ge.ARROW_UP,priority:100,preconditions:ar,staticParameters:{direction:ye.UP}},rVe={id:vo.id,description:"shortcut.sheet.select-left-cell",group:"3_sheet-view",binding:Ge.ARROW_LEFT,priority:100,preconditions:ar,staticParameters:{direction:ye.LEFT}},iVe={id:vo.id,description:"shortcut.sheet.select-right-cell",group:"3_sheet-view",binding:Ge.ARROW_RIGHT,priority:100,preconditions:ar,staticParameters:{direction:ye.RIGHT}},oVe={id:i2.id,description:"shortcut.sheet.select-next-cell",group:"3_sheet-view",binding:Ge.TAB,priority:100,preconditions:ar,staticParameters:{direction:ye.RIGHT,keycode:Ge.TAB}},aVe={id:i2.id,description:"shortcut.sheet.select-previous-cell",group:"3_sheet-view",binding:Ge.TAB|Yt.SHIFT,priority:100,preconditions:ar,staticParameters:{direction:ye.LEFT,keycode:Ge.TAB}},sVe={id:i2.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:Ge.ENTER,priority:100,preconditions:ar,staticParameters:{direction:ye.DOWN,keycode:Ge.ENTER}},uVe={id:i2.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:Ge.ENTER|Yt.SHIFT,priority:100,preconditions:ar,staticParameters:{direction:ye.UP,keycode:Ge.ENTER}},lVe={id:vo.id,description:"shortcut.sheet.select-below-value-cell",group:"3_sheet-view",binding:Ge.ARROW_DOWN|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.DOWN,jumpOver:xs.moveGap}},cVe={id:vo.id,description:"shortcut.sheet.select-up-value-cell",group:"3_sheet-view",binding:Ge.ARROW_UP|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.UP,jumpOver:xs.moveGap}},dVe={id:vo.id,description:"shortcut.sheet.select-left-value-cell",group:"3_sheet-view",binding:Ge.ARROW_LEFT|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.LEFT,jumpOver:xs.moveGap}},mVe={id:vo.id,description:"shortcut.sheet.select-right-value-cell",group:"3_sheet-view",binding:Ge.ARROW_RIGHT|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.RIGHT,jumpOver:xs.moveGap}},fVe={id:Fs.id,description:"shortcut.sheet.expand-selection-down",group:"3_sheet-view",binding:Ge.ARROW_DOWN|Yt.SHIFT,preconditions:ar,staticParameters:{direction:ye.DOWN}},hVe={id:Fs.id,description:"shortcut.sheet.expand-selection-up",group:"3_sheet-view",binding:Ge.ARROW_UP|Yt.SHIFT,preconditions:ar,staticParameters:{direction:ye.UP}},pVe={id:Fs.id,description:"shortcut.sheet.expand-selection-left",group:"3_sheet-view",binding:Ge.ARROW_LEFT|Yt.SHIFT,preconditions:ar,staticParameters:{direction:ye.LEFT}},gVe={id:Fs.id,description:"shortcut.sheet.expand-selection-right",group:"3_sheet-view",binding:Ge.ARROW_RIGHT|Yt.SHIFT,preconditions:ar,staticParameters:{direction:ye.RIGHT}},vVe={id:Fs.id,description:"shortcut.sheet.expand-selection-to-below-gap",group:"3_sheet-view",binding:Ge.ARROW_DOWN|Yt.SHIFT|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.DOWN,jumpOver:xs.moveGap}},bVe={id:Fs.id,description:"shortcut.sheet.expand-selection-to-up-gap",group:"3_sheet-view",binding:Ge.ARROW_UP|Yt.SHIFT|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.UP,jumpOver:xs.moveGap}},_Ve={id:Fs.id,description:"shortcut.sheet.expand-selection-to-left-gap",group:"3_sheet-view",binding:Ge.ARROW_LEFT|Yt.SHIFT|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.LEFT,jumpOver:xs.moveGap}},CVe={id:Fs.id,description:"shortcut.sheet.expand-selection-to-right-gap",group:"3_sheet-view",binding:Ge.ARROW_RIGHT|Yt.SHIFT|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{direction:ye.RIGHT,jumpOver:xs.moveGap}},SVe={id:$V.id,description:"shortcut.sheet.select-all",group:"3_sheet-view",binding:Ge.A|Yt.CTRL_COMMAND,preconditions:ar,staticParameters:{expandToGapFirst:!0,loop:!0}},EVe={id:hy.id,description:"shortcut.sheet.set-bold",group:"4_sheet-edit",preconditions:t=>ar(t),binding:Ge.B|Yt.CTRL_COMMAND},yVe={id:py.id,description:"shortcut.sheet.set-italic",group:"4_sheet-edit",preconditions:t=>ar(t),binding:Ge.I|Yt.CTRL_COMMAND},DVe={id:gy.id,description:"shortcut.sheet.set-underline",group:"4_sheet-edit",preconditions:t=>ar(t),binding:Ge.U|Yt.CTRL_COMMAND},RVe={id:vy.id,description:"shortcut.sheet.set-strike-through",group:"4_sheet-edit",preconditions:t=>ar(t),binding:Ge.X|Yt.SHIFT|Yt.CTRL_COMMAND},IVe={id:wf.id,preconditions:t=>ar(t),binding:Ge.DELETE,mac:Ge.BACKSPACE},AVe={id:W8.id,description:"shortcut.sheet.zoom-in",binding:Ge.EQUAL|Yt.CTRL_COMMAND,group:"3_sheet-view",preconditions:ar,priority:1,staticParameters:{delta:.2}},TVe={id:e5.id,binding:Ge.EQUAL|Yt.CTRL_COMMAND},wVe={id:W8.id,description:"shortcut.sheet.zoom-out",binding:Ge.MINUS|Yt.CTRL_COMMAND,group:"3_sheet-view",preconditions:ar,priority:1,staticParameters:{delta:-.2}},LVe={id:e5.id,binding:Ge.MINUS|Yt.CTRL_COMMAND},OVe={id:W8.id,description:"shortcut.sheet.reset-zoom",binding:Ge.Digit0|Yt.CTRL_COMMAND,preconditions:ar,group:"3_sheet-view",priority:1,staticParameters:{reset:!0}},PVe={id:e5.id,binding:Ge.Digit0|Yt.CTRL_COMMAND};var MVe=Object.defineProperty,NVe=Object.getOwnPropertyDescriptor,xVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?NVe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&MVe(e,n,i),i},w2=(t,e)=>(n,r)=>e(n,r,t);let q7=class extends We{constructor(e,n,r,i,o,a){super(),this._injector=e,this._componentManager=n,this._commandService=r,this._shortcutService=i,this._menuService=o,this._uiController=a,this._init()}_initCustomComponents(){const e=this._componentManager;this.disposeWithMe(e.register(Cy,eFe)),this.disposeWithMe(e.register(IH,Qke)),this.disposeWithMe(e.register(z8,$S)),this.disposeWithMe(e.register(dH,yk)),this.disposeWithMe(e.register(mH,Dk)),this.disposeWithMe(e.register(fH,Rk))}_initCommands(){[vH,cu,_H,bH,W8,Fs,vo,i2,RH,yH,SH,EH,eH,tH,_0,$V,gH,V8,jU,z9,v1,hy,py,gy,vy,zxe,Wxe,nH,rH,Y9,zU,YU,XU,qU,by,aH,_y,sH,U8,N7,j8,uH,lH,cH,WU,Y8,Ml,DH,CH,Dy,yy,Ry,Ey].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))})}_initMenus(){[gFe,vFe,bFe,_Fe,CFe,SFe,EFe,RUe,IUe,AUe,DUe,MUe,NUe,xUe,FUe,$Ue,kUe,BUe,LUe,LFe,PFe,OFe,MFe,wUe,NFe,yFe,xFe,TUe,OUe,PUe,UUe,VUe,IFe,AFe,TFe,wFe,DFe,RFe,tFe,nFe,rFe,iFe,oFe,aFe,sFe,uFe,lFe,cFe,dFe,yUe,HUe,jUe,zUe,WUe,YUe,mFe,fFe,hFe,pFe,XUe,qUe,GUe,KUe,ZUe,QUe].forEach(e=>{this.disposeWithMe(this._menuService.addMenuItem(this._injector.invoke(e)))})}_initShortcuts(){[tVe,nVe,rVe,iVe,oVe,aVe,sVe,uVe,lVe,cVe,dVe,mVe,fVe,hVe,pVe,gVe,vVe,bVe,_Ve,CVe,SVe,AVe,wVe,OVe,PVe,TVe,LVe,EVe,yVe,DVe,RVe,IVe,...n$e(),r$e,i$e,a$e,s$e,u$e,o$e,JUe,eVe].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_initWorkbenchParts(){this.disposeWithMe(this._uiController.registerHeaderComponent(()=>H6(SUe,this._injector))),this.disposeWithMe(this._uiController.registerFooterComponent(()=>H6(CUe,this._injector))),this.disposeWithMe(this._uiController.registerContentComponent(()=>H6(EUe,this._injector)))}_init(){this._initCustomComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts()}};q7=xVe([yt(ot.Ready,q7),w2(0,K(wn)),w2(1,K(Jo)),w2(2,se),w2(3,lu),w2(4,S1),w2(5,F0)],q7);var FVe=Object.defineProperty,$Ve=Object.getOwnPropertyDescriptor,kVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?$Ve(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&FVe(e,n,i),i},Hl=(t,e)=>(n,r)=>e(n,r,t);let G7=class extends We{constructor(e,n,r,i,o,a,s){super(),H(this,"_calculateTimeout",-1),this._univerInstanceService=e,this._selectionManagerService=n,this._functionService=r,this._statusBarService=i,this._commandService=o,this._formulaDataModel=a,this._numfmtService=s,this._init()}_init(){this._registerSelectionListener()}_registerSelectionListener(){this.disposeWithMe(je(this._selectionManagerService.selectionMoving$.subscribe(e=>{var n;((n=this._selectionManagerService.getCurrent())==null?void 0:n.pluginName)===Nn&&e&&(clearTimeout(this._calculateTimeout),this._calculateTimeout=setTimeout(()=>{const r=e[e.length-1].primary;this._calculateSelection(e.map(i=>i.range),r)},100))}))),this.disposeWithMe(je(this._selectionManagerService.selectionMoveEnd$.pipe(LC(100)).subscribe(e=>{var n;if(((n=this._selectionManagerService.getCurrent())==null?void 0:n.pluginName)===Nn&&e){const r=e[e.length-1].primary;this._calculateSelection(e.map(i=>i.range),r)}}))),this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===Vt.id){const n=this._selectionManagerService.getSelections();n&&(clearTimeout(this._calculateTimeout),this._calculateTimeout=setTimeout(()=>{this._calculateSelection(n.map(r=>r.range))},100))}}))}_calculateSelection(e,n){var r;const i=this._univerInstanceService.getCurrentUniverSheetInstance(),o=i.getUnitId(),a=i.getActiveSheet().getSheetId(),s={},u=this._formulaDataModel.getArrayFormulaCellData();if(this._univerInstanceService.getCurrentUniverSheetInstance().getSheets().forEach(l=>{const c=l.getConfig();s[l.getSheetId()]={cellData:new Ye(c.cellData),rowCount:c.rowCount,columnCount:c.columnCount}}),e!=null&&e.length){const l=e.map(f=>new Fm(f,a,o));l.forEach(f=>{f.setUnitData({[o]:s}),u&&f.setArrayFormulaCellData(RB(u))});const c=this._statusBarService.getFunctions().map(f=>{const h=this._functionService.getExecutor(f.func);if(!h)return;const p=l.map(b=>b.toArrayValueObject(!1)),v=h==null?void 0:h.calculate(...p),g=v==null?void 0:v.getValue();if(g)return{func:f.func,value:g}});if(c.every(f=>f===void 0))return;let d=null;if(n){const{actualRow:f,actualColumn:h}=n;d=(r=this._numfmtService.getValue(o,a,f,h))==null?void 0:r.pattern}const m={values:c.filter(f=>f!==void 0),pattern:d};this._statusBarService.setState(m)}else this._statusBarService.setState(null)}_isSingleCell(e){return e.startRow===e.endRow&&e.startColumn===e.endColumn}};G7=kVe([yt(ot.Ready,G7),Hl(0,ae),Hl(1,K(dt)),Hl(2,Bs),Hl(3,Iy),Hl(4,se),Hl(5,K(Ai)),Hl(6,K(Ti))],G7);var BVe=Object.defineProperty,UVe=Object.getOwnPropertyDescriptor,VVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?UVe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&BVe(e,n,i),i},jl=(t,e)=>(n,r)=>e(n,r,t);let K7=class extends We{constructor(e,n,r,i,o,a,s){super(),this._sheetSkeletonManagerService=e,this._currentUniverService=n,this._commandService=r,this._renderManagerService=i,this._selectionRenderService=o,this._selectionManagerService=a,this._scrollManagerService=s,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._zoomEventBinding()}_zoomEventBinding(){var e;const n=(e=this._getSheetObject())==null?void 0:e.scene;n!=null&&(n.getViewport(Ft.VIEW_MAIN),this.disposeWithMe(je(n.onMouseWheelObserver.add((r,i)=>{if(!r.ctrlKey)return;const o=Math.abs(r.deltaX);let a=o<40?.2:o<80?.4:.2;a*=r.deltaY>0?-1:1,n.scaleX<1&&(a/=2);const s=this._currentUniverService.getCurrentUniverSheetInstance(),u=s.getActiveSheet(),l=u.getZoomRatio();let c=+Number.parseFloat(`${l+a}`).toFixed(1);c=c>=4?4:c<=.1?.1:c,this._commandService.executeCommand(Y8.id,{zoomRatio:Math.round(c*10)/10,unitId:s.getUnitId(),subUnitId:u.getSheetId()}),r.preventDefault()}))))}_skeletonListener(){this.disposeWithMe(je(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe(e=>{if(e==null)return;const n=this._currentUniverService.getCurrentUniverSheetInstance().getActiveSheet().getZoomRatio()||1;this._updateViewZoom(n)})))}_commandExecutedListener(){const e=[Ml.id];this.disposeWithMe(this._commandService.onCommandExecuted(n=>{if(e.includes(n.id)){const r=this._currentUniverService.getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=n.params,{unitId:a,subUnitId:s}=o;if(!(a===r.getUnitId()&&s===i.getSheetId()))return;const u=i.getConfig().zoomRatio||1;this._updateViewZoom(u)}}))}_updateViewZoom(e){const n=this._getSheetObject();n==null||n.scene.scale(e,e),n==null||n.spreadsheet.makeForceDirty()}_getSheetObject(){return pa(this._currentUniverService,this._renderManagerService)}};K7=VVe([yt(ot.Rendered,K7),jl(0,K(Dr)),jl(1,ae),jl(2,se),jl(3,Jn),jl(4,Hi),jl(5,K(dt)),jl(6,K(Pl))],K7);var HVe=Object.defineProperty,jVe=Object.getOwnPropertyDescriptor,zVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?jVe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&HVe(e,n,i),i},r6=(t,e)=>(n,r)=>e(n,r,t);let Z7=class extends Ro{constructor(e,n,r,i,o){super(),H(this,"_scene"),H(this,"_currentWorkbook"),H(this,"_loadedMap",new Set),H(this,"_isLoadedEditor",!1),H(this,"_fps$",new dn("")),H(this,"fps$",this._fps$.asObservable()),this._currentUniverService=e,this._commandService=n,this._renderManagerService=r,this._selectionRenderService=i,this._sheetSkeletonManagerService=o,this._currentUniverService.currentSheet$.subscribe(a=>{if(a==null)return;const s=a.getUnitId();this._loadedMap.has(s)||(this._currentWorkbook=a,this._addNewRender(),this._loadedMap.add(s))})}dispose(){this._fps$.complete()}_addNewRender(){const e=this._currentWorkbook,n=e.getUnitId(),r=e.getContainer(),i=e.getParentRenderUnitId();if(r!=null&&i!=null)throw new Error("container or parentRenderUnitId can only exist one");const o=r==null&&i!=null;o?this._renderManagerService.createRenderWithParent(n,i):this._renderManagerService.createRender(n);const a=this._renderManagerService.getRenderById(n);if(a==null)return;const{scene:s,engine:u}=a;s.openTransformer(),this._scene=s,s.addLayer(new Pm(s,[],0),new Pm(s,[],2)),a!=null&&this._addComponent(a),e.getShouldRenderLoopImmediately()&&!o&&u.runRenderLoop(()=>{s.render(),this._fps$.next(Math.round(u.getFps()).toString())}),this._renderManagerService.setCurrent(n)}_addComponent(e){const n=this._scene,r=this._currentWorkbook,i=r.getActiveSheet(),o=r.getUnitId(),a=i.getSheetId();this._addViewport(i);const s=new u_e(ho.MAIN),u=new a_e(ho.ROW),l=new zbe(ho.COLUMN),c=new cn(ho.LEFT_TOP,{zIndex:2,left:-1,top:-1,fill:"rgb(248, 249, 250)",stroke:"rgb(217, 217, 217)",strokeWidth:1});e.mainComponent=s,e.components.set(ho.MAIN,s),e.components.set(ho.ROW,u),e.components.set(ho.COLUMN,l),e.components.set(ho.LEFT_TOP,c),n.addObjects([s],$T),n.addObjects([u,l,c],El),n.enableLayerCache($T,El),this._sheetSkeletonManagerService.setCurrent({sheetId:a,unitId:o})}_addViewport(e){const n=this._scene;if(n==null)return;const{rowHeader:r,columnHeader:i}=e.getConfig(),o=new Gs(Ft.VIEW_MAIN,n,{left:r.width,top:i.height,bottom:0,right:0,isWheelPreventDefaultX:!0});return new Gs(Ft.VIEW_ROW_TOP,n,{active:!1,isWheelPreventDefaultX:!0}),new Gs(Ft.VIEW_ROW_BOTTOM,n,{left:0,top:i.height,bottom:0,width:r.width,isWheelPreventDefaultX:!0}),new Gs(Ft.VIEW_COLUMN_LEFT,n,{active:!1,isWheelPreventDefaultX:!0}),new Gs(Ft.VIEW_COLUMN_RIGHT,n,{left:r.width,top:0,height:i.height,right:0,isWheelPreventDefaultX:!0}),new Gs(Ft.VIEW_LEFT_TOP,n,{left:0,top:0,width:r.width,height:i.height,isWheelPreventDefaultX:!0}),new Gs(Ft.VIEW_MAIN_LEFT_TOP,n,{isWheelPreventDefaultX:!0,active:!1}),new Gs(Ft.VIEW_MAIN_LEFT,n,{isWheelPreventDefaultX:!0,active:!1}),new Gs(Ft.VIEW_MAIN_TOP,n,{isWheelPreventDefaultX:!0,active:!1}),n.onMouseWheelObserver.add((a,s)=>{if(a.ctrlKey)return;let u=0,l=0;const c=o.limitedScroll();if(a.inputIndex===kt.MouseWheelX){const d=Math.abs(a.deltaX);a.deltaX>0?u=d:u=-d,this._commandService.executeCommand(N7.id,{offsetX:u}),n.getParent().classType===qt.SCENE_VIEWER?c!=null&&c.isLimitedX||s.stopPropagation():o.isWheelPreventDefaultX?a.preventDefault():c!=null&&c.isLimitedX||a.preventDefault()}if(a.inputIndex===kt.MouseWheelY){let d=Math.abs(a.deltaY);a.shiftKey?(d*=3,a.deltaY>0?u=d:u=-d,this._commandService.executeCommand(N7.id,{offsetX:u}),n.getParent().classType===qt.SCENE_VIEWER?c!=null&&c.isLimitedX||s.stopPropagation():o.isWheelPreventDefaultX?a.preventDefault():c!=null&&c.isLimitedX||a.preventDefault()):(a.deltaY>0?l=d:l=-d,this._commandService.executeCommand(N7.id,{offsetY:l}),n.getParent().classType===qt.SCENE_VIEWER?c!=null&&c.isLimitedY||s.stopPropagation():o.isWheelPreventDefaultY?a.preventDefault():c!=null&&c.isLimitedY||a.preventDefault())}a.inputIndex,kt.MouseWheelZ,this._scene.makeDirty(!0)}),new n8(o),n.attachControl(),o}};Z7=zVe([yt(ot.Ready,Z7),r6(0,ae),r6(1,se),r6(2,Jn),r6(3,Hi),r6(4,K(Dr))],Z7);var WVe=Object.defineProperty,YVe=Object.getOwnPropertyDescriptor,XVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?YVe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&WVe(e,n,i),i},Jg=(t,e)=>(n,r)=>e(n,r,t),ev;let dC=(ev=class extends b1{constructor(t,e,n,r){super(TMe),this._injector=e,this._localeService=n,this._currentUniverService=r,this._localeService.load({zhCN:FFe})}onStarting(t){[[Z7],[Vm],[Oo,{useClass:nC}],[r2,{useClass:eC}],[Ed,{useClass:Nke}],[bd,{useClass:iC}],[o2,{useClass:kFe}],[Bf,{useClass:BFe}],[vd,{useClass:S7}],[Pl],[Dr],[Hi,{useClass:Z_}],[Iy,{useClass:oUe}],[B8,{useClass:Q_}],[y7],[D7],[P7],[T7],[w7],[M7],[x7],[F7],[$7],[k7],[B7],[L7],[V7],[C0],[j7],[R7],[I7],[H7],[z7],[q7],[O7],[K7],[E7],[G7],[A7],[U7]].forEach(e=>t.add(e))}onReady(){this._markSheetAsFocused()}_markSheetAsFocused(){const t=this._currentUniverService;t.currentSheet$.pipe(Sh(e=>!!e)).subscribe(e=>{t.focusUniverInstance(e.getUnitId())})}},H(ev,"type",Ir.Sheet),ev);dC=XVe([Jg(1,K(wn)),Jg(2,K(Gt)),Jg(3,ae)],dC);var qVe=Object.defineProperty,GVe=(t,e,n)=>e in t?qVe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,j0=(t,e,n)=>(GVe(t,typeof e!="symbol"?e+"":e,n),n);const z0={id:"sheet.command.numfmt.set.numfmt",type:ue.COMMAND,handler:(t,e)=>{if(!e)return!1;const n=t.get(se),r=t.get(ae),i=t.get(en),o=r.getCurrentUniverSheetInstance(),a=o.getUnitId(),s=o.getActiveSheet().getSheetId(),u=e.values.filter(p=>!!p.pattern),l=e.values.filter(p=>!p.pattern),c=Cl(a,s,u),d={unitId:a,subUnitId:s,ranges:l.map(p=>({startColumn:p.col,startRow:p.row,endColumn:p.col,endRow:p.row}))},m=[],f=[];if(u.length){Object.keys(c.values).forEach(v=>{const g=c.values[v];g.ranges=g1(g.ranges)}),m.push({id:Do.id,params:c});const p=Mf(t,c);f.push(...p)}if(l.length){d.ranges=g1(d.ranges),m.push({id:Co.id,params:d});const p=Uc(t,d);f.push(...p)}const h=lr(m,n).result;return h&&i.pushUndoRedo({unitID:a,undoMutations:f,redoMutations:m}),h}},KVe={sheet:{numfmt:{title:"数据格式",numfmtType:"格式类型",cancel:"取消",confirm:"确认",general:"常规",accounting:"会计",text:"文本",number:"数值",currency:"货币",date:"日期",time:"时间",thousandthPercentile:"千分位符",preview:"示例",dateTime:"日期时间",decimalLength:"小数位数",currencyType:"货币类型",moreFmt:"更多格式",financialValue:"财务数值",roundingCurrency:"货币取整",timeDuration:"持续时间",currencyDes:"货币格式用于表示一般货币数值。会计格式可以对一列数值进行小数点对齐",accountingDes:"会计数字格式可对一列数值进行货币符号和小数点对齐",dateType:"日期类型",dateDes:"日期格式将日期和时间系列数值品示为日期值。",negType:"负数类型",generalDes:"常规格式不包含任何特定的数字格式。",thousandthPercentileDes:"千分位符格式用于一般数字的表示。货币和会计格式则提供货币值计算的专用格式。",addDecimal:"增加小数位",subtractDecimal:"减少小数位"}}},zm="SHEET_NUMFMT_PLUGIN",q9=t=>{const e=t.filter(o=>o.id===Co.id).map(o=>o.params),n=t.filter(o=>o.id===Do.id).map(o=>o.params),r=[];if(e[0]){const o=e.reduce((a,s)=>(a.ranges.push(...s.ranges),a),{ranges:[],unitId:e[0].unitId,subUnitId:e[0].subUnitId});o.ranges=g1(o.ranges),r.push({id:Co.id,params:o})}const i=(o,a)=>{const s=Object.keys(o),u=s.findIndex(l=>{const c=o[l];return Ie.diffValue(c,a)});return s[u]};if(n[0]){const o=n.reduce((a,s)=>(Object.keys(s.values).forEach(u=>{const l=s.values[u],c=s.refMap[u],d=i(a.refMap,c);if(d)a.values[d].ranges.push(...l.ranges);else{const m=Math.max(...Object.keys(a.refMap).map(Number),0)+1;a.values[m]={ranges:l.ranges},a.refMap[m]=c}}),a),{values:{},refMap:{},unitId:n[0].unitId,subUnitId:n[0].subUnitId});Object.keys(o.values).forEach(a=>{const s=o.values[a];s.ranges=g1(s.ranges)}),r.push({id:Do.id,params:o})}return r};var ZVe=Object.defineProperty,QVe=Object.getOwnPropertyDescriptor,JVe=(t,e,n,r)=>{for(var i=r>1?void 0:r?QVe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&ZVe(e,n,i),i},n4=(t,e)=>(n,r)=>e(n,r,t);let Q7=class extends We{constructor(e,n,r,i){super(),this._injector=e,this._univerInstanceService=n,this._numfmtService=r,this._autoFillService=i,this._initAutoFill()}_initAutoFill(){const e=()=>({redos:[],undos:[]}),n=(o,a,s)=>{const u=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),l=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),c={startRow:o.row,startColumn:o.col,endColumn:o.col,endRow:o.row},d={startRow:a.row,startColumn:a.col,endColumn:a.col,endRow:a.row},m=[];if(mr.foreach(s,(f,h)=>{const p=ht.getPositionRange({startRow:f,startColumn:h,endColumn:h,endRow:f},c),v=this._numfmtService.getValue(u,l,p.startRow,p.startColumn);if(v){const g=ht.getPositionRange({startRow:f,startColumn:h,endColumn:h,endRow:f},d);m.push({pattern:v.pattern,type:v.type,row:g.startRow,col:g.startColumn})}}),m.length){const f={id:Do.id,params:Cl(u,l,m)},h=Mf(this._injector,f.params);return{redos:[f],undos:h}}return{redos:[],undos:[]}},r=(o,a)=>{const s=[],u=[],l={row:o.startRow,col:o.startColumn};return HMe(o,a).forEach(c=>{const{undos:d,redos:m}=n(l,c.repeatStartCell,c.relativeRange);s.push(...d),u.push(...m)}),{undos:q9(s),redos:q9(u)}},i={id:zm,onFillData:(o,a,s)=>{if(s===tr.COPY||s===tr.ONLY_FORMAT||s===tr.SERIES){const{source:u,target:l}=o;return r(u,l)}return e()}};this.disposeWithMe(this._autoFillService.addHook(i))}};Q7=JVe([yt(ot.Rendered,Q7),n4(0,K(wn)),n4(1,K(ae)),n4(2,K(Ti)),n4(3,K(vd))],Q7);const wy=t=>Ns.getInfo(t).type||"unknown",q8=(t,e)=>{const n=Ns.getInfo(t)._partitions[1],r=Ns.format(t,e,{locale:"zh-CN"});return e<0?{result:r,color:n.color}:{result:r}};var eHe=Object.defineProperty,tHe=Object.getOwnPropertyDescriptor,nHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?tHe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&eHe(e,n,i),i},i6=(t,e)=>(n,r)=>e(n,r,t);let J7=class extends We{constructor(t,e,n,r,i){super(),this._sheetInterceptorService=t,this._themeService=e,this._sheetSkeletonManagerService=n,this._commandService=r,this._numfmtService=i,this._initInterceptorCellContent()}_initInterceptorCellContent(){const t=new Ye;this.disposeWithMe(this._sheetInterceptorService.intercept(Rs.CELL_CONTENT,{handler:(e,n,r)=>{const i=n.unitId,o=n.subUnitId,a=this._numfmtService.getValue(i,o,n.row,n.col);if(!a)return r(e);const s=e;if(!s||s.t!==$n.NUMBER)return r(e);let u="";const l=t.getValue(n.row,n.col);if(l&&l.parameters===s.v)return{...e,...l.result};const c=q8(a.pattern,Number(s.v));if(u=c.result,!u)return r(e);const d={v:u};if(c.color){const m=this._themeService.getCurrentTheme()[`${c.color}500`];m&&(d.interceptorStyle={cl:{rgb:m}})}return t.setValue(n.row,n.col,{result:d,parameters:s.v}),{...e,...d}}})),this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===Do.id){const n=e.params;Object.keys(n.values).forEach(r=>{n.values[r].ranges.forEach(i=>{mr.foreach(i,(o,a)=>{t.realDeleteValue(o,a)})})})}})),this.disposeWithMe(je(this._sheetSkeletonManagerService.currentSkeleton$.pipe(ja(e=>e==null?void 0:e.sheetId),OC()).subscribe(()=>{t.reset()})))}};J7=nHe([yt(ot.Rendered,J7),i6(0,K(In)),i6(1,K(_i)),i6(2,K(Dr)),i6(3,K(se)),i6(4,K(Ti))],J7);const yl=(t,e=0)=>{var n;return t&&(n=Ns.getInfo(t).maxDecimals)!=null?n:e},yd=(t,e)=>{if(t&&!e||!t&&e)return!1;const n=l=>l.reduce((c,d)=>{if(c.isEnd)return c;const m=d.value||d.num;return d.type==="point"?(c.isEnd=!0,c):{...c,result:c.result+m}},{isEnd:!1,result:""}).result,r=Ns.getInfo(t)._partitions,i=Ns.getInfo(e)._partitions,o=n(r[0].tokens),a=n(i[0].tokens),s=n(r[1].tokens),u=n(i[1].tokens);return o===a&&s===u&&r[1].color===i[1].color},_w=t=>new Array(Math.min(Math.max(0,Number(t)),30)).fill(0).join(""),da=(t,e)=>t.split(";").map(n=>/\.0?/.test(n)?n.replace(/\.0*/g,`${e>0?".":""}${_w(Number(e||0))}`):/0([^0]?)|0$/.test(n)?n.replace(/0([^0]+)|0$/,`0${e>0?".":""}${_w(Number(e||0))}$1`):n).join(";"),rHe=t=>/\.0?/.test(t)||/0([^0]?)|0$/.test(t),TH={id:"sheet.command.numfmt.add.decimal.command",type:ue.COMMAND,handler:async t=>{const e=t.get(se),n=t.get(dt),r=t.get(Ti),i=t.get(ae),o=n.getSelections();if(!o||!o.length)return!1;const a=i.getCurrentUniverSheetInstance(),s=a.getActiveSheet(),u=a.getUnitId(),l=s.getSheetId();let c=0;o.forEach(h=>{mr.foreach(h.range,(p,v)=>{const g=r.getValue(u,l,p,v);if(!g)return;const b=yl(g.pattern);c=b>c?b:c})});const d=c+1,m=da(`0${d>0?".0":""}`,d),f=[];return o.forEach(h=>{mr.foreach(h.range,(p,v)=>{const g=r.getValue(u,l,p,v);if(!g||yd(g.pattern,"0.0"))f.push({row:p,col:v,pattern:m});else{const b=yl(g.pattern),C=da(g.pattern,b+1);C!==g.pattern&&f.push({row:p,col:v,pattern:C})}})}),f.length?await e.executeCommand(z0.id,{values:f}):!1}},iHe=[{label:"1930-08-05",suffix:"yyyy-MM-dd"},{label:"1930/08/05",suffix:"yyyy/MM/dd"},{label:"1930年08月05日",suffix:'yyyy"年"MM"月"dd"日"'},{label:"08-05",suffix:"MM-dd"},{label:"8月5日",suffix:'M"月"d"日"'},{label:"13:30:30",suffix:"h:mm:ss"},{label:"13:30",suffix:"h:mm"},{label:"下午01:30",suffix:"A/P hh:mm"},{label:"下午1:30",suffix:"A/P h:mm"},{label:"下午1:30:30",suffix:"A/P h:mm:ss"},{label:"08-05 下午 01:30",suffix:"MM-dd A/P hh:mm"}],oHe=[{label:"(1,235)",suffix:"#,##0_);(#,##0)"},{label:"(1,235) ",suffix:"#,##0_);[Red](#,##0)",color:"red"},{label:"1,234.56",suffix:"#,##0.00_);#,##0.00"},{label:"1,234.56",suffix:"#,##0.00_);[Red]#,##0.00",color:"red"},{label:"-1,234.56",suffix:"#,##0.00_);-#,##0.00"},{label:"-1,234.56",suffix:"#,##0.00_);[Red]-#,##0.00",color:"red"}],wH=[{label:t=>`${t}1,235`,suffix:t=>`"${t}"#,##0.00_);"${t}"#,##0.00`},{label:t=>`${t}1,235`,suffix:t=>`"${t}"#,##0.00_);[Red]"${t}"#,##0.00`,color:"red"},{label:t=>`(${t}1,235)`,suffix:t=>`"${t}"#,##0.00_);("${t}"#,##0.00)`},{label:t=>`(${t}1,235)`,suffix:t=>`"${t}"#,##0.00_);[Red]("${t}"#,##0.00)`,color:"red"},{label:t=>`-${t}1,235`,suffix:t=>`"${t}"#,##0.00_);-"${t}"#,##0.00`},{label:t=>`-${t}1,235`,suffix:t=>`"${t}"#,##0.00_);[Red]-"${t}"#,##0.00`,color:"red"}],LH={id:"sheet.command.numfmt.set.currency",type:ue.COMMAND,handler:async t=>{const e=t.get(se),n=t.get(dt).getSelections();if(!n||!n.length)return!1;const r=[],i=wH[0].suffix("¥");return n.forEach(o=>{mr.foreach(o.range,(a,s)=>{r.push({row:a,col:s,pattern:i,type:"currency"})})}),await e.executeCommand(z0.id,{values:r})}},OH={id:"sheet.command.numfmt.subtract.decimal.command",type:ue.COMMAND,handler:async t=>{const e=t.get(se),n=t.get(dt),r=t.get(Ti),i=t.get(ae),o=n.getSelections();if(!o||!o.length)return!1;const a=i.getCurrentUniverSheetInstance(),s=a.getActiveSheet(),u=a.getUnitId(),l=s.getSheetId();let c=0;o.forEach(h=>{mr.foreach(h.range,(p,v)=>{const g=r.getValue(u,l,p,v);if(!g)return;const b=yl(g.pattern);c=b>c?b:c})});const d=c-1,m=da(`0${d>0?".0":"."}`,d),f=[];return o.forEach(h=>{mr.foreach(h.range,(p,v)=>{const g=r.getValue(u,l,p,v);if(!g||yd(g.pattern,"0.0"))f.push({row:p,col:v,pattern:m});else{const b=yl(g.pattern);f.push({row:p,col:v,pattern:da(g.pattern,b-1)})}})}),await e.executeCommand(z0.id,{values:f})}},tv={id:"sheet.operation.close.numfmt.panel",type:ue.OPERATION,handler:()=>!0},Ly=ln("INumfmtController");o5(ot.Rendered,Ly);const G9={id:"sheet.operation.open.numfmt.panel",type:ue.OPERATION,handler:t=>(t.get(Ly).openPanel(),!0)};var PH={exports:{}},G8={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aHe=Se,sHe=Symbol.for("react.element"),uHe=Symbol.for("react.fragment"),lHe=Object.prototype.hasOwnProperty,cHe=aHe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dHe={key:!0,ref:!0,__self:!0,__source:!0};function MH(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)lHe.call(e,r)&&!dHe.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:sHe,type:t,key:o,ref:a,props:i,_owner:cHe.current}}G8.Fragment=uHe;G8.jsx=MH;G8.jsxs=MH;PH.exports=G8;var on=PH.exports;const Oy=_.createContext([]),mC=["$","£","¥","¤","֏","؋","৳","฿","₡","₦","₩","₪","₫","€","₭","₮","₱","₲","₴","₸","₹","₺","₼","₽","₾","₿"];var mHe=Object.defineProperty,fHe=Object.getOwnPropertyDescriptor,hHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?fHe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&mHe(e,n,i),i},pHe=(t,e)=>(n,r)=>e(n,r,t);let K9=class{constructor(t){this._localStorageService=t}_getKey(t){return`userHabitController_${t}`}async addHabit(t,e){const n=this._getKey(t);return this._localStorageService.getItem(n).then(r=>{r||this._localStorageService.setItem(n,e)})}markHabit(t,e){const n=this._getKey(t);this._localStorageService.getItem(n).then(r=>{if(r){const i=r.findIndex(o=>o===e);i>-1&&r.splice(i,1),r.unshift(e),this._localStorageService.setItem(n,r)}})}async getHabit(t,e){const n=this._getKey(t),r=await this._localStorageService.getItem(n);if(e&&r){const i=r.map((o,a,s)=>{const u=s.length;return{value:o,priority:u-a}});return e.sort((o,a)=>{var s,u;const l=((s=i.find(c=>c.value===o))==null?void 0:s.priority)||-1;return(((u=i.find(c=>c.value===a))==null?void 0:u.priority)||-1)-l})}return r||[]}deleteHabit(t){this._localStorageService.removeItem(t)}};K9=hHe([pHe(0,K(QL))],K9);const Cw="numfmtCurrency",gHe=t=>{const e=Ct(K9),[n,r]=_.useState(mC);return _.useEffect(()=>{e.addHabit("numfmtCurrency",[]).then(()=>{e.getHabit(Cw,[...mC]).then(i=>{r(i),t&&t(i)})})},[]),{userHabitCurrency:n,mark:i=>{e.markHabit(Cw,i)}}},vHe=()=>{const t=_.useRef([]),[e,n]=_.useState({});return _.useEffect(()=>{t.current.forEach(r=>{r()}),t.current=[]},[e]),r=>{t.current.push(r),n({})}},Hf=t=>mC.find(e=>t.includes(e)),bHe=t=>!!Hf(t)&&t.startsWith("_("),_He=t=>{const[e,n]=_.useState(()=>yl(t.defaultPattern||"",2)),r=_.useContext(Oy),[i,o]=_.useState(()=>Hf(t.defaultPattern)||r[0]),a=_.useMemo(()=>r.map(c=>({label:c,value:c})),[]),s=Ct(Gt).t;t.action.current=()=>da(`_("${i}"* #,##0${e>0?".0":""}_)`,e);const u=c=>{o(c),t.onChange(da(`_("${c}"* #,##0${e>0?".0":""}_)`,e))},l=c=>{const d=c||0;n(d),t.onChange(da(`_("${i}"* #,##0${d>0?".0":""}_)`,d))};return on.jsxs("div",{children:[on.jsxs("div",{className:"m-t-16 options ",children:[on.jsxs("div",{className:"option",children:[on.jsx("div",{className:"label",children:s("sheet.numfmt.decimalLength")}),on.jsx("div",{className:"m-t-8 w-120",children:on.jsx(of,{value:e,max:20,min:0,onChange:l})})]}),on.jsxs("div",{className:"option",children:[on.jsx("div",{className:"label",children:s("sheet.numfmt.currencyType")}),on.jsx("div",{className:"m-t-8 w-140",children:on.jsx(K5,{onChange:u,options:a,value:i})})]})]}),on.jsx("div",{className:"describe m-t-14",children:s("sheet.numfmt.accountingDes")})]})},nv=t=>wH.map(e=>({label:e.label(t),value:e.suffix(t),color:e.color})),NH=()=>iHe.map(t=>({label:t.label,value:t.suffix})),xH=()=>oHe.map(t=>({label:t.label,value:t.suffix,color:t.color})),CHe=t=>!!Hf(t)&&!t.startsWith("_("),SHe=t=>{const e=Ct(Gt).t,n=_.useContext(Oy),[r,i]=_.useState(()=>Hf(t.defaultPattern)||n[0]),[o,a]=_.useState(()=>yl(t.defaultPattern||"",2)),[s,u]=_.useState(()=>{var h;const p=nv(r);return((h=p.find(v=>yd(v.value,t.defaultPattern)))==null?void 0:h.value)||p[0].value}),l=_.useMemo(()=>nv(r),[r]),c=_.useMemo(()=>n.map(h=>({label:h,value:h})),[n]);t.action.current=()=>da(s,o);const d=h=>{i(h);const p=nv(h)[0].value;u(p),t.onChange(da(p,o))},m=h=>{u(h),t.onChange(da(h,o))},f=h=>{a(h||0),t.onChange(da(s,h||0))};return on.jsxs("div",{children:[on.jsxs("div",{className:"m-t-16 options ",children:[on.jsxs("div",{className:"option",children:[on.jsx("div",{className:"label",children:e("sheet.numfmt.decimalLength")}),on.jsx("div",{className:"m-t-8 w-120",children:on.jsx(of,{value:o,max:20,min:0,onChange:f})})]}),on.jsxs("div",{className:"option",children:[on.jsx("div",{className:"label",children:e("sheet.numfmt.currencyType")}),on.jsx("div",{className:"m-t-8 w-140",children:on.jsx(K5,{onChange:d,options:c,value:r})})]})]}),on.jsx("div",{className:"m-t-16 label",children:e("sheet.numfmt.negType")}),on.jsx("div",{className:"m-t-8",children:on.jsx(dE,{onChange:m,options:l,value:s})}),on.jsx("div",{className:"describe m-t-14",children:e("sheet.numfmt.currencyDes")})]})},EHe=t=>{const e=Ns.getInfo(t);return NH().map(n=>n.value).includes(t)||["date","datetime","time"].includes(e.type)},yHe=t=>{const e=_.useMemo(NH,[]),n=Ct(Gt).t,[r,i]=_.useState(()=>{if(t.defaultPattern){const a=e.find(s=>s.value===t.defaultPattern);if(a)return a.value}return e[0].value});t.action.current=()=>r;const o=a=>{i(a),t.onChange(a)};return on.jsxs("div",{children:[on.jsx("div",{className:"m-t-16 label",children:n("sheet.numfmt.dateType")}),on.jsx("div",{className:"m-t-8",children:on.jsx(dE,{value:r,options:e,onChange:o})}),on.jsx("div",{className:"describe m-t-14",children:n("sheet.numfmt.dateDes")})]})},DHe=t=>!t,RHe=t=>{const e=Ct(Gt).t;return t.action.current=()=>"",on.jsx("div",{children:on.jsx("div",{className:"describe m-t-14",children:e("sheet.numfmt.generalDes")})})},IHe=t=>xH().some(e=>yd(e.value,t)),AHe=t=>{const e=Ct(Gt),n=_.useMemo(xH,[]),[r,i]=_.useState(()=>yl(t.defaultPattern||"",0)),[o,a]=_.useState(()=>{const d=n.find(m=>yd(m.value,t.defaultPattern||""));return(d==null?void 0:d.value)||n[0].value}),s=_.useMemo(()=>da(o,Number(r||0)),[o,r]),u=_.useMemo(()=>!rHe(o),[o]),l=d=>{i(d||0),t.onChange(da(o,Number(d||0)))},c=d=>{i(yl(d,0)),a(d),t.onChange(d)};return t.action.current=()=>s,on.jsxs("div",{children:[on.jsx("div",{className:"m-t-16 label",children:e.t("sheet.numfmt.decimalLength")}),on.jsx("div",{className:"m-t-8",children:on.jsx(of,{disabled:u,value:r,max:20,min:0,onChange:l})}),on.jsxs("div",{className:"m-t-16 label",children:[" ",e.t("sheet.numfmt.negType")]}),on.jsx("div",{className:"m-t-8",children:on.jsx(dE,{onChange:c,options:n,value:o})}),on.jsx("div",{className:"describe m-t-14",children:e.t("sheet.numfmt.thousandthPercentileDes")})]})},THe=t=>{const{defaultValue:e,defaultPattern:n,row:r,col:i}=t.value,o=Ct(Gt),a=_.useRef(()=>""),s=o.t,u=vHe(),l=_.useMemo(()=>[{label:"sheet.numfmt.general",component:RHe},{label:"sheet.numfmt.accounting",component:_He},{label:"sheet.numfmt.currency",component:SHe},{label:"sheet.numfmt.date",component:yHe},{label:"sheet.numfmt.thousandthPercentile",component:AHe}].map(R=>({...R,label:s(R.label)})),[]),[c,d]=_.useState(g),[m,f]=_.useState(()=>`${r}_${i}`),{mark:h,userHabitCurrency:p}=gHe(()=>f(`${r}_${i}_userCurrency'`)),v=_.useMemo(()=>{var R;return(R=l.find(I=>I.label===c))==null?void 0:R.component},[c]);function g(){return[DHe,bHe,CHe,EHe,IHe].reduce((R,I,T)=>R||(I(n)?l[T].label:""),"")||l[0].label}const b=l.map(R=>({label:R.label,value:R.label})),C=R=>{d(R),u(()=>t.onChange({type:"change",value:a.current()||""}))},S=R=>{t.onChange({type:"change",value:R})},E=()=>{const R=a.current()||"",I=Hf(R);I&&h(I),t.onChange({type:"confirm",value:R})},y=()=>{t.onChange({type:"cancel",value:""})},D={onChange:S,defaultValue:e,defaultPattern:n,action:a};return _.useEffect(()=>{d(g()),f(`${r}_${i}`)},[r,i]),on.jsxs("div",{className:"numfmt-panel p-b-20",children:[on.jsxs("div",{children:[on.jsx("div",{className:"label m-t-14",children:s("sheet.numfmt.numfmtType")}),on.jsx("div",{className:"m-t-8",children:on.jsx(K5,{onChange:C,options:b,value:c})}),on.jsx("div",{children:v&&on.jsx(Oy.Provider,{value:p,children:_.createElement(v,{...D,key:m})})})]}),on.jsxs("div",{className:"btn-list m-t-14 m-b-20",children:[on.jsx(X1,{size:"small",onClick:y,className:"m-r-12",children:s("sheet.numfmt.cancel")}),on.jsx(X1,{type:"primary",size:"small",onClick:E,children:s("sheet.numfmt.confirm")})]})]})};var wHe=Object.defineProperty,LHe=Object.getOwnPropertyDescriptor,OHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?LHe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&wHe(e,n,i),i},Ia=(t,e)=>(n,r)=>e(n,r,t);let eh=class extends We{constructor(t,e,n,r,i,o,a,s,u,l,c,d){super(),j0(this,"_previewPattern",""),j0(this,"openPanel",()=>{const m=this._sidebarService,f=this._selectionManagerService,h=this._commandService,p=this._univerInstanceService,v=this._numfmtService,g=this._localeService,b=(f.getSelectionRanges()||[])[0];if(!b)return!1;const C=p.getCurrentUniverSheetInstance(),S=C.getActiveSheet(),E=S.getCellRaw(b.startRow,b.startColumn),y=v.getValue(C.getUnitId(),S.getSheetId(),b.startRow,b.startColumn);let D="";y&&(D=y.pattern);const R=(E==null?void 0:E.t)===$n.NUMBER?E.v:12345678,I={onChange:T=>{var P,N;if(T.type==="change")this._previewPattern=T.value,this._sheetSkeletonManagerService.reCalculate(),(N=(P=this._renderManagerService.getRenderById(C.getUnitId()))==null?void 0:P.mainComponent)==null||N.makeDirty();else if(T.type==="confirm"){const B=f.getSelectionRanges()||[],W={values:[]},G=wy(T.value);B.forEach(Q=>{mr.foreach(Q,(te,X)=>{W.values.push({row:te,col:X,pattern:T.value,type:G})})}),h.executeCommand(z0.id,W),m.close()}else T.type==="cancel"&&m.close()},value:{defaultPattern:D,defaultValue:R,row:b.startRow,col:b.startColumn}};m.open({header:{title:g.t("sheet.numfmt.title")},children:{label:zm,...I},onClose:()=>{var T,P;this._sheetSkeletonManagerService.reCalculate(),(P=(T=this._renderManagerService.getRenderById(C.getUnitId()))==null?void 0:T.mainComponent)==null||P.makeDirty(),h.executeCommand(tv.id)}})}),this._sheetInterceptorService=t,this._themeService=e,this._injector=n,this._univerInstanceService=r,this._sheetSkeletonManagerService=i,this._commandService=o,this._selectionManagerService=a,this._renderManagerService=s,this._numfmtService=u,this._componentManager=l,this._sidebarService=c,this._localeService=d,this._initInterceptorCommands(),this._initRealTimeRenderingInterceptor(),this._initPanel(),this._initCommands(),this._commandExecutedListener()}_initCommands(){[TH,OH,LH,G9,tv,z0].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))})}_initPanel(){this._componentManager.register(zm,THe)}_initInterceptorCommands(){const t=this;this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations(e){switch(e.id){case Tf.id:case ll.id:{const n=t._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),r=t._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),i=t._selectionManagerService.getSelectionRanges();if(!(i!=null&&i.length))break;const o={unitId:n,subUnitId:r,ranges:[]},a=t._numfmtService.getModel(n,r);i.forEach(u=>{mr.foreach(u,(l,c)=>{a!=null&&a.getValue(l,c)&&o.ranges.push({startColumn:c,endColumn:c,startRow:l,endRow:l})})}),o.ranges=g1(o.ranges);const s=Uc(t._injector,o);return{redos:[{id:Co.id,params:o}],undos:s}}}return{redos:[],undos:[]}}}))}_initRealTimeRenderingInterceptor(){const t=new Wt(n=>{this._commandService.onCommandExecuted(r=>{r.id===G9.id&&n.next(!0),r.id===tv.id&&n.next(!1)})}),e=TC([t,this._selectionManagerService.selectionMoveEnd$.pipe(ja(n=>n?n.map(r=>r.range):[]))]);this.disposeWithMe(je(e.pipe(PC(([n,r])=>new Wt(i=>{const o=new ws;return n&&r.length&&i.next({selectionRanges:r,disposableCollection:o}),()=>{o.dispose()}})),$z(()=>{this._previewPattern=null})).subscribe(({disposableCollection:n,selectionRanges:r})=>{var i,o;const a=this._univerInstanceService.getCurrentUniverSheetInstance();this.openPanel(),n.add(this._sheetInterceptorService.intercept(Rs.CELL_CONTENT,{priority:99,handler:(s,u,l)=>{const{row:c,col:d}=u;if(r.find(m=>m.startColumn<=d&&m.endColumn>=d&&m.startRow<=c&&m.endRow>=c)){const m=u.worksheet.getCellRaw(c,d),f=m==null?void 0:m.v,h=m==null?void 0:m.t;if(f==null||h!==$n.NUMBER||this._previewPattern===null)return l(s);const p=q8(this._previewPattern,f);if(p.color){const v=this._themeService.getCurrentTheme()[`${p.color}500`];return{...s,v:p.result,t:$n.STRING,s:{cl:{rgb:v}}}}return{...s,v:p.result,t:$n.STRING}}return l(s)}})),(o=(i=this._renderManagerService.getRenderById(a.getUnitId()))==null?void 0:i.mainComponent)==null||o.makeDirty()})))}_commandExecutedListener(){const t=[Co.id,Do.id];this.disposeWithMe(je(Q9(new Wt(e=>{const n=this._commandService.onCommandExecuted(r=>{if(t.includes(r.id)){const i=r.params;e.next(i.unitId)}});return()=>{n.dispose()}}),this._numfmtService.modelReplace$).pipe(LC(16)).subscribe(e=>{var n,r;this._sheetSkeletonManagerService.reCalculate(),(r=(n=this._renderManagerService.getRenderById(e))==null?void 0:n.mainComponent)==null||r.makeDirty()})))}};eh=OHe([yt(ot.Rendered,eh),Ia(0,K(In)),Ia(1,K(_i)),Ia(2,K(wn)),Ia(3,K(ae)),Ia(4,K(Dr)),Ia(5,K(se)),Ia(6,K(dt)),Ia(7,K(Jn)),Ia(8,K(Ti)),Ia(9,K(Jo)),Ia(10,K(cd)),Ia(11,K(Gt))],eh);var PHe=Object.defineProperty,MHe=Object.getOwnPropertyDescriptor,NHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?MHe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&PHe(e,n,i),i},r4=(t,e)=>(n,r)=>e(n,r,t);let th=class extends We{constructor(e,n,r,i){super(),j0(this,"_copyInfo"),this._sheetClipboardService=e,this._injector=n,this._numfmtService=r,this._univerInstanceService=i,this._initClipboardHook()}_initClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook({id:zm,onBeforeCopy:(e,n,r)=>this._collectNumfmt(e,n,r),onPasteCells:(e,n,r,i)=>{const{copyType:o=_s.COPY,pasteType:a}=i,{range:s}=e||{},{range:u}=n;return this._generateNumfmtMutations(u,{copyType:o,pasteType:a,copyRange:s})}}))}_collectNumfmt(e,n,r){const i=new Ye;this._copyInfo={matrix:i,info:{unitId:e,subUnitId:n}};const o=this._numfmtService.getModel(e,n);o&&mr.foreach(r,(a,s)=>{const u=this._numfmtService.getValue(e,n,a,s,o);if(!u)return;const l=ht.getRelativeRange({startRow:a,endRow:a,startColumn:s,endColumn:s},r);i.setValue(l.startRow,l.startColumn,{pattern:u.pattern,type:u.type})})}_generateNumfmtMutations(e,n){const r=this._univerInstanceService.getCurrentUniverSheetInstance(),i=r.getActiveSheet(),o=r.getUnitId(),a=i.getSheetId();if(n.copyType===_s.CUT)return this._copyInfo=null,{redos:[],undos:[]};if(!this._copyInfo||!this._copyInfo.matrix.getSizeOf()||!n.copyRange)return{redos:[],undos:[]};if([ro.SPECIAL_PASTE_COL_WIDTH,ro.SPECIAL_PASTE_VALUE].includes(n.pasteType))return{redos:[],undos:[]};const s=$Fe(n.copyRange,e,!0),u=[],l={unitId:o,subUnitId:a,ranges:[]},c=this._numfmtService.getModel(o,a);mr.foreach(e,(f,h)=>{this._numfmtService.getValue(o,a,f,h,c)&&l.ranges.push({startRow:f,startColumn:h,endRow:f,endColumn:h})}),s.forEach(f=>{this._copyInfo&&this._copyInfo.matrix.forValue((h,p,v)=>{const g=ht.getPositionRange({startRow:h,endRow:h,startColumn:p,endColumn:p},f.startRange);u.push({row:g.startRow,col:g.startColumn,pattern:v.pattern,type:v.type})})});const d=Cl(o,a,u);Object.keys(d.values).forEach(f=>{const h=d.values[f];h.ranges=g1(h.ranges)}),l.ranges=g1(l.ranges);const m=[...Mf(this._injector,d),...Uc(this._injector,l)];return{redos:[{id:Co.id,params:l},{id:Do.id,params:d}],undos:q9(m)}}};th=NHe([yt(ot.Rendered,th),r4(0,K(r2)),r4(1,K(wn)),r4(2,K(Ti)),r4(3,K(ae))],th);var xHe=Object.defineProperty,FHe=Object.getOwnPropertyDescriptor,$He=(t,e,n,r)=>{for(var i=r>1?void 0:r?FHe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&xHe(e,n,i),i},o6=(t,e)=>(n,r)=>e(n,r,t);const kHe=()=>{let t=[];return{add:(e,n,r,i,o)=>t.push({unitId:e,subUnitId:n,row:r,col:i,value:o}),getEffects:()=>t,clean:()=>{t=[]}}};let nh=class extends We{constructor(t,e,n,r,i){super(),j0(this,"_collectEffectMutation",kHe()),this._sheetInterceptorService=t,this._numfmtService=e,this._univerInstanceService=n,this._injector=r,this._editorBridgeService=i,this._initInterceptorEditorStart(),this._initInterceptorEditorEnd(),this._initInterceptorCommands()}_initInterceptorEditorStart(){this.disposeWithMe(je(this._editorBridgeService.interceptor.intercept(this._editorBridgeService.interceptor.getInterceptPoints().BEFORE_CELL_EDIT,{handler:(t,e,n)=>{const r=e.row,i=e.col,o=this._numfmtService.getValue(e.unitId,e.subUnitId,r,i);if(o)switch(wy(o.pattern)){case"scientific":case"percent":case"currency":case"grouped":case"number":return e.worksheet.getCellRaw(r,i);case"date":case"time":case"datetime":default:return n&&n(t)}return n(t)}})))}_initInterceptorEditorEnd(){this.disposeWithMe(je(this._editorBridgeService.interceptor.intercept(this._editorBridgeService.interceptor.getInterceptPoints().AFTER_CELL_EDIT,{handler:(t,e,n)=>{this._collectEffectMutation.clean();const r=this._numfmtService.getValue(e.unitId,e.subUnitId,e.row,e.col),i=()=>{r&&this._collectEffectMutation.add(e.unitId,e.subUnitId,e.row,e.col,null)};if(!(t!=null&&t.v))return n(t);const o=String(t.v),a=Ns.parseDate(o)||Ns.parseTime(o);if(a){if(a&&a.z){const s=Number(a.v);return this._collectEffectMutation.add(e.unitId,e.subUnitId,e.row,e.col,{type:"date",pattern:a.z}),{...t,v:s,t:$n.NUMBER}}}else(["date","time","datetime"].includes((r==null?void 0:r.type)||"")||!BHe(o))&&i();return n(t)}})))}_initInterceptorCommands(){const t=this;this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations(e){switch(e.id){case Ga.id:{const n=t._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),r=t._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),i=t._collectEffectMutation.getEffects();if(!i.length)return{redos:[],undos:[]};const o=i.filter(l=>{var c;return!!((c=l.value)!=null&&c.pattern)}).map(l=>({row:l.row,col:l.col,pattern:l.value.pattern,type:l.value.type})),a=i.filter(l=>{var c;return!((c=l.value)!=null&&c.pattern)}).map(l=>({startRow:l.row,endColumn:l.col,startColumn:l.col,endRow:l.row})),s=[],u=[];if(o){const l={id:Do.id,params:Cl(n,r,o)};s.push(l),u.push(...Mf(t._injector,l.params))}if(a){const l={id:Co.id,params:{unitId:n,subUnitId:r,ranges:a}};s.push(l),u.push(...Uc(t._injector,l.params))}return{redos:s,undos:u.reverse()}}}return{redos:[],undos:[]}}}))}};nh=$He([yt(ot.Rendered,nh),o6(0,K(In)),o6(1,K(Ti)),o6(2,K(ae)),o6(3,K(wn)),o6(4,K(Oo))],nh);function BHe(t){return/^-?\d+(\.\d+)?$/.test(t)}var UHe=Object.defineProperty,VHe=Object.getOwnPropertyDescriptor,HHe=(t,e,n,r)=>{for(var i=r>1?void 0:r?VHe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&UHe(e,n,i),i},jHe=(t,e)=>(n,r)=>e(n,r,t);let rh=class extends We{constructor(t){super(),j0(this,"_initLocal",()=>{this._localeService.load({zhCN:KVe})}),this._localeService=t,this._initLocal()}};rh=HHe([yt(ot.Rendered,rh),jHe(0,K(Gt))],rh);var $a=function(){return $a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},$a.apply(this,arguments)},zHe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},jf=_.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,a=zHe(t,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),u=_.useRef("_".concat(XHe()));return FH(n,"".concat(r),{defIds:n.defIds,idSuffix:u.current},$a({ref:e,className:s},a),o)});function FH(t,e,n,r,i){return _.createElement(t.tag,$a($a({key:e},WHe(t,n,i)),r),(YHe(t,n).children||[]).map(function(o,a){return FH(o,"".concat(e,"-").concat(t.tag,"-").concat(a),n,void 0,i)}))}function WHe(t,e,n){var r=$a({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var a=o[0],s=o[1];typeof s=="string"&&(r[a]=s.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function YHe(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?$a($a({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?$a($a({},i),{attrs:$a($a({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function XHe(){return Math.random().toString(36).substring(2,8)}jf.displayName="UniverIcon";var qHe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.99988 3.60921C3.99988 2.32055 5.04456 1.27588 6.33321 1.27588 7.62187 1.27588 8.66654 2.32055 8.66654 3.60921V6.24136C8.66654 7.53002 7.62187 8.5747 6.33321 8.5747 5.04455 8.5747 3.99988 7.53002 3.99988 6.24136V3.60921zM6.33321 2.60921C5.78093 2.60921 5.33321 3.05693 5.33321 3.60921V6.24136C5.33321 6.79364 5.78093 7.24136 6.33321 7.24136 6.88549 7.24136 7.33321 6.79364 7.33321 6.24136V3.60921C7.33321 3.05693 6.88549 2.60921 6.33321 2.60921zM9.99988 3.60921C9.99988 2.32055 11.0446 1.27588 12.3332 1.27588 13.6219 1.27588 14.6665 2.32055 14.6665 3.60921V6.24136C14.6665 7.53002 13.6219 8.5747 12.3332 8.5747 11.0446 8.5747 9.99988 7.53002 9.99988 6.24136V3.60921zM12.3332 2.60921C11.7809 2.60921 11.3332 3.05693 11.3332 3.60921V6.24136C11.3332 6.79364 11.7809 7.24136 12.3332 7.24136 12.8855 7.24136 13.3332 6.79364 13.3332 6.24136V3.60921C13.3332 3.05693 12.8855 2.60921 12.3332 2.60921z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.4713 9.58625C12.211 9.3259 11.7889 9.3259 11.5285 9.58625 11.2682 9.8466 11.2682 10.2687 11.5285 10.5291L12.3904 11.391H6.33329C5.9651 11.391 5.66663 11.6895 5.66663 12.0577 5.66663 12.4258 5.9651 12.7243 6.33329 12.7243H12.3904L11.5285 13.5862C11.2682 13.8466 11.2682 14.2687 11.5285 14.5291 11.7889 14.7894 12.211 14.7894 12.4713 14.5291L14.4669 12.5335C14.4851 12.5156 14.5022 12.4968 14.5183 12.477 14.5484 12.4399 14.5739 12.4003 14.5948 12.359 14.6407 12.2685 14.6666 12.1661 14.6666 12.0577 14.6666 11.9492 14.6407 11.8468 14.5948 11.7563 14.5739 11.715 14.5484 11.6754 14.5183 11.6383 14.5022 11.6185 14.4851 11.5997 14.4669 11.5818L12.4713 9.58625zM1.33325 7.98825C1.33325 7.62006 1.63173 7.32159 1.99992 7.32159H2.33325C2.70144 7.32159 2.99992 7.62006 2.99992 7.98825 2.99992 8.35644 2.70144 8.65492 2.33325 8.65492H1.99992C1.63173 8.65492 1.33325 8.35644 1.33325 7.98825z"}}]},$H=_.forwardRef(function(t,e){return _.createElement(jf,Object.assign({},t,{id:"add-digits-single",ref:e,icon:qHe}))});$H.displayName="AddDigitsSingle";const GHe=$H;var KHe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_556",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#D9D9D9",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_556)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M0.629584 3.99986C1.13729 3.4922 1.9604 3.49224 2.46806 3.99995L7.57569 9.10806C7.81 9.3424 8.18992 9.3424 8.42424 9.10808L13.5323 3.99998C14.04 3.4923 14.8631 3.4923 15.3708 3.99998C15.8785 4.50766 15.8785 5.33078 15.3708 5.83846L9.41415 11.7951C8.63307 12.5762 7.36669 12.5762 6.58565 11.7951L0.629497 5.83834C0.121839 5.33063 0.121879 4.50752 0.629584 3.99986Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},kH=_.forwardRef(function(t,e){return _.createElement(jf,Object.assign({},t,{id:"more-down-single",ref:e,icon:KHe}))});kH.displayName="MoreDownSingle";const ZHe=kH;var QHe={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5 3.61825C5 2.32958 6.04468 1.28491 7.33333 1.28491C8.62199 1.28491 9.66667 2.32958 9.66667 3.61825V6.30787C9.66667 7.59653 8.62199 8.64121 7.33333 8.64121C6.04468 8.64121 5 7.59653 5 6.30787V3.61825ZM7.33333 2.61825C6.78105 2.61825 6.33333 3.06596 6.33333 3.61825V6.30787C6.33333 6.86015 6.78106 7.30787 7.33333 7.30787C7.88561 7.30787 8.33333 6.86015 8.33333 6.30787V3.61825C8.33333 3.06596 7.88561 2.61825 7.33333 2.61825Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M2 7.9745C2 7.60631 2.29848 7.30783 2.66667 7.30783H3C3.36819 7.30783 3.66667 7.60631 3.66667 7.9745 3.66667 8.34269 3.36819 8.64117 3 8.64117H2.66667C2.29848 8.64117 2 8.34269 2 7.9745zM8.80482 9.56197C9.06517 9.82232 9.06517 10.2444 8.80482 10.5048L7.94289 11.3667H13.3334C13.7016 11.3667 14.0001 11.6652 14.0001 12.0334 14.0001 12.4016 13.7016 12.7 13.3334 12.7H7.94289L8.80482 13.562C9.06517 13.8223 9.06517 14.2444 8.80482 14.5048 8.54447 14.7651 8.12236 14.7651 7.86201 14.5048L5.86201 12.5048C5.79809 12.4409 5.74987 12.3672 5.71733 12.2886 5.68474 12.21 5.66675 12.1238 5.66675 12.0334 5.66675 11.943 5.68474 11.8568 5.71733 11.7782 5.74987 11.6996 5.79809 11.6259 5.86201 11.562L7.86201 9.56197C8.12236 9.30162 8.54447 9.30162 8.80482 9.56197z"}}]},BH=_.forwardRef(function(t,e){return _.createElement(jf,Object.assign({},t,{id:"reduce-digits-single",ref:e,icon:QHe}))});BH.displayName="ReduceDigitsSingle";const JHe=BH;var eje={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.05443 1.55744C4.34898 1.33653 4.76685 1.39623 4.98776 1.69078L7.99996 5.98276L11.0122 1.69078C11.2331 1.39623 11.6509 1.33653 11.9455 1.55744C12.24 1.77836 12.2997 2.19623 12.0788 2.49078L9.33338 6.42708H12.0788C12.447 6.42708 12.7455 6.72556 12.7455 7.09375C12.7455 7.46194 12.447 7.76042 12.0788 7.76042H8.66659V9.69702H12.3348C12.703 9.69702 13.0015 9.9955 13.0015 10.3637C13.0015 10.7319 12.703 11.0304 12.3348 11.0304H8.66659V13.9091C8.66659 14.2773 8.36811 14.5758 7.99992 14.5758C7.63173 14.5758 7.33325 14.2773 7.33325 13.9091V11.0304H3.66508C3.29689 11.0304 2.99841 10.7319 2.99841 10.3637C2.99841 9.9955 3.29689 9.69702 3.66508 9.69702H7.33325V7.76042H3.92109C3.5529 7.76042 3.25443 7.46194 3.25443 7.09375C3.25443 6.72556 3.5529 6.42708 3.92109 6.42708H6.66653L3.92109 2.49078C3.70018 2.19623 3.75987 1.77836 4.05443 1.55744Z"}}]},UH=_.forwardRef(function(t,e){return _.createElement(jf,Object.assign({},t,{id:"rmb-single",ref:e,icon:eje}))});UH.displayName="RmbSingle";const tje=UH,ih=[{label:"sheet.numfmt.general",pattern:null},{label:"sheet.numfmt.text",pattern:"@@@"},"|",{label:"sheet.numfmt.number",pattern:"0"},"|",{label:"sheet.numfmt.accounting",pattern:'"¥" #,##0.00_);[Red]("¥"#,##0.00)'},{label:"sheet.numfmt.financialValue",pattern:"#,##0.00;[Red]#,##0.00"},{label:"sheet.numfmt.currency",pattern:'"¥"#,##0.00_);[Red]("¥"#,##0.00)'},{label:"sheet.numfmt.roundingCurrency",pattern:'"¥"#,##0;[Red]"¥"#,##0'},"|",{label:"sheet.numfmt.date",pattern:"yyyy-mm-dd;@"},{label:"sheet.numfmt.time",pattern:'am/pm h":"mm":"ss'},{label:"sheet.numfmt.dateTime",pattern:"yyyy-m-d am/pm h:mm"},{label:"sheet.numfmt.timeDuration",pattern:"h:mm:ss"},"|",{label:"sheet.numfmt.moreFmt",pattern:""}],nje=t=>{var e;const n=Ct(Gt),r=(e=t.value)!=null?e:n.t("sheet.numfmt.general");return on.jsx("span",{className:"more-numfmt-type",children:r})},rje=()=>{const t=Ct(se),e=Ct(Gt),n=gf(),r=Ct(dt),i=s=>{const u=r.getLast();if(!u)return;const l=n.get(To),c=u.range,d=[];mr.foreach(c,(m,f)=>{s?d.push({row:m,col:f,pattern:s,type:wy(s)}):d.push({row:m,col:f})}),t.executeCommand(z0.id,{values:d}),l.focus()},o=s=>{if(s===0)i(null);else if(s===ih.length-1)t.executeCommand(G9.id);else{const u=ih[s];u.pattern&&i(u.pattern)}},a=1220;return on.jsx("div",{className:"more-numfmt-type-options",children:ih.map((s,u)=>s==="|"?on.jsx("div",{className:"line m-t-4",onClick:l=>l.stopPropagation()},u):on.jsxs("div",{className:"option-item m-t-4",onClick:()=>{o(u)},children:[on.jsx("div",{children:e.t(s.label)}),on.jsx("div",{className:"m-l-26",children:s.pattern?Ns.format(s.pattern||"",a,{locale:"zh-CN"}):""})]},u))})},ije=t=>{const e="icon-rmbSingle";return t.register(e,tje),t.register("MoreDownSingle",ZHe),n=>({icon:e,id:LH.id,title:"sheet.numfmt.currency",tooltip:"sheet.numfmt.currency",type:pt.BUTTON,group:Kt.TOOLBAR_FORMULAS_INSERT,positions:[hn.TOOLBAR_START],hidden$:cr(n,or.SHEET),disabled$:ei(n)})},oje=t=>{const e="icon-addDigitsSingle";return t.register(e,GHe),n=>({icon:e,id:TH.id,title:"sheet.numfmt.addDecimal",tooltip:"sheet.numfmt.addDecimal",type:pt.BUTTON,positions:[hn.TOOLBAR_START],group:Kt.TOOLBAR_FORMULAS_INSERT,hidden$:cr(n,or.SHEET),disabled$:ei(n)})},aje=t=>{const e="icon-reduceDigitsSingle";return t.register(e,JHe),n=>({icon:e,id:OH.id,title:"sheet.numfmt.subtractDecimal",tooltip:"sheet.numfmt.subtractDecimal",type:pt.BUTTON,group:Kt.TOOLBAR_FORMULAS_INSERT,positions:[hn.TOOLBAR_START],hidden$:cr(n,or.SHEET),disabled$:ei(n)})},sje=t=>{const e="sheet.numfmt.moreNumfmtType",n="sheet.numfmt.moreNumfmtType.options";return t.register(e,nje),t.register(n,rje),r=>{const i=r.get(Ti),o=r.get(Ai),a=r.get(ae),s=r.get(se),u=r.get(Gt),l=r.get(dt),c=new Wt(d=>Q9(l.selectionMoveEnd$,new Wt(m=>{const f=[Co.id,Do.id],h=s.onCommandExecuted(p=>{f.includes(p.id)&&m.next(null)});return()=>h.dispose()})).subscribe(()=>{const m=l.getSelections();if(m&&m[0]){const f=a.getCurrentUniverSheetInstance(),h=f.getActiveSheet(),p=m[0].range,v=p.startRow,g=p.startColumn,b=i.getValue(f.getUnitId(),h.getSheetId(),v,g),C=o.getNumfmtValue(f.getUnitId(),h.getSheetId(),v,g),S=(b==null?void 0:b.pattern)||C;let E=u.t("sheet.numfmt.general");if(S){const y=ih.filter(D=>typeof D=="object"&&D.pattern).find(D=>yd(S,D.pattern));y&&typeof y=="object"&&y.pattern?E=u.t(y.label):E=u.t("sheet.numfmt.moreFmt")}d.next(E)}}));return{label:e,id:G9.id,tooltip:"sheet.numfmt.title",type:pt.SELECTOR,group:Kt.TOOLBAR_FORMULAS_INSERT,positions:[hn.TOOLBAR_START],selections:[{label:{name:n,hoverable:!1}}],value$:c,hidden$:cr(r,or.SHEET),disabled$:ei(r)}}};var uje=Object.defineProperty,lje=Object.getOwnPropertyDescriptor,cje=(t,e,n,r)=>{for(var i=r>1?void 0:r?lje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&uje(e,n,i),i},rv=(t,e)=>(n,r)=>e(n,r,t);let oh=class extends We{constructor(t,e,n){super(),this._injector=t,this._componentManager=e,this._menuService=n,this._initMenu()}_initMenu(){[oje,aje,ije,sje].map(t=>t(this._componentManager)).forEach(t=>{this.disposeWithMe(this._menuService.addMenuItem(t(this._injector)))})}};oh=cje([yt(ot.Rendered,oh),rv(0,K(wn)),rv(1,K(Jo)),rv(2,K(S1))],oh);var dje=Object.defineProperty,mje=Object.getOwnPropertyDescriptor,fje=(t,e,n,r)=>{for(var i=r>1?void 0:r?mje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&dje(e,n,i),i},L2=(t,e)=>(n,r)=>e(n,r,t);const hje=[Do.id,Co.id];let ah=class extends We{constructor(e,n,r,i,o,a){super(),this._numfmtService=e,this._univerInstanceService=n,this._injector=r,this._refRangeService=i,this._sheetSkeletonManagerService=o,this._commandService=a,this._registerRefRange(),this._mergeRefMutations()}_mergeRefMutations(){this._refRangeService.interceptor.intercept(this._refRangeService.interceptor.getInterceptPoints().MERGE_REDO,{handler:(e,n,r)=>{if(!e)return r(e);const i=e.filter(o=>!hje.includes(o.id));return i.push(...q9(e)),r(i)}})}_registerRefRange(){this.disposeWithMe(je(Q9(this._sheetSkeletonManagerService.currentSkeleton$.pipe(ja(e=>e==null?void 0:e.sheetId),OC()),this._numfmtService.modelReplace$).pipe(PC(()=>new Wt(e=>{const n=new ws;return e.next(n),()=>{n.dispose()}}))).subscribe(e=>{const n=this._univerInstanceService.getCurrentUniverSheetInstance().getUnitId(),r=this._univerInstanceService.getCurrentUniverSheetInstance().getActiveSheet().getSheetId(),i=this._numfmtService.getModel(n,r),o=new Map,a=(s,u,l)=>{const c={startRow:u,startColumn:l,endRow:u,endColumn:l};let d=[];switch(s.id){case Wn.DeleteRangeMoveLeftCommandId:{d=gV(s,c);break}case Wn.DeleteRangeMoveUpCommandId:{d=vV(s,c);break}case Wn.InsertColCommandId:{d=fV(s,c);break}case Wn.InsertRangeMoveDownCommandId:{d=hV(s,c);break}case Wn.InsertRangeMoveRightCommandId:{d=pV(s,c);break}case Wn.InsertRowCommandId:{d=mV(s,c);break}case Wn.MoveRangeCommandId:{d=lV(s,c);break}case Wn.RemoveColCommandId:{d=cV(s,c);break}case Wn.RemoveRowCommandId:{d=dV(s,c);break}case Wn.MoveColsCommandId:{d=oy(s,c);break}case Wn.MoveRowsCommandId:d=iy(s,c)}const m=xo(d,c),f=this._numfmtService.getValue(n,r,u,l);if(!m&&f){const h={id:Co.id,params:{unitId:n,subUnitId:r,ranges:[{startColumn:l,startRow:u,endColumn:l,endRow:u}]}},p=Uc(this._injector,h.params);return{redos:[h],undos:p}}if(f&&m){const h=[],p=[],v=[{pattern:f.pattern,type:f.type,row:m.startRow,col:m.startColumn}],g={id:Do.id,params:Cl(n,r,v)},b=Mf(this._injector,g.params),C={id:Co.id,params:{unitId:n,subUnitId:r,ranges:[{startColumn:l,startRow:u,endColumn:l,endRow:u}]}},S=Uc(this._injector,C.params);return h.push(g,C),p.push(...b,...S),{redos:h,undos:p.reverse()}}return{redos:[],undos:[]}};i&&i.forValue((s,u)=>{const l={startRow:s,startColumn:u,endRow:s,endColumn:u},c=this._refRangeService.registerRefRange(l,d=>a(d,s,u));o.set(`${s}_${u}`,c),e.add(c)}),e.add(je(new Wt(s=>{e.add(this._commandService.onCommandExecuted(u=>{[Do.id,Co.id].includes(u.id)&&s.next(u.params)}))}).pipe(Sh(s=>s.unitId===n&&s.subUnitId===r),ja(s=>s.ranges?s.ranges:s.values?Object.keys(s.values).reduce((u,l)=>{const c=s.values[l];return u.push(...c.ranges),u},[]):[]),Mz(300),ja(s=>s.reduce((u,l)=>(u.push(...l),u),[])),Sh(s=>!!s.length)).subscribe(s=>{s.forEach(u=>{mr.foreach(u,(l,c)=>{const d=`${l}_${c}`,m=o.get(d);if(o.delete(d),m&&m.dispose(),this._numfmtService.getValue(n,r,l,c)){const f={startRow:l,startColumn:c,endRow:l,endColumn:c},h=this._refRangeService.registerRefRange(f,p=>a(p,l,c));o.set(d,h),e.add(h)}})})})))})))}};ah=fje([yt(ot.Rendered,ah),L2(0,K(Ti)),L2(1,K(ae)),L2(2,K(wn)),L2(3,K(b0)),L2(4,K(Dr)),L2(5,K(se))],ah);var pje=Object.defineProperty,gje=Object.getOwnPropertyDescriptor,vje=(t,e,n,r)=>{for(var i=r>1?void 0:r?gje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&pje(e,n,i),i},i4=(t,e)=>(n,r)=>e(n,r,t);let sh=class extends We{constructor(e,n,r,i){super(),this._numfmtService=e,this._sheetInterceptorService=n,this._univerInstanceService=r,this._injector=i,this._initSheetChange()}_initSheetChange(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:e=>{if(e.id===Lf.id){const n=e.params,r=n.unitId||bje(this._univerInstanceService),i=n.subUnitId||_je(this._univerInstanceService),o=this._numfmtService.getModel(r,i);if(!o)return{redos:[],undos:[]};const a=[];o.forValue((l,c)=>{a.push({startColumn:c,endColumn:c,startRow:l,endRow:l})});const s={unitId:r,subUnitId:i,ranges:g1(a)},u=Uc(this._injector,s);return{redos:[{id:Co.id,params:s}],undos:u}}return{redos:[],undos:[]}}}))}};sh=vje([yt(ot.Rendered,sh),i4(0,K(Ti)),i4(1,K(In)),i4(2,K(ae)),i4(3,K(wn))],sh);const bje=t=>t.getCurrentUniverSheetInstance().getUnitId(),_je=t=>t.getCurrentUniverSheetInstance().getActiveSheet().getSheetId();var Cje=Object.defineProperty,Sje=Object.getOwnPropertyDescriptor,Eje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Sje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Cje(e,n,i),i},yje=(t,e)=>(n,r)=>e(n,r,t),iv;let Sw=(iv=class extends b1{constructor(t,e){super(zm),this._injector=e}onStarting(){this._injector.add([Ly,{useClass:eh,lazy:!1}]),this._injector.add([nh]),this._injector.add([K9]),this._injector.add([ah]),this._injector.add([sh]),this._injector.add([th]),this._injector.add([Q7]),this._injector.add([J7]),this._injector.add([rh]),this._injector.add([oh])}},j0(iv,"type",Ir.Sheet),iv);Sw=Eje([yje(1,K(wn))],Sw);var Dje=Object.defineProperty,Rje=(t,e,n)=>e in t?Dje(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Rn=(t,e,n)=>(Rje(t,typeof e!="symbol"?e+"":e,n),n);const VH="formula-ui";class Ije extends We{constructor(){super(...arguments),Rn(this,"_dirtyConversionMap",new Map)}dispose(){this._dirtyConversionMap.clear()}remove(e){this._dirtyConversionMap.delete(e)}get(e){return this._dirtyConversionMap.get(e)}has(e){return this._dirtyConversionMap.has(e)}register(e,n){this._dirtyConversionMap.set(e,n)}getDirtyConversionMap(){return this._dirtyConversionMap}}const Py=ln("univer.formula.active-dirty-manager.service");var Aje=Object.defineProperty,Tje=Object.getOwnPropertyDescriptor,wje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Tje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Aje(e,n,i),i},ov=(t,e)=>(n,r)=>e(n,r,t);let uh=class extends We{constructor(t,e,n){super(),this._activeDirtyManagerService=t,this._currentUniverService=e,this._formulaDataModel=n,this._initialize()}_initialize(){this._initialConversion()}_initialConversion(){this._activeDirtyManagerService.register(Vt.id,{commandId:Vt.id,getDirtyData:t=>{const e=t.params;return e.trigger===ii.id?{}:{dirtyRanges:this._getSetRangeValuesMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(qa.id,{commandId:qa.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getMoveRangeMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(U0.id,{commandId:U0.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getMoveRowsMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(V0.id,{commandId:V0.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getMoveRowsMutationDirtyRange(e)}}}),this._activeDirtyManagerService.register(cl.id,{commandId:cl.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getRemoveRowOrColumnMutation(e,!0)}}}),this._activeDirtyManagerService.register(dl.id,{commandId:dl.id,getDirtyData:t=>{const e=t.params;return{dirtyRanges:this._getRemoveRowOrColumnMutation(e,!1)}}}),this._activeDirtyManagerService.register(Qo.id,{commandId:Qo.id,getDirtyData:t=>{const e=t.params;return{dirtyNameMap:this._getRemoveSheetMutation(e)}}}),this._activeDirtyManagerService.register(Eo.id,{commandId:Eo.id,getDirtyData:t=>{const e=t.params;return{dirtyNameMap:this._getInsertSheetMutation(e)}}})}_getSetRangeValuesMutationDirtyRange(t){const{subUnitId:e,unitId:n,cellValue:r}=t,i=[];return r==null||(i.push(...this._getDirtyRangesByCellValue(n,e,r)),i.push(...this._getDirtyRangesForArrayFormula(n,e,r))),i}_getMoveRangeMutationDirtyRange(t){const{unitId:e,from:n,to:r}=t,i=[];return i.push(...this._getDirtyRangesByCellValue(e,n.subUnitId,n.value)),i.push(...this._getDirtyRangesByCellValue(e,r.subUnitId,r.value)),i.push(...this._getDirtyRangesForArrayFormula(e,r.subUnitId,r.value)),i}_getMoveRowsMutationDirtyRange(t){const{subUnitId:e,unitId:n,sourceRange:r,targetRange:i}=t,o=[],a=this._rangeToMatrix(r).getData(),s=this._rangeToMatrix(i).getData();return o.push(...this._getDirtyRangesByCellValue(n,e,a)),o.push(...this._getDirtyRangesByCellValue(n,e,s)),o.push(...this._getDirtyRangesForArrayFormula(n,e,s)),o}_getDeleteRangeMutationDirtyRange(t){const{subUnitId:e,unitId:n,range:r,shiftDimension:i}=t,o=[],a=this._currentUniverService.getUniverSheetInstance(n),s=a==null?void 0:a.getSheetBySheetId(e),u=(s==null?void 0:s.getLastRowWithContent())||0,l=(s==null?void 0:s.getLastColumnWithContent())||0,c=new Ye;let d=null;const{startRow:m,startColumn:f,endRow:h,endColumn:p}=r;i===Tr.ROWS?d=this._rangeToMatrix({startRow:m,startColumn:f,endRow:u,endColumn:p}):i===Tr.COLUMNS&&(d=this._rangeToMatrix({startRow:m,startColumn:f,endRow:h,endColumn:l})),d!=null&&c.merge(d);const v=c.getData();return o.push(...this._getDirtyRangesByCellValue(n,e,v)),o.push(...this._getDirtyRangesForArrayFormula(n,e,v)),o}_getRemoveRowOrColumnMutation(t,e=!0){const{subUnitId:n,unitId:r,range:i}=t,o=[],a=this._currentUniverService.getUniverSheetInstance(r),s=a==null?void 0:a.getSheetBySheetId(n),u=(s==null?void 0:s.getRowCount())||0,l=(s==null?void 0:s.getColumnCount())||0,c=new Ye;let d=null;const{startRow:m,endRow:f,startColumn:h,endColumn:p}=i;e===!0?d=this._rangeToMatrix({startRow:m,startColumn:0,endRow:f,endColumn:l-1}):d=this._rangeToMatrix({startRow:0,startColumn:h,endRow:u,endColumn:p}),d!=null&&c.merge(d);const v=c.getData();return o.push(...this._getDirtyRangesByCellValue(r,n,v)),o.push(...this._getDirtyRangesForArrayFormula(r,n,v)),o}_getRemoveSheetMutation(t){const e={},{subUnitId:n,unitId:r,subUnitName:i}=t;return e[r]==null&&(e[r]={}),e[r][n]=i,e}_getInsertSheetMutation(t){const e={},{sheet:n,unitId:r}=t;return e[r]==null&&(e[r]={}),e[r][n.id]=n.name,e}_rangeToMatrix(t){const e=new Ye,{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;for(let a=n;a<=i;a++)for(let s=r;s<=o;s++)e.setValue(a,s,{});return e}_getDirtyRangesByCellValue(t,e,n){const r=[];return n==null||new Ye(n).getDiscreteRanges().forEach(i=>{r.push({unitId:t,sheetId:e,range:i})}),r}_getDirtyRangesForArrayFormula(t,e,n){var r,i;const o=[];if(n==null)return o;const a=new Ye(n),s=this._formulaDataModel.getArrayFormulaRange();if((r=s==null?void 0:s[t])!=null&&r[e]){const u=new Ye((i=s==null?void 0:s[t])==null?void 0:i[e]);a.forValue((l,c)=>{u.forValue((d,m,f)=>{if(f==null)return!0;const{startRow:h,startColumn:p,endRow:v,endColumn:g}=f;l>=h&&l<=v&&c>=p&&c<=g&&o.push({unitId:t,sheetId:e,range:{startRow:h,startColumn:p,endRow:h,endColumn:p}})})})}return o}};uh=wje([yt(ot.Ready,uh),ov(0,Py),ov(1,ae),ov(2,K(Ai))],uh);var Lje=Object.defineProperty,Oje=Object.getOwnPropertyDescriptor,Pje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Oje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Lje(e,n,i),i},o4=(t,e)=>(n,r)=>e(n,r,t);let lh=class extends We{constructor(t,e,n,r){super(),this._commandService=t,this._sheetInterceptorService=e,this._formulaDataModel=n,this._themeService=r,this._initialize()}_initialize(){this._commandExecutedListener(),this._initInterceptorCellContent()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id!==V1.id)return;const e=t.params;if(e==null)return;const{arrayFormulaRange:n,arrayFormulaCellData:r}=e;this._formulaDataModel.setArrayFormulaRange(n),this._formulaDataModel.setArrayFormulaCellData(r)}))}_initInterceptorCellContent(){this.disposeWithMe(this._sheetInterceptorService.intercept(Rs.CELL_CONTENT,{priority:100,handler:(t,e,n)=>{var r,i,o,a,s,u,l,c,d;const{unitId:m,subUnitId:f,row:h,col:p}=e,v=this._formulaDataModel.getArrayFormulaCellData(),g=this._formulaDataModel.getArrayFormulaRange(),b=(o=(i=(r=v==null?void 0:v[m])==null?void 0:r[f])==null?void 0:i[h])==null?void 0:o[p],C=(u=(s=(a=g==null?void 0:g[m])==null?void 0:a[f])==null?void 0:s[h])==null?void 0:u[p];if(b==null||C!=null&&C.startRow===h&&C.startColumn===p)return n(t);const S=(d=(c=(l=this._formulaDataModel.getNumfmtItemMap()[m])==null?void 0:l[f])==null?void 0:c[h])==null?void 0:d[p];if(S){const E=b==null?void 0:b.v,y=b==null?void 0:b.t;if(E==null||y!==$n.NUMBER)return n(t);const D=q8(S,E);if(D.color){const R=this._themeService.getCurrentTheme()[`${D.color}500`];return{...t,v:D.result,t:$n.STRING,s:{cl:{rgb:R}}}}return{...t,v:D.result,t:$n.STRING}}return n({...t,...b})}}))}};lh=Pje([yt(ot.Ready,lh),o4(0,se),o4(1,K(In)),o4(2,K(Ai)),o4(3,K(_i))],lh);var Mje=Object.defineProperty,Nje=Object.getOwnPropertyDescriptor,xje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Nje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Mje(e,n,i),i},Ew=(t,e)=>(n,r)=>e(n,r,t);let ch=class extends We{constructor(t,e){super(),this._autoFillService=t,this._lexerTreeBuilder=e,this._initialize()}_initialize(){this._registerAutoFill()}_registerAutoFill(){const t={type:Si.FORMULA,priority:1001,match:e=>$i(e==null?void 0:e.f)||La(e==null?void 0:e.si),isContinue:(e,n)=>e.type===Si.FORMULA,applyFunctions:{[tr.COPY]:(e,n,r,i)=>{const{data:o,index:a}=e;return this._fillCopyFormula(o,n,r,a,i)}}};this._autoFillService.registerRule(t)}_fillCopyFormula(t,e,n,r,i){var o,a;const s=$je(i),u=[],l=new Map;for(let c=1;c<=e;c++){const d=(c-1)%t.length,m=Ie.deepClone(t[d]);if(m){const f=((o=t[d])==null?void 0:o.f)||"",h=((a=t[d])==null?void 0:a.si)||"",p=$i(f);if(La(h))m.si=h,m.f=null,m.v=null,m.p=null,n===ye.DOWN||n===ye.RIGHT?u.push(m):u.unshift(m);else if(p){let v=l.get(d);if(v)m.si=v,m.f=null,m.v=null,m.p=null;else{v=Ie.generateRandomId(6),l.set(d,v);const{offsetX:g,offsetY:b}=Fje(s,n),C=this._lexerTreeBuilder.moveFormulaRefOffset(f,g,b);m.si=v,m.f=C,m.v=null,m.p=null}n===ye.DOWN||n===ye.RIGHT?u.push(m):u.unshift(m)}}}return u}};ch=xje([yt(ot.Ready,ch),Ew(0,vd),Ew(1,K(E1))],ch);function Fje(t,e){let n=0,r=0;switch(e){case ye.UP:r=-t;break;case ye.RIGHT:n=t;break;case ye.DOWN:r=t;break;case ye.LEFT:n=-t;break}return{offsetX:n,offsetY:r}}function $je(t){let e=0;for(const n in t)t[n].forEach(r=>{e+=r.data.length});return e}const HH="special-paste-formula",jH={id:"sheet.command.paste-formula",type:ue.COMMAND,handler:async t=>t.get(se).executeCommand(gd.id,{value:HH})};var kje=Object.defineProperty,Bje=Object.getOwnPropertyDescriptor,Uje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Bje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&kje(e,n,i),i},a4=(t,e)=>(n,r)=>e(n,r,t);const Vje="default-paste-formula";let dh=class extends We{constructor(t,e,n,r){super(),this._currentUniverSheet=t,this._lexerTreeBuilder=e,this._sheetClipboardService=n,this._injector=r,this._initialize()}_initialize(){this._registerClipboardHook()}_registerClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._pasteFormulaHook())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._pasteWithFormulaHook()))}_pasteFormulaHook(){return{id:HH,priority:10,specialPasteInfo:{label:"specialPaste.formula"},onPasteCells:(t,e,n,r)=>{const i={copyType:r.copyType||_s.COPY,copyRange:t==null?void 0:t.range},o=e.range,a=n,s=this._currentUniverSheet.getCurrentUniverSheetInstance(),u=s.getUnitId(),l=s.getActiveSheet().getSheetId();return this._injector.invoke(c=>yw(u,l,o,a,c,i,this._lexerTreeBuilder,!0))}}}_pasteWithFormulaHook(){return{id:Vje,priority:10,onPasteCells:(t,e,n,r)=>{const i={copyType:r.copyType||_s.COPY,copyRange:t==null?void 0:t.range},o=e.range,a=n,s=this._currentUniverSheet.getCurrentUniverSheetInstance(),u=s.getUnitId(),l=s.getActiveSheet().getSheetId();return this._injector.invoke(c=>yw(u,l,o,a,c,i,this._lexerTreeBuilder))}}}};dh=Uje([yt(ot.Ready,dh),a4(0,ae),a4(1,K(E1)),a4(2,r2),a4(3,K(wn))],dh);function yw(t,e,n,r,i,o,a,s=!1){const u=[],l=[],{startColumn:c,startRow:d}=n,m=new Ye,f=new Map;let h=0,p=0,v=0,g=0;if(o){const{copyType:S,copyRange:E}=o;S===_s.COPY&&E&&(v=E.startRow,g=E.startColumn,h=E.endRow-v+1,p=E.endColumn-g+1)}r.forValue((S,E,y)=>{const D=y.f||"",R={};if(s&&(R.v=y.v),$i(D)&&h&&p){const I=S%h,T=E%p,P=`${I}_${T}`;let N=f.get(P);if(N)R.si=N,R.f=null,R.v=null,R.p=null;else{N=Ie.generateRandomId(6),f.set(P,N);const B=E+c-(g+T),W=S+d-(v+I),G=a.moveFormulaRefOffset(D,B,W);R.si=N,R.f=G,R.v=null,R.p=null}}m.setValue(S+d,E+c,R)});const b={unitId:t,subUnitId:e,cellValue:m.getData()};u.push({id:Vt.id,params:b});const C=ci(i,b);return l.push({id:Vt.id,params:C}),{undos:l,redos:u}}var Hje=Object.defineProperty,jje=Object.getOwnPropertyDescriptor,zje=(t,e,n,r)=>{for(var i=r>1?void 0:r?jje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Hje(e,n,i),i},O1=(t,e)=>(n,r)=>e(n,r,t);let mh=class extends We{constructor(t,e,n,r,i,o,a,s,u){super(),Rn(this,"_previousShape"),this._editorBridgeService=t,this._formulaDataModel=e,this._lexerTreeBuilder=n,this._themeService=r,this._renderManagerService=i,this._selectionRenderService=o,this._sheetSkeletonManagerService=a,this._commandService=s,this._sheetInterceptorService=u,this._initInterceptorEditorStart(),this._commandExecutedListener(),this._initInterceptorCell()}_initInterceptorEditorStart(){this.disposeWithMe(je(this._editorBridgeService.interceptor.intercept(this._editorBridgeService.interceptor.getInterceptPoints().BEFORE_CELL_EDIT,{handler:(t,e,n)=>{var r,i,o,a;const{row:s,col:u,unitId:l,subUnitId:c,worksheet:d}=e,m=this._formulaDataModel.getArrayFormulaRange(),f=this._formulaDataModel.getArrayFormulaCellData();if(this._removeArrayFormulaRangeShape(),t==null)return n(t);let h=null;const p=this._formulaDataModel.getFormulaDataItem(s,u,c,l);if(p!=null){const{f:g,si:b,x:C=0,y:S=0}=p;if(b!=null&&(C>0||S>0)){let E="";if(g.length>0)E=g;else{const y=this._formulaDataModel.getFormulaItemBySId(b,c,l);if(y==null||y.f.length===0)return n(t);E=y.f}h={f:this._lexerTreeBuilder.moveFormulaRefOffset(E,C,S)}}}if(t.v!=null&&t.v!==""&&((o=(i=(r=f[l])==null?void 0:r[c])==null?void 0:i[s])==null?void 0:o[u])==null)return h||n(t);const v=(a=m==null?void 0:m[l])==null?void 0:a[c];return v!=null&&new Ye(v).forValue((g,b,C)=>{if(C==null)return!0;const{startRow:S,startColumn:E,endRow:y,endColumn:D}=C;if(g===s&&b===u)return this._createArrayFormulaRangeShape(C,l),!1;if(s>=S&&s<=y&&u>=E&&u<=D){const R=d.getCell(S,E);if((R==null?void 0:R.v)===k.SPILL)return;const I=this._formulaDataModel.getFormulaDataItem(g,b,c,l);return I==null||I.f==null?!0:(h==null&&(h={f:I.f,isInArrayFormulaRange:!0}),this._createArrayFormulaRangeShape(C,l),!1)}}),h||n(t)}})))}_initInterceptorCell(){this.disposeWithMe(this._sheetInterceptorService.intercept(Rs.CELL_CONTENT,{handler:(t,e,n)=>{var r,i,o;const{row:a,col:s,unitId:u,subUnitId:l}=e,c=this._formulaDataModel.getArrayFormulaCellData(),d=(o=(i=(r=c==null?void 0:c[u])==null?void 0:r[l])==null?void 0:i[a])==null?void 0:o[s];return n(d?{...t,...d}:t)}}))}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((t,e)=>{(t.id===w8.id||t.id===V1.id&&e&&e.remove)&&this._removeArrayFormulaRangeShape()}))}_createArrayFormulaRangeShape(t,e){var n;const r=this._themeService.getCurrentTheme(),i=new Xo(r.colorWhite).setAlpha(0).toString(),o={strokeWidth:1,stroke:r.hyacinth700,fill:i,widgets:{},hasAutoFill:!1,hasRowHeader:!1,hasColumnHeader:!1},{scene:a}=this._renderManagerService.getRenderById(e)||{},{rangeWithCoord:s,primaryWithCoord:u}=this._selectionRenderService.convertSelectionRangeToData({range:t,primary:null,style:o}),l=(n=this._sheetSkeletonManagerService.getCurrent())==null?void 0:n.skeleton;if(!a||!l)return;const{rowHeaderWidth:c,columnHeaderHeight:d}=l,m=new j9(a,100,!1,this._themeService);m.update(s,c,d,o,u),m.setEvent(!1),this._previousShape=m}_removeArrayFormulaRangeShape(){this._previousShape!=null&&(this._previousShape.dispose(),this._previousShape=null)}};mh=zje([yt(ot.Rendered,mh),O1(0,K(Oo)),O1(1,K(Ai)),O1(2,K(E1)),O1(3,K(_i)),O1(4,Jn),O1(5,Hi),O1(6,K(Dr)),O1(7,se),O1(8,K(In))],mh);const My={id:"formula-ui.operation.change-ref-to-absolute",type:ue.OPERATION,handler:async t=>!0};class Wje{constructor(){Rn(this,"_sequenceNodes",[]),Rn(this,"_isSelectionMoving",!1),Rn(this,"_isLockedOnSelectionChangeRefString",!1),Rn(this,"_isLockedOnSelectionInsertRefString",!1),Rn(this,"_syncToEditor$",new an),Rn(this,"syncToEditor$",this._syncToEditor$.asObservable()),Rn(this,"_changeRef$",new an),Rn(this,"changeRef$",this._changeRef$.asObservable()),Rn(this,"_inputFormula$",new an),Rn(this,"inputFormula$",this._inputFormula$.asObservable())}dispose(){this._sequenceNodes=[]}inputFormula(e){this._inputFormula$.next(e)}syncToEditor(e){this._syncToEditor$.next({sequences:this.getSequenceNodes(),textSelectionOffset:e})}getSequenceNodes(){return[...this._sequenceNodes]}setSequenceNodes(e){this._sequenceNodes=e}clearSequenceNodes(){this._sequenceNodes=[]}getCurrentSequenceNode(e){return this._sequenceNodes[this.getCurrentSequenceNodeIndex(e)]}getCurrentSequenceNodeByIndex(e){return this._sequenceNodes[e]}getCurrentSequenceNodeIndex(e){let n=0;for(let r=0,i=this._sequenceNodes.length;r<i;r++){const o=this._sequenceNodes[r];if(typeof o=="string")n++;else{const{endIndex:a}=o;n=a}if(e<=n)return r}return this._sequenceNodes.length}updateSequenceRef(e,n){const r=this._sequenceNodes[e];if(typeof r=="string"||r.nodeType!==ni.REFERENCE)return;const i=n.length-r.token.length,o={...r};o.token=n,o.endIndex+=i,this._sequenceNodes[e]=o;for(let a=e+1,s=this._sequenceNodes.length;a<s;a++){const u=this._sequenceNodes[a];if(typeof u=="string")continue;const l={...u};l.startIndex+=i,l.endIndex+=i,this._sequenceNodes[a]=l}this._changeRef$.next(!0)}insertSequenceRef(e,n){const r=n.length,i=this.getCurrentSequenceNodeIndex(e);this._sequenceNodes.splice(i,0,{token:n,startIndex:e,endIndex:e+r-1,nodeType:ni.REFERENCE});for(let o=i+1,a=this._sequenceNodes.length;o<a;o++){const s=this._sequenceNodes[o];if(typeof s=="string")continue;const u={...s};u.startIndex+=r,u.endIndex+=r,this._sequenceNodes[o]=u}this._changeRef$.next(!0)}insertSequenceString(e,n){const r=this.getCurrentSequenceNodeIndex(e),i=n.split("");this._sequenceNodes.splice(r,0,...i);const o=i.length;for(let a=r+o,s=this._sequenceNodes.length;a<s;a++){const u=this._sequenceNodes[a];if(typeof u=="string")continue;const l={...u};l.startIndex+=o,l.endIndex+=o,this._sequenceNodes[a]=l}this._changeRef$.next(!0)}enableSelectionMoving(){this._isSelectionMoving=!0}disableSelectionMoving(){this._isSelectionMoving=!1}isSelectionMoving(){return this._isSelectionMoving}enableLockedSelectionChange(){this._isLockedOnSelectionChangeRefString=!0}disableLockedSelectionChange(){this._isLockedOnSelectionChangeRefString=!1}isLockedSelectionChange(){return this._isLockedOnSelectionChangeRefString}enableLockedSelectionInsert(){this._isLockedOnSelectionInsertRefString=!0}disableLockedSelectionInsert(){this._isLockedOnSelectionInsertRefString=!1}isLockedSelectionInsert(){return this._isLockedOnSelectionInsertRefString}}const zf=ln("formula-ui.input-service");var Yje=Object.defineProperty,Xje=Object.getOwnPropertyDescriptor,qje=(t,e,n,r)=>{for(var i=r>1?void 0:r?Xje(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&Yje(e,n,i),i},zl=(t,e)=>(n,r)=>e(n,r,t);let fh=class extends We{constructor(t,e,n,r,i,o,a){super(),Rn(this,"_userCursorMove",!1),this._commandService=t,this._textSelectionRenderManager=e,this._editorBridgeService=n,this._lexerTreeBuilder=r,this._renderManagerService=i,this._formulaInputService=o,this._textSelectionManagerService=a,this._initialize()}_initialize(){this._commandExecutedListener(),this._initialEditorInputChange(),this._userMouseListener(),this._inputFormulaListener()}_initialEditorInputChange(){this.disposeWithMe(je(this._textSelectionRenderManager.onInputBefore$.subscribe(t=>{const e=t==null?void 0:t.event;e!=null&&e.which!==Ge.F4&&(this._userCursorMove=!1)})))}_userMouseListener(){const t=this._getEditorObject();if(t==null)return;const{document:e}=t;this.disposeWithMe(je(e.onPointerDownObserver.add(()=>{this._userCursorMove=!0})))}_inputFormulaListener(){this.disposeWithMe(je(this._formulaInputService.inputFormula$.subscribe(t=>{this._editorBridgeService.isVisible().visible===!1&&this._editorBridgeService.changeVisible({visible:!0,eventType:dr.Dblclick});const e=this._lexerTreeBuilder.sequenceNodesBuilder(t)||[];this._formulaInputService.setSequenceNodes(e),this._formulaInputService.syncToEditor(t.length-1)})))}_changeRefString(){const t=this._textSelectionManagerService.getActiveRange();if(t==null)return;const{startOffset:e}=t,n=e-2,r=this._formulaInputService.getCurrentSequenceNodeIndex(n),i=this._formulaInputService.getCurrentSequenceNodeByIndex(r);if(i==null||typeof i=="string"||i.nodeType!==ni.REFERENCE)return;const o=i.token.split("!");let a=i.token;o.length>1&&(a=o[o.length-1]);let s="";for(let c=0,d=o.length;c<d-1;c++)s+=o[c];let u=a;if(a.indexOf(bn.COLON)>-1)if(!this._userCursorMove)u=this._changeRangeRef(a);else{const c=a.split(bn.COLON),d=c[0],m=c[1];n-i.startIndex<=d.length?u=this._changeSingleRef(d)+bn.COLON+m:u=d+bn.COLON+this._changeSingleRef(m)}else u=this._changeSingleRef(a);u=s+u;const l=u.length-i.token.length;this._formulaInputService.updateSequenceRef(r,u),this._formulaInputService.syncToEditor(n+l+1)}_changeRangeRef(t){const e=Ms(t).range;let n="";return e.startAbsoluteRefType===Hn.NONE||e.startAbsoluteRefType==null?(e.startAbsoluteRefType=Hn.ALL,e.endAbsoluteRefType=Hn.ALL):(e.startAbsoluteRefType=Hn.NONE,e.endAbsoluteRefType=Hn.NONE),n=p1(e),n}_changeSingleRef(t){const e=Ms(t).range,n=e.startAbsoluteRefType;let r="";return n===Hn.NONE||n==null?(e.startAbsoluteRefType=Hn.ALL,e.endAbsoluteRefType=Hn.ALL):n===Hn.ALL?(e.startAbsoluteRefType=Hn.ROW,e.endAbsoluteRefType=Hn.ROW):n===Hn.ROW?(e.startAbsoluteRefType=Hn.COLUMN,e.endAbsoluteRefType=Hn.COLUMN):(e.startAbsoluteRefType=Hn.NONE,e.endAbsoluteRefType=Hn.NONE),r=p1(e),r}_commandExecutedListener(){const t=[My.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{t.includes(e.id)&&this._changeRefString()}))}_getEditorObject(){return bc(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};fh=qje([yt(ot.Steady,fh),zl(0,se),zl(1,To),zl(2,K(Oo)),zl(3,K(E1)),zl(4,Jn),zl(5,zf),zl(6,K(kr))],fh);const zH={id:"formula-ui.command.insert-function",type:ue.COMMAND,handler:async(t,e)=>{const{list:n}=e,r=t.get(se),i=new Ye;n.forEach(a=>{const{range:s,primary:u,formula:l}=a,{row:c,column:d}=u,m=Ie.generateRandomId(6);i.setValue(c,d,{f:l,si:m});const{startRow:f,startColumn:h,endRow:p,endColumn:v}=s;for(let g=f;g<=p;g++)for(let b=h;b<=v;b++)(g!==c||b!==d)&&i.setValue(g,b,{si:m})});const o={value:i.getData()};return r.executeCommand(Ga.id,o)}},Dd={id:"formula-ui.operation.select-editor-formula",type:ue.OPERATION,handler:(t,e)=>!0},a2=ln("formula-ui.prompt-service");class Gje{constructor(){Rn(this,"_search$",new an),Rn(this,"_help$",new an),Rn(this,"_navigate$",new an),Rn(this,"_accept$",new an),Rn(this,"_acceptFormulaName$",new an),Rn(this,"search$",this._search$.asObservable()),Rn(this,"help$",this._help$.asObservable()),Rn(this,"navigate$",this._navigate$.asObservable()),Rn(this,"accept$",this._accept$.asObservable()),Rn(this,"acceptFormulaName$",this._acceptFormulaName$.asObservable()),Rn(this,"_searching",!1),Rn(this,"_helping",!1),Rn(this,"_isInsertRefString",!1)}dispose(){this._search$.complete(),this._help$.complete(),this._navigate$.complete(),this._accept$.complete(),this._acceptFormulaName$.complete()}search(e){this._searching=e.visible,this._search$.next(e)}isSearching(){return this._searching}help(e){this._helping=e.visible,this._help$.next(e)}isHelping(){return this._helping}navigate(e){this._navigate$.next(e)}accept(e){this._accept$.next(e)}acceptFormulaName(e){this._acceptFormulaName$.next(e)}}const fC={id:"formula-ui.operation.help-function",type:ue.OPERATION,handler:async(t,e)=>(t.get(a2).help(e),!0)},Ny={id:"formula-ui.operation.insert-function",type:ue.OPERATION,handler:async(t,e)=>{var n,r;const i=t.get(dt),o=t.get(zf),a=i.getSelections();if(!a||!a.length)return!1;const s=t.get(ae).getCurrentUniverSheetInstance(),u=s.getActiveSheet(),l=s.getUnitId(),c=u.getSheetId(),d=u.getCellMatrix(),{value:m}=e,f=t.get(se),h=[];let p=null,v=0,g=0,b="";if(a.length===1&&(Qje(a[0].range)||Jje(a[0].range))){const{range:C,primary:S}=a[0],E=(n=S==null?void 0:S.actualRow)!=null?n:C.startRow,y=(r=S==null?void 0:S.actualColumn)!=null?r:C.startColumn;p=C,v=E,g=y;const D=Dw(d,E,y);D&&(b=p1(D))}else a.some(C=>{var S,E;const{range:y,primary:D}=C,R=(S=D==null?void 0:D.actualRow)!=null?S:y.startRow,I=(E=D==null?void 0:D.actualColumn)!=null?E:y.startColumn,T=Dw(d,R,I);if(!T)return p=y,v=R,g=I,!0;const P=p1(T),N=`=${m}(${P})`;return h.push({range:y,primary:{row:R,column:I},formula:N}),!1});if(p){const C=k9(v,g,u),S={range:ht.clone(p),primary:{startRow:C.startRow,startColumn:C.startColumn,endRow:C.endRow,endColumn:C.endColumn,actualRow:v,actualColumn:g,isMerged:C.isMerged,isMergedMainCell:C.startRow===v&&C.startColumn===g}},E={unitId:l,subUnitId:c,pluginName:Nn,selections:[S]};await f.executeCommand(_n.id,E),setTimeout(()=>{o.inputFormula(`=${m}(${b}`)},0)}return h.length===0?!1:f.executeCommand(zH.id,{list:h})}};function Dw(t,e,n){const r=Kje(t,e,n);if(r!==e)return{startRow:r,endRow:e-1,startColumn:n,endColumn:n};const i=Zje(t,e,n);return i!==n?{startRow:e,endRow:e,startColumn:i,endColumn:n-1}:null}function Kje(t,e,n){let r=!1;if(e===0)return e;for(let i=e-1;i>=0;i--){const o=t.getValue(i,n);if(Z9(o)&&!r){if(i===0)return 0;r=!0}else{if(r&&!Z9(o))return i+1;if(r&&i===0)return 0}}return e}function Zje(t,e,n){let r=!1;if(n===0)return n;for(let i=n-1;i>=0;i--){const o=t.getValue(e,i);if(Z9(o)&&!r){if(i===0)return 0;r=!0}else{if(r&&!Z9(o))return i+1;if(r&&i===0)return 0}}return n}function Z9(t){if(t!=null&&t.p){const e=t==null?void 0:t.p.body;if(e==null)return!1;const n=e.dataStream,r=n.substring(n.length-2,n.length)===Sc?n.substring(0,n.length-2):n;return n5(r)}return t&&(t.t===$n.NUMBER||aY(t)===$n.NUMBER)}function Qje(t){return t.startRow===t.endRow&&t.startColumn===t.endColumn}function Jje(t){return t.startRow!==t.endRow&&t.startColumn!==t.endColumn}const WH=`${VH}_MORE_FUNCTIONS_COMPONENT`,YH={id:"formula-ui.operation.more-functions",type:ue.OPERATION,handler:async t=>(t.get(cd).open({header:{title:"formula.insert.tooltip"},children:{label:WH}}),!0)},hC={id:"formula-ui.operation.search-function",type:ue.OPERATION,handler:async(t,e)=>(t.get(a2).search(e),!0)};var XH={exports:{}},K8={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eze=Se,tze=Symbol.for("react.element"),nze=Symbol.for("react.fragment"),rze=Object.prototype.hasOwnProperty,ize=eze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oze={key:!0,ref:!0,__self:!0,__source:!0};function qH(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)rze.call(e,r)&&!oze.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:tze,type:t,key:o,ref:a,props:i,_owner:ize.current}}K8.Fragment=nze;K8.jsx=qH;K8.jsxs=qH;XH.exports=K8;var At=XH.exports;const aze="univer-formula-error-function",sze={formulaErrorFunction:aze};function uze(){const[t,e]=_.useState(!1),[n,r]=_.useState({left:0,top:0}),i=Ct(a2),o=Ct(o2);return _.useEffect(()=>{const a=i.help$.subscribe(s=>{const u=o.getState();if(!u)return;const{visible:l}=s;if(!l){e(l);return}const{endX:c=0,startY:d=0}=u;r({left:c,top:d}),e(l)});return()=>{a==null||a.unsubscribe()}},[]),t?At.jsx("div",{className:sze.formulaErrorFunction,style:{left:n.left,top:n.top}}):null}var ka=function(){return ka=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ka.apply(this,arguments)},lze=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n},Wf=_.forwardRef(function(t,e){var n=t.icon,r=t.id,i=t.className,o=t.extend,a=lze(t,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(r," ").concat(i||"").trim(),u=_.useRef("_".concat(mze()));return GH(n,"".concat(r),{defIds:n.defIds,idSuffix:u.current},ka({ref:e,className:s},a),o)});function GH(t,e,n,r,i){return _.createElement(t.tag,ka(ka({key:e},cze(t,n,i)),r),(dze(t,n).children||[]).map(function(o,a){return GH(o,"".concat(e,"-").concat(t.tag,"-").concat(a),n,void 0,i)}))}function cze(t,e,n){var r=ka({},t.attrs);n!=null&&n.colorChannel1&&r.fill==="colorChannel1"&&(r.fill=n.colorChannel1);var i=e.defIds;return!i||i.length===0||(t.tag==="use"&&r["xlink:href"]&&(r["xlink:href"]=r["xlink:href"]+e.idSuffix),Object.entries(r).forEach(function(o){var a=o[0],s=o[1];typeof s=="string"&&(r[a]=s.replace(/url\(#(.*)\)/,"url(#$1".concat(e.idSuffix,")")))})),r}function dze(t,e){var n,r=e.defIds;return!r||r.length===0?t:t.tag==="defs"&&!((n=t.children)===null||n===void 0)&&n.length?ka(ka({},t),{children:t.children.map(function(i){return typeof i.attrs.id=="string"&&r&&r.indexOf(i.attrs.id)>-1?ka(ka({},i),{attrs:ka(ka({},i.attrs),{id:i.attrs.id+e.idSuffix})}):i})}):t}function mze(){return Math.random().toString(36).substring(2,8)}Wf.displayName="UniverIcon";var fze={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.44 3.57291C14.698 3.83093 14.698 4.24927 14.44 4.50729L6.44342 12.5037C6.28721 12.6599 6.03395 12.6599 5.87774 12.5037L1.55992 8.18578C1.3019 7.92776 1.3019 7.50942 1.55993 7.2514C1.81795 6.99338 2.23629 6.99338 2.49431 7.25141L6.01916 10.7763C6.09727 10.8544 6.2239 10.8544 6.30201 10.7763L13.5056 3.57291C13.7636 3.31489 14.1819 3.31489 14.44 3.57291Z",fillRule:"evenodd",clipRule:"evenodd"}}]},KH=_.forwardRef(function(t,e){return _.createElement(Wf,Object.assign({},t,{id:"check-mark-single",ref:e,icon:fze}))});KH.displayName="CheckMarkSingle";const hze=KH;var pze={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.57061 3.65132C4.31677 3.39748 3.90521 3.39748 3.65137 3.65132C3.39753 3.90516 3.39753 4.31672 3.65137 4.57056L7.08079 7.99998L3.65123 11.4295C3.39739 11.6834 3.39739 12.0949 3.65123 12.3488C3.90507 12.6026 4.31662 12.6026 4.57047 12.3488L8.00003 8.91921L11.4295 12.3487C11.6834 12.6026 12.0949 12.6026 12.3488 12.3487C12.6026 12.0949 12.6026 11.6833 12.3488 11.4295L8.91927 7.99998L12.3486 4.57061C12.6025 4.31677 12.6025 3.90521 12.3486 3.65137C12.0948 3.39753 11.6832 3.39753 11.4294 3.65137L8.00003 7.08074L4.57061 3.65132Z"}}]},ZH=_.forwardRef(function(t,e){return _.createElement(Wf,Object.assign({},t,{id:"close-single",ref:e,icon:pze}))});ZH.displayName="CloseSingle";const gze=ZH;var vze={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_891",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{fill:"currentColor",mask:"url(#mask0_102_891)"},children:[{tag:"path",attrs:{d:"M8.7965 5.29175C8.7965 5.73167 8.43988 6.08829 7.99996 6.08829 7.56005 6.08829 7.20343 5.73167 7.20343 5.29175 7.20343 4.85184 7.56005 4.49522 7.99996 4.49522 8.43988 4.49522 8.7965 4.85184 8.7965 5.29175zM8.63719 7.68135C8.63719 7.32942 8.35189 7.04413 7.99996 7.04413 7.64803 7.04413 7.36274 7.32942 7.36274 7.68135V11.5047C7.36274 11.8566 7.64803 12.1419 7.99996 12.1419 8.35189 12.1419 8.63719 11.8566 8.63719 11.5047V7.68135z"}},{tag:"path",attrs:{d:"M0.990479 7.99996C0.990479 4.12873 4.12873 0.990479 7.99996 0.990479C11.8712 0.990479 15.0094 4.12873 15.0094 7.99996C15.0094 11.8712 11.8712 15.0094 7.99996 15.0094C4.12873 15.0094 0.990479 11.8712 0.990479 7.99996ZM7.99996 2.26493C4.83259 2.26493 2.26493 4.83259 2.26493 7.99996C2.26493 11.1673 4.83259 13.735 7.99996 13.735C11.1673 13.735 13.735 11.1673 13.735 7.99996C13.735 4.83259 11.1673 2.26493 7.99996 2.26493Z",fillRule:"evenodd",clipRule:"evenodd"}}]}]},QH=_.forwardRef(function(t,e){return _.createElement(Wf,Object.assign({},t,{id:"details-single",ref:e,icon:vze}))});QH.displayName="DetailsSingle";const bze=QH;var _ze={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.45493 2.80093C5.74783 2.49409 6.2227 2.49409 6.5156 2.80093L11.0156 7.51523C11.3085 7.82207 11.3085 8.31956 11.0156 8.6264L6.44488 13.27C6.15199 13.5768 5.67711 13.5768 5.38422 13.27C5.09133 12.9631 5.09133 12.4656 5.38422 12.1588L9.28804 8.20898C9.36409 8.13203 9.36517 8.00855 9.29047 7.93029L5.45493 3.9121C5.16204 3.60526 5.16204 3.10777 5.45493 2.80093Z",fillRule:"evenodd",clipRule:"evenodd"}}]},JH=_.forwardRef(function(t,e){return _.createElement(Wf,Object.assign({},t,{id:"more-single",ref:e,icon:_ze}))});JH.displayName="MoreSingle";const Cze=JH,Sze="univer-formula-help-function",Eze="univer-formula-help-function-title",yze="univer-formula-help-function-title-icons",Dze="univer-formula-help-function-title-icon",Rze="univer-formula-help-function-content",Ize="univer-formula-help-function-content-inner",Aze="univer-formula-help-function-content-params",Tze="univer-formula-help-function-content-params-title",wze="univer-formula-help-function-content-params-detail",Lze="univer-formula-help-function-active",Oze="univer-formula-help-decorator",oa={formulaHelpFunction:Sze,formulaHelpFunctionTitle:Eze,formulaHelpFunctionTitleIcons:yze,formulaHelpFunctionTitleIcon:Dze,formulaHelpFunctionContent:Rze,formulaHelpFunctionContentInner:Ize,formulaHelpFunctionContentParams:Aze,formulaHelpFunctionContentParamsTitle:Tze,formulaHelpFunctionContentParamsDetail:wze,formulaHelpFunctionActive:Lze,formulaHelpDecorator:Oze};function Pze(){const[t,e]=_.useState(!1),[n,r]=_.useState(!0),[i,o]=_.useState(!0),[a,s]=_.useState(0),[u,l]=_.useState([0,0]),[c,d]=_.useState({left:0,top:0}),[m,f]=_.useState(null),h=Ct(a2),p=Ct(o2),v=Ct(Gt),g=Ct(Bf),b=Ct(pr),C=v.t("formula.prompt.required"),S=v.t("formula.prompt.optional");_.useEffect(()=>{const y=h.help$.subscribe(D=>{const{visible:R,paramIndex:I,functionInfo:T}=D;if(!R){e(R);return}const P=b.getContextValue(W1)?g.getPosition():p.getRect();if(P==null)return;const{left:N,top:B,height:W}=P;T.description===""&&T.functionParameter.length===0||(l([N,B+W]),s(I),f(T),d({left:N,top:B}),e(R))});return()=>{y==null||y.unsubscribe()}},[]);function E(y){s(y)}return At.jsx(At.Fragment,{children:i?At.jsx(uE,{visible:t,offset:u,children:m?At.jsxs("div",{className:oa.formulaHelpFunction,children:[At.jsxs("div",{className:oa.formulaHelpFunctionTitle,children:[At.jsx(Mze,{prefix:m.functionName,value:m.functionParameter,active:a,onClick:E}),At.jsxs("div",{className:oa.formulaHelpFunctionTitleIcons,children:[At.jsx("div",{className:oa.formulaHelpFunctionTitleIcon,style:{transform:n?"rotateZ(-90deg)":"rotateZ(90deg)"},onClick:()=>r(!n),children:At.jsx(Cze,{})}),At.jsx("div",{className:oa.formulaHelpFunctionTitleIcon,onClick:()=>o(!i),children:At.jsx(gze,{})})]})]}),At.jsx("div",{className:oa.formulaHelpFunctionContent,style:{height:n?"unset":0,padding:n?"revert-layer":0},children:At.jsxs("div",{className:oa.formulaHelpFunctionContentInner,children:[At.jsx(av,{title:v.t("formula.prompt.helpExample"),value:`${m.functionName}(${m.functionParameter.map(y=>y.example).join(",")})`}),At.jsx(av,{title:v.t("formula.prompt.helpAbstract"),value:m.description}),m&&m.functionParameter&&m.functionParameter.map((y,D)=>At.jsx(av,{className:a===D?oa.formulaHelpFunctionActive:"",title:y.name,value:`${y.require?C:S} ${y.detail}`},D))]})})]}):At.jsx(At.Fragment,{})}):t?At.jsx("div",{className:oa.formulaHelpDecorator,onClick:()=>o(!i),style:{left:c.left-24,top:c.top},children:At.jsx(bze,{})}):At.jsx(At.Fragment,{})})}const av=t=>At.jsxs("div",{className:oa.formulaHelpFunctionContentParams,children:[At.jsx("div",{className:`${oa.formulaHelpFunctionContentParamsTitle} ${t.className}`,children:t.title}),At.jsx("div",{className:oa.formulaHelpFunctionContentParamsDetail,children:t.value})]}),Mze=t=>{const{prefix:e,value:n,active:r,onClick:i}=t;return At.jsxs("div",{children:[At.jsxs("span",{children:[e,"("]}),n&&n.map((o,a)=>At.jsxs("span",{children:[At.jsx("span",{className:r===a?oa.formulaHelpFunctionActive:"",onClick:()=>i(a),children:o.repeat?`[${o.name},...]`:o.name}),a===n.length-1?"":","]},a)),")"]})},Nze="univer-formula-search-function",xze="univer-formula-search-function-item",Fze="univer-formula-search-function-item-name",$ze="univer-formula-search-function-item-name-light",kze="univer-formula-search-function-item-desc",Bze="univer-formula-search-function-item-active",Du={formulaSearchFunction:Nze,formulaSearchFunctionItem:xze,formulaSearchFunctionItemName:Fze,formulaSearchFunctionItemNameLight:$ze,formulaSearchFunctionItemDesc:kze,formulaSearchFunctionItemActive:Bze};function Uze(){const[t,e]=_.useState(!1),[n,r]=_.useState(0),[i,o]=_.useState([0,0]),[a,s]=_.useState([]),[u,l]=_.useState(""),c=_.useRef(null),d=Ct(a2),m=Ct(o2),f=Ct(Bf),h=Ct(pr);_.useEffect(()=>{let b=[],C=0;const S=d.search$.subscribe(D=>{const{visible:R,searchText:I,searchList:T}=D;if(!R){e(R);return}const P=h.getContextValue(W1)?f.getPosition():m.getRect();if(P==null)return;const{left:N,top:B,height:W}=P;l(I),s(T),b=T,o([N,B+W]),e(R),r(0),C=0}),E=d.navigate$.subscribe(D=>{const{direction:R}=D;if(R===ye.UP){let I=C-1;I=I<0?b.length-1:I,r(I),C=I}else if(R===ye.DOWN){let I=C+1;I=I>=b.length?0:I,r(I),C=I}g(C)}),y=d.accept$.subscribe(D=>{const R=b[C].name;d.acceptFormulaName(R)});return()=>{S==null||S.unsubscribe(),E==null||E.unsubscribe(),y==null||y.unsubscribe()}},[]);function p(b){r(b)}function v(){r(-1)}function g(b){var C;const S=(C=c.current)==null?void 0:C.querySelectorAll(`.${Du.formulaSearchFunctionItem}`)[b];if(!S)return;const E=S.parentNode;if(!E)return;const y=E.getBoundingClientRect().top,D=E.offsetHeight,R=S.getBoundingClientRect(),I=R.top,T=R.height;if(I>=0&&I>y&&I-y+T<=D)return;const P=S.offsetTop-(D-T)/2;E.scrollTo({top:P,behavior:"smooth"})}return At.jsx(uE,{visible:t,offset:i,children:At.jsx("ul",{className:Du.formulaSearchFunction,ref:c,children:a.map((b,C)=>At.jsxs("li",{className:n===C?`${Du.formulaSearchFunctionItem} ${Du.formulaSearchFunctionItemActive}`:Du.formulaSearchFunctionItem,onMouseEnter:()=>p(C),onMouseLeave:v,onClick:()=>d.acceptFormulaName(b.name),children:[At.jsxs("span",{className:Du.formulaSearchFunctionItemName,children:[At.jsx("span",{className:Du.formulaSearchFunctionItemNameLight,children:u}),At.jsx("span",{children:b.name.slice(u.length)})]}),At.jsx("span",{className:Du.formulaSearchFunctionItemDesc,children:b.desc})]},C))})})}function Vze(){return At.jsxs(At.Fragment,{children:[At.jsx(Uze,{}),At.jsx(Pze,{}),At.jsx(uze,{})]})}const Hze="univer-formula-more-functions",jze="univer-formula-more-functions-operation",Rw={formulaMoreFunctions:Hze,formulaMoreFunctionsOperation:jze};function ej(t){const{prefix:e,value:n}=t;return At.jsxs("div",{children:[At.jsxs("span",{children:[e,"("]}),n&&n.map((r,i)=>At.jsxs("span",{children:[At.jsx("span",{children:r.repeat?`[${r.name},...]`:r.name}),i===n.length-1?"":","]},i)),")"]})}const zze="univer-formula-function-params",Wze="univer-formula-function-params-title",Yze="univer-formula-function-params-detail",sv={formulaFunctionParams:zze,formulaFunctionParamsTitle:Wze,formulaFunctionParamsDetail:Yze};function R6(t){const{className:e,value:n,title:r}=t;return At.jsxs("div",{className:sv.formulaFunctionParams,children:[At.jsx("div",{className:`${sv.formulaFunctionParamsTitle} ${e}`,children:r}),At.jsx("div",{className:sv.formulaFunctionParamsDetail,children:n})]})}const Xze="univer-formula-input-params-list",qze="univer-formula-input-params-list-item-name",Gze="univer-formula-input-params-list-item-selector",a6={formulaInputParamsList:Xze,formulaInputParamsListItemName:qze,formulaInputParamsListItemSelector:Gze};function Kze(t){const{functionInfo:e,onChange:n}=t;if(!e)return null;const[r,i]=_.useState([]),[o,a]=_.useState(e.functionParameter),[s,u]=_.useState(-1);function l(d,m){const f=[...r];f[m]=d,i(f),n(f)}function c(d){if(d===o.length-1&&o[d].repeat){const m=[...o];m.push(o[d]),a(m)}u(d)}return At.jsxs("div",{className:a6.formulaInputParams,children:[At.jsx("div",{className:a6.formulaInputParamsList,children:o.map((d,m)=>At.jsxs("div",{children:[At.jsx("div",{className:a6.formulaInputParamsListItemName,children:d.name}),At.jsx("div",{className:a6.formulaInputParamsListItemSelector,children:At.jsx(Oxe,{onChange:f=>l(f,m),onActive:()=>c(m)})})]},m))}),At.jsx("div",{className:a6.formulaInputParamsInfo,children:At.jsx(R6,{title:s===-1?At.jsx(ej,{prefix:e.functionName,value:o}):o[s].name,value:s===-1?e.description:o[s].detail})})]})}const Zze=[],Qze=[{functionName:kn.BETADIST,functionType:A.Compatibility,description:"formula.functionList.BETADIST.description",abstract:"formula.functionList.BETADIST.abstract",functionParameter:[{name:"formula.functionList.BETADIST.functionParameter.number1.name",detail:"formula.functionList.BETADIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BETADIST.functionParameter.number2.name",detail:"formula.functionList.BETADIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.BETAINV,functionType:A.Compatibility,description:"formula.functionList.BETAINV.description",abstract:"formula.functionList.BETAINV.abstract",functionParameter:[{name:"formula.functionList.BETAINV.functionParameter.number1.name",detail:"formula.functionList.BETAINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BETAINV.functionParameter.number2.name",detail:"formula.functionList.BETAINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.BINOMDIST,functionType:A.Compatibility,description:"formula.functionList.BINOMDIST.description",abstract:"formula.functionList.BINOMDIST.abstract",functionParameter:[{name:"formula.functionList.BINOMDIST.functionParameter.number1.name",detail:"formula.functionList.BINOMDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BINOMDIST.functionParameter.number2.name",detail:"formula.functionList.BINOMDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.CHIDIST,functionType:A.Compatibility,description:"formula.functionList.CHIDIST.description",abstract:"formula.functionList.CHIDIST.abstract",functionParameter:[{name:"formula.functionList.CHIDIST.functionParameter.number1.name",detail:"formula.functionList.CHIDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHIDIST.functionParameter.number2.name",detail:"formula.functionList.CHIDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.CHIINV,functionType:A.Compatibility,description:"formula.functionList.CHIINV.description",abstract:"formula.functionList.CHIINV.abstract",functionParameter:[{name:"formula.functionList.CHIINV.functionParameter.number1.name",detail:"formula.functionList.CHIINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHIINV.functionParameter.number2.name",detail:"formula.functionList.CHIINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.CHITEST,functionType:A.Compatibility,description:"formula.functionList.CHITEST.description",abstract:"formula.functionList.CHITEST.abstract",functionParameter:[{name:"formula.functionList.CHITEST.functionParameter.number1.name",detail:"formula.functionList.CHITEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHITEST.functionParameter.number2.name",detail:"formula.functionList.CHITEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.CONFIDENCE,functionType:A.Compatibility,description:"formula.functionList.CONFIDENCE.description",abstract:"formula.functionList.CONFIDENCE.abstract",functionParameter:[{name:"formula.functionList.CONFIDENCE.functionParameter.number1.name",detail:"formula.functionList.CONFIDENCE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE.functionParameter.number2.name",detail:"formula.functionList.CONFIDENCE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.COVAR,functionType:A.Compatibility,description:"formula.functionList.COVAR.description",abstract:"formula.functionList.COVAR.abstract",functionParameter:[{name:"formula.functionList.COVAR.functionParameter.number1.name",detail:"formula.functionList.COVAR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COVAR.functionParameter.number2.name",detail:"formula.functionList.COVAR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.CRITBINOM,functionType:A.Compatibility,description:"formula.functionList.CRITBINOM.description",abstract:"formula.functionList.CRITBINOM.abstract",functionParameter:[{name:"formula.functionList.CRITBINOM.functionParameter.number1.name",detail:"formula.functionList.CRITBINOM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CRITBINOM.functionParameter.number2.name",detail:"formula.functionList.CRITBINOM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.EXPONDIST,functionType:A.Compatibility,description:"formula.functionList.EXPONDIST.description",abstract:"formula.functionList.EXPONDIST.abstract",functionParameter:[{name:"formula.functionList.EXPONDIST.functionParameter.number1.name",detail:"formula.functionList.EXPONDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EXPONDIST.functionParameter.number2.name",detail:"formula.functionList.EXPONDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.FDIST,functionType:A.Compatibility,description:"formula.functionList.FDIST.description",abstract:"formula.functionList.FDIST.abstract",functionParameter:[{name:"formula.functionList.FDIST.functionParameter.number1.name",detail:"formula.functionList.FDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FDIST.functionParameter.number2.name",detail:"formula.functionList.FDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.FINV,functionType:A.Compatibility,description:"formula.functionList.FINV.description",abstract:"formula.functionList.FINV.abstract",functionParameter:[{name:"formula.functionList.FINV.functionParameter.number1.name",detail:"formula.functionList.FINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FINV.functionParameter.number2.name",detail:"formula.functionList.FINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.FTEST,functionType:A.Compatibility,description:"formula.functionList.FTEST.description",abstract:"formula.functionList.FTEST.abstract",functionParameter:[{name:"formula.functionList.FTEST.functionParameter.number1.name",detail:"formula.functionList.FTEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FTEST.functionParameter.number2.name",detail:"formula.functionList.FTEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.GAMMADIST,functionType:A.Compatibility,description:"formula.functionList.GAMMADIST.description",abstract:"formula.functionList.GAMMADIST.abstract",functionParameter:[{name:"formula.functionList.GAMMADIST.functionParameter.number1.name",detail:"formula.functionList.GAMMADIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAMMADIST.functionParameter.number2.name",detail:"formula.functionList.GAMMADIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.GAMMAINV,functionType:A.Compatibility,description:"formula.functionList.GAMMAINV.description",abstract:"formula.functionList.GAMMAINV.abstract",functionParameter:[{name:"formula.functionList.GAMMAINV.functionParameter.number1.name",detail:"formula.functionList.GAMMAINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAMMAINV.functionParameter.number2.name",detail:"formula.functionList.GAMMAINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.HYPGEOMDIST,functionType:A.Compatibility,description:"formula.functionList.HYPGEOMDIST.description",abstract:"formula.functionList.HYPGEOMDIST.abstract",functionParameter:[{name:"formula.functionList.HYPGEOMDIST.functionParameter.number1.name",detail:"formula.functionList.HYPGEOMDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HYPGEOMDIST.functionParameter.number2.name",detail:"formula.functionList.HYPGEOMDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.LOGINV,functionType:A.Compatibility,description:"formula.functionList.LOGINV.description",abstract:"formula.functionList.LOGINV.abstract",functionParameter:[{name:"formula.functionList.LOGINV.functionParameter.number1.name",detail:"formula.functionList.LOGINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOGINV.functionParameter.number2.name",detail:"formula.functionList.LOGINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.LOGNORMDIST,functionType:A.Compatibility,description:"formula.functionList.LOGNORMDIST.description",abstract:"formula.functionList.LOGNORMDIST.abstract",functionParameter:[{name:"formula.functionList.LOGNORMDIST.functionParameter.number1.name",detail:"formula.functionList.LOGNORMDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOGNORMDIST.functionParameter.number2.name",detail:"formula.functionList.LOGNORMDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.MODE,functionType:A.Compatibility,description:"formula.functionList.MODE.description",abstract:"formula.functionList.MODE.abstract",functionParameter:[{name:"formula.functionList.MODE.functionParameter.number1.name",detail:"formula.functionList.MODE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MODE.functionParameter.number2.name",detail:"formula.functionList.MODE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.NEGBINOMDIST,functionType:A.Compatibility,description:"formula.functionList.NEGBINOMDIST.description",abstract:"formula.functionList.NEGBINOMDIST.abstract",functionParameter:[{name:"formula.functionList.NEGBINOMDIST.functionParameter.number1.name",detail:"formula.functionList.NEGBINOMDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NEGBINOMDIST.functionParameter.number2.name",detail:"formula.functionList.NEGBINOMDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.NORMDIST,functionType:A.Compatibility,description:"formula.functionList.NORMDIST.description",abstract:"formula.functionList.NORMDIST.abstract",functionParameter:[{name:"formula.functionList.NORMDIST.functionParameter.number1.name",detail:"formula.functionList.NORMDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORMDIST.functionParameter.number2.name",detail:"formula.functionList.NORMDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.NORMINV,functionType:A.Compatibility,description:"formula.functionList.NORMINV.description",abstract:"formula.functionList.NORMINV.abstract",functionParameter:[{name:"formula.functionList.NORMINV.functionParameter.number1.name",detail:"formula.functionList.NORMINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORMINV.functionParameter.number2.name",detail:"formula.functionList.NORMINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.NORMSDIST,functionType:A.Compatibility,description:"formula.functionList.NORMSDIST.description",abstract:"formula.functionList.NORMSDIST.abstract",functionParameter:[{name:"formula.functionList.NORMSDIST.functionParameter.number1.name",detail:"formula.functionList.NORMSDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORMSDIST.functionParameter.number2.name",detail:"formula.functionList.NORMSDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.NORMSINV,functionType:A.Compatibility,description:"formula.functionList.NORMSINV.description",abstract:"formula.functionList.NORMSINV.abstract",functionParameter:[{name:"formula.functionList.NORMSINV.functionParameter.number1.name",detail:"formula.functionList.NORMSINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORMSINV.functionParameter.number2.name",detail:"formula.functionList.NORMSINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.PERCENTILE,functionType:A.Compatibility,description:"formula.functionList.PERCENTILE.description",abstract:"formula.functionList.PERCENTILE.abstract",functionParameter:[{name:"formula.functionList.PERCENTILE.functionParameter.number1.name",detail:"formula.functionList.PERCENTILE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERCENTILE.functionParameter.number2.name",detail:"formula.functionList.PERCENTILE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.PERCENTRANK,functionType:A.Compatibility,description:"formula.functionList.PERCENTRANK.description",abstract:"formula.functionList.PERCENTRANK.abstract",functionParameter:[{name:"formula.functionList.PERCENTRANK.functionParameter.number1.name",detail:"formula.functionList.PERCENTRANK.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK.functionParameter.number2.name",detail:"formula.functionList.PERCENTRANK.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.POISSON,functionType:A.Compatibility,description:"formula.functionList.POISSON.description",abstract:"formula.functionList.POISSON.abstract",functionParameter:[{name:"formula.functionList.POISSON.functionParameter.number1.name",detail:"formula.functionList.POISSON.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.POISSON.functionParameter.number2.name",detail:"formula.functionList.POISSON.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.QUARTILE,functionType:A.Compatibility,description:"formula.functionList.QUARTILE.description",abstract:"formula.functionList.QUARTILE.abstract",functionParameter:[{name:"formula.functionList.QUARTILE.functionParameter.number1.name",detail:"formula.functionList.QUARTILE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.QUARTILE.functionParameter.number2.name",detail:"formula.functionList.QUARTILE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.RANK,functionType:A.Compatibility,description:"formula.functionList.RANK.description",abstract:"formula.functionList.RANK.abstract",functionParameter:[{name:"formula.functionList.RANK.functionParameter.number1.name",detail:"formula.functionList.RANK.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RANK.functionParameter.number2.name",detail:"formula.functionList.RANK.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.STDEV,functionType:A.Compatibility,description:"formula.functionList.STDEV.description",abstract:"formula.functionList.STDEV.abstract",functionParameter:[{name:"formula.functionList.STDEV.functionParameter.number1.name",detail:"formula.functionList.STDEV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STDEV.functionParameter.number2.name",detail:"formula.functionList.STDEV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.STDEVP,functionType:A.Compatibility,description:"formula.functionList.STDEVP.description",abstract:"formula.functionList.STDEVP.abstract",functionParameter:[{name:"formula.functionList.STDEVP.functionParameter.number1.name",detail:"formula.functionList.STDEVP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STDEVP.functionParameter.number2.name",detail:"formula.functionList.STDEVP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.TDIST,functionType:A.Compatibility,description:"formula.functionList.TDIST.description",abstract:"formula.functionList.TDIST.abstract",functionParameter:[{name:"formula.functionList.TDIST.functionParameter.number1.name",detail:"formula.functionList.TDIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TDIST.functionParameter.number2.name",detail:"formula.functionList.TDIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.TINV,functionType:A.Compatibility,description:"formula.functionList.TINV.description",abstract:"formula.functionList.TINV.abstract",functionParameter:[{name:"formula.functionList.TINV.functionParameter.number1.name",detail:"formula.functionList.TINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TINV.functionParameter.number2.name",detail:"formula.functionList.TINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.TTEST,functionType:A.Compatibility,description:"formula.functionList.TTEST.description",abstract:"formula.functionList.TTEST.abstract",functionParameter:[{name:"formula.functionList.TTEST.functionParameter.number1.name",detail:"formula.functionList.TTEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TTEST.functionParameter.number2.name",detail:"formula.functionList.TTEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.VAR,functionType:A.Compatibility,description:"formula.functionList.VAR.description",abstract:"formula.functionList.VAR.abstract",functionParameter:[{name:"formula.functionList.VAR.functionParameter.number1.name",detail:"formula.functionList.VAR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VAR.functionParameter.number2.name",detail:"formula.functionList.VAR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.VARP,functionType:A.Compatibility,description:"formula.functionList.VARP.description",abstract:"formula.functionList.VARP.abstract",functionParameter:[{name:"formula.functionList.VARP.functionParameter.number1.name",detail:"formula.functionList.VARP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VARP.functionParameter.number2.name",detail:"formula.functionList.VARP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.WEIBULL,functionType:A.Compatibility,description:"formula.functionList.WEIBULL.description",abstract:"formula.functionList.WEIBULL.abstract",functionParameter:[{name:"formula.functionList.WEIBULL.functionParameter.number1.name",detail:"formula.functionList.WEIBULL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WEIBULL.functionParameter.number2.name",detail:"formula.functionList.WEIBULL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:kn.ZTEST,functionType:A.Compatibility,description:"formula.functionList.ZTEST.description",abstract:"formula.functionList.ZTEST.abstract",functionParameter:[{name:"formula.functionList.ZTEST.functionParameter.number1.name",detail:"formula.functionList.ZTEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ZTEST.functionParameter.number2.name",detail:"formula.functionList.ZTEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],Jze=[{functionName:Tu.CUBEKPIMEMBER,functionType:A.Cube,description:"formula.functionList.CUBEKPIMEMBER.description",abstract:"formula.functionList.CUBEKPIMEMBER.abstract",functionParameter:[{name:"formula.functionList.CUBEKPIMEMBER.functionParameter.number1.name",detail:"formula.functionList.CUBEKPIMEMBER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEKPIMEMBER.functionParameter.number2.name",detail:"formula.functionList.CUBEKPIMEMBER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Tu.CUBEMEMBER,functionType:A.Cube,description:"formula.functionList.CUBEMEMBER.description",abstract:"formula.functionList.CUBEMEMBER.abstract",functionParameter:[{name:"formula.functionList.CUBEMEMBER.functionParameter.number1.name",detail:"formula.functionList.CUBEMEMBER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEMEMBER.functionParameter.number2.name",detail:"formula.functionList.CUBEMEMBER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Tu.CUBEMEMBERPROPERTY,functionType:A.Cube,description:"formula.functionList.CUBEMEMBERPROPERTY.description",abstract:"formula.functionList.CUBEMEMBERPROPERTY.abstract",functionParameter:[{name:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number1.name",detail:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number2.name",detail:"formula.functionList.CUBEMEMBERPROPERTY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Tu.CUBERANKEDMEMBER,functionType:A.Cube,description:"formula.functionList.CUBERANKEDMEMBER.description",abstract:"formula.functionList.CUBERANKEDMEMBER.abstract",functionParameter:[{name:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number1.name",detail:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number2.name",detail:"formula.functionList.CUBERANKEDMEMBER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Tu.CUBESET,functionType:A.Cube,description:"formula.functionList.CUBESET.description",abstract:"formula.functionList.CUBESET.abstract",functionParameter:[{name:"formula.functionList.CUBESET.functionParameter.number1.name",detail:"formula.functionList.CUBESET.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBESET.functionParameter.number2.name",detail:"formula.functionList.CUBESET.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Tu.CUBESETCOUNT,functionType:A.Cube,description:"formula.functionList.CUBESETCOUNT.description",abstract:"formula.functionList.CUBESETCOUNT.abstract",functionParameter:[{name:"formula.functionList.CUBESETCOUNT.functionParameter.number1.name",detail:"formula.functionList.CUBESETCOUNT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBESETCOUNT.functionParameter.number2.name",detail:"formula.functionList.CUBESETCOUNT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Tu.CUBEVALUE,functionType:A.Cube,description:"formula.functionList.CUBEVALUE.description",abstract:"formula.functionList.CUBEVALUE.abstract",functionParameter:[{name:"formula.functionList.CUBEVALUE.functionParameter.number1.name",detail:"formula.functionList.CUBEVALUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUBEVALUE.functionParameter.number2.name",detail:"formula.functionList.CUBEVALUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],eWe=[{functionName:ia.DAVERAGE,functionType:A.Database,description:"formula.functionList.DAVERAGE.description",abstract:"formula.functionList.DAVERAGE.abstract",functionParameter:[{name:"formula.functionList.DAVERAGE.functionParameter.number1.name",detail:"formula.functionList.DAVERAGE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DAVERAGE.functionParameter.number2.name",detail:"formula.functionList.DAVERAGE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DCOUNT,functionType:A.Database,description:"formula.functionList.DCOUNT.description",abstract:"formula.functionList.DCOUNT.abstract",functionParameter:[{name:"formula.functionList.DCOUNT.functionParameter.number1.name",detail:"formula.functionList.DCOUNT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DCOUNT.functionParameter.number2.name",detail:"formula.functionList.DCOUNT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DCOUNTA,functionType:A.Database,description:"formula.functionList.DCOUNTA.description",abstract:"formula.functionList.DCOUNTA.abstract",functionParameter:[{name:"formula.functionList.DCOUNTA.functionParameter.number1.name",detail:"formula.functionList.DCOUNTA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DCOUNTA.functionParameter.number2.name",detail:"formula.functionList.DCOUNTA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DGET,functionType:A.Database,description:"formula.functionList.DGET.description",abstract:"formula.functionList.DGET.abstract",functionParameter:[{name:"formula.functionList.DGET.functionParameter.number1.name",detail:"formula.functionList.DGET.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DGET.functionParameter.number2.name",detail:"formula.functionList.DGET.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DMAX,functionType:A.Database,description:"formula.functionList.DMAX.description",abstract:"formula.functionList.DMAX.abstract",functionParameter:[{name:"formula.functionList.DMAX.functionParameter.number1.name",detail:"formula.functionList.DMAX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DMAX.functionParameter.number2.name",detail:"formula.functionList.DMAX.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DMIN,functionType:A.Database,description:"formula.functionList.DMIN.description",abstract:"formula.functionList.DMIN.abstract",functionParameter:[{name:"formula.functionList.DMIN.functionParameter.number1.name",detail:"formula.functionList.DMIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DMIN.functionParameter.number2.name",detail:"formula.functionList.DMIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DPRODUCT,functionType:A.Database,description:"formula.functionList.DPRODUCT.description",abstract:"formula.functionList.DPRODUCT.abstract",functionParameter:[{name:"formula.functionList.DPRODUCT.functionParameter.number1.name",detail:"formula.functionList.DPRODUCT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DPRODUCT.functionParameter.number2.name",detail:"formula.functionList.DPRODUCT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DSTDEV,functionType:A.Database,description:"formula.functionList.DSTDEV.description",abstract:"formula.functionList.DSTDEV.abstract",functionParameter:[{name:"formula.functionList.DSTDEV.functionParameter.number1.name",detail:"formula.functionList.DSTDEV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DSTDEV.functionParameter.number2.name",detail:"formula.functionList.DSTDEV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DSTDEVP,functionType:A.Database,description:"formula.functionList.DSTDEVP.description",abstract:"formula.functionList.DSTDEVP.abstract",functionParameter:[{name:"formula.functionList.DSTDEVP.functionParameter.number1.name",detail:"formula.functionList.DSTDEVP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DSTDEVP.functionParameter.number2.name",detail:"formula.functionList.DSTDEVP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DSUM,functionType:A.Database,description:"formula.functionList.DSUM.description",abstract:"formula.functionList.DSUM.abstract",functionParameter:[{name:"formula.functionList.DSUM.functionParameter.number1.name",detail:"formula.functionList.DSUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DSUM.functionParameter.number2.name",detail:"formula.functionList.DSUM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DVAR,functionType:A.Database,description:"formula.functionList.DVAR.description",abstract:"formula.functionList.DVAR.abstract",functionParameter:[{name:"formula.functionList.DVAR.functionParameter.number1.name",detail:"formula.functionList.DVAR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DVAR.functionParameter.number2.name",detail:"formula.functionList.DVAR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ia.DVARP,functionType:A.Database,description:"formula.functionList.DVARP.description",abstract:"formula.functionList.DVARP.abstract",functionParameter:[{name:"formula.functionList.DVARP.functionParameter.number1.name",detail:"formula.functionList.DVARP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DVARP.functionParameter.number2.name",detail:"formula.functionList.DVARP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],tWe=[{functionName:ur.DATE,functionType:A.Date,description:"formula.functionList.DATE.description",abstract:"formula.functionList.DATE.abstract",functionParameter:[{name:"formula.functionList.DATE.functionParameter.year.name",detail:"formula.functionList.DATE.functionParameter.year.detail",example:"2024",require:1,repeat:0},{name:"formula.functionList.DATE.functionParameter.month.name",detail:"formula.functionList.DATE.functionParameter.month.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.DATE.functionParameter.day.name",detail:"formula.functionList.DATE.functionParameter.day.detail",example:"1",require:1,repeat:0}]},{functionName:ur.DATEDIF,functionType:A.Date,description:"formula.functionList.DATEDIF.description",abstract:"formula.functionList.DATEDIF.abstract",functionParameter:[{name:"formula.functionList.DATEDIF.functionParameter.number1.name",detail:"formula.functionList.DATEDIF.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DATEDIF.functionParameter.number2.name",detail:"formula.functionList.DATEDIF.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.DATEVALUE,functionType:A.Date,description:"formula.functionList.DATEVALUE.description",abstract:"formula.functionList.DATEVALUE.abstract",functionParameter:[{name:"formula.functionList.DATEVALUE.functionParameter.number1.name",detail:"formula.functionList.DATEVALUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DATEVALUE.functionParameter.number2.name",detail:"formula.functionList.DATEVALUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.DAY,functionType:A.Date,description:"formula.functionList.DAY.description",abstract:"formula.functionList.DAY.abstract",functionParameter:[{name:"formula.functionList.DAY.functionParameter.serialNumber.name",detail:"formula.functionList.DAY.functionParameter.serialNumber.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.DAYS,functionType:A.Date,description:"formula.functionList.DAYS.description",abstract:"formula.functionList.DAYS.abstract",functionParameter:[{name:"formula.functionList.DAYS.functionParameter.number1.name",detail:"formula.functionList.DAYS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DAYS.functionParameter.number2.name",detail:"formula.functionList.DAYS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.DAYS360,functionType:A.Date,description:"formula.functionList.DAYS360.description",abstract:"formula.functionList.DAYS360.abstract",functionParameter:[{name:"formula.functionList.DAYS360.functionParameter.number1.name",detail:"formula.functionList.DAYS360.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DAYS360.functionParameter.number2.name",detail:"formula.functionList.DAYS360.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.EDATE,functionType:A.Date,description:"formula.functionList.EDATE.description",abstract:"formula.functionList.EDATE.abstract",functionParameter:[{name:"formula.functionList.EDATE.functionParameter.startDate.name",detail:"formula.functionList.EDATE.functionParameter.startDate.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.EDATE.functionParameter.months.name",detail:"formula.functionList.EDATE.functionParameter.months.detail",example:"1",require:1,repeat:0}]},{functionName:ur.EOMONTH,functionType:A.Date,description:"formula.functionList.EOMONTH.description",abstract:"formula.functionList.EOMONTH.abstract",functionParameter:[{name:"formula.functionList.EOMONTH.functionParameter.number1.name",detail:"formula.functionList.EOMONTH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EOMONTH.functionParameter.number2.name",detail:"formula.functionList.EOMONTH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.HOUR,functionType:A.Date,description:"formula.functionList.HOUR.description",abstract:"formula.functionList.HOUR.abstract",functionParameter:[{name:"formula.functionList.HOUR.functionParameter.number1.name",detail:"formula.functionList.HOUR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HOUR.functionParameter.number2.name",detail:"formula.functionList.HOUR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.ISOWEEKNUM,functionType:A.Date,description:"formula.functionList.ISOWEEKNUM.description",abstract:"formula.functionList.ISOWEEKNUM.abstract",functionParameter:[{name:"formula.functionList.ISOWEEKNUM.functionParameter.number1.name",detail:"formula.functionList.ISOWEEKNUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISOWEEKNUM.functionParameter.number2.name",detail:"formula.functionList.ISOWEEKNUM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.MINUTE,functionType:A.Date,description:"formula.functionList.MINUTE.description",abstract:"formula.functionList.MINUTE.abstract",functionParameter:[{name:"formula.functionList.MINUTE.functionParameter.number1.name",detail:"formula.functionList.MINUTE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MINUTE.functionParameter.number2.name",detail:"formula.functionList.MINUTE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.MONTH,functionType:A.Date,description:"formula.functionList.MONTH.description",abstract:"formula.functionList.MONTH.abstract",functionParameter:[{name:"formula.functionList.MONTH.functionParameter.serialNumber.name",detail:"formula.functionList.MONTH.functionParameter.serialNumber.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.NETWORKDAYS,functionType:A.Date,description:"formula.functionList.NETWORKDAYS.description",abstract:"formula.functionList.NETWORKDAYS.abstract",functionParameter:[{name:"formula.functionList.NETWORKDAYS.functionParameter.number1.name",detail:"formula.functionList.NETWORKDAYS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NETWORKDAYS.functionParameter.number2.name",detail:"formula.functionList.NETWORKDAYS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.NETWORKDAYS_INTL,functionType:A.Date,description:"formula.functionList.NETWORKDAYS_INTL.description",abstract:"formula.functionList.NETWORKDAYS_INTL.abstract",functionParameter:[{name:"formula.functionList.NETWORKDAYS_INTL.functionParameter.number1.name",detail:"formula.functionList.NETWORKDAYS_INTL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NETWORKDAYS_INTL.functionParameter.number2.name",detail:"formula.functionList.NETWORKDAYS_INTL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.NOW,functionType:A.Date,description:"formula.functionList.NOW.description",abstract:"formula.functionList.NOW.abstract",functionParameter:[{name:"formula.functionList.NOW.functionParameter.number1.name",detail:"formula.functionList.NOW.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NOW.functionParameter.number2.name",detail:"formula.functionList.NOW.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.SECOND,functionType:A.Date,description:"formula.functionList.SECOND.description",abstract:"formula.functionList.SECOND.abstract",functionParameter:[{name:"formula.functionList.SECOND.functionParameter.number1.name",detail:"formula.functionList.SECOND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SECOND.functionParameter.number2.name",detail:"formula.functionList.SECOND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.TIME,functionType:A.Date,description:"formula.functionList.TIME.description",abstract:"formula.functionList.TIME.abstract",functionParameter:[{name:"formula.functionList.TIME.functionParameter.number1.name",detail:"formula.functionList.TIME.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TIME.functionParameter.number2.name",detail:"formula.functionList.TIME.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.TIMEVALUE,functionType:A.Date,description:"formula.functionList.TIMEVALUE.description",abstract:"formula.functionList.TIMEVALUE.abstract",functionParameter:[{name:"formula.functionList.TIMEVALUE.functionParameter.number1.name",detail:"formula.functionList.TIMEVALUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TIMEVALUE.functionParameter.number2.name",detail:"formula.functionList.TIMEVALUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.TODAY,functionType:A.Date,description:"formula.functionList.TODAY.description",abstract:"formula.functionList.TODAY.abstract",functionParameter:[]},{functionName:ur.WEEKDAY,functionType:A.Date,description:"formula.functionList.WEEKDAY.description",abstract:"formula.functionList.WEEKDAY.abstract",functionParameter:[{name:"formula.functionList.WEEKDAY.functionParameter.number1.name",detail:"formula.functionList.WEEKDAY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WEEKDAY.functionParameter.number2.name",detail:"formula.functionList.WEEKDAY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.WEEKNUM,functionType:A.Date,description:"formula.functionList.WEEKNUM.description",abstract:"formula.functionList.WEEKNUM.abstract",functionParameter:[{name:"formula.functionList.WEEKNUM.functionParameter.number1.name",detail:"formula.functionList.WEEKNUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WEEKNUM.functionParameter.number2.name",detail:"formula.functionList.WEEKNUM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.WORKDAY,functionType:A.Date,description:"formula.functionList.WORKDAY.description",abstract:"formula.functionList.WORKDAY.abstract",functionParameter:[{name:"formula.functionList.WORKDAY.functionParameter.number1.name",detail:"formula.functionList.WORKDAY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WORKDAY.functionParameter.number2.name",detail:"formula.functionList.WORKDAY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.WORKDAY_INTL,functionType:A.Date,description:"formula.functionList.WORKDAY_INTL.description",abstract:"formula.functionList.WORKDAY_INTL.abstract",functionParameter:[{name:"formula.functionList.WORKDAY_INTL.functionParameter.number1.name",detail:"formula.functionList.WORKDAY_INTL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WORKDAY_INTL.functionParameter.number2.name",detail:"formula.functionList.WORKDAY_INTL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.YEAR,functionType:A.Date,description:"formula.functionList.YEAR.description",abstract:"formula.functionList.YEAR.abstract",functionParameter:[{name:"formula.functionList.YEAR.functionParameter.serialNumber.name",detail:"formula.functionList.YEAR.functionParameter.serialNumber.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:ur.YEARFRAC,functionType:A.Date,description:"formula.functionList.YEARFRAC.description",abstract:"formula.functionList.YEARFRAC.abstract",functionParameter:[{name:"formula.functionList.YEARFRAC.functionParameter.number1.name",detail:"formula.functionList.YEARFRAC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.YEARFRAC.functionParameter.number2.name",detail:"formula.functionList.YEARFRAC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],nWe=[{functionName:un.BESSELI,functionType:A.Engineering,description:"formula.functionList.BESSELI.description",abstract:"formula.functionList.BESSELI.abstract",functionParameter:[{name:"formula.functionList.BESSELI.functionParameter.number1.name",detail:"formula.functionList.BESSELI.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BESSELI.functionParameter.number2.name",detail:"formula.functionList.BESSELI.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BESSELJ,functionType:A.Engineering,description:"formula.functionList.BESSELJ.description",abstract:"formula.functionList.BESSELJ.abstract",functionParameter:[{name:"formula.functionList.BESSELJ.functionParameter.number1.name",detail:"formula.functionList.BESSELJ.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BESSELJ.functionParameter.number2.name",detail:"formula.functionList.BESSELJ.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BESSELK,functionType:A.Engineering,description:"formula.functionList.BESSELK.description",abstract:"formula.functionList.BESSELK.abstract",functionParameter:[{name:"formula.functionList.BESSELK.functionParameter.number1.name",detail:"formula.functionList.BESSELK.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BESSELK.functionParameter.number2.name",detail:"formula.functionList.BESSELK.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BESSELY,functionType:A.Engineering,description:"formula.functionList.BESSELY.description",abstract:"formula.functionList.BESSELY.abstract",functionParameter:[{name:"formula.functionList.BESSELY.functionParameter.number1.name",detail:"formula.functionList.BESSELY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BESSELY.functionParameter.number2.name",detail:"formula.functionList.BESSELY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BIN2DEC,functionType:A.Engineering,description:"formula.functionList.BIN2DEC.description",abstract:"formula.functionList.BIN2DEC.abstract",functionParameter:[{name:"formula.functionList.BIN2DEC.functionParameter.number1.name",detail:"formula.functionList.BIN2DEC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BIN2DEC.functionParameter.number2.name",detail:"formula.functionList.BIN2DEC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BIN2HEX,functionType:A.Engineering,description:"formula.functionList.BIN2HEX.description",abstract:"formula.functionList.BIN2HEX.abstract",functionParameter:[{name:"formula.functionList.BIN2HEX.functionParameter.number1.name",detail:"formula.functionList.BIN2HEX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BIN2HEX.functionParameter.number2.name",detail:"formula.functionList.BIN2HEX.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BIN2OCT,functionType:A.Engineering,description:"formula.functionList.BIN2OCT.description",abstract:"formula.functionList.BIN2OCT.abstract",functionParameter:[{name:"formula.functionList.BIN2OCT.functionParameter.number1.name",detail:"formula.functionList.BIN2OCT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BIN2OCT.functionParameter.number2.name",detail:"formula.functionList.BIN2OCT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BITAND,functionType:A.Engineering,description:"formula.functionList.BITAND.description",abstract:"formula.functionList.BITAND.abstract",functionParameter:[{name:"formula.functionList.BITAND.functionParameter.number1.name",detail:"formula.functionList.BITAND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BITAND.functionParameter.number2.name",detail:"formula.functionList.BITAND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BITLSHIFT,functionType:A.Engineering,description:"formula.functionList.BITLSHIFT.description",abstract:"formula.functionList.BITLSHIFT.abstract",functionParameter:[{name:"formula.functionList.BITLSHIFT.functionParameter.number1.name",detail:"formula.functionList.BITLSHIFT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BITLSHIFT.functionParameter.number2.name",detail:"formula.functionList.BITLSHIFT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BITOR,functionType:A.Engineering,description:"formula.functionList.BITOR.description",abstract:"formula.functionList.BITOR.abstract",functionParameter:[{name:"formula.functionList.BITOR.functionParameter.number1.name",detail:"formula.functionList.BITOR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BITOR.functionParameter.number2.name",detail:"formula.functionList.BITOR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BITRSHIFT,functionType:A.Engineering,description:"formula.functionList.BITRSHIFT.description",abstract:"formula.functionList.BITRSHIFT.abstract",functionParameter:[{name:"formula.functionList.BITRSHIFT.functionParameter.number1.name",detail:"formula.functionList.BITRSHIFT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BITRSHIFT.functionParameter.number2.name",detail:"formula.functionList.BITRSHIFT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.BITXOR,functionType:A.Engineering,description:"formula.functionList.BITXOR.description",abstract:"formula.functionList.BITXOR.abstract",functionParameter:[{name:"formula.functionList.BITXOR.functionParameter.number1.name",detail:"formula.functionList.BITXOR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BITXOR.functionParameter.number2.name",detail:"formula.functionList.BITXOR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.COMPLEX,functionType:A.Engineering,description:"formula.functionList.COMPLEX.description",abstract:"formula.functionList.COMPLEX.abstract",functionParameter:[{name:"formula.functionList.COMPLEX.functionParameter.number1.name",detail:"formula.functionList.COMPLEX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COMPLEX.functionParameter.number2.name",detail:"formula.functionList.COMPLEX.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.CONVERT,functionType:A.Engineering,description:"formula.functionList.CONVERT.description",abstract:"formula.functionList.CONVERT.abstract",functionParameter:[{name:"formula.functionList.CONVERT.functionParameter.number1.name",detail:"formula.functionList.CONVERT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CONVERT.functionParameter.number2.name",detail:"formula.functionList.CONVERT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.DEC2BIN,functionType:A.Engineering,description:"formula.functionList.DEC2BIN.description",abstract:"formula.functionList.DEC2BIN.abstract",functionParameter:[{name:"formula.functionList.DEC2BIN.functionParameter.number1.name",detail:"formula.functionList.DEC2BIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DEC2BIN.functionParameter.number2.name",detail:"formula.functionList.DEC2BIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.DEC2HEX,functionType:A.Engineering,description:"formula.functionList.DEC2HEX.description",abstract:"formula.functionList.DEC2HEX.abstract",functionParameter:[{name:"formula.functionList.DEC2HEX.functionParameter.number1.name",detail:"formula.functionList.DEC2HEX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DEC2HEX.functionParameter.number2.name",detail:"formula.functionList.DEC2HEX.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.DEC2OCT,functionType:A.Engineering,description:"formula.functionList.DEC2OCT.description",abstract:"formula.functionList.DEC2OCT.abstract",functionParameter:[{name:"formula.functionList.DEC2OCT.functionParameter.number1.name",detail:"formula.functionList.DEC2OCT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DEC2OCT.functionParameter.number2.name",detail:"formula.functionList.DEC2OCT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.DELTA,functionType:A.Engineering,description:"formula.functionList.DELTA.description",abstract:"formula.functionList.DELTA.abstract",functionParameter:[{name:"formula.functionList.DELTA.functionParameter.number1.name",detail:"formula.functionList.DELTA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DELTA.functionParameter.number2.name",detail:"formula.functionList.DELTA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.ERF,functionType:A.Engineering,description:"formula.functionList.ERF.description",abstract:"formula.functionList.ERF.abstract",functionParameter:[{name:"formula.functionList.ERF.functionParameter.number1.name",detail:"formula.functionList.ERF.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ERF.functionParameter.number2.name",detail:"formula.functionList.ERF.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.ERF_PRECISE,functionType:A.Engineering,description:"formula.functionList.ERF_PRECISE.description",abstract:"formula.functionList.ERF_PRECISE.abstract",functionParameter:[{name:"formula.functionList.ERF_PRECISE.functionParameter.number1.name",detail:"formula.functionList.ERF_PRECISE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ERF_PRECISE.functionParameter.number2.name",detail:"formula.functionList.ERF_PRECISE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.ERFC,functionType:A.Engineering,description:"formula.functionList.ERFC.description",abstract:"formula.functionList.ERFC.abstract",functionParameter:[{name:"formula.functionList.ERFC.functionParameter.number1.name",detail:"formula.functionList.ERFC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ERFC.functionParameter.number2.name",detail:"formula.functionList.ERFC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.ERFC_PRECISE,functionType:A.Engineering,description:"formula.functionList.ERFC_PRECISE.description",abstract:"formula.functionList.ERFC_PRECISE.abstract",functionParameter:[{name:"formula.functionList.ERFC_PRECISE.functionParameter.number1.name",detail:"formula.functionList.ERFC_PRECISE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ERFC_PRECISE.functionParameter.number2.name",detail:"formula.functionList.ERFC_PRECISE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.GESTEP,functionType:A.Engineering,description:"formula.functionList.GESTEP.description",abstract:"formula.functionList.GESTEP.abstract",functionParameter:[{name:"formula.functionList.GESTEP.functionParameter.number1.name",detail:"formula.functionList.GESTEP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GESTEP.functionParameter.number2.name",detail:"formula.functionList.GESTEP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.HEX2BIN,functionType:A.Engineering,description:"formula.functionList.HEX2BIN.description",abstract:"formula.functionList.HEX2BIN.abstract",functionParameter:[{name:"formula.functionList.HEX2BIN.functionParameter.number1.name",detail:"formula.functionList.HEX2BIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HEX2BIN.functionParameter.number2.name",detail:"formula.functionList.HEX2BIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.HEX2DEC,functionType:A.Engineering,description:"formula.functionList.HEX2DEC.description",abstract:"formula.functionList.HEX2DEC.abstract",functionParameter:[{name:"formula.functionList.HEX2DEC.functionParameter.number1.name",detail:"formula.functionList.HEX2DEC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HEX2DEC.functionParameter.number2.name",detail:"formula.functionList.HEX2DEC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.HEX2OCT,functionType:A.Engineering,description:"formula.functionList.HEX2OCT.description",abstract:"formula.functionList.HEX2OCT.abstract",functionParameter:[{name:"formula.functionList.HEX2OCT.functionParameter.number1.name",detail:"formula.functionList.HEX2OCT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HEX2OCT.functionParameter.number2.name",detail:"formula.functionList.HEX2OCT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMABS,functionType:A.Engineering,description:"formula.functionList.IMABS.description",abstract:"formula.functionList.IMABS.abstract",functionParameter:[{name:"formula.functionList.IMABS.functionParameter.number1.name",detail:"formula.functionList.IMABS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMABS.functionParameter.number2.name",detail:"formula.functionList.IMABS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMAGINARY,functionType:A.Engineering,description:"formula.functionList.IMAGINARY.description",abstract:"formula.functionList.IMAGINARY.abstract",functionParameter:[{name:"formula.functionList.IMAGINARY.functionParameter.number1.name",detail:"formula.functionList.IMAGINARY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMAGINARY.functionParameter.number2.name",detail:"formula.functionList.IMAGINARY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMARGUMENT,functionType:A.Engineering,description:"formula.functionList.IMARGUMENT.description",abstract:"formula.functionList.IMARGUMENT.abstract",functionParameter:[{name:"formula.functionList.IMARGUMENT.functionParameter.number1.name",detail:"formula.functionList.IMARGUMENT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMARGUMENT.functionParameter.number2.name",detail:"formula.functionList.IMARGUMENT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMCONJUGATE,functionType:A.Engineering,description:"formula.functionList.IMCONJUGATE.description",abstract:"formula.functionList.IMCONJUGATE.abstract",functionParameter:[{name:"formula.functionList.IMCONJUGATE.functionParameter.number1.name",detail:"formula.functionList.IMCONJUGATE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMCONJUGATE.functionParameter.number2.name",detail:"formula.functionList.IMCONJUGATE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMCOS,functionType:A.Engineering,description:"formula.functionList.IMCOS.description",abstract:"formula.functionList.IMCOS.abstract",functionParameter:[{name:"formula.functionList.IMCOS.functionParameter.number1.name",detail:"formula.functionList.IMCOS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMCOS.functionParameter.number2.name",detail:"formula.functionList.IMCOS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMCOSH,functionType:A.Engineering,description:"formula.functionList.IMCOSH.description",abstract:"formula.functionList.IMCOSH.abstract",functionParameter:[{name:"formula.functionList.IMCOSH.functionParameter.number1.name",detail:"formula.functionList.IMCOSH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMCOSH.functionParameter.number2.name",detail:"formula.functionList.IMCOSH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMCOT,functionType:A.Engineering,description:"formula.functionList.IMCOT.description",abstract:"formula.functionList.IMCOT.abstract",functionParameter:[{name:"formula.functionList.IMCOT.functionParameter.number1.name",detail:"formula.functionList.IMCOT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMCOT.functionParameter.number2.name",detail:"formula.functionList.IMCOT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMCSC,functionType:A.Engineering,description:"formula.functionList.IMCSC.description",abstract:"formula.functionList.IMCSC.abstract",functionParameter:[{name:"formula.functionList.IMCSC.functionParameter.number1.name",detail:"formula.functionList.IMCSC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMCSC.functionParameter.number2.name",detail:"formula.functionList.IMCSC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMCSCH,functionType:A.Engineering,description:"formula.functionList.IMCSCH.description",abstract:"formula.functionList.IMCSCH.abstract",functionParameter:[{name:"formula.functionList.IMCSCH.functionParameter.number1.name",detail:"formula.functionList.IMCSCH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMCSCH.functionParameter.number2.name",detail:"formula.functionList.IMCSCH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMDIV,functionType:A.Engineering,description:"formula.functionList.IMDIV.description",abstract:"formula.functionList.IMDIV.abstract",functionParameter:[{name:"formula.functionList.IMDIV.functionParameter.number1.name",detail:"formula.functionList.IMDIV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMDIV.functionParameter.number2.name",detail:"formula.functionList.IMDIV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMEXP,functionType:A.Engineering,description:"formula.functionList.IMEXP.description",abstract:"formula.functionList.IMEXP.abstract",functionParameter:[{name:"formula.functionList.IMEXP.functionParameter.number1.name",detail:"formula.functionList.IMEXP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMEXP.functionParameter.number2.name",detail:"formula.functionList.IMEXP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMLN,functionType:A.Engineering,description:"formula.functionList.IMLN.description",abstract:"formula.functionList.IMLN.abstract",functionParameter:[{name:"formula.functionList.IMLN.functionParameter.number1.name",detail:"formula.functionList.IMLN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMLN.functionParameter.number2.name",detail:"formula.functionList.IMLN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMLOG10,functionType:A.Engineering,description:"formula.functionList.IMLOG10.description",abstract:"formula.functionList.IMLOG10.abstract",functionParameter:[{name:"formula.functionList.IMLOG10.functionParameter.number1.name",detail:"formula.functionList.IMLOG10.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMLOG10.functionParameter.number2.name",detail:"formula.functionList.IMLOG10.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMLOG2,functionType:A.Engineering,description:"formula.functionList.IMLOG2.description",abstract:"formula.functionList.IMLOG2.abstract",functionParameter:[{name:"formula.functionList.IMLOG2.functionParameter.number1.name",detail:"formula.functionList.IMLOG2.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMLOG2.functionParameter.number2.name",detail:"formula.functionList.IMLOG2.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMPOWER,functionType:A.Engineering,description:"formula.functionList.IMPOWER.description",abstract:"formula.functionList.IMPOWER.abstract",functionParameter:[{name:"formula.functionList.IMPOWER.functionParameter.number1.name",detail:"formula.functionList.IMPOWER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMPOWER.functionParameter.number2.name",detail:"formula.functionList.IMPOWER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMPRODUCT,functionType:A.Engineering,description:"formula.functionList.IMPRODUCT.description",abstract:"formula.functionList.IMPRODUCT.abstract",functionParameter:[{name:"formula.functionList.IMPRODUCT.functionParameter.number1.name",detail:"formula.functionList.IMPRODUCT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMPRODUCT.functionParameter.number2.name",detail:"formula.functionList.IMPRODUCT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMREAL,functionType:A.Engineering,description:"formula.functionList.IMREAL.description",abstract:"formula.functionList.IMREAL.abstract",functionParameter:[{name:"formula.functionList.IMREAL.functionParameter.number1.name",detail:"formula.functionList.IMREAL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMREAL.functionParameter.number2.name",detail:"formula.functionList.IMREAL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMSEC,functionType:A.Engineering,description:"formula.functionList.IMSEC.description",abstract:"formula.functionList.IMSEC.abstract",functionParameter:[{name:"formula.functionList.IMSEC.functionParameter.number1.name",detail:"formula.functionList.IMSEC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMSEC.functionParameter.number2.name",detail:"formula.functionList.IMSEC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMSECH,functionType:A.Engineering,description:"formula.functionList.IMSECH.description",abstract:"formula.functionList.IMSECH.abstract",functionParameter:[{name:"formula.functionList.IMSECH.functionParameter.number1.name",detail:"formula.functionList.IMSECH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMSECH.functionParameter.number2.name",detail:"formula.functionList.IMSECH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMSIN,functionType:A.Engineering,description:"formula.functionList.IMSIN.description",abstract:"formula.functionList.IMSIN.abstract",functionParameter:[{name:"formula.functionList.IMSIN.functionParameter.number1.name",detail:"formula.functionList.IMSIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMSIN.functionParameter.number2.name",detail:"formula.functionList.IMSIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMSINH,functionType:A.Engineering,description:"formula.functionList.IMSINH.description",abstract:"formula.functionList.IMSINH.abstract",functionParameter:[{name:"formula.functionList.IMSINH.functionParameter.number1.name",detail:"formula.functionList.IMSINH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMSINH.functionParameter.number2.name",detail:"formula.functionList.IMSINH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMSQRT,functionType:A.Engineering,description:"formula.functionList.IMSQRT.description",abstract:"formula.functionList.IMSQRT.abstract",functionParameter:[{name:"formula.functionList.IMSQRT.functionParameter.number1.name",detail:"formula.functionList.IMSQRT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMSQRT.functionParameter.number2.name",detail:"formula.functionList.IMSQRT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMSUB,functionType:A.Engineering,description:"formula.functionList.IMSUB.description",abstract:"formula.functionList.IMSUB.abstract",functionParameter:[{name:"formula.functionList.IMSUB.functionParameter.number1.name",detail:"formula.functionList.IMSUB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMSUB.functionParameter.number2.name",detail:"formula.functionList.IMSUB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMSUM,functionType:A.Engineering,description:"formula.functionList.IMSUM.description",abstract:"formula.functionList.IMSUM.abstract",functionParameter:[{name:"formula.functionList.IMSUM.functionParameter.number1.name",detail:"formula.functionList.IMSUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMSUM.functionParameter.number2.name",detail:"formula.functionList.IMSUM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.IMTAN,functionType:A.Engineering,description:"formula.functionList.IMTAN.description",abstract:"formula.functionList.IMTAN.abstract",functionParameter:[{name:"formula.functionList.IMTAN.functionParameter.number1.name",detail:"formula.functionList.IMTAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMTAN.functionParameter.number2.name",detail:"formula.functionList.IMTAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.OCT2BIN,functionType:A.Engineering,description:"formula.functionList.OCT2BIN.description",abstract:"formula.functionList.OCT2BIN.abstract",functionParameter:[{name:"formula.functionList.OCT2BIN.functionParameter.number1.name",detail:"formula.functionList.OCT2BIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.OCT2BIN.functionParameter.number2.name",detail:"formula.functionList.OCT2BIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.OCT2DEC,functionType:A.Engineering,description:"formula.functionList.OCT2DEC.description",abstract:"formula.functionList.OCT2DEC.abstract",functionParameter:[{name:"formula.functionList.OCT2DEC.functionParameter.number1.name",detail:"formula.functionList.OCT2DEC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.OCT2DEC.functionParameter.number2.name",detail:"formula.functionList.OCT2DEC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:un.OCT2HEX,functionType:A.Engineering,description:"formula.functionList.OCT2HEX.description",abstract:"formula.functionList.OCT2HEX.abstract",functionParameter:[{name:"formula.functionList.OCT2HEX.functionParameter.number1.name",detail:"formula.functionList.OCT2HEX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.OCT2HEX.functionParameter.number2.name",detail:"formula.functionList.OCT2HEX.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],rWe=[{functionName:nn.ACCRINT,functionType:A.Financial,description:"formula.functionList.ACCRINT.description",abstract:"formula.functionList.ACCRINT.abstract",functionParameter:[{name:"formula.functionList.ACCRINT.functionParameter.number1.name",detail:"formula.functionList.ACCRINT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ACCRINT.functionParameter.number2.name",detail:"formula.functionList.ACCRINT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.ACCRINTM,functionType:A.Financial,description:"formula.functionList.ACCRINTM.description",abstract:"formula.functionList.ACCRINTM.abstract",functionParameter:[{name:"formula.functionList.ACCRINTM.functionParameter.number1.name",detail:"formula.functionList.ACCRINTM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ACCRINTM.functionParameter.number2.name",detail:"formula.functionList.ACCRINTM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.AMORDEGRC,functionType:A.Financial,description:"formula.functionList.AMORDEGRC.description",abstract:"formula.functionList.AMORDEGRC.abstract",functionParameter:[{name:"formula.functionList.AMORDEGRC.functionParameter.number1.name",detail:"formula.functionList.AMORDEGRC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AMORDEGRC.functionParameter.number2.name",detail:"formula.functionList.AMORDEGRC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.AMORLINC,functionType:A.Financial,description:"formula.functionList.AMORLINC.description",abstract:"formula.functionList.AMORLINC.abstract",functionParameter:[{name:"formula.functionList.AMORLINC.functionParameter.number1.name",detail:"formula.functionList.AMORLINC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AMORLINC.functionParameter.number2.name",detail:"formula.functionList.AMORLINC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.COUPDAYBS,functionType:A.Financial,description:"formula.functionList.COUPDAYBS.description",abstract:"formula.functionList.COUPDAYBS.abstract",functionParameter:[{name:"formula.functionList.COUPDAYBS.functionParameter.number1.name",detail:"formula.functionList.COUPDAYBS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUPDAYBS.functionParameter.number2.name",detail:"formula.functionList.COUPDAYBS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.COUPDAYS,functionType:A.Financial,description:"formula.functionList.COUPDAYS.description",abstract:"formula.functionList.COUPDAYS.abstract",functionParameter:[{name:"formula.functionList.COUPDAYS.functionParameter.number1.name",detail:"formula.functionList.COUPDAYS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUPDAYS.functionParameter.number2.name",detail:"formula.functionList.COUPDAYS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.COUPDAYSNC,functionType:A.Financial,description:"formula.functionList.COUPDAYSNC.description",abstract:"formula.functionList.COUPDAYSNC.abstract",functionParameter:[{name:"formula.functionList.COUPDAYSNC.functionParameter.number1.name",detail:"formula.functionList.COUPDAYSNC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUPDAYSNC.functionParameter.number2.name",detail:"formula.functionList.COUPDAYSNC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.COUPNCD,functionType:A.Financial,description:"formula.functionList.COUPNCD.description",abstract:"formula.functionList.COUPNCD.abstract",functionParameter:[{name:"formula.functionList.COUPNCD.functionParameter.number1.name",detail:"formula.functionList.COUPNCD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUPNCD.functionParameter.number2.name",detail:"formula.functionList.COUPNCD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.COUPNUM,functionType:A.Financial,description:"formula.functionList.COUPNUM.description",abstract:"formula.functionList.COUPNUM.abstract",functionParameter:[{name:"formula.functionList.COUPNUM.functionParameter.number1.name",detail:"formula.functionList.COUPNUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUPNUM.functionParameter.number2.name",detail:"formula.functionList.COUPNUM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.COUPPCD,functionType:A.Financial,description:"formula.functionList.COUPPCD.description",abstract:"formula.functionList.COUPPCD.abstract",functionParameter:[{name:"formula.functionList.COUPPCD.functionParameter.number1.name",detail:"formula.functionList.COUPPCD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUPPCD.functionParameter.number2.name",detail:"formula.functionList.COUPPCD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.CUMIPMT,functionType:A.Financial,description:"formula.functionList.CUMIPMT.description",abstract:"formula.functionList.CUMIPMT.abstract",functionParameter:[{name:"formula.functionList.CUMIPMT.functionParameter.number1.name",detail:"formula.functionList.CUMIPMT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUMIPMT.functionParameter.number2.name",detail:"formula.functionList.CUMIPMT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.CUMPRINC,functionType:A.Financial,description:"formula.functionList.CUMPRINC.description",abstract:"formula.functionList.CUMPRINC.abstract",functionParameter:[{name:"formula.functionList.CUMPRINC.functionParameter.number1.name",detail:"formula.functionList.CUMPRINC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CUMPRINC.functionParameter.number2.name",detail:"formula.functionList.CUMPRINC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.DB,functionType:A.Financial,description:"formula.functionList.DB.description",abstract:"formula.functionList.DB.abstract",functionParameter:[{name:"formula.functionList.DB.functionParameter.number1.name",detail:"formula.functionList.DB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DB.functionParameter.number2.name",detail:"formula.functionList.DB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.DDB,functionType:A.Financial,description:"formula.functionList.DDB.description",abstract:"formula.functionList.DDB.abstract",functionParameter:[{name:"formula.functionList.DDB.functionParameter.number1.name",detail:"formula.functionList.DDB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DDB.functionParameter.number2.name",detail:"formula.functionList.DDB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.DISC,functionType:A.Financial,description:"formula.functionList.DISC.description",abstract:"formula.functionList.DISC.abstract",functionParameter:[{name:"formula.functionList.DISC.functionParameter.number1.name",detail:"formula.functionList.DISC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DISC.functionParameter.number2.name",detail:"formula.functionList.DISC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.DOLLARDE,functionType:A.Financial,description:"formula.functionList.DOLLARDE.description",abstract:"formula.functionList.DOLLARDE.abstract",functionParameter:[{name:"formula.functionList.DOLLARDE.functionParameter.number1.name",detail:"formula.functionList.DOLLARDE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DOLLARDE.functionParameter.number2.name",detail:"formula.functionList.DOLLARDE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.DOLLARFR,functionType:A.Financial,description:"formula.functionList.DOLLARFR.description",abstract:"formula.functionList.DOLLARFR.abstract",functionParameter:[{name:"formula.functionList.DOLLARFR.functionParameter.number1.name",detail:"formula.functionList.DOLLARFR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DOLLARFR.functionParameter.number2.name",detail:"formula.functionList.DOLLARFR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.DURATION,functionType:A.Financial,description:"formula.functionList.DURATION.description",abstract:"formula.functionList.DURATION.abstract",functionParameter:[{name:"formula.functionList.DURATION.functionParameter.number1.name",detail:"formula.functionList.DURATION.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DURATION.functionParameter.number2.name",detail:"formula.functionList.DURATION.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.EFFECT,functionType:A.Financial,description:"formula.functionList.EFFECT.description",abstract:"formula.functionList.EFFECT.abstract",functionParameter:[{name:"formula.functionList.EFFECT.functionParameter.number1.name",detail:"formula.functionList.EFFECT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EFFECT.functionParameter.number2.name",detail:"formula.functionList.EFFECT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.FV,functionType:A.Financial,description:"formula.functionList.FV.description",abstract:"formula.functionList.FV.abstract",functionParameter:[{name:"formula.functionList.FV.functionParameter.number1.name",detail:"formula.functionList.FV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FV.functionParameter.number2.name",detail:"formula.functionList.FV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.FVSCHEDULE,functionType:A.Financial,description:"formula.functionList.FVSCHEDULE.description",abstract:"formula.functionList.FVSCHEDULE.abstract",functionParameter:[{name:"formula.functionList.FVSCHEDULE.functionParameter.number1.name",detail:"formula.functionList.FVSCHEDULE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FVSCHEDULE.functionParameter.number2.name",detail:"formula.functionList.FVSCHEDULE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.INTRATE,functionType:A.Financial,description:"formula.functionList.INTRATE.description",abstract:"formula.functionList.INTRATE.abstract",functionParameter:[{name:"formula.functionList.INTRATE.functionParameter.number1.name",detail:"formula.functionList.INTRATE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INTRATE.functionParameter.number2.name",detail:"formula.functionList.INTRATE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.IPMT,functionType:A.Financial,description:"formula.functionList.IPMT.description",abstract:"formula.functionList.IPMT.abstract",functionParameter:[{name:"formula.functionList.IPMT.functionParameter.number1.name",detail:"formula.functionList.IPMT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IPMT.functionParameter.number2.name",detail:"formula.functionList.IPMT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.IRR,functionType:A.Financial,description:"formula.functionList.IRR.description",abstract:"formula.functionList.IRR.abstract",functionParameter:[{name:"formula.functionList.IRR.functionParameter.number1.name",detail:"formula.functionList.IRR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IRR.functionParameter.number2.name",detail:"formula.functionList.IRR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.ISPMT,functionType:A.Financial,description:"formula.functionList.ISPMT.description",abstract:"formula.functionList.ISPMT.abstract",functionParameter:[{name:"formula.functionList.ISPMT.functionParameter.number1.name",detail:"formula.functionList.ISPMT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISPMT.functionParameter.number2.name",detail:"formula.functionList.ISPMT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.MDURATION,functionType:A.Financial,description:"formula.functionList.MDURATION.description",abstract:"formula.functionList.MDURATION.abstract",functionParameter:[{name:"formula.functionList.MDURATION.functionParameter.number1.name",detail:"formula.functionList.MDURATION.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MDURATION.functionParameter.number2.name",detail:"formula.functionList.MDURATION.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.MIRR,functionType:A.Financial,description:"formula.functionList.MIRR.description",abstract:"formula.functionList.MIRR.abstract",functionParameter:[{name:"formula.functionList.MIRR.functionParameter.number1.name",detail:"formula.functionList.MIRR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MIRR.functionParameter.number2.name",detail:"formula.functionList.MIRR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.NOMINAL,functionType:A.Financial,description:"formula.functionList.NOMINAL.description",abstract:"formula.functionList.NOMINAL.abstract",functionParameter:[{name:"formula.functionList.NOMINAL.functionParameter.number1.name",detail:"formula.functionList.NOMINAL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NOMINAL.functionParameter.number2.name",detail:"formula.functionList.NOMINAL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.NPER,functionType:A.Financial,description:"formula.functionList.NPER.description",abstract:"formula.functionList.NPER.abstract",functionParameter:[{name:"formula.functionList.NPER.functionParameter.number1.name",detail:"formula.functionList.NPER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NPER.functionParameter.number2.name",detail:"formula.functionList.NPER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.NPV,functionType:A.Financial,description:"formula.functionList.NPV.description",abstract:"formula.functionList.NPV.abstract",functionParameter:[{name:"formula.functionList.NPV.functionParameter.number1.name",detail:"formula.functionList.NPV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NPV.functionParameter.number2.name",detail:"formula.functionList.NPV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.ODDFPRICE,functionType:A.Financial,description:"formula.functionList.ODDFPRICE.description",abstract:"formula.functionList.ODDFPRICE.abstract",functionParameter:[{name:"formula.functionList.ODDFPRICE.functionParameter.number1.name",detail:"formula.functionList.ODDFPRICE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ODDFPRICE.functionParameter.number2.name",detail:"formula.functionList.ODDFPRICE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.ODDFYIELD,functionType:A.Financial,description:"formula.functionList.ODDFYIELD.description",abstract:"formula.functionList.ODDFYIELD.abstract",functionParameter:[{name:"formula.functionList.ODDFYIELD.functionParameter.number1.name",detail:"formula.functionList.ODDFYIELD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ODDFYIELD.functionParameter.number2.name",detail:"formula.functionList.ODDFYIELD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.ODDLPRICE,functionType:A.Financial,description:"formula.functionList.ODDLPRICE.description",abstract:"formula.functionList.ODDLPRICE.abstract",functionParameter:[{name:"formula.functionList.ODDLPRICE.functionParameter.number1.name",detail:"formula.functionList.ODDLPRICE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ODDLPRICE.functionParameter.number2.name",detail:"formula.functionList.ODDLPRICE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.ODDLYIELD,functionType:A.Financial,description:"formula.functionList.ODDLYIELD.description",abstract:"formula.functionList.ODDLYIELD.abstract",functionParameter:[{name:"formula.functionList.ODDLYIELD.functionParameter.number1.name",detail:"formula.functionList.ODDLYIELD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ODDLYIELD.functionParameter.number2.name",detail:"formula.functionList.ODDLYIELD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.PDURATION,functionType:A.Financial,description:"formula.functionList.PDURATION.description",abstract:"formula.functionList.PDURATION.abstract",functionParameter:[{name:"formula.functionList.PDURATION.functionParameter.number1.name",detail:"formula.functionList.PDURATION.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PDURATION.functionParameter.number2.name",detail:"formula.functionList.PDURATION.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.PMT,functionType:A.Financial,description:"formula.functionList.PMT.description",abstract:"formula.functionList.PMT.abstract",functionParameter:[{name:"formula.functionList.PMT.functionParameter.number1.name",detail:"formula.functionList.PMT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PMT.functionParameter.number2.name",detail:"formula.functionList.PMT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.PPMT,functionType:A.Financial,description:"formula.functionList.PPMT.description",abstract:"formula.functionList.PPMT.abstract",functionParameter:[{name:"formula.functionList.PPMT.functionParameter.number1.name",detail:"formula.functionList.PPMT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PPMT.functionParameter.number2.name",detail:"formula.functionList.PPMT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.PRICE,functionType:A.Financial,description:"formula.functionList.PRICE.description",abstract:"formula.functionList.PRICE.abstract",functionParameter:[{name:"formula.functionList.PRICE.functionParameter.number1.name",detail:"formula.functionList.PRICE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PRICE.functionParameter.number2.name",detail:"formula.functionList.PRICE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.PRICEDISC,functionType:A.Financial,description:"formula.functionList.PRICEDISC.description",abstract:"formula.functionList.PRICEDISC.abstract",functionParameter:[{name:"formula.functionList.PRICEDISC.functionParameter.number1.name",detail:"formula.functionList.PRICEDISC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PRICEDISC.functionParameter.number2.name",detail:"formula.functionList.PRICEDISC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.PRICEMAT,functionType:A.Financial,description:"formula.functionList.PRICEMAT.description",abstract:"formula.functionList.PRICEMAT.abstract",functionParameter:[{name:"formula.functionList.PRICEMAT.functionParameter.number1.name",detail:"formula.functionList.PRICEMAT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PRICEMAT.functionParameter.number2.name",detail:"formula.functionList.PRICEMAT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.PV,functionType:A.Financial,description:"formula.functionList.PV.description",abstract:"formula.functionList.PV.abstract",functionParameter:[{name:"formula.functionList.PV.functionParameter.number1.name",detail:"formula.functionList.PV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PV.functionParameter.number2.name",detail:"formula.functionList.PV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.RATE,functionType:A.Financial,description:"formula.functionList.RATE.description",abstract:"formula.functionList.RATE.abstract",functionParameter:[{name:"formula.functionList.RATE.functionParameter.number1.name",detail:"formula.functionList.RATE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RATE.functionParameter.number2.name",detail:"formula.functionList.RATE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.RECEIVED,functionType:A.Financial,description:"formula.functionList.RECEIVED.description",abstract:"formula.functionList.RECEIVED.abstract",functionParameter:[{name:"formula.functionList.RECEIVED.functionParameter.number1.name",detail:"formula.functionList.RECEIVED.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RECEIVED.functionParameter.number2.name",detail:"formula.functionList.RECEIVED.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.RRI,functionType:A.Financial,description:"formula.functionList.RRI.description",abstract:"formula.functionList.RRI.abstract",functionParameter:[{name:"formula.functionList.RRI.functionParameter.number1.name",detail:"formula.functionList.RRI.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RRI.functionParameter.number2.name",detail:"formula.functionList.RRI.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.SLN,functionType:A.Financial,description:"formula.functionList.SLN.description",abstract:"formula.functionList.SLN.abstract",functionParameter:[{name:"formula.functionList.SLN.functionParameter.number1.name",detail:"formula.functionList.SLN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SLN.functionParameter.number2.name",detail:"formula.functionList.SLN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.SYD,functionType:A.Financial,description:"formula.functionList.SYD.description",abstract:"formula.functionList.SYD.abstract",functionParameter:[{name:"formula.functionList.SYD.functionParameter.number1.name",detail:"formula.functionList.SYD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SYD.functionParameter.number2.name",detail:"formula.functionList.SYD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.TBILLEQ,functionType:A.Financial,description:"formula.functionList.TBILLEQ.description",abstract:"formula.functionList.TBILLEQ.abstract",functionParameter:[{name:"formula.functionList.TBILLEQ.functionParameter.number1.name",detail:"formula.functionList.TBILLEQ.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TBILLEQ.functionParameter.number2.name",detail:"formula.functionList.TBILLEQ.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.TBILLPRICE,functionType:A.Financial,description:"formula.functionList.TBILLPRICE.description",abstract:"formula.functionList.TBILLPRICE.abstract",functionParameter:[{name:"formula.functionList.TBILLPRICE.functionParameter.number1.name",detail:"formula.functionList.TBILLPRICE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TBILLPRICE.functionParameter.number2.name",detail:"formula.functionList.TBILLPRICE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.TBILLYIELD,functionType:A.Financial,description:"formula.functionList.TBILLYIELD.description",abstract:"formula.functionList.TBILLYIELD.abstract",functionParameter:[{name:"formula.functionList.TBILLYIELD.functionParameter.number1.name",detail:"formula.functionList.TBILLYIELD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TBILLYIELD.functionParameter.number2.name",detail:"formula.functionList.TBILLYIELD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.VDB,functionType:A.Financial,description:"formula.functionList.VDB.description",abstract:"formula.functionList.VDB.abstract",functionParameter:[{name:"formula.functionList.VDB.functionParameter.number1.name",detail:"formula.functionList.VDB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VDB.functionParameter.number2.name",detail:"formula.functionList.VDB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.XIRR,functionType:A.Financial,description:"formula.functionList.XIRR.description",abstract:"formula.functionList.XIRR.abstract",functionParameter:[{name:"formula.functionList.XIRR.functionParameter.number1.name",detail:"formula.functionList.XIRR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.XIRR.functionParameter.number2.name",detail:"formula.functionList.XIRR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.XNPV,functionType:A.Financial,description:"formula.functionList.XNPV.description",abstract:"formula.functionList.XNPV.abstract",functionParameter:[{name:"formula.functionList.XNPV.functionParameter.number1.name",detail:"formula.functionList.XNPV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.XNPV.functionParameter.number2.name",detail:"formula.functionList.XNPV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.YIELD,functionType:A.Financial,description:"formula.functionList.YIELD.description",abstract:"formula.functionList.YIELD.abstract",functionParameter:[{name:"formula.functionList.YIELD.functionParameter.number1.name",detail:"formula.functionList.YIELD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.YIELD.functionParameter.number2.name",detail:"formula.functionList.YIELD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.YIELDDISC,functionType:A.Financial,description:"formula.functionList.YIELDDISC.description",abstract:"formula.functionList.YIELDDISC.abstract",functionParameter:[{name:"formula.functionList.YIELDDISC.functionParameter.number1.name",detail:"formula.functionList.YIELDDISC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.YIELDDISC.functionParameter.number2.name",detail:"formula.functionList.YIELDDISC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:nn.YIELDMAT,functionType:A.Financial,description:"formula.functionList.YIELDMAT.description",abstract:"formula.functionList.YIELDMAT.abstract",functionParameter:[{name:"formula.functionList.YIELDMAT.functionParameter.number1.name",detail:"formula.functionList.YIELDMAT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.YIELDMAT.functionParameter.number2.name",detail:"formula.functionList.YIELDMAT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],iWe=[{functionName:jr.CELL,functionType:A.Information,description:"formula.functionList.CELL.description",abstract:"formula.functionList.CELL.abstract",functionParameter:[{name:"formula.functionList.CELL.functionParameter.number1.name",detail:"formula.functionList.CELL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CELL.functionParameter.number2.name",detail:"formula.functionList.CELL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ERROR_TYPE,functionType:A.Information,description:"formula.functionList.ERROR_TYPE.description",abstract:"formula.functionList.ERROR_TYPE.abstract",functionParameter:[{name:"formula.functionList.ERROR_TYPE.functionParameter.number1.name",detail:"formula.functionList.ERROR_TYPE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ERROR_TYPE.functionParameter.number2.name",detail:"formula.functionList.ERROR_TYPE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.INFO,functionType:A.Information,description:"formula.functionList.INFO.description",abstract:"formula.functionList.INFO.abstract",functionParameter:[{name:"formula.functionList.INFO.functionParameter.number1.name",detail:"formula.functionList.INFO.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INFO.functionParameter.number2.name",detail:"formula.functionList.INFO.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISBLANK,functionType:A.Information,description:"formula.functionList.ISBLANK.description",abstract:"formula.functionList.ISBLANK.abstract",functionParameter:[{name:"formula.functionList.ISBLANK.functionParameter.value.name",detail:"formula.functionList.ISBLANK.functionParameter.value.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISERR,functionType:A.Information,description:"formula.functionList.ISERR.description",abstract:"formula.functionList.ISERR.abstract",functionParameter:[{name:"formula.functionList.ISERR.functionParameter.number1.name",detail:"formula.functionList.ISERR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISERR.functionParameter.number2.name",detail:"formula.functionList.ISERR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISERROR,functionType:A.Information,description:"formula.functionList.ISERROR.description",abstract:"formula.functionList.ISERROR.abstract",functionParameter:[{name:"formula.functionList.ISERROR.functionParameter.number1.name",detail:"formula.functionList.ISERROR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISERROR.functionParameter.number2.name",detail:"formula.functionList.ISERROR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISEVEN,functionType:A.Information,description:"formula.functionList.ISEVEN.description",abstract:"formula.functionList.ISEVEN.abstract",functionParameter:[{name:"formula.functionList.ISEVEN.functionParameter.number1.name",detail:"formula.functionList.ISEVEN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISEVEN.functionParameter.number2.name",detail:"formula.functionList.ISEVEN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISFORMULA,functionType:A.Information,description:"formula.functionList.ISFORMULA.description",abstract:"formula.functionList.ISFORMULA.abstract",functionParameter:[{name:"formula.functionList.ISFORMULA.functionParameter.number1.name",detail:"formula.functionList.ISFORMULA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISFORMULA.functionParameter.number2.name",detail:"formula.functionList.ISFORMULA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISLOGICAL,functionType:A.Information,description:"formula.functionList.ISLOGICAL.description",abstract:"formula.functionList.ISLOGICAL.abstract",functionParameter:[{name:"formula.functionList.ISLOGICAL.functionParameter.number1.name",detail:"formula.functionList.ISLOGICAL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISLOGICAL.functionParameter.number2.name",detail:"formula.functionList.ISLOGICAL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISNA,functionType:A.Information,description:"formula.functionList.ISNA.description",abstract:"formula.functionList.ISNA.abstract",functionParameter:[{name:"formula.functionList.ISNA.functionParameter.number1.name",detail:"formula.functionList.ISNA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISNA.functionParameter.number2.name",detail:"formula.functionList.ISNA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISNONTEXT,functionType:A.Information,description:"formula.functionList.ISNONTEXT.description",abstract:"formula.functionList.ISNONTEXT.abstract",functionParameter:[{name:"formula.functionList.ISNONTEXT.functionParameter.number1.name",detail:"formula.functionList.ISNONTEXT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISNONTEXT.functionParameter.number2.name",detail:"formula.functionList.ISNONTEXT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISNUMBER,functionType:A.Information,description:"formula.functionList.ISNUMBER.description",abstract:"formula.functionList.ISNUMBER.abstract",functionParameter:[{name:"formula.functionList.ISNUMBER.functionParameter.number1.name",detail:"formula.functionList.ISNUMBER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISNUMBER.functionParameter.number2.name",detail:"formula.functionList.ISNUMBER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISODD,functionType:A.Information,description:"formula.functionList.ISODD.description",abstract:"formula.functionList.ISODD.abstract",functionParameter:[{name:"formula.functionList.ISODD.functionParameter.number1.name",detail:"formula.functionList.ISODD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISODD.functionParameter.number2.name",detail:"formula.functionList.ISODD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISOMITTED,functionType:A.Information,description:"formula.functionList.ISOMITTED.description",abstract:"formula.functionList.ISOMITTED.abstract",functionParameter:[{name:"formula.functionList.ISOMITTED.functionParameter.number1.name",detail:"formula.functionList.ISOMITTED.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISOMITTED.functionParameter.number2.name",detail:"formula.functionList.ISOMITTED.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISREF,functionType:A.Information,description:"formula.functionList.ISREF.description",abstract:"formula.functionList.ISREF.abstract",functionParameter:[{name:"formula.functionList.ISREF.functionParameter.number1.name",detail:"formula.functionList.ISREF.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISREF.functionParameter.number2.name",detail:"formula.functionList.ISREF.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.ISTEXT,functionType:A.Information,description:"formula.functionList.ISTEXT.description",abstract:"formula.functionList.ISTEXT.abstract",functionParameter:[{name:"formula.functionList.ISTEXT.functionParameter.number1.name",detail:"formula.functionList.ISTEXT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISTEXT.functionParameter.number2.name",detail:"formula.functionList.ISTEXT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.N,functionType:A.Information,description:"formula.functionList.N.description",abstract:"formula.functionList.N.abstract",functionParameter:[{name:"formula.functionList.N.functionParameter.number1.name",detail:"formula.functionList.N.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.N.functionParameter.number2.name",detail:"formula.functionList.N.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.NA,functionType:A.Information,description:"formula.functionList.NA.description",abstract:"formula.functionList.NA.abstract",functionParameter:[{name:"formula.functionList.NA.functionParameter.number1.name",detail:"formula.functionList.NA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NA.functionParameter.number2.name",detail:"formula.functionList.NA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.SHEET,functionType:A.Information,description:"formula.functionList.SHEET.description",abstract:"formula.functionList.SHEET.abstract",functionParameter:[{name:"formula.functionList.SHEET.functionParameter.number1.name",detail:"formula.functionList.SHEET.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SHEET.functionParameter.number2.name",detail:"formula.functionList.SHEET.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.SHEETS,functionType:A.Information,description:"formula.functionList.SHEETS.description",abstract:"formula.functionList.SHEETS.abstract",functionParameter:[{name:"formula.functionList.SHEETS.functionParameter.number1.name",detail:"formula.functionList.SHEETS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SHEETS.functionParameter.number2.name",detail:"formula.functionList.SHEETS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:jr.TYPE,functionType:A.Information,description:"formula.functionList.TYPE.description",abstract:"formula.functionList.TYPE.abstract",functionParameter:[{name:"formula.functionList.TYPE.functionParameter.number1.name",detail:"formula.functionList.TYPE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TYPE.functionParameter.number2.name",detail:"formula.functionList.TYPE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],oWe=[{functionName:Fr.AND,functionType:A.Logical,description:"formula.functionList.AND.description",abstract:"formula.functionList.AND.abstract",functionParameter:[{name:"formula.functionList.AND.functionParameter.logical1.name",detail:"formula.functionList.AND.functionParameter.logical1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AND.functionParameter.logical2.name",detail:"formula.functionList.AND.functionParameter.logical2.detail",example:"A1:A20",require:0,repeat:1}]},{functionName:Fr.BYCOL,functionType:A.Logical,description:"formula.functionList.BYCOL.description",abstract:"formula.functionList.BYCOL.abstract",functionParameter:[{name:"formula.functionList.BYCOL.functionParameter.number1.name",detail:"formula.functionList.BYCOL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BYCOL.functionParameter.number2.name",detail:"formula.functionList.BYCOL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.BYROW,functionType:A.Logical,description:"formula.functionList.BYROW.description",abstract:"formula.functionList.BYROW.abstract",functionParameter:[{name:"formula.functionList.BYROW.functionParameter.number1.name",detail:"formula.functionList.BYROW.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BYROW.functionParameter.number2.name",detail:"formula.functionList.BYROW.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.FALSE,functionType:A.Logical,description:"formula.functionList.FALSE.description",abstract:"formula.functionList.FALSE.abstract",functionParameter:[{name:"formula.functionList.FALSE.functionParameter.number1.name",detail:"formula.functionList.FALSE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FALSE.functionParameter.number2.name",detail:"formula.functionList.FALSE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.IF,functionType:A.Logical,description:"formula.functionList.IF.description",abstract:"formula.functionList.IF.abstract",functionParameter:[{name:"formula.functionList.IF.functionParameter.logicalTest.name",detail:"formula.functionList.IF.functionParameter.logicalTest.detail",example:"A1>B2",require:1,repeat:0},{name:"formula.functionList.IF.functionParameter.valueIfTrue.name",detail:"formula.functionList.IF.functionParameter.valueIfTrue.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IF.functionParameter.valueIfFalse.name",detail:"formula.functionList.IF.functionParameter.valueIfFalse.detail",example:"A1:A20",require:0,repeat:0}]},{functionName:Fr.IFERROR,functionType:A.Logical,description:"formula.functionList.IFERROR.description",abstract:"formula.functionList.IFERROR.abstract",functionParameter:[{name:"formula.functionList.IFERROR.functionParameter.value.name",detail:"formula.functionList.IFERROR.functionParameter.value.detail",example:"A2/B2",require:1,repeat:0},{name:"formula.functionList.IFERROR.functionParameter.valueIfError.name",detail:"formula.functionList.IFERROR.functionParameter.valueIfError.detail",example:"Error in calculation",require:1,repeat:0}]},{functionName:Fr.IFNA,functionType:A.Logical,description:"formula.functionList.IFNA.description",abstract:"formula.functionList.IFNA.abstract",functionParameter:[{name:"formula.functionList.IFNA.functionParameter.number1.name",detail:"formula.functionList.IFNA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IFNA.functionParameter.number2.name",detail:"formula.functionList.IFNA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.IFS,functionType:A.Logical,description:"formula.functionList.IFS.description",abstract:"formula.functionList.IFS.abstract",functionParameter:[{name:"formula.functionList.IFS.functionParameter.number1.name",detail:"formula.functionList.IFS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IFS.functionParameter.number2.name",detail:"formula.functionList.IFS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.LAMBDA,functionType:A.Logical,description:"formula.functionList.LAMBDA.description",abstract:"formula.functionList.LAMBDA.abstract",functionParameter:[{name:"formula.functionList.LAMBDA.functionParameter.parameter.name",detail:"formula.functionList.LAMBDA.functionParameter.parameter.detail",example:"[x, y, …,]",require:1,repeat:1},{name:"formula.functionList.LAMBDA.functionParameter.calculation.name",detail:"formula.functionList.LAMBDA.functionParameter.calculation.detail",example:"x+y",require:1,repeat:0}]},{functionName:Fr.LET,functionType:A.Logical,description:"formula.functionList.LET.description",abstract:"formula.functionList.LET.abstract",functionParameter:[{name:"formula.functionList.LET.functionParameter.number1.name",detail:"formula.functionList.LET.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LET.functionParameter.number2.name",detail:"formula.functionList.LET.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.MAKEARRAY,aliasFunctionName:"formula.functionList.MAKEARRAY.aliasFunctionName",functionType:A.Logical,description:"formula.functionList.MAKEARRAY.description",abstract:"formula.functionList.MAKEARRAY.abstract",functionParameter:[{name:"formula.functionList.MAKEARRAY.functionParameter.number1.name",detail:"formula.functionList.MAKEARRAY.functionParameter.number1.detail",example:"8",require:1,repeat:0},{name:"formula.functionList.MAKEARRAY.functionParameter.number2.name",detail:"formula.functionList.MAKEARRAY.functionParameter.number2.detail",example:"7",require:1,repeat:0},{name:"formula.functionList.MAKEARRAY.functionParameter.value3.name",detail:"formula.functionList.MAKEARRAY.functionParameter.value3.detail",example:"LAMBDA(r,c, r*c)",require:1,repeat:0}]},{functionName:Fr.MAP,functionType:A.Logical,description:"formula.functionList.MAP.description",abstract:"formula.functionList.MAP.abstract",functionParameter:[{name:"formula.functionList.MAP.functionParameter.number1.name",detail:"formula.functionList.MAP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAP.functionParameter.number2.name",detail:"formula.functionList.MAP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.NOT,functionType:A.Logical,description:"formula.functionList.NOT.description",abstract:"formula.functionList.NOT.abstract",functionParameter:[{name:"formula.functionList.NOT.functionParameter.number1.name",detail:"formula.functionList.NOT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NOT.functionParameter.number2.name",detail:"formula.functionList.NOT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.OR,functionType:A.Logical,description:"formula.functionList.OR.description",abstract:"formula.functionList.OR.abstract",functionParameter:[{name:"formula.functionList.OR.functionParameter.number1.name",detail:"formula.functionList.OR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.OR.functionParameter.number2.name",detail:"formula.functionList.OR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.REDUCE,functionType:A.Logical,description:"formula.functionList.REDUCE.description",abstract:"formula.functionList.REDUCE.abstract",functionParameter:[{name:"formula.functionList.REDUCE.functionParameter.number1.name",detail:"formula.functionList.REDUCE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.REDUCE.functionParameter.number2.name",detail:"formula.functionList.REDUCE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.SCAN,functionType:A.Logical,description:"formula.functionList.SCAN.description",abstract:"formula.functionList.SCAN.abstract",functionParameter:[{name:"formula.functionList.SCAN.functionParameter.number1.name",detail:"formula.functionList.SCAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SCAN.functionParameter.number2.name",detail:"formula.functionList.SCAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.SWITCH,functionType:A.Logical,description:"formula.functionList.SWITCH.description",abstract:"formula.functionList.SWITCH.abstract",functionParameter:[{name:"formula.functionList.SWITCH.functionParameter.number1.name",detail:"formula.functionList.SWITCH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SWITCH.functionParameter.number2.name",detail:"formula.functionList.SWITCH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.TRUE,functionType:A.Logical,description:"formula.functionList.TRUE.description",abstract:"formula.functionList.TRUE.abstract",functionParameter:[{name:"formula.functionList.TRUE.functionParameter.number1.name",detail:"formula.functionList.TRUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TRUE.functionParameter.number2.name",detail:"formula.functionList.TRUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Fr.XOR,functionType:A.Logical,description:"formula.functionList.XOR.description",abstract:"formula.functionList.XOR.abstract",functionParameter:[{name:"formula.functionList.XOR.functionParameter.number1.name",detail:"formula.functionList.XOR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.XOR.functionParameter.number2.name",detail:"formula.functionList.XOR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],aWe=[{functionName:Sn.ADDRESS,functionType:A.Lookup,description:"formula.functionList.ADDRESS.description",abstract:"formula.functionList.ADDRESS.abstract",functionParameter:[{name:"formula.functionList.ADDRESS.functionParameter.row_num.name",detail:"formula.functionList.ADDRESS.functionParameter.row_num.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.column_num.name",detail:"formula.functionList.ADDRESS.functionParameter.column_num.detail",example:"2",require:1,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.abs_num.name",detail:"formula.functionList.ADDRESS.functionParameter.abs_num.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.a1.name",detail:"formula.functionList.ADDRESS.functionParameter.a1.detail",example:"TRUE",require:0,repeat:0},{name:"formula.functionList.ADDRESS.functionParameter.sheet_text.name",detail:"formula.functionList.ADDRESS.functionParameter.sheet_text.detail",example:"Sheet2",require:0,repeat:0}]},{functionName:Sn.AREAS,functionType:A.Lookup,description:"formula.functionList.AREAS.description",abstract:"formula.functionList.AREAS.abstract",functionParameter:[{name:"formula.functionList.AREAS.functionParameter.number1.name",detail:"formula.functionList.AREAS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AREAS.functionParameter.number2.name",detail:"formula.functionList.AREAS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.CHOOSE,functionType:A.Lookup,description:"formula.functionList.CHOOSE.description",abstract:"formula.functionList.CHOOSE.abstract",functionParameter:[{name:"formula.functionList.CHOOSE.functionParameter.number1.name",detail:"formula.functionList.CHOOSE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHOOSE.functionParameter.number2.name",detail:"formula.functionList.CHOOSE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.CHOOSECOLS,functionType:A.Lookup,description:"formula.functionList.CHOOSECOLS.description",abstract:"formula.functionList.CHOOSECOLS.abstract",functionParameter:[{name:"formula.functionList.CHOOSECOLS.functionParameter.number1.name",detail:"formula.functionList.CHOOSECOLS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHOOSECOLS.functionParameter.number2.name",detail:"formula.functionList.CHOOSECOLS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.CHOOSEROWS,functionType:A.Lookup,description:"formula.functionList.CHOOSEROWS.description",abstract:"formula.functionList.CHOOSEROWS.abstract",functionParameter:[{name:"formula.functionList.CHOOSEROWS.functionParameter.number1.name",detail:"formula.functionList.CHOOSEROWS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHOOSEROWS.functionParameter.number2.name",detail:"formula.functionList.CHOOSEROWS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.COLUMN,functionType:A.Lookup,description:"formula.functionList.COLUMN.description",abstract:"formula.functionList.COLUMN.abstract",functionParameter:[{name:"formula.functionList.COLUMN.functionParameter.number1.name",detail:"formula.functionList.COLUMN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COLUMN.functionParameter.number2.name",detail:"formula.functionList.COLUMN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.COLUMNS,functionType:A.Lookup,description:"formula.functionList.COLUMNS.description",abstract:"formula.functionList.COLUMNS.abstract",functionParameter:[{name:"formula.functionList.COLUMNS.functionParameter.number1.name",detail:"formula.functionList.COLUMNS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COLUMNS.functionParameter.number2.name",detail:"formula.functionList.COLUMNS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.DROP,functionType:A.Lookup,description:"formula.functionList.DROP.description",abstract:"formula.functionList.DROP.abstract",functionParameter:[{name:"formula.functionList.DROP.functionParameter.number1.name",detail:"formula.functionList.DROP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DROP.functionParameter.number2.name",detail:"formula.functionList.DROP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.EXPAND,functionType:A.Lookup,description:"formula.functionList.EXPAND.description",abstract:"formula.functionList.EXPAND.abstract",functionParameter:[{name:"formula.functionList.EXPAND.functionParameter.number1.name",detail:"formula.functionList.EXPAND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EXPAND.functionParameter.number2.name",detail:"formula.functionList.EXPAND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.FILTER,functionType:A.Lookup,description:"formula.functionList.FILTER.description",abstract:"formula.functionList.FILTER.abstract",functionParameter:[{name:"formula.functionList.FILTER.functionParameter.number1.name",detail:"formula.functionList.FILTER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FILTER.functionParameter.number2.name",detail:"formula.functionList.FILTER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.FORMULATEXT,functionType:A.Lookup,description:"formula.functionList.FORMULATEXT.description",abstract:"formula.functionList.FORMULATEXT.abstract",functionParameter:[{name:"formula.functionList.FORMULATEXT.functionParameter.number1.name",detail:"formula.functionList.FORMULATEXT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORMULATEXT.functionParameter.number2.name",detail:"formula.functionList.FORMULATEXT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.GETPIVOTDATA,functionType:A.Lookup,description:"formula.functionList.GETPIVOTDATA.description",abstract:"formula.functionList.GETPIVOTDATA.abstract",functionParameter:[{name:"formula.functionList.GETPIVOTDATA.functionParameter.number1.name",detail:"formula.functionList.GETPIVOTDATA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GETPIVOTDATA.functionParameter.number2.name",detail:"formula.functionList.GETPIVOTDATA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.HLOOKUP,functionType:A.Lookup,description:"formula.functionList.HLOOKUP.description",abstract:"formula.functionList.HLOOKUP.abstract",functionParameter:[{name:"formula.functionList.HLOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.HLOOKUP.functionParameter.lookupValue.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.HLOOKUP.functionParameter.tableArray.name",detail:"formula.functionList.HLOOKUP.functionParameter.tableArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HLOOKUP.functionParameter.rowIndexNum.name",detail:"formula.functionList.HLOOKUP.functionParameter.rowIndexNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.HLOOKUP.functionParameter.rangeLookup.name",detail:"formula.functionList.HLOOKUP.functionParameter.rangeLookup.detail",example:"false",require:0,repeat:0}]},{functionName:Sn.HSTACK,functionType:A.Lookup,description:"formula.functionList.HSTACK.description",abstract:"formula.functionList.HSTACK.abstract",functionParameter:[{name:"formula.functionList.HSTACK.functionParameter.number1.name",detail:"formula.functionList.HSTACK.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HSTACK.functionParameter.number2.name",detail:"formula.functionList.HSTACK.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.HYPERLINK,functionType:A.Lookup,description:"formula.functionList.HYPERLINK.description",abstract:"formula.functionList.HYPERLINK.abstract",functionParameter:[{name:"formula.functionList.HYPERLINK.functionParameter.number1.name",detail:"formula.functionList.HYPERLINK.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HYPERLINK.functionParameter.number2.name",detail:"formula.functionList.HYPERLINK.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.IMAGE,functionType:A.Lookup,description:"formula.functionList.IMAGE.description",abstract:"formula.functionList.IMAGE.abstract",functionParameter:[{name:"formula.functionList.IMAGE.functionParameter.number1.name",detail:"formula.functionList.IMAGE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.IMAGE.functionParameter.number2.name",detail:"formula.functionList.IMAGE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.INDEX,functionType:A.Lookup,description:"formula.functionList.INDEX.description",abstract:"formula.functionList.INDEX.abstract",functionParameter:[{name:"formula.functionList.INDEX.functionParameter.number1.name",detail:"formula.functionList.INDEX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INDEX.functionParameter.number2.name",detail:"formula.functionList.INDEX.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.INDIRECT,functionType:A.Lookup,description:"formula.functionList.INDIRECT.description",abstract:"formula.functionList.INDIRECT.abstract",functionParameter:[{name:"formula.functionList.INDIRECT.functionParameter.number1.name",detail:"formula.functionList.INDIRECT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INDIRECT.functionParameter.number2.name",detail:"formula.functionList.INDIRECT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.LOOKUP,functionType:A.Lookup,description:"formula.functionList.LOOKUP.description",abstract:"formula.functionList.LOOKUP.abstract",functionParameter:[{name:"formula.functionList.LOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.LOOKUP.functionParameter.lookupValue.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.LOOKUP.functionParameter.lookupVectorOrArray.name",detail:"formula.functionList.LOOKUP.functionParameter.lookupVectorOrArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOOKUP.functionParameter.resultVector.name",detail:"formula.functionList.LOOKUP.functionParameter.resultVector.detail",example:"A1:A20",require:0,repeat:0}]},{functionName:Sn.MATCH,functionType:A.Lookup,description:"formula.functionList.MATCH.description",abstract:"formula.functionList.MATCH.abstract",functionParameter:[{name:"formula.functionList.MATCH.functionParameter.lookupValue.name",detail:"formula.functionList.MATCH.functionParameter.lookupValue.detail",example:"10",require:1,repeat:0},{name:"formula.functionList.MATCH.functionParameter.lookupArray.name",detail:"formula.functionList.MATCH.functionParameter.lookupArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MATCH.functionParameter.matchType.name",detail:"formula.functionList.MATCH.functionParameter.matchType.detail",example:"1",require:0,repeat:0}]},{functionName:Sn.OFFSET,functionType:A.Lookup,description:"formula.functionList.OFFSET.description",abstract:"formula.functionList.OFFSET.abstract",functionParameter:[{name:"formula.functionList.OFFSET.functionParameter.reference.name",detail:"formula.functionList.OFFSET.functionParameter.reference.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.rows.name",detail:"formula.functionList.OFFSET.functionParameter.rows.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.cols.name",detail:"formula.functionList.OFFSET.functionParameter.cols.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.height.name",detail:"formula.functionList.OFFSET.functionParameter.height.detail",example:"1",require:0,repeat:0},{name:"formula.functionList.OFFSET.functionParameter.width.name",detail:"formula.functionList.OFFSET.functionParameter.width.detail",example:"1",require:0,repeat:0}]},{functionName:Sn.ROW,functionType:A.Lookup,description:"formula.functionList.ROW.description",abstract:"formula.functionList.ROW.abstract",functionParameter:[{name:"formula.functionList.ROW.functionParameter.number1.name",detail:"formula.functionList.ROW.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ROW.functionParameter.number2.name",detail:"formula.functionList.ROW.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.ROWS,functionType:A.Lookup,description:"formula.functionList.ROWS.description",abstract:"formula.functionList.ROWS.abstract",functionParameter:[{name:"formula.functionList.ROWS.functionParameter.number1.name",detail:"formula.functionList.ROWS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ROWS.functionParameter.number2.name",detail:"formula.functionList.ROWS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.RTD,functionType:A.Lookup,description:"formula.functionList.RTD.description",abstract:"formula.functionList.RTD.abstract",functionParameter:[{name:"formula.functionList.RTD.functionParameter.number1.name",detail:"formula.functionList.RTD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RTD.functionParameter.number2.name",detail:"formula.functionList.RTD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.SORT,functionType:A.Lookup,description:"formula.functionList.SORT.description",abstract:"formula.functionList.SORT.abstract",functionParameter:[{name:"formula.functionList.SORT.functionParameter.number1.name",detail:"formula.functionList.SORT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SORT.functionParameter.number2.name",detail:"formula.functionList.SORT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.SORTBY,functionType:A.Lookup,description:"formula.functionList.SORTBY.description",abstract:"formula.functionList.SORTBY.abstract",functionParameter:[{name:"formula.functionList.SORTBY.functionParameter.number1.name",detail:"formula.functionList.SORTBY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SORTBY.functionParameter.number2.name",detail:"formula.functionList.SORTBY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.TAKE,functionType:A.Lookup,description:"formula.functionList.TAKE.description",abstract:"formula.functionList.TAKE.abstract",functionParameter:[{name:"formula.functionList.TAKE.functionParameter.number1.name",detail:"formula.functionList.TAKE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TAKE.functionParameter.number2.name",detail:"formula.functionList.TAKE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.TOCOL,functionType:A.Lookup,description:"formula.functionList.TOCOL.description",abstract:"formula.functionList.TOCOL.abstract",functionParameter:[{name:"formula.functionList.TOCOL.functionParameter.number1.name",detail:"formula.functionList.TOCOL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TOCOL.functionParameter.number2.name",detail:"formula.functionList.TOCOL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.TOROW,functionType:A.Lookup,description:"formula.functionList.TOROW.description",abstract:"formula.functionList.TOROW.abstract",functionParameter:[{name:"formula.functionList.TOROW.functionParameter.number1.name",detail:"formula.functionList.TOROW.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TOROW.functionParameter.number2.name",detail:"formula.functionList.TOROW.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.TRANSPOSE,functionType:A.Lookup,description:"formula.functionList.TRANSPOSE.description",abstract:"formula.functionList.TRANSPOSE.abstract",functionParameter:[{name:"formula.functionList.TRANSPOSE.functionParameter.number1.name",detail:"formula.functionList.TRANSPOSE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TRANSPOSE.functionParameter.number2.name",detail:"formula.functionList.TRANSPOSE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.UNIQUE,functionType:A.Lookup,description:"formula.functionList.UNIQUE.description",abstract:"formula.functionList.UNIQUE.abstract",functionParameter:[{name:"formula.functionList.UNIQUE.functionParameter.number1.name",detail:"formula.functionList.UNIQUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.UNIQUE.functionParameter.number2.name",detail:"formula.functionList.UNIQUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.VLOOKUP,functionType:A.Lookup,description:"formula.functionList.VLOOKUP.description",abstract:"formula.functionList.VLOOKUP.abstract",functionParameter:[{name:"formula.functionList.VLOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.VLOOKUP.functionParameter.lookupValue.detail",example:"B2",require:1,repeat:0},{name:"formula.functionList.VLOOKUP.functionParameter.tableArray.name",detail:"formula.functionList.VLOOKUP.functionParameter.tableArray.detail",example:"C2:E7",require:1,repeat:0},{name:"formula.functionList.VLOOKUP.functionParameter.colIndexNum.name",detail:"formula.functionList.VLOOKUP.functionParameter.colIndexNum.detail",example:"1",require:1,repeat:0},{name:"formula.functionList.VLOOKUP.functionParameter.rangeLookup.name",detail:"formula.functionList.VLOOKUP.functionParameter.rangeLookup.detail",example:"TRUE",require:0,repeat:0}]},{functionName:Sn.VSTACK,functionType:A.Lookup,description:"formula.functionList.VSTACK.description",abstract:"formula.functionList.VSTACK.abstract",functionParameter:[{name:"formula.functionList.VSTACK.functionParameter.number1.name",detail:"formula.functionList.VSTACK.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VSTACK.functionParameter.number2.name",detail:"formula.functionList.VSTACK.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.WRAPCOLS,functionType:A.Lookup,description:"formula.functionList.WRAPCOLS.description",abstract:"formula.functionList.WRAPCOLS.abstract",functionParameter:[{name:"formula.functionList.WRAPCOLS.functionParameter.number1.name",detail:"formula.functionList.WRAPCOLS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WRAPCOLS.functionParameter.number2.name",detail:"formula.functionList.WRAPCOLS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.WRAPROWS,functionType:A.Lookup,description:"formula.functionList.WRAPROWS.description",abstract:"formula.functionList.WRAPROWS.abstract",functionParameter:[{name:"formula.functionList.WRAPROWS.functionParameter.number1.name",detail:"formula.functionList.WRAPROWS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WRAPROWS.functionParameter.number2.name",detail:"formula.functionList.WRAPROWS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Sn.XLOOKUP,functionType:A.Lookup,description:"formula.functionList.XLOOKUP.description",abstract:"formula.functionList.XLOOKUP.abstract",functionParameter:[{name:"formula.functionList.XLOOKUP.functionParameter.lookupValue.name",detail:"formula.functionList.XLOOKUP.functionParameter.lookupValue.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.lookupArray.name",detail:"formula.functionList.XLOOKUP.functionParameter.lookupArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.returnArray.name",detail:"formula.functionList.XLOOKUP.functionParameter.returnArray.detail",example:"B1:B20",require:1,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.ifNotFound.name",detail:"formula.functionList.XLOOKUP.functionParameter.ifNotFound.detail",example:"default",require:0,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.matchMode.name",detail:"formula.functionList.XLOOKUP.functionParameter.matchMode.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.XLOOKUP.functionParameter.searchMode.name",detail:"formula.functionList.XLOOKUP.functionParameter.searchMode.detail",example:"1",require:0,repeat:0}]},{functionName:Sn.XMATCH,functionType:A.Lookup,description:"formula.functionList.XMATCH.description",abstract:"formula.functionList.XMATCH.abstract",functionParameter:[{name:"formula.functionList.XMATCH.functionParameter.lookupValue.name",detail:"formula.functionList.XMATCH.functionParameter.lookupValue.detail",example:"B1",require:1,repeat:0},{name:"formula.functionList.XMATCH.functionParameter.lookupArray.name",detail:"formula.functionList.XMATCH.functionParameter.lookupArray.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.XMATCH.functionParameter.matchMode.name",detail:"formula.functionList.XMATCH.functionParameter.matchMode.detail",example:"0",require:0,repeat:0},{name:"formula.functionList.XMATCH.functionParameter.searchMode.name",detail:"formula.functionList.XMATCH.functionParameter.searchMode.detail",example:"1",require:0,repeat:0}]}],sWe=[{functionName:gt.ABS,functionType:A.Math,description:"formula.functionList.ABS.description",abstract:"formula.functionList.ABS.abstract",functionParameter:[{name:"formula.functionList.ABS.functionParameter.number.name",detail:"formula.functionList.ABS.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ACOS,functionType:A.Math,description:"formula.functionList.ACOS.description",abstract:"formula.functionList.ACOS.abstract",functionParameter:[{name:"formula.functionList.ACOS.functionParameter.number.name",detail:"formula.functionList.ACOS.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ACOSH,functionType:A.Math,description:"formula.functionList.ACOSH.description",abstract:"formula.functionList.ACOSH.abstract",functionParameter:[{name:"formula.functionList.ACOSH.functionParameter.number.name",detail:"formula.functionList.ACOSH.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ACOT,functionType:A.Math,description:"formula.functionList.ACOT.description",abstract:"formula.functionList.ACOT.abstract",functionParameter:[{name:"formula.functionList.ACOT.functionParameter.number.name",detail:"formula.functionList.ACOT.functionParameter.number.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ACOTH,functionType:A.Math,description:"formula.functionList.ACOTH.description",abstract:"formula.functionList.ACOTH.abstract",functionParameter:[{name:"formula.functionList.ACOTH.functionParameter.number1.name",detail:"formula.functionList.ACOTH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ACOTH.functionParameter.number2.name",detail:"formula.functionList.ACOTH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.AGGREGATE,functionType:A.Math,description:"formula.functionList.AGGREGATE.description",abstract:"formula.functionList.AGGREGATE.abstract",functionParameter:[{name:"formula.functionList.AGGREGATE.functionParameter.number1.name",detail:"formula.functionList.AGGREGATE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AGGREGATE.functionParameter.number2.name",detail:"formula.functionList.AGGREGATE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ARABIC,functionType:A.Math,description:"formula.functionList.ARABIC.description",abstract:"formula.functionList.ARABIC.abstract",functionParameter:[{name:"formula.functionList.ARABIC.functionParameter.number1.name",detail:"formula.functionList.ARABIC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ARABIC.functionParameter.number2.name",detail:"formula.functionList.ARABIC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ASIN,functionType:A.Math,description:"formula.functionList.ASIN.description",abstract:"formula.functionList.ASIN.abstract",functionParameter:[{name:"formula.functionList.ASIN.functionParameter.number1.name",detail:"formula.functionList.ASIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ASIN.functionParameter.number2.name",detail:"formula.functionList.ASIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ASINH,functionType:A.Math,description:"formula.functionList.ASINH.description",abstract:"formula.functionList.ASINH.abstract",functionParameter:[{name:"formula.functionList.ASINH.functionParameter.number1.name",detail:"formula.functionList.ASINH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ASINH.functionParameter.number2.name",detail:"formula.functionList.ASINH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ATAN,functionType:A.Math,description:"formula.functionList.ATAN.description",abstract:"formula.functionList.ATAN.abstract",functionParameter:[{name:"formula.functionList.ATAN.functionParameter.number1.name",detail:"formula.functionList.ATAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ATAN.functionParameter.number2.name",detail:"formula.functionList.ATAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ATAN2,functionType:A.Math,description:"formula.functionList.ATAN2.description",abstract:"formula.functionList.ATAN2.abstract",functionParameter:[{name:"formula.functionList.ATAN2.functionParameter.number1.name",detail:"formula.functionList.ATAN2.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ATAN2.functionParameter.number2.name",detail:"formula.functionList.ATAN2.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ATANH,functionType:A.Math,description:"formula.functionList.ATANH.description",abstract:"formula.functionList.ATANH.abstract",functionParameter:[{name:"formula.functionList.ATANH.functionParameter.number1.name",detail:"formula.functionList.ATANH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ATANH.functionParameter.number2.name",detail:"formula.functionList.ATANH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.BASE,functionType:A.Math,description:"formula.functionList.BASE.description",abstract:"formula.functionList.BASE.abstract",functionParameter:[{name:"formula.functionList.BASE.functionParameter.number1.name",detail:"formula.functionList.BASE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BASE.functionParameter.number2.name",detail:"formula.functionList.BASE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.CEILING,functionType:A.Math,description:"formula.functionList.CEILING.description",abstract:"formula.functionList.CEILING.abstract",functionParameter:[{name:"formula.functionList.CEILING.functionParameter.number1.name",detail:"formula.functionList.CEILING.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CEILING.functionParameter.number2.name",detail:"formula.functionList.CEILING.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.CEILING_MATH,functionType:A.Math,description:"formula.functionList.CEILING_MATH.description",abstract:"formula.functionList.CEILING_MATH.abstract",functionParameter:[{name:"formula.functionList.CEILING_MATH.functionParameter.number1.name",detail:"formula.functionList.CEILING_MATH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CEILING_MATH.functionParameter.number2.name",detail:"formula.functionList.CEILING_MATH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.CEILING_PRECISE,functionType:A.Math,description:"formula.functionList.CEILING_PRECISE.description",abstract:"formula.functionList.CEILING_PRECISE.abstract",functionParameter:[{name:"formula.functionList.CEILING_PRECISE.functionParameter.number1.name",detail:"formula.functionList.CEILING_PRECISE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CEILING_PRECISE.functionParameter.number2.name",detail:"formula.functionList.CEILING_PRECISE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.COMBIN,functionType:A.Math,description:"formula.functionList.COMBIN.description",abstract:"formula.functionList.COMBIN.abstract",functionParameter:[{name:"formula.functionList.COMBIN.functionParameter.number1.name",detail:"formula.functionList.COMBIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COMBIN.functionParameter.number2.name",detail:"formula.functionList.COMBIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.COMBINA,functionType:A.Math,description:"formula.functionList.COMBINA.description",abstract:"formula.functionList.COMBINA.abstract",functionParameter:[{name:"formula.functionList.COMBINA.functionParameter.number1.name",detail:"formula.functionList.COMBINA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COMBINA.functionParameter.number2.name",detail:"formula.functionList.COMBINA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.COS,functionType:A.Math,description:"formula.functionList.COS.description",abstract:"formula.functionList.COS.abstract",functionParameter:[{name:"formula.functionList.COS.functionParameter.number1.name",detail:"formula.functionList.COS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COS.functionParameter.number2.name",detail:"formula.functionList.COS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.COSH,functionType:A.Math,description:"formula.functionList.COSH.description",abstract:"formula.functionList.COSH.abstract",functionParameter:[{name:"formula.functionList.COSH.functionParameter.number1.name",detail:"formula.functionList.COSH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COSH.functionParameter.number2.name",detail:"formula.functionList.COSH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.COT,functionType:A.Math,description:"formula.functionList.COT.description",abstract:"formula.functionList.COT.abstract",functionParameter:[{name:"formula.functionList.COT.functionParameter.number1.name",detail:"formula.functionList.COT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COT.functionParameter.number2.name",detail:"formula.functionList.COT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.COTH,functionType:A.Math,description:"formula.functionList.COTH.description",abstract:"formula.functionList.COTH.abstract",functionParameter:[{name:"formula.functionList.COTH.functionParameter.number1.name",detail:"formula.functionList.COTH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COTH.functionParameter.number2.name",detail:"formula.functionList.COTH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.CSC,functionType:A.Math,description:"formula.functionList.CSC.description",abstract:"formula.functionList.CSC.abstract",functionParameter:[{name:"formula.functionList.CSC.functionParameter.number1.name",detail:"formula.functionList.CSC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CSC.functionParameter.number2.name",detail:"formula.functionList.CSC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.CSCH,functionType:A.Math,description:"formula.functionList.CSCH.description",abstract:"formula.functionList.CSCH.abstract",functionParameter:[{name:"formula.functionList.CSCH.functionParameter.number1.name",detail:"formula.functionList.CSCH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CSCH.functionParameter.number2.name",detail:"formula.functionList.CSCH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.DECIMAL,functionType:A.Math,description:"formula.functionList.DECIMAL.description",abstract:"formula.functionList.DECIMAL.abstract",functionParameter:[{name:"formula.functionList.DECIMAL.functionParameter.number1.name",detail:"formula.functionList.DECIMAL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DECIMAL.functionParameter.number2.name",detail:"formula.functionList.DECIMAL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.DEGREES,functionType:A.Math,description:"formula.functionList.DEGREES.description",abstract:"formula.functionList.DEGREES.abstract",functionParameter:[{name:"formula.functionList.DEGREES.functionParameter.number1.name",detail:"formula.functionList.DEGREES.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DEGREES.functionParameter.number2.name",detail:"formula.functionList.DEGREES.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.EVEN,functionType:A.Math,description:"formula.functionList.EVEN.description",abstract:"formula.functionList.EVEN.abstract",functionParameter:[{name:"formula.functionList.EVEN.functionParameter.number1.name",detail:"formula.functionList.EVEN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EVEN.functionParameter.number2.name",detail:"formula.functionList.EVEN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.EXP,functionType:A.Math,description:"formula.functionList.EXP.description",abstract:"formula.functionList.EXP.abstract",functionParameter:[{name:"formula.functionList.EXP.functionParameter.number1.name",detail:"formula.functionList.EXP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EXP.functionParameter.number2.name",detail:"formula.functionList.EXP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.FACT,functionType:A.Math,description:"formula.functionList.FACT.description",abstract:"formula.functionList.FACT.abstract",functionParameter:[{name:"formula.functionList.FACT.functionParameter.number1.name",detail:"formula.functionList.FACT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FACT.functionParameter.number2.name",detail:"formula.functionList.FACT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.FACTDOUBLE,functionType:A.Math,description:"formula.functionList.FACTDOUBLE.description",abstract:"formula.functionList.FACTDOUBLE.abstract",functionParameter:[{name:"formula.functionList.FACTDOUBLE.functionParameter.number1.name",detail:"formula.functionList.FACTDOUBLE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FACTDOUBLE.functionParameter.number2.name",detail:"formula.functionList.FACTDOUBLE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.FLOOR,functionType:A.Math,description:"formula.functionList.FLOOR.description",abstract:"formula.functionList.FLOOR.abstract",functionParameter:[{name:"formula.functionList.FLOOR.functionParameter.number1.name",detail:"formula.functionList.FLOOR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FLOOR.functionParameter.number2.name",detail:"formula.functionList.FLOOR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.FLOOR_MATH,functionType:A.Math,description:"formula.functionList.FLOOR_MATH.description",abstract:"formula.functionList.FLOOR_MATH.abstract",functionParameter:[{name:"formula.functionList.FLOOR_MATH.functionParameter.number1.name",detail:"formula.functionList.FLOOR_MATH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FLOOR_MATH.functionParameter.number2.name",detail:"formula.functionList.FLOOR_MATH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.FLOOR_PRECISE,functionType:A.Math,description:"formula.functionList.FLOOR_PRECISE.description",abstract:"formula.functionList.FLOOR_PRECISE.abstract",functionParameter:[{name:"formula.functionList.FLOOR_PRECISE.functionParameter.number1.name",detail:"formula.functionList.FLOOR_PRECISE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FLOOR_PRECISE.functionParameter.number2.name",detail:"formula.functionList.FLOOR_PRECISE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.GCD,functionType:A.Math,description:"formula.functionList.GCD.description",abstract:"formula.functionList.GCD.abstract",functionParameter:[{name:"formula.functionList.GCD.functionParameter.number1.name",detail:"formula.functionList.GCD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GCD.functionParameter.number2.name",detail:"formula.functionList.GCD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.INT,functionType:A.Math,description:"formula.functionList.INT.description",abstract:"formula.functionList.INT.abstract",functionParameter:[{name:"formula.functionList.INT.functionParameter.number1.name",detail:"formula.functionList.INT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INT.functionParameter.number2.name",detail:"formula.functionList.INT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ISO_CEILING,functionType:A.Math,description:"formula.functionList.ISO_CEILING.description",abstract:"formula.functionList.ISO_CEILING.abstract",functionParameter:[{name:"formula.functionList.ISO_CEILING.functionParameter.number1.name",detail:"formula.functionList.ISO_CEILING.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ISO_CEILING.functionParameter.number2.name",detail:"formula.functionList.ISO_CEILING.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.LCM,functionType:A.Math,description:"formula.functionList.LCM.description",abstract:"formula.functionList.LCM.abstract",functionParameter:[{name:"formula.functionList.LCM.functionParameter.number1.name",detail:"formula.functionList.LCM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LCM.functionParameter.number2.name",detail:"formula.functionList.LCM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.LET,functionType:A.Math,description:"formula.functionList.LET.description",abstract:"formula.functionList.LET.abstract",functionParameter:[{name:"formula.functionList.LET.functionParameter.number1.name",detail:"formula.functionList.LET.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LET.functionParameter.number2.name",detail:"formula.functionList.LET.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.LN,functionType:A.Math,description:"formula.functionList.LN.description",abstract:"formula.functionList.LN.abstract",functionParameter:[{name:"formula.functionList.LN.functionParameter.number1.name",detail:"formula.functionList.LN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LN.functionParameter.number2.name",detail:"formula.functionList.LN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.LOG,functionType:A.Math,description:"formula.functionList.LOG.description",abstract:"formula.functionList.LOG.abstract",functionParameter:[{name:"formula.functionList.LOG.functionParameter.number1.name",detail:"formula.functionList.LOG.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOG.functionParameter.number2.name",detail:"formula.functionList.LOG.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.LOG10,functionType:A.Math,description:"formula.functionList.LOG10.description",abstract:"formula.functionList.LOG10.abstract",functionParameter:[{name:"formula.functionList.LOG10.functionParameter.number1.name",detail:"formula.functionList.LOG10.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOG10.functionParameter.number2.name",detail:"formula.functionList.LOG10.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.MDETERM,functionType:A.Math,description:"formula.functionList.MDETERM.description",abstract:"formula.functionList.MDETERM.abstract",functionParameter:[{name:"formula.functionList.MDETERM.functionParameter.number1.name",detail:"formula.functionList.MDETERM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MDETERM.functionParameter.number2.name",detail:"formula.functionList.MDETERM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.MINVERSE,functionType:A.Math,description:"formula.functionList.MINVERSE.description",abstract:"formula.functionList.MINVERSE.abstract",functionParameter:[{name:"formula.functionList.MINVERSE.functionParameter.number1.name",detail:"formula.functionList.MINVERSE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MINVERSE.functionParameter.number2.name",detail:"formula.functionList.MINVERSE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.MMULT,functionType:A.Math,description:"formula.functionList.MMULT.description",abstract:"formula.functionList.MMULT.abstract",functionParameter:[{name:"formula.functionList.MMULT.functionParameter.number1.name",detail:"formula.functionList.MMULT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MMULT.functionParameter.number2.name",detail:"formula.functionList.MMULT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.MOD,functionType:A.Math,description:"formula.functionList.MOD.description",abstract:"formula.functionList.MOD.abstract",functionParameter:[{name:"formula.functionList.MOD.functionParameter.number1.name",detail:"formula.functionList.MOD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MOD.functionParameter.number2.name",detail:"formula.functionList.MOD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.MROUND,functionType:A.Math,description:"formula.functionList.MROUND.description",abstract:"formula.functionList.MROUND.abstract",functionParameter:[{name:"formula.functionList.MROUND.functionParameter.number1.name",detail:"formula.functionList.MROUND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MROUND.functionParameter.number2.name",detail:"formula.functionList.MROUND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.MULTINOMIAL,functionType:A.Math,description:"formula.functionList.MULTINOMIAL.description",abstract:"formula.functionList.MULTINOMIAL.abstract",functionParameter:[{name:"formula.functionList.MULTINOMIAL.functionParameter.number1.name",detail:"formula.functionList.MULTINOMIAL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MULTINOMIAL.functionParameter.number2.name",detail:"formula.functionList.MULTINOMIAL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.MUNIT,functionType:A.Math,description:"formula.functionList.MUNIT.description",abstract:"formula.functionList.MUNIT.abstract",functionParameter:[{name:"formula.functionList.MUNIT.functionParameter.number1.name",detail:"formula.functionList.MUNIT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MUNIT.functionParameter.number2.name",detail:"formula.functionList.MUNIT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ODD,functionType:A.Math,description:"formula.functionList.ODD.description",abstract:"formula.functionList.ODD.abstract",functionParameter:[{name:"formula.functionList.ODD.functionParameter.number1.name",detail:"formula.functionList.ODD.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ODD.functionParameter.number2.name",detail:"formula.functionList.ODD.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.PI,functionType:A.Math,description:"formula.functionList.PI.description",abstract:"formula.functionList.PI.abstract",functionParameter:[{name:"formula.functionList.PI.functionParameter.number1.name",detail:"formula.functionList.PI.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PI.functionParameter.number2.name",detail:"formula.functionList.PI.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.POWER,functionType:A.Math,description:"formula.functionList.POWER.description",abstract:"formula.functionList.POWER.abstract",functionParameter:[{name:"formula.functionList.POWER.functionParameter.number1.name",detail:"formula.functionList.POWER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.POWER.functionParameter.number2.name",detail:"formula.functionList.POWER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.PRODUCT,functionType:A.Math,description:"formula.functionList.PRODUCT.description",abstract:"formula.functionList.PRODUCT.abstract",functionParameter:[{name:"formula.functionList.PRODUCT.functionParameter.number1.name",detail:"formula.functionList.PRODUCT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PRODUCT.functionParameter.number2.name",detail:"formula.functionList.PRODUCT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.QUOTIENT,functionType:A.Math,description:"formula.functionList.QUOTIENT.description",abstract:"formula.functionList.QUOTIENT.abstract",functionParameter:[{name:"formula.functionList.QUOTIENT.functionParameter.number1.name",detail:"formula.functionList.QUOTIENT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.QUOTIENT.functionParameter.number2.name",detail:"formula.functionList.QUOTIENT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.RADIANS,functionType:A.Math,description:"formula.functionList.RADIANS.description",abstract:"formula.functionList.RADIANS.abstract",functionParameter:[{name:"formula.functionList.RADIANS.functionParameter.number1.name",detail:"formula.functionList.RADIANS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RADIANS.functionParameter.number2.name",detail:"formula.functionList.RADIANS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.RAND,functionType:A.Math,description:"formula.functionList.RAND.description",abstract:"formula.functionList.RAND.abstract",functionParameter:[{name:"formula.functionList.RAND.functionParameter.number1.name",detail:"formula.functionList.RAND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RAND.functionParameter.number2.name",detail:"formula.functionList.RAND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.RANDARRAY,functionType:A.Math,description:"formula.functionList.RANDARRAY.description",abstract:"formula.functionList.RANDARRAY.abstract",functionParameter:[{name:"formula.functionList.RANDARRAY.functionParameter.number1.name",detail:"formula.functionList.RANDARRAY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RANDARRAY.functionParameter.number2.name",detail:"formula.functionList.RANDARRAY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.RANDBETWEEN,functionType:A.Math,description:"formula.functionList.RANDBETWEEN.description",abstract:"formula.functionList.RANDBETWEEN.abstract",functionParameter:[{name:"formula.functionList.RANDBETWEEN.functionParameter.number1.name",detail:"formula.functionList.RANDBETWEEN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RANDBETWEEN.functionParameter.number2.name",detail:"formula.functionList.RANDBETWEEN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ROMAN,functionType:A.Math,description:"formula.functionList.ROMAN.description",abstract:"formula.functionList.ROMAN.abstract",functionParameter:[{name:"formula.functionList.ROMAN.functionParameter.number1.name",detail:"formula.functionList.ROMAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ROMAN.functionParameter.number2.name",detail:"formula.functionList.ROMAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ROUND,functionType:A.Math,description:"formula.functionList.ROUND.description",abstract:"formula.functionList.ROUND.abstract",functionParameter:[{name:"formula.functionList.ROUND.functionParameter.number1.name",detail:"formula.functionList.ROUND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ROUND.functionParameter.number2.name",detail:"formula.functionList.ROUND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ROUNDDOWN,functionType:A.Math,description:"formula.functionList.ROUNDDOWN.description",abstract:"formula.functionList.ROUNDDOWN.abstract",functionParameter:[{name:"formula.functionList.ROUNDDOWN.functionParameter.number1.name",detail:"formula.functionList.ROUNDDOWN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ROUNDDOWN.functionParameter.number2.name",detail:"formula.functionList.ROUNDDOWN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.ROUNDUP,functionType:A.Math,description:"formula.functionList.ROUNDUP.description",abstract:"formula.functionList.ROUNDUP.abstract",functionParameter:[{name:"formula.functionList.ROUNDUP.functionParameter.number1.name",detail:"formula.functionList.ROUNDUP.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ROUNDUP.functionParameter.number2.name",detail:"formula.functionList.ROUNDUP.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SEC,functionType:A.Math,description:"formula.functionList.SEC.description",abstract:"formula.functionList.SEC.abstract",functionParameter:[{name:"formula.functionList.SEC.functionParameter.number1.name",detail:"formula.functionList.SEC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SEC.functionParameter.number2.name",detail:"formula.functionList.SEC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SECH,functionType:A.Math,description:"formula.functionList.SECH.description",abstract:"formula.functionList.SECH.abstract",functionParameter:[{name:"formula.functionList.SECH.functionParameter.number1.name",detail:"formula.functionList.SECH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SECH.functionParameter.number2.name",detail:"formula.functionList.SECH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SERIESSUM,functionType:A.Math,description:"formula.functionList.SERIESSUM.description",abstract:"formula.functionList.SERIESSUM.abstract",functionParameter:[{name:"formula.functionList.SERIESSUM.functionParameter.number1.name",detail:"formula.functionList.SERIESSUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SERIESSUM.functionParameter.number2.name",detail:"formula.functionList.SERIESSUM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SEQUENCE,functionType:A.Math,description:"formula.functionList.SEQUENCE.description",abstract:"formula.functionList.SEQUENCE.abstract",functionParameter:[{name:"formula.functionList.SEQUENCE.functionParameter.number1.name",detail:"formula.functionList.SEQUENCE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SEQUENCE.functionParameter.number2.name",detail:"formula.functionList.SEQUENCE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SIGN,functionType:A.Math,description:"formula.functionList.SIGN.description",abstract:"formula.functionList.SIGN.abstract",functionParameter:[{name:"formula.functionList.SIGN.functionParameter.number1.name",detail:"formula.functionList.SIGN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SIGN.functionParameter.number2.name",detail:"formula.functionList.SIGN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SIN,functionType:A.Math,description:"formula.functionList.SIN.description",abstract:"formula.functionList.SIN.abstract",functionParameter:[{name:"formula.functionList.SIN.functionParameter.number1.name",detail:"formula.functionList.SIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SIN.functionParameter.number2.name",detail:"formula.functionList.SIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SINH,functionType:A.Math,description:"formula.functionList.SINH.description",abstract:"formula.functionList.SINH.abstract",functionParameter:[{name:"formula.functionList.SINH.functionParameter.number1.name",detail:"formula.functionList.SINH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SINH.functionParameter.number2.name",detail:"formula.functionList.SINH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SQRT,functionType:A.Math,description:"formula.functionList.SQRT.description",abstract:"formula.functionList.SQRT.abstract",functionParameter:[{name:"formula.functionList.SQRT.functionParameter.number1.name",detail:"formula.functionList.SQRT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SQRT.functionParameter.number2.name",detail:"formula.functionList.SQRT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SQRTPI,functionType:A.Math,description:"formula.functionList.SQRTPI.description",abstract:"formula.functionList.SQRTPI.abstract",functionParameter:[{name:"formula.functionList.SQRTPI.functionParameter.number1.name",detail:"formula.functionList.SQRTPI.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SQRTPI.functionParameter.number2.name",detail:"formula.functionList.SQRTPI.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SUBTOTAL,functionType:A.Math,description:"formula.functionList.SUBTOTAL.description",abstract:"formula.functionList.SUBTOTAL.abstract",functionParameter:[{name:"formula.functionList.SUBTOTAL.functionParameter.number1.name",detail:"formula.functionList.SUBTOTAL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUBTOTAL.functionParameter.number2.name",detail:"formula.functionList.SUBTOTAL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SUM,aliasFunctionName:"formula.functionList.SUM.aliasFunctionName",functionType:A.Math,description:"formula.functionList.SUM.description",abstract:"formula.functionList.SUM.abstract",functionParameter:[{name:"formula.functionList.SUM.functionParameter.number1.name",detail:"formula.functionList.SUM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUM.functionParameter.number2.name",detail:"formula.functionList.SUM.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:gt.SUMIF,aliasFunctionName:"formula.functionList.SUMIF.aliasFunctionName",functionType:A.Math,description:"formula.functionList.SUMIF.description",abstract:"formula.functionList.SUMIF.abstract",functionParameter:[{name:"formula.functionList.SUMIF.functionParameter.range.name",detail:"formula.functionList.SUMIF.functionParameter.range.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMIF.functionParameter.criteria.name",detail:"formula.functionList.SUMIF.functionParameter.criteria.detail",example:">5",require:1,repeat:0},{name:"formula.functionList.SUMIF.functionParameter.sumRange.name",detail:"formula.functionList.SUMIF.functionParameter.sumRange.detail",example:"B1:B20",require:0,repeat:0}]},{functionName:gt.SUMIFS,functionType:A.Math,description:"formula.functionList.SUMIFS.description",abstract:"formula.functionList.SUMIFS.abstract",functionParameter:[{name:"formula.functionList.SUMIFS.functionParameter.sumRange.name",detail:"formula.functionList.SUMIFS.functionParameter.sumRange.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMIFS.functionParameter.criteriaRange1.name",detail:"formula.functionList.SUMIFS.functionParameter.criteriaRange1.detail",example:"B1:B20",require:1,repeat:0},{name:"formula.functionList.SUMIFS.functionParameter.criteria1.name",detail:"formula.functionList.SUMIFS.functionParameter.criteria1.detail",example:">10",require:1,repeat:0},{name:"formula.functionList.SUMIFS.functionParameter.criteriaRange2.name",detail:"formula.functionList.SUMIFS.functionParameter.criteriaRange2.detail",example:"C1:C20",require:0,repeat:1},{name:"formula.functionList.SUMIFS.functionParameter.criteria2.name",detail:"formula.functionList.SUMIFS.functionParameter.criteria2.detail",example:"<100",require:0,repeat:1}]},{functionName:gt.SUMPRODUCT,functionType:A.Math,description:"formula.functionList.SUMPRODUCT.description",abstract:"formula.functionList.SUMPRODUCT.abstract",functionParameter:[{name:"formula.functionList.SUMPRODUCT.functionParameter.number1.name",detail:"formula.functionList.SUMPRODUCT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMPRODUCT.functionParameter.number2.name",detail:"formula.functionList.SUMPRODUCT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SUMSQ,functionType:A.Math,description:"formula.functionList.SUMSQ.description",abstract:"formula.functionList.SUMSQ.abstract",functionParameter:[{name:"formula.functionList.SUMSQ.functionParameter.number1.name",detail:"formula.functionList.SUMSQ.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMSQ.functionParameter.number2.name",detail:"formula.functionList.SUMSQ.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SUMX2MY2,functionType:A.Math,description:"formula.functionList.SUMX2MY2.description",abstract:"formula.functionList.SUMX2MY2.abstract",functionParameter:[{name:"formula.functionList.SUMX2MY2.functionParameter.number1.name",detail:"formula.functionList.SUMX2MY2.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMX2MY2.functionParameter.number2.name",detail:"formula.functionList.SUMX2MY2.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SUMX2PY2,functionType:A.Math,description:"formula.functionList.SUMX2PY2.description",abstract:"formula.functionList.SUMX2PY2.abstract",functionParameter:[{name:"formula.functionList.SUMX2PY2.functionParameter.number1.name",detail:"formula.functionList.SUMX2PY2.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMX2PY2.functionParameter.number2.name",detail:"formula.functionList.SUMX2PY2.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.SUMXMY2,functionType:A.Math,description:"formula.functionList.SUMXMY2.description",abstract:"formula.functionList.SUMXMY2.abstract",functionParameter:[{name:"formula.functionList.SUMXMY2.functionParameter.number1.name",detail:"formula.functionList.SUMXMY2.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUMXMY2.functionParameter.number2.name",detail:"formula.functionList.SUMXMY2.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.TAN,functionType:A.Math,description:"formula.functionList.TAN.description",abstract:"formula.functionList.TAN.abstract",functionParameter:[{name:"formula.functionList.TAN.functionParameter.number1.name",detail:"formula.functionList.TAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TAN.functionParameter.number2.name",detail:"formula.functionList.TAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.TANH,functionType:A.Math,description:"formula.functionList.TANH.description",abstract:"formula.functionList.TANH.abstract",functionParameter:[{name:"formula.functionList.TANH.functionParameter.number1.name",detail:"formula.functionList.TANH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TANH.functionParameter.number2.name",detail:"formula.functionList.TANH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:gt.TRUNC,functionType:A.Math,description:"formula.functionList.TRUNC.description",abstract:"formula.functionList.TRUNC.abstract",functionParameter:[{name:"formula.functionList.TRUNC.functionParameter.number1.name",detail:"formula.functionList.TRUNC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TRUNC.functionParameter.number2.name",detail:"formula.functionList.TRUNC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],uWe=[{functionName:Oe.AVEDEV,functionType:A.Statistical,description:"formula.functionList.AVEDEV.description",abstract:"formula.functionList.AVEDEV.abstract",functionParameter:[{name:"formula.functionList.AVEDEV.functionParameter.number1.name",detail:"formula.functionList.AVEDEV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVEDEV.functionParameter.number2.name",detail:"formula.functionList.AVEDEV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.AVERAGE,aliasFunctionName:"formula.functionList.AVERAGE.aliasFunctionName",functionType:A.Statistical,description:"formula.functionList.AVERAGE.description",abstract:"formula.functionList.AVERAGE.abstract",functionParameter:[{name:"formula.functionList.AVERAGE.functionParameter.number1.name",detail:"formula.functionList.AVERAGE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGE.functionParameter.number2.name",detail:"formula.functionList.AVERAGE.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Oe.AVERAGEA,functionType:A.Statistical,description:"formula.functionList.AVERAGEA.description",abstract:"formula.functionList.AVERAGEA.abstract",functionParameter:[{name:"formula.functionList.AVERAGEA.functionParameter.number1.name",detail:"formula.functionList.AVERAGEA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGEA.functionParameter.number2.name",detail:"formula.functionList.AVERAGEA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.AVERAGEIF,functionType:A.Statistical,description:"formula.functionList.AVERAGEIF.description",abstract:"formula.functionList.AVERAGEIF.abstract",functionParameter:[{name:"formula.functionList.AVERAGEIF.functionParameter.number1.name",detail:"formula.functionList.AVERAGEIF.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGEIF.functionParameter.number2.name",detail:"formula.functionList.AVERAGEIF.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.AVERAGEIFS,functionType:A.Statistical,description:"formula.functionList.AVERAGEIFS.description",abstract:"formula.functionList.AVERAGEIFS.abstract",functionParameter:[{name:"formula.functionList.AVERAGEIFS.functionParameter.number1.name",detail:"formula.functionList.AVERAGEIFS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.AVERAGEIFS.functionParameter.number2.name",detail:"formula.functionList.AVERAGEIFS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.BETA_DIST,functionType:A.Statistical,description:"formula.functionList.BETA_DIST.description",abstract:"formula.functionList.BETA_DIST.abstract",functionParameter:[{name:"formula.functionList.BETA_DIST.functionParameter.number1.name",detail:"formula.functionList.BETA_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BETA_DIST.functionParameter.number2.name",detail:"formula.functionList.BETA_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.BETA_INV,functionType:A.Statistical,description:"formula.functionList.BETA_INV.description",abstract:"formula.functionList.BETA_INV.abstract",functionParameter:[{name:"formula.functionList.BETA_INV.functionParameter.number1.name",detail:"formula.functionList.BETA_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BETA_INV.functionParameter.number2.name",detail:"formula.functionList.BETA_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.BINOM_DIST,functionType:A.Statistical,description:"formula.functionList.BINOM_DIST.description",abstract:"formula.functionList.BINOM_DIST.abstract",functionParameter:[{name:"formula.functionList.BINOM_DIST.functionParameter.number1.name",detail:"formula.functionList.BINOM_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST.functionParameter.number2.name",detail:"formula.functionList.BINOM_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.BINOM_DIST_RANGE,functionType:A.Statistical,description:"formula.functionList.BINOM_DIST_RANGE.description",abstract:"formula.functionList.BINOM_DIST_RANGE.abstract",functionParameter:[{name:"formula.functionList.BINOM_DIST_RANGE.functionParameter.number1.name",detail:"formula.functionList.BINOM_DIST_RANGE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BINOM_DIST_RANGE.functionParameter.number2.name",detail:"formula.functionList.BINOM_DIST_RANGE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.BINOM_INV,functionType:A.Statistical,description:"formula.functionList.BINOM_INV.description",abstract:"formula.functionList.BINOM_INV.abstract",functionParameter:[{name:"formula.functionList.BINOM_INV.functionParameter.number1.name",detail:"formula.functionList.BINOM_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BINOM_INV.functionParameter.number2.name",detail:"formula.functionList.BINOM_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CHISQ_DIST,functionType:A.Statistical,description:"formula.functionList.CHISQ_DIST.description",abstract:"formula.functionList.CHISQ_DIST.abstract",functionParameter:[{name:"formula.functionList.CHISQ_DIST.functionParameter.number1.name",detail:"formula.functionList.CHISQ_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHISQ_DIST.functionParameter.number2.name",detail:"formula.functionList.CHISQ_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CHISQ_DIST_RT,functionType:A.Statistical,description:"formula.functionList.CHISQ_DIST_RT.description",abstract:"formula.functionList.CHISQ_DIST_RT.abstract",functionParameter:[{name:"formula.functionList.CHISQ_DIST_RT.functionParameter.number1.name",detail:"formula.functionList.CHISQ_DIST_RT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHISQ_DIST_RT.functionParameter.number2.name",detail:"formula.functionList.CHISQ_DIST_RT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CHISQ_INV,functionType:A.Statistical,description:"formula.functionList.CHISQ_INV.description",abstract:"formula.functionList.CHISQ_INV.abstract",functionParameter:[{name:"formula.functionList.CHISQ_INV.functionParameter.number1.name",detail:"formula.functionList.CHISQ_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHISQ_INV.functionParameter.number2.name",detail:"formula.functionList.CHISQ_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CHISQ_INV_RT,functionType:A.Statistical,description:"formula.functionList.CHISQ_INV_RT.description",abstract:"formula.functionList.CHISQ_INV_RT.abstract",functionParameter:[{name:"formula.functionList.CHISQ_INV_RT.functionParameter.number1.name",detail:"formula.functionList.CHISQ_INV_RT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHISQ_INV_RT.functionParameter.number2.name",detail:"formula.functionList.CHISQ_INV_RT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CHISQ_TEST,functionType:A.Statistical,description:"formula.functionList.CHISQ_TEST.description",abstract:"formula.functionList.CHISQ_TEST.abstract",functionParameter:[{name:"formula.functionList.CHISQ_TEST.functionParameter.number1.name",detail:"formula.functionList.CHISQ_TEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHISQ_TEST.functionParameter.number2.name",detail:"formula.functionList.CHISQ_TEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CONFIDENCE_NORM,functionType:A.Statistical,description:"formula.functionList.CONFIDENCE_NORM.description",abstract:"formula.functionList.CONFIDENCE_NORM.abstract",functionParameter:[{name:"formula.functionList.CONFIDENCE_NORM.functionParameter.number1.name",detail:"formula.functionList.CONFIDENCE_NORM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE_NORM.functionParameter.number2.name",detail:"formula.functionList.CONFIDENCE_NORM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CONFIDENCE_T,functionType:A.Statistical,description:"formula.functionList.CONFIDENCE_T.description",abstract:"formula.functionList.CONFIDENCE_T.abstract",functionParameter:[{name:"formula.functionList.CONFIDENCE_T.functionParameter.number1.name",detail:"formula.functionList.CONFIDENCE_T.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CONFIDENCE_T.functionParameter.number2.name",detail:"formula.functionList.CONFIDENCE_T.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.CORREL,functionType:A.Statistical,description:"formula.functionList.CORREL.description",abstract:"formula.functionList.CORREL.abstract",functionParameter:[{name:"formula.functionList.CORREL.functionParameter.number1.name",detail:"formula.functionList.CORREL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CORREL.functionParameter.number2.name",detail:"formula.functionList.CORREL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.COUNT,aliasFunctionName:"formula.functionList.COUNT.aliasFunctionName",functionType:A.Statistical,description:"formula.functionList.COUNT.description",abstract:"formula.functionList.COUNT.abstract",functionParameter:[{name:"formula.functionList.COUNT.functionParameter.value1.name",detail:"formula.functionList.COUNT.functionParameter.value1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNT.functionParameter.value2.name",detail:"formula.functionList.COUNT.functionParameter.value2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Oe.COUNTA,aliasFunctionName:"formula.functionList.COUNTA.aliasFunctionName",functionType:A.Statistical,description:"formula.functionList.COUNTA.description",abstract:"formula.functionList.COUNTA.abstract",functionParameter:[{name:"formula.functionList.COUNTA.functionParameter.number1.name",detail:"formula.functionList.COUNTA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNTA.functionParameter.number2.name",detail:"formula.functionList.COUNTA.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Oe.COUNTBLANK,functionType:A.Statistical,description:"formula.functionList.COUNTBLANK.description",abstract:"formula.functionList.COUNTBLANK.abstract",functionParameter:[{name:"formula.functionList.COUNTBLANK.functionParameter.number1.name",detail:"formula.functionList.COUNTBLANK.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNTBLANK.functionParameter.number2.name",detail:"formula.functionList.COUNTBLANK.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.COUNTIF,functionType:A.Statistical,description:"formula.functionList.COUNTIF.description",abstract:"formula.functionList.COUNTIF.abstract",functionParameter:[{name:"formula.functionList.COUNTIF.functionParameter.number1.name",detail:"formula.functionList.COUNTIF.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNTIF.functionParameter.number2.name",detail:"formula.functionList.COUNTIF.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.COUNTIFS,functionType:A.Statistical,description:"formula.functionList.COUNTIFS.description",abstract:"formula.functionList.COUNTIFS.abstract",functionParameter:[{name:"formula.functionList.COUNTIFS.functionParameter.number1.name",detail:"formula.functionList.COUNTIFS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COUNTIFS.functionParameter.number2.name",detail:"formula.functionList.COUNTIFS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.COVARIANCE_P,functionType:A.Statistical,description:"formula.functionList.COVARIANCE_P.description",abstract:"formula.functionList.COVARIANCE_P.abstract",functionParameter:[{name:"formula.functionList.COVARIANCE_P.functionParameter.number1.name",detail:"formula.functionList.COVARIANCE_P.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COVARIANCE_P.functionParameter.number2.name",detail:"formula.functionList.COVARIANCE_P.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.COVARIANCE_S,functionType:A.Statistical,description:"formula.functionList.COVARIANCE_S.description",abstract:"formula.functionList.COVARIANCE_S.abstract",functionParameter:[{name:"formula.functionList.COVARIANCE_S.functionParameter.number1.name",detail:"formula.functionList.COVARIANCE_S.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.COVARIANCE_S.functionParameter.number2.name",detail:"formula.functionList.COVARIANCE_S.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.DEVSQ,functionType:A.Statistical,description:"formula.functionList.DEVSQ.description",abstract:"formula.functionList.DEVSQ.abstract",functionParameter:[{name:"formula.functionList.DEVSQ.functionParameter.number1.name",detail:"formula.functionList.DEVSQ.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DEVSQ.functionParameter.number2.name",detail:"formula.functionList.DEVSQ.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.EXPON_DIST,functionType:A.Statistical,description:"formula.functionList.EXPON_DIST.description",abstract:"formula.functionList.EXPON_DIST.abstract",functionParameter:[{name:"formula.functionList.EXPON_DIST.functionParameter.number1.name",detail:"formula.functionList.EXPON_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EXPON_DIST.functionParameter.number2.name",detail:"formula.functionList.EXPON_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.F_DIST,functionType:A.Statistical,description:"formula.functionList.F_DIST.description",abstract:"formula.functionList.F_DIST.abstract",functionParameter:[{name:"formula.functionList.F_DIST.functionParameter.number1.name",detail:"formula.functionList.F_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.F_DIST.functionParameter.number2.name",detail:"formula.functionList.F_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.F_DIST_RT,functionType:A.Statistical,description:"formula.functionList.F_DIST_RT.description",abstract:"formula.functionList.F_DIST_RT.abstract",functionParameter:[{name:"formula.functionList.F_DIST_RT.functionParameter.number1.name",detail:"formula.functionList.F_DIST_RT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.F_DIST_RT.functionParameter.number2.name",detail:"formula.functionList.F_DIST_RT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.F_INV,functionType:A.Statistical,description:"formula.functionList.F_INV.description",abstract:"formula.functionList.F_INV.abstract",functionParameter:[{name:"formula.functionList.F_INV.functionParameter.number1.name",detail:"formula.functionList.F_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.F_INV.functionParameter.number2.name",detail:"formula.functionList.F_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.F_INV_RT,functionType:A.Statistical,description:"formula.functionList.F_INV_RT.description",abstract:"formula.functionList.F_INV_RT.abstract",functionParameter:[{name:"formula.functionList.F_INV_RT.functionParameter.number1.name",detail:"formula.functionList.F_INV_RT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.F_INV_RT.functionParameter.number2.name",detail:"formula.functionList.F_INV_RT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.F_TEST,functionType:A.Statistical,description:"formula.functionList.F_TEST.description",abstract:"formula.functionList.F_TEST.abstract",functionParameter:[{name:"formula.functionList.F_TEST.functionParameter.number1.name",detail:"formula.functionList.F_TEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.F_TEST.functionParameter.number2.name",detail:"formula.functionList.F_TEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FISHER,functionType:A.Statistical,description:"formula.functionList.FISHER.description",abstract:"formula.functionList.FISHER.abstract",functionParameter:[{name:"formula.functionList.FISHER.functionParameter.number1.name",detail:"formula.functionList.FISHER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FISHER.functionParameter.number2.name",detail:"formula.functionList.FISHER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FISHERINV,functionType:A.Statistical,description:"formula.functionList.FISHERINV.description",abstract:"formula.functionList.FISHERINV.abstract",functionParameter:[{name:"formula.functionList.FISHERINV.functionParameter.number1.name",detail:"formula.functionList.FISHERINV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FISHERINV.functionParameter.number2.name",detail:"formula.functionList.FISHERINV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FORECAST,functionType:A.Statistical,description:"formula.functionList.FORECAST.description",abstract:"formula.functionList.FORECAST.abstract",functionParameter:[{name:"formula.functionList.FORECAST.functionParameter.number1.name",detail:"formula.functionList.FORECAST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST.functionParameter.number2.name",detail:"formula.functionList.FORECAST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FORECAST_ETS,functionType:A.Statistical,description:"formula.functionList.FORECAST_ETS.description",abstract:"formula.functionList.FORECAST_ETS.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FORECAST_ETS_CONFINT,functionType:A.Statistical,description:"formula.functionList.FORECAST_ETS_CONFINT.description",abstract:"formula.functionList.FORECAST_ETS_CONFINT.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS_CONFINT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FORECAST_ETS_SEASONALITY,functionType:A.Statistical,description:"formula.functionList.FORECAST_ETS_SEASONALITY.description",abstract:"formula.functionList.FORECAST_ETS_SEASONALITY.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS_SEASONALITY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FORECAST_ETS_STAT,functionType:A.Statistical,description:"formula.functionList.FORECAST_ETS_STAT.description",abstract:"formula.functionList.FORECAST_ETS_STAT.abstract",functionParameter:[{name:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number1.name",detail:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number2.name",detail:"formula.functionList.FORECAST_ETS_STAT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FORECAST_LINEAR,functionType:A.Statistical,description:"formula.functionList.FORECAST_LINEAR.description",abstract:"formula.functionList.FORECAST_LINEAR.abstract",functionParameter:[{name:"formula.functionList.FORECAST_LINEAR.functionParameter.number1.name",detail:"formula.functionList.FORECAST_LINEAR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FORECAST_LINEAR.functionParameter.number2.name",detail:"formula.functionList.FORECAST_LINEAR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.FREQUENCY,functionType:A.Statistical,description:"formula.functionList.FREQUENCY.description",abstract:"formula.functionList.FREQUENCY.abstract",functionParameter:[{name:"formula.functionList.FREQUENCY.functionParameter.number1.name",detail:"formula.functionList.FREQUENCY.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FREQUENCY.functionParameter.number2.name",detail:"formula.functionList.FREQUENCY.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GAMMA,functionType:A.Statistical,description:"formula.functionList.GAMMA.description",abstract:"formula.functionList.GAMMA.abstract",functionParameter:[{name:"formula.functionList.GAMMA.functionParameter.number1.name",detail:"formula.functionList.GAMMA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAMMA.functionParameter.number2.name",detail:"formula.functionList.GAMMA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GAMMA_DIST,functionType:A.Statistical,description:"formula.functionList.GAMMA_DIST.description",abstract:"formula.functionList.GAMMA_DIST.abstract",functionParameter:[{name:"formula.functionList.GAMMA_DIST.functionParameter.number1.name",detail:"formula.functionList.GAMMA_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAMMA_DIST.functionParameter.number2.name",detail:"formula.functionList.GAMMA_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GAMMA_INV,functionType:A.Statistical,description:"formula.functionList.GAMMA_INV.description",abstract:"formula.functionList.GAMMA_INV.abstract",functionParameter:[{name:"formula.functionList.GAMMA_INV.functionParameter.number1.name",detail:"formula.functionList.GAMMA_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAMMA_INV.functionParameter.number2.name",detail:"formula.functionList.GAMMA_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GAMMALN,functionType:A.Statistical,description:"formula.functionList.GAMMALN.description",abstract:"formula.functionList.GAMMALN.abstract",functionParameter:[{name:"formula.functionList.GAMMALN.functionParameter.number1.name",detail:"formula.functionList.GAMMALN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAMMALN.functionParameter.number2.name",detail:"formula.functionList.GAMMALN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GAMMALN_PRECISE,functionType:A.Statistical,description:"formula.functionList.GAMMALN_PRECISE.description",abstract:"formula.functionList.GAMMALN_PRECISE.abstract",functionParameter:[{name:"formula.functionList.GAMMALN_PRECISE.functionParameter.number1.name",detail:"formula.functionList.GAMMALN_PRECISE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAMMALN_PRECISE.functionParameter.number2.name",detail:"formula.functionList.GAMMALN_PRECISE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GAUSS,functionType:A.Statistical,description:"formula.functionList.GAUSS.description",abstract:"formula.functionList.GAUSS.abstract",functionParameter:[{name:"formula.functionList.GAUSS.functionParameter.number1.name",detail:"formula.functionList.GAUSS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GAUSS.functionParameter.number2.name",detail:"formula.functionList.GAUSS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GEOMEAN,functionType:A.Statistical,description:"formula.functionList.GEOMEAN.description",abstract:"formula.functionList.GEOMEAN.abstract",functionParameter:[{name:"formula.functionList.GEOMEAN.functionParameter.number1.name",detail:"formula.functionList.GEOMEAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GEOMEAN.functionParameter.number2.name",detail:"formula.functionList.GEOMEAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.GROWTH,functionType:A.Statistical,description:"formula.functionList.GROWTH.description",abstract:"formula.functionList.GROWTH.abstract",functionParameter:[{name:"formula.functionList.GROWTH.functionParameter.number1.name",detail:"formula.functionList.GROWTH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.GROWTH.functionParameter.number2.name",detail:"formula.functionList.GROWTH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.HARMEAN,functionType:A.Statistical,description:"formula.functionList.HARMEAN.description",abstract:"formula.functionList.HARMEAN.abstract",functionParameter:[{name:"formula.functionList.HARMEAN.functionParameter.number1.name",detail:"formula.functionList.HARMEAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HARMEAN.functionParameter.number2.name",detail:"formula.functionList.HARMEAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.HYPGEOM_DIST,functionType:A.Statistical,description:"formula.functionList.HYPGEOM_DIST.description",abstract:"formula.functionList.HYPGEOM_DIST.abstract",functionParameter:[{name:"formula.functionList.HYPGEOM_DIST.functionParameter.number1.name",detail:"formula.functionList.HYPGEOM_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.HYPGEOM_DIST.functionParameter.number2.name",detail:"formula.functionList.HYPGEOM_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.INTERCEPT,functionType:A.Statistical,description:"formula.functionList.INTERCEPT.description",abstract:"formula.functionList.INTERCEPT.abstract",functionParameter:[{name:"formula.functionList.INTERCEPT.functionParameter.number1.name",detail:"formula.functionList.INTERCEPT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.INTERCEPT.functionParameter.number2.name",detail:"formula.functionList.INTERCEPT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.KURT,functionType:A.Statistical,description:"formula.functionList.KURT.description",abstract:"formula.functionList.KURT.abstract",functionParameter:[{name:"formula.functionList.KURT.functionParameter.number1.name",detail:"formula.functionList.KURT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.KURT.functionParameter.number2.name",detail:"formula.functionList.KURT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.LARGE,functionType:A.Statistical,description:"formula.functionList.LARGE.description",abstract:"formula.functionList.LARGE.abstract",functionParameter:[{name:"formula.functionList.LARGE.functionParameter.number1.name",detail:"formula.functionList.LARGE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LARGE.functionParameter.number2.name",detail:"formula.functionList.LARGE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.LINEST,functionType:A.Statistical,description:"formula.functionList.LINEST.description",abstract:"formula.functionList.LINEST.abstract",functionParameter:[{name:"formula.functionList.LINEST.functionParameter.number1.name",detail:"formula.functionList.LINEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LINEST.functionParameter.number2.name",detail:"formula.functionList.LINEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.LOGEST,functionType:A.Statistical,description:"formula.functionList.LOGEST.description",abstract:"formula.functionList.LOGEST.abstract",functionParameter:[{name:"formula.functionList.LOGEST.functionParameter.number1.name",detail:"formula.functionList.LOGEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOGEST.functionParameter.number2.name",detail:"formula.functionList.LOGEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.LOGNORM_DIST,functionType:A.Statistical,description:"formula.functionList.LOGNORM_DIST.description",abstract:"formula.functionList.LOGNORM_DIST.abstract",functionParameter:[{name:"formula.functionList.LOGNORM_DIST.functionParameter.number1.name",detail:"formula.functionList.LOGNORM_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOGNORM_DIST.functionParameter.number2.name",detail:"formula.functionList.LOGNORM_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.LOGNORM_INV,functionType:A.Statistical,description:"formula.functionList.LOGNORM_INV.description",abstract:"formula.functionList.LOGNORM_INV.abstract",functionParameter:[{name:"formula.functionList.LOGNORM_INV.functionParameter.number1.name",detail:"formula.functionList.LOGNORM_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOGNORM_INV.functionParameter.number2.name",detail:"formula.functionList.LOGNORM_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.MAX,aliasFunctionName:"formula.functionList.MAX.aliasFunctionName",functionType:A.Statistical,description:"formula.functionList.MAX.description",abstract:"formula.functionList.MAX.abstract",functionParameter:[{name:"formula.functionList.MAX.functionParameter.number1.name",detail:"formula.functionList.MAX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAX.functionParameter.number2.name",detail:"formula.functionList.MAX.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Oe.MAXA,functionType:A.Statistical,description:"formula.functionList.MAXA.description",abstract:"formula.functionList.MAXA.abstract",functionParameter:[{name:"formula.functionList.MAXA.functionParameter.number1.name",detail:"formula.functionList.MAXA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAXA.functionParameter.number2.name",detail:"formula.functionList.MAXA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.MAXIFS,functionType:A.Statistical,description:"formula.functionList.MAXIFS.description",abstract:"formula.functionList.MAXIFS.abstract",functionParameter:[{name:"formula.functionList.MAXIFS.functionParameter.number1.name",detail:"formula.functionList.MAXIFS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MAXIFS.functionParameter.number2.name",detail:"formula.functionList.MAXIFS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.MEDIAN,functionType:A.Statistical,description:"formula.functionList.MEDIAN.description",abstract:"formula.functionList.MEDIAN.abstract",functionParameter:[{name:"formula.functionList.MEDIAN.functionParameter.number1.name",detail:"formula.functionList.MEDIAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MEDIAN.functionParameter.number2.name",detail:"formula.functionList.MEDIAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.MIN,aliasFunctionName:"formula.functionList.MIN.aliasFunctionName",functionType:A.Statistical,description:"formula.functionList.MIN.description",abstract:"formula.functionList.MIN.abstract",functionParameter:[{name:"formula.functionList.MIN.functionParameter.number1.name",detail:"formula.functionList.MIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MIN.functionParameter.number2.name",detail:"formula.functionList.MIN.functionParameter.number2.detail",example:"B2:B10",require:0,repeat:1}]},{functionName:Oe.MINA,functionType:A.Statistical,description:"formula.functionList.MINA.description",abstract:"formula.functionList.MINA.abstract",functionParameter:[{name:"formula.functionList.MINA.functionParameter.number1.name",detail:"formula.functionList.MINA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MINA.functionParameter.number2.name",detail:"formula.functionList.MINA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.MINIFS,functionType:A.Statistical,description:"formula.functionList.MINIFS.description",abstract:"formula.functionList.MINIFS.abstract",functionParameter:[{name:"formula.functionList.MINIFS.functionParameter.number1.name",detail:"formula.functionList.MINIFS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MINIFS.functionParameter.number2.name",detail:"formula.functionList.MINIFS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.MODE_MULT,functionType:A.Statistical,description:"formula.functionList.MODE_MULT.description",abstract:"formula.functionList.MODE_MULT.abstract",functionParameter:[{name:"formula.functionList.MODE_MULT.functionParameter.number1.name",detail:"formula.functionList.MODE_MULT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MODE_MULT.functionParameter.number2.name",detail:"formula.functionList.MODE_MULT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.MODE_SNGL,functionType:A.Statistical,description:"formula.functionList.MODE_SNGL.description",abstract:"formula.functionList.MODE_SNGL.abstract",functionParameter:[{name:"formula.functionList.MODE_SNGL.functionParameter.number1.name",detail:"formula.functionList.MODE_SNGL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MODE_SNGL.functionParameter.number2.name",detail:"formula.functionList.MODE_SNGL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.NEGBINOM_DIST,functionType:A.Statistical,description:"formula.functionList.NEGBINOM_DIST.description",abstract:"formula.functionList.NEGBINOM_DIST.abstract",functionParameter:[{name:"formula.functionList.NEGBINOM_DIST.functionParameter.number1.name",detail:"formula.functionList.NEGBINOM_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NEGBINOM_DIST.functionParameter.number2.name",detail:"formula.functionList.NEGBINOM_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.NORM_DIST,functionType:A.Statistical,description:"formula.functionList.NORM_DIST.description",abstract:"formula.functionList.NORM_DIST.abstract",functionParameter:[{name:"formula.functionList.NORM_DIST.functionParameter.number1.name",detail:"formula.functionList.NORM_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORM_DIST.functionParameter.number2.name",detail:"formula.functionList.NORM_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.NORM_INV,functionType:A.Statistical,description:"formula.functionList.NORM_INV.description",abstract:"formula.functionList.NORM_INV.abstract",functionParameter:[{name:"formula.functionList.NORM_INV.functionParameter.number1.name",detail:"formula.functionList.NORM_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORM_INV.functionParameter.number2.name",detail:"formula.functionList.NORM_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.NORM_S_DIST,functionType:A.Statistical,description:"formula.functionList.NORM_S_DIST.description",abstract:"formula.functionList.NORM_S_DIST.abstract",functionParameter:[{name:"formula.functionList.NORM_S_DIST.functionParameter.number1.name",detail:"formula.functionList.NORM_S_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORM_S_DIST.functionParameter.number2.name",detail:"formula.functionList.NORM_S_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.NORM_S_INV,functionType:A.Statistical,description:"formula.functionList.NORM_S_INV.description",abstract:"formula.functionList.NORM_S_INV.abstract",functionParameter:[{name:"formula.functionList.NORM_S_INV.functionParameter.number1.name",detail:"formula.functionList.NORM_S_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NORM_S_INV.functionParameter.number2.name",detail:"formula.functionList.NORM_S_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PEARSON,functionType:A.Statistical,description:"formula.functionList.PEARSON.description",abstract:"formula.functionList.PEARSON.abstract",functionParameter:[{name:"formula.functionList.PEARSON.functionParameter.number1.name",detail:"formula.functionList.PEARSON.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PEARSON.functionParameter.number2.name",detail:"formula.functionList.PEARSON.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PERCENTILE_EXC,functionType:A.Statistical,description:"formula.functionList.PERCENTILE_EXC.description",abstract:"formula.functionList.PERCENTILE_EXC.abstract",functionParameter:[{name:"formula.functionList.PERCENTILE_EXC.functionParameter.number1.name",detail:"formula.functionList.PERCENTILE_EXC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERCENTILE_EXC.functionParameter.number2.name",detail:"formula.functionList.PERCENTILE_EXC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PERCENTILE_INC,functionType:A.Statistical,description:"formula.functionList.PERCENTILE_INC.description",abstract:"formula.functionList.PERCENTILE_INC.abstract",functionParameter:[{name:"formula.functionList.PERCENTILE_INC.functionParameter.number1.name",detail:"formula.functionList.PERCENTILE_INC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERCENTILE_INC.functionParameter.number2.name",detail:"formula.functionList.PERCENTILE_INC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PERCENTRANK_EXC,functionType:A.Statistical,description:"formula.functionList.PERCENTRANK_EXC.description",abstract:"formula.functionList.PERCENTRANK_EXC.abstract",functionParameter:[{name:"formula.functionList.PERCENTRANK_EXC.functionParameter.number1.name",detail:"formula.functionList.PERCENTRANK_EXC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK_EXC.functionParameter.number2.name",detail:"formula.functionList.PERCENTRANK_EXC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PERCENTRANK_INC,functionType:A.Statistical,description:"formula.functionList.PERCENTRANK_INC.description",abstract:"formula.functionList.PERCENTRANK_INC.abstract",functionParameter:[{name:"formula.functionList.PERCENTRANK_INC.functionParameter.number1.name",detail:"formula.functionList.PERCENTRANK_INC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERCENTRANK_INC.functionParameter.number2.name",detail:"formula.functionList.PERCENTRANK_INC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PERMUT,functionType:A.Statistical,description:"formula.functionList.PERMUT.description",abstract:"formula.functionList.PERMUT.abstract",functionParameter:[{name:"formula.functionList.PERMUT.functionParameter.number1.name",detail:"formula.functionList.PERMUT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERMUT.functionParameter.number2.name",detail:"formula.functionList.PERMUT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PERMUTATIONA,functionType:A.Statistical,description:"formula.functionList.PERMUTATIONA.description",abstract:"formula.functionList.PERMUTATIONA.abstract",functionParameter:[{name:"formula.functionList.PERMUTATIONA.functionParameter.number1.name",detail:"formula.functionList.PERMUTATIONA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PERMUTATIONA.functionParameter.number2.name",detail:"formula.functionList.PERMUTATIONA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PHI,functionType:A.Statistical,description:"formula.functionList.PHI.description",abstract:"formula.functionList.PHI.abstract",functionParameter:[{name:"formula.functionList.PHI.functionParameter.number1.name",detail:"formula.functionList.PHI.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PHI.functionParameter.number2.name",detail:"formula.functionList.PHI.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.POISSON_DIST,functionType:A.Statistical,description:"formula.functionList.POISSON_DIST.description",abstract:"formula.functionList.POISSON_DIST.abstract",functionParameter:[{name:"formula.functionList.POISSON_DIST.functionParameter.number1.name",detail:"formula.functionList.POISSON_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.POISSON_DIST.functionParameter.number2.name",detail:"formula.functionList.POISSON_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.PROB,functionType:A.Statistical,description:"formula.functionList.PROB.description",abstract:"formula.functionList.PROB.abstract",functionParameter:[{name:"formula.functionList.PROB.functionParameter.number1.name",detail:"formula.functionList.PROB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PROB.functionParameter.number2.name",detail:"formula.functionList.PROB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.QUARTILE_EXC,functionType:A.Statistical,description:"formula.functionList.QUARTILE_EXC.description",abstract:"formula.functionList.QUARTILE_EXC.abstract",functionParameter:[{name:"formula.functionList.QUARTILE_EXC.functionParameter.number1.name",detail:"formula.functionList.QUARTILE_EXC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.QUARTILE_EXC.functionParameter.number2.name",detail:"formula.functionList.QUARTILE_EXC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.QUARTILE_INC,functionType:A.Statistical,description:"formula.functionList.QUARTILE_INC.description",abstract:"formula.functionList.QUARTILE_INC.abstract",functionParameter:[{name:"formula.functionList.QUARTILE_INC.functionParameter.number1.name",detail:"formula.functionList.QUARTILE_INC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.QUARTILE_INC.functionParameter.number2.name",detail:"formula.functionList.QUARTILE_INC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.RANK_AVG,functionType:A.Statistical,description:"formula.functionList.RANK_AVG.description",abstract:"formula.functionList.RANK_AVG.abstract",functionParameter:[{name:"formula.functionList.RANK_AVG.functionParameter.number1.name",detail:"formula.functionList.RANK_AVG.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RANK_AVG.functionParameter.number2.name",detail:"formula.functionList.RANK_AVG.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.RANK_EQ,functionType:A.Statistical,description:"formula.functionList.RANK_EQ.description",abstract:"formula.functionList.RANK_EQ.abstract",functionParameter:[{name:"formula.functionList.RANK_EQ.functionParameter.number1.name",detail:"formula.functionList.RANK_EQ.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RANK_EQ.functionParameter.number2.name",detail:"formula.functionList.RANK_EQ.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.RSQ,functionType:A.Statistical,description:"formula.functionList.RSQ.description",abstract:"formula.functionList.RSQ.abstract",functionParameter:[{name:"formula.functionList.RSQ.functionParameter.number1.name",detail:"formula.functionList.RSQ.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RSQ.functionParameter.number2.name",detail:"formula.functionList.RSQ.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.SKEW,functionType:A.Statistical,description:"formula.functionList.SKEW.description",abstract:"formula.functionList.SKEW.abstract",functionParameter:[{name:"formula.functionList.SKEW.functionParameter.number1.name",detail:"formula.functionList.SKEW.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SKEW.functionParameter.number2.name",detail:"formula.functionList.SKEW.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.SKEW_P,functionType:A.Statistical,description:"formula.functionList.SKEW_P.description",abstract:"formula.functionList.SKEW_P.abstract",functionParameter:[{name:"formula.functionList.SKEW_P.functionParameter.number1.name",detail:"formula.functionList.SKEW_P.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SKEW_P.functionParameter.number2.name",detail:"formula.functionList.SKEW_P.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.SLOPE,functionType:A.Statistical,description:"formula.functionList.SLOPE.description",abstract:"formula.functionList.SLOPE.abstract",functionParameter:[{name:"formula.functionList.SLOPE.functionParameter.number1.name",detail:"formula.functionList.SLOPE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SLOPE.functionParameter.number2.name",detail:"formula.functionList.SLOPE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.SMALL,functionType:A.Statistical,description:"formula.functionList.SMALL.description",abstract:"formula.functionList.SMALL.abstract",functionParameter:[{name:"formula.functionList.SMALL.functionParameter.number1.name",detail:"formula.functionList.SMALL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SMALL.functionParameter.number2.name",detail:"formula.functionList.SMALL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.STANDARDIZE,functionType:A.Statistical,description:"formula.functionList.STANDARDIZE.description",abstract:"formula.functionList.STANDARDIZE.abstract",functionParameter:[{name:"formula.functionList.STANDARDIZE.functionParameter.number1.name",detail:"formula.functionList.STANDARDIZE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STANDARDIZE.functionParameter.number2.name",detail:"formula.functionList.STANDARDIZE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.STDEV_P,functionType:A.Statistical,description:"formula.functionList.STDEV_P.description",abstract:"formula.functionList.STDEV_P.abstract",functionParameter:[{name:"formula.functionList.STDEV_P.functionParameter.number1.name",detail:"formula.functionList.STDEV_P.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STDEV_P.functionParameter.number2.name",detail:"formula.functionList.STDEV_P.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.STDEV_S,functionType:A.Statistical,description:"formula.functionList.STDEV_S.description",abstract:"formula.functionList.STDEV_S.abstract",functionParameter:[{name:"formula.functionList.STDEV_S.functionParameter.number1.name",detail:"formula.functionList.STDEV_S.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STDEV_S.functionParameter.number2.name",detail:"formula.functionList.STDEV_S.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.STDEVA,functionType:A.Statistical,description:"formula.functionList.STDEVA.description",abstract:"formula.functionList.STDEVA.abstract",functionParameter:[{name:"formula.functionList.STDEVA.functionParameter.number1.name",detail:"formula.functionList.STDEVA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STDEVA.functionParameter.number2.name",detail:"formula.functionList.STDEVA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.STDEVPA,functionType:A.Statistical,description:"formula.functionList.STDEVPA.description",abstract:"formula.functionList.STDEVPA.abstract",functionParameter:[{name:"formula.functionList.STDEVPA.functionParameter.number1.name",detail:"formula.functionList.STDEVPA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STDEVPA.functionParameter.number2.name",detail:"formula.functionList.STDEVPA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.STEYX,functionType:A.Statistical,description:"formula.functionList.STEYX.description",abstract:"formula.functionList.STEYX.abstract",functionParameter:[{name:"formula.functionList.STEYX.functionParameter.number1.name",detail:"formula.functionList.STEYX.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.STEYX.functionParameter.number2.name",detail:"formula.functionList.STEYX.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.T_DIST,functionType:A.Statistical,description:"formula.functionList.T_DIST.description",abstract:"formula.functionList.T_DIST.abstract",functionParameter:[{name:"formula.functionList.T_DIST.functionParameter.number1.name",detail:"formula.functionList.T_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.T_DIST.functionParameter.number2.name",detail:"formula.functionList.T_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.T_DIST_2T,functionType:A.Statistical,description:"formula.functionList.T_DIST_2T.description",abstract:"formula.functionList.T_DIST_2T.abstract",functionParameter:[{name:"formula.functionList.T_DIST_2T.functionParameter.number1.name",detail:"formula.functionList.T_DIST_2T.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.T_DIST_2T.functionParameter.number2.name",detail:"formula.functionList.T_DIST_2T.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.T_DIST_RT,functionType:A.Statistical,description:"formula.functionList.T_DIST_RT.description",abstract:"formula.functionList.T_DIST_RT.abstract",functionParameter:[{name:"formula.functionList.T_DIST_RT.functionParameter.number1.name",detail:"formula.functionList.T_DIST_RT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.T_DIST_RT.functionParameter.number2.name",detail:"formula.functionList.T_DIST_RT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.T_INV,functionType:A.Statistical,description:"formula.functionList.T_INV.description",abstract:"formula.functionList.T_INV.abstract",functionParameter:[{name:"formula.functionList.T_INV.functionParameter.number1.name",detail:"formula.functionList.T_INV.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.T_INV.functionParameter.number2.name",detail:"formula.functionList.T_INV.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.T_INV_2T,functionType:A.Statistical,description:"formula.functionList.T_INV_2T.description",abstract:"formula.functionList.T_INV_2T.abstract",functionParameter:[{name:"formula.functionList.T_INV_2T.functionParameter.number1.name",detail:"formula.functionList.T_INV_2T.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.T_INV_2T.functionParameter.number2.name",detail:"formula.functionList.T_INV_2T.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.T_TEST,functionType:A.Statistical,description:"formula.functionList.T_TEST.description",abstract:"formula.functionList.T_TEST.abstract",functionParameter:[{name:"formula.functionList.T_TEST.functionParameter.number1.name",detail:"formula.functionList.T_TEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.T_TEST.functionParameter.number2.name",detail:"formula.functionList.T_TEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.TREND,functionType:A.Statistical,description:"formula.functionList.TREND.description",abstract:"formula.functionList.TREND.abstract",functionParameter:[{name:"formula.functionList.TREND.functionParameter.number1.name",detail:"formula.functionList.TREND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TREND.functionParameter.number2.name",detail:"formula.functionList.TREND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.TRIMMEAN,functionType:A.Statistical,description:"formula.functionList.TRIMMEAN.description",abstract:"formula.functionList.TRIMMEAN.abstract",functionParameter:[{name:"formula.functionList.TRIMMEAN.functionParameter.number1.name",detail:"formula.functionList.TRIMMEAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TRIMMEAN.functionParameter.number2.name",detail:"formula.functionList.TRIMMEAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.VAR_P,functionType:A.Statistical,description:"formula.functionList.VAR_P.description",abstract:"formula.functionList.VAR_P.abstract",functionParameter:[{name:"formula.functionList.VAR_P.functionParameter.number1.name",detail:"formula.functionList.VAR_P.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VAR_P.functionParameter.number2.name",detail:"formula.functionList.VAR_P.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.VAR_S,functionType:A.Statistical,description:"formula.functionList.VAR_S.description",abstract:"formula.functionList.VAR_S.abstract",functionParameter:[{name:"formula.functionList.VAR_S.functionParameter.number1.name",detail:"formula.functionList.VAR_S.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VAR_S.functionParameter.number2.name",detail:"formula.functionList.VAR_S.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.VARA,functionType:A.Statistical,description:"formula.functionList.VARA.description",abstract:"formula.functionList.VARA.abstract",functionParameter:[{name:"formula.functionList.VARA.functionParameter.number1.name",detail:"formula.functionList.VARA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VARA.functionParameter.number2.name",detail:"formula.functionList.VARA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.VARPA,functionType:A.Statistical,description:"formula.functionList.VARPA.description",abstract:"formula.functionList.VARPA.abstract",functionParameter:[{name:"formula.functionList.VARPA.functionParameter.number1.name",detail:"formula.functionList.VARPA.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VARPA.functionParameter.number2.name",detail:"formula.functionList.VARPA.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.WEIBULL_DIST,functionType:A.Statistical,description:"formula.functionList.WEIBULL_DIST.description",abstract:"formula.functionList.WEIBULL_DIST.abstract",functionParameter:[{name:"formula.functionList.WEIBULL_DIST.functionParameter.number1.name",detail:"formula.functionList.WEIBULL_DIST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WEIBULL_DIST.functionParameter.number2.name",detail:"formula.functionList.WEIBULL_DIST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:Oe.Z_TEST,functionType:A.Statistical,description:"formula.functionList.Z_TEST.description",abstract:"formula.functionList.Z_TEST.abstract",functionParameter:[{name:"formula.functionList.Z_TEST.functionParameter.number1.name",detail:"formula.functionList.Z_TEST.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.Z_TEST.functionParameter.number2.name",detail:"formula.functionList.Z_TEST.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],lWe=[{functionName:fn.ASC,functionType:A.Text,description:"formula.functionList.ASC.description",abstract:"formula.functionList.ASC.abstract",functionParameter:[{name:"formula.functionList.ASC.functionParameter.number1.name",detail:"formula.functionList.ASC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ASC.functionParameter.number2.name",detail:"formula.functionList.ASC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.ARRAYTOTEXT,functionType:A.Text,description:"formula.functionList.ARRAYTOTEXT.description",abstract:"formula.functionList.ARRAYTOTEXT.abstract",functionParameter:[{name:"formula.functionList.ARRAYTOTEXT.functionParameter.number1.name",detail:"formula.functionList.ARRAYTOTEXT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ARRAYTOTEXT.functionParameter.number2.name",detail:"formula.functionList.ARRAYTOTEXT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.BAHTTEXT,functionType:A.Text,description:"formula.functionList.BAHTTEXT.description",abstract:"formula.functionList.BAHTTEXT.abstract",functionParameter:[{name:"formula.functionList.BAHTTEXT.functionParameter.number1.name",detail:"formula.functionList.BAHTTEXT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.BAHTTEXT.functionParameter.number2.name",detail:"formula.functionList.BAHTTEXT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.CHAR,functionType:A.Text,description:"formula.functionList.CHAR.description",abstract:"formula.functionList.CHAR.abstract",functionParameter:[{name:"formula.functionList.CHAR.functionParameter.number1.name",detail:"formula.functionList.CHAR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CHAR.functionParameter.number2.name",detail:"formula.functionList.CHAR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.CLEAN,functionType:A.Text,description:"formula.functionList.CLEAN.description",abstract:"formula.functionList.CLEAN.abstract",functionParameter:[{name:"formula.functionList.CLEAN.functionParameter.number1.name",detail:"formula.functionList.CLEAN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CLEAN.functionParameter.number2.name",detail:"formula.functionList.CLEAN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.CODE,functionType:A.Text,description:"formula.functionList.CODE.description",abstract:"formula.functionList.CODE.abstract",functionParameter:[{name:"formula.functionList.CODE.functionParameter.number1.name",detail:"formula.functionList.CODE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CODE.functionParameter.number2.name",detail:"formula.functionList.CODE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.CONCAT,functionType:A.Text,description:"formula.functionList.CONCAT.description",abstract:"formula.functionList.CONCAT.abstract",functionParameter:[{name:"formula.functionList.CONCAT.functionParameter.number1.name",detail:"formula.functionList.CONCAT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CONCAT.functionParameter.number2.name",detail:"formula.functionList.CONCAT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.CONCATENATE,functionType:A.Text,description:"formula.functionList.CONCATENATE.description",abstract:"formula.functionList.CONCATENATE.abstract",functionParameter:[{name:"formula.functionList.CONCATENATE.functionParameter.text1.name",detail:"formula.functionList.CONCATENATE.functionParameter.text1.detail",example:"A1",require:1,repeat:0},{name:"formula.functionList.CONCATENATE.functionParameter.text2.name",detail:"formula.functionList.CONCATENATE.functionParameter.text2.detail",example:"A2",require:0,repeat:1}]},{functionName:fn.DBCS,functionType:A.Text,description:"formula.functionList.DBCS.description",abstract:"formula.functionList.DBCS.abstract",functionParameter:[{name:"formula.functionList.DBCS.functionParameter.number1.name",detail:"formula.functionList.DBCS.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DBCS.functionParameter.number2.name",detail:"formula.functionList.DBCS.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.DOLLAR,functionType:A.Text,description:"formula.functionList.DOLLAR.description",abstract:"formula.functionList.DOLLAR.abstract",functionParameter:[{name:"formula.functionList.DOLLAR.functionParameter.number1.name",detail:"formula.functionList.DOLLAR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.DOLLAR.functionParameter.number2.name",detail:"formula.functionList.DOLLAR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.EXACT,functionType:A.Text,description:"formula.functionList.EXACT.description",abstract:"formula.functionList.EXACT.abstract",functionParameter:[{name:"formula.functionList.EXACT.functionParameter.number1.name",detail:"formula.functionList.EXACT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EXACT.functionParameter.number2.name",detail:"formula.functionList.EXACT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.FIND,functionType:A.Text,description:"formula.functionList.FIND.description",abstract:"formula.functionList.FIND.abstract",functionParameter:[{name:"formula.functionList.FIND.functionParameter.number1.name",detail:"formula.functionList.FIND.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FIND.functionParameter.number2.name",detail:"formula.functionList.FIND.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.FINDB,functionType:A.Text,description:"formula.functionList.FINDB.description",abstract:"formula.functionList.FINDB.abstract",functionParameter:[{name:"formula.functionList.FINDB.functionParameter.number1.name",detail:"formula.functionList.FINDB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FINDB.functionParameter.number2.name",detail:"formula.functionList.FINDB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.FIXED,functionType:A.Text,description:"formula.functionList.FIXED.description",abstract:"formula.functionList.FIXED.abstract",functionParameter:[{name:"formula.functionList.FIXED.functionParameter.number1.name",detail:"formula.functionList.FIXED.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FIXED.functionParameter.number2.name",detail:"formula.functionList.FIXED.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.LEFT,functionType:A.Text,description:"formula.functionList.LEFT.description",abstract:"formula.functionList.LEFT.abstract",functionParameter:[{name:"formula.functionList.LEFT.functionParameter.number1.name",detail:"formula.functionList.LEFT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LEFT.functionParameter.number2.name",detail:"formula.functionList.LEFT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.LEFTB,functionType:A.Text,description:"formula.functionList.LEFTB.description",abstract:"formula.functionList.LEFTB.abstract",functionParameter:[{name:"formula.functionList.LEFTB.functionParameter.number1.name",detail:"formula.functionList.LEFTB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LEFTB.functionParameter.number2.name",detail:"formula.functionList.LEFTB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.LEN,functionType:A.Text,description:"formula.functionList.LEN.description",abstract:"formula.functionList.LEN.abstract",functionParameter:[{name:"formula.functionList.LEN.functionParameter.number1.name",detail:"formula.functionList.LEN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LEN.functionParameter.number2.name",detail:"formula.functionList.LEN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.LENB,functionType:A.Text,description:"formula.functionList.LENB.description",abstract:"formula.functionList.LENB.abstract",functionParameter:[{name:"formula.functionList.LENB.functionParameter.number1.name",detail:"formula.functionList.LENB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LENB.functionParameter.number2.name",detail:"formula.functionList.LENB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.LOWER,functionType:A.Text,description:"formula.functionList.LOWER.description",abstract:"formula.functionList.LOWER.abstract",functionParameter:[{name:"formula.functionList.LOWER.functionParameter.number1.name",detail:"formula.functionList.LOWER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.LOWER.functionParameter.number2.name",detail:"formula.functionList.LOWER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.MID,functionType:A.Text,description:"formula.functionList.MID.description",abstract:"formula.functionList.MID.abstract",functionParameter:[{name:"formula.functionList.MID.functionParameter.number1.name",detail:"formula.functionList.MID.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MID.functionParameter.number2.name",detail:"formula.functionList.MID.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.MIDB,functionType:A.Text,description:"formula.functionList.MIDB.description",abstract:"formula.functionList.MIDB.abstract",functionParameter:[{name:"formula.functionList.MIDB.functionParameter.number1.name",detail:"formula.functionList.MIDB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.MIDB.functionParameter.number2.name",detail:"formula.functionList.MIDB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.NUMBERVALUE,functionType:A.Text,description:"formula.functionList.NUMBERVALUE.description",abstract:"formula.functionList.NUMBERVALUE.abstract",functionParameter:[{name:"formula.functionList.NUMBERVALUE.functionParameter.number1.name",detail:"formula.functionList.NUMBERVALUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.NUMBERVALUE.functionParameter.number2.name",detail:"formula.functionList.NUMBERVALUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.PHONETIC,functionType:A.Text,description:"formula.functionList.PHONETIC.description",abstract:"formula.functionList.PHONETIC.abstract",functionParameter:[{name:"formula.functionList.PHONETIC.functionParameter.number1.name",detail:"formula.functionList.PHONETIC.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PHONETIC.functionParameter.number2.name",detail:"formula.functionList.PHONETIC.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.PROPER,functionType:A.Text,description:"formula.functionList.PROPER.description",abstract:"formula.functionList.PROPER.abstract",functionParameter:[{name:"formula.functionList.PROPER.functionParameter.number1.name",detail:"formula.functionList.PROPER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.PROPER.functionParameter.number2.name",detail:"formula.functionList.PROPER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.REPLACE,functionType:A.Text,description:"formula.functionList.REPLACE.description",abstract:"formula.functionList.REPLACE.abstract",functionParameter:[{name:"formula.functionList.REPLACE.functionParameter.number1.name",detail:"formula.functionList.REPLACE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.REPLACE.functionParameter.number2.name",detail:"formula.functionList.REPLACE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.REPLACEB,functionType:A.Text,description:"formula.functionList.REPLACEB.description",abstract:"formula.functionList.REPLACEB.abstract",functionParameter:[{name:"formula.functionList.REPLACEB.functionParameter.number1.name",detail:"formula.functionList.REPLACEB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.REPLACEB.functionParameter.number2.name",detail:"formula.functionList.REPLACEB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.REPT,functionType:A.Text,description:"formula.functionList.REPT.description",abstract:"formula.functionList.REPT.abstract",functionParameter:[{name:"formula.functionList.REPT.functionParameter.number1.name",detail:"formula.functionList.REPT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.REPT.functionParameter.number2.name",detail:"formula.functionList.REPT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.RIGHT,functionType:A.Text,description:"formula.functionList.RIGHT.description",abstract:"formula.functionList.RIGHT.abstract",functionParameter:[{name:"formula.functionList.RIGHT.functionParameter.number1.name",detail:"formula.functionList.RIGHT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RIGHT.functionParameter.number2.name",detail:"formula.functionList.RIGHT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.RIGHTB,functionType:A.Text,description:"formula.functionList.RIGHTB.description",abstract:"formula.functionList.RIGHTB.abstract",functionParameter:[{name:"formula.functionList.RIGHTB.functionParameter.number1.name",detail:"formula.functionList.RIGHTB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.RIGHTB.functionParameter.number2.name",detail:"formula.functionList.RIGHTB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.SEARCH,functionType:A.Text,description:"formula.functionList.SEARCH.description",abstract:"formula.functionList.SEARCH.abstract",functionParameter:[{name:"formula.functionList.SEARCH.functionParameter.number1.name",detail:"formula.functionList.SEARCH.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SEARCH.functionParameter.number2.name",detail:"formula.functionList.SEARCH.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.SEARCHB,functionType:A.Text,description:"formula.functionList.SEARCHB.description",abstract:"formula.functionList.SEARCHB.abstract",functionParameter:[{name:"formula.functionList.SEARCHB.functionParameter.number1.name",detail:"formula.functionList.SEARCHB.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SEARCHB.functionParameter.number2.name",detail:"formula.functionList.SEARCHB.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.SUBSTITUTE,functionType:A.Text,description:"formula.functionList.SUBSTITUTE.description",abstract:"formula.functionList.SUBSTITUTE.abstract",functionParameter:[{name:"formula.functionList.SUBSTITUTE.functionParameter.number1.name",detail:"formula.functionList.SUBSTITUTE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.SUBSTITUTE.functionParameter.number2.name",detail:"formula.functionList.SUBSTITUTE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.T,functionType:A.Text,description:"formula.functionList.T.description",abstract:"formula.functionList.T.abstract",functionParameter:[{name:"formula.functionList.T.functionParameter.number1.name",detail:"formula.functionList.T.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.T.functionParameter.number2.name",detail:"formula.functionList.T.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.TEXT,functionType:A.Text,description:"formula.functionList.TEXT.description",abstract:"formula.functionList.TEXT.abstract",functionParameter:[{name:"formula.functionList.TEXT.functionParameter.number1.name",detail:"formula.functionList.TEXT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TEXT.functionParameter.number2.name",detail:"formula.functionList.TEXT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.TEXTAFTER,functionType:A.Text,description:"formula.functionList.TEXTAFTER.description",abstract:"formula.functionList.TEXTAFTER.abstract",functionParameter:[{name:"formula.functionList.TEXTAFTER.functionParameter.number1.name",detail:"formula.functionList.TEXTAFTER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TEXTAFTER.functionParameter.number2.name",detail:"formula.functionList.TEXTAFTER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.TEXTBEFORE,functionType:A.Text,description:"formula.functionList.TEXTBEFORE.description",abstract:"formula.functionList.TEXTBEFORE.abstract",functionParameter:[{name:"formula.functionList.TEXTBEFORE.functionParameter.number1.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TEXTBEFORE.functionParameter.number2.name",detail:"formula.functionList.TEXTBEFORE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.TEXTJOIN,functionType:A.Text,description:"formula.functionList.TEXTJOIN.description",abstract:"formula.functionList.TEXTJOIN.abstract",functionParameter:[{name:"formula.functionList.TEXTJOIN.functionParameter.number1.name",detail:"formula.functionList.TEXTJOIN.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TEXTJOIN.functionParameter.number2.name",detail:"formula.functionList.TEXTJOIN.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.TEXTSPLIT,functionType:A.Text,description:"formula.functionList.TEXTSPLIT.description",abstract:"formula.functionList.TEXTSPLIT.abstract",functionParameter:[{name:"formula.functionList.TEXTSPLIT.functionParameter.number1.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TEXTSPLIT.functionParameter.number2.name",detail:"formula.functionList.TEXTSPLIT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.TRIM,functionType:A.Text,description:"formula.functionList.TRIM.description",abstract:"formula.functionList.TRIM.abstract",functionParameter:[{name:"formula.functionList.TRIM.functionParameter.number1.name",detail:"formula.functionList.TRIM.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.TRIM.functionParameter.number2.name",detail:"formula.functionList.TRIM.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.UNICHAR,functionType:A.Text,description:"formula.functionList.UNICHAR.description",abstract:"formula.functionList.UNICHAR.abstract",functionParameter:[{name:"formula.functionList.UNICHAR.functionParameter.number1.name",detail:"formula.functionList.UNICHAR.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.UNICHAR.functionParameter.number2.name",detail:"formula.functionList.UNICHAR.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.UNICODE,functionType:A.Text,description:"formula.functionList.UNICODE.description",abstract:"formula.functionList.UNICODE.abstract",functionParameter:[{name:"formula.functionList.UNICODE.functionParameter.number1.name",detail:"formula.functionList.UNICODE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.UNICODE.functionParameter.number2.name",detail:"formula.functionList.UNICODE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.UPPER,functionType:A.Text,description:"formula.functionList.UPPER.description",abstract:"formula.functionList.UPPER.abstract",functionParameter:[{name:"formula.functionList.UPPER.functionParameter.number1.name",detail:"formula.functionList.UPPER.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.UPPER.functionParameter.number2.name",detail:"formula.functionList.UPPER.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.VALUE,functionType:A.Text,description:"formula.functionList.VALUE.description",abstract:"formula.functionList.VALUE.abstract",functionParameter:[{name:"formula.functionList.VALUE.functionParameter.number1.name",detail:"formula.functionList.VALUE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VALUE.functionParameter.number2.name",detail:"formula.functionList.VALUE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.VALUETOTEXT,functionType:A.Text,description:"formula.functionList.VALUETOTEXT.description",abstract:"formula.functionList.VALUETOTEXT.abstract",functionParameter:[{name:"formula.functionList.VALUETOTEXT.functionParameter.number1.name",detail:"formula.functionList.VALUETOTEXT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.VALUETOTEXT.functionParameter.number2.name",detail:"formula.functionList.VALUETOTEXT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.CALL,functionType:A.Text,description:"formula.functionList.CALL.description",abstract:"formula.functionList.CALL.abstract",functionParameter:[{name:"formula.functionList.CALL.functionParameter.number1.name",detail:"formula.functionList.CALL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.CALL.functionParameter.number2.name",detail:"formula.functionList.CALL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.EUROCONVERT,functionType:A.Text,description:"formula.functionList.EUROCONVERT.description",abstract:"formula.functionList.EUROCONVERT.abstract",functionParameter:[{name:"formula.functionList.EUROCONVERT.functionParameter.number1.name",detail:"formula.functionList.EUROCONVERT.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.EUROCONVERT.functionParameter.number2.name",detail:"formula.functionList.EUROCONVERT.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:fn.REGISTER_ID,functionType:A.Text,description:"formula.functionList.REGISTER_ID.description",abstract:"formula.functionList.REGISTER_ID.abstract",functionParameter:[{name:"formula.functionList.REGISTER_ID.functionParameter.number1.name",detail:"formula.functionList.REGISTER_ID.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.REGISTER_ID.functionParameter.number2.name",detail:"formula.functionList.REGISTER_ID.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],cWe=[],dWe=[{functionName:a7.ENCODEURL,functionType:A.Web,description:"formula.functionList.ENCODEURL.description",abstract:"formula.functionList.ENCODEURL.abstract",functionParameter:[{name:"formula.functionList.ENCODEURL.functionParameter.number1.name",detail:"formula.functionList.ENCODEURL.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.ENCODEURL.functionParameter.number2.name",detail:"formula.functionList.ENCODEURL.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:a7.FILTERXML,functionType:A.Web,description:"formula.functionList.FILTERXML.description",abstract:"formula.functionList.FILTERXML.abstract",functionParameter:[{name:"formula.functionList.FILTERXML.functionParameter.number1.name",detail:"formula.functionList.FILTERXML.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.FILTERXML.functionParameter.number2.name",detail:"formula.functionList.FILTERXML.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]},{functionName:a7.WEBSERVICE,functionType:A.Web,description:"formula.functionList.WEBSERVICE.description",abstract:"formula.functionList.WEBSERVICE.abstract",functionParameter:[{name:"formula.functionList.WEBSERVICE.functionParameter.number1.name",detail:"formula.functionList.WEBSERVICE.functionParameter.number1.detail",example:"A1:A20",require:1,repeat:0},{name:"formula.functionList.WEBSERVICE.functionParameter.number2.name",detail:"formula.functionList.WEBSERVICE.functionParameter.number2.detail",example:"A1:A20",require:1,repeat:0}]}],mWe=[...rWe,...tWe,...sWe,...uWe,...aWe,...eWe,...lWe,...oWe,...iWe,...nWe,...Jze,...Qze,...dWe,...Zze,...cWe];function fWe(t,e){return Object.keys(t).filter(n=>isNaN(Number(n))).map(n=>({label:e.t(`formula.functionType.${n.toLocaleLowerCase()}`),value:`${t[n]}`}))}function hWe(t,e){let n="";return t.aliasFunctionName?(n=e.t(t.aliasFunctionName),n===t.aliasFunctionName&&(n=t.functionName)):n=t.functionName,n}var pWe=Object.defineProperty,gWe=Object.getOwnPropertyDescriptor,vWe=(t,e,n,r)=>{for(var i=r>1?void 0:r?gWe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&pWe(e,n,i),i},Iw=(t,e)=>(n,r)=>e(n,r,t);const Z8=ln("formula-ui.description-service");let pC=class{constructor(t=[],e,n){Rn(this,"_descriptions",[]),this._description=t,this._functionService=e,this._localeService=n,this._initialize()}dispose(){this._localeService.localeChanged$.complete()}getDescriptions(){return this._functionService.getDescriptions()}hasFunction(t){return this._functionService.getDescriptions().get(t.toLocaleUpperCase())!==void 0}getFunctionInfo(t){return this._functionService.getDescriptions().get(t.toLocaleUpperCase())}getSearchListByName(t){const e=[],n=this._functionService.getDescriptions();return t=t.toLocaleUpperCase(),n.forEach(r=>{const{functionName:i,abstract:o}=r;i.indexOf(t)>-1&&e.push({name:i,desc:o})}),e}getSearchListByNameFirstLetter(t){const e=[],n=this._functionService.getDescriptions();return t=t.toLocaleUpperCase(),n.forEach(r=>{const{functionName:i,abstract:o}=r;i.indexOf(t)===0&&e.push({name:i,desc:o})}),e}getSearchListByType(t){const e=[];return this._functionService.getDescriptions().forEach(n=>{const{functionName:r,functionType:i,abstract:o}=n;(i===t||t===-1)&&e.push({name:r,desc:o})}),e}registerDescriptions(t){this._descriptions=this._descriptions.concat(t),this._registerDescriptions()}unregisterDescriptions(t){this._descriptions=this._descriptions.filter(e=>!t.includes(e.functionName)),this._functionService.unregisterDescriptions(...t)}_initialize(){this._localeService.localeChanged$.subscribe(()=>{this._registerDescriptions()}),this._initDescription(),this._registerDescriptions()}_initDescription(){const t=[...HB,...jB,...zB,...WB,...YB,...XB,...qB,...GB,...KB,...eU,...nU,...rU,...iU,...oU,...aU,...sU].map(n=>n[1]),e=mWe.filter(n=>t.includes(n.functionName));this._descriptions=e.concat(this._description)}_registerDescriptions(){const t=this._localeService,e=this._descriptions.map(n=>({functionName:hWe(n,t),functionType:n.functionType,description:t.t(n.description),abstract:t.t(n.abstract),functionParameter:n.functionParameter.map(r=>({name:t.t(r.name),detail:t.t(r.detail),example:r.example,require:r.require,repeat:r.repeat}))}));this._functionService.registerDescriptions(...e)}};pC=vWe([Iw(1,Bs),Iw(2,K(Gt))],pC);const bWe="univer-formula-select-function-select",_We="univer-formula-select-function-result",CWe="univer-formula-select-function-result-item",SWe="univer-formula-select-function-result-item-name-light",EWe="univer-formula-select-function-result-item-selected",yWe="univer-formula-select-function-result-item-active",DWe="univer-formula-select-function-content",P1={formulaSelectFunctionSelect:bWe,formulaSelectFunctionResult:_We,formulaSelectFunctionResultItem:CWe,formulaSelectFunctionResultItemNameLight:SWe,formulaSelectFunctionResultItemSelected:EWe,formulaSelectFunctionResultItemActive:yWe,formulaSelectFunctionContent:DWe};function RWe(t){const{onChange:e}=t,n="-1",[r,i]=_.useState(""),[o,a]=_.useState([]),[s,u]=_.useState(0),[l,c]=_.useState(n),[d,m]=_.useState(0),[f,h]=_.useState(null),p=Ct(Z8),v=Ct(Gt),g=fWe(A,v);g.unshift({label:v.t("formula.moreFunctions.allFunctions"),value:n});const b=v.t("formula.prompt.required"),C=v.t("formula.prompt.optional");_.useEffect(()=>{y(n)},[]),_.useEffect(()=>{E(0)},[o]);const S=P=>{if(r.trim()==="")return P;const N=new RegExp(`(${r.toLocaleUpperCase()})`);return P.split(N).filter(Boolean).map((B,W)=>B.match(N)?At.jsx("span",{className:P1.formulaSelectFunctionResultItemNameLight,children:B},W):B)},E=P=>{if(o.length===0){h(null);return}m(P);const N=p.getFunctionInfo(o[P].name);if(!N){h(null);return}h(N),e(N)};function y(P){c(P);const N=p.getSearchListByType(+P);a(N)}function D(P){i(P);const N=p.getSearchListByName(P);a(N)}function R(P){if(P.stopPropagation(),P.key==="ArrowDown"){const N=s+1;u(N===o.length?0:N)}else if(P.key==="ArrowUp"){const N=s-1;u(N===-1?o.length-1:N)}else P.key==="Enter"&&E(s)}const I=P=>{u(P)},T=()=>{u(-1)};return At.jsxs("div",{children:[At.jsxs("div",{className:P1.formulaSelectFunctionSelect,children:[At.jsx(K5,{value:l,options:g,onChange:y}),At.jsx(xee,{placeholder:v.t("formula.moreFunctions.searchFunctionPlaceholder"),onKeyDown:R,value:r,onChange:D,size:"large",allowClear:!0})]}),At.jsx("ul",{className:P1.formulaSelectFunctionResult,onKeyDown:R,tabIndex:-1,children:o.map(({name:P},N)=>At.jsxs("li",{className:s===N?`${P1.formulaSelectFunctionResultItem} ${P1.formulaSelectFunctionResultItemActive}`:P1.formulaSelectFunctionResultItem,onMouseEnter:()=>I(N),onMouseLeave:T,onClick:()=>E(N),children:[d===N&&At.jsx(hze,{className:P1.formulaSelectFunctionResultItemSelected}),At.jsx("span",{className:P1.formulaSelectFunctionResultItemName,children:S(P)})]},N))}),f&&At.jsxs("div",{className:P1.formulaSelectFunctionContent,children:[At.jsx(R6,{title:f.functionName,value:f.description}),At.jsx(R6,{title:v.t("formula.moreFunctions.syntax"),value:At.jsx(ej,{prefix:f.functionName,value:f.functionParameter})}),At.jsx(R6,{title:v.t("formula.prompt.helpExample"),value:`${f.functionName}(${f.functionParameter.map(P=>P.example).join(",")})`}),f.functionParameter&&f.functionParameter.map((P,N)=>At.jsx(R6,{title:P.name,value:`${P.require?b:C} ${P.detail}`},N))]})]})}function IWe(){const[t,e]=_.useState(!0),[n,r]=_.useState(!1),[i,o]=_.useState([]),[a,s]=_.useState(null),u=Ct(Gt);Ct(cd);const l=Ct(zf);function c(){e(!t),r(!n)}function d(){l.inputFormula(`=${a==null?void 0:a.functionName}(`)}return At.jsxs("div",{className:Rw.formulaMoreFunctions,children:[t&&At.jsx(RWe,{onChange:s}),n&&At.jsx(Kze,{functionInfo:a,onChange:o}),At.jsxs("div",{className:Rw.formulaMoreFunctionsOperation,children:[n&&At.jsx(X1,{type:"primary",size:"small",onClick:c,children:u.t("formula.moreFunctions.next")}),n&&At.jsx(X1,{size:"small",onClick:c,children:u.t("formula.moreFunctions.prev")}),t&&At.jsx(X1,{type:"primary",size:"small",onClick:d,children:u.t("formula.moreFunctions.confirm")})]})]})}function AWe(t){return{id:Ny.id,icon:"FunctionSingle",tooltip:"formula.insert.tooltip",group:Kt.TOOLBAR_FORMULAS_INSERT,type:pt.SELECTOR,positions:[hn.TOOLBAR_START],selections:[{label:"SUM",value:"SUM",icon:"SumSingle"},{label:"AVERAGE",value:"AVERAGE",icon:"AvgSingle"},{label:"COUNT",value:"COUNT",icon:"CntSingle"},{label:"MAX",value:"MAX",icon:"MaxSingle"},{label:"MIN",value:"MIN",icon:"MinSingle"}],hidden$:cr(t,or.SHEET),disabled$:ei(t)}}function TWe(){return{id:YH.id,title:"formula.insert.more",positions:Ny.id,type:pt.BUTTON}}function wWe(t){return new Wt(e=>e.next(!t.get($s).supportClipboard))}function LWe(t){return{id:jH.id,type:pt.BUTTON,title:"formula.operation.pasteFormula",positions:[Sd],disabled$:wWe(t)}}const tj="meta_key_ctrl_And_Shift",Q8=[Ge.ARROW_DOWN,Ge.ARROW_UP,Ge.ARROW_LEFT,Ge.ARROW_RIGHT],OWe=[...Q8,Ge.ENTER,Ge.TAB];function PWe(){const t=[];for(const e of OWe)t.push({id:Dd.id,binding:e,preconditions:n=>Ff(n),staticParameters:{eventType:dr.Keyboard,keycode:e}});return t}function MWe(){const t=[];for(const e of Q8)t.push({id:Dd.id,binding:e|Yt.SHIFT,preconditions:n=>Ff(n),staticParameters:{eventType:dr.Keyboard,keycode:e,metaKey:Yt.SHIFT}});return t}function NWe(){const t=[];for(const e of Q8)t.push({id:Dd.id,binding:e|Yt.CTRL_COMMAND,preconditions:n=>Ff(n),staticParameters:{eventType:dr.Keyboard,keycode:e,metaKey:Yt.CTRL_COMMAND}});return t}function xWe(){const t=[];for(const e of Q8)t.push({id:Dd.id,binding:e|Yt.SHIFT|Yt.CTRL_COMMAND,preconditions:n=>Ff(n),staticParameters:{eventType:dr.Keyboard,keycode:e,metaKey:tj}});return t}const FWe={id:My.id,binding:Ge.F4,preconditions:t=>Ff(t)};var $We=Object.defineProperty,kWe=Object.getOwnPropertyDescriptor,BWe=(t,e,n,r)=>{for(var i=r>1?void 0:r?kWe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&$We(e,n,i),i},O2=(t,e)=>(n,r)=>e(n,r,t);let hh=class extends We{constructor(t,e,n,r,i,o){super(),this._injector=t,this._menuService=e,this._commandService=n,this._shortcutService=r,this._uiController=i,this._componentManager=o,this._initialize()}_initialize(){this._registerCommands(),this._registerMenus(),this._registerShortcuts(),this._registerComponents()}_registerMenus(){[AWe,TWe,LWe].forEach(t=>{this.disposeWithMe(this._menuService.addMenuItem(this._injector.invoke(t)))})}_registerCommands(){[zH,jH,Ny,YH,hC,fC,Dd,My].forEach(t=>this.disposeWithMe(this._commandService.registerCommand(t)))}_registerShortcuts(){[...PWe(),...MWe(),...NWe(),...xWe(),FWe].forEach(t=>{this.disposeWithMe(this._shortcutService.registerShortcut(t))})}_registerComponents(){this.disposeWithMe(this._uiController.registerContentComponent(()=>H6(Vze,this._injector))),this._componentManager.register(WH,IWe)}};hh=BWe([yt(ot.Ready,hh),O2(0,K(wn)),O2(1,S1),O2(2,se),O2(3,lu),O2(4,F0),O2(5,K(Jo))],hh);const Aw="formula_reference_selection_plugin_name";function uv(t,e,n){const r=t.getCurrentTheme(),i=new Xo(e).setAlpha(.05).toRgbString();return{id:n,strokeWidth:1.5,stroke:e,fill:i,widgets:{tl:!0,tc:!0,tr:!0,ml:!0,mr:!0,bl:!0,bc:!0,br:!0},widgetSize:6,widgetStrokeWidth:1,widgetStroke:r.colorWhite,hasAutoFill:!1,hasRowHeader:!1,hasColumnHeader:!1}}var UWe=Object.defineProperty,VWe=Object.getOwnPropertyDescriptor,HWe=(t,e,n,r)=>{for(var i=r>1?void 0:r?VWe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&UWe(e,n,i),i},Ni=(t,e)=>(n,r)=>e(n,r,t);let ph=class extends We{constructor(t,e,n,r,i,o,a,s,u,l,c,d,m,f,h,p,v){super(),Rn(this,"_formulaRefColors",[]),Rn(this,"_previousSequenceNodes"),Rn(this,"_previousRangesCount",0),Rn(this,"_previousInsertRefStringIndex"),Rn(this,"_currentInsertRefStringIndex",-1),Rn(this,"_currentUnitId"),Rn(this,"_currentSheetId"),Rn(this,"_arrowMoveActionState",0),Rn(this,"_isSelectionMovingRefSelections",[]),Rn(this,"_stringColor",""),Rn(this,"_numberColor",""),Rn(this,"_insertSelections",[]),Rn(this,"_inputPanelState",0),this._commandService=t,this._contextService=e,this._textSelectionRenderManager=n,this._editorBridgeService=r,this._formulaPromptService=i,this._lexerTreeBuilder=o,this._renderManagerService=a,this._themeService=s,this._selectionManagerService=u,this._sheetSkeletonManagerService=l,this._currentUniverService=c,this._selectionRenderService=d,this._descriptionService=m,this._textSelectionManagerService=f,this._formulaInputService=h,this._docViewModelManagerService=p,this._contextMenuService=v,this._initialize()}dispose(){this._formulaRefColors=[],this._resetTemp()}_resetTemp(){this._previousSequenceNodes=null,this._previousInsertRefStringIndex=null,this._currentUnitId=null,this._currentSheetId=null,this._isSelectionMovingRefSelections=[],this._previousRangesCount=0,this._currentInsertRefStringIndex=-1}_initialize(){this._initialCursorSync(),this._initAcceptFormula(),this._initialFormulaTheme(),this._initialRefSelectionUpdateEvent(),this._initialRefSelectionInsertEvent(),this._initialExitEditor(),this._initialEditorInputChange(),this._commandExecutedListener(),this._cursorStateListener(),this._syncEditorListener()}_initialFormulaTheme(){const t=this._themeService.getCurrentTheme();this._formulaRefColors=[t.loopColor1,t.loopColor2,t.loopColor3,t.loopColor4,t.loopColor5,t.loopColor6,t.loopColor7,t.loopColor8,t.loopColor9,t.loopColor10,t.loopColor11,t.loopColor12],this._numberColor=t.hyacinth700,this._stringColor=t.verdancy800}_initialCursorSync(){this.disposeWithMe(je(this._textSelectionManagerService.textSelection$.subscribe(t=>{if(this._editorBridgeService.isVisible().visible===!1||this._formulaInputService.isSelectionMoving()||(t==null?void 0:t.unitId)==null||![qn,Qr].includes(t.unitId))return;const e=this._getCurrentBody(),n=(e==null?void 0:e.dataStream)||"";this._contextSwitch(n),this._changeKeepVisibleHideState(),this._switchSelectionPlugin(),!this._formulaInputService.isLockedSelectionChange()&&(this._highlightFormula(),this._changeFunctionPanelState())})))}_initialEditorInputChange(){this.disposeWithMe(je(this._textSelectionRenderManager.onInputBefore$.subscribe(t=>{this._previousSequenceNodes=null,this._previousInsertRefStringIndex=null,this._selectionRenderService.enableSkipRemainLast();const e=t==null?void 0:t.event;e!=null&&([Ge.ARROW_DOWN,Ge.ARROW_UP,Ge.ARROW_LEFT,Ge.ARROW_RIGHT].includes(e.which)?this._inputPanelState=2:(this._arrowMoveActionState!==1&&(this._arrowMoveActionState=2),this._inputPanelState=1))})))}_initialExitEditor(){this.disposeWithMe(je(this._editorBridgeService.afterVisible$.subscribe(t=>{if(t.visible===!0){const{unitId:n,sheetId:r}=this._getCurrentUnitIdAndSheetId();this._currentUnitId==null&&(this._currentUnitId=n),this._currentSheetId==null&&(this._currentSheetId=r);return}const e=this._selectionManagerService.getCurrent();if(this._insertSelections=[],(e==null?void 0:e.pluginName)===Nn){this._disableForceKeepVisible(),this._currentUnitId=null,this._currentSheetId=null;return}this._selectionManagerService.clear(),this._selectionManagerService.changePlugin(Nn),this._updateEditorModel(`\r
`,[]),this._contextService.setContextValue(rc,!1),this._disableForceKeepVisible(),this._selectionRenderService.resetStyle(),this._resetTemp(),this._hideFunctionPanel()})))}_initialRefSelectionUpdateEvent(){const t=new ws;this.disposeWithMe(je(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{t.dispose();const e=this._selectionManagerService.getCurrent();this._formulaInputService.disableSelectionMoving(),(e==null?void 0:e.pluginName)===Aw&&(this._updateRefSelectionStyle(this._isSelectionMovingRefSelections),this._selectionRenderService.getCurrentControls().forEach(n=>{n.disableHelperSelection(),t.add(je(n.selectionMoving$.subscribe(r=>{this._changeControlSelection(r,n)}))),t.add(je(n.selectionScaling$.subscribe(r=>{this._changeControlSelection(r,n)}))),t.add(je(n.selectionMoved$.subscribe(()=>{this._formulaInputService.disableLockedSelectionChange()}))),t.add(je(n.selectionScaled$.subscribe(()=>{this._formulaInputService.disableLockedSelectionChange()})))}))})))}_syncEditorListener(){this.disposeWithMe(je(this._formulaInputService.syncToEditor$.subscribe(t=>{const{sequences:e,textSelectionOffset:n}=t;this._syncToEditor(e,n)})))}_selectionChanging(t,e=!1){if(t.length===0||!this._formulaInputService.isLockedSelectionInsert()||(this._formulaInputService.enableSelectionMoving(),this._inertControlSelection(t),e===!1))return;const n=t[t.length-1];this._inertControlSelectionReplace(n)}_initialRefSelectionInsertEvent(){this.disposeWithMe(je(this._selectionRenderService.selectionMoving$.subscribe(t=>{this._selectionChanging(t.map(e=>_7(e)))}))),this.disposeWithMe(je(this._selectionRenderService.selectionMoveStart$.subscribe(t=>{this._selectionChanging(t.map(e=>_7(e)),!0)})))}_initAcceptFormula(){this.disposeWithMe(je(this._formulaPromptService.acceptFormulaName$.subscribe(t=>{const e=this._textSelectionManagerService.getActiveRange();if(e==null){this._hideFunctionPanel();return}const{startOffset:n}=e,r=this._formulaInputService.getSequenceNodes(),i=this._formulaInputService.getCurrentSequenceNodeIndex(n-2),o=r[i];if(o==null||typeof o=="string"){this._hideFunctionPanel();return}const a=t.length-o.token.length,s={...o};s.token=t,s.endIndex+=a,r[i]=s,r.splice(i+1,0,bn.OPEN_BRACKET);const u=t.length+1;for(let l=i+2,c=r.length;l<c;l++){const d=r[l];if(typeof d=="string")continue;const m={...d};m.startIndex+=u,m.endIndex+=u,r[l]=m}this._syncToEditor(r,s.endIndex+2)})))}_changeFunctionPanelState(){const t=this._textSelectionManagerService.getActiveRange();if(t==null){this._hideFunctionPanel();return}const{startOffset:e}=t,n=this._formulaInputService.getCurrentSequenceNode(e-2);if(n==null){this._hideFunctionPanel();return}if(typeof n!="string"&&n.nodeType===ni.FUNCTION){const u=n.token.toUpperCase();if(this._inputPanelState===1){const l=this._descriptionService.getSearchListByNameFirstLetter(u);if(this._hideFunctionPanel(),l==null||l.length===0)return;this._commandService.executeCommand(hC.id,{visible:!0,searchText:u,searchList:l})}else this._descriptionService.hasFunction(u)&&this._changeHelpFunctionPanelState(u,-1);return}const r=this._getCurrentBody(),i=(r==null?void 0:r.dataStream)||"",o=this._lexerTreeBuilder.getFunctionAndParameter(i,e-1);if(o==null){this._hideFunctionPanel();return}const{functionName:a,paramIndex:s}=o;this._changeHelpFunctionPanelState(a.toUpperCase(),s)}_changeHelpFunctionPanelState(t,e){const n=this._descriptionService.getFunctionInfo(t);this._hideFunctionPanel(),n!=null&&this._commandService.executeCommand(fC.id,{visible:!0,paramIndex:e,functionInfo:n})}_hideFunctionPanel(){this._commandService.executeCommand(hC.id,{visible:!1,searchText:""}),this._commandService.executeCommand(fC.id,{visible:!1,paramIndex:-1})}_changeKeepVisibleHideState(){if(this._getContextState()===!1){this._disableForceKeepVisible();return}const t=this._getCurrentChar();if(t==null){this._disableForceKeepVisible();return}this._matchRefDrawToken(t)?(this._editorBridgeService.enableForceKeepVisible(),this._contextMenuService.disable(),this._formulaInputService.enableLockedSelectionInsert(),this._selectionRenderService.enableRemainLast(),this._arrowMoveActionState!==1&&(this._arrowMoveActionState=2)):this._disableForceKeepVisible()}_matchRefDrawToken(t){return i7(t)&&t!==bn.CLOSE_BRACES&&t!==bn.CLOSE_BRACKET&&t!==bn.SINGLE_QUOTATION&&t!==bn.DOUBLE_QUOTATION||t===" "}_getCurrentChar(){const t=this._textSelectionManagerService.getActiveRange();if(t==null)return;const{startOffset:e}=t,n=this._getCurrentBody();return n==null||e==null?void 0:n.dataStream[e-1]}_disableForceKeepVisible(){this._editorBridgeService.disableForceKeepVisible(),this._contextMenuService.enable(),this._formulaInputService.disableLockedSelectionInsert(),this._currentInsertRefStringIndex=-1,this._selectionRenderService.disableRemainLast(),this._arrowMoveActionState===2&&(this._arrowMoveActionState=4)}_getCurrentBody(){var t;const e=this._editorBridgeService.getCurrentEditorId();if(e==null)return;const n=this._currentUniverService.getUniverDocInstance(e);return(t=n==null?void 0:n.snapshot)==null?void 0:t.body}_getFormulaAndCellEditorBody(){return[qn,Qr].map(t=>{const e=this._currentUniverService.getUniverDocInstance(t);return e==null?void 0:e.getBody()})}_contextSwitch(t){if($i(t)){this._contextService.setContextValue(rc,!0);const e=this._lexerTreeBuilder.sequenceNodesBuilder(t.replace(/\r/g,"").replace(/\n/g,""))||[];this._formulaInputService.setSequenceNodes(e);const n=this._textSelectionManagerService.getActiveRange();if(n==null)return;const{startOffset:r}=n;this._currentInsertRefStringIndex=r-1}else this._contextService.setContextValue(rc,!1),this._formulaInputService.disableLockedSelectionChange(),this._formulaInputService.disableLockedSelectionInsert(),this._formulaInputService.clearSequenceNodes(),this._hideFunctionPanel()}_getContextState(){return this._contextService.getContextValue(rc)}_switchSelectionPlugin(){if(this._getContextState()===!0){this._selectionManagerService.changePluginNoRefresh(Aw);const t=vc(this._themeService);t.strokeDash=8,t.hasAutoFill=!1,t.hasRowHeader=!1,t.hasColumnHeader=!1,this._selectionRenderService.setStyle(t)}else this._selectionManagerService.changePluginNoRefresh(Nn),this._selectionRenderService.resetStyle()}_highlightFormula(){if(this._getContextState()===!1)return;const t=this._formulaInputService.getSequenceNodes(),e=this._getFormulaAndCellEditorBody().filter(n=>!!n);if(this._selectionManagerService.clear(),t==null||t.length===0)e.forEach(n=>n.textRuns=[]);else{const{textRuns:n,refSelections:r}=this._buildTextRuns(t);e.forEach(i=>i.textRuns=n),this._refreshSelectionForReference(r)}this._refreshFormulaAndCellEditor()}_buildTextRuns(t){const e=[],n=[];let r=0;for(let i=0,o=t.length;i<o;i++){const a=t[i];if(typeof a=="string")continue;const{startIndex:s,endIndex:u,nodeType:l,token:c}=a;let d="";if(l===ni.REFERENCE){const m=r%this._formulaRefColors.length;d=this._formulaRefColors[m],n.push({refIndex:i,themeColor:d,token:c}),r++}else l===ni.NUMBER?d=this._numberColor:l===ni.STRING?d=this._stringColor:l===ni.ARRAY&&(d=this._stringColor);d&&d.length>0&&e.push({st:s+1,ed:u+2,ts:{cl:{rgb:d}}})}return{textRuns:e,refSelections:n}}_exceedCurrentRange(t,e,n){const{endRow:r,endColumn:i}=t;return r>e||i>n}_refreshSelectionForReference(t){var e;const{unitId:n,sheetId:r}=this._getCurrentUnitIdAndSheetId(),i=[],o=this._currentUniverService.getUniverSheetInstance(n),a=o==null?void 0:o.getSheetBySheetId(r);if(a==null)return;let s=null;for(let u=0,l=t.length;u<l;u++){const c=t[u],{themeColor:d,token:m,refIndex:f}=c,h=Ms(m),{unitId:p,sheetName:v,range:g}=h;if(p!=null&&p.length>0&&n!==p)continue;const b=this._getSheetIdByName(n,v.trim());if(v.length!==0&&b!==r||this._exceedCurrentRange(g,a.getRowCount(),a.getColumnCount()))continue;let C=(e=this._insertSelections.find(S=>{const{startRow:E,startColumn:y,endRow:D,endColumn:R}=S.range;return E===g.startRow&&y===g.startColumn&&D===g.endRow&&R===g.endColumn||E===g.startRow&&y===g.startColumn&&g.startRow===g.endRow&&g.startColumn===g.endColumn}))==null?void 0:e.primary;if(C!=null){const{isMerged:S,isMergedMainCell:E,startRow:y,endRow:D,startColumn:R,endColumn:I}=C;(S||E)&&y===g.startRow&&R===g.startColumn&&g.startRow===g.endRow&&g.startColumn===g.endColumn&&(g.endRow=D,g.endColumn=I),s={range:g,primary:C,style:uv(this._themeService,d,f.toString())};continue}C=yo(g,a),!ht.equals(C,g)&&g.startRow===g.endRow&&g.startColumn===g.endColumn&&(g.startRow=C.startRow,g.endRow=C.endRow,g.startColumn=C.startColumn,g.endColumn=C.endColumn),i.push({range:g,primary:C,style:uv(this._themeService,d,f.toString())})}s&&i.push(s),i.length!==0&&this._selectionManagerService.add(i)}_getSheetIdByName(t,e){var n;const r=this._currentUniverService.getUniverSheetInstance(t);return(n=r==null?void 0:r.getSheetBySheetName(TTe(e)))==null?void 0:n.getSheetId()}_getSheetNameById(t,e){var n;const r=this._currentUniverService.getUniverSheetInstance(t);return((n=r==null?void 0:r.getSheetBySheetId(e))==null?void 0:n.getName())||""}_getCurrentUnitIdAndSheetId(){const t=this._sheetSkeletonManagerService.getCurrent();if(t==null){const i=this._currentUniverService.getCurrentUniverSheetInstance(),o=i.getActiveSheet();return{unitId:i.getUnitId(),sheetId:o.getSheetId()}}const{unitId:e,sheetId:n,skeleton:r}=t;return{unitId:e,sheetId:n,skeleton:r}}_getRefString(t){const{unitId:e,sheetId:n}=this._getCurrentUnitIdAndSheetId();let r="",i="";e===this._currentUnitId?r="":r=e,n===this._currentSheetId?i="":i=this._getSheetNameById(e,n);const{range:o,primary:a}=t;let{startRow:s,endRow:u,startColumn:l,endColumn:c}=o;const{startAbsoluteRefType:d,endAbsoluteRefType:m,rangeType:f}=o;if(a){const{isMerged:h,isMergedMainCell:p,startRow:v,endRow:g,startColumn:b,endColumn:C}=a;(h||p)&&v===s&&b===l&&g===u&&C===c&&(s=v,l=b,u=v,c=b)}return Y6({sheetName:i,unitId:r,range:{startRow:s,endRow:u,startColumn:l,endColumn:c,rangeType:f,startAbsoluteRefType:d,endAbsoluteRefType:m}})}async _syncToEditor(t,e,n=!0){const r=VE(t),{textRuns:i,refSelections:o}=this._buildTextRuns(t);this._isSelectionMovingRefSelections=o;const a=this._textSelectionManagerService.getActiveRange();if(a==null)return;const{collapsed:s,style:u}=a;this._currentInsertRefStringIndex=e,await this._fitEditorSize(),n?this._commandService.executeCommand(TF.id,{unitId:this._editorBridgeService.getCurrentEditorId(),body:{dataStream:`=${r}`,textRuns:i},textRanges:[{startOffset:e+1,endOffset:e+1,collapsed:s,style:u}],segmentId:null}):(this._updateEditorModel(`=${r}\r
`,i),this._textSelectionManagerService.replaceTextRanges([{startOffset:e+1,endOffset:e+1,style:u}])),setTimeout(()=>{this._textSelectionRenderManager.focus(),this._setRemainCapture()},0),this._setRemainCapture()}async _fitEditorSize(){const t=this._editorBridgeService.getCurrentEditorId();t!=null&&await this._commandService.syncExecuteCommand(V8.id,{unitId:t})}_updateEditorModel(t,e){const n=this._editorBridgeService.getCurrentEditorId();if(n==null)return;const r=this._currentUniverService.getUniverDocInstance(n),i=this._docViewModelManagerService.getViewModel(n);if(i==null||r==null)return;const o=r==null?void 0:r.getSnapshot();if(o==null)return;const a={dataStream:t,textRuns:e};o.body=a,i.reset(r)}_inertControlSelectionReplace(t){this._previousSequenceNodes==null&&(this._previousSequenceNodes=this._formulaInputService.getSequenceNodes()),this._previousInsertRefStringIndex==null&&(this._previousInsertRefStringIndex=this._currentInsertRefStringIndex);const e=Ie.deepClone(this._previousSequenceNodes);if(e==null)return;const n=this._getRefString(t);this._formulaInputService.setSequenceNodes(e),this._formulaInputService.insertSequenceRef(this._previousInsertRefStringIndex,n),this._syncToEditor(e,this._previousInsertRefStringIndex+n.length);const r=this._selectionRenderService.getSelectionDataWithStyle();this._insertSelections=[],r.forEach(i=>{const o=_7(i);this._insertSelections.push(o)})}_inertControlSelection(t){const e=t[t.length-1];if((t.length===this._previousRangesCount||this._previousRangesCount===0)&&this._previousSequenceNodes!=null)this._inertControlSelectionReplace(e);else{let n=this._formulaInputService.getSequenceNodes();if(n==null)return;const r=this._getCurrentChar();if(r==null)return;this._previousInsertRefStringIndex=this._currentInsertRefStringIndex,this._matchRefDrawToken(r)||(this._formulaInputService.insertSequenceString(this._currentInsertRefStringIndex,bn.COMMA),n=this._formulaInputService.getSequenceNodes(),this._previousInsertRefStringIndex+=1),this._previousSequenceNodes=Ie.deepClone(n);const i=this._getRefString(e);this._formulaInputService.setSequenceNodes(n),this._formulaInputService.insertSequenceRef(this._previousInsertRefStringIndex,i),this._selectionRenderService.disableSkipRemainLast()}this._arrowMoveActionState=2,this._previousRangesCount=t.length}_updateRefSelectionStyle(t){const e=this._selectionRenderService.getCurrentControls(),{unitId:n,sheetId:r}=this._getCurrentUnitIdAndSheetId();for(let i=0,o=t.length;i<o;i++){const a=t[i],{refIndex:s,themeColor:u,token:l}=a,c=Ms(l),{unitId:d,sheetName:m,range:f}=c;if(d!=null&&d.length>0&&n!==d)continue;const h=this._getSheetIdByName(n,m.trim());if(h!=null&&h!==r)continue;const p=e.find(g=>{const{startRow:b,startColumn:C,endRow:S,endColumn:E,rangeType:y}=g.getRange();return y===ct.COLUMN&&C===f.startColumn&&E===f.endColumn||y===ct.ROW&&b===f.startRow&&S===f.endRow||b===f.startRow&&C===f.startColumn&&S===f.endRow&&E===f.endColumn||b===f.startRow&&C===f.startColumn&&f.startRow===f.endRow&&f.startColumn===f.endColumn});if(p==null)continue;const v=uv(this._themeService,u,s.toString());p.updateStyle(v)}}_changeControlSelection(t,e){var n;if(!t)return;const{unitId:r,sheetId:i,skeleton:o}=this._getCurrentUnitIdAndSheetId();this._formulaInputService.enableLockedSelectionChange();const a=(n=e.selectionStyle)==null?void 0:n.id;if(a==null||!Ie.isStringNumber(a))return;let{startRow:s,endRow:u,startColumn:l,endColumn:c}=t;const d=Xc(s,l,o==null?void 0:o.mergeData);if(d){const{isMerged:b,isMergedMainCell:C,startRow:S,endRow:E,startColumn:y,endColumn:D}=d;(b||C)&&S===s&&y===l&&E===u&&D===c&&(s=S,l=y,u=S,c=y)}const m=Number(a),f=this._formulaInputService.getCurrentSequenceNodeByIndex(m);let h={startAbsoluteRefType:Hn.NONE};if(typeof f!="string"){const b=f.token;h=OTe(b),h.endAbsoluteRefType==null&&(h.endAbsoluteRefType=h.startAbsoluteRefType)}const p=this._getRefString({range:{startRow:Math.min(s,u),endRow:Math.max(s,u),startColumn:Math.min(l,c),endColumn:Math.max(l,c),...h},primary:d,style:null});this._formulaInputService.updateSequenceRef(m,p);const v=this._formulaInputService.getSequenceNodes(),g=v[m];typeof g!="string"&&(this._syncToEditor(v,g.endIndex+1),e.update(t,void 0,void 0,void 0,this._selectionRenderService.convertCellRangeToInfo(d)))}_refreshFormulaAndCellEditor(){var t;const e=[qn,Qr];for(const n of e){const r=bc(n,this._renderManagerService),i=r==null?void 0:r.document;i!=null&&((t=i.getSkeleton())==null||t.calculate(),i.makeDirty())}}_setRemainCapture(){const{unitId:t}=this._getCurrentUnitIdAndSheetId(),e=bc(t,this._renderManagerService),n=e==null?void 0:e.engine;n==null||n.setRemainCapture()}_cursorStateListener(){const t=this._getEditorObject();if(t==null)return;const{document:e}=t;this.disposeWithMe(je(e.onPointerDownObserver.add(()=>{this._arrowMoveActionState=1,this._inputPanelState=3})))}_commandExecutedListener(){const t=[Dd.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{keycode:r,metaKey:i}=n;if(r===Ge.ENTER){if(this._formulaPromptService.isSearching()){this._formulaPromptService.accept(!0);return}this._editorBridgeService.changeVisible({visible:!1,eventType:dr.Keyboard,keycode:r}),this._commandService.executeCommand(vo.id,{direction:ye.DOWN});return}if(r===Ge.TAB){if(this._formulaPromptService.isSearching()){this._formulaPromptService.accept(!0);return}this._editorBridgeService.changeVisible({visible:!1,eventType:dr.Keyboard,keycode:r}),this._commandService.executeCommand(vo.id,{direction:ye.RIGHT});return}if(this._formulaPromptService.isSearching()){if(r===Ge.ARROW_DOWN){this._formulaPromptService.navigate({direction:ye.DOWN});return}if(r===Ge.ARROW_UP){this._formulaPromptService.navigate({direction:ye.UP});return}}if(this._arrowMoveActionState===1){this._moveInEditor(r);return}if(this._arrowMoveActionState===4){this._editorBridgeService.changeVisible({visible:!1,eventType:dr.Keyboard,keycode:r});return}if(this._arrowMoveActionState===2&&(this._arrowMoveActionState=3),(this._selectionManagerService.getSelectionRanges()||[]).length===0){const u=this._selectionManagerService.getLastByPlugin(Nn);if(u!=null){const l=Ie.deepClone(u);this._selectionManagerService.add([l])}}let o=ye.DOWN;r===Ge.ARROW_DOWN?o=ye.DOWN:r===Ge.ARROW_UP?o=ye.UP:r===Ge.ARROW_LEFT?o=ye.LEFT:r===Ge.ARROW_RIGHT&&(o=ye.RIGHT),i===Yt.CTRL_COMMAND?this._commandService.executeCommand(vo.id,{direction:o,jumpOver:xs.moveGap}):i===Yt.SHIFT?this._commandService.executeCommand(Fs.id,{direction:o}):i===tj?this._commandService.executeCommand(Fs.id,{direction:o,jumpOver:xs.moveGap}):this._commandService.executeCommand(vo.id,{direction:o});const a=this._selectionManagerService.getSelections()||[],s=a[a.length-1];this._inertControlSelectionReplace(s)}}))}_moveInEditor(t){if(t==null)return;let e=ye.LEFT;t===Ge.ARROW_DOWN?e=ye.DOWN:t===Ge.ARROW_UP?e=ye.UP:t===Ge.ARROW_RIGHT&&(e=ye.RIGHT),this._commandService.executeCommand(nu.id,{direction:e})}_getEditorObject(){return bc(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}};ph=HWe([yt(ot.Steady,ph),Ni(0,se),Ni(1,pr),Ni(2,To),Ni(3,K(Oo)),Ni(4,K(a2)),Ni(5,K(E1)),Ni(6,Jn),Ni(7,K(_i)),Ni(8,K(dt)),Ni(9,K(Dr)),Ni(10,ae),Ni(11,K(Hi)),Ni(12,K(Z8)),Ni(13,K(kr)),Ni(14,zf),Ni(15,K(tu)),Ni(16,yf)],ph);var jWe=Object.defineProperty,zWe=Object.getOwnPropertyDescriptor,WWe=(t,e,n,r)=>{for(var i=r>1?void 0:r?zWe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&jWe(e,n,i),i},s4=(t,e)=>(n,r)=>e(n,r,t);let gh=class extends We{constructor(t,e,n,r){super(),Rn(this,"_waitingCommandQueue",[]),Rn(this,"_executingCommandQueue",[]),Rn(this,"_setTimeoutKey",-1),Rn(this,"_startExecutionTime",0),this._commandService=t,this._activeDirtyManagerService=e,this._numfmtService=n,this._formulaDataModel=r,this._initialize()}_initialize(){this._commandExecutedListener(),this._initialExecuteFormulaProcessListener(),this._initialExecuteFormula()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted((t,e)=>{if(this._activeDirtyManagerService.get(t.id)){if(t.id===Vt.id){const n=t.params;if(e&&e.onlyLocal===!0||n.trigger===ii.id||n.trigger===pl.id||n.trigger===ll.id)return}this._waitingCommandQueue.push(t),clearTimeout(this._setTimeoutKey),this._setTimeoutKey=setTimeout(()=>{this._commandService.executeCommand(T9.id,{...this._generateDirty(this._waitingCommandQueue)},{onlyLocal:!0}),this._startExecutionTime=performance.now(),this._executingCommandQueue=this._waitingCommandQueue,this._waitingCommandQueue=[]},100)}}))}_generateDirty(t){const e=[],n={},r={},i=this._formulaDataModel.getNumfmtItemMap();for(const o of t){const a=this._activeDirtyManagerService.get(o.id);if(a==null)continue;const s=a.getDirtyData(o),{dirtyRanges:u,dirtyNameMap:l,dirtyUnitFeatureMap:c}=s;u!=null&&e.push(...u),l!=null&&this._mergeDirtyNameMap(n,l),c!=null&&this._mergeDirtyUnitFeatureMap(r,c)}return e.forEach(o=>{const{unitId:a,sheetId:s}=o;i[a]==null&&(i[a]={}),i[a][s]==null&&(i[a][s]={});const u=this._numfmtService.getModel(a,s);if(!u)return;const l=this._numfmtService.getRefModel(a);u.forValue((c,d,m)=>{if(m&&l){const f=l.getValue(m==null?void 0:m.i);if(!f)return;i[a][s][c]==null&&(i[a][s][c]={}),i[a][s][c][d]=f.pattern}})}),{dirtyRanges:e,dirtyNameMap:n,dirtyUnitFeatureMap:r,numfmtItemMap:i}}_mergeDirtyNameMap(t,e){Object.keys(e).forEach(n=>{t[n]==null&&(t[n]={}),Object.keys(e[n]).forEach(r=>{var i;(i=e[n])!=null&&i[r]&&(t[n]==null&&(t[n]={}),t[n][r]=e[n][r])})})}_mergeDirtyUnitFeatureMap(t,e){Object.keys(e).forEach(n=>{t[n]==null&&(t[n]={}),Object.keys(e[n]).forEach(r=>{t[n][r]==null&&(t[n][r]={}),Object.keys(e[n][r]).forEach(i=>{t[n][r][i]=e[n][r][i]||!1})})})}_initialExecuteFormulaProcessListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id!==w9.id)return;const e=t.params;if(e.stageInfo!=null)e.stageInfo;else switch(e.functionsExecutedState){case j1.NOT_EXECUTED:this._waitingCommandQueue.unshift(...this._executingCommandQueue),this._executingCommandQueue=[];break;case j1.STOP_EXECUTION:this._waitingCommandQueue.unshift(...this._executingCommandQueue),this._executingCommandQueue=[];break;case j1.SUCCESS:performance.now()-this._startExecutionTime,this._executingCommandQueue=[];break;case j1.INITIAL:this._executingCommandQueue=[];break}}))}_initialExecuteFormula(){this._commandService.executeCommand(T9.id,{commands:[],forceCalculation:!0},{onlyLocal:!0})}};gh=WWe([yt(ot.Ready,gh),s4(0,se),s4(1,Py),s4(2,K(Ti)),s4(3,K(Ai))],gh);function s6(t,e,n,r,i,o,a){const{id:s}=e;if(Ou(t,n,r))return t;const u=new Ye(t[n][r]),l=o&&new Ye(o[n][r]);switch(s){case Qc.id:YWe(u,e,l);break;case fd.id:XWe(u,e,i);break;case hd.id:qWe(u,e,i);break;case Jc.id:GWe(u,e,l,a);break;case e2.id:KWe(u,e,l,a);break;case fl.id:ZWe(u,e);break;case ml.id:QWe(u,e);break;case t2.id:JWe(u,e,l,a);break;case n2.id:eYe(u,e,l,a);break;case $c.id:tYe(u,e);break;case Fc.id:nYe(u,e);break}return t}function YWe(t,e,n){const{params:r}=e;if(!r)return;const{fromRange:i,toRange:o}=r;gC(i,o,t,t,n)}function XWe(t,e,n){const{params:r}=e;if(!r)return;const{fromRange:{startRow:i},toRange:{startRow:o}}=r,a=n==null?void 0:n.filter(c=>c.range.rangeType===ct.ROW&&c.range.startRow<=i&&i<=c.range.endRow);if((a==null?void 0:a.length)!==1)return;const s=a[0].range,u=s.startRow,l=s.endRow-s.startRow+1;t.moveRows(u,l,o)}function qWe(t,e,n){const{params:r}=e;if(!r)return;const{fromRange:{startColumn:i},toRange:{startColumn:o}}=r,a=n==null?void 0:n.filter(c=>c.range.rangeType===ct.COLUMN&&c.range.startColumn<=i&&i<=c.range.endColumn);if((a==null?void 0:a.length)!==1)return;const s=a[0].range,u=s.startColumn,l=s.endColumn-s.startColumn+1;t.moveColumns(u,l,o)}function GWe(t,e,n,r){const{params:i}=e;if(!i)return;const{range:o}=i;if(n){nj(o,t,n,r);return}const a=t.getLength()-1,s=t.getRange().endColumn;N8(t,o,a,s,Tr.ROWS)}function KWe(t,e,n,r){const{params:i}=e;if(!i)return;const{range:o}=i;if(n){rj(o,t,n,r);return}const a=t.getLength()-1,s=t.getRange().endColumn;N8(t,o,a,s,Tr.COLUMNS)}function ZWe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;N8(t,r,i,o,Tr.COLUMNS)}function QWe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;N8(t,r,i,o,Tr.ROWS)}function JWe(t,e,n,r){const{params:i}=e;if(!i)return;const{range:o}=i;if(n){nj(o,t,n,r);return}const a=t.getLength()-1,s=t.getRange().endColumn;x8(t,o,a,s,Tr.ROWS)}function eYe(t,e,n,r){const{params:i}=e;if(!i)return;const{range:o}=i;if(n){rj(o,t,n,r);return}const a=t.getLength()-1,s=t.getRange().endColumn;x8(t,o,a,s,Tr.COLUMNS)}function tYe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;x8(t,r,i,o,Tr.ROWS)}function nYe(t,e){const{params:n}=e;if(!n)return;const{range:r}=n,i=t.getLength()-1,o=t.getRange().endColumn;x8(t,r,i,o,Tr.COLUMNS)}function rYe(t,e,n,r){var i;if(Ou(t,n,r)||((i=t[n])==null?void 0:i[r])==null)return t;const o=new Ye(t[n][r]);return o.forValue((a,s,u)=>{if(u==null)return!0;const{startRow:l,startColumn:c,endRow:d,endColumn:m}=u;if(a===l&&s===c)return!0;const f=d-l,h=m-c,p={startRow:a,startColumn:s,endRow:a+f,endColumn:s+h};o.setValue(a,s,p)}),t}function Ou(t,e,n){var r;return t==null||t[e]==null||((r=t[e])==null?void 0:r[n])==null}function lv(t,e,n){var r;t&&t[e]&&(r=t[e])!=null&&r[n]&&delete t[e][n]}function Wm(t,e){const{startRow:n,endRow:r,startColumn:i,endColumn:o}=t;for(let a=n;a<=r;a++)for(let s=i;s<=o;s++)e.setValue(a,s,null)}function iYe(t,e,n){if(!n)return!1;let r=!1;return n.forValue((i,o,a)=>{if(!a)return;const{startRow:s,endRow:u,startColumn:l,endColumn:c}=a;if(s<=t&&t<=u&&l<=e&&e<=c)return r=!0,!1}),r}function gC(t,e,n,r,i){const{startRow:o,endRow:a,startColumn:s,endColumn:u}=t,{startRow:l,endRow:c,startColumn:d,endColumn:m}=e,f=new Ye;for(let h=o;h<=a;h++)for(let p=s;p<=u;p++){const v=n.getValue(h,p),g=i&&i.getValue(h,p);if(g){f.setValue(h-o,p-s,v),Wm(g,n);continue}else if(iYe(h,p,i)){f.setValue(h-o,p-s,null);continue}f.setValue(h-o,p-s,v),n.setValue(h,p,null)}for(let h=l;h<=c;h++)for(let p=d;p<=m;p++){const v=f.getValue(h-l,p-d);r.setValue(h,p,v)}}function nj(t,e,n,r){const{endRow:i}=t;n.forValue((o,a,s)=>{if(!s)return;const{startRow:u}=s;i<=u&&Wm(s,e)}),r==null||r.forEach(({row:o,column:a,range:s})=>{if(!s)return;const{endRow:u}=s;if(i<=u){const l=n==null?void 0:n.getValue(o,a);l&&Wm(l,e)}})}function rj(t,e,n,r){const{endColumn:i}=t;n.forValue((o,a,s)=>{if(!s)return;const{startColumn:u}=s;i<=u&&Wm(s,e)}),r==null||r.forEach(({row:o,column:a,range:s})=>{if(!s)return;const{endColumn:u}=s;if(i<=u){const l=n==null?void 0:n.getValue(o,a);l&&Wm(l,e)}})}function oYe(t,e,n,r){const{params:i}=t;if(!i)return;const{unitId:o}=i;let{from:a,to:s}=i;t.params.trigger===Gm.id&&(a=i.to,s=i.from);const{subUnitId:u,value:l}=a,{subUnitId:c,value:d}=s;if(Ou(e,o,u)||Ou(e,o,c)||Ou(n,o,u)||Ou(n,o,c)||Ou(r,o,u)||Ou(r,o,c))return;const m=new Ye(l),f=new Ye(d);Tw(m,e,o,u),Tw(f,e,o,c),aYe(m,f,n,r,o,u,c)}function Tw(t,e,n,r){e[n]||(e[n]={}),t.forValue((i,o,a)=>{if(e[n][r][i]||(e[n][r][i]={}),!a){delete e[n][r][i][o];return}const s=(a==null?void 0:a.f)||"",u=(a==null?void 0:a.si)||"",l=$i(s),c=La(u);l&&c?e[n][r][i][o]={f:s,si:u}:l&&!c?e[n][r][i][o]={f:s}:!l&&c?e[n][r][i][o]={f:"",si:u}:!l&&!c&&delete e[n][r][i][o]})}function aYe(t,e,n,r,i,o,a){var s,u,l,c,d,m,f,h;const p=new Ye((u=(s=r==null?void 0:r[i])==null?void 0:s[o])!=null?u:{}),v=new Ye((c=(l=r==null?void 0:r[i])==null?void 0:l[a])!=null?c:{}),g=new Ye((m=(d=n==null?void 0:n[i])==null?void 0:d[o])!=null?m:{}),b=new Ye((h=(f=n==null?void 0:n[i])==null?void 0:f[a])!=null?h:{}),C=t.getDataRange(),S=e.getDataRange();gC(C,S,p,v,g),gC(C,S,g,b)}var sYe=Object.defineProperty,uYe=Object.getOwnPropertyDescriptor,lYe=(t,e,n,r)=>{for(var i=r>1?void 0:r?uYe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&sYe(e,n,i),i},Wl=(t,e)=>(n,r)=>e(n,r,t);let vh=class extends We{constructor(t,e,n,r,i,o,a){super(),this._currentUniverService=t,this._commandService=e,this._lexerTreeBuilder=n,this._formulaDataModel=r,this._sheetInterceptorService=i,this._selectionManagerService=o,this._injector=a,this._initialize()}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:t=>this._getUpdateFormula(t)})),this.disposeWithMe(this._commandService.onCommandExecuted((t,e)=>{var n,r;if(t.params)if(t.id===Vt.id){const i=t.params;if(e&&e.onlyLocal===!0||i.trigger===ii.id||i.trigger===pl.id||i.trigger===ll.id)return;this._handleSetRangeValuesMutation(i,e)}else t.id===Qo.id?this._handleRemoveSheetMutation(t.params):t.id===Eo.id?this._handleInsertSheetMutation(t.params):(((n=t.params)==null?void 0:n.trigger)===Gm.id||((r=t.params)==null?void 0:r.trigger)===a5.id)&&this._handleRedoUndo(t)}))}_handleRedoUndo(t){const{id:e}=t,n=this._formulaDataModel.getFormulaData(),r=this._formulaDataModel.getArrayFormulaRange(),i=this._formulaDataModel.getArrayFormulaCellData();switch(e){case qa.id:oYe(t,n,r,i);break}this._commandService.executeCommand(nc.id,{formulaData:n}),this._commandService.executeCommand(V1.id,{arrayFormulaRange:r,arrayFormulaCellData:i})}_handleSetRangeValuesMutation(t,e){const{subUnitId:n,unitId:r,cellValue:i}=t;e&&e.onlyLocal===!0||t.trigger===ii.id||t.trigger===pl.id||t.trigger===ll.id||i==null||(this._formulaDataModel.updateFormulaData(r,n,i),this._formulaDataModel.updateArrayFormulaCellData(r,n,i),this._formulaDataModel.updateArrayFormulaRange(r,n,i),this._formulaDataModel.updateNumfmtData(r,n,i),this._commandService.executeCommand(nc.id,{formulaData:this._formulaDataModel.getFormulaData()},{onlyLocal:!0}),this._commandService.executeCommand(V1.id,{arrayFormulaRange:this._formulaDataModel.getArrayFormulaRange(),arrayFormulaCellData:this._formulaDataModel.getArrayFormulaCellData()},{onlyLocal:!0,remove:!0}),this._commandService.executeCommand(km.id,{numfmtItemMap:this._formulaDataModel.getNumfmtItemMap()},{onlyLocal:!0}))}_handleRemoveSheetMutation(t){const{subUnitId:e,unitId:n}=t,r=this._formulaDataModel.getFormulaData();lv(r,n,e);const i=this._formulaDataModel.getArrayFormulaRange();lv(i,n,e);const o=this._formulaDataModel.getArrayFormulaCellData();lv(o,n,e),this._commandService.executeCommand(nc.id,{formulaData:r},{onlyLocal:!0}),this._commandService.executeCommand(V1.id,{arrayFormulaRange:i,arrayFormulaCellData:o},{onlyLocal:!0})}_handleInsertSheetMutation(t){const{sheet:e,unitId:n}=t,r=this._formulaDataModel.getFormulaData(),{id:i,cellData:o}=e,a=new Ye(o);PB(r,n,i,a),this._commandService.executeCommand(nc.id,{formulaData:r},{onlyLocal:!0})}_getUpdateFormula(t){const{id:e}=t;let n=null;switch(e){case Qc.id:n=this._handleMoveRange(t);break;case fd.id:n=this._handleMoveRows(t);break;case hd.id:n=this._handleMoveCols(t);break;case Jc.id:n=this._handleInsertRow(t);break;case e2.id:n=this._handleInsertCol(t);break;case fl.id:n=this._handleInsertRangeMoveRight(t);break;case ml.id:n=this._handleInsertRangeMoveDown(t);break;case t2.id:n=this._handleRemoveRow(t);break;case n2.id:n=this._handleRemoveCol(t);break;case $c.id:n=this._handleDeleteRangeMoveUp(t);break;case Fc.id:n=this._handleDeleteRangeMoveLeft(t);break;case F8.id:n=this._handleSetWorksheetName(t);break;case Lf.id:n=this._handleRemoveWorksheet(t);break}if(n){const{unitSheetNameMap:r}=this._formulaDataModel.getCalculateData();let i=this._formulaDataModel.getFormulaData();const o=this._formulaDataModel.getNumfmtItemMap(),{newFormulaData:a,refRanges:s}=this._getFormulaReferenceMoveInfo(i,r,n),u=this._currentUniverService.getCurrentUniverSheetInstance(),l=u.getUnitId(),c=u.getActiveSheet().getSheetId(),d=this._selectionManagerService.getSelections(),m=this._formulaDataModel.getArrayFormulaRange(),f=this._formulaDataModel.getArrayFormulaCellData(),h=s6(f,t,l,c,d,m,s);let p=s6(m,t,l,c,d,m);p=rYe(p,t,l,c),this._commandService.executeCommand(V1.id,{arrayFormulaRange:p,arrayFormulaCellData:h},{onlyLocal:!0}),i=s6(i,t,l,c,d);const v=s6(a,t,l,c,d);this._commandService.executeCommand(nc.id,{formulaData:this._formulaDataModel.getFormulaData()});const g=s6(o,t,l,c,d);return this._commandService.executeCommand(km.id,{numfmtItemMap:g}),this._getUpdateFormulaMutations(i,v)}return{undos:[],redos:[]}}_handleMoveRange(t){const{params:e}=t;if(!e)return null;const{fromRange:n,toRange:r}=e;if(!n||!r)return null;const{unitId:i,sheetId:o}=this._getCurrentSheetInfo();return{type:0,from:n,to:r,unitId:i,sheetId:o}}_handleMoveRows(t){const{params:e}=t;if(!e)return null;const{fromRange:{startRow:n,endRow:r},toRange:{startRow:i,endRow:o}}=e,a=this._currentUniverService.getCurrentUniverSheetInstance(),s=a.getUnitId(),u=a.getActiveSheet(),l=u.getSheetId(),c={startRow:n,startColumn:0,endRow:r,endColumn:u.getColumnCount()-1,rangeType:ct.ROW},d={startRow:i,startColumn:0,endRow:o,endColumn:u.getColumnCount()-1,rangeType:ct.ROW};return{type:1,from:c,to:d,unitId:s,sheetId:l}}_handleMoveCols(t){const{params:e}=t;if(!e)return null;const{fromRange:{startColumn:n,endColumn:r},toRange:{startColumn:i,endColumn:o}}=e,a=this._currentUniverService.getCurrentUniverSheetInstance(),s=a.getUnitId(),u=a.getActiveSheet(),l=u.getSheetId(),c={startRow:0,startColumn:n,endRow:u.getRowCount()-1,endColumn:r,rangeType:ct.COLUMN},d={startRow:0,startColumn:i,endRow:u.getRowCount()-1,endColumn:o,rangeType:ct.COLUMN};return{type:2,from:c,to:d,unitId:s,sheetId:l}}_handleInsertRow(t){const{params:e}=t;if(!e)return null;const{range:n,unitId:r,subUnitId:i}=e;return{type:3,range:n,unitId:r,sheetId:i}}_handleInsertCol(t){const{params:e}=t;if(!e)return null;const{range:n,unitId:r,subUnitId:i}=e;return{type:4,range:n,unitId:r,sheetId:i}}_handleInsertRangeMoveRight(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:10,range:n,unitId:r,sheetId:i}}_handleInsertRangeMoveDown(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:9,range:n,unitId:r,sheetId:i}}_handleRemoveRow(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:5,range:n,unitId:r,sheetId:i}}_handleRemoveCol(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:6,range:n,unitId:r,sheetId:i}}_handleDeleteRangeMoveUp(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:8,range:n,unitId:r,sheetId:i}}_handleDeleteRangeMoveLeft(t){const{params:e}=t;if(!e)return null;const{range:n}=e,{unitId:r,sheetId:i}=this._getCurrentSheetInfo();return{type:7,range:n,unitId:r,sheetId:i}}_handleSetWorksheetName(t){const{params:e}=t;if(!e)return null;const{unitId:n,subUnitId:r,name:i}=e,{unitId:o,sheetId:a}=this._getCurrentSheetInfo();return{type:11,unitId:n||o,sheetId:r||a,sheetName:i}}_handleRemoveWorksheet(t){const{params:e}=t;if(!e)return null;const{unitId:n,subUnitId:r}=e,{unitId:i,sheetId:o}=this._getCurrentSheetInfo();return{type:12,unitId:n||i,sheetId:r||o}}_getUpdateFormulaMutations(t,e){var n;const r=[],i=[],o={get:this._injector.get.bind(this._injector)},a=Object.keys(e);for(const s of a){const u=e[s];if(u==null)continue;const l=Object.keys(u);for(const c of l){const d=(n=t[s])==null?void 0:n[c],m=new Ye(d),f=new Ye(u[c]),h=new Ye;f.forValue((b,C,S)=>{var E;const y=(S==null?void 0:S.f)||"",D=((E=m.getValue(b,C))==null?void 0:E.f)||"";$i(y)&&($i(D)&&y!==D?h.setValue(b,C,{f:y}):h.setValue(b,C,{f:y,si:null}))});const p=h.getData();if(Ie.isEmptyObject(p))continue;const v={subUnitId:c,unitId:s,cellValue:p};r.push({id:Vt.id,params:v});const g=ci(o,v);i.push({id:Vt.id,params:g})}}return{redos:r,undos:i}}_getFormulaReferenceMoveInfo(t,e,n){if(!Ie.isDefine(t))return{newFormulaData:{},refRanges:[]};const r=Object.keys(t);if(r.length===0)return{newFormulaData:{},refRanges:[]};const i={},o=[];for(const a of r){const s=t[a];if(s==null)continue;const u=Object.keys(s);Ie.isDefine(i[a])||(i[a]={});for(const l of u){const c=new Ye(s[l]),d=new Ye;c.forValue((m,f,h)=>{var p;if(!h)return!0;const{f:v,x:g,y:b,si:C}=h,S=this._lexerTreeBuilder.sequenceNodesBuilder(v);if(S==null)return!0;let E=!1;const y=[];for(let R=0,I=S.length;R<I;R++){const T=S[R];if(typeof T=="string"||T.nodeType!==ni.REFERENCE)continue;const{token:P}=T,N=Ms(P),{range:B,sheetName:W,unitId:G}=N;o.push({row:m,column:f,range:B});const Q=G==null||G.length===0?a:G,te=(p=e==null?void 0:e[Q])==null?void 0:p[W];if(!this._checkIsSameUnitAndSheet(n.unitId,n.sheetId,a,l,G,te||""))continue;const X={range:B,sheetId:te,unitId:G,sheetName:W,refOffsetX:g||0,refOffsetY:b||0};let x=null;if(n.type===11){const{unitId:O,sheetId:M,sheetName:V}=n;if(V==null||te==null||te.length===0||M!==te)continue;x=Y6({range:B,sheetName:V,unitId:G})}else if(n.type===12){const{unitId:O,sheetId:M,sheetName:V}=n;if(te==null||te.length===0||M!==te)continue;x=k.REF}else x=this._getNewRangeByMoveParam(X,n,a,l);x!=null&&(S[R]={...T,token:x},E=!0,y.push(R))}if(!E)return!0;const D=this._updateRefOffset(S,y,g,b);d.setValue(m,f,{f:`=${VE(D)}`,x:g,y:b,si:C})}),i[a]&&(i[a][l]=d.getData())}}return{newFormulaData:i,refRanges:o}}_getNewRangeByMoveParam(t,e,n,r){const{type:i,unitId:o,sheetId:a,range:s,from:u,to:l}=e,{range:c,sheetId:d,unitId:m,sheetName:f,refOffsetX:h,refOffsetY:p}=t;if(!this._checkIsSameUnitAndSheet(o,a,n,r,m,d))return;const v=ht.moveOffset(c,h,p);let g=null;if(i===0){if(u==null||l==null)return;const b=this._checkMoveEdge(v,u),C=ht.getIntersects(v,u);if(C==null)return;const S=lV({id:Wn.MoveRangeCommandId,params:{toRange:l,fromRange:u}},C),E=xo(S,C);if(E==null)return k.REF;g=this._getMoveNewRange(b,E,u,l,v,C)}else if(i===1){if(u==null||l==null)return;const b=this._checkMoveEdge(v,u),C=ht.getIntersects(v,u);if(C==null)return;const S=iy({id:Wn.MoveRowsCommandId,params:{toRange:l,fromRange:u}},C),E=xo(S,C);if(E==null)return k.REF;g=this._getMoveNewRange(b,E,u,l,v,C)}else if(i===2){if(u==null||l==null)return;const b=this._checkMoveEdge(v,u),C=ht.getIntersects(v,u);if(C==null)return;const S=oy({id:Wn.MoveColsCommandId,params:{toRange:l,fromRange:u}},C),E=xo(S,C);if(E==null)return k.REF;g=this._getMoveNewRange(b,E,u,l,v,C)}if(s!=null){if(i===3){const b=mV({id:Wn.InsertRowCommandId,params:{range:s,unitId:"",subUnitId:"",direction:ye.DOWN}},v),C=xo(b,v);if(C==null)return;g={...v,...C}}else if(i===4){const b=fV({id:Wn.InsertColCommandId,params:{range:s,unitId:"",subUnitId:"",direction:ye.RIGHT}},v),C=xo(b,v);if(C==null)return;g={...v,...C}}else if(i===5){const b=dV({id:Wn.RemoveRowCommandId,params:{range:s}},v),C=xo(b,v);if(C==null)return k.REF;g={...v,...C}}else if(i===6){const b=cV({id:Wn.RemoveColCommandId,params:{range:s}},v),C=xo(b,v);if(C==null)return k.REF;g={...v,...C}}else if(i===7){const b=gV({id:Wn.DeleteRangeMoveLeftCommandId,params:{range:s}},v),C=xo(b,v);if(C==null)return k.REF;g={...v,...C}}else if(i===8){const b=vV({id:Wn.DeleteRangeMoveUpCommandId,params:{range:s}},v),C=xo(b,v);if(C==null)return k.REF;g={...v,...C}}else if(i===9){const b=hV({id:Wn.InsertRangeMoveDownCommandId,params:{range:s}},v),C=xo(b,v);if(C==null)return;g={...v,...C}}else if(i===10){const b=pV({id:Wn.InsertRangeMoveRightCommandId,params:{range:s}},v),C=xo(b,v);if(C==null)return;g={...v,...C}}}if(g!=null)return Y6({range:g,sheetName:f,unitId:m})}_checkIsSameUnitAndSheet(t,e,n,r,i,o){if((i==null||i.length===0)&&(o==null||o.length===0)){if(t===n&&e===r)return!0}else if((t===i||i==null||i.length===0)&&e===o)return!0;return!1}_updateRefOffset(t,e,n=0,r=0){const i=[];for(let o=0,a=t.length;o<a;o++){const s=t[o];if(typeof s=="string"||s.nodeType!==ni.REFERENCE||e.includes(o)){i.push(s);continue}const{token:u}=s,l=Ms(u),{range:c,sheetName:d,unitId:m}=l,f=ht.moveOffset(c,n,r);i.push({...s,token:Y6({range:f,unitId:m,sheetName:d})})}return i}_checkMoveEdge(t,e){const{startRow:n,startColumn:r,endRow:i,endColumn:o}=t,{startRow:a,startColumn:s,endRow:u,endColumn:l}=e;if(n>=a&&i<=u&&r>=s&&o<=l)return 4;if(r>=s&&o<=l&&n>=a&&n<=u&&i>u)return 0;if(r>=s&&o<=l&&i>=a&&i<=u&&n<a)return 1;if(n>=a&&i<=u&&r>=s&&r<=l&&o>l)return 2;if(n>=a&&i<=u&&o>=s&&o<=l&&r<s)return 3}_getMoveNewRange(t,e,n,r,i,o){const{startRow:a,endRow:s,startColumn:u,endColumn:l}=e,{startRow:c,startColumn:d,endRow:m,endColumn:f,rangeType:h=ct.NORMAL}=n,{startRow:p,startColumn:v,endRow:g,endColumn:b}=r,{startRow:C,endRow:S,startColumn:E,endColumn:y}=o,{startRow:D,endRow:R,startColumn:I,endColumn:T}=i,P={...i};if(t===0)if(u===I&&l===T)if(a<D)P.startRow=a;else if(s<R)P.startRow=a;else if(s>=R&&p<=R)P.startRow=m+1,P.endRow=s;else if(p>R)P.endRow-=m+1-D;else return;else return;else if(t===1)if(u===I&&l===T)if(s>R)P.endRow=s;else if(a>D)P.endRow=s;else if(a<=D&&g>=D)P.endRow=c+1,P.startRow=a;else if(g<D)P.startRow+=R-c+1;else return;else return;else if(t===2)if(a===D&&s===R)if(u<I)P.startColumn=u;else if(l<T)P.startColumn=u;else if(l>=T&&v<=T)P.startColumn=f+1,P.endColumn=l;else if(v>T)P.endColumn-=f+1-I;else return;else return;else if(t===3)if(a===D&&s===R)if(l>T)P.endColumn=l;else if(u>I)P.endColumn=l;else if(u<=I&&b>=I)P.endColumn=d+1,P.startColumn=u;else if(b<I)P.startColumn+=T-d+1;else return;else return;else t===4?(P.startRow=a,P.startColumn=u,P.endRow=s,P.endColumn=l):d<=I&&f>=T?p>R?P.endRow-=m-c+1:g<D&&(P.startRow+=m-c+1):c<=D&&m>=R?v>T?P.endColumn-=f-d+1:b<I&&(P.startColumn+=f-d+1):((v<=y+1&&b>=T||v<=I&&b>=E-1)&&p<=D&&g>=R||(p<=S+1&&g>=R||p<=D&&g>=C-1)&&v<=I&&b>=T)&&(P.startRow=a,P.startColumn=u,P.endRow=s,P.endColumn=l);return P}_getCurrentSheetInfo(){const t=this._currentUniverService.getCurrentUniverSheetInstance(),e=t.getUnitId(),n=t.getActiveSheet().getSheetId();return{unitId:e,sheetId:n}}};vh=lYe([yt(ot.Ready,vh),Wl(0,ae),Wl(1,se),Wl(2,K(E1)),Wl(3,K(Ai)),Wl(4,K(In)),Wl(5,K(dt)),Wl(6,K(wn))],vh);const cYe={},dYe={BETADIST:{description:"返回 beta 累积分布函数",abstract:"返回 beta 累积分布函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/betadist-%E5%87%BD%E6%95%B0-49f1b9a9-a5da-470f-8077-5f1730b5fd47"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BETAINV:{description:"返回指定 beta 分布的累积分布函数的反函数",abstract:"返回指定 beta 分布的累积分布函数的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/betainv-%E5%87%BD%E6%95%B0-8b914ade-b902-43c1-ac9c-c05c54f10d6c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOMDIST:{description:"返回一元二项式分布的概率",abstract:"返回一元二项式分布的概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/binomdist-%E5%87%BD%E6%95%B0-506a663e-c4ca-428d-b9a8-05583d68789c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHIDIST:{description:"返回 χ2 分布的单尾概率",abstract:"返回 χ2 分布的单尾概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chidist-%E5%87%BD%E6%95%B0-c90d0fbc-5b56-4f5f-ab57-34af1bf6897e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHIINV:{description:"返回 χ2 分布的单尾概率的反函数",abstract:"返回 χ2 分布的单尾概率的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chiinv-%E5%87%BD%E6%95%B0-cfbea3f6-6e4f-40c9-a87f-20472e0512af"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHITEST:{description:"返回独立性检验值",abstract:"返回独立性检验值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chitest-%E5%87%BD%E6%95%B0-981ff871-b694-4134-848e-38ec704577ac"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONFIDENCE:{description:"返回总体平均值的置信区间",abstract:"返回总体平均值的置信区间",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/confidence-%E5%87%BD%E6%95%B0-75ccc007-f77c-4343-bc14-673642091ad6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COVAR:{description:"返回协方差（成对偏差乘积的平均值）",abstract:"返回协方差（成对偏差乘积的平均值）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/covar-%E5%87%BD%E6%95%B0-50479552-2c03-4daf-bd71-a5ab88b2db03"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CRITBINOM:{description:"返回使累积二项式分布小于或等于临界值的最小值",abstract:"返回使累积二项式分布小于或等于临界值的最小值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/critbinom-%E5%87%BD%E6%95%B0-eb6b871d-796b-4d21-b69b-e4350d5f407b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXPONDIST:{description:"返回指数分布",abstract:"返回指数分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/expondist-%E5%87%BD%E6%95%B0-68ab45fd-cd6d-4887-9770-9357eb8ee06a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FDIST:{description:"返回 F 概率分布",abstract:"返回 F 概率分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/fdist-%E5%87%BD%E6%95%B0-ecf76fba-b3f1-4e7d-a57e-6a5b7460b786"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FINV:{description:"返回 F 概率分布的反函数",abstract:"返回 F 概率分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/finv-%E5%87%BD%E6%95%B0-4d46c97c-c368-4852-bc15-41e8e31140b1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FTEST:{description:"返回 F 检验的结果",abstract:"返回 F 检验的结果",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ftest-%E5%87%BD%E6%95%B0-4c9e1202-53fe-428c-a737-976f6fc3f9fd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMADIST:{description:"返回 γ 分布",abstract:"返回 γ 分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gammadist-%E5%87%BD%E6%95%B0-7327c94d-0f05-4511-83df-1dd7ed23e19e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMAINV:{description:"返回 γ 累积分布函数的反函数",abstract:"返回 γ 累积分布函数的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gammainv-%E5%87%BD%E6%95%B0-06393558-37ab-47d0-aa63-432f99e7916d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HYPGEOMDIST:{description:"返回超几何分布",abstract:"返回超几何分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hypgeomdist-%E5%87%BD%E6%95%B0-23e37961-2871-4195-9629-d0b2c108a12e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGINV:{description:"返回对数累积分布函数的反函数",abstract:"返回对数累积分布函数的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/loginv-%E5%87%BD%E6%95%B0-0bd7631a-2725-482b-afb4-de23df77acfe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGNORMDIST:{description:"返回对数累积分布函数",abstract:"返回对数累积分布函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/lognormdist-%E5%87%BD%E6%95%B0-f8d194cb-9ee3-4034-8c75-1bdb3884100b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MODE:{description:"返回在数据集内出现次数最多的值",abstract:"返回在数据集内出现次数最多的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mode-%E5%87%BD%E6%95%B0-e45192ce-9122-4980-82ed-4bdc34973120"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NEGBINOMDIST:{description:"返回负二项式分布",abstract:"返回负二项式分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/negbinomdist-%E5%87%BD%E6%95%B0-f59b0a37-bae2-408d-b115-a315609ba714"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMDIST:{description:"返回正态累积分布",abstract:"返回正态累积分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/normdist-%E5%87%BD%E6%95%B0-126db625-c53e-4591-9a22-c9ff422d6d58"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMINV:{description:"返回正态累积分布的反函数",abstract:"返回正态累积分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/norminv-%E5%87%BD%E6%95%B0-87981ab8-2de0-4cb0-b1aa-e21d4cb879b8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMSDIST:{description:"返回标准正态累积分布",abstract:"返回标准正态累积分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/normsdist-%E5%87%BD%E6%95%B0-463369ea-0345-445d-802a-4ff0d6ce7cac"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORMSINV:{description:"返回标准正态累积分布函数的反函数",abstract:"返回标准正态累积分布函数的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/normsinv-%E5%87%BD%E6%95%B0-8d1bce66-8e4d-4f3b-967c-30eed61f019d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTILE:{description:"返回区域中数值的第 k 个百分点的值",abstract:"返回区域中数值的第 k 个百分点的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/percentile-%E5%87%BD%E6%95%B0-91b43a53-543c-4708-93de-d626debdddca"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTRANK:{description:"返回数据集中值的百分比排位",abstract:"返回数据集中值的百分比排位",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/percentrank-%E5%87%BD%E6%95%B0-f1b5836c-9619-4847-9fc9-080ec9024442"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},POISSON:{description:"返回泊松分布",abstract:"返回泊松分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/poisson-%E5%87%BD%E6%95%B0-d81f7294-9d7c-4f75-bc23-80aa8624173a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUARTILE:{description:"返回一组数据的四分位点",abstract:"返回一组数据的四分位点",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/quartile-%E5%87%BD%E6%95%B0-93cf8f62-60cd-4fdb-8a92-8451041e1a2a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANK:{description:"返回一列数字的数字排位",abstract:"返回一列数字的数字排位",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rank-%E5%87%BD%E6%95%B0-6a2fc49d-1831-4a03-9d8c-c279cf99f723"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEV:{description:"基于样本估算标准偏差",abstract:"基于样本估算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/stdev-%E5%87%BD%E6%95%B0-51fecaaa-231e-4bbb-9230-33650a72c9b0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEVP:{description:"基于整个样本总体计算标准偏差",abstract:"基于整个样本总体计算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/stdevp-%E5%87%BD%E6%95%B0-1f7c1c88-1bec-4422-8242-e9f7dc8bb195"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TDIST:{description:"返回学生 t-分布",abstract:"返回学生 t-分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tdist-%E5%87%BD%E6%95%B0-630a7695-4021-4853-9468-4a1f9dcdd192"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TINV:{description:"返回学生 t-分布的反函数",abstract:"返回学生 t-分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tinv-%E5%87%BD%E6%95%B0-a7c85b9d-90f5-41fe-9ca5-1cd2f3e1ed7c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TTEST:{description:"返回与学生 t-检验相关的概率",abstract:"返回与学生 t-检验相关的概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ttest-%E5%87%BD%E6%95%B0-1696ffc1-4811-40fd-9d13-a0eaad83c7ae"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VAR:{description:"基于样本估算方差",abstract:"基于样本估算方差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/var-%E5%87%BD%E6%95%B0-1f2b7ab2-954d-4e17-ba2c-9e58b15a7da2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VARP:{description:"计算基于样本总体的方差",abstract:"计算基于样本总体的方差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/varp-%E5%87%BD%E6%95%B0-26a541c4-ecee-464d-a731-bd4c575b1a6b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEIBULL:{description:"返回 Weibull 分布",abstract:"返回 Weibull 分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/weibull-%E5%87%BD%E6%95%B0-b83dc2c6-260b-4754-bef2-633196f6fdcc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ZTEST:{description:"返回 z 检验的单尾概率值",abstract:"返回 z 检验的单尾概率值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ztest-%E5%87%BD%E6%95%B0-8f33be8a-6bd6-4ecc-8e3a-d9a4420c4a6a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},mYe={CUBEKPIMEMBER:{description:"返回重要性能指示器 (KPI) 属性，并在单元格中显示 KPI 名称。 KPI 是一种用于监控单位绩效的可计量度量值，如每月总利润或季度员工调整。",abstract:"返回重要性能指示器 (KPI) 属性，并在单元格中显示 KPI 名称。 KPI 是一种用于监控单位绩效的可计量度量值，如每月总利润或季度员工调整。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cubekpimember-%E5%87%BD%E6%95%B0-744608bf-2c62-42cd-b67a-a56109f4b03b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBEMEMBER:{description:"返回多维数据集中的成员或元组。 用于验证多维数据集内是否存在成员或元组。",abstract:"返回多维数据集中的成员或元组。 用于验证多维数据集内是否存在成员或元组。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cubemember-%E5%87%BD%E6%95%B0-0f6a15b9-2c18-4819-ae89-e1b5c8b398ad"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBEMEMBERPROPERTY:{description:"返回多维数据集中成员属性的值。 用于验证多维数据集内是否存在某个成员名并返回此成员的指定属性。",abstract:"返回多维数据集中成员属性的值。 用于验证多维数据集内是否存在某个成员名并返回此成员的指定属性。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cubememberproperty-%E5%87%BD%E6%95%B0-001e57d6-b35a-49e5-abcd-05ff599e8951"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBERANKEDMEMBER:{description:"返回集合中的第 n 个或排在一定名次的成员。 用来返回集合中的一个或多个元素，如业绩最好的销售人员或前 10 名的学生。",abstract:"返回集合中的第 n 个或排在一定名次的成员。 用来返回集合中的一个或多个元素，如业绩最好的销售人员或前 10 名的学生。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cuberankedmember-%E5%87%BD%E6%95%B0-07efecde-e669-4075-b4bf-6b40df2dc4b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBESET:{description:"定义成员或元组的计算集。方法是向服务器上的多维数据集发送一个集合表达式，此表达式创建集合，并随后将该集合返回到 Microsoft Excel。",abstract:"定义成员或元组的计算集。方法是向服务器上的多维数据集发送一个集合表达式，此表达式创建集合，并随后将该集合返回到 Microsoft Excel。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cubeset-%E5%87%BD%E6%95%B0-5b2146bd-62d6-4d04-9d8f-670e993ee1d9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBESETCOUNT:{description:"返回集合中的项目数。",abstract:"返回集合中的项目数。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cubesetcount-%E5%87%BD%E6%95%B0-c4c2a438-c1ff-4061-80fe-982f2d705286"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUBEVALUE:{description:"从多维数据集中返回汇总值。",abstract:"从多维数据集中返回汇总值。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cubevalue-%E5%87%BD%E6%95%B0-8733da24-26d1-4e34-9b3a-84a8f00dcbe0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},fYe={DAVERAGE:{description:"返回所选数据库条目的平均值",abstract:"返回所选数据库条目的平均值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/daverage-%E5%87%BD%E6%95%B0-a6a2d5ac-4b4b-48cd-a1d8-7b37834e5aee"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DCOUNT:{description:"计算数据库中包含数字的单元格的数量",abstract:"计算数据库中包含数字的单元格的数量",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dcount-%E5%87%BD%E6%95%B0-c1fc7b93-fb0d-4d8d-97db-8d5f076eaeb1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DCOUNTA:{description:"计算数据库中非空单元格的数量",abstract:"计算数据库中非空单元格的数量",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dcounta-%E5%87%BD%E6%95%B0-00232a6d-5a66-4a01-a25b-c1653fda1244"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DGET:{description:"从数据库提取符合指定条件的单个记录",abstract:"从数据库提取符合指定条件的单个记录",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dget-%E5%87%BD%E6%95%B0-455568bf-4eef-45f7-90f0-ec250d00892e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DMAX:{description:"返回所选数据库条目的最大值",abstract:"返回所选数据库条目的最大值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dmax-%E5%87%BD%E6%95%B0-f4e8209d-8958-4c3d-a1ee-6351665d41c2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DMIN:{description:"返回所选数据库条目的最小值",abstract:"返回所选数据库条目的最小值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dmin-%E5%87%BD%E6%95%B0-4ae6f1d9-1f26-40f1-a783-6dc3680192a3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DPRODUCT:{description:"将数据库中符合条件的记录的特定字段中的值相乘",abstract:"将数据库中符合条件的记录的特定字段中的值相乘",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dproduct-%E5%87%BD%E6%95%B0-4f96b13e-d49c-47a7-b769-22f6d017cb31"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DSTDEV:{description:"基于所选数据库条目的样本估算标准偏差",abstract:"基于所选数据库条目的样本估算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dstdev-%E5%87%BD%E6%95%B0-026b8c73-616d-4b5e-b072-241871c4ab96"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DSTDEVP:{description:"基于所选数据库条目的样本总体计算标准偏差",abstract:"基于所选数据库条目的样本总体计算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dstdevp-%E5%87%BD%E6%95%B0-04b78995-da03-4813-bbd9-d74fd0f5d94b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DSUM:{description:"对数据库中符合条件的记录的字段列中的数字求和",abstract:"对数据库中符合条件的记录的字段列中的数字求和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dsum-%E5%87%BD%E6%95%B0-53181285-0c4b-4f5a-aaa3-529a322be41b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DVAR:{description:"基于所选数据库条目的样本估算方差",abstract:"基于所选数据库条目的样本估算方差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dvar-%E5%87%BD%E6%95%B0-d6747ca9-99c7-48bb-996e-9d7af00f3ed1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DVARP:{description:"基于所选数据库条目的样本总体计算方差",abstract:"基于所选数据库条目的样本总体计算方差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dvarp-%E5%87%BD%E6%95%B0-eb0ba387-9cb7-45c8-81e9-0394912502fc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},hYe={DATE:{description:"采用三个单独的值并将它们合并为一个日期。",abstract:"返回特定日期的序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/date-%E5%87%BD%E6%95%B0-e36c0c8c-4104-49da-ab83-82328b832349"}],functionParameter:{year:{name:"年",detail:"可以包含 1 到 4 位数字。 Excel 根据计算机使用的日期系统解释 year 参数。 默认情况下，Univer 使用 1900 日期系统，这意味着第一个日期是 1900 年 1 月 1 日。"},month:{name:"月",detail:"一个正整数或负整数，表示一年中从 1 月至 12 月（一月到十二月）的各个月。"},day:{name:"日",detail:"一个正整数或负整数，表示一月中从 1 日到 31 日的各天。"}}},DATEDIF:{description:"计算两个日期之间的天数、月数或年数。 此函数在用于计算年龄的公式中很有用。",abstract:"计算两个日期之间的天数、月数或年数。 此函数在用于计算年龄的公式中很有用。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/datedif-%E5%87%BD%E6%95%B0-25dba1a4-2812-480b-84dd-8b32a451b35c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DATEVALUE:{description:"将文本格式的日期转换为序列号",abstract:"将文本格式的日期转换为序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/datevalue-%E5%87%BD%E6%95%B0-df8b07d4-7761-4a93-bc33-b7471bbff252"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DAY:{description:"返回以序列数表示的某日期的天数。天数是介于 1 到 31 之间的整数。",abstract:"将序列号转换为月份日期",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/day-%E5%87%BD%E6%95%B0-8a7d1cbb-6c7d-4ba1-8aea-25c134d03101"}],functionParameter:{serialNumber:{name:"日期序列号",detail:"要查找的日期。 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。"}}},DAYS:{description:"返回两个日期之间的天数",abstract:"返回两个日期之间的天数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/days-%E5%87%BD%E6%95%B0-57740535-d549-4395-8728-0f07bff0b9df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DAYS360:{description:"以一年 360 天为基准计算两个日期间的天数",abstract:"以一年 360 天为基准计算两个日期间的天数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/days360-%E5%87%BD%E6%95%B0-b9a509fd-49ef-407e-94df-0cbda5718c2a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EDATE:{description:"返回表示某个日期的序列号，该日期与指定日期 (start_date) 相隔（之前或之后）指示的月份数。 使用函数 EDATE 可以计算与发行日处于一月中同一天的到期日的日期。",abstract:"返回用于表示开始日期之前或之后月数的日期的序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/edate-%E5%87%BD%E6%95%B0-3c920eb2-6e66-44e7-a1f5-753ae47ee4f5"}],functionParameter:{startDate:{name:"开始日期",detail:"一个代表开始日期的日期。 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。"},months:{name:"月份",detail:"Start Date 之前或之后的月份数。 Months 为正值将生成未来日期；为负值将生成过去日期。"}}},EOMONTH:{description:"返回指定月数之前或之后的月份的最后一天的序列号",abstract:"返回指定月数之前或之后的月份的最后一天的序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/eomonth-%E5%87%BD%E6%95%B0-7314ffa1-2bc9-4005-9d66-f49db127d628"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HOUR:{description:"将序列号转换为小时",abstract:"将序列号转换为小时",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hour-%E5%87%BD%E6%95%B0-a3afa879-86cb-4339-b1b5-2dd2d7310ac7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISOWEEKNUM:{description:"返回给定日期在全年中的 ISO 周数",abstract:"返回给定日期在全年中的 ISO 周数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/isoweeknum-%E5%87%BD%E6%95%B0-1c2d0afe-d25b-4ab1-8894-8d0520e90e0e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MINUTE:{description:"将序列号转换为分钟",abstract:"将序列号转换为分钟",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/minute-%E5%87%BD%E6%95%B0-af728df0-05c4-4b07-9eed-a84801a60589"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MONTH:{description:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。",abstract:"将序列号转换为月",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/month-%E5%87%BD%E6%95%B0-579a2881-199b-48b2-ab90-ddba0eba86e8"}],functionParameter:{serialNumber:{name:"日期序列号",detail:"要查找的月份的日期。 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。"}}},NETWORKDAYS:{description:"返回两个日期间的完整工作日的天数",abstract:"返回两个日期间的完整工作日的天数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/networkdays-%E5%87%BD%E6%95%B0-48e717bf-a7a3-495f-969e-5005e3eb18e7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NETWORKDAYS_INTL:{description:"返回两个日期之间的完整工作日的天数（使用参数指明周末有几天并指明是哪几天）",abstract:"返回两个日期之间的完整工作日的天数（使用参数指明周末有几天并指明是哪几天）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/networkdays-intl-%E5%87%BD%E6%95%B0-a9b26239-4f20-46a1-9ab8-4e925bfd5e28"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NOW:{description:"返回当前日期和时间的序列号",abstract:"返回当前日期和时间的序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/now-%E5%87%BD%E6%95%B0-3337fd29-145a-4347-b2e6-20c904739c46"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SECOND:{description:"将序列号转换为秒",abstract:"将序列号转换为秒",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/second-%E5%87%BD%E6%95%B0-740d1cfc-553c-4099-b668-80eaa24e8af1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TIME:{description:"返回特定时间的序列号",abstract:"返回特定时间的序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/time-%E5%87%BD%E6%95%B0-9a5aff99-8f7d-4611-845e-747d0b8d5457"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TIMEVALUE:{description:"将文本格式的时间转换为序列号",abstract:"将文本格式的时间转换为序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/timevalue-%E5%87%BD%E6%95%B0-0b615c12-33d8-4431-bf3d-f3eb6d186645"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TODAY:{description:"返回今天日期的序列号",abstract:"返回今天日期的序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/today-%E5%87%BD%E6%95%B0-5eb3078d-a82c-4736-8930-2f51a028fdd9"}],functionParameter:{}},WEEKDAY:{description:"将序列号转换为星期日期",abstract:"将序列号转换为星期日期",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/weekday-%E5%87%BD%E6%95%B0-60e44483-2ed1-439f-8bd0-e404c190949a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEEKNUM:{description:"将序列号转换为代表该星期为一年中第几周的数字",abstract:"将序列号转换为代表该星期为一年中第几周的数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/weeknum-%E5%87%BD%E6%95%B0-e5c43a03-b4ab-426c-b411-b18c13c75340"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WORKDAY:{description:"返回指定的若干个工作日之前或之后的日期的序列号",abstract:"返回指定的若干个工作日之前或之后的日期的序列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/workday-%E5%87%BD%E6%95%B0-f764a5b7-05fc-4494-9486-60d494efbf33"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WORKDAY_INTL:{description:"返回日期在指定的工作日天数之前或之后的序列号（使用参数指明周末有几天并指明是哪几天）",abstract:"返回日期在指定的工作日天数之前或之后的序列号（使用参数指明周末有几天并指明是哪几天）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/workday-intl-%E5%87%BD%E6%95%B0-a378391c-9ba7-4678-8a39-39611a9bf81d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YEAR:{description:"返回对应于某个日期的年份。 Year 作为 1900 - 9999 之间的整数返回。",abstract:"将序列号转换为年",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/year-%E5%87%BD%E6%95%B0-c64f017a-1354-490d-981f-578e8ec8d3b9"}],functionParameter:{serialNumber:{name:"日期序列号",detail:"要查找的年份的日期。 应使用 DATE 函数输入日期，或者将日期作为其他公式或函数的结果输入。 例如，使用函数 DATE(2008,5,23) 输入 2008 年 5 月 23 日。 如果日期以文本形式输入，则会出现问题。"}}},YEARFRAC:{description:"返回代表 start_date 和 end_date 之间整天天数的年分数",abstract:"返回代表 start_date 和 end_date 之间整天天数的年分数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/yearfrac-%E5%87%BD%E6%95%B0-3844141e-c76d-4143-82b6-208454ddc6a8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},pYe={BESSELI:{description:"返回修正的贝赛耳函数 In(x)",abstract:"返回修正的贝赛耳函数 In(x)",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/besseli-%E5%87%BD%E6%95%B0-8d33855c-9a8d-444b-98e0-852267b1c0df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BESSELJ:{description:"返回贝赛耳函数 Jn(x)",abstract:"返回贝赛耳函数 Jn(x)",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/besselj-%E5%87%BD%E6%95%B0-839cb181-48de-408b-9d80-bd02982d94f7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BESSELK:{description:"返回修正的贝赛耳函数 Kn(x)",abstract:"返回修正的贝赛耳函数 Kn(x)",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/besselk-%E5%87%BD%E6%95%B0-606d11bc-06d3-4d53-9ecb-2803e2b90b70"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BESSELY:{description:"返回贝赛耳函数 Yn(x)",abstract:"返回贝赛耳函数 Yn(x)",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bessely-%E5%87%BD%E6%95%B0-f3a356b3-da89-42c3-8974-2da54d6353a2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BIN2DEC:{description:"将二进制数转换为十进制数",abstract:"将二进制数转换为十进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bin2dec-%E5%87%BD%E6%95%B0-63905b57-b3a0-453d-99f4-647bb519cd6c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BIN2HEX:{description:"将二进制数转换为十六进制数",abstract:"将二进制数转换为十六进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bin2hex-%E5%87%BD%E6%95%B0-0375e507-f5e5-4077-9af8-28d84f9f41cc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BIN2OCT:{description:"将二进制数转换为八进制数",abstract:"将二进制数转换为八进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bin2oct-%E5%87%BD%E6%95%B0-0a4e01ba-ac8d-4158-9b29-16c25c4c23fd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITAND:{description:"返回两个数的“按位与”",abstract:"返回两个数的“按位与”",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bitand-%E5%87%BD%E6%95%B0-8a2be3d7-91c3-4b48-9517-64548008563a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITLSHIFT:{description:"返回左移 shift_amount 位的计算值接收数",abstract:"返回左移 shift_amount 位的计算值接收数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bitlshift-%E5%87%BD%E6%95%B0-c55bb27e-cacd-4c7c-b258-d80861a03c9c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITOR:{description:"返回两个数的“按位或”",abstract:"返回两个数的“按位或”",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bitor-%E5%87%BD%E6%95%B0-f6ead5c8-5b98-4c9e-9053-8ad5234919b2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITRSHIFT:{description:"返回右移 shift_amount 位的计算值接收数",abstract:"返回右移 shift_amount 位的计算值接收数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bitrshift-%E5%87%BD%E6%95%B0-274d6996-f42c-4743-abdb-4ff95351222c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BITXOR:{description:"返回两个数的按位“异或”",abstract:"返回两个数的按位“异或”",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bitxor-%E5%87%BD%E6%95%B0-c81306a1-03f9-4e89-85ac-b86c3cba10e4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COMPLEX:{description:"将实系数和虚系数转换为复数",abstract:"将实系数和虚系数转换为复数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/complex-%E5%87%BD%E6%95%B0-f0b8f3a9-51cc-4d6d-86fb-3a9362fa4128"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONVERT:{description:"将数字从一种度量系统转换为另一种度量系统",abstract:"将数字从一种度量系统转换为另一种度量系统",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/convert-%E5%87%BD%E6%95%B0-d785bef1-808e-4aac-bdcd-666c810f9af2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEC2BIN:{description:"将十进制数转换为二进制数",abstract:"将十进制数转换为二进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dec2bin-%E5%87%BD%E6%95%B0-0f63dd0e-5d1a-42d8-b511-5bf5c6d43838"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEC2HEX:{description:"将十进制数转换为十六进制数",abstract:"将十进制数转换为十六进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dec2hex-%E5%87%BD%E6%95%B0-6344ee8b-b6b5-4c6a-a672-f64666704619"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEC2OCT:{description:"将十进制数转换为八进制数",abstract:"将十进制数转换为八进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dec2oct-%E5%87%BD%E6%95%B0-c9d835ca-20b7-40c4-8a9e-d3be351ce00f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DELTA:{description:"检验两个值是否相等",abstract:"检验两个值是否相等",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/delta-%E5%87%BD%E6%95%B0-2f763672-c959-4e07-ac33-fe03220ba432"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERF:{description:"返回误差函数",abstract:"返回误差函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/erf-%E5%87%BD%E6%95%B0-c53c7e7b-5482-4b6c-883e-56df3c9af349"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERF_PRECISE:{description:"返回误差函数",abstract:"返回误差函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/erf-precise-%E5%87%BD%E6%95%B0-9a349593-705c-4278-9a98-e4122831a8e0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERFC:{description:"返回互补误差函数",abstract:"返回互补误差函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/erfc-%E5%87%BD%E6%95%B0-736e0318-70ba-4e8b-8d08-461fe68b71b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERFC_PRECISE:{description:"返回从 x 到无穷大积分的互补 ERF 函数",abstract:"返回从 x 到无穷大积分的互补 ERF 函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/erfc-precise-%E5%87%BD%E6%95%B0-e90e6bab-f45e-45df-b2ac-cd2eb4d4a273"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GESTEP:{description:"检验数字是否大于阈值",abstract:"检验数字是否大于阈值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gestep-%E5%87%BD%E6%95%B0-f37e7d2a-41da-4129-be95-640883fca9df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HEX2BIN:{description:"将十六进制数转换为二进制数",abstract:"将十六进制数转换为二进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hex2bin-%E5%87%BD%E6%95%B0-a13aafaa-5737-4920-8424-643e581828c1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HEX2DEC:{description:"将十六进制数转换为十进制数",abstract:"将十六进制数转换为十进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hex2dec-%E5%87%BD%E6%95%B0-8c8c3155-9f37-45a5-a3ee-ee5379ef106e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HEX2OCT:{description:"将十六进制数转换为八进制数",abstract:"将十六进制数转换为八进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hex2oct-%E5%87%BD%E6%95%B0-54d52808-5d19-4bd0-8a63-1096a5d11912"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMABS:{description:"返回复数的绝对值（模数）",abstract:"返回复数的绝对值（模数）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imabs-%E5%87%BD%E6%95%B0-b31e73c6-d90c-4062-90bc-8eb351d765a1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMAGINARY:{description:"返回复数的虚系数",abstract:"返回复数的虚系数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imaginary-%E5%87%BD%E6%95%B0-dd5952fd-473d-44d9-95a1-9a17b23e428a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMARGUMENT:{description:"返回参数 theta，即以弧度表示的角",abstract:"返回参数 theta，即以弧度表示的角",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imargument-%E5%87%BD%E6%95%B0-eed37ec1-23b3-4f59-b9f3-d340358a034a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCONJUGATE:{description:"返回复数的共轭复数",abstract:"返回复数的共轭复数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imconjugate-%E5%87%BD%E6%95%B0-2e2fc1ea-f32b-4f9b-9de6-233853bafd42"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCOS:{description:"返回复数的余弦",abstract:"返回复数的余弦",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imcos-%E5%87%BD%E6%95%B0-dad75277-f592-4a6b-ad6c-be93a808a53c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCOSH:{description:"返回复数的双曲余弦值",abstract:"返回复数的双曲余弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imcosh-%E5%87%BD%E6%95%B0-053e4ddb-4122-458b-be9a-457c405e90ff"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCOT:{description:"返回复数的余弦值",abstract:"返回复数的余弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imcot-%E5%87%BD%E6%95%B0-dc6a3607-d26a-4d06-8b41-8931da36442c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCSC:{description:"返回复数的余割值",abstract:"返回复数的余割值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imcsc-%E5%87%BD%E6%95%B0-9e158d8f-2ddf-46cd-9b1d-98e29904a323"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMCSCH:{description:"返回复数的双曲余割值",abstract:"返回复数的双曲余割值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imcsch-%E5%87%BD%E6%95%B0-c0ae4f54-5f09-4fef-8da0-dc33ea2c5ca9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMDIV:{description:"返回两个复数的商",abstract:"返回两个复数的商",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imdiv-%E5%87%BD%E6%95%B0-a505aff7-af8a-4451-8142-77ec3d74d83f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMEXP:{description:"返回复数的指数",abstract:"返回复数的指数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imexp-%E5%87%BD%E6%95%B0-c6f8da1f-e024-4c0c-b802-a60e7147a95f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMLN:{description:"返回复数的自然对数",abstract:"返回复数的自然对数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imln-%E5%87%BD%E6%95%B0-32b98bcf-8b81-437c-a636-6fb3aad509d8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMLOG10:{description:"返回复数的以 10 为底的对数",abstract:"返回复数的以 10 为底的对数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imlog10-%E5%87%BD%E6%95%B0-58200fca-e2a2-4271-8a98-ccd4360213a5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMLOG2:{description:"返回复数的以 2 为底的对数",abstract:"返回复数的以 2 为底的对数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imlog2-%E5%87%BD%E6%95%B0-152e13b4-bc79-486c-a243-e6a676878c51"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMPOWER:{description:"返回复数的整数幂",abstract:"返回复数的整数幂",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/impower-%E5%87%BD%E6%95%B0-210fd2f5-f8ff-4c6a-9d60-30e34fbdef39"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMPRODUCT:{description:"返回从 2 到 255 的复数的乘积",abstract:"返回从 2 到 255 的复数的乘积",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/improduct-%E5%87%BD%E6%95%B0-2fb8651a-a4f2-444f-975e-8ba7aab3a5ba"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMREAL:{description:"返回复数的实系数",abstract:"返回复数的实系数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imreal-%E5%87%BD%E6%95%B0-d12bc4c0-25d0-4bb3-a25f-ece1938bf366"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSEC:{description:"返回复数的正切值",abstract:"返回复数的正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imsec-%E5%87%BD%E6%95%B0-6df11132-4411-4df4-a3dc-1f17372459e0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSECH:{description:"返回复数的双曲正切值",abstract:"返回复数的双曲正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imsech-%E5%87%BD%E6%95%B0-f250304f-788b-4505-954e-eb01fa50903b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSIN:{description:"返回复数的正弦",abstract:"返回复数的正弦",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imsin-%E5%87%BD%E6%95%B0-1ab02a39-a721-48de-82ef-f52bf37859f6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSINH:{description:"返回复数的双曲正弦值",abstract:"返回复数的双曲正弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imsinh-%E5%87%BD%E6%95%B0-dfb9ec9e-8783-4985-8c42-b028e9e8da3d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSQRT:{description:"返回复数的平方根",abstract:"返回复数的平方根",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imsqrt-%E5%87%BD%E6%95%B0-e1753f80-ba11-4664-a10e-e17368396b70"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSUB:{description:"返回两个复数的差",abstract:"返回两个复数的差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imsub-%E5%87%BD%E6%95%B0-2e404b4d-4935-4e85-9f52-cb08b9a45054"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMSUM:{description:"返回多个复数的和",abstract:"返回多个复数的和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imsum-%E5%87%BD%E6%95%B0-81542999-5f1c-4da6-9ffe-f1d7aaa9457f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMTAN:{description:"返回复数的正切值",abstract:"返回复数的正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/imtan-%E5%87%BD%E6%95%B0-8478f45d-610a-43cf-8544-9fc0b553a132"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OCT2BIN:{description:"将八进制数转换为二进制数",abstract:"将八进制数转换为二进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/oct2bin-%E5%87%BD%E6%95%B0-55383471-3c56-4d27-9522-1a8ec646c589"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OCT2DEC:{description:"将八进制数转换为十进制数",abstract:"将八进制数转换为十进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/oct2dec-%E5%87%BD%E6%95%B0-87606014-cb98-44b2-8dbb-e48f8ced1554"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OCT2HEX:{description:"将八进制数转换为十六进制数",abstract:"将八进制数转换为十六进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/oct2hex-%E5%87%BD%E6%95%B0-912175b4-d497-41b4-a029-221f051b858f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},gYe={ACCRINT:{description:"返回定期支付利息的债券的应计利息",abstract:"返回定期支付利息的债券的应计利息",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/accrint-%E5%87%BD%E6%95%B0-fe45d089-6722-4fb3-9379-e1f911d8dc74"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ACCRINTM:{description:"返回在到期日支付利息的债券的应计利息",abstract:"返回在到期日支付利息的债券的应计利息",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/accrintm-%E5%87%BD%E6%95%B0-f62f01f9-5754-4cc4-805b-0e70199328a7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AMORDEGRC:{description:"使用折旧系数返回每个记帐期的折旧值",abstract:"使用折旧系数返回每个记帐期的折旧值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/amordegrc-%E5%87%BD%E6%95%B0-a14d0ca1-64a4-42eb-9b3d-b0dededf9e51"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AMORLINC:{description:"返回每个记帐期的折旧值",abstract:"返回每个记帐期的折旧值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/amorlinc-%E5%87%BD%E6%95%B0-7d417b45-f7f5-4dba-a0a5-3451a81079a8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPDAYBS:{description:"返回从票息期开始到结算日之间的天数",abstract:"返回从票息期开始到结算日之间的天数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/coupdaybs-%E5%87%BD%E6%95%B0-eb9a8dfb-2fb2-4c61-8e5d-690b320cf872"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPDAYS:{description:"返回包含结算日的票息期天数",abstract:"返回包含结算日的票息期天数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/coupdays-%E5%87%BD%E6%95%B0-cc64380b-315b-4e7b-950c-b30b0a76f671"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPDAYSNC:{description:"返回从结算日到下一票息支付日之间的天数",abstract:"返回从结算日到下一票息支付日之间的天数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/coupdaysnc-%E5%87%BD%E6%95%B0-5ab3f0b2-029f-4a8b-bb65-47d525eea547"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPNCD:{description:"返回结算日之后的下一个票息支付日",abstract:"返回结算日之后的下一个票息支付日",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/coupncd-%E5%87%BD%E6%95%B0-fd962fef-506b-4d9d-8590-16df5393691f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPNUM:{description:"返回结算日与到期日之间可支付的票息数",abstract:"返回结算日与到期日之间可支付的票息数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/coupnum-%E5%87%BD%E6%95%B0-a90af57b-de53-4969-9c99-dd6139db2522"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUPPCD:{description:"返回结算日之前的上一票息支付日",abstract:"返回结算日之前的上一票息支付日",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/couppcd-%E5%87%BD%E6%95%B0-2eb50473-6ee9-4052-a206-77a9a385d5b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUMIPMT:{description:"返回两个付款期之间累积支付的利息",abstract:"返回两个付款期之间累积支付的利息",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cumipmt-%E5%87%BD%E6%95%B0-61067bb0-9016-427d-b95b-1a752af0e606"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CUMPRINC:{description:"返回两个付款期之间为贷款累积支付的本金",abstract:"返回两个付款期之间为贷款累积支付的本金",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cumprinc-%E5%87%BD%E6%95%B0-94a4516d-bd65-41a1-bc16-053a6af4c04d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DB:{description:"使用固定余额递减法，返回一笔资产在给定期间内的折旧值",abstract:"使用固定余额递减法，返回一笔资产在给定期间内的折旧值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/db-%E5%87%BD%E6%95%B0-354e7d28-5f93-4ff1-8a52-eb4ee549d9d7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DDB:{description:"使用双倍余额递减法或其他指定方法，返回一笔资产在给定期间内的折旧值",abstract:"使用双倍余额递减法或其他指定方法，返回一笔资产在给定期间内的折旧值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ddb-%E5%87%BD%E6%95%B0-519a7a37-8772-4c96-85c0-ed2c209717a5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DISC:{description:"返回债券的贴现率",abstract:"返回债券的贴现率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/disc-%E5%87%BD%E6%95%B0-71fce9f3-3f05-4acf-a5a3-eac6ef4daa53"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DOLLARDE:{description:"将以分数表示的价格转换为以小数表示的价格",abstract:"将以分数表示的价格转换为以小数表示的价格",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dollarde-%E5%87%BD%E6%95%B0-db85aab0-1677-428a-9dfd-a38476693427"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DOLLARFR:{description:"将以小数表示的价格转换为以分数表示的价格",abstract:"将以小数表示的价格转换为以分数表示的价格",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dollarfr-%E5%87%BD%E6%95%B0-0835d163-3023-4a33-9824-3042c5d4f495"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DURATION:{description:"返回定期支付利息的债券的每年期限",abstract:"返回定期支付利息的债券的每年期限",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/duration-%E5%87%BD%E6%95%B0-b254ea57-eadc-4602-a86a-c8e369334038"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EFFECT:{description:"返回年有效利率",abstract:"返回年有效利率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/effect-%E5%87%BD%E6%95%B0-910d4e4c-79e2-4009-95e6-507e04f11bc4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FV:{description:"返回一笔投资的未来值",abstract:"返回一笔投资的未来值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/fv-%E5%87%BD%E6%95%B0-2eef9f44-a084-4c61-bdd8-4fe4bb1b71b3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FVSCHEDULE:{description:"返回应用一系列复利率计算的初始本金的未来值",abstract:"返回应用一系列复利率计算的初始本金的未来值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/fvschedule-%E5%87%BD%E6%95%B0-bec29522-bd87-4082-bab9-a241f3fb251d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INTRATE:{description:"返回完全投资型债券的利率",abstract:"返回完全投资型债券的利率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/intrate-%E5%87%BD%E6%95%B0-5cb34dde-a221-4cb6-b3eb-0b9e55e1316f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IPMT:{description:"返回一笔投资在给定期间内支付的利息",abstract:"返回一笔投资在给定期间内支付的利息",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ipmt-%E5%87%BD%E6%95%B0-5cce0ad6-8402-4a41-8d29-61a0b054cb6f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IRR:{description:"返回一系列现金流的内部收益率",abstract:"返回一系列现金流的内部收益率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/irr-%E5%87%BD%E6%95%B0-64925eaa-9988-495b-b290-3ad0c163c1bc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISPMT:{description:"计算特定投资期内要支付的利息",abstract:"计算特定投资期内要支付的利息",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ispmt-%E5%87%BD%E6%95%B0-fa58adb6-9d39-4ce0-8f43-75399cea56cc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MDURATION:{description:"返回假设面值为 ￥100 的有价证券的 Macauley 修正期限",abstract:"返回假设面值为 ￥100 的有价证券的 Macauley 修正期限",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mduration-%E5%87%BD%E6%95%B0-b3786a69-4f20-469a-94ad-33e5b90a763c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MIRR:{description:"返回正和负现金流以不同利率进行计算的内部收益率",abstract:"返回正和负现金流以不同利率进行计算的内部收益率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mirr-%E5%87%BD%E6%95%B0-b020f038-7492-4fb4-93c1-35c345b53524"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NOMINAL:{description:"返回年度的名义利率",abstract:"返回年度的名义利率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/nominal-%E5%87%BD%E6%95%B0-7f1ae29b-6b92-435e-b950-ad8b190ddd2b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NPER:{description:"返回投资的期数",abstract:"返回投资的期数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/nper-%E5%87%BD%E6%95%B0-240535b5-6653-4d2d-bfcf-b6a38151d815"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NPV:{description:"返回基于一系列定期的现金流和贴现率计算的投资的净现值",abstract:"返回基于一系列定期的现金流和贴现率计算的投资的净现值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/npv-%E5%87%BD%E6%95%B0-8672cb67-2576-4d07-b67b-ac28acf2a568"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDFPRICE:{description:"返回每张票面为 ￥100 且第一期为奇数的债券的现价",abstract:"返回每张票面为 ￥100 且第一期为奇数的债券的现价",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/oddfprice-%E5%87%BD%E6%95%B0-d7d664a8-34df-4233-8d2b-922bcf6a69e1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDFYIELD:{description:"返回第一期为奇数的债券的收益",abstract:"返回第一期为奇数的债券的收益",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/oddfyield-%E5%87%BD%E6%95%B0-66bc8b7b-6501-4c93-9ce3-2fd16220fe37"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDLPRICE:{description:"返回每张票面为 ￥100 且最后一期为奇数的债券的现价",abstract:"返回每张票面为 ￥100 且最后一期为奇数的债券的现价",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/oddlprice-%E5%87%BD%E6%95%B0-fb657749-d200-4902-afaf-ed5445027fc4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODDLYIELD:{description:"返回最后一期为奇数的债券的收益",abstract:"返回最后一期为奇数的债券的收益",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/oddlyield-%E5%87%BD%E6%95%B0-c873d088-cf40-435f-8d41-c8232fee9238"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PDURATION:{description:"返回投资到达指定值所需的期数",abstract:"返回投资到达指定值所需的期数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/pduration-%E5%87%BD%E6%95%B0-44f33460-5be5-4c90-b857-22308892adaf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PMT:{description:"返回年金的定期支付金额",abstract:"返回年金的定期支付金额",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/pmt-%E5%87%BD%E6%95%B0-0214da64-9a63-4996-bc20-214433fa6441"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PPMT:{description:"返回一笔投资在给定期间内偿还的本金",abstract:"返回一笔投资在给定期间内偿还的本金",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ppmt-%E5%87%BD%E6%95%B0-c370d9e3-7749-4ca4-beea-b06c6ac95e1b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRICE:{description:"返回每张票面为 ￥100 且定期支付利息的债券的现价",abstract:"返回每张票面为 ￥100 且定期支付利息的债券的现价",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/price-%E5%87%BD%E6%95%B0-3ea9deac-8dfa-436f-a7c8-17ea02c21b0a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRICEDISC:{description:"返回每张票面为 ￥100 的已贴现债券的现价",abstract:"返回每张票面为 ￥100 的已贴现债券的现价",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/pricedisc-%E5%87%BD%E6%95%B0-d06ad7c1-380e-4be7-9fd9-75e3079acfd3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRICEMAT:{description:"返回每张票面为 ￥100 且在到期日支付利息的债券的现价",abstract:"返回每张票面为 ￥100 且在到期日支付利息的债券的现价",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/pricemat-%E5%87%BD%E6%95%B0-52c3b4da-bc7e-476a-989f-a95f675cae77"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PV:{description:"返回投资的现值",abstract:"返回投资的现值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/pv-%E5%87%BD%E6%95%B0-23879d31-0e02-4321-be01-da16e8168cbd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RATE:{description:"返回年金的各期利率",abstract:"返回年金的各期利率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rate-%E5%87%BD%E6%95%B0-9f665657-4a7e-4bb7-a030-83fc59e748ce"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RECEIVED:{description:"返回完全投资型债券在到期日收回的金额",abstract:"返回完全投资型债券在到期日收回的金额",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/received-%E5%87%BD%E6%95%B0-7a3f8b93-6611-4f81-8576-828312c9b5e5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RRI:{description:"返回某项投资增长的等效利率",abstract:"返回某项投资增长的等效利率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rri-%E5%87%BD%E6%95%B0-6f5822d8-7ef1-4233-944c-79e8172930f4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SLN:{description:"返回固定资产的每期线性折旧费",abstract:"返回固定资产的每期线性折旧费",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sln-%E5%87%BD%E6%95%B0-cdb666e5-c1c6-40a7-806a-e695edc2f1c8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SYD:{description:"返回某项固定资产按年限总和折旧法计算的每期折旧金额",abstract:"返回某项固定资产按年限总和折旧法计算的每期折旧金额",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/syd-%E5%87%BD%E6%95%B0-069f8106-b60b-4ca2-98e0-2a0f206bdb27"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TBILLEQ:{description:"返回国库券的等价债券收益",abstract:"返回国库券的等价债券收益",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tbilleq-%E5%87%BD%E6%95%B0-2ab72d90-9b4d-4efe-9fc2-0f81f2c19c8c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TBILLPRICE:{description:"返回面值 ￥100 的国库券的价格",abstract:"返回面值 ￥100 的国库券的价格",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tbillprice-%E5%87%BD%E6%95%B0-eacca992-c29d-425a-9eb8-0513fe6035a2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TBILLYIELD:{description:"返回国库券的收益率",abstract:"返回国库券的收益率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tbillyield-%E5%87%BD%E6%95%B0-6d381232-f4b0-4cd5-8e97-45b9c03468ba"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VDB:{description:"使用余额递减法，返回一笔资产在给定期间或部分期间内的折旧值",abstract:"使用余额递减法，返回一笔资产在给定期间或部分期间内的折旧值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/vdb-%E5%87%BD%E6%95%B0-dde4e207-f3fa-488d-91d2-66d55e861d73"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XIRR:{description:"返回一组现金流的内部收益率，这些现金流不一定定期发生",abstract:"返回一组现金流的内部收益率，这些现金流不一定定期发生",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/xirr-%E5%87%BD%E6%95%B0-de1242ec-6477-445b-b11b-a303ad9adc9d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XNPV:{description:"返回一组现金流的净现值，这些现金流不一定定期发生",abstract:"返回一组现金流的净现值，这些现金流不一定定期发生",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/xnpv-%E5%87%BD%E6%95%B0-1b42bbf6-370f-4532-a0eb-d67c16b664b7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YIELD:{description:"返回定期支付利息的债券的收益",abstract:"返回定期支付利息的债券的收益",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/yield-%E5%87%BD%E6%95%B0-f5f5ca43-c4bd-434f-8bd2-ed3c9727a4fe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YIELDDISC:{description:"返回已贴现债券的年收益；例如，短期国库券",abstract:"返回已贴现债券的年收益；例如，短期国库券",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/yielddisc-%E5%87%BD%E6%95%B0-a9dbdbae-7dae-46de-b995-615faffaaed7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},YIELDMAT:{description:"返回在到期日支付利息的债券的年收益",abstract:"返回在到期日支付利息的债券的年收益",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/yieldmat-%E5%87%BD%E6%95%B0-ba7d1809-0d33-4bcb-96c7-6c56ec62ef6f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},vYe={CELL:{description:"返回有关单元格格式、位置或内容的信息",abstract:"返回有关单元格格式、位置或内容的信息",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cell-%E5%87%BD%E6%95%B0-51bd39a5-f338-4dbe-a33f-955d67c2b2cf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ERROR_TYPE:{description:"返回对应于错误类型的数字",abstract:"返回对应于错误类型的数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/error-type-%E5%87%BD%E6%95%B0-10958677-7c8d-44f7-ae77-b9a9ee6eefaa"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INFO:{description:"返回有关当前操作环境的信息",abstract:"返回有关当前操作环境的信息",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/info-%E5%87%BD%E6%95%B0-725f259a-0e4b-49b3-8b52-58815c69acae"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISBLANK:{description:"如果值为空，则返回 TRUE",abstract:"如果值为空，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{value:{name:"值",detail:" 指的是要测试的值。 参数 value 可以是空白（空单元格）、错误值、逻辑值、文本、数字、引用值，或者引用要测试的以上任意值的名称。"}}},ISERR:{description:"如果值为除 #N/A 以外的任何错误值，则返回 TRUE",abstract:"如果值为除 #N/A 以外的任何错误值，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISERROR:{description:"如果值为任何错误值，则返回 TRUE",abstract:"如果值为任何错误值，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISEVEN:{description:"如果数字为偶数，则返回 TRUE",abstract:"如果数字为偶数，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/iseven-%E5%87%BD%E6%95%B0-aa15929a-d77b-4fbb-92f4-2f479af55356"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISFORMULA:{description:"如果有对包含公式的单元格的引用，则返回 TRUE",abstract:"如果有对包含公式的单元格的引用，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/isformula-%E5%87%BD%E6%95%B0-e4d1355f-7121-4ef2-801e-3839bfd6b1e5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISLOGICAL:{description:"如果值为逻辑值，则返回 TRUE",abstract:"如果值为逻辑值，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISNA:{description:"如果值为错误值 #N/A，则返回 TRUE",abstract:"如果值为错误值 #N/A，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISNONTEXT:{description:"如果值不是文本，则返回 TRUE",abstract:"如果值不是文本，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISNUMBER:{description:"如果值为数字，则返回 TRUE",abstract:"如果值为数字，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISODD:{description:"如果数字为奇数，则返回 TRUE",abstract:"如果数字为奇数，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISOMITTED:{description:"检查 LAMBDA 中的值是否缺失，并返回 TRUE 或 FALSE",abstract:"检查 LAMBDA 中的值是否缺失，并返回 TRUE 或 FALSE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/isomitted-%E5%87%BD%E6%95%B0-831d6fbc-0f07-40c4-9c5b-9c73fd1d60c1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISREF:{description:"如果值为引用值，则返回 TRUE",abstract:"如果值为引用值，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISTEXT:{description:"如果值为文本，则返回 TRUE",abstract:"如果值为文本，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/is-%E5%87%BD%E6%95%B0-0f2d7971-6019-40a0-a171-f2d869135665"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},N:{description:"返回转换为数字的值",abstract:"返回转换为数字的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/n-%E5%87%BD%E6%95%B0-a624cad1-3635-4208-b54a-29733d1278c9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NA:{description:"返回错误值 #N/A",abstract:"返回错误值 #N/A",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/na-%E5%87%BD%E6%95%B0-5469c2d1-a90c-4fb5-9bbc-64bd9bb6b47c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SHEET:{description:"返回引用工作表的工作表编号",abstract:"返回引用工作表的工作表编号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sheet-%E5%87%BD%E6%95%B0-44718b6f-8b87-47a1-a9d6-b701c06cff24"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SHEETS:{description:"返回引用中的工作表数",abstract:"返回引用中的工作表数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sheets-%E5%87%BD%E6%95%B0-770515eb-e1e8-45ce-8066-b557e5e4b80b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TYPE:{description:"返回表示值的数据类型的数字",abstract:"返回表示值的数据类型的数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/type-%E5%87%BD%E6%95%B0-45b4e688-4bc3-48b3-a105-ffa892995899"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},bYe={AND:{description:"如果其所有参数均为 TRUE，则返回 TRUE",abstract:"如果其所有参数均为 TRUE，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/and-%E5%87%BD%E6%95%B0-5f19b2e8-e1df-4408-897a-ce285a19e9d9"}],functionParameter:{logical1:{name:"逻辑值 1",detail:"第一个想要测试且计算结果可为 TRUE 或 FALSE 的条件。"},logical2:{name:"逻辑值 2",detail:"其他想要测试且计算结果可为 TRUE 或 FALSE 的条件（最多 255 个条件）。"}}},BYCOL:{description:"将 LAMBDA 应用于每个列并返回结果数组",abstract:"将 LAMBDA 应用于每个列并返回结果数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bycol-%E5%87%BD%E6%95%B0-58463999-7de5-49ce-8f38-b7f7a2192bfb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BYROW:{description:"将 LAMBDA 应用于每一行并返回结果数组",abstract:"将 LAMBDA 应用于每一行并返回结果数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/byrow-%E5%87%BD%E6%95%B0-2e04c677-78c8-4e6b-8c10-a4602f2602bb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FALSE:{description:"返回逻辑值 FALSE",abstract:"返回逻辑值 FALSE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/false-%E5%87%BD%E6%95%B0-2d58dfa5-9c03-4259-bf8f-f0ae14346904"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IF:{description:"指定要执行的逻辑检测",abstract:"指定要执行的逻辑检测",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/if-%E5%87%BD%E6%95%B0-69aed7c9-4e8a-4755-a9bc-aa8bbff73be2"}],functionParameter:{logicalTest:{name:"布尔表达式",detail:"要测试的条件。"},valueIfTrue:{name:"如果值为 true",detail:"logical_test 的结果为 TRUE 时，您希望返回的值。"},valueIfFalse:{name:"如果值为 false",detail:"logical_test 的结果为 FALSE 时，您希望返回的值。"}}},IFERROR:{description:"如果公式的计算结果错误，则返回您指定的值；否则返回公式的结果",abstract:"如果公式的计算结果错误，则返回您指定的值；否则返回公式的结果",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/iferror-%E5%87%BD%E6%95%B0-c526fd07-caeb-47b8-8bb6-63f3e417f611"}],functionParameter:{value:{name:"值",detail:" 检查是否存在错误的参数。"},valueIfError:{name:"发生错误时的值",detail:"公式计算结果为错误时要返回的值。 评估以下错误类型：#N/A、#VALUE!、#REF!、#DIV/0!、#NUM!、#NAME? 或 #NULL!。"}}},IFNA:{description:"如果该表达式解析为 #N/A，则返回指定值；否则返回该表达式的结果",abstract:"如果该表达式解析为 #N/A，则返回指定值；否则返回该表达式的结果",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ifna-%E5%87%BD%E6%95%B0-6626c961-a569-42fc-a49d-79b4951fd461"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IFS:{description:" 检查是否满足一个或多个条件，且是否返回与第一个 TRUE 条件对应的值。",abstract:" 检查是否满足一个或多个条件，且是否返回与第一个 TRUE 条件对应的值。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ifs-%E5%87%BD%E6%95%B0-36329a26-37b2-467c-972b-4a39bd951d45"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LAMBDA:{description:"使用 LAMBDA 函数创建可重用的自定义函数，并使用易记名称调用它们。 新函数在整个工作簿中可用，其调用类似本机 Excel 函数。",abstract:"创建自定义、可重用的函数，并通过友好名称调用它们",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/lambda-%E5%87%BD%E6%95%B0-bd212d27-1cd1-4321-a34a-ccbf254b8b67"}],functionParameter:{parameter:{name:"参数",detail:"要传递给函数的值，例如单元格引用、字符串或数字。 最多可以输入 253 个参数。 此参数可选。"},calculation:{name:"计算",detail:"要作为函数结果执行并返回的公式。 其必须为最后一个参数，且必须返回结果。 此参数是必需项。"}}},LET:{description:"将名称分配给计算结果",abstract:"将名称分配给计算结果",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/let-%E5%87%BD%E6%95%B0-34842dd8-b92b-4d3f-b325-b8b8f9908999"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MAKEARRAY:{description:"通过应用 LAMBDA 返回指定行和列大小的计算数组",abstract:"通过应用 LAMBDA 返回指定行和列大小的计算数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/makearray-%E5%87%BD%E6%95%B0-b80da5ad-b338-4149-a523-5b221da09097"}],functionParameter:{number1:{name:"rows",detail:"数组中的行数。 必须大于零"},number2:{name:"cols",detail:"数组中的列数。 必须大于零"},value3:{name:"lambda",detail:"调用 LAMBDA 来创建数组。 LAMBDA 接受两个参数:row数组的行索引, col数组的列索引"}}},MAP:{description:"返回一个数组，该数组通过应用 LAMBDA 创建新值，将数组 () 映射到新值",abstract:"返回一个数组，该数组通过应用 LAMBDA 创建新值，将数组 () 映射到新值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/map-%E5%87%BD%E6%95%B0-48006093-f97c-47c1-bfcc-749263bb1f01"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NOT:{description:"对其参数的逻辑求反",abstract:"对其参数的逻辑求反",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/not-%E5%87%BD%E6%95%B0-9cfc6011-a054-40c7-a140-cd4ba2d87d77"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},OR:{description:"如果任一参数为 TRUE，则返回 TRUE",abstract:"如果任一参数为 TRUE，则返回 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/or-%E5%87%BD%E6%95%B0-7d17ad14-8700-4281-b308-00b131e22af0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REDUCE:{description:"通过将 LAMBDA 应用于每个值并返回累加器中的总值，将数组减少为累积值",abstract:"通过将 LAMBDA 应用于每个值并返回累加器中的总值，将数组减少为累积值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/reduce-%E5%87%BD%E6%95%B0-42e39910-b345-45f3-84b8-0642b568b7cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SCAN:{description:"通过将 LAMBDA 应用于每个值来扫描数组，并返回具有每个中间值的数组",abstract:"通过将 LAMBDA 应用于每个值来扫描数组，并返回具有每个中间值的数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/scan-%E5%87%BD%E6%95%B0-d58dfd11-9969-4439-b2dc-e7062724de29"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SWITCH:{description:"根据值列表计算表达式，并返回与第一个匹配值对应的结果。 如果不匹配，则可能返回可选默认值。",abstract:"根据值列表计算表达式，并返回与第一个匹配值对应的结果。 如果不匹配，则可能返回可选默认值。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/switch-%E5%87%BD%E6%95%B0-47ab33c0-28ce-4530-8a45-d532ec4aa25e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRUE:{description:"返回逻辑值 TRUE",abstract:"返回逻辑值 TRUE",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/true-%E5%87%BD%E6%95%B0-7652c6e3-8987-48d0-97cd-ef223246b3fb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XOR:{description:"返回所有参数的逻辑“异或”值",abstract:"返回所有参数的逻辑“异或”值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/xor-%E5%87%BD%E6%95%B0-1548d4c2-5e47-4f77-9a92-0533bba14f37"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},_Ye={ADDRESS:{description:"根据指定行号和列号获得工作表中的某个单元格的地址。 例如，ADDRESS(2,3) 返回 $C$2。 再例如，ADDRESS(77,300) 返回 $KN$77。 可以使用其他函数（如 ROW 和 COLUMN 函数）为 ADDRESS 函数提供行号和列号参数。",abstract:"以文本形式将引用值返回到工作表的单个单元格",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/address-%E5%87%BD%E6%95%B0-d0c26c0d-3991-446b-8de4-ab46431d4f89"}],functionParameter:{row_num:{name:"行号",detail:"一个数值，指定要在单元格引用中使用的行号。"},column_num:{name:"列号",detail:"一个数值，指定要在单元格引用中使用的列号。"},abs_num:{name:"引用类型",detail:"一个数值，指定要返回的引用类型。"},a1:{name:"引用样式",detail:"一个逻辑值，指定 A1 或 R1C1 引用样式。 在 A1 样式中，列和行将分别按字母和数字顺序添加标签。 在 R1C1 引用样式中，列和行均按数字顺序添加标签。 如果参数 A1 为 TRUE 或被省略，则 ADDRESS 函数返回 A1 样式引用；如果为 FALSE，则 ADDRESS 函数返回 R1C1 样式引用。"},sheet_text:{name:"工作表名称",detail:'一个文本值，指定要用作外部引用的工作表的名称。 例如，公式=ADDRESS (1，1,,,"Sheet2") 返回 Sheet2！$A$1。 如果 sheet_text 参数，则不使用工作表名称，函数返回的地址引用当前工作表上的单元格。'}}},AREAS:{description:"返回引用中涉及的区域个数",abstract:"返回引用中涉及的区域个数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/areas-%E5%87%BD%E6%95%B0-8392ba32-7a41-43b3-96b0-3695d2ec6152"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHOOSE:{description:"从值的列表中选择值",abstract:"从值的列表中选择值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/choose-%E5%87%BD%E6%95%B0-fc5c184f-cb62-4ec7-a46e-38653b98f5bc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHOOSECOLS:{description:"返回数组中的指定列",abstract:"返回数组中的指定列",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/choosecols-%E5%87%BD%E6%95%B0-bf117976-2722-4466-9b9a-1c01ed9aebff"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHOOSEROWS:{description:"返回数组中的指定行",abstract:"返回数组中的指定行",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chooserows-%E5%87%BD%E6%95%B0-51ace882-9bab-4a44-9625-7274ef7507a3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COLUMN:{description:"返回引用的列号",abstract:"返回引用的列号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/column-%E5%87%BD%E6%95%B0-44e8c754-711c-4df3-9da4-47a55042554b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COLUMNS:{description:"返回引用中包含的列数",abstract:"返回引用中包含的列数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/columns-%E5%87%BD%E6%95%B0-4e8e7b4e-e603-43e8-b177-956088fa48ca"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DROP:{description:"从数组的开头或末尾排除指定数量的行或列",abstract:"从数组的开头或末尾排除指定数量的行或列",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/drop-%E5%87%BD%E6%95%B0-1cb4e151-9e17-4838-abe5-9ba48d8c6a34"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXPAND:{description:"将数组展开或填充到指定的行和列维度",abstract:"将数组展开或填充到指定的行和列维度",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/expand-%E5%87%BD%E6%95%B0-7433fba5-4ad1-41da-a904-d5d95808bc38"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FILTER:{description:"FILTER 函数可以基于定义的条件筛选一系列数据。",abstract:"FILTER 函数可以基于定义的条件筛选一系列数据。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/filter-%E5%87%BD%E6%95%B0-f4f7cb66-82eb-4767-8f7c-4877ad80c759"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORMULATEXT:{description:"将给定引用的公式返回为文本",abstract:"将给定引用的公式返回为文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/formulatext-%E5%87%BD%E6%95%B0-0a786771-54fd-4ae2-96ee-09cda35439c8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GETPIVOTDATA:{description:"返回存储在数据透视表中的数据",abstract:"返回存储在数据透视表中的数据",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/getpivotdata-%E5%87%BD%E6%95%B0-8c083b99-a922-4ca0-af5e-3af55960761f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HLOOKUP:{description:"在表格的首行或数值数组中搜索值，然后返回表格或数组中指定行的所在列中的值。",abstract:"查找数组的首行，并返回指定单元格的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hlookup-%E5%87%BD%E6%95%B0-a3034eec-b719-4ba3-bb65-e1ad662ed95f"}],functionParameter:{lookupValue:{name:"查找值",detail:"要查找的值。 要查找的值必须位于 table_array 参数中指定的单元格区域的第一行中。"},tableArray:{name:"范围",detail:"VLOOKUP 在其中搜索 lookup_value 和返回值的单元格区域。在其中查找数据的信息表。 使用对区域或区域名称的引用。"},rowIndexNum:{name:"行号",detail:"行号table_array匹配值将返回的行号（row_index_num为 1，则返回 table_array 中的第一行值，row_index_num 2 返回 table_array 中的第二行值）。"},rangeLookup:{name:"查询类型",detail:"指定希望查找精确匹配值还是近似匹配值：默认近似匹配 - 1/TRUE, 完全匹配 - 0/FALSE"}}},HSTACK:{description:"水平和顺序追加数组以返回较大的数组",abstract:"水平和顺序追加数组以返回较大的数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hstack-%E5%87%BD%E6%95%B0-98c4ab76-10fe-4b4f-8d5f-af1c125fe8c2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HYPERLINK:{description:"创建快捷方式或跳转，以打开存储在网络服务器、Intranet 或 Internet 上的文档",abstract:"创建快捷方式或跳转，以打开存储在网络服务器、Intranet 或 Internet 上的文档",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hyperlink-%E5%87%BD%E6%95%B0-333c7ce6-c5ae-4164-9c47-7de9b76f577f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},IMAGE:{description:"从给定源返回图像",abstract:"从给定源返回图像",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/image-%E5%87%BD%E6%95%B0-7e112975-5e52-4f2a-b9da-1d913d51f5d5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INDEX:{description:"使用索引从引用或数组中选择值",abstract:"使用索引从引用或数组中选择值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/index-%E5%87%BD%E6%95%B0-a5dcf0dd-996d-40a4-a822-b56b061328bd"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INDIRECT:{description:"返回由文本值指定的引用",abstract:"返回由文本值指定的引用",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/indirect-%E5%87%BD%E6%95%B0-474b3a3a-8a26-4f44-b491-92b6306fa261"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOOKUP:{description:"当您需要查询一行或一列并查找另一行或列中的相同位置的值时使用",abstract:"在向量或数组中查找值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/lookup-%E5%87%BD%E6%95%B0-446d94af-663b-451d-8251-369d5e3864cb"}],functionParameter:{lookupValue:{name:"查找值",detail:"在第一个向量中搜索的值。可以是数字、文本、逻辑值、名称或对值的引用。"},lookupVectorOrArray:{name:"查询范围或数组",detail:"只包含一行或一列的区域。"},resultVector:{name:"结果范围",detail:" 只包含一行或一列的区域。参数必须与 lookup_vector 参数大小相同。 其大小必须相同。"}}},MATCH:{description:"使用 MATCH 函数在 范围 单元格中搜索特定的项，然后返回该项在此区域中的相对位置。 例如，如果 A1:A3 区域中包含值 5、25 和 38，那么公式 =MATCH(25,A1:A3,0) 返回数字 2，因为 25 是该区域中的第二项。",abstract:"在引用或数组中查找值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/match-%E5%87%BD%E6%95%B0-e8dffd45-c762-47d6-bf89-533f4a37673a"}],functionParameter:{lookupValue:{name:"查找值",detail:"要在 lookup_array 中匹配的值。 例如，如果要在电话簿中查找某人的电话号码，则应该将姓名作为查找值，但实际上需要的是电话号码。lookup_value 参数可以为值（数字、文本或逻辑值）或对数字、文本或逻辑值的单元格引用。"},lookupArray:{name:"搜索区域",detail:"要搜索的单元格区域。"},matchType:{name:"匹配类型",detail:"数字 -1、0 或 1。 match_type 参数指定 Excel 如何将 lookup_value 与 lookup_array 中的值匹配。 此参数的默认值为 1。"}}},OFFSET:{description:"从给定引用中返回引用偏移量",abstract:"从给定引用中返回引用偏移量",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/offset-%E5%87%BD%E6%95%B0-c8de19ae-dd79-4b9b-a14e-b4d906d11b66"}],functionParameter:{reference:{name:"引用",detail:"要基于偏移量的引用。 引用必须引用单元格或相邻单元格区域;否则，OFFSET 返回#VALUE！ 错误值。"},rows:{name:"行数",detail:"需要左上角单元格引用的向上或向下行数。 使用 5 作为 rows 参数，可指定引用中的左上角单元格为引用下方的 5 行。 Rows 可为正数（这意味着在起始引用的下方）或负数（这意味着在起始引用的上方）。"},cols:{name:"列数",detail:"需要结果的左上角单元格引用的从左到右的列数。 使用 5 作为 cols 参数，可指定引用中的左上角单元格为引用右方的 5 列。 Cols 可为正数（这意味着在起始引用的右侧）或负数（这意味着在起始引用的左侧）。"},height:{name:"行高",detail:"需要返回的引用的行高。 Height 必须为正数。"},width:{name:"列宽",detail:"需要返回的引用的列宽。 Width 必须为正数。"}}},ROW:{description:"返回引用的行号",abstract:"返回引用的行号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/row-%E5%87%BD%E6%95%B0-3a63b74a-c4d0-4093-b49a-e76eb49a6d8d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROWS:{description:"返回引用中的行数",abstract:"返回引用中的行数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rows-%E5%87%BD%E6%95%B0-b592593e-3fc2-47f2-bec1-bda493811597"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RTD:{description:"从支持 COM 自动化的程序中检索实时数据",abstract:"从支持 COM 自动化的程序中检索实时数据",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rtd-%E5%87%BD%E6%95%B0-e0cc001a-56f0-470a-9b19-9455dc0eb593"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SORT:{description:"对区域或数组的内容进行排序",abstract:"对区域或数组的内容进行排序",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sort-%E5%87%BD%E6%95%B0-22f63bd0-ccc8-492f-953d-c20e8e44b86c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SORTBY:{description:"根据相应区域或数组中的值对区域或数组的内容进行排序",abstract:"根据相应区域或数组中的值对区域或数组的内容进行排序",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sortby-%E5%87%BD%E6%95%B0-cd2d7a62-1b93-435c-b561-d6a35134f28f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TAKE:{description:"从数组的开头或末尾返回指定数量的连续行或列",abstract:"从数组的开头或末尾返回指定数量的连续行或列",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/take-%E5%87%BD%E6%95%B0-25382ff1-5da1-4f78-ab43-f33bd2e4e003"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TOCOL:{description:"返回单个列中的数组",abstract:"返回单个列中的数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tocol-%E5%87%BD%E6%95%B0-22839d9b-0b55-4fc1-b4e6-2761f8f122ed"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TOROW:{description:"返回单个行中的数组",abstract:"返回单个行中的数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/torow-%E5%87%BD%E6%95%B0-b90d0964-a7d9-44b7-816b-ffa5c2fe2289"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRANSPOSE:{description:"返回数组的转置",abstract:"返回数组的转置",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/transpose-%E5%87%BD%E6%95%B0-ed039415-ed8a-4a81-93e9-4b6dfac76027"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UNIQUE:{description:"返回列表或区域的唯一值列表",abstract:"返回列表或区域的唯一值列表",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/unique-%E5%87%BD%E6%95%B0-c5ab87fd-30a3-4ce9-9d1a-40204fb85e1e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VLOOKUP:{description:"需要在表格或区域中按行查找内容时，请使用 VLOOKUP。 例如，按部件号查找汽车部件的价格，或根据员工 ID 查找员工姓名。",abstract:"在数组第一列中查找，然后在行之间移动以返回单元格的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/vlookup-%E5%87%BD%E6%95%B0-0bbc8083-26fe-4963-8ab8-93a18ad188a1"}],functionParameter:{lookupValue:{name:"查找值",detail:"要查找的值。 要查找的值必须位于 table_array 参数中指定的单元格区域的第一列中。"},tableArray:{name:"范围",detail:"VLOOKUP 在其中搜索 lookup_value 和返回值的单元格区域。 可以使用命名区域或表，并且可以在参数中使用名称，而不是单元格引用。 "},colIndexNum:{name:"行号",detail:"其中包含返回值的单元格的编号（table_array 最左侧单元格为 1 开始编号）。"},rangeLookup:{name:"查询类型",detail:"一个逻辑值，该值指定希望 VLOOKUP 查找近似匹配还是精确匹配：近似匹配 - 1/TRUE, 完全匹配 - 0/FALSE"}}},VSTACK:{description:"按顺序垂直追加数组以返回更大的数组",abstract:"按顺序垂直追加数组以返回更大的数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/vstack-%E5%87%BD%E6%95%B0-a4b86897-be0f-48fc-adca-fcc10d795a9c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WRAPCOLS:{description:"在指定数量的元素之后按列包装提供的行或值列",abstract:"在指定数量的元素之后按列包装提供的行或值列",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/wrapcols-%E5%87%BD%E6%95%B0-d038b05a-57b7-4ee0-be94-ded0792511e2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WRAPROWS:{description:"在指定数量的元素之后按行包装提供的行或值列",abstract:"在指定数量的元素之后按行包装提供的行或值列",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/wraprows-%E5%87%BD%E6%95%B0-796825f3-975a-4cee-9c84-1bbddf60ade0"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},XLOOKUP:{description:"函数搜索区域或数组，然后返回与它找到的第一个匹配项对应的项。 如果不存在匹配项，则 XLOOKUP 可以返回最接近的 (近似) 匹配项",abstract:"搜索区域或数组，并返回与之找到的第一个匹配项对应的项。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/xlookup-%E5%87%BD%E6%95%B0-b7fd680e-6d10-43e6-84f9-88eae8bf5929"}],functionParameter:{lookupValue:{name:"查找值",detail:"要搜索的值，如果省略，XLOOKUP 将返回在 lookup_array 中找到的空白单元格。"},lookupArray:{name:"搜索区域",detail:"要搜索的数组或区域"},returnArray:{name:"返回区域",detail:"要返回的数组或区域"},ifNotFound:{name:"[默认显示值]",detail:"如果未找到有效的匹配项，则返回你提供的 [if_not_found] 文本，否则返回#N/A "},matchMode:{name:"[匹配类型]",detail:"指定匹配类型： 0 - 完全匹配。 如果未找到，则返回 #N/A。默认选项。-1 - 完全匹配。 如果没有找到，则返回下一个较小的项。1 - 完全匹配。 如果没有找到，则返回下一个较大的项。 2 - 通配符匹配，其中 *, ? 和 ~ 有特殊含义。"},searchMode:{name:"[搜索模式]",detail:"指定要使用的搜索模式：1 从第一项开始执行搜索，默认选项。-1 从最后一项开始执行反向搜索。2 执行依赖于 lookup_array 按升序排序的二进制搜索, -2执行依赖于 lookup_array 按降序排序的二进制搜索"}}},XMATCH:{description:"在数组或单元格区域中搜索指定项，然后返回项的相对位置。",abstract:"返回项目在数组或单元格区域中的相对位置。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/xmatch-%E5%87%BD%E6%95%B0-d966da31-7a6b-4a13-a1c6-5a33ed6a0312"}],functionParameter:{lookupValue:{name:"查找值",detail:"查找值"},lookupArray:{name:"搜索区域",detail:"要搜索的数组或区域"},matchMode:{name:"匹配类型",detail:`指定匹配类型：
0 - 完全匹配（默认值）
-1 - 完全匹配或下一个最小项
1 - 完全匹配或下一个最大项
2 - 通配符匹配，其中 *, ? 和 ~ 有特殊含义。`},searchMode:{name:"搜索类型",detail:`指定搜索类型：
1 - 搜索从第一到最后一个（默认值）
-1 - 搜索从最后到第一个（反向搜索）。
2 - 执行依赖于 lookup_array 按升序排序的二进制搜索。 如果未排序，将返回无效结果。
2 - 执行依赖于 lookup_array 按降序排序的二进制搜索。 如果未排序，将返回无效结果。`}}}},CYe={ABS:{description:"返回数字的绝对值。一个数字的绝对值是该数字不带其符号的形式。",abstract:"返回数字的绝对值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/abs-%E5%87%BD%E6%95%B0-3420200f-5628-4e8c-99da-c99d7c87713c"}],functionParameter:{number:{name:"数值",detail:"需要计算其绝对值的实数。"}}},ACOS:{description:"返回数字的反余弦值。 反余弦值是指余弦值为 number 的角度。 返回的角度以弧度表示，弧度值在 0（零）到 pi 之间。",abstract:"返回数字的反余弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/acos-%E5%87%BD%E6%95%B0-cb73173f-d089-4582-afa1-76e5524b5d5b"}],functionParameter:{number:{name:"数值",detail:"所求角度的余弦值，必须介于 -1 到 1 之间。"}}},ACOSH:{description:"返回数字的反双曲余弦值。 该数字必须大于或等于 1。 反双曲余弦值是指双曲余弦值为 number 的值，因此 ACOSH(COSH(number)) 等于 number。",abstract:"返回数字的反双曲余弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/acosh-%E5%87%BD%E6%95%B0-e3992cc1-103f-4e72-9f04-624b9ef5ebfe"}],functionParameter:{number:{name:"数值",detail:"大于或等于 1 的任意实数。"}}},ACOT:{description:"返回数字的反余切值的主值。",abstract:"返回一个数的反余切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/acot-%E5%87%BD%E6%95%B0-dc7e5008-fe6b-402e-bdd6-2eea8383d905"}],functionParameter:{number:{name:"数值",detail:"Number 是需要的角度的正切值。 这必须是实数。"}}},ACOTH:{description:"返回一个数的双曲反余切值",abstract:"返回一个数的双曲反余切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/acoth-%E5%87%BD%E6%95%B0-cc49480f-f684-4171-9fc5-73e4e852300f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AGGREGATE:{description:"返回列表或数据库中的聚合",abstract:"返回列表或数据库中的聚合",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/aggregate-%E5%87%BD%E6%95%B0-43b9278e-6aa7-4f17-92b6-e19993fa26df"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ARABIC:{description:"将罗马数字转换为阿拉伯数字",abstract:"将罗马数字转换为阿拉伯数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/arabic-%E5%87%BD%E6%95%B0-9a8da418-c17b-4ef9-a657-9370a30a674f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ASIN:{description:"返回数字的反正弦值",abstract:"返回数字的反正弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/asin-%E5%87%BD%E6%95%B0-81fb95e5-6d6f-48c4-bc45-58f955c6d347"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ASINH:{description:"返回数字的反双曲正弦值",abstract:"返回数字的反双曲正弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/asinh-%E5%87%BD%E6%95%B0-4e00475a-067a-43cf-926a-765b0249717c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ATAN:{description:"返回数字的反正切值",abstract:"返回数字的反正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/atan-%E5%87%BD%E6%95%B0-50746fa8-630a-406b-81d0-4a2aed395543"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ATAN2:{description:"返回 X 和 Y 坐标的反正切值",abstract:"返回 X 和 Y 坐标的反正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/atan2-%E5%87%BD%E6%95%B0-c04592ab-b9e3-4908-b428-c96b3a565033"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ATANH:{description:"返回数字的反双曲正切值",abstract:"返回数字的反双曲正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/atanh-%E5%87%BD%E6%95%B0-3cd65768-0de7-4f1d-b312-d01c8c930d90"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BASE:{description:"将一个数转换为具有给定基数的文本表示",abstract:"将一个数转换为具有给定基数的文本表示",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/base-%E5%87%BD%E6%95%B0-2ef61411-aee9-4f29-a811-1c42456c6342"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CEILING:{description:"将数字舍入为最接近的整数或最接近的指定基数的倍数",abstract:"将数字舍入为最接近的整数或最接近的指定基数的倍数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ceiling-%E5%87%BD%E6%95%B0-0a5cd7c8-0720-4f0a-bd2c-c943e510899f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CEILING_MATH:{description:"将数字向上舍入为最接近的整数或最接近的指定基数的倍数",abstract:"将数字向上舍入为最接近的整数或最接近的指定基数的倍数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ceiling-math-%E5%87%BD%E6%95%B0-80f95d2f-b499-4eee-9f16-f795a8e306c8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CEILING_PRECISE:{description:"将数字舍入为最接近的整数或最接近的指定基数的倍数。 无论该数字的符号如何，该数字都向上舍入。",abstract:"将数字舍入为最接近的整数或最接近的指定基数的倍数。 无论该数字的符号如何，该数字都向上舍入。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ceiling-precise-%E5%87%BD%E6%95%B0-f366a774-527a-4c92-ba49-af0a196e66cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COMBIN:{description:"返回给定数目对象的组合数",abstract:"返回给定数目对象的组合数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/combin-%E5%87%BD%E6%95%B0-12a3f276-0a21-423a-8de6-06990aaf638a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COMBINA:{description:"返回给定数目对象具有重复项的组合数",abstract:"返回给定数目对象具有重复项的组合数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/combina-%E5%87%BD%E6%95%B0-efb49eaa-4f4c-4cd2-8179-0ddfcf9d035d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COS:{description:"返回数字的余弦值",abstract:"返回数字的余弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cos-%E5%87%BD%E6%95%B0-0fb808a5-95d6-4553-8148-22aebdce5f05"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COSH:{description:"返回数字的双曲余弦值",abstract:"返回数字的双曲余弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cosh-%E5%87%BD%E6%95%B0-e460d426-c471-43e8-9540-a57ff3b70555"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COT:{description:"返回角度的余弦值",abstract:"返回角度的余弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/cot-%E5%87%BD%E6%95%B0-c446f34d-6fe4-40dc-84f8-cf59e5f5e31a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COTH:{description:"返回数字的双曲余切值",abstract:"返回数字的双曲余切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/coth-%E5%87%BD%E6%95%B0-2e0b4cb6-0ba0-403e-aed4-deaa71b49df5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CSC:{description:"返回角度的余割值",abstract:"返回角度的余割值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/csc-%E5%87%BD%E6%95%B0-07379361-219a-4398-8675-07ddc4f135c1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CSCH:{description:"返回角度的双曲余割值",abstract:"返回角度的双曲余割值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/csch-%E5%87%BD%E6%95%B0-f58f2c22-eb75-4dd6-84f4-a503527f8eeb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DECIMAL:{description:"将给定基数内的数的文本表示转换为十进制数",abstract:"将给定基数内的数的文本表示转换为十进制数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/decimal-%E5%87%BD%E6%95%B0-ee554665-6176-46ef-82de-0a283658da2e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEGREES:{description:"将弧度转换为度",abstract:"将弧度转换为度",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/degrees-%E5%87%BD%E6%95%B0-4d6ec4db-e694-4b94-ace0-1cc3f61f9ba1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EVEN:{description:"将数字向上舍入到最接近的偶数",abstract:"将数字向上舍入到最接近的偶数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/even-%E5%87%BD%E6%95%B0-197b5f06-c795-4c1e-8696-3c3b8a646cf9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXP:{description:"返回e的 n 次方",abstract:"返回e的 n 次方",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/exp-%E5%87%BD%E6%95%B0-c578f034-2c45-4c37-bc8c-329660a63abe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FACT:{description:"返回数字的阶乘",abstract:"返回数字的阶乘",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/fact-%E5%87%BD%E6%95%B0-ca8588c2-15f2-41c0-8e8c-c11bd471a4f3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FACTDOUBLE:{description:"返回数字的双倍阶乘",abstract:"返回数字的双倍阶乘",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/factdouble-%E5%87%BD%E6%95%B0-e67697ac-d214-48eb-b7b7-cce2589ecac8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FLOOR:{description:"向绝对值减小的方向舍入数字",abstract:"向绝对值减小的方向舍入数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/floor-%E5%87%BD%E6%95%B0-14bb497c-24f2-4e04-b327-b0b4de5a8886"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FLOOR_MATH:{description:"将数字向下舍入为最接近的整数或最接近的指定基数的倍数",abstract:"将数字向下舍入为最接近的整数或最接近的指定基数的倍数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/floor-math-%E5%87%BD%E6%95%B0-c302b599-fbdb-4177-ba19-2c2b1249a2f5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FLOOR_PRECISE:{description:"将数字向下舍入为最接近的整数或最接近的指定基数的倍数。 无论该数字的符号如何，该数字都向下舍入。",abstract:"将数字向下舍入为最接近的整数或最接近的指定基数的倍数。 无论该数字的符号如何，该数字都向下舍入。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/floor-precise-%E5%87%BD%E6%95%B0-f769b468-1452-4617-8dc3-02f842a0702e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GCD:{description:"返回最大公约数",abstract:"返回最大公约数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gcd-%E5%87%BD%E6%95%B0-d5107a51-69e3-461f-8e4c-ddfc21b5073a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INT:{description:"将数字向下舍入到最接近的整数",abstract:"将数字向下舍入到最接近的整数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/int-%E5%87%BD%E6%95%B0-a6c4af9e-356d-4369-ab6a-cb1fd9d343ef"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ISO_CEILING:{description:"返回一个数字，该数字向上舍入为最接近的整数或最接近的有效位的倍数",abstract:"返回一个数字，该数字向上舍入为最接近的整数或最接近的有效位的倍数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/iso-ceiling-%E5%87%BD%E6%95%B0-e587bb73-6cc2-4113-b664-ff5b09859a83"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LCM:{description:"返回最小公倍数",abstract:"返回最小公倍数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/lcm-%E5%87%BD%E6%95%B0-7152b67a-8bb5-4075-ae5c-06ede5563c94"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LET:{description:"将名称分配给计算结果，以允许将中间计算、值或定义名称存储在公式内",abstract:"将名称分配给计算结果，以允许将中间计算、值或定义名称存储在公式内",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/let-%E5%87%BD%E6%95%B0-34842dd8-b92b-4d3f-b325-b8b8f9908999"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LN:{description:"返回数字的自然对数",abstract:"返回数字的自然对数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/ln-%E5%87%BD%E6%95%B0-81fe1ed7-dac9-4acd-ba1d-07a142c6118f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOG:{description:"返回数字的以指定底为底的对数",abstract:"返回数字的以指定底为底的对数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/log-%E5%87%BD%E6%95%B0-4e82f196-1ca9-4747-8fb0-6c4a3abb3280"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOG10:{description:"返回数字的以 10 为底的对数",abstract:"返回数字的以 10 为底的对数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/log10-%E5%87%BD%E6%95%B0-c75b881b-49dd-44fb-b6f4-37e3486a0211"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MDETERM:{description:"返回数组的矩阵行列式的值",abstract:"返回数组的矩阵行列式的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mdeterm-%E5%87%BD%E6%95%B0-e7bfa857-3834-422b-b871-0ffd03717020"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MINVERSE:{description:"返回数组的逆矩阵",abstract:"返回数组的逆矩阵",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/minverse-%E5%87%BD%E6%95%B0-11f55086-adde-4c9f-8eb9-59da2d72efc6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MMULT:{description:"返回两个数组的矩阵乘积",abstract:"返回两个数组的矩阵乘积",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mmult-%E5%87%BD%E6%95%B0-40593ed7-a3cd-4b6b-b9a3-e4ad3c7245eb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MOD:{description:"返回除法的余数",abstract:"返回除法的余数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mod-%E5%87%BD%E6%95%B0-9b6cd169-b6ee-406a-a97b-edf2a9dc24f3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MROUND:{description:"返回一个舍入到所需倍数的数字",abstract:"返回一个舍入到所需倍数的数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mround-%E5%87%BD%E6%95%B0-c299c3b0-15a5-426d-aa4b-d2d5b3baf427"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MULTINOMIAL:{description:"返回一组数字的多项式",abstract:"返回一组数字的多项式",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/multinomial-%E5%87%BD%E6%95%B0-6fa6373c-6533-41a2-a45e-a56db1db1bf6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MUNIT:{description:"返回单位矩阵或指定维度",abstract:"返回单位矩阵或指定维度",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/munit-%E5%87%BD%E6%95%B0-c9fe916a-dc26-4105-997d-ba22799853a3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ODD:{description:"将数字向上舍入为最接近的奇数",abstract:"将数字向上舍入为最接近的奇数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/odd-%E5%87%BD%E6%95%B0-deae64eb-e08a-4c88-8b40-6d0b42575c98"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PI:{description:"返回 pi 的值",abstract:"返回 pi 的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/pi-%E5%87%BD%E6%95%B0-264199d0-a3ba-46b8-975a-c4a04608989b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},POWER:{description:"返回数的乘幂",abstract:"返回数的乘幂",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/power-%E5%87%BD%E6%95%B0-d3f2908b-56f4-4c3f-895a-07fb519c362a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PRODUCT:{description:"将其参数相乘",abstract:"将其参数相乘",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/product-%E5%87%BD%E6%95%B0-8e6b5b24-90ee-4650-aeec-80982a0512ce"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUOTIENT:{description:"返回除法的整数部分",abstract:"返回除法的整数部分",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/quotient-%E5%87%BD%E6%95%B0-9f7bf099-2a18-4282-8fa4-65290cc99dee"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RADIANS:{description:"将度转换为弧度",abstract:"将度转换为弧度",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/radians-%E5%87%BD%E6%95%B0-ac409508-3d48-45f5-ac02-1497c92de5bf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RAND:{description:"返回 0 和 1 之间的一个随机数",abstract:"返回 0 和 1 之间的一个随机数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rand-%E5%87%BD%E6%95%B0-4cbfa695-8869-4788-8d90-021ea9f5be73"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANDARRAY:{description:"RANDARRAY 函数返回 0 和 1 之间的随机数字数组。 但是，你可以指定要填充的行数和列数、最小值和最大值，以及是否返回整个数字或小数值。",abstract:"RANDARRAY 函数返回 0 和 1 之间的随机数字数组。 但是，你可以指定要填充的行数和列数、最小值和最大值，以及是否返回整个数字或小数值。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/randarray-%E5%87%BD%E6%95%B0-21261e55-3bec-4885-86a6-8b0a47fd4d33"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANDBETWEEN:{description:"返回位于两个指定数之间的一个随机数",abstract:"返回位于两个指定数之间的一个随机数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/randbetween-%E5%87%BD%E6%95%B0-4cc7f0d1-87dc-4eb7-987f-a469ab381685"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROMAN:{description:"将阿拉伯数字转换为文本式罗马数字",abstract:"将阿拉伯数字转换为文本式罗马数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/roman-%E5%87%BD%E6%95%B0-d6b0b99e-de46-4704-a518-b45a0f8b56f5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROUND:{description:"将数字按指定位数舍入",abstract:"将数字按指定位数舍入",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/round-%E5%87%BD%E6%95%B0-c018c5d8-40fb-4053-90b1-b3e7f61a213c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROUNDDOWN:{description:"向绝对值减小的方向舍入数字",abstract:"向绝对值减小的方向舍入数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rounddown-%E5%87%BD%E6%95%B0-2ec94c73-241f-4b01-8c6f-17e6d7968f53"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ROUNDUP:{description:"向绝对值增大的方向舍入数字",abstract:"向绝对值增大的方向舍入数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/roundup-%E5%87%BD%E6%95%B0-f8bc9b23-e795-47db-8703-db171d0c42a7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEC:{description:"返回角度的正割值",abstract:"返回角度的正割值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sec-%E5%87%BD%E6%95%B0-ff224717-9c87-4170-9b58-d069ced6d5f7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SECH:{description:"返回角度的双曲正切值",abstract:"返回角度的双曲正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sech-%E5%87%BD%E6%95%B0-e05a789f-5ff7-4d7f-984a-5edb9b09556f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SERIESSUM:{description:"返回基于公式的幂级数的和",abstract:"返回基于公式的幂级数的和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/seriessum-%E5%87%BD%E6%95%B0-a3ab25b5-1093-4f5b-b084-96c49087f637"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEQUENCE:{description:"SEQUENCE 函数可在数组中生成一系列连续数字，例如，1、2、3、4。",abstract:"SEQUENCE 函数可在数组中生成一系列连续数字，例如，1、2、3、4。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sequence-%E5%87%BD%E6%95%B0-57467a98-57e0-4817-9f14-2eb78519ca90"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SIGN:{description:"返回数字的符号",abstract:"返回数字的符号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sign-%E5%87%BD%E6%95%B0-109c932d-fcdc-4023-91f1-2dd0e916a1d8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SIN:{description:"返回给定角度的正弦值",abstract:"返回给定角度的正弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sin-%E5%87%BD%E6%95%B0-cf0e3432-8b9e-483c-bc55-a76651c95602"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SINH:{description:"返回数字的双曲正弦值",abstract:"返回数字的双曲正弦值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sinh-%E5%87%BD%E6%95%B0-1e4e8b9f-2b65-43fc-ab8a-0a37f4081fa7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SQRT:{description:"返回正平方根",abstract:"返回正平方根",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sqrt-%E5%87%BD%E6%95%B0-654975c2-05c4-4831-9a24-2c65e4040fdf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SQRTPI:{description:"返回某数与 pi 的乘积的平方根",abstract:"返回某数与 pi 的乘积的平方根",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sqrtpi-%E5%87%BD%E6%95%B0-1fb4e63f-9b51-46d6-ad68-b3e7a8b519b4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUBTOTAL:{description:"返回列表或数据库中的分类汇总",abstract:"返回列表或数据库中的分类汇总",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/subtotal-%E5%87%BD%E6%95%B0-7b027003-f060-4ade-9040-e478765b9939"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUM:{description:"将单个值、单元格引用或是区域相加，或者将三者的组合相加。",abstract:"求参数的和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sum-%E5%87%BD%E6%95%B0-043e1c7d-7726-4e80-8f32-07b23e057f89"}],functionParameter:{number1:{name:"数值 1",detail:"要相加的第一个数字。 该数字可以是 4 之类的数字，B6 之类的单元格引用或 B2:B8 之类的单元格范围。"},number2:{name:"数值 2",detail:"这是要相加的第二个数字。 可以按照这种方式最多指定 255 个数字。"}}},SUMIF:{description:"对范围中符合指定条件的值求和。",abstract:"按给定条件对指定单元格求和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sumif-%E5%87%BD%E6%95%B0-169b8c99-c05c-4483-a712-1697a653039b"}],functionParameter:{range:{name:"范围",detail:"要根据条件进行检测的范围。"},criteria:{name:"条件",detail:"以数字、表达式、单元格引用、文本或函数的形式来定义将添加哪些单元格。可包括的通配符字符 - 问号（？）以匹配任意单个字符，星号（*）以匹配任意字符序列。 如果要查找实际的问号或星号，请在该字符前键入波形符（~）。"},sumRange:{name:"求和范围",detail:"要添加的实际单元格，如果要添加在范围参数指定以外的其他单元格。 如果省略sum_range参数，Excel就会添加范围参数中指定的单元格（与应用标准的单元格相同）。"}}},SUMIFS:{description:"在区域中添加满足多个条件的单元格",abstract:"在区域中添加满足多个条件的单元格",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sumifs-%E5%87%BD%E6%95%B0-c9e748f5-7ea7-455d-9406-611cebce642b"}],functionParameter:{sumRange:{name:"求和范围",detail:"要求和的单元格区域。"},criteriaRange1:{name:"条件范围 1",detail:"使用条件 1 测试的区域。条件范围 1 和条件 1 设置用于搜索某个区域是否符合特定条件的搜索对。 一旦在该区域中找到了项，将计算求和范围中的相应值的和。"},criteria1:{name:"条件 1",detail:'定义将计算条件范围 1 中的哪些单元格的和的条件。 例如，可以将条件输入为 32、">32"、B4、"苹果" 或 "32"。'},criteriaRange2:{name:"条件范围 2",detail:"附加的区域，最多可以输入 127 个区域。"},criteria2:{name:"条件 2",detail:"附加的关联条件，最多可以输入 127 个条件。"}}},SUMPRODUCT:{description:"返回对应的数组元素的乘积和",abstract:"返回对应的数组元素的乘积和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sumproduct-%E5%87%BD%E6%95%B0-16753e75-9f68-4874-94ac-4d2145a2fd2e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMSQ:{description:"返回参数的平方和",abstract:"返回参数的平方和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sumsq-%E5%87%BD%E6%95%B0-e3313c02-51cc-4963-aae6-31442d9ec307"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMX2MY2:{description:"返回两数组中对应值平方差之和",abstract:"返回两数组中对应值平方差之和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sumx2my2-%E5%87%BD%E6%95%B0-9e599cc5-5399-48e9-a5e0-e37812dfa3e9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMX2PY2:{description:"返回两数组中对应值的平方和之和",abstract:"返回两数组中对应值的平方和之和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sumx2py2-%E5%87%BD%E6%95%B0-826b60b4-0aa2-4e5e-81d2-be704d3d786f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUMXMY2:{description:"返回两个数组中对应值差的平方和",abstract:"返回两个数组中对应值差的平方和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/sumxmy2-%E5%87%BD%E6%95%B0-9d144ac1-4d79-43de-b524-e2ecee23b299"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TAN:{description:"返回数字的正切值",abstract:"返回数字的正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tan-%E5%87%BD%E6%95%B0-08851a40-179f-4052-b789-d7f699447401"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TANH:{description:"返回数字的双曲正切值",abstract:"返回数字的双曲正切值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/tanh-%E5%87%BD%E6%95%B0-017222f0-a0c3-4f69-9787-b3202295dc6c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRUNC:{description:"将数字截尾取整",abstract:"将数字截尾取整",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/trunc-%E5%87%BD%E6%95%B0-8b86a64c-3127-43db-ba14-aa5ceb292721"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},SYe={AVEDEV:{description:"返回数据点与它们的平均值的绝对偏差平均值",abstract:"返回数据点与它们的平均值的绝对偏差平均值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/avedev-%E5%87%BD%E6%95%B0-58fe8d65-2a84-4dc7-8052-f3f87b5c6639"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AVERAGE:{description:"返回参数的平均值（算术平均值）。",abstract:"返回其参数的平均值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/average-%E5%87%BD%E6%95%B0-047bac88-d466-426c-a32b-8f33eb960cf6"}],functionParameter:{number1:{name:"数值 1",detail:"要计算平均值的第一个数字、单元格引用或单元格区域。"},number2:{name:"数值 2",detail:"要计算平均值的其他数字、单元格引用或单元格区域，最多可包含 255 个。"}}},AVERAGEA:{description:"返回其参数的平均值，包括数字、文本和逻辑值",abstract:"返回其参数的平均值，包括数字、文本和逻辑值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/averagea-%E5%87%BD%E6%95%B0-f5f84098-d453-4f4c-bbba-3d2c66356091"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AVERAGEIF:{description:"返回区域中满足给定条件的所有单元格的平均值（算术平均值）",abstract:"返回区域中满足给定条件的所有单元格的平均值（算术平均值）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/averageif-%E5%87%BD%E6%95%B0-faec8e2e-0dec-4308-af69-f5576d8ac642"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},AVERAGEIFS:{description:"返回满足多个条件的所有单元格的平均值（算术平均值）",abstract:"返回满足多个条件的所有单元格的平均值（算术平均值）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/averageifs-%E5%87%BD%E6%95%B0-48910c45-1fc0-4389-a028-f7c5c3001690"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BETA_DIST:{description:"返回 beta 累积分布函数",abstract:"返回 beta 累积分布函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/beta-dist-%E5%87%BD%E6%95%B0-11188c9c-780a-42c7-ba43-9ecb5a878d31"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BETA_INV:{description:"返回指定 beta 分布的累积分布函数的反函数",abstract:"返回指定 beta 分布的累积分布函数的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/beta-inv-%E5%87%BD%E6%95%B0-e84cb8aa-8df0-4cf6-9892-83a341d252eb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOM_DIST:{description:"返回一元二项式分布的概率",abstract:"返回一元二项式分布的概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/binom-dist-%E5%87%BD%E6%95%B0-c5ae37b6-f39c-4be2-94c2-509a1480770c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOM_DIST_RANGE:{description:"使用二项式分布返回试验结果的概率",abstract:"使用二项式分布返回试验结果的概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/binom-dist-range-%E5%87%BD%E6%95%B0-17331329-74c7-4053-bb4c-6653a7421595"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BINOM_INV:{description:"返回使累积二项式分布小于或等于临界值的最小值",abstract:"返回使累积二项式分布小于或等于临界值的最小值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/binom-inv-%E5%87%BD%E6%95%B0-80a0370c-ada6-49b4-83e7-05a91ba77ac9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_DIST:{description:"返回累积 beta 概率密度函数",abstract:"返回累积 beta 概率密度函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chisq-dist-%E5%87%BD%E6%95%B0-8486b05e-5c05-4942-a9ea-f6b341518732"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_DIST_RT:{description:"返回 χ2 分布的单尾概率",abstract:"返回 χ2 分布的单尾概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chisq-dist-rt-%E5%87%BD%E6%95%B0-dc4832e8-ed2b-49ae-8d7c-b28d5804c0f2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_INV:{description:"返回累积 beta 概率密度函数",abstract:"返回累积 beta 概率密度函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chisq-inv-%E5%87%BD%E6%95%B0-400db556-62b3-472d-80b3-254723e7092f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_INV_RT:{description:"返回 χ2 分布的单尾概率的反函数",abstract:"返回 χ2 分布的单尾概率的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chisq-inv-rt-%E5%87%BD%E6%95%B0-435b5ed8-98d5-4da6-823f-293e2cbc94fe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHISQ_TEST:{description:"返回独立性检验值",abstract:"返回独立性检验值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/chisq-test-%E5%87%BD%E6%95%B0-2e8a7861-b14a-4985-aa93-fb88de3f260f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONFIDENCE_NORM:{description:"返回总体平均值的置信区间",abstract:"返回总体平均值的置信区间",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/confidence-norm-%E5%87%BD%E6%95%B0-7cec58a6-85bb-488d-91c3-63828d4fbfd4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONFIDENCE_T:{description:"返回总体平均值的置信区间（使用学生 t-分布）",abstract:"返回总体平均值的置信区间（使用学生 t-分布）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/confidence-t-%E5%87%BD%E6%95%B0-e8eca395-6c3a-4ba9-9003-79ccc61d3c53"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CORREL:{description:"返回两个数据集之间的相关系数",abstract:"返回两个数据集之间的相关系数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/correl-%E5%87%BD%E6%95%B0-995dcef7-0c0a-4bed-a3fb-239d7b68ca92"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUNT:{description:"计算包含数字的单元格个数以及参数列表中数字的个数。",abstract:"计算参数列表中数字的个数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/count-%E5%87%BD%E6%95%B0-a59cd7fc-b623-4d93-87a4-d23bf411294c"}],functionParameter:{value1:{name:"值 1",detail:"要计算其中数字的个数的第一项、单元格引用或区域。"},value2:{name:"值 2",detail:"要计算其中数字的个数的其他项、单元格引用或区域，最多可包含 255 个。"}}},COUNTA:{description:`计算包含任何类型的信息（包括错误值和空文本 ("")）的单元格
        如果不需要对逻辑值、文本或错误值进行计数（换句话说，只希望对包含数字的单元格进行计数），请使用 COUNT 函数。`,abstract:"计算参数列表中值的个数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/counta-%E5%87%BD%E6%95%B0-7dc98875-d5c1-46f1-9a82-53f3219e2509"}],functionParameter:{number1:{name:"数值 1",detail:"必需。 表示要计数的值的第一个参数"},number2:{name:"数值 2",detail:"可选。 表示要计数的值的其他参数，最多可包含 255 个参数。"}}},COUNTBLANK:{description:"计算区域内空白单元格的数量",abstract:"计算区域内空白单元格的数量",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/countblank-%E5%87%BD%E6%95%B0-6a92d772-675c-4bee-b346-24af6bd3ac22"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUNTIF:{description:"计算区域内符合给定条件的单元格的数量",abstract:"计算区域内符合给定条件的单元格的数量",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/countif-%E5%87%BD%E6%95%B0-e0de10c6-f885-4e71-abb4-1f464816df34"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COUNTIFS:{description:"计算区域内符合多个条件的单元格的数量",abstract:"计算区域内符合多个条件的单元格的数量",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/countifs-%E5%87%BD%E6%95%B0-dda3dc6e-f74e-4aee-88bc-aa8c2a866842"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COVARIANCE_P:{description:"返回协方差（成对偏差乘积的平均值）",abstract:"返回协方差（成对偏差乘积的平均值）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/covariance-p-%E5%87%BD%E6%95%B0-6f0e1e6d-956d-4e4b-9943-cfef0bf9edfc"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},COVARIANCE_S:{description:"返回样本协方差，即两个数据集中每对数据点的偏差乘积的平均值",abstract:"返回样本协方差，即两个数据集中每对数据点的偏差乘积的平均值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/covariance-s-%E5%87%BD%E6%95%B0-0a539b74-7371-42aa-a18f-1f5320314977"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DEVSQ:{description:"返回偏差的平方和",abstract:"返回偏差的平方和",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/devsq-%E5%87%BD%E6%95%B0-8b739616-8376-4df5-8bd0-cfe0a6caf444"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXPON_DIST:{description:"返回指数分布",abstract:"返回指数分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/expon-dist-%E5%87%BD%E6%95%B0-4c12ae24-e563-4155-bf3e-8b78b6ae140e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_DIST:{description:"返回 F 概率分布",abstract:"返回 F 概率分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/f-dist-%E5%87%BD%E6%95%B0-a887efdc-7c8e-46cb-a74a-f884cd29b25d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_DIST_RT:{description:"返回 F 概率分布",abstract:"返回 F 概率分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/f-dist-rt-%E5%87%BD%E6%95%B0-d74cbb00-6017-4ac9-b7d7-6049badc0520"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_INV:{description:"返回 F 概率分布的反函数",abstract:"返回 F 概率分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/f-inv-%E5%87%BD%E6%95%B0-0dda0cf9-4ea0-42fd-8c3c-417a1ff30dbe"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_INV_RT:{description:"返回 F 概率分布的反函数",abstract:"返回 F 概率分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/f-inv-rt-%E5%87%BD%E6%95%B0-d371aa8f-b0b1-40ef-9cc2-496f0693ac00"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},F_TEST:{description:"返回 F 检验的结果",abstract:"返回 F 检验的结果",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/f-test-%E5%87%BD%E6%95%B0-100a59e7-4108-46f8-8443-78ffacb6c0a7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FISHER:{description:"返回 Fisher 变换值",abstract:"返回 Fisher 变换值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/fisher-%E5%87%BD%E6%95%B0-d656523c-5076-4f95-b87b-7741bf236c69"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FISHERINV:{description:"返回 Fisher 变换的反函数",abstract:"返回 Fisher 变换的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/fisherinv-%E5%87%BD%E6%95%B0-62504b39-415a-4284-a285-19c8e82f86bb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST:{description:"返回线性趋势值",abstract:"返回线性趋势值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/forecast-%E5%92%8C-forecast-linear-%E5%87%BD%E6%95%B0-50ca49c9-7b40-4892-94e4-7ad38bbeda99"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS:{description:"通过使用指数平滑 (ETS) 算法的 AAA 版本，返回基于现有（历史）值的未来值",abstract:"通过使用指数平滑 (ETS) 算法的 AAA 版本，返回基于现有（历史）值的未来值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS_CONFINT:{description:"返回指定目标日期预测值的置信区间",abstract:"返回指定目标日期预测值的置信区间",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS.CONFINT"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS_SEASONALITY:{description:"返回 Excel 针对指定时间系列检测到的重复模式的长度",abstract:"返回 Excel 针对指定时间系列检测到的重复模式的长度",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS.SEASONALITY"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_ETS_STAT:{description:"返回作为时间序列预测的结果的统计值。",abstract:"返回作为时间序列预测的结果的统计值。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.ETS.STAT"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FORECAST_LINEAR:{description:"返回基于现有值的未来值",abstract:"返回基于现有值的未来值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/%E9%A2%84%E6%B5%8B%E5%87%BD%E6%95%B0-%E5%8F%82%E8%80%83-897a2fe9-6595-4680-a0b0-93e0308d5f6e#_FORECAST.LINEAR"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FREQUENCY:{description:"以垂直数组的形式返回频率分布",abstract:"以垂直数组的形式返回频率分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/frequency-%E5%87%BD%E6%95%B0-44e3be2b-eca0-42cd-a3f7-fd9ea898fdb9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMA:{description:"返回 γ 函数值",abstract:"返回 γ 函数值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gamma-%E5%87%BD%E6%95%B0-ce1702b1-cf55-471d-8307-f83be0fc5297"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMA_DIST:{description:"返回 γ 分布",abstract:"返回 γ 分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gamma-dist-%E5%87%BD%E6%95%B0-9b6f1538-d11c-4d5f-8966-21f6a2201def"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMA_INV:{description:"返回 γ 累积分布函数的反函数",abstract:"返回 γ 累积分布函数的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gamma-inv-%E5%87%BD%E6%95%B0-74991443-c2b0-4be5-aaab-1aa4d71fbb18"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMALN:{description:"返回 γ 函数的自然对数，Γ(x)",abstract:"返回 γ 函数的自然对数，Γ(x)",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gammaln-%E5%87%BD%E6%95%B0-b838c48b-c65f-484f-9e1d-141c55470eb9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAMMALN_PRECISE:{description:"返回 γ 函数的自然对数，Γ(x)",abstract:"返回 γ 函数的自然对数，Γ(x)",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gammaln-precise-%E5%87%BD%E6%95%B0-5cdfe601-4e1e-4189-9d74-241ef1caa599"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GAUSS:{description:"返回小于标准正态累积分布 0.5 的值",abstract:"返回小于标准正态累积分布 0.5 的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/gauss-%E5%87%BD%E6%95%B0-069f1b4e-7dee-4d6a-a71f-4b69044a6b33"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GEOMEAN:{description:"返回几何平均值",abstract:"返回几何平均值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/geomean-%E5%87%BD%E6%95%B0-db1ac48d-25a5-40a0-ab83-0b38980e40d5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},GROWTH:{description:"返回指数趋势值",abstract:"返回指数趋势值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/growth-%E5%87%BD%E6%95%B0-541a91dc-3d5e-437d-b156-21324e68b80d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HARMEAN:{description:"返回调和平均值",abstract:"返回调和平均值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/harmean-%E5%87%BD%E6%95%B0-5efd9184-fab5-42f9-b1d3-57883a1d3bc6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},HYPGEOM_DIST:{description:"返回超几何分布",abstract:"返回超几何分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/hypgeom-dist-%E5%87%BD%E6%95%B0-6dbd547f-1d12-4b1f-8ae5-b0d9e3d22fbf"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},INTERCEPT:{description:"返回线性回归线的截距",abstract:"返回线性回归线的截距",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/intercept-%E5%87%BD%E6%95%B0-2a9b74e2-9d47-4772-b663-3bca70bf63ef"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},KURT:{description:"返回数据集的峰值",abstract:"返回数据集的峰值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/kurt-%E5%87%BD%E6%95%B0-bc3a265c-5da4-4dcb-b7fd-c237789095ab"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LARGE:{description:"返回数据集中第 k 个最大值",abstract:"返回数据集中第 k 个最大值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/large-%E5%87%BD%E6%95%B0-3af0af19-1190-42bb-bb8b-01672ec00a64"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LINEST:{description:"返回线性趋势的参数",abstract:"返回线性趋势的参数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/linest-%E5%87%BD%E6%95%B0-84d7d0d9-6e50-4101-977a-fa7abf772b6d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGEST:{description:"返回指数趋势的参数",abstract:"返回指数趋势的参数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/logest-%E5%87%BD%E6%95%B0-f27462d8-3657-4030-866b-a272c1d18b4b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGNORM_DIST:{description:"返回对数累积分布函数",abstract:"返回对数累积分布函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/lognorm-dist-%E5%87%BD%E6%95%B0-eb60d00b-48a9-4217-be2b-6074aee6b070"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOGNORM_INV:{description:"返回对数累积分布的反函数",abstract:"返回对数累积分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/lognorm-inv-%E5%87%BD%E6%95%B0-fe79751a-f1f2-4af8-a0a1-e151b2d4f600"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MAX:{description:"返回一组值中的最大值。",abstract:"返回参数列表中的最大值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/max-%E5%87%BD%E6%95%B0-e0012414-9ac8-4b34-9a47-73e662c08098"}],functionParameter:{number1:{name:"数值 1",detail:"要计算最大值的第一个数字、单元格引用或单元格区域。"},number2:{name:"数值 2",detail:"要计算最大值的其他数字、单元格引用或单元格区域，最多可包含 255 个。"}}},MAXA:{description:"返回参数列表中的最大值，包括数字、文本和逻辑值",abstract:"返回参数列表中的最大值，包括数字、文本和逻辑值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/maxa-%E5%87%BD%E6%95%B0-814bda1e-3840-4bff-9365-2f59ac2ee62d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MAXIFS:{description:"返回一组给定条件或标准指定的单元格之间的最大值",abstract:"返回一组给定条件或标准指定的单元格之间的最大值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/maxifs-%E5%87%BD%E6%95%B0-dfd611e6-da2c-488a-919b-9b6376b28883"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MEDIAN:{description:"返回给定数值集合的中值",abstract:"返回给定数值集合的中值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/median-%E5%87%BD%E6%95%B0-d0916313-4753-414c-8537-ce85bdd967d2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MIN:{description:"返回一组值中的最小值。",abstract:"返回参数列表中的最小值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/min-%E5%87%BD%E6%95%B0-61635d12-920f-4ce2-a70f-96f202dcc152"}],functionParameter:{number1:{name:"数值 1",detail:"要计算最小值的第一个数字、单元格引用或单元格区域。"},number2:{name:"数值 2",detail:"要计算最小值的其他数字、单元格引用或单元格区域，最多可包含 255 个。"}}},MINA:{description:"返回参数列表中的最小值，包括数字、文本和逻辑值",abstract:"返回参数列表中的最小值，包括数字、文本和逻辑值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mina-%E5%87%BD%E6%95%B0-245a6f46-7ca5-4dc7-ab49-805341bc31d3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MINIFS:{description:"返回一组给定条件或标准指定的单元格之间的最小值。",abstract:"返回一组给定条件或标准指定的单元格之间的最小值。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/minifs-%E5%87%BD%E6%95%B0-6ca1ddaa-079b-4e74-80cc-72eef32e6599"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MODE_MULT:{description:"返回一组数据或数据区域中出现频率最高或重复出现的数值的垂直数组",abstract:"返回一组数据或数据区域中出现频率最高或重复出现的数值的垂直数组",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mode-mult-%E5%87%BD%E6%95%B0-50fd9464-b2ba-4191-b57a-39446689ae8c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MODE_SNGL:{description:"返回在数据集内出现次数最多的值",abstract:"返回在数据集内出现次数最多的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mode-sngl-%E5%87%BD%E6%95%B0-f1267c16-66c6-4386-959f-8fba5f8bb7f8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NEGBINOM_DIST:{description:"返回负二项式分布",abstract:"返回负二项式分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/negbinom-dist-%E5%87%BD%E6%95%B0-c8239f89-c2d0-45bd-b6af-172e570f8599"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_DIST:{description:"返回正态累积分布",abstract:"返回正态累积分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/norm-dist-%E5%87%BD%E6%95%B0-edb1cc14-a21c-4e53-839d-8082074c9f8d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_INV:{description:"返回正态累积分布的反函数",abstract:"返回正态累积分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/norm-inv-%E5%87%BD%E6%95%B0-54b30935-fee7-493c-bedb-2278a9db7e13"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_S_DIST:{description:"返回标准正态累积分布",abstract:"返回标准正态累积分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/norm-s-dist-%E5%87%BD%E6%95%B0-1e787282-3832-4520-a9ae-bd2a8d99ba88"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NORM_S_INV:{description:"返回标准正态累积分布函数的反函数",abstract:"返回标准正态累积分布函数的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/norm-s-inv-%E5%87%BD%E6%95%B0-d6d556b4-ab7f-49cd-b526-5a20918452b1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PEARSON:{description:"返回 Pearson 乘积矩相关系数",abstract:"返回 Pearson 乘积矩相关系数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/pearson-%E5%87%BD%E6%95%B0-0c3e30fc-e5af-49c4-808a-3ef66e034c18"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTILE_EXC:{description:"返回某个区域中的数值的第 k 个百分点值，此处的 k 的范围为 0 到 1（不含 0 和 1）",abstract:"返回某个区域中的数值的第 k 个百分点值，此处的 k 的范围为 0 到 1（不含 0 和 1）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/percentile-exc-%E5%87%BD%E6%95%B0-bbaa7204-e9e1-4010-85bf-c31dc5dce4ba"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTILE_INC:{description:"返回区域中数值的第 k 个百分点的值",abstract:"返回区域中数值的第 k 个百分点的值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/percentile-inc-%E5%87%BD%E6%95%B0-680f9539-45eb-410b-9a5e-c1355e5fe2ed"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTRANK_EXC:{description:"将某个数值在数据集中的排位作为数据集的百分点值返回，此处的百分点值的范围为 0 到 1（不含 0 和 1）",abstract:"将某个数值在数据集中的排位作为数据集的百分点值返回，此处的百分点值的范围为 0 到 1（不含 0 和 1）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/percentrank-exc-%E5%87%BD%E6%95%B0-d8afee96-b7e2-4a2f-8c01-8fcdedaa6314"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERCENTRANK_INC:{description:"返回数据集中值的百分比排位",abstract:"返回数据集中值的百分比排位",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/percentrank-inc-%E5%87%BD%E6%95%B0-149592c9-00c0-49ba-86c1-c1f45b80463a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERMUT:{description:"返回给定数目对象的排列数",abstract:"返回给定数目对象的排列数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/permut-%E5%87%BD%E6%95%B0-3bd1cb9a-2880-41ab-a197-f246a7a602d3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PERMUTATIONA:{description:"返回可从总计对象中选择的给定数目对象（含重复）的排列数",abstract:"返回可从总计对象中选择的给定数目对象（含重复）的排列数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/permutationa-%E5%87%BD%E6%95%B0-6c7d7fdc-d657-44e6-aa19-2857b25cae4e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PHI:{description:"返回标准正态分布的密度函数值",abstract:"返回标准正态分布的密度函数值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/phi-%E5%87%BD%E6%95%B0-23e49bc6-a8e8-402d-98d3-9ded87f6295c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},POISSON_DIST:{description:"返回泊松分布",abstract:"返回泊松分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/poisson-dist-%E5%87%BD%E6%95%B0-8fe148ff-39a2-46cb-abf3-7772695d9636"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PROB:{description:"返回区域中的数值落在指定区间内的概率",abstract:"返回区域中的数值落在指定区间内的概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/prob-%E5%87%BD%E6%95%B0-9ac30561-c81c-4259-8253-34f0a238fc49"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUARTILE_EXC:{description:"基于百分点值返回数据集的四分位，此处的百分点值的范围为 0 到 1（不含 0 和 1）",abstract:"基于百分点值返回数据集的四分位，此处的百分点值的范围为 0 到 1（不含 0 和 1）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/quartile-exc-%E5%87%BD%E6%95%B0-5a355b7a-840b-4a01-b0f1-f538c2864cad"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},QUARTILE_INC:{description:"返回一组数据的四分位点",abstract:"返回一组数据的四分位点",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/quartile-inc-%E5%87%BD%E6%95%B0-1bbacc80-5075-42f1-aed6-47d735c4819d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANK_AVG:{description:"返回一列数字的数字排位",abstract:"返回一列数字的数字排位",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rank-avg-%E5%87%BD%E6%95%B0-bd406a6f-eb38-4d73-aa8e-6d1c3c72e83a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RANK_EQ:{description:"返回一列数字的数字排位",abstract:"返回一列数字的数字排位",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rank-eq-%E5%87%BD%E6%95%B0-284858ce-8ef6-450e-b662-26245be04a40"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RSQ:{description:"返回 Pearson 乘积矩相关系数的平方",abstract:"返回 Pearson 乘积矩相关系数的平方",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rsq-%E5%87%BD%E6%95%B0-d7161715-250d-4a01-b80d-a8364f2be08f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SKEW:{description:"返回分布的不对称度",abstract:"返回分布的不对称度",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/skew-%E5%87%BD%E6%95%B0-bdf49d86-b1ef-4804-a046-28eaea69c9fa"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SKEW_P:{description:"返回一个分布的不对称度：用来体现某一分布相对其平均值的不对称程度",abstract:"返回一个分布的不对称度：用来体现某一分布相对其平均值的不对称程度",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/skew-p-%E5%87%BD%E6%95%B0-76530a5c-99b9-48a1-8392-26632d542fcb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SLOPE:{description:"返回线性回归线的斜率",abstract:"返回线性回归线的斜率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/slope-%E5%87%BD%E6%95%B0-11fb8f97-3117-4813-98aa-61d7e01276b9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SMALL:{description:"返回数据集中的第 k 个最小值",abstract:"返回数据集中的第 k 个最小值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/small-%E5%87%BD%E6%95%B0-17da8222-7c82-42b2-961b-14c45384df07"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STANDARDIZE:{description:"返回正态化数值",abstract:"返回正态化数值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/standardize-%E5%87%BD%E6%95%B0-81d66554-2d54-40ec-ba83-6437108ee775"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEV_P:{description:"基于整个样本总体计算标准偏差",abstract:"基于整个样本总体计算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/stdev-p-%E5%87%BD%E6%95%B0-6e917c05-31a0-496f-ade7-4f4e7462f285"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEV_S:{description:"基于样本估算标准偏差",abstract:"基于样本估算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/stdev-s-%E5%87%BD%E6%95%B0-7d69cf97-0c1f-4acf-be27-f3e83904cc23"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEVA:{description:"基于样本（包括数字、文本和逻辑值）估算标准偏差",abstract:"基于样本（包括数字、文本和逻辑值）估算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/stdeva-%E5%87%BD%E6%95%B0-5ff38888-7ea5-48de-9a6d-11ed73b29e9d"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STDEVPA:{description:"基于样本总体（包括数字、文本和逻辑值）计算标准偏差",abstract:"基于样本总体（包括数字、文本和逻辑值）计算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/stdevpa-%E5%87%BD%E6%95%B0-5578d4d6-455a-4308-9991-d405afe2c28c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},STEYX:{description:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差",abstract:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/steyx-%E5%87%BD%E6%95%B0-6ce74b2c-449d-4a6e-b9ac-f9cef5ba48ab"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_DIST:{description:"返回学生 t-分布的百分点（概率）",abstract:"返回学生 t-分布的百分点（概率）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/t-dist-%E5%87%BD%E6%95%B0-4329459f-ae91-48c2-bba8-1ead1c6c21b2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_DIST_2T:{description:"返回学生 t-分布的百分点（概率）",abstract:"返回学生 t-分布的百分点（概率）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/t-dist-2t-%E5%87%BD%E6%95%B0-198e9340-e360-4230-bd21-f52f22ff5c28"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_DIST_RT:{description:"返回学生 t-分布",abstract:"返回学生 t-分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/t-dist-rt-%E5%87%BD%E6%95%B0-20a30020-86f9-4b35-af1f-7ef6ae683eda"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_INV:{description:"返回作为概率和自由度函数的学生 t 分布的 t 值",abstract:"返回作为概率和自由度函数的学生 t 分布的 t 值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/t-inv-%E5%87%BD%E6%95%B0-2908272b-4e61-4942-9df9-a25fec9b0e2e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_INV_2T:{description:"返回学生 t-分布的反函数",abstract:"返回学生 t-分布的反函数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/t-inv-2t-%E5%87%BD%E6%95%B0-ce72ea19-ec6c-4be7-bed2-b9baf2264f17"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T_TEST:{description:"返回与学生 t-检验相关的概率",abstract:"返回与学生 t-检验相关的概率",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/t-test-%E5%87%BD%E6%95%B0-d4e08ec3-c545-485f-962e-276f7cbed055"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TREND:{description:"返回线性趋势值",abstract:"返回线性趋势值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/trend-%E5%87%BD%E6%95%B0-e2f135f0-8827-4096-9873-9a7cf7b51ef1"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRIMMEAN:{description:"返回数据集的内部平均值",abstract:"返回数据集的内部平均值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/trimmean-%E5%87%BD%E6%95%B0-d90c9878-a119-4746-88fa-63d988f511d3"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VAR_P:{description:"计算基于样本总体的方差",abstract:"计算基于样本总体的方差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/var-p-%E5%87%BD%E6%95%B0-73d1285c-108c-4843-ba5d-a51f90656f3a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VAR_S:{description:"基于样本估算方差",abstract:"基于样本估算方差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/var-s-%E5%87%BD%E6%95%B0-913633de-136b-449d-813e-65a00b2b990b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VARA:{description:"基于样本（包括数字、文本和逻辑值）估算方差",abstract:"基于样本（包括数字、文本和逻辑值）估算方差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/vara-%E5%87%BD%E6%95%B0-3de77469-fa3a-47b4-85fd-81758a1e1d07"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VARPA:{description:"基于样本总体（包括数字、文本和逻辑值）计算标准偏差",abstract:"基于样本总体（包括数字、文本和逻辑值）计算标准偏差",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/varpa-%E5%87%BD%E6%95%B0-59a62635-4e89-4fad-88ac-ce4dc0513b96"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEIBULL_DIST:{description:"返回 Weibull 分布",abstract:"返回 Weibull 分布",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/weibull-dist-%E5%87%BD%E6%95%B0-4e783c39-9325-49be-bbc9-a83ef82b45db"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},Z_TEST:{description:"返回 z 检验的单尾概率值",abstract:"返回 z 检验的单尾概率值",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/z-test-%E5%87%BD%E6%95%B0-d633d5a3-2031-4614-a016-92180ad82bee"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},EYe={ASC:{description:"将字符串中的全角（双字节）英文字母或片假名更改为半角（单字节）字符",abstract:"将字符串中的全角（双字节）英文字母或片假名更改为半角（单字节）字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/asc-%E5%87%BD%E6%95%B0-0b6abf1c-c663-4004-a964-ebc00b723266"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},ARRAYTOTEXT:{description:"ARRAYTOTEXT 函数返回任意指定区域内的文本值的数组。",abstract:"ARRAYTOTEXT 函数返回任意指定区域内的文本值的数组。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/arraytotext-%E5%87%BD%E6%95%B0-9cdcad46-2fa5-4c6b-ac92-14e7bc862b8b"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},BAHTTEXT:{description:"使用 ß（泰铢）货币格式将数字转换为文本",abstract:"使用 ß（泰铢）货币格式将数字转换为文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/bahttext-%E5%87%BD%E6%95%B0-5ba4d0b4-abd3-4325-8d22-7a92d59aab9c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CHAR:{description:"返回由代码数字指定的字符",abstract:"返回由代码数字指定的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/char-%E5%87%BD%E6%95%B0-bbd249c8-b36e-4a91-8017-1c133f9b837a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CLEAN:{description:"删除文本中所有非打印字符",abstract:"删除文本中所有非打印字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/clean-%E5%87%BD%E6%95%B0-26f3d7c5-475f-4a9c-90e5-4b8ba987ba41"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CODE:{description:"返回文本字符串中第一个字符的数字代码",abstract:"返回文本字符串中第一个字符的数字代码",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/code-%E5%87%BD%E6%95%B0-c32b692b-2ed0-4a04-bdd9-75640144b928"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONCAT:{description:"将多个区域和/或字符串的文本组合起来，但不提供分隔符或 IgnoreEmpty 参数。",abstract:"将多个区域和/或字符串的文本组合起来，但不提供分隔符或 IgnoreEmpty 参数。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/concat-%E5%87%BD%E6%95%B0-9b1a9a3f-94ff-41af-9736-694cbd6b4ca2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CONCATENATE:{description:"将几个文本项合并为一个文本项",abstract:"将几个文本项合并为一个文本项",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/concatenate-%E5%87%BD%E6%95%B0-8f8ae884-2ca8-4f7a-b093-75d702bea31d"}],functionParameter:{text1:{name:"文本 1",detail:"要联接的第一个项目。 项目可以是文本值、数字或单元格引用。"},text2:{name:"文本 2",detail:"要联接的其他文本项目。 最多可以有 255 个项目，总共最多支持 8,192 个字符。"}}},DBCS:{description:"将字符串中的半角（单字节）英文字母或片假名更改为全角（双字节）字符",abstract:"将字符串中的半角（单字节）英文字母或片假名更改为全角（双字节）字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dbcs-%E5%87%BD%E6%95%B0-a4025e73-63d2-4958-9423-21a24794c9e5"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},DOLLAR:{description:"使用 ￥（人民币）货币格式将数字转换为文本",abstract:"使用 ￥（人民币）货币格式将数字转换为文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/dollar-%E5%87%BD%E6%95%B0-a6cd05d9-9740-4ad3-a469-8109d18ff611"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EXACT:{description:"检查两个文本值是否相同",abstract:"检查两个文本值是否相同",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/exact-%E5%87%BD%E6%95%B0-d3087698-fc15-4a15-9631-12575cf29926"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FIND:{description:"在一个文本值中查找另一个文本值（区分大小写）",abstract:"在一个文本值中查找另一个文本值（区分大小写）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/find-findb-%E5%87%BD%E6%95%B0-c7912941-af2a-4bdf-a553-d0d89b0a0628"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FINDB:{description:"在一个文本值中查找另一个文本值（区分大小写）",abstract:"在一个文本值中查找另一个文本值（区分大小写）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/find-findb-%E5%87%BD%E6%95%B0-c7912941-af2a-4bdf-a553-d0d89b0a0628"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FIXED:{description:"将数字格式设置为具有固定小数位数的文本",abstract:"将数字格式设置为具有固定小数位数的文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/fixed-%E5%87%BD%E6%95%B0-ffd5723c-324c-45e9-8b96-e41be2a8274a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LEFT:{description:"返回文本值中最左边的字符",abstract:"返回文本值中最左边的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/left-leftb-%E5%87%BD%E6%95%B0-9203d2d2-7960-479b-84c6-1ea52b99640c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LEFTB:{description:"返回文本值中最左边的字符",abstract:"返回文本值中最左边的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/left-leftb-%E5%87%BD%E6%95%B0-9203d2d2-7960-479b-84c6-1ea52b99640c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LEN:{description:"返回文本字符串中的字符个数",abstract:"返回文本字符串中的字符个数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/len-lenb-%E5%87%BD%E6%95%B0-29236f94-cedc-429d-affd-b5e33d2c67cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LENB:{description:"返回文本字符串中的字符个数",abstract:"返回文本字符串中的字符个数",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/len-lenb-%E5%87%BD%E6%95%B0-29236f94-cedc-429d-affd-b5e33d2c67cb"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},LOWER:{description:"将文本转换为小写",abstract:"将文本转换为小写",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/lower-%E5%87%BD%E6%95%B0-3f21df02-a80c-44b2-afaf-81358f9fdeb4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MID:{description:"从文本字符串中的指定位置起返回特定个数的字符",abstract:"从文本字符串中的指定位置起返回特定个数的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mid-midb-%E5%87%BD%E6%95%B0-d5f9e25c-d7d6-472e-b568-4ecb12433028"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},MIDB:{description:"从文本字符串中的指定位置起返回特定个数的字符",abstract:"从文本字符串中的指定位置起返回特定个数的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/mid-midb-%E5%87%BD%E6%95%B0-d5f9e25c-d7d6-472e-b568-4ecb12433028"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},NUMBERVALUE:{description:"以与区域设置无关的方式将文本转换为数字",abstract:"以与区域设置无关的方式将文本转换为数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/numbervalue-%E5%87%BD%E6%95%B0-1b05c8cf-2bfa-4437-af70-596c7ea7d879"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PHONETIC:{description:"提取文本字符串中的拼音（汉字注音）字符",abstract:"提取文本字符串中的拼音（汉字注音）字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/phonetic-%E5%87%BD%E6%95%B0-9a329dac-0c0f-42f8-9a55-639086988554"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},PROPER:{description:"将文本值的每个字的首字母大写",abstract:"将文本值的每个字的首字母大写",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/proper-%E5%87%BD%E6%95%B0-52a5a283-e8b2-49be-8506-b2887b889f94"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REPLACE:{description:"替换文本中的字符",abstract:"替换文本中的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/replace-replaceb-%E5%87%BD%E6%95%B0-8d799074-2425-4a8a-84bc-82472868878a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REPLACEB:{description:"替换文本中的字符",abstract:"替换文本中的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/replace-replaceb-%E5%87%BD%E6%95%B0-8d799074-2425-4a8a-84bc-82472868878a"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REPT:{description:"按给定次数重复文本",abstract:"按给定次数重复文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/rept-%E5%87%BD%E6%95%B0-04c4d778-e712-43b4-9c15-d656582bb061"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RIGHT:{description:"返回文本值中最右边的字符",abstract:"返回文本值中最右边的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/right-rightb-%E5%87%BD%E6%95%B0-240267ee-9afa-4639-a02b-f19e1786cf2f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},RIGHTB:{description:"返回文本值中最右边的字符",abstract:"返回文本值中最右边的字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/right-rightb-%E5%87%BD%E6%95%B0-240267ee-9afa-4639-a02b-f19e1786cf2f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEARCH:{description:"在一个文本值中查找另一个文本值（不区分大小写）",abstract:"在一个文本值中查找另一个文本值（不区分大小写）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/search-searchb-%E5%87%BD%E6%95%B0-9ab04538-0e55-4719-a72e-b6f54513b495"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SEARCHB:{description:"在一个文本值中查找另一个文本值（不区分大小写）",abstract:"在一个文本值中查找另一个文本值（不区分大小写）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/search-searchb-%E5%87%BD%E6%95%B0-9ab04538-0e55-4719-a72e-b6f54513b495"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},SUBSTITUTE:{description:"在文本字符串中用新文本替换旧文本",abstract:"在文本字符串中用新文本替换旧文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/substitute-%E5%87%BD%E6%95%B0-6434944e-a904-4336-a9b0-1e58df3bc332"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},T:{description:"将参数转换为文本",abstract:"将参数转换为文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/t-%E5%87%BD%E6%95%B0-fb83aeec-45e7-4924-af95-53e073541228"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXT:{description:"设置数字格式并将其转换为文本",abstract:"设置数字格式并将其转换为文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/text-%E5%87%BD%E6%95%B0-20d5ac4d-7b94-49fd-bb38-93d29371225c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTAFTER:{description:"返回给定字符或字符串之后出现的文本",abstract:"返回给定字符或字符串之后出现的文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/textafter-%E5%87%BD%E6%95%B0-c8db2546-5b51-416a-9690-c7e6722e90b4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTBEFORE:{description:"返回出现在给定字符或字符串之前的文本",abstract:"返回出现在给定字符或字符串之前的文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/textbefore-%E5%87%BD%E6%95%B0-d099c28a-dba8-448e-ac6c-f086d0fa1b29"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTJOIN:{description:"合并来自多个区域和/或字符串的文本",abstract:"合并来自多个区域和/或字符串的文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/textjoin-%E5%87%BD%E6%95%B0-357b449a-ec91-49d0-80c3-0e8fc845691c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TEXTSPLIT:{description:"使用列分隔符和行分隔符拆分文本字符串",abstract:"使用列分隔符和行分隔符拆分文本字符串",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/textsplit-%E5%87%BD%E6%95%B0-b1ca414e-4c21-4ca0-b1b7-bdecace8a6e7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},TRIM:{description:"删除文本中的空格",abstract:"删除文本中的空格",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/trim-%E5%87%BD%E6%95%B0-410388fa-c5df-49c6-b16c-9e5630b479f9"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UNICHAR:{description:"返回给定数值引用的 Unicode 字符",abstract:"返回给定数值引用的 Unicode 字符",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/unichar-%E5%87%BD%E6%95%B0-ffeb64f5-f131-44c6-b332-5cd72f0659b8"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UNICODE:{description:"返回对应于文本的第一个字符的数字（代码点）",abstract:"返回对应于文本的第一个字符的数字（代码点）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/unicode-%E5%87%BD%E6%95%B0-adb74aaa-a2a5-4dde-aff6-966e4e81f16f"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},UPPER:{description:"将文本转换为大写形式",abstract:"将文本转换为大写形式",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/upper-%E5%87%BD%E6%95%B0-c11f29b3-d1a3-4537-8df6-04d0049963d6"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VALUE:{description:"将文本参数转换为数字",abstract:"将文本参数转换为数字",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/value-%E5%87%BD%E6%95%B0-257d0108-07dc-437d-ae1c-bc2d3953d8c2"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},VALUETOTEXT:{description:"从任意指定值返回文本",abstract:"从任意指定值返回文本",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/valuetotext-%E5%87%BD%E6%95%B0-5fff61a2-301a-4ab2-9ffa-0a5242a08fea"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},CALL:{description:"调用动态链接库或代码源中的过程",abstract:"调用动态链接库或代码源中的过程",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/call-%E5%87%BD%E6%95%B0-32d58445-e646-4ffd-8d5e-b45077a5e995"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},EUROCONVERT:{description:"用于将数字转换为欧元形式，将数字由欧元形式转换为欧元成员国货币形式，或利用欧元作为中间货币将数字由某一欧元成员国货币转化为另一欧元成员国货币形式（三角转换关系）",abstract:"用于将数字转换为欧元形式，将数字由欧元形式转换为欧元成员国货币形式，或利用欧元作为中间货币将数字由某一欧元成员国货币转化为另一欧元成员国货币形式（三角转换关系）",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/euroconvert-%E5%87%BD%E6%95%B0-79c8fd67-c665-450c-bb6c-15fc92f8345c"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},REGISTER_ID:{description:"返回已注册过的指定动态链接库 (DLL) 或代码源的注册号",abstract:"返回已注册过的指定动态链接库 (DLL) 或代码源的注册号",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/register-id-%E5%87%BD%E6%95%B0-f8f0af0f-fd66-4704-a0f2-87b27b175b50"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},yYe={},DYe={ENCODEURL:{description:"返回 URL 编码的字符串",abstract:"返回 URL 编码的字符串",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/encodeurl-%E5%87%BD%E6%95%B0-07c7fb90-7c60-4bff-8687-fac50fe33d0e"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},FILTERXML:{description:"通过使用指定的 XPath，返回 XML 内容中的特定数据",abstract:"通过使用指定的 XPath，返回 XML 内容中的特定数据",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/filterxml-%E5%87%BD%E6%95%B0-4df72efc-11ec-4951-86f5-c1374812f5b7"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}},WEBSERVICE:{description:"返回 Web 服务中的数据。",abstract:"返回 Web 服务中的数据。",links:[{title:"教学",url:"https://support.microsoft.com/zh-cn/office/webservice-%E5%87%BD%E6%95%B0-0546a35a-ecc6-4739-aed7-c0b7ce1562c4"}],functionParameter:{number1:{name:"number1",detail:"first"},number2:{name:"number2",detail:"second"}}}},RYe={formula:{insert:{tooltip:"函数",sum:"求和",average:"平均值",count:"计数",max:"最大值",min:"最小值",more:"更多函数..."},functionList:{...gYe,...hYe,...CYe,...SYe,..._Ye,...fYe,...EYe,...bYe,...vYe,...pYe,...mYe,...dYe,...DYe,...cYe,...yYe},prompt:{helpExample:"示例",helpAbstract:"简介",required:"必需。",optional:"可选。"},functionType:{financial:"财务",date:"日期与时间",math:"数学与三角函数",statistical:"统计",lookup:"查找与引用",database:"数据库",text:"文本",logical:"逻辑",information:"信息",engineering:"工程",cube:"多维数据集",compatibility:"兼容性",web:"Web",array:"数组",univer:"Univer",user:"用户自定义"},moreFunctions:{confirm:"应用",prev:"上一步",next:"下一步",searchFunctionPlaceholder:"搜索函数",allFunctions:"全部函数",syntax:"语法"},operation:{pasteFormula:"仅粘贴公式"}}};var IYe=Object.defineProperty,AYe=Object.getOwnPropertyDescriptor,TYe=(t,e,n,r)=>{for(var i=r>1?void 0:r?AYe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&IYe(e,n,i),i},wYe=(t,e)=>(n,r)=>e(n,r,t);const ij=ln("formula-ui.formula-custom-function-service");let vC=class extends We{constructor(t){super(),this._commandService=t}registerFunctions(t){const e=t.map(n=>[n[0].toString(),n[1]]);this._commandService.executeCommand(BE.id,{functions:e},{local:!0})}unregisterFunctions(t){this._commandService.executeCommand(zE.id,{functions:t},{local:!0})}};vC=TYe([wYe(0,se)],vC);var LYe=Object.defineProperty,OYe=Object.getOwnPropertyDescriptor,PYe=(t,e,n,r)=>{for(var i=r>1?void 0:r?OYe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&LYe(e,n,i),i},u4=(t,e)=>(n,r)=>e(n,r,t);const MYe=ln("formula-ui.register-function-service");let bC=class extends We{constructor(t,e,n,r){super(),this._localeService=t,this._descriptionService=e,this._formulaCustomFunctionService=n,this._functionService=r}registerFunctions(t){const{locales:e,description:n,calculate:r}=t;if(e&&this._localeService.load(e),n)this._descriptionService.registerDescriptions(n);else{const i=r.map(([o,a,s])=>({functionName:a,functionType:A.User,description:"",abstract:s||"",functionParameter:[]}));this._functionService.registerDescriptions(...i)}this._formulaCustomFunctionService.registerFunctions(r)}unregisterFunctions(t){const{localeKeys:e,functionNames:n}=t;this._descriptionService.unregisterDescriptions(n),this._formulaCustomFunctionService.unregisterFunctions(n)}};bC=PYe([u4(0,K(Gt)),u4(1,K(Z8)),u4(2,K(ij)),u4(3,Bs)],bC);var NYe=Object.defineProperty,xYe=Object.getOwnPropertyDescriptor,FYe=(t,e,n,r)=>{for(var i=r>1?void 0:r?xYe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&NYe(e,n,i),i},l4=(t,e)=>(n,r)=>e(n,r,t);let bh=class extends We{constructor(t,e,n,r){super(),this._commandService=t,this._sheetInterceptorService=e,this._formulaDataModel=n,this._themeService=r,this._initialize()}_initialize(){this._commandExecutedListener(),this._initInterceptorCellContent()}_commandExecutedListener(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id!==km.id)return;const e=t.params;if(e==null)return;const{numfmtItemMap:n}=e;this._formulaDataModel.updateNumfmtItemMap(n)}))}_initInterceptorCellContent(){this.disposeWithMe(this._sheetInterceptorService.intercept(Rs.CELL_CONTENT,{priority:98,handler:(t,e,n)=>{var r,i,o;const{unitId:a,subUnitId:s,row:u,col:l}=e,c=(o=(i=(r=this._formulaDataModel.getNumfmtItemMap()[a])==null?void 0:r[s])==null?void 0:i[u])==null?void 0:o[l];if(c==null||c==="")return n(t);const d=e.worksheet.getCellRaw(u,l),m=d==null?void 0:d.v,f=d==null?void 0:d.t;if(m==null||f!==$n.NUMBER)return n(t);const h=q8(c,m);if(h.color){const p=this._themeService.getCurrentTheme()[`${h.color}500`];return{...t,v:h.result,t:$n.STRING,s:{cl:{rgb:p}}}}return{...t,v:h.result,t:$n.STRING}}}))}};bh=FYe([yt(ot.Ready,bh),l4(0,se),l4(1,K(In)),l4(2,K(Ai)),l4(3,K(_i))],bh);var $Ye=Object.defineProperty,kYe=Object.getOwnPropertyDescriptor,BYe=(t,e,n,r)=>{for(var i=r>1?void 0:r?kYe(e,n):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(r?a(e,n,i):a(i))||i);return r&&i&&$Ye(e,n,i),i},cv=(t,e)=>(n,r)=>e(n,r,t),dv;let _C=(dv=class extends b1{constructor(t,e,n,r){super(VH),this._config=t,this._injector=e,this._localeService=n,this._currentUniverService=r}initialize(){this._localeService.load({zhCN:RYe}),[[a2,{useClass:Gje}],[zf,{useClass:Wje}],[Z8,{useFactory:()=>{var t;return this._injector.createInstance(pC,(t=this._config)==null?void 0:t.description)}}],[ij,{useClass:vC}],[Py,{useClass:Ije}],[MYe,{useClass:bC}],[hh],[ph],[fh],[ch],[dh],[lh],[bh],[gh],[vh],[mh],[uh]].forEach(t=>this._injector.add(t))}onReady(){this.initialize()}},Rn(dv,"type",Ir.Sheet),dv);_C=BYe([cv(1,K(wn)),cv(2,K(Gt)),cv(3,ae)],_C);const oj=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n},UYe={name:"UniverSheet",props:{data:{value:Object,default:()=>({})}},watch:{data:{handler(t){this.destroyUniver(),this.init(t)},immediate:!0}},data(){return{univer:null,workbook:null}},mounted(){this.init(this.data)},methods:{init(t={}){const e=new qY({theme:Ex});this.univer=e,e.registerPlugin(c_),e.registerPlugin(H_),e.registerPlugin(M_,{container:this.$refs.container,header:!0,toolbar:!0,footer:!0}),e.registerPlugin(f_,{hasScroll:!1}),e.registerPlugin(F_),e.registerPlugin(q_),e.registerPlugin(dC),e.registerPlugin(_C),this.workbook=e.createUniverSheet(t)},destroyUniver(){var t;(t=this.univer)==null||t.dispose(),this.univer=null,this.workbook=null},getData(){if(!this.workbook)throw new Error("Workbook is not initialized");return this.workbook.save()}}},VYe={ref:"container",class:"univer-container"};function HYe(t,e,n,r,i,o){return ww(),Lw("div",VYe,null,512)}const jYe=oj(UYe,[["render",HYe],["__scopeId","data-v-0c3d451b"]]),zYe={id:"workbook-01",locale:t5.ZH_CN,name:"universheet",sheetOrder:["sheet-01","sheet-02","sheet-03"],appVersion:"3.0.0-alpha",sheets:{"sheet-01":{type:m4.GRID,id:"sheet-01",cellData:{0:{0:{v:"Hello World"}}},name:"sheet1",tabColor:"red",hidden:we.FALSE,rowCount:1e3,columnCount:20,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,status:1,showGridlines:1,hideRow:[],hideColumn:[],rowHeader:{width:46,hidden:we.FALSE},columnHeader:{height:20,hidden:we.FALSE},selections:["A2"],rightToLeft:we.FALSE,pluginMeta:{}},"sheet-02":{type:m4.GRID,id:"sheet-02",name:"sheet2",cellData:{}},"sheet-03":{type:m4.GRID,id:"sheet-03",name:"sheet3",cellData:{}}}};const WYe={name:"App",components:{UniverSheet:jYe},data(){return{data:JSON.parse(localStorage.getItem("sheets"))||zYe}},watch:{data:{handler(){var e;const t=(e=this.$refs.univerRef)==null?void 0:e.getData();console.log("儲存",t),localStorage.setItem("sheets",JSON.stringify(t))},deep:!0}},methods:{getData(){var e;const t=(e=this.$refs.univerRef)==null?void 0:e.getData();console.log("result",t)}},mounted(){}},YYe={id:"sheetsWrap"};function XYe(t,e,n,r,i,o){const a=aj("UniverSheet");return ww(),Lw("div",YYe,[Fy("div",null,[Fy("button",{type:"button",onClick:e[0]||(e[0]=(...s)=>o.getData&&o.getData(...s))}," 取得資料 ")]),sj(a,{id:"sheet",ref:"univerRef",data:i.data},null,8,["data"])])}const QZe=oj(WYe,[["render",XYe]]);export{QZe as default};
